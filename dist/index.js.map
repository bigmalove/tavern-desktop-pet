{"version":3,"file":"index.js","mappings":"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","sources":["webpack://tavern_helper_template////ui/FunctionMenu.vue?bf5d","src://tavern_helper_template/node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js","webpack://tavern_helper_template////ui/TreeNode.vue?5d18","src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js","webpack://tavern_helper_template////ui/ModelBrowser.vue?6a09","webpack://tavern_helper_template////ui/ModelBrowser.vue?1256","webpack://tavern_helper_template////ui/FunctionMenu.vue?0566","src://tavern_helper_template/node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/listToStyles.js","src://tavern_helper_template/node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js","webpack://tavern_helper_template////ui/PetContainer.vue?36aa","webpack://tavern_helper_template////ui/SettingsPanel.vue?dd79","webpack://tavern_helper_template////ui/PetContainer.vue?f5e7","webpack://tavern_helper_template////ui/TreeNode.vue?7472","webpack://tavern_helper_template////ui/ChatBubble.vue?2609","webpack://tavern_helper_template////ui/SettingsPanel.vue?a2e2","src://tavern_helper_template/node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js","webpack://tavern_helper_template////ui/ChatBubble.vue?d14c","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/webpack/runtime/compat get default export","src://tavern_helper_template/webpack/runtime/define property getters","src://tavern_helper_template/webpack/runtime/hasOwnProperty shorthand","src://tavern_helper_template/webpack/runtime/make namespace object","src://tavern_helper_template/external var \"Vue\"","src://tavern_helper_template////core/constants.ts","src://tavern_helper_template/external var \"z\"","src://tavern_helper_template////core/emotion.ts","src://tavern_helper_template////utils/dom.ts","src://tavern_helper_template////core/settings.ts","src://tavern_helper_template////audio/edge-tts-direct.ts","src://tavern_helper_template////audio/tts-config.ts","src://tavern_helper_template////core/state.ts","src://tavern_helper_template////db/init.ts","src://tavern_helper_template////live2d/runtime-router.ts","src://tavern_helper_template////db/live2d-models.ts","src://tavern_helper_template////live2d/loader.ts","src://tavern_helper_template////utils/gesture-recognizer.ts","src://tavern_helper_template////live2d/stage.ts","src://tavern_helper_template////live2d/builtin-expression-motion.ts","src://tavern_helper_template////live2d/expression-motion.ts","src://tavern_helper_template////live2d/manager.ts","src://tavern_helper_template////live2d/lip-sync.ts","src://tavern_helper_template////audio/tts-manager.ts","src://tavern_helper_template////chat/bilingual-text.ts","src://tavern_helper_template////chat/monitor.ts","src://tavern_helper_template////chat/prompt-templates.ts","src://tavern_helper_template////chat/commentator.ts","src://tavern_helper_template////chat/emotion-cot.ts","src://tavern_helper_template////core/ui.ts","src://tavern_helper_template////ui/ChatBubble.vue","webpack://tavern_helper_template////ui/ChatBubble.vue?4a23","src://tavern_helper_template////ui/FunctionMenu.vue","webpack://tavern_helper_template////ui/FunctionMenu.vue?e028","src://tavern_helper_template////live2d/model-browser.ts","src://tavern_helper_template////ui/TreeNode.vue","webpack://tavern_helper_template////ui/TreeNode.vue?c5ea","src://tavern_helper_template////ui/ModelBrowser.vue","webpack://tavern_helper_template////ui/ModelBrowser.vue?8203","src://tavern_helper_template////live2d/uploader.ts","src://tavern_helper_template////ui/SettingsPanel.vue","webpack://tavern_helper_template////ui/SettingsPanel.vue?6f86","src://tavern_helper_template////ui/PetContainer.vue","webpack://tavern_helper_template////ui/PetContainer.vue?aed4","src://tavern_helper_template////utils/style-teleport.ts","src://tavern_helper_template////index.ts"],"sourcesContent":["/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./FunctionMenu.vue?vue&type=style&index=0&id=ff4f8948&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"078f2c0f\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./FunctionMenu.vue?vue&type=style&index=0&id=ff4f8948&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./FunctionMenu.vue?vue&type=style&index=0&id=ff4f8948&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = [];\n\n  // return the list of modules as css string\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n      content += cssWithMappingToString(item);\n      if (needLayer) {\n        content += \"}\";\n      }\n      if (item[2]) {\n        content += \"}\";\n      }\n      if (item[4]) {\n        content += \"}\";\n      }\n      return content;\n    }).join(\"\");\n  };\n\n  // import a list of modules into the list\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n    var alreadyImportedModules = {};\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n      list.push(item);\n    }\n  };\n  return list;\n};","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.node-row[data-v-3a6a95ba]{display:flex;align-items:center;padding:5px 8px;cursor:pointer;border-bottom:1px solid hsla(0,0%,100%,.08);font-size:12px;gap:4px;-webkit-user-select:none;user-select:none;transition:background .14s}.node-row[data-v-3a6a95ba]:hover{background:rgba(255,225,0,.12)}.node-row.is-model .node-name[data-v-3a6a95ba]{color:#00dac2;font-weight:600}.node-row.is-selected[data-v-3a6a95ba]{background:rgba(255,225,0,.2)}.expand-icon[data-v-3a6a95ba]{width:14px;font-size:8px;color:#8d8d8d;transition:transform .2s;flex-shrink:0;text-align:center}.expand-icon.expanded[data-v-3a6a95ba]{transform:rotate(90deg)}.expand-icon.placeholder[data-v-3a6a95ba]{visibility:hidden}.node-icon[data-v-3a6a95ba]{font-size:13px;flex-shrink:0;line-height:1}.node-name[data-v-3a6a95ba]{color:#f1f1f1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1}.node-spinner[data-v-3a6a95ba]{display:inline-block;width:10px;height:10px;border:1.5px solid #4d4d4d;border-top-color:#00dac2;border-radius:50%;animation:spin-3a6a95ba .8s linear infinite;flex-shrink:0;margin-left:4px}@keyframes spin-3a6a95ba{to{transform:rotate(360deg)}}.empty-hint[data-v-3a6a95ba]{font-size:11px;color:#8d8d8d;padding:4px 8px}.child-error[data-v-3a6a95ba]{font-size:11px;color:#ffb5af;padding:4px 8px}.child-error .retry-link[data-v-3a6a95ba]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.child-error .retry-link[data-v-3a6a95ba]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.child-error .retry-link[data-v-3a6a95ba]:disabled{opacity:.45;cursor:not-allowed}.child-error .retry-link[data-v-3a6a95ba]{height:22px;min-width:56px;padding:0 8px;margin-left:6px;font-size:10px;border-color:rgba(0,218,194,.55);color:#c5fff9;cursor:pointer}.child-error .retry-link[data-v-3a6a95ba]:hover{background:#00dac2;border-color:#00dac2;color:#000}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/TreeNode.vue\"],\"names\":[],\"mappings\":\"AAAA,iEAAA,CCAwH,2BAAU,YAAa,CAAA,kBAAmB,CAAA,eAAgB,CAAA,cAAe,CAAA,2CAA4C,CAAA,cAAe,CAAA,OAAQ,CAAA,wBAAiB,CAAjB,gBAAiB,CAAA,0BAA2B,CAAA,iCAAgB,8BAA+B,CAAA,+CAA8B,aAAc,CAAA,eAAgB,CAAA,uCAAsB,6BAA8B,CAAA,8BAAa,UAAW,CAAA,aAAc,CAAA,aAAc,CAAA,wBAAyB,CAAA,aAAc,CAAA,iBAAkB,CAAA,uCAAsB,uBAAwB,CAAA,0CAAyB,iBAAkB,CAAA,4BAAW,cAAe,CAAA,aAAc,CAAA,aAAc,CAAA,4BAAW,aAAc,CAAA,eAAgB,CAAA,sBAAuB,CAAA,kBAAmB,CAAA,MAAO,CAAA,+BAAc,oBAAqB,CAAA,UAAW,CAAA,WAAY,CAAA,0BAA2B,CAAA,wBAAyB,CAAA,iBAAkB,CAAA,2CAAmC,CAAA,aAAc,CAAA,eAAgB,CAAA,yBAAgB,GAAG,wBAAyB,CAAC,CAAA,6BAAY,cAAe,CAAA,aAAc,CAAA,eAAgB,CAAA,8BAAa,cAAe,CAAA,aAAc,CAAA,eAAgB,CAAA,0CAAyB,uBAAgB,CAAhB,eAAgB,CAAA,oCAAqC,CAAA,wBAAyB,CAAA,UAAW,CAAA,iDAAkD,CAAA,eAAgB,CAAA,oBAAqB,CAAA,wBAAyB,CAAA,cAAe,CAAA,kFAAuF,CAAA,sEAAuE,CAAA,+DAA8C,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,mDAAkC,WAAY,CAAA,kBAAmB,CAAA,0CAAyB,WAAY,CAAA,cAAe,CAAA,aAAc,CAAA,eAAgB,CAAA,cAAe,CAAA,gCAAiC,CAAA,aAAc,CAAA,cAAe,CAAA,gDAA+B,kBAAmB,CAAA,oBAAqB,CAAA,UAAW\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.node-row{display:flex;align-items:center;padding:5px 8px;cursor:pointer;border-bottom:1px solid hsla(0,0%,100%,.08);font-size:12px;gap:4px;user-select:none;transition:background .14s}.node-row:hover{background:rgba(255,225,0,.12)}.node-row.is-model .node-name{color:#00dac2;font-weight:600}.node-row.is-selected{background:rgba(255,225,0,.2)}.expand-icon{width:14px;font-size:8px;color:#8d8d8d;transition:transform .2s;flex-shrink:0;text-align:center}.expand-icon.expanded{transform:rotate(90deg)}.expand-icon.placeholder{visibility:hidden}.node-icon{font-size:13px;flex-shrink:0;line-height:1}.node-name{color:#f1f1f1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1}.node-spinner{display:inline-block;width:10px;height:10px;border:1.5px solid #4d4d4d;border-top-color:#00dac2;border-radius:50%;animation:spin .8s linear infinite;flex-shrink:0;margin-left:4px}@keyframes spin{to{transform:rotate(360deg)}}.empty-hint{font-size:11px;color:#8d8d8d;padding:4px 8px}.child-error{font-size:11px;color:#ffb5af;padding:4px 8px}.child-error .retry-link{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.child-error .retry-link:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.child-error .retry-link:disabled{opacity:.45;cursor:not-allowed}.child-error .retry-link{height:22px;min-width:56px;padding:0 8px;margin-left:6px;font-size:10px;border-color:rgba(0,218,194,.55);color:#c5fff9;cursor:pointer}.child-error .retry-link:hover{background:#00dac2;border-color:#00dac2;color:#000}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.model-browser[data-v-7ee23a0a]{display:flex;flex-direction:column;height:100%;max-height:60vh;color:#fff;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif}.browser-header[data-v-7ee23a0a]{display:flex;align-items:center;justify-content:space-between;padding:8px 0 10px;margin-bottom:10px;border-bottom:1px solid rgba(255,225,0,.35)}.browser-header .browser-title[data-v-7ee23a0a]{font-size:14px;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;letter-spacing:.08em;color:#ffe100}.browser-header .browser-hint[data-v-7ee23a0a]{font-size:10px;color:#8d8d8d;letter-spacing:.08em}.search-box[data-v-7ee23a0a]{margin-bottom:10px}.search-box input[data-v-7ee23a0a]{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.search-box input[data-v-7ee23a0a]:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.search-box input[data-v-7ee23a0a]::placeholder{color:#8d8d8d}.search-box input[data-v-7ee23a0a]{color:#fff}.error-bar[data-v-7ee23a0a]{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:8px 10px;background:rgba(255,59,48,.12);border:1px solid rgba(255,59,48,.4);margin-bottom:10px;font-size:12px;color:#ffc9c5}.error-bar .retry-btn[data-v-7ee23a0a]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.error-bar .retry-btn[data-v-7ee23a0a]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.error-bar .retry-btn[data-v-7ee23a0a]:disabled{opacity:.45;cursor:not-allowed}.error-bar .retry-btn[data-v-7ee23a0a]{min-width:72px;height:26px;padding:0 8px;font-size:11px;border-color:rgba(255,59,48,.6);color:#ffc9c5}.error-bar .retry-btn[data-v-7ee23a0a]:hover{background:#ff3b30;border-color:#ff3b30;color:#fff}.tree-container[data-v-7ee23a0a]{flex:1;overflow-y:auto;min-height:150px;padding:4px 0 6px;border:1px solid hsla(0,0%,100%,.12);background:rgba(0,0,0,.3)}.tree-container[data-v-7ee23a0a]::-webkit-scrollbar{width:7px;height:7px}.tree-container[data-v-7ee23a0a]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.tree-container[data-v-7ee23a0a]::-webkit-scrollbar-thumb{background:#555}.tree-container[data-v-7ee23a0a]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.tree-container[data-v-7ee23a0a]:empty{border-style:dashed}.loading-state[data-v-7ee23a0a]{display:flex;align-items:center;justify-content:center;padding:24px;color:#8d8d8d;font-size:13px;gap:8px}.spinner[data-v-7ee23a0a]{display:inline-block;width:14px;height:14px;border:2px solid #4d4d4d;border-top-color:#00dac2;border-radius:50%;animation:spin-7ee23a0a .8s linear infinite}@keyframes spin-7ee23a0a{to{transform:rotate(360deg)}}.empty-state[data-v-7ee23a0a]{text-align:center;padding:24px;color:#8d8d8d;font-size:13px}.browser-footer[data-v-7ee23a0a]{border-top:1px solid hsla(0,0%,100%,.16);padding-top:12px;margin-top:10px}.browser-footer .selected-info[data-v-7ee23a0a]{font-size:12px;color:#d5d5d5;margin-bottom:8px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.browser-footer .selected-info .selected-path[data-v-7ee23a0a]{color:#ffe100;font-weight:600}.browser-footer .selected-info .no-selection[data-v-7ee23a0a]{color:#8d8d8d}.browser-footer .footer-actions[data-v-7ee23a0a]{display:flex;justify-content:flex-end;gap:8px}.btn[data-v-7ee23a0a]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.btn[data-v-7ee23a0a]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.btn[data-v-7ee23a0a]:disabled{opacity:.45;cursor:not-allowed}.btn[data-v-7ee23a0a]{min-width:90px;height:32px;padding:0 14px;font-size:12px}.btn[data-v-7ee23a0a]:disabled{opacity:.4;cursor:not-allowed}.btn.btn-primary[data-v-7ee23a0a]{background:#ffe100;color:#000;border-color:#ffe100}.btn.btn-primary[data-v-7ee23a0a]:hover:not(:disabled){background:#fff26e;border-color:#fff26e}.btn.btn-secondary[data-v-7ee23a0a]{background:rgba(0,218,194,.08);border-color:rgba(0,218,194,.55);color:#c5fff9}.btn.btn-secondary[data-v-7ee23a0a]:hover{background:#00dac2;border-color:#00dac2;color:#000}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/ModelBrowser.vue\"],\"names\":[],\"mappings\":\"AAAA,iEAAA,CCAwH,gCAAe,YAAa,CAAA,qBAAsB,CAAA,WAAY,CAAA,eAAgB,CAAA,UAAW,CAAA,gFAAiF,CAAA,iCAAgB,YAAa,CAAA,kBAAmB,CAAA,6BAA8B,CAAA,kBAAmB,CAAA,kBAAmB,CAAA,2CAA4C,CAAA,gDAA+B,cAAe,CAAA,iDAAkD,CAAA,oBAAqB,CAAA,aAAc,CAAA,+CAA8B,cAAe,CAAA,aAAc,CAAA,oBAAqB,CAAA,6BAAY,kBAAmB,CAAA,mCAAkB,UAAW,CAAA,qBAAsB,CAAA,gBAAiB,CAAA,wBAAyB,CAAA,+BAAgC,CAAA,eAAgB,CAAA,0BAA2B,CAAA,aAAc,CAAA,+DAAgE,CAAA,cAAe,CAAA,YAAa,CAAA,sDAAuD,CAAA,yCAAwB,oBAAqB,CAAA,8BAA+B,CAAA,gDAA+B,aAAc,CAAA,mCAAkB,UAAW,CAAA,4BAAW,YAAa,CAAA,kBAAmB,CAAA,6BAA8B,CAAA,OAAQ,CAAA,gBAAiB,CAAA,8BAA+B,CAAA,mCAAoC,CAAA,kBAAmB,CAAA,cAAe,CAAA,aAAc,CAAA,uCAAsB,uBAAgB,CAAhB,eAAgB,CAAA,oCAAqC,CAAA,wBAAyB,CAAA,UAAW,CAAA,iDAAkD,CAAA,eAAgB,CAAA,oBAAqB,CAAA,wBAAyB,CAAA,cAAe,CAAA,kFAAuF,CAAA,sEAAuE,CAAA,4DAA2C,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,gDAA+B,WAAY,CAAA,kBAAmB,CAAA,uCAAsB,cAAe,CAAA,WAAY,CAAA,aAAc,CAAA,cAAe,CAAA,+BAAgC,CAAA,aAAc,CAAA,6CAA4B,kBAAmB,CAAA,oBAAqB,CAAA,UAAW,CAAA,iCAAgB,MAAO,CAAA,eAAgB,CAAA,gBAAiB,CAAA,iBAAkB,CAAA,oCAAqC,CAAA,yBAA0B,CAAA,oDAAmC,SAAU,CAAA,UAAW,CAAA,0DAAyC,8BAA+B,CAAA,0DAAyC,eAAgB,CAAA,gEAA+C,kBAAmB,CAAA,uCAAsB,mBAAoB,CAAA,gCAAe,YAAa,CAAA,kBAAmB,CAAA,sBAAuB,CAAA,YAAa,CAAA,aAAc,CAAA,cAAe,CAAA,OAAQ,CAAA,0BAAS,oBAAqB,CAAA,UAAW,CAAA,WAAY,CAAA,wBAAyB,CAAA,wBAAyB,CAAA,iBAAkB,CAAA,2CAAmC,CAAA,yBAAgB,GAAG,wBAAyB,CAAC,CAAA,8BAAa,iBAAkB,CAAA,YAAa,CAAA,aAAc,CAAA,cAAe,CAAA,iCAAgB,wCAAyC,CAAA,gBAAiB,CAAA,eAAgB,CAAA,gDAA+B,cAAe,CAAA,aAAc,CAAA,iBAAkB,CAAA,eAAgB,CAAA,sBAAuB,CAAA,kBAAmB,CAAA,+DAA8C,aAAc,CAAA,eAAgB,CAAA,8DAA6C,aAAc,CAAA,iDAAgC,YAAa,CAAA,wBAAyB,CAAA,OAAQ,CAAA,sBAAK,uBAAgB,CAAhB,eAAgB,CAAA,oCAAqC,CAAA,wBAAyB,CAAA,UAAW,CAAA,iDAAkD,CAAA,eAAgB,CAAA,oBAAqB,CAAA,wBAAyB,CAAA,cAAe,CAAA,kFAAuF,CAAA,sEAAuE,CAAA,2CAA0B,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,+BAAc,WAAY,CAAA,kBAAmB,CAAA,sBAAK,cAAe,CAAA,WAAY,CAAA,cAAe,CAAA,cAAe,CAAA,+BAAc,UAAW,CAAA,kBAAmB,CAAA,kCAAiB,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,uDAAsC,kBAAmB,CAAA,oBAAqB,CAAA,oCAAmB,8BAA+B,CAAA,gCAAiC,CAAA,aAAc,CAAA,0CAAyB,kBAAmB,CAAA,oBAAqB,CAAA,UAAW\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.model-browser{display:flex;flex-direction:column;height:100%;max-height:60vh;color:#fff;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif}.browser-header{display:flex;align-items:center;justify-content:space-between;padding:8px 0 10px;margin-bottom:10px;border-bottom:1px solid rgba(255,225,0,.35)}.browser-header .browser-title{font-size:14px;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;letter-spacing:.08em;color:#ffe100}.browser-header .browser-hint{font-size:10px;color:#8d8d8d;letter-spacing:.08em}.search-box{margin-bottom:10px}.search-box input{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.search-box input:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.search-box input::placeholder{color:#8d8d8d}.search-box input{color:#fff}.error-bar{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:8px 10px;background:rgba(255,59,48,.12);border:1px solid rgba(255,59,48,.4);margin-bottom:10px;font-size:12px;color:#ffc9c5}.error-bar .retry-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.error-bar .retry-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.error-bar .retry-btn:disabled{opacity:.45;cursor:not-allowed}.error-bar .retry-btn{min-width:72px;height:26px;padding:0 8px;font-size:11px;border-color:rgba(255,59,48,.6);color:#ffc9c5}.error-bar .retry-btn:hover{background:#ff3b30;border-color:#ff3b30;color:#fff}.tree-container{flex:1;overflow-y:auto;min-height:150px;padding:4px 0 6px;border:1px solid hsla(0,0%,100%,.12);background:rgba(0,0,0,.3)}.tree-container::-webkit-scrollbar{width:7px;height:7px}.tree-container::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.tree-container::-webkit-scrollbar-thumb{background:#555}.tree-container::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.tree-container:empty{border-style:dashed}.loading-state{display:flex;align-items:center;justify-content:center;padding:24px;color:#8d8d8d;font-size:13px;gap:8px}.spinner{display:inline-block;width:14px;height:14px;border:2px solid #4d4d4d;border-top-color:#00dac2;border-radius:50%;animation:spin .8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.empty-state{text-align:center;padding:24px;color:#8d8d8d;font-size:13px}.browser-footer{border-top:1px solid hsla(0,0%,100%,.16);padding-top:12px;margin-top:10px}.browser-footer .selected-info{font-size:12px;color:#d5d5d5;margin-bottom:8px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.browser-footer .selected-info .selected-path{color:#ffe100;font-weight:600}.browser-footer .selected-info .no-selection{color:#8d8d8d}.browser-footer .footer-actions{display:flex;justify-content:flex-end;gap:8px}.btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.btn:disabled{opacity:.45;cursor:not-allowed}.btn{min-width:90px;height:32px;padding:0 14px;font-size:12px}.btn:disabled{opacity:.4;cursor:not-allowed}.btn.btn-primary{background:#ffe100;color:#000;border-color:#ffe100}.btn.btn-primary:hover:not(:disabled){background:#fff26e;border-color:#fff26e}.btn.btn-secondary{background:rgba(0,218,194,.08);border-color:rgba(0,218,194,.55);color:#c5fff9}.btn.btn-secondary:hover{background:#00dac2;border-color:#00dac2;color:#000}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ModelBrowser.vue?vue&type=style&index=0&id=7ee23a0a&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"db518fdc\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ModelBrowser.vue?vue&type=style&index=0&id=7ee23a0a&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ModelBrowser.vue?vue&type=style&index=0&id=7ee23a0a&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.menu-overlay[data-v-ff4f8948]{position:fixed;inset:0;z-index:10002;background:rgba(0,0,0,.12);display:flex;align-items:center;justify-content:center}.menu-cluster[data-v-ff4f8948]{position:fixed;display:flex;align-items:center;gap:10px;max-width:calc(100vw - 16px);pointer-events:auto}.menu-cluster.is-left[data-v-ff4f8948]{flex-direction:row-reverse}.menu-panel[data-v-ff4f8948]{width:164px;padding:8px;background:#181818;color:#fff;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0,100% 0,100% calc(100% - 12px),calc(100% - 12px) 100%,0 100%)}.menu-panel[data-v-ff4f8948]::before{content:\"\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.menu-panel[data-v-ff4f8948]{background-image:linear-gradient(rgba(255,255,255,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.03) 1px,transparent 1px);background-size:20px 20px}.panel-top[data-v-ff4f8948]{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;padding:4px 4px 8px;border-bottom:1px solid rgba(255,225,0,.35)}.panel-title[data-v-ff4f8948]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;color:#ffe100;font-size:12px;letter-spacing:.12em}.icon-btn[data-v-ff4f8948]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.icon-btn[data-v-ff4f8948]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.icon-btn[data-v-ff4f8948]:disabled{opacity:.45;cursor:not-allowed}.icon-btn[data-v-ff4f8948]{width:28px;height:24px;padding:0;font-size:16px;line-height:1}.command-btn[data-v-ff4f8948]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.command-btn[data-v-ff4f8948]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.command-btn[data-v-ff4f8948]:disabled{opacity:.45;cursor:not-allowed}.command-btn[data-v-ff4f8948]{width:100%;min-height:52px;padding:8px 10px;margin-bottom:8px;text-align:left;display:grid;grid-template-columns:auto 1fr;grid-template-areas:\"idx main\" \"idx sub\";-moz-column-gap:8px;column-gap:8px;row-gap:2px}.command-btn[data-v-ff4f8948]:last-child{margin-bottom:0}.command-btn.active[data-v-ff4f8948]{background:#ffe100;color:#000;border-color:#ffe100}.command-btn.danger[data-v-ff4f8948]{border-color:rgba(255,59,48,.45);color:#ffc9c5}.command-btn.danger[data-v-ff4f8948]:hover{background:#ff3b30;border-color:#ff3b30;color:#fff}.command-index[data-v-ff4f8948]{grid-area:idx;align-self:center;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:16px;color:#00dac2}.command-main[data-v-ff4f8948]{grid-area:main;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:12px;line-height:1}.command-sub[data-v-ff4f8948]{grid-area:sub;font-size:10px;color:#8d8d8d;text-transform:none}.chat-drawer[data-v-ff4f8948]{width:min(320px,100vw - 36px);max-height:min(68vh,420px);padding:12px;background:#262626;color:#fff;overflow:auto;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0,100% 0,100% calc(100% - 12px),calc(100% - 12px) 100%,0 100%)}.chat-drawer[data-v-ff4f8948]::before{content:\"\";position:absolute;top:0;left:0;width:56px;height:2px;background:#00dac2;z-index:2}.chat-drawer[data-v-ff4f8948]{background-image:linear-gradient(rgba(255,255,255,0.024) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.024) 1px,transparent 1px);background-size:20px 20px}.chat-drawer[data-v-ff4f8948]::-webkit-scrollbar{width:7px;height:7px}.chat-drawer[data-v-ff4f8948]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.chat-drawer[data-v-ff4f8948]::-webkit-scrollbar-thumb{background:#555}.chat-drawer[data-v-ff4f8948]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.drawer-head[data-v-ff4f8948]{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;padding-bottom:8px;border-bottom:1px solid rgba(0,218,194,.38)}.drawer-title[data-v-ff4f8948]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:12px;letter-spacing:.12em;color:#00dac2}.drawer-close[data-v-ff4f8948]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.drawer-close[data-v-ff4f8948]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.drawer-close[data-v-ff4f8948]:disabled{opacity:.45;cursor:not-allowed}.drawer-close[data-v-ff4f8948]{width:26px;height:24px;padding:0;font-size:16px;line-height:1}.chat-input[data-v-ff4f8948]{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.chat-input[data-v-ff4f8948]:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.chat-input[data-v-ff4f8948]::placeholder{color:#8d8d8d}.chat-input[data-v-ff4f8948]{min-height:96px;resize:vertical;color:#fff}.drawer-actions[data-v-ff4f8948]{display:flex;justify-content:flex-end;margin-top:10px}.send-btn[data-v-ff4f8948]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.send-btn[data-v-ff4f8948]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.send-btn[data-v-ff4f8948]:disabled{opacity:.45;cursor:not-allowed}.send-btn[data-v-ff4f8948]{min-width:96px;height:34px}.drawer-hint[data-v-ff4f8948]{margin-top:8px;font-size:11px;color:#8d8d8d}.drawer-enter-active[data-v-ff4f8948],.drawer-leave-active[data-v-ff4f8948]{transition:opacity .16s ease,transform .16s ease}.drawer-enter-from[data-v-ff4f8948],.drawer-leave-to[data-v-ff4f8948]{opacity:0;transform:translateX(-8px)}.menu-cluster.is-left .drawer-enter-from[data-v-ff4f8948],.menu-cluster.is-left .drawer-leave-to[data-v-ff4f8948]{transform:translateX(8px)}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/FunctionMenu.vue\"],\"names\":[],\"mappings\":\"AAAA,iEAAA,CCAwH,+BAAc,cAAe,CAAA,OAAQ,CAAA,aAAc,CAAA,0BAA2B,CAAA,YAAa,CAAA,kBAAmB,CAAA,sBAAuB,CAAA,+BAAc,cAAe,CAAA,YAAa,CAAA,kBAAmB,CAAA,QAAS,CAAA,4BAA6B,CAAA,mBAAoB,CAAA,uCAAsB,0BAA2B,CAAA,6BAAY,WAAY,CAAA,WAAY,CAAA,kBAAmB,CAAA,UAAW,CAAA,gFAAiF,CAAA,iBAAkB,CAAA,wBAAyB,CAAA,sCAAuC,CAAA,kFAAuF,CAAA,qCAAoB,UAAW,CAAA,iBAAkB,CAAA,KAAM,CAAA,MAAO,CAAA,UAAW,CAAA,UAAW,CAAA,kBAAmB,CAAA,SAAU,CAAA,6BAAY,8IAAwJ,CAAA,yBAA0B,CAAA,4BAAW,YAAa,CAAA,kBAAmB,CAAA,6BAA8B,CAAA,iBAAkB,CAAA,mBAAoB,CAAA,2CAA4C,CAAA,8BAAa,iDAAkD,CAAA,aAAc,CAAA,cAAe,CAAA,oBAAqB,CAAA,2BAAU,uBAAgB,CAAhB,eAAgB,CAAA,oCAAqC,CAAA,wBAAyB,CAAA,UAAW,CAAA,iDAAkD,CAAA,eAAgB,CAAA,oBAAqB,CAAA,wBAAyB,CAAA,cAAe,CAAA,kFAAuF,CAAA,sEAAuE,CAAA,gDAA+B,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,oCAAmB,WAAY,CAAA,kBAAmB,CAAA,2BAAU,UAAW,CAAA,WAAY,CAAA,SAAU,CAAA,cAAe,CAAA,aAAc,CAAA,8BAAa,uBAAgB,CAAhB,eAAgB,CAAA,oCAAqC,CAAA,wBAAyB,CAAA,UAAW,CAAA,iDAAkD,CAAA,eAAgB,CAAA,oBAAqB,CAAA,wBAAyB,CAAA,cAAe,CAAA,kFAAuF,CAAA,sEAAuE,CAAA,mDAAkC,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,uCAAsB,WAAY,CAAA,kBAAmB,CAAA,8BAAa,UAAW,CAAA,eAAgB,CAAA,gBAAiB,CAAA,iBAAkB,CAAA,eAAgB,CAAA,YAAa,CAAA,8BAA+B,CAAA,wCAAyC,CAAA,mBAAe,CAAf,cAAe,CAAA,WAAY,CAAA,yCAAwB,eAAgB,CAAA,qCAAoB,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,qCAAoB,gCAAiC,CAAA,aAAc,CAAA,2CAA0B,kBAAmB,CAAA,oBAAqB,CAAA,UAAW,CAAA,gCAAe,aAAc,CAAA,iBAAkB,CAAA,iDAAkD,CAAA,cAAe,CAAA,aAAc,CAAA,+BAAc,cAAe,CAAA,iDAAkD,CAAA,cAAe,CAAA,aAAc,CAAA,8BAAa,aAAc,CAAA,cAAe,CAAA,aAAc,CAAA,mBAAoB,CAAA,8BAAa,6BAA8B,CAAA,0BAA2B,CAAA,YAAa,CAAA,kBAAmB,CAAA,UAAW,CAAA,aAAc,CAAA,iBAAkB,CAAA,wBAAyB,CAAA,sCAAuC,CAAA,kFAAuF,CAAA,sCAAqB,UAAW,CAAA,iBAAkB,CAAA,KAAM,CAAA,MAAO,CAAA,UAAW,CAAA,UAAW,CAAA,kBAAmB,CAAA,SAAU,CAAA,8BAAa,gJAA0J,CAAA,yBAA0B,CAAA,iDAAgC,SAAU,CAAA,UAAW,CAAA,uDAAsC,8BAA+B,CAAA,uDAAsC,eAAgB,CAAA,6DAA4C,kBAAmB,CAAA,8BAAa,YAAa,CAAA,kBAAmB,CAAA,6BAA8B,CAAA,kBAAmB,CAAA,kBAAmB,CAAA,2CAA4C,CAAA,+BAAc,iDAAkD,CAAA,cAAe,CAAA,oBAAqB,CAAA,aAAc,CAAA,+BAAc,uBAAgB,CAAhB,eAAgB,CAAA,oCAAqC,CAAA,wBAAyB,CAAA,UAAW,CAAA,iDAAkD,CAAA,eAAgB,CAAA,oBAAqB,CAAA,wBAAyB,CAAA,cAAe,CAAA,kFAAuF,CAAA,sEAAuE,CAAA,oDAAmC,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,wCAAuB,WAAY,CAAA,kBAAmB,CAAA,+BAAc,UAAW,CAAA,WAAY,CAAA,SAAU,CAAA,cAAe,CAAA,aAAc,CAAA,6BAAY,UAAW,CAAA,qBAAsB,CAAA,gBAAiB,CAAA,wBAAyB,CAAA,+BAAgC,CAAA,eAAgB,CAAA,0BAA2B,CAAA,aAAc,CAAA,+DAAgE,CAAA,cAAe,CAAA,YAAa,CAAA,sDAAuD,CAAA,mCAAkB,oBAAqB,CAAA,8BAA+B,CAAA,0CAAyB,aAAc,CAAA,6BAAY,eAAgB,CAAA,eAAgB,CAAA,UAAW,CAAA,iCAAgB,YAAa,CAAA,wBAAyB,CAAA,eAAgB,CAAA,2BAAU,uBAAgB,CAAhB,eAAgB,CAAA,oCAAqC,CAAA,wBAAyB,CAAA,UAAW,CAAA,iDAAkD,CAAA,eAAgB,CAAA,oBAAqB,CAAA,wBAAyB,CAAA,cAAe,CAAA,kFAAuF,CAAA,sEAAuE,CAAA,gDAA+B,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,oCAAmB,WAAY,CAAA,kBAAmB,CAAA,2BAAU,cAAe,CAAA,WAAY,CAAA,8BAAa,cAAe,CAAA,cAAe,CAAA,aAAc,CAAA,4EAA0C,gDAAiD,CAAA,sEAAoC,SAAU,CAAA,0BAA2B,CAAA,kHAAgF,yBAA0B\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.menu-overlay{position:fixed;inset:0;z-index:10002;background:rgba(0,0,0,.12);display:flex;align-items:center;justify-content:center}.menu-cluster{position:fixed;display:flex;align-items:center;gap:10px;max-width:calc(100vw - 16px);pointer-events:auto}.menu-cluster.is-left{flex-direction:row-reverse}.menu-panel{width:164px;padding:8px;background:#181818;color:#fff;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%)}.menu-panel::before{content:\\\"\\\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.menu-panel{background-image:linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);background-size:20px 20px}.panel-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;padding:4px 4px 8px;border-bottom:1px solid rgba(255,225,0,.35)}.panel-title{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;color:#ffe100;font-size:12px;letter-spacing:.12em}.icon-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.icon-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.icon-btn:disabled{opacity:.45;cursor:not-allowed}.icon-btn{width:28px;height:24px;padding:0;font-size:16px;line-height:1}.command-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.command-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.command-btn:disabled{opacity:.45;cursor:not-allowed}.command-btn{width:100%;min-height:52px;padding:8px 10px;margin-bottom:8px;text-align:left;display:grid;grid-template-columns:auto 1fr;grid-template-areas:\\\"idx main\\\" \\\"idx sub\\\";column-gap:8px;row-gap:2px}.command-btn:last-child{margin-bottom:0}.command-btn.active{background:#ffe100;color:#000;border-color:#ffe100}.command-btn.danger{border-color:rgba(255,59,48,.45);color:#ffc9c5}.command-btn.danger:hover{background:#ff3b30;border-color:#ff3b30;color:#fff}.command-index{grid-area:idx;align-self:center;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:16px;color:#00dac2}.command-main{grid-area:main;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:12px;line-height:1}.command-sub{grid-area:sub;font-size:10px;color:#8d8d8d;text-transform:none}.chat-drawer{width:min(320px,100vw - 36px);max-height:min(68vh,420px);padding:12px;background:#262626;color:#fff;overflow:auto;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%)}.chat-drawer::before{content:\\\"\\\";position:absolute;top:0;left:0;width:56px;height:2px;background:#00dac2;z-index:2}.chat-drawer{background-image:linear-gradient(rgba(255, 255, 255, 0.024) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.024) 1px, transparent 1px);background-size:20px 20px}.chat-drawer::-webkit-scrollbar{width:7px;height:7px}.chat-drawer::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.chat-drawer::-webkit-scrollbar-thumb{background:#555}.chat-drawer::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.drawer-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;padding-bottom:8px;border-bottom:1px solid rgba(0,218,194,.38)}.drawer-title{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:12px;letter-spacing:.12em;color:#00dac2}.drawer-close{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.drawer-close:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.drawer-close:disabled{opacity:.45;cursor:not-allowed}.drawer-close{width:26px;height:24px;padding:0;font-size:16px;line-height:1}.chat-input{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.chat-input:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.chat-input::placeholder{color:#8d8d8d}.chat-input{min-height:96px;resize:vertical;color:#fff}.drawer-actions{display:flex;justify-content:flex-end;margin-top:10px}.send-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.send-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.send-btn:disabled{opacity:.45;cursor:not-allowed}.send-btn{min-width:96px;height:34px}.drawer-hint{margin-top:8px;font-size:11px;color:#8d8d8d}.drawer-enter-active,.drawer-leave-active{transition:opacity .16s ease,transform .16s ease}.drawer-enter-from,.drawer-leave-to{opacity:0;transform:translateX(-8px)}.menu-cluster.is-left .drawer-enter-from,.menu-cluster.is-left .drawer-leave-to{transform:translateX(8px)}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","/**\n * Translates the list format produced by css-loader into something\n * easier to manipulate.\n */\nexport default function listToStyles (parentId, list) {\n  var styles = []\n  var newStyles = {}\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i]\n    var id = item[0]\n    var css = item[1]\n    var media = item[2]\n    var sourceMap = item[3]\n    var part = {\n      id: parentId + ':' + i,\n      css: css,\n      media: media,\n      sourceMap: sourceMap\n    }\n    if (!newStyles[id]) {\n      styles.push(newStyles[id] = { id: id, parts: [part] })\n    } else {\n      newStyles[id].parts.push(part)\n    }\n  }\n  return styles\n}\n","/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n  Modified by Evan You @yyx990803\n*/\n\nimport listToStyles from './listToStyles'\n\nvar hasDocument = typeof document !== 'undefined'\n\nif (typeof DEBUG !== 'undefined' && DEBUG) {\n  if (!hasDocument) {\n    throw new Error(\n    'vue-style-loader cannot be used in a non-browser environment. ' +\n    \"Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.\"\n  ) }\n}\n\n/*\ntype StyleObject = {\n  id: number;\n  parts: Array<StyleObjectPart>\n}\n\ntype StyleObjectPart = {\n  css: string;\n  media: string;\n  sourceMap: ?string\n}\n*/\n\nvar stylesInDom = {/*\n  [id: number]: {\n    id: number,\n    refs: number,\n    parts: Array<(obj?: StyleObjectPart) => void>\n  }\n*/}\n\nvar head = hasDocument && (document.head || document.getElementsByTagName('head')[0])\nvar singletonElement = null\nvar singletonCounter = 0\nvar isProduction = false\nvar noop = function () {}\nvar options = null\nvar ssrIdKey = 'data-vue-ssr-id'\n\n// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n// tags it will allow on a page\nvar isOldIE = typeof navigator !== 'undefined' && /msie [6-9]\\b/.test(navigator.userAgent.toLowerCase())\n\nexport default function addStylesClient (parentId, list, _isProduction, _options) {\n  isProduction = _isProduction\n\n  options = _options || {}\n\n  var styles = listToStyles(parentId, list)\n  addStylesToDom(styles)\n\n  return function update (newList) {\n    var mayRemove = []\n    for (var i = 0; i < styles.length; i++) {\n      var item = styles[i]\n      var domStyle = stylesInDom[item.id]\n      domStyle.refs--\n      mayRemove.push(domStyle)\n    }\n    if (newList) {\n      styles = listToStyles(parentId, newList)\n      addStylesToDom(styles)\n    } else {\n      styles = []\n    }\n    for (var i = 0; i < mayRemove.length; i++) {\n      var domStyle = mayRemove[i]\n      if (domStyle.refs === 0) {\n        for (var j = 0; j < domStyle.parts.length; j++) {\n          domStyle.parts[j]()\n        }\n        delete stylesInDom[domStyle.id]\n      }\n    }\n  }\n}\n\nfunction addStylesToDom (styles /* Array<StyleObject> */) {\n  for (var i = 0; i < styles.length; i++) {\n    var item = styles[i]\n    var domStyle = stylesInDom[item.id]\n    if (domStyle) {\n      domStyle.refs++\n      for (var j = 0; j < domStyle.parts.length; j++) {\n        domStyle.parts[j](item.parts[j])\n      }\n      for (; j < item.parts.length; j++) {\n        domStyle.parts.push(addStyle(item.parts[j]))\n      }\n      if (domStyle.parts.length > item.parts.length) {\n        domStyle.parts.length = item.parts.length\n      }\n    } else {\n      var parts = []\n      for (var j = 0; j < item.parts.length; j++) {\n        parts.push(addStyle(item.parts[j]))\n      }\n      stylesInDom[item.id] = { id: item.id, refs: 1, parts: parts }\n    }\n  }\n}\n\nfunction createStyleElement () {\n  var styleElement = document.createElement('style')\n  styleElement.type = 'text/css'\n  head.appendChild(styleElement)\n  return styleElement\n}\n\nfunction addStyle (obj /* StyleObjectPart */) {\n  var update, remove\n  var styleElement = document.querySelector('style[' + ssrIdKey + '~=\"' + obj.id + '\"]')\n\n  if (styleElement) {\n    if (isProduction) {\n      // has SSR styles and in production mode.\n      // simply do nothing.\n      return noop\n    } else {\n      // has SSR styles but in dev mode.\n      // for some reason Chrome can't handle source map in server-rendered\n      // style tags - source maps in <style> only works if the style tag is\n      // created and inserted dynamically. So we remove the server rendered\n      // styles and inject new ones.\n      styleElement.parentNode.removeChild(styleElement)\n    }\n  }\n\n  if (isOldIE) {\n    // use singleton mode for IE9.\n    var styleIndex = singletonCounter++\n    styleElement = singletonElement || (singletonElement = createStyleElement())\n    update = applyToSingletonTag.bind(null, styleElement, styleIndex, false)\n    remove = applyToSingletonTag.bind(null, styleElement, styleIndex, true)\n  } else {\n    // use multi-style-tag mode in all other cases\n    styleElement = createStyleElement()\n    update = applyToTag.bind(null, styleElement)\n    remove = function () {\n      styleElement.parentNode.removeChild(styleElement)\n    }\n  }\n\n  update(obj)\n\n  return function updateStyle (newObj /* StyleObjectPart */) {\n    if (newObj) {\n      if (newObj.css === obj.css &&\n          newObj.media === obj.media &&\n          newObj.sourceMap === obj.sourceMap) {\n        return\n      }\n      update(obj = newObj)\n    } else {\n      remove()\n    }\n  }\n}\n\nvar replaceText = (function () {\n  var textStore = []\n\n  return function (index, replacement) {\n    textStore[index] = replacement\n    return textStore.filter(Boolean).join('\\n')\n  }\n})()\n\nfunction applyToSingletonTag (styleElement, index, remove, obj) {\n  var css = remove ? '' : obj.css\n\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = replaceText(index, css)\n  } else {\n    var cssNode = document.createTextNode(css)\n    var childNodes = styleElement.childNodes\n    if (childNodes[index]) styleElement.removeChild(childNodes[index])\n    if (childNodes.length) {\n      styleElement.insertBefore(cssNode, childNodes[index])\n    } else {\n      styleElement.appendChild(cssNode)\n    }\n  }\n}\n\nfunction applyToTag (styleElement, obj) {\n  var css = obj.css\n  var media = obj.media\n  var sourceMap = obj.sourceMap\n\n  if (media) {\n    styleElement.setAttribute('media', media)\n  }\n  if (options.ssrId) {\n    styleElement.setAttribute(ssrIdKey, obj.id)\n  }\n\n  if (sourceMap) {\n    // https://developer.chrome.com/devtools/docs/javascript-debugging\n    // this makes source maps inside style tags work properly in Chrome\n    css += '\\n/*# sourceURL=' + sourceMap.sources[0] + ' */'\n    // http://stackoverflow.com/a/26603875\n    css += '\\n/*# sourceMappingURL=data:application/json;base64,' + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + ' */'\n  }\n\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = css\n  } else {\n    while (styleElement.firstChild) {\n      styleElement.removeChild(styleElement.firstChild)\n    }\n    styleElement.appendChild(document.createTextNode(css))\n  }\n}\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.browser-overlay[data-v-9229b8c6]{position:fixed;inset:0;z-index:10003;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.browser-dialog[data-v-9229b8c6]{width:min(980px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0,100% 0,100% calc(100% - 12px),calc(100% - 12px) 100%,0 100%)}.browser-dialog[data-v-9229b8c6]::before{content:\"\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.browser-dialog[data-v-9229b8c6]{background-image:linear-gradient(rgba(255,255,255,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.03) 1px,transparent 1px);background-size:22px 22px}.browser-dialog-header[data-v-9229b8c6]{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 18px;border-bottom:1px solid rgba(255,225,0,.36);background:rgba(0,0,0,.28)}.browser-dialog-header h3[data-v-9229b8c6]{margin:0;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:15px;letter-spacing:.08em}.browser-dialog-header .close-btn[data-v-9229b8c6]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.browser-dialog-header .close-btn[data-v-9229b8c6]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.browser-dialog-header .close-btn[data-v-9229b8c6]:disabled{opacity:.45;cursor:not-allowed}.browser-dialog-header .close-btn[data-v-9229b8c6]{width:34px;height:28px;padding:0;line-height:1;font-size:16px}.browser-dialog-body[data-v-9229b8c6]{padding:14px 18px 16px;overflow:auto;flex:1}.browser-dialog-body[data-v-9229b8c6]::-webkit-scrollbar{width:7px;height:7px}.browser-dialog-body[data-v-9229b8c6]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.browser-dialog-body[data-v-9229b8c6]::-webkit-scrollbar-thumb{background:#555}.browser-dialog-body[data-v-9229b8c6]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}@media (max-width:860px){.browser-overlay[data-v-9229b8c6]{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.browser-dialog[data-v-9229b8c6]{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}}@media (max-width:620px){.browser-overlay[data-v-9229b8c6]{align-items:stretch;padding:0}.browser-dialog[data-v-9229b8c6]{width:100vw;max-height:100dvh;box-shadow:none;clip-path:none;border-left:none;border-right:none}.browser-dialog-header[data-v-9229b8c6]{padding:12px}.browser-dialog-body[data-v-9229b8c6]{padding:10px 12px 12px}}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/PetContainer.vue\"],\"names\":[],\"mappings\":\"AAAA,iEAAA,CCAwH,kCAAiB,cAAe,CAAA,OAAQ,CAAA,aAAc,CAAA,yBAA0B,CAAA,YAAa,CAAA,kBAAmB,CAAA,sBAAuB,CAAA,YAAa,CAAA,qBAAsB,CAAA,aAAc,CAAA,iCAAgB,6BAA8B,CAAA,8BAA+B,CAAA,YAAa,CAAA,qBAAsB,CAAA,eAAgB,CAAA,UAAW,CAAA,kBAAmB,CAAA,gFAAiF,CAAA,iBAAkB,CAAA,wBAAyB,CAAA,sCAAuC,CAAA,kFAAuF,CAAA,yCAAwB,UAAW,CAAA,iBAAkB,CAAA,KAAM,CAAA,MAAO,CAAA,UAAW,CAAA,UAAW,CAAA,kBAAmB,CAAA,SAAU,CAAA,iCAAgB,8IAAwJ,CAAA,yBAA0B,CAAA,wCAAuB,YAAa,CAAA,kBAAmB,CAAA,6BAA8B,CAAA,QAAS,CAAA,iBAAkB,CAAA,2CAA4C,CAAA,0BAA2B,CAAA,2CAA0B,QAAS,CAAA,iDAAkD,CAAA,cAAe,CAAA,oBAAqB,CAAA,mDAAkC,uBAAgB,CAAhB,eAAgB,CAAA,oCAAqC,CAAA,wBAAyB,CAAA,UAAW,CAAA,iDAAkD,CAAA,eAAgB,CAAA,oBAAqB,CAAA,wBAAyB,CAAA,cAAe,CAAA,kFAAuF,CAAA,sEAAuE,CAAA,wEAAuD,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,4DAA2C,WAAY,CAAA,kBAAmB,CAAA,mDAAkC,UAAW,CAAA,WAAY,CAAA,SAAU,CAAA,aAAc,CAAA,cAAe,CAAA,sCAAqB,sBAAuB,CAAA,aAAc,CAAA,MAAO,CAAA,yDAAwC,SAAU,CAAA,UAAW,CAAA,+DAA8C,8BAA+B,CAAA,+DAA8C,eAAgB,CAAA,qEAAoD,kBAAmB,CAAA,yBAAyB,kCAAiB,sBAAuB,CAAA,wFAAyF,CAAA,iCAAgB,UAAW,CAAA,uFAAwF,CAAA,cAAe,CAAA,wCAAyC,CAAC,CAAA,yBAAyB,kCAAiB,mBAAoB,CAAA,SAAU,CAAA,iCAAgB,WAAY,CAAA,iBAAkB,CAAA,eAAgB,CAAA,cAAe,CAAA,gBAAiB,CAAA,iBAAkB,CAAA,wCAAuB,YAAa,CAAA,sCAAqB,sBAAuB,CAAC\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.browser-overlay{position:fixed;inset:0;z-index:10003;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.browser-dialog{width:min(980px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%)}.browser-dialog::before{content:\\\"\\\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.browser-dialog{background-image:linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);background-size:22px 22px}.browser-dialog-header{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 18px;border-bottom:1px solid rgba(255,225,0,.36);background:rgba(0,0,0,.28)}.browser-dialog-header h3{margin:0;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:15px;letter-spacing:.08em}.browser-dialog-header .close-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.browser-dialog-header .close-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.browser-dialog-header .close-btn:disabled{opacity:.45;cursor:not-allowed}.browser-dialog-header .close-btn{width:34px;height:28px;padding:0;line-height:1;font-size:16px}.browser-dialog-body{padding:14px 18px 16px;overflow:auto;flex:1}.browser-dialog-body::-webkit-scrollbar{width:7px;height:7px}.browser-dialog-body::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.browser-dialog-body::-webkit-scrollbar-thumb{background:#555}.browser-dialog-body::-webkit-scrollbar-thumb:hover{background:#6f6f6f}@media(max-width: 860px){.browser-overlay{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.browser-dialog{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}}@media(max-width: 620px){.browser-overlay{align-items:stretch;padding:0}.browser-dialog{width:100vw;max-height:100dvh;box-shadow:none;clip-path:none;border-left:none;border-right:none}.browser-dialog-header{padding:12px}.browser-dialog-body{padding:10px 12px 12px}}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./SettingsPanel.vue?vue&type=style&index=0&id=64a4f085&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"4a73c08c\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./SettingsPanel.vue?vue&type=style&index=0&id=64a4f085&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./SettingsPanel.vue?vue&type=style&index=0&id=64a4f085&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./PetContainer.vue?vue&type=style&index=0&id=9229b8c6&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"51b2fb61\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./PetContainer.vue?vue&type=style&index=0&id=9229b8c6&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./PetContainer.vue?vue&type=style&index=0&id=9229b8c6&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./TreeNode.vue?vue&type=style&index=0&id=3a6a95ba&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"bd0944e8\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./TreeNode.vue?vue&type=style&index=0&id=3a6a95ba&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./TreeNode.vue?vue&type=style&index=0&id=3a6a95ba&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.chat-bubble[data-v-98097aea]{position:fixed;transform:translate(-50%,-100%);max-width:320px;min-width:80px;animation:bubble-in-98097aea .22s ease-out;z-index:10004;pointer-events:none}.bubble-content[data-v-98097aea]{position:relative;background:rgba(14,14,14,.96);color:#fff;border:1px solid #ffe100;padding:9px 26px 10px 13px;clip-path:polygon(10px 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%,0 10px);font-size:12px;line-height:1.5;word-break:break-word;box-shadow:8px 8px 0 rgba(0,0,0,.56);font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif;pointer-events:auto}.bubble-content[data-v-98097aea]::after{content:\"\";position:absolute;right:22px;bottom:-2px;width:30px;height:3px;background:#ffe100}.bubble-text[data-v-98097aea]{white-space:pre-wrap}.cursor[data-v-98097aea]{animation:blink-98097aea .64s infinite;margin-left:1px;color:#00dac2}.bubble-close[data-v-98097aea]{position:absolute;right:6px;top:5px;width:15px;height:15px;border:1px solid hsla(0,0%,100%,.3);background:hsla(0,0%,100%,.08);color:#fff;line-height:13px;text-align:center;cursor:pointer;font-size:10px;padding:0;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif}.bubble-close[data-v-98097aea]:hover{background:#ff3b30;border-color:#ff3b30}.bubble-arrow[data-v-98097aea]{width:11px;height:11px;background:rgba(14,14,14,.96);border-left:1px solid #ffe100;border-bottom:1px solid #ffe100;transform:rotate(-45deg);margin:0 auto;margin-top:-6px}@keyframes bubble-in-98097aea{from{opacity:0;transform:translateX(-50%) translateY(8px) scale(0.9)}to{opacity:1;transform:translateX(-50%) translateY(0) scale(1)}}@keyframes blink-98097aea{0%,50%{opacity:1}51%,100%{opacity:0}}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/ChatBubble.vue\"],\"names\":[],\"mappings\":\"AAAA,iEAAA,CCAwH,8BAAa,cAAe,CAAA,+BAAiC,CAAA,eAAgB,CAAA,cAAe,CAAA,0CAAkC,CAAA,aAAc,CAAA,mBAAoB,CAAA,iCAAgB,iBAAkB,CAAA,6BAA8B,CAAA,UAAW,CAAA,wBAAyB,CAAA,0BAA2B,CAAA,4FAAkG,CAAA,cAAe,CAAA,eAAgB,CAAA,qBAAsB,CAAA,oCAAqC,CAAA,gFAAiF,CAAA,mBAAoB,CAAA,wCAAuB,UAAW,CAAA,iBAAkB,CAAA,UAAW,CAAA,WAAY,CAAA,UAAW,CAAA,UAAW,CAAA,kBAAmB,CAAA,8BAAa,oBAAqB,CAAA,yBAAQ,sCAA8B,CAAA,eAAgB,CAAA,aAAc,CAAA,+BAAc,iBAAkB,CAAA,SAAU,CAAA,OAAQ,CAAA,UAAW,CAAA,WAAY,CAAA,mCAAoC,CAAA,8BAA+B,CAAA,UAAW,CAAA,gBAAiB,CAAA,iBAAkB,CAAA,cAAe,CAAA,cAAe,CAAA,SAAU,CAAA,iDAAkD,CAAA,qCAAoB,kBAAmB,CAAA,oBAAqB,CAAA,+BAAc,UAAW,CAAA,WAAY,CAAA,6BAA8B,CAAA,6BAA8B,CAAA,+BAAgC,CAAA,wBAAyB,CAAA,aAAc,CAAA,eAAgB,CAAA,8BAAqB,KAAK,SAAU,CAAA,qDAAsD,CAAA,GAAG,SAAU,CAAA,iDAAkD,CAAC,CAAA,0BAAiB,OAAO,SAAU,CAAA,SAAS,SAAU,CAAC\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.chat-bubble{position:fixed;transform:translate(-50%, -100%);max-width:320px;min-width:80px;animation:bubble-in .22s ease-out;z-index:10004;pointer-events:none}.bubble-content{position:relative;background:rgba(14,14,14,.96);color:#fff;border:1px solid #ffe100;padding:9px 26px 10px 13px;clip-path:polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);font-size:12px;line-height:1.5;word-break:break-word;box-shadow:8px 8px 0 rgba(0,0,0,.56);font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif;pointer-events:auto}.bubble-content::after{content:\\\"\\\";position:absolute;right:22px;bottom:-2px;width:30px;height:3px;background:#ffe100}.bubble-text{white-space:pre-wrap}.cursor{animation:blink .64s infinite;margin-left:1px;color:#00dac2}.bubble-close{position:absolute;right:6px;top:5px;width:15px;height:15px;border:1px solid hsla(0,0%,100%,.3);background:hsla(0,0%,100%,.08);color:#fff;line-height:13px;text-align:center;cursor:pointer;font-size:10px;padding:0;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif}.bubble-close:hover{background:#ff3b30;border-color:#ff3b30}.bubble-arrow{width:11px;height:11px;background:rgba(14,14,14,.96);border-left:1px solid #ffe100;border-bottom:1px solid #ffe100;transform:rotate(-45deg);margin:0 auto;margin-top:-6px}@keyframes bubble-in{from{opacity:0;transform:translateX(-50%) translateY(8px) scale(0.9)}to{opacity:1;transform:translateX(-50%) translateY(0) scale(1)}}@keyframes blink{0%,50%{opacity:1}51%,100%{opacity:0}}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.settings-overlay[data-v-64a4f085]{position:fixed;inset:0;z-index:10001;background:rgba(0,0,0,.82);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.settings-panel[data-v-64a4f085]{width:min(1080px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0,100% 0,100% calc(100% - 12px),calc(100% - 12px) 100%,0 100%)}.settings-panel[data-v-64a4f085]::before{content:\"\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.settings-panel[data-v-64a4f085]{background-image:linear-gradient(rgba(255,255,255,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.03) 1px,transparent 1px);background-size:22px 22px}.panel-header[data-v-64a4f085]{display:flex;align-items:center;justify-content:space-between;gap:14px;padding:14px 18px;border-bottom:2px solid #ffe100;background:rgba(0,0,0,.32)}.header-title[data-v-64a4f085]{min-width:0}.header-title h3[data-v-64a4f085]{margin:0;font-size:20px;line-height:1;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase}.header-title p[data-v-64a4f085]{margin:4px 0 0;font-size:10px;color:#8d8d8d;letter-spacing:.14em;text-transform:uppercase}.close-btn[data-v-64a4f085]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.close-btn[data-v-64a4f085]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.close-btn[data-v-64a4f085]:disabled{opacity:.45;cursor:not-allowed}.close-btn[data-v-64a4f085]{min-width:88px;height:32px;padding:0 10px;font-size:12px}.panel-main[data-v-64a4f085]{flex:1;min-height:0;display:grid;grid-template-columns:220px 1fr}.panel-nav[data-v-64a4f085]{border-right:1px solid hsla(0,0%,100%,.16);padding:12px;overflow:auto}.panel-nav[data-v-64a4f085]::-webkit-scrollbar{width:7px;height:7px}.panel-nav[data-v-64a4f085]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-nav[data-v-64a4f085]::-webkit-scrollbar-thumb{background:#555}.panel-nav[data-v-64a4f085]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.nav-btn[data-v-64a4f085]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.nav-btn[data-v-64a4f085]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.nav-btn[data-v-64a4f085]:disabled{opacity:.45;cursor:not-allowed}.nav-btn[data-v-64a4f085]{width:100%;min-height:62px;padding:10px 12px;margin-bottom:10px;text-align:left;display:grid;grid-template-columns:auto 1fr;grid-template-areas:\"idx label\" \"idx sub\";-moz-column-gap:8px;column-gap:8px;row-gap:2px}.nav-btn[data-v-64a4f085]:last-child{margin-bottom:0}.nav-btn.active[data-v-64a4f085]{background:#ffe100;color:#000;border-color:#ffe100}.nav-index[data-v-64a4f085]{grid-area:idx;align-self:center;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;color:#00dac2;font-size:18px}.nav-label[data-v-64a4f085]{grid-area:label;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:13px;letter-spacing:.05em}.nav-sub[data-v-64a4f085]{grid-area:sub;font-size:10px;color:#8d8d8d;letter-spacing:.06em}.panel-body[data-v-64a4f085]{padding:14px 18px 16px;overflow:auto}.panel-body[data-v-64a4f085]::-webkit-scrollbar{width:7px;height:7px}.panel-body[data-v-64a4f085]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-body[data-v-64a4f085]::-webkit-scrollbar-thumb{background:#555}.panel-body[data-v-64a4f085]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.setting-section[data-v-64a4f085]{max-width:740px}.setting-section h4[data-v-64a4f085]{margin:0 0 12px;display:inline-flex;align-items:center;gap:8px;padding:4px 12px;background:#0f0f0f;border-left:4px solid #ffe100;transform:skewX(-14deg)}.setting-section h4[data-v-64a4f085]>*{transform:skewX(14deg)}.section-index[data-v-64a4f085]{color:#00dac2;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:13px}.section-label[data-v-64a4f085]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:14px;letter-spacing:.04em}.section-sub[data-v-64a4f085]{font-size:10px;color:#8d8d8d;letter-spacing:.06em}.form-group[data-v-64a4f085]{margin-bottom:12px}.form-group>label[data-v-64a4f085]{display:block;margin-bottom:5px;font-size:12px;color:#d5d5d5;line-height:1.35}.form-group>label>input[type=checkbox][data-v-64a4f085]{margin-right:8px;accent-color:#00dac2}.form-group input[type=text][data-v-64a4f085],.form-group input[type=password][data-v-64a4f085],.form-group input[type=number][data-v-64a4f085],.form-group select[data-v-64a4f085],.form-group textarea[data-v-64a4f085]{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.form-group input[type=text][data-v-64a4f085]:focus,.form-group input[type=password][data-v-64a4f085]:focus,.form-group input[type=number][data-v-64a4f085]:focus,.form-group select[data-v-64a4f085]:focus,.form-group textarea[data-v-64a4f085]:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.form-group input[type=text][data-v-64a4f085]::placeholder,.form-group input[type=password][data-v-64a4f085]::placeholder,.form-group input[type=number][data-v-64a4f085]::placeholder,.form-group select[data-v-64a4f085]::placeholder,.form-group textarea[data-v-64a4f085]::placeholder{color:#8d8d8d}.form-group textarea[data-v-64a4f085]{resize:vertical;min-height:86px;font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;color:#fff}.form-group select[data-v-64a4f085]{color:#fff;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif}.form-group select option[data-v-64a4f085]{background:#101010;color:#fff}.form-group input[type=range][data-v-64a4f085]{width:100%;-webkit-appearance:none;appearance:none;height:4px;border:none;background:#4a4a4a;border-radius:0;padding:0;margin:7px 0 4px}.form-group input[type=range][data-v-64a4f085]::-webkit-slider-thumb{-webkit-appearance:none;width:12px;height:12px;background:#ffe100;border:2px solid #000;transform:rotate(45deg)}.form-group input[type=range][data-v-64a4f085]::-moz-range-thumb{width:12px;height:12px;border:2px solid #000;border-radius:0;background:#ffe100;transform:rotate(45deg)}.form-group input[type=range][data-v-64a4f085]::-moz-range-track{height:4px;background:#4a4a4a;border:none}.form-group input[type=checkbox][data-v-64a4f085]{accent-color:#00dac2}.form-group .hint[data-v-64a4f085]{margin-top:4px;font-size:11px;color:#8d8d8d}.hint-error[data-v-64a4f085]{color:#ff3b30 !important}.form-row[data-v-64a4f085]{display:flex;gap:12px;align-items:flex-start}.form-row .half[data-v-64a4f085]{flex:1;min-width:0}.dice-sheet-list[data-v-64a4f085]{margin-top:6px;display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:8px}.dice-sheet-item[data-v-64a4f085]{display:flex;align-items:center;gap:8px;padding:6px 8px;border:1px solid hsla(0,0%,100%,.18);background:hsla(0,0%,100%,.04);font-size:12px;color:#e8e8e8;line-height:1.35}.dice-sheet-item input[type=checkbox][data-v-64a4f085]{margin:0}.input-with-btn[data-v-64a4f085]{display:grid;grid-template-columns:1fr auto;gap:8px;align-items:stretch}.input-with-btn .input-btn[data-v-64a4f085]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.input-with-btn .input-btn[data-v-64a4f085]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.input-with-btn .input-btn[data-v-64a4f085]:disabled{opacity:.45;cursor:not-allowed}.input-with-btn .input-btn[data-v-64a4f085]{min-width:84px;padding:0 12px;font-size:11px;white-space:nowrap}.model-list[data-v-64a4f085]{display:flex;flex-wrap:wrap;gap:8px}.hidden-file-input[data-v-64a4f085]{display:none}.local-model-info[data-v-64a4f085]{margin-top:6px;padding:8px 10px;border:1px solid hsla(0,0%,100%,.16);background:hsla(0,0%,100%,.04);font-size:12px;line-height:1.45;color:#e8e8e8}.model-btn[data-v-64a4f085]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.model-btn[data-v-64a4f085]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.model-btn[data-v-64a4f085]:disabled{opacity:.45;cursor:not-allowed}.model-btn[data-v-64a4f085]{min-height:30px;padding:0 12px;font-size:12px;text-transform:none;letter-spacing:.03em}.model-btn.active[data-v-64a4f085]{background:#ffe100;border-color:#ffe100;color:#000}.model-btn.browse-btn[data-v-64a4f085]{border-color:rgba(0,218,194,.55);color:#b2fff6}.model-btn.browse-btn[data-v-64a4f085]:hover{background:#00dac2;border-color:#00dac2;color:#000}.emotion-layout[data-v-64a4f085]{display:grid;grid-template-columns:minmax(0,1fr) 340px;gap:14px;align-items:start}.emotion-configs[data-v-64a4f085]{min-width:0}.emotion-preview-panel[data-v-64a4f085]{position:sticky;top:10px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.28);padding:10px 12px 12px;background-image:linear-gradient(rgba(255,255,255,0.02) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.02) 1px,transparent 1px);background-size:18px 18px}.emotion-preview-header[data-v-64a4f085]{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:10px}.emotion-preview-title[data-v-64a4f085]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:700;letter-spacing:.08em;color:#00dac2}.emotion-preview-tag[data-v-64a4f085]{font-size:12px;color:hsla(0,0%,100%,.78)}.emotion-preview-canvas[data-v-64a4f085]{position:relative;width:100%;aspect-ratio:3/4;border-radius:10px;overflow:hidden;background:rgba(15,23,42,.95);border:1px solid hsla(0,0%,100%,.18)}.emotion-preview-interact[data-v-64a4f085]{position:absolute;inset:0;z-index:3}.emotion-preview-empty[data-v-64a4f085]{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;padding:10px;text-align:center;z-index:4;pointer-events:none;color:hsla(0,0%,100%,.78);font-size:12px}.emotion-preview-controls[data-v-64a4f085]{margin-top:10px;display:flex;flex-direction:column;gap:8px}.emotion-zoom-row[data-v-64a4f085]{display:grid;grid-template-columns:auto 1fr auto;gap:10px;align-items:center}.zoom-label[data-v-64a4f085]{font-size:12px;color:hsla(0,0%,100%,.78)}.zoom-value[data-v-64a4f085]{font-size:12px;color:#ffe100;font-variant-numeric:tabular-nums}.emotion-preview-actions[data-v-64a4f085]{display:flex;gap:8px}.emotion-tag[data-v-64a4f085]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:700;letter-spacing:.08em;color:#ffe100;text-transform:uppercase}.emotion-map-table[data-v-64a4f085]{margin-top:4px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.22);max-height:none;overflow:visible;background-image:linear-gradient(rgba(255,255,255,0.02) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.02) 1px,transparent 1px);background-size:20px 20px}.emotion-map-head[data-v-64a4f085],.emotion-map-row[data-v-64a4f085]{display:grid;grid-template-columns:72px 22px minmax(0,1fr) minmax(0,1fr) 52px;gap:10px;align-items:center}.emotion-map-head[data-v-64a4f085]{position:sticky;top:0;z-index:2;padding:8px 10px;font-size:10px;color:hsla(0,0%,100%,.68);letter-spacing:.03em;background:rgba(2,8,20,.92);border-bottom:1px solid hsla(0,0%,100%,.2)}.emotion-map-row[data-v-64a4f085]{padding:10px;border-bottom:1px solid hsla(0,0%,100%,.12)}.emotion-map-row[data-v-64a4f085]:nth-child(odd){background:hsla(0,0%,100%,.02)}.emotion-map-tag[data-v-64a4f085]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:700;letter-spacing:.08em;color:#ffe100}.emotion-map-arrow[data-v-64a4f085]{text-align:center;color:hsla(0,0%,100%,.78);font-size:18px;line-height:1}.emotion-map-preview-btn[data-v-64a4f085]{min-width:0;width:44px;height:32px;padding:0;font-size:14px;line-height:1}.emotion-map-row select[data-v-64a4f085]{width:100%;min-width:0;text-overflow:ellipsis;white-space:nowrap}.emotion-advanced-list[data-v-64a4f085]{margin-top:10px;display:flex;flex-direction:column;gap:10px}.emotion-advanced-item[data-v-64a4f085]{border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.28);padding:10px 12px 2px;background-image:linear-gradient(rgba(255,255,255,0.025) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.025) 1px,transparent 1px);background-size:18px 18px}.emotion-advanced-title[data-v-64a4f085]{margin-bottom:8px;font-size:12px;letter-spacing:.06em;color:hsla(0,0%,100%,.85)}.advanced-toggle[data-v-64a4f085]{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border:1px solid hsla(0,0%,100%,.2);background:hsla(0,0%,100%,.04);font-size:11px;color:#d5d5d5;cursor:pointer;-webkit-user-select:none;user-select:none;clip-path:polygon(0 0,100% 0,100% calc(100% - 8px),calc(100% - 8px) 100%,0 100%)}.advanced-toggle[data-v-64a4f085]:hover{border-color:rgba(255,225,0,.65);color:#ffe100}.advanced-toggle .toggle-icon[data-v-64a4f085]{width:12px;text-align:center;color:#00dac2}.advanced-params[data-v-64a4f085]{margin-top:8px;padding-top:10px;border-top:1px dashed hsla(0,0%,100%,.2)}.about-card[data-v-64a4f085]{margin-bottom:12px;padding:10px 12px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.26);background-image:linear-gradient(rgba(255,255,255,0.02) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.02) 1px,transparent 1px);background-size:18px 18px}.about-title[data-v-64a4f085]{margin-bottom:8px;font-size:12px;letter-spacing:.06em;color:#ffe100}.about-link[data-v-64a4f085]{color:#00dac2;word-break:break-all;text-decoration:underline}.about-list[data-v-64a4f085]{margin:0;padding-left:18px;display:flex;flex-direction:column;gap:8px;font-size:12px;line-height:1.5;color:#d5d5d5}.status-badge[data-v-64a4f085]{margin-left:8px;font-size:12px}.status-success[data-v-64a4f085]{color:#00dac2}.status-fail[data-v-64a4f085]{color:#ff9c94}.panel-footer[data-v-64a4f085]{display:flex;justify-content:flex-end;gap:10px;padding:12px 18px 14px;border-top:1px solid hsla(0,0%,100%,.18);background:rgba(0,0,0,.36)}.btn[data-v-64a4f085]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.btn[data-v-64a4f085]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.btn[data-v-64a4f085]:disabled{opacity:.45;cursor:not-allowed}.btn[data-v-64a4f085]{min-width:100px;height:34px;padding:0 14px;font-size:12px}.btn-primary[data-v-64a4f085]{background:#ffe100;color:#000;border-color:#ffe100}.btn-secondary[data-v-64a4f085]{background:hsla(0,0%,100%,.06);border-color:hsla(0,0%,100%,.3)}.btn-test[data-v-64a4f085]{min-width:96px;background:rgba(0,218,194,.1);border-color:rgba(0,218,194,.6);color:#bcfff7}.btn-test[data-v-64a4f085]:hover:not(:disabled){background:#00dac2;border-color:#00dac2;color:#000}.browser-overlay[data-v-64a4f085]{position:fixed;inset:0;z-index:10002;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.browser-dialog[data-v-64a4f085]{width:min(980px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0,100% 0,100% calc(100% - 12px),calc(100% - 12px) 100%,0 100%)}.browser-dialog[data-v-64a4f085]::before{content:\"\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.browser-dialog[data-v-64a4f085]{background-image:linear-gradient(rgba(255,255,255,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.03) 1px,transparent 1px);background-size:22px 22px}.browser-dialog-header[data-v-64a4f085]{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 18px;border-bottom:1px solid rgba(255,225,0,.36);background:rgba(0,0,0,.28)}.browser-dialog-header h3[data-v-64a4f085]{margin:0;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:15px;letter-spacing:.08em}.browser-dialog-header .close-btn[data-v-64a4f085]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.browser-dialog-header .close-btn[data-v-64a4f085]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.browser-dialog-header .close-btn[data-v-64a4f085]:disabled{opacity:.45;cursor:not-allowed}.browser-dialog-header .close-btn[data-v-64a4f085]{width:34px;height:28px;padding:0;line-height:1;font-size:16px}.browser-dialog-body[data-v-64a4f085]{padding:14px 18px 16px;overflow:auto;flex:1}.browser-dialog-body[data-v-64a4f085]::-webkit-scrollbar{width:7px;height:7px}.browser-dialog-body[data-v-64a4f085]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.browser-dialog-body[data-v-64a4f085]::-webkit-scrollbar-thumb{background:#555}.browser-dialog-body[data-v-64a4f085]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.gpt-model-dialog[data-v-64a4f085]{width:min(1240px,100vw - 24px)}.gpt-model-editor-dialog[data-v-64a4f085]{width:min(1080px,100vw - 24px)}.gpt-model-header[data-v-64a4f085]{align-items:flex-start}.gpt-model-header-actions[data-v-64a4f085]{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end;align-items:center}.gpt-model-header-actions .btn[data-v-64a4f085]{min-width:84px;height:30px;padding:0 10px;font-size:11px}.gpt-model-body[data-v-64a4f085]{display:flex;flex-direction:column;gap:10px}.gpt-model-tools[data-v-64a4f085]{display:grid;grid-template-columns:minmax(0,1fr) auto auto;gap:8px;align-items:center}.gpt-model-tools input[data-v-64a4f085]{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.gpt-model-tools input[data-v-64a4f085]:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.gpt-model-tools input[data-v-64a4f085]::placeholder{color:#8d8d8d}.gpt-model-card-list[data-v-64a4f085]{display:flex;flex-direction:column;gap:10px}.gpt-model-card[data-v-64a4f085]{border:1px solid hsla(0,0%,100%,.18);background:hsla(0,0%,100%,.03);padding:10px 12px;background-image:linear-gradient(rgba(255,255,255,0.02) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.02) 1px,transparent 1px);background-size:18px 18px}.gpt-model-card-head[data-v-64a4f085]{display:flex;align-items:center;justify-content:space-between;gap:10px}.gpt-model-card-head label[data-v-64a4f085]{display:inline-flex;align-items:center;gap:8px;font-size:12px}.gpt-model-id[data-v-64a4f085]{font-size:11px;color:hsla(0,0%,100%,.65);font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;word-break:break-all}.gpt-model-card-actions[data-v-64a4f085]{margin-top:6px;display:flex;flex-wrap:wrap;gap:8px}.gpt-model-card-actions .btn[data-v-64a4f085]{min-width:110px}.gpt-ref-list[data-v-64a4f085]{display:flex;flex-direction:column;gap:10px;margin-bottom:8px}.gpt-ref-item[data-v-64a4f085]{border:1px solid hsla(0,0%,100%,.16);background:hsla(0,0%,100%,.02);padding:10px}.gpt-ref-actions[data-v-64a4f085]{display:flex;gap:8px;align-items:flex-end;flex-wrap:wrap}.gpt-expression-map-list[data-v-64a4f085]{display:flex;flex-direction:column;gap:8px;margin-bottom:8px}.gpt-expression-map-row[data-v-64a4f085]{display:grid;grid-template-columns:minmax(0,1fr) minmax(0,1fr) auto;gap:8px;align-items:center}.gpt-expression-map-row input[data-v-64a4f085],.gpt-expression-map-row select[data-v-64a4f085]{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.gpt-expression-map-row input[data-v-64a4f085]:focus,.gpt-expression-map-row select[data-v-64a4f085]:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.gpt-expression-map-row input[data-v-64a4f085]::placeholder,.gpt-expression-map-row select[data-v-64a4f085]::placeholder{color:#8d8d8d}.gpt-expression-map-row input[data-v-64a4f085],.gpt-expression-map-row select[data-v-64a4f085]{width:100%}@media (max-width:860px){.settings-overlay[data-v-64a4f085]{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.settings-panel[data-v-64a4f085]{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}.settings-panel[data-v-64a4f085]::before{width:40px}.panel-main[data-v-64a4f085]{grid-template-columns:1fr;grid-template-rows:auto 1fr;min-height:0}.panel-nav[data-v-64a4f085]{border-right:none;border-bottom:1px solid hsla(0,0%,100%,.16);display:flex;gap:6px;padding:8px 10px;overflow-x:auto;overflow-y:hidden}.panel-nav[data-v-64a4f085]::-webkit-scrollbar{width:7px;height:7px}.panel-nav[data-v-64a4f085]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-nav[data-v-64a4f085]::-webkit-scrollbar-thumb{background:#555}.panel-nav[data-v-64a4f085]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.nav-btn[data-v-64a4f085]{flex:0 0 auto;width:150px;min-height:42px;padding:6px 10px;margin-bottom:0;grid-template-areas:\"idx label\";grid-template-columns:auto 1fr;row-gap:0;align-items:center}.panel-body[data-v-64a4f085]{min-height:0}.nav-index[data-v-64a4f085]{font-size:16px}.nav-label[data-v-64a4f085]{font-size:12px}.nav-sub[data-v-64a4f085]{display:none}.browser-overlay[data-v-64a4f085]{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.browser-dialog[data-v-64a4f085]{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}.gpt-model-dialog[data-v-64a4f085],.gpt-model-editor-dialog[data-v-64a4f085]{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px)}.gpt-model-tools[data-v-64a4f085]{grid-template-columns:1fr}.gpt-expression-map-row[data-v-64a4f085]{grid-template-columns:1fr}.emotion-layout[data-v-64a4f085]{grid-template-columns:1fr}.emotion-preview-panel[data-v-64a4f085]{order:-1;position:sticky;top:8px;z-index:8;margin-bottom:8px;padding:8px 10px 10px;background:rgba(0,0,0,.9)}.emotion-preview-header[data-v-64a4f085]{margin-bottom:6px}.emotion-preview-canvas[data-v-64a4f085]{aspect-ratio:16/9;max-height:210px}.emotion-preview-controls[data-v-64a4f085]{margin-top:8px;gap:6px}.emotion-map-head[data-v-64a4f085]{position:static}.emotion-preview-controls .hint[data-v-64a4f085]{display:none}}@media (max-width:620px){.settings-overlay[data-v-64a4f085]{align-items:stretch;padding:0}.settings-panel[data-v-64a4f085]{width:100vw;max-height:100dvh;border-left:none;border-right:none;box-shadow:none}.panel-header[data-v-64a4f085]{padding:10px 12px}.header-title h3[data-v-64a4f085]{font-size:15px;letter-spacing:.06em}.header-title p[data-v-64a4f085]{display:none}.panel-nav[data-v-64a4f085]{padding:6px 8px}.nav-btn[data-v-64a4f085]{width:126px;min-height:38px;padding:5px 8px}.nav-index[data-v-64a4f085]{font-size:14px}.nav-label[data-v-64a4f085]{font-size:11px;letter-spacing:.04em}.close-btn[data-v-64a4f085]{min-width:66px;height:28px;padding:0 8px;font-size:11px}.panel-footer[data-v-64a4f085]{padding:10px 12px calc(10px + env(safe-area-inset-bottom))}.panel-body[data-v-64a4f085]{padding:8px 10px}.form-row[data-v-64a4f085]{flex-direction:column;gap:0}.input-with-btn[data-v-64a4f085]{grid-template-columns:1fr}.btn[data-v-64a4f085]{min-width:86px}.emotion-preview-panel[data-v-64a4f085]{top:6px;padding:8px}.emotion-preview-canvas[data-v-64a4f085]{max-height:180px}.emotion-map-head[data-v-64a4f085],.emotion-map-row[data-v-64a4f085]{grid-template-columns:56px 16px minmax(0,1fr) minmax(0,1fr) 42px;gap:6px}.emotion-map-row[data-v-64a4f085]{padding:8px}.emotion-map-arrow[data-v-64a4f085]{font-size:14px}.emotion-map-preview-btn[data-v-64a4f085]{width:38px;height:30px;font-size:12px}.browser-overlay[data-v-64a4f085]{align-items:stretch;padding:0}.browser-dialog[data-v-64a4f085]{width:100vw;max-height:100dvh;box-shadow:none;clip-path:none}.gpt-model-dialog[data-v-64a4f085],.gpt-model-editor-dialog[data-v-64a4f085]{width:100vw;max-height:100dvh;box-shadow:none;clip-path:none}.browser-dialog-header[data-v-64a4f085]{padding:12px}.browser-dialog-body[data-v-64a4f085]{padding:10px 12px 12px}.gpt-model-header-actions[data-v-64a4f085]{width:100%;justify-content:flex-start}.gpt-model-card-actions .btn[data-v-64a4f085]{min-width:0;flex:1 1 120px}}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/SettingsPanel.vue\"],\"names\":[],\"mappings\":\"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\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.settings-overlay{position:fixed;inset:0;z-index:10001;background:rgba(0,0,0,.82);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.settings-panel{width:min(1080px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%)}.settings-panel::before{content:\\\"\\\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.settings-panel{background-image:linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);background-size:22px 22px}.panel-header{display:flex;align-items:center;justify-content:space-between;gap:14px;padding:14px 18px;border-bottom:2px solid #ffe100;background:rgba(0,0,0,.32)}.header-title{min-width:0}.header-title h3{margin:0;font-size:20px;line-height:1;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase}.header-title p{margin:4px 0 0;font-size:10px;color:#8d8d8d;letter-spacing:.14em;text-transform:uppercase}.close-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.close-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.close-btn:disabled{opacity:.45;cursor:not-allowed}.close-btn{min-width:88px;height:32px;padding:0 10px;font-size:12px}.panel-main{flex:1;min-height:0;display:grid;grid-template-columns:220px 1fr}.panel-nav{border-right:1px solid hsla(0,0%,100%,.16);padding:12px;overflow:auto}.panel-nav::-webkit-scrollbar{width:7px;height:7px}.panel-nav::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-nav::-webkit-scrollbar-thumb{background:#555}.panel-nav::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.nav-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.nav-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.nav-btn:disabled{opacity:.45;cursor:not-allowed}.nav-btn{width:100%;min-height:62px;padding:10px 12px;margin-bottom:10px;text-align:left;display:grid;grid-template-columns:auto 1fr;grid-template-areas:\\\"idx label\\\" \\\"idx sub\\\";column-gap:8px;row-gap:2px}.nav-btn:last-child{margin-bottom:0}.nav-btn.active{background:#ffe100;color:#000;border-color:#ffe100}.nav-index{grid-area:idx;align-self:center;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;color:#00dac2;font-size:18px}.nav-label{grid-area:label;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:13px;letter-spacing:.05em}.nav-sub{grid-area:sub;font-size:10px;color:#8d8d8d;letter-spacing:.06em}.panel-body{padding:14px 18px 16px;overflow:auto}.panel-body::-webkit-scrollbar{width:7px;height:7px}.panel-body::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-body::-webkit-scrollbar-thumb{background:#555}.panel-body::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.setting-section{max-width:740px}.setting-section h4{margin:0 0 12px;display:inline-flex;align-items:center;gap:8px;padding:4px 12px;background:#0f0f0f;border-left:4px solid #ffe100;transform:skewX(-14deg)}.setting-section h4>*{transform:skewX(14deg)}.section-index{color:#00dac2;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:13px}.section-label{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:14px;letter-spacing:.04em}.section-sub{font-size:10px;color:#8d8d8d;letter-spacing:.06em}.form-group{margin-bottom:12px}.form-group>label{display:block;margin-bottom:5px;font-size:12px;color:#d5d5d5;line-height:1.35}.form-group>label>input[type=checkbox]{margin-right:8px;accent-color:#00dac2}.form-group input[type=text],.form-group input[type=password],.form-group input[type=number],.form-group select,.form-group textarea{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.form-group input[type=text]:focus,.form-group input[type=password]:focus,.form-group input[type=number]:focus,.form-group select:focus,.form-group textarea:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.form-group input[type=text]::placeholder,.form-group input[type=password]::placeholder,.form-group input[type=number]::placeholder,.form-group select::placeholder,.form-group textarea::placeholder{color:#8d8d8d}.form-group textarea{resize:vertical;min-height:86px;font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;color:#fff}.form-group select{color:#fff;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif}.form-group select option{background:#101010;color:#fff}.form-group input[type=range]{width:100%;appearance:none;height:4px;border:none;background:#4a4a4a;border-radius:0;padding:0;margin:7px 0 4px}.form-group input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:12px;height:12px;background:#ffe100;border:2px solid #000;transform:rotate(45deg)}.form-group input[type=range]::-moz-range-thumb{width:12px;height:12px;border:2px solid #000;border-radius:0;background:#ffe100;transform:rotate(45deg)}.form-group input[type=range]::-moz-range-track{height:4px;background:#4a4a4a;border:none}.form-group input[type=checkbox]{accent-color:#00dac2}.form-group .hint{margin-top:4px;font-size:11px;color:#8d8d8d}.hint-error{color:#ff3b30 !important}.form-row{display:flex;gap:12px;align-items:flex-start}.form-row .half{flex:1;min-width:0}.dice-sheet-list{margin-top:6px;display:grid;grid-template-columns:repeat(auto-fit, minmax(180px, 1fr));gap:8px}.dice-sheet-item{display:flex;align-items:center;gap:8px;padding:6px 8px;border:1px solid hsla(0,0%,100%,.18);background:hsla(0,0%,100%,.04);font-size:12px;color:#e8e8e8;line-height:1.35}.dice-sheet-item input[type=checkbox]{margin:0}.input-with-btn{display:grid;grid-template-columns:1fr auto;gap:8px;align-items:stretch}.input-with-btn .input-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.input-with-btn .input-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.input-with-btn .input-btn:disabled{opacity:.45;cursor:not-allowed}.input-with-btn .input-btn{min-width:84px;padding:0 12px;font-size:11px;white-space:nowrap}.model-list{display:flex;flex-wrap:wrap;gap:8px}.hidden-file-input{display:none}.local-model-info{margin-top:6px;padding:8px 10px;border:1px solid hsla(0,0%,100%,.16);background:hsla(0,0%,100%,.04);font-size:12px;line-height:1.45;color:#e8e8e8}.model-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.model-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.model-btn:disabled{opacity:.45;cursor:not-allowed}.model-btn{min-height:30px;padding:0 12px;font-size:12px;text-transform:none;letter-spacing:.03em}.model-btn.active{background:#ffe100;border-color:#ffe100;color:#000}.model-btn.browse-btn{border-color:rgba(0,218,194,.55);color:#b2fff6}.model-btn.browse-btn:hover{background:#00dac2;border-color:#00dac2;color:#000}.emotion-layout{display:grid;grid-template-columns:minmax(0, 1fr) 340px;gap:14px;align-items:start}.emotion-configs{min-width:0}.emotion-preview-panel{position:sticky;top:10px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.28);padding:10px 12px 12px;background-image:linear-gradient(rgba(255, 255, 255, 0.02) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.02) 1px, transparent 1px);background-size:18px 18px}.emotion-preview-header{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:10px}.emotion-preview-title{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:700;letter-spacing:.08em;color:#00dac2}.emotion-preview-tag{font-size:12px;color:hsla(0,0%,100%,.78)}.emotion-preview-canvas{position:relative;width:100%;aspect-ratio:3/4;border-radius:10px;overflow:hidden;background:rgba(15,23,42,.95);border:1px solid hsla(0,0%,100%,.18)}.emotion-preview-interact{position:absolute;inset:0;z-index:3}.emotion-preview-empty{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;padding:10px;text-align:center;z-index:4;pointer-events:none;color:hsla(0,0%,100%,.78);font-size:12px}.emotion-preview-controls{margin-top:10px;display:flex;flex-direction:column;gap:8px}.emotion-zoom-row{display:grid;grid-template-columns:auto 1fr auto;gap:10px;align-items:center}.zoom-label{font-size:12px;color:hsla(0,0%,100%,.78)}.zoom-value{font-size:12px;color:#ffe100;font-variant-numeric:tabular-nums}.emotion-preview-actions{display:flex;gap:8px}.emotion-tag{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:700;letter-spacing:.08em;color:#ffe100;text-transform:uppercase}.emotion-map-table{margin-top:4px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.22);max-height:none;overflow:visible;background-image:linear-gradient(rgba(255, 255, 255, 0.02) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.02) 1px, transparent 1px);background-size:20px 20px}.emotion-map-head,.emotion-map-row{display:grid;grid-template-columns:72px 22px minmax(0, 1fr) minmax(0, 1fr) 52px;gap:10px;align-items:center}.emotion-map-head{position:sticky;top:0;z-index:2;padding:8px 10px;font-size:10px;color:hsla(0,0%,100%,.68);letter-spacing:.03em;background:rgba(2,8,20,.92);border-bottom:1px solid hsla(0,0%,100%,.2)}.emotion-map-row{padding:10px;border-bottom:1px solid hsla(0,0%,100%,.12)}.emotion-map-row:nth-child(odd){background:hsla(0,0%,100%,.02)}.emotion-map-tag{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:700;letter-spacing:.08em;color:#ffe100}.emotion-map-arrow{text-align:center;color:hsla(0,0%,100%,.78);font-size:18px;line-height:1}.emotion-map-preview-btn{min-width:0;width:44px;height:32px;padding:0;font-size:14px;line-height:1}.emotion-map-row select{width:100%;min-width:0;text-overflow:ellipsis;white-space:nowrap}.emotion-advanced-list{margin-top:10px;display:flex;flex-direction:column;gap:10px}.emotion-advanced-item{border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.28);padding:10px 12px 2px;background-image:linear-gradient(rgba(255, 255, 255, 0.025) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.025) 1px, transparent 1px);background-size:18px 18px}.emotion-advanced-title{margin-bottom:8px;font-size:12px;letter-spacing:.06em;color:hsla(0,0%,100%,.85)}.advanced-toggle{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border:1px solid hsla(0,0%,100%,.2);background:hsla(0,0%,100%,.04);font-size:11px;color:#d5d5d5;cursor:pointer;user-select:none;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 8px), calc(100% - 8px) 100%, 0 100%)}.advanced-toggle:hover{border-color:rgba(255,225,0,.65);color:#ffe100}.advanced-toggle .toggle-icon{width:12px;text-align:center;color:#00dac2}.advanced-params{margin-top:8px;padding-top:10px;border-top:1px dashed hsla(0,0%,100%,.2)}.about-card{margin-bottom:12px;padding:10px 12px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.26);background-image:linear-gradient(rgba(255, 255, 255, 0.02) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.02) 1px, transparent 1px);background-size:18px 18px}.about-title{margin-bottom:8px;font-size:12px;letter-spacing:.06em;color:#ffe100}.about-link{color:#00dac2;word-break:break-all;text-decoration:underline}.about-list{margin:0;padding-left:18px;display:flex;flex-direction:column;gap:8px;font-size:12px;line-height:1.5;color:#d5d5d5}.status-badge{margin-left:8px;font-size:12px}.status-success{color:#00dac2}.status-fail{color:#ff9c94}.panel-footer{display:flex;justify-content:flex-end;gap:10px;padding:12px 18px 14px;border-top:1px solid hsla(0,0%,100%,.18);background:rgba(0,0,0,.36)}.btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.btn:disabled{opacity:.45;cursor:not-allowed}.btn{min-width:100px;height:34px;padding:0 14px;font-size:12px}.btn-primary{background:#ffe100;color:#000;border-color:#ffe100}.btn-secondary{background:hsla(0,0%,100%,.06);border-color:hsla(0,0%,100%,.3)}.btn-test{min-width:96px;background:rgba(0,218,194,.1);border-color:rgba(0,218,194,.6);color:#bcfff7}.btn-test:hover:not(:disabled){background:#00dac2;border-color:#00dac2;color:#000}.browser-overlay{position:fixed;inset:0;z-index:10002;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.browser-dialog{width:min(980px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%)}.browser-dialog::before{content:\\\"\\\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.browser-dialog{background-image:linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);background-size:22px 22px}.browser-dialog-header{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 18px;border-bottom:1px solid rgba(255,225,0,.36);background:rgba(0,0,0,.28)}.browser-dialog-header h3{margin:0;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:15px;letter-spacing:.08em}.browser-dialog-header .close-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.browser-dialog-header .close-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.browser-dialog-header .close-btn:disabled{opacity:.45;cursor:not-allowed}.browser-dialog-header .close-btn{width:34px;height:28px;padding:0;line-height:1;font-size:16px}.browser-dialog-body{padding:14px 18px 16px;overflow:auto;flex:1}.browser-dialog-body::-webkit-scrollbar{width:7px;height:7px}.browser-dialog-body::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.browser-dialog-body::-webkit-scrollbar-thumb{background:#555}.browser-dialog-body::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.gpt-model-dialog{width:min(1240px,100vw - 24px)}.gpt-model-editor-dialog{width:min(1080px,100vw - 24px)}.gpt-model-header{align-items:flex-start}.gpt-model-header-actions{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end;align-items:center}.gpt-model-header-actions .btn{min-width:84px;height:30px;padding:0 10px;font-size:11px}.gpt-model-body{display:flex;flex-direction:column;gap:10px}.gpt-model-tools{display:grid;grid-template-columns:minmax(0, 1fr) auto auto;gap:8px;align-items:center}.gpt-model-tools input{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.gpt-model-tools input:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.gpt-model-tools input::placeholder{color:#8d8d8d}.gpt-model-card-list{display:flex;flex-direction:column;gap:10px}.gpt-model-card{border:1px solid hsla(0,0%,100%,.18);background:hsla(0,0%,100%,.03);padding:10px 12px;background-image:linear-gradient(rgba(255, 255, 255, 0.02) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.02) 1px, transparent 1px);background-size:18px 18px}.gpt-model-card-head{display:flex;align-items:center;justify-content:space-between;gap:10px}.gpt-model-card-head label{display:inline-flex;align-items:center;gap:8px;font-size:12px}.gpt-model-id{font-size:11px;color:hsla(0,0%,100%,.65);font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;word-break:break-all}.gpt-model-card-actions{margin-top:6px;display:flex;flex-wrap:wrap;gap:8px}.gpt-model-card-actions .btn{min-width:110px}.gpt-ref-list{display:flex;flex-direction:column;gap:10px;margin-bottom:8px}.gpt-ref-item{border:1px solid hsla(0,0%,100%,.16);background:hsla(0,0%,100%,.02);padding:10px}.gpt-ref-actions{display:flex;gap:8px;align-items:flex-end;flex-wrap:wrap}.gpt-expression-map-list{display:flex;flex-direction:column;gap:8px;margin-bottom:8px}.gpt-expression-map-row{display:grid;grid-template-columns:minmax(0, 1fr) minmax(0, 1fr) auto;gap:8px;align-items:center}.gpt-expression-map-row input,.gpt-expression-map-row select{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.gpt-expression-map-row input:focus,.gpt-expression-map-row select:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.gpt-expression-map-row input::placeholder,.gpt-expression-map-row select::placeholder{color:#8d8d8d}.gpt-expression-map-row input,.gpt-expression-map-row select{width:100%}@media(max-width: 860px){.settings-overlay{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.settings-panel{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}.settings-panel::before{width:40px}.panel-main{grid-template-columns:1fr;grid-template-rows:auto 1fr;min-height:0}.panel-nav{border-right:none;border-bottom:1px solid hsla(0,0%,100%,.16);display:flex;gap:6px;padding:8px 10px;overflow-x:auto;overflow-y:hidden}.panel-nav::-webkit-scrollbar{width:7px;height:7px}.panel-nav::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-nav::-webkit-scrollbar-thumb{background:#555}.panel-nav::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.nav-btn{flex:0 0 auto;width:150px;min-height:42px;padding:6px 10px;margin-bottom:0;grid-template-areas:\\\"idx label\\\";grid-template-columns:auto 1fr;row-gap:0;align-items:center}.panel-body{min-height:0}.nav-index{font-size:16px}.nav-label{font-size:12px}.nav-sub{display:none}.browser-overlay{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.browser-dialog{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}.gpt-model-dialog,.gpt-model-editor-dialog{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px)}.gpt-model-tools{grid-template-columns:1fr}.gpt-expression-map-row{grid-template-columns:1fr}.emotion-layout{grid-template-columns:1fr}.emotion-preview-panel{order:-1;position:sticky;top:8px;z-index:8;margin-bottom:8px;padding:8px 10px 10px;background:rgba(0,0,0,.9)}.emotion-preview-header{margin-bottom:6px}.emotion-preview-canvas{aspect-ratio:16/9;max-height:210px}.emotion-preview-controls{margin-top:8px;gap:6px}.emotion-map-head{position:static}.emotion-preview-controls .hint{display:none}}@media(max-width: 620px){.settings-overlay{align-items:stretch;padding:0}.settings-panel{width:100vw;max-height:100dvh;border-left:none;border-right:none;box-shadow:none}.panel-header{padding:10px 12px}.header-title h3{font-size:15px;letter-spacing:.06em}.header-title p{display:none}.panel-nav{padding:6px 8px}.nav-btn{width:126px;min-height:38px;padding:5px 8px}.nav-index{font-size:14px}.nav-label{font-size:11px;letter-spacing:.04em}.close-btn{min-width:66px;height:28px;padding:0 8px;font-size:11px}.panel-footer{padding:10px 12px calc(10px + env(safe-area-inset-bottom))}.panel-body{padding:8px 10px}.form-row{flex-direction:column;gap:0}.input-with-btn{grid-template-columns:1fr}.btn{min-width:86px}.emotion-preview-panel{top:6px;padding:8px}.emotion-preview-canvas{max-height:180px}.emotion-map-head,.emotion-map-row{grid-template-columns:56px 16px minmax(0, 1fr) minmax(0, 1fr) 42px;gap:6px}.emotion-map-row{padding:8px}.emotion-map-arrow{font-size:14px}.emotion-map-preview-btn{width:38px;height:30px;font-size:12px}.browser-overlay{align-items:stretch;padding:0}.browser-dialog{width:100vw;max-height:100dvh;box-shadow:none;clip-path:none}.gpt-model-dialog,.gpt-model-editor-dialog{width:100vw;max-height:100dvh;box-shadow:none;clip-path:none}.browser-dialog-header{padding:12px}.browser-dialog-body{padding:10px 12px 12px}.gpt-model-header-actions{width:100%;justify-content:flex-start}.gpt-model-card-actions .btn{min-width:0;flex:1 1 120px}}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n  if (!cssMapping) {\n    return content;\n  }\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    return [content].concat([sourceMapping]).join(\"\\n\");\n  }\n  return [content].join(\"\\n\");\n};","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ChatBubble.vue?vue&type=style&index=0&id=98097aea&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"266a4174\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ChatBubble.vue?vue&type=style&index=0&id=98097aea&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ChatBubble.vue?vue&type=style&index=0&id=98097aea&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","/**  */\nexport const SCRIPT_NAME = '';\n\n/** IndexedDB  */\nexport const DB_NAME = 'DesktopPetPluginDB';\nexport const DB_VERSION = 1;\nexport const STORE_LIVE2D_MODELS = 'live2dModels';\nexport const STORE_SDK_CACHE = 'sdkCache';\n\n/** Live2D runtime  */\nexport type Live2DRuntimeType = 'legacy' | 'cubism5';\n\n/**  */\nexport const LOCAL_LIVE2D_MODEL_PATH_PREFIX = 'local://desktop-pet/';\nexport const LOCAL_LIVE2D_MODEL_SLOT_ID = 'default';\nexport const LOCAL_LIVE2D_MODEL_PATH = `${LOCAL_LIVE2D_MODEL_PATH_PREFIX}${LOCAL_LIVE2D_MODEL_SLOT_ID}`;\nexport const EMPTY_MOTION_GROUP_VALUE = '__desktop_pet_empty_motion_group__';\n\n/** Live2D CDN  pixi-live2d-display  */\nexport const LIVE2D_CDN_BASE = 'https://cdn.jsdelivr.net/gh/guansss/pixi-live2d-display/test/assets/';\n\n/** SDK CDN  */\nexport const SDK_URLS = {\n  PIXI: 'https://cdn.jsdelivr.net/npm/pixi.js@6.5.10/dist/browser/pixi.min.js',\n  CUBISM4_CORE: 'https://cdn.jsdelivr.net/npm/live2dcubismcore@1.0.2/live2dcubismcore.min.js',\n  CUBISM4_CORE_FALLBACK_URLS: Object.freeze([\n    'https://gcore.jsdelivr.net/npm/live2dcubismcore@1.0.2/live2dcubismcore.min.js',\n    'https://unpkg.com/live2dcubismcore@1.0.2/live2dcubismcore.min.js',\n    'https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js',\n  ]),\n  CUBISM5_CORE: 'https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js',\n  CUBISM5_CORE_FALLBACK_URLS: Object.freeze([\n    'https://cdn.jsdelivr.net/gh/bigmalove/galgame@main/dist/live2dcubismcore.min.js',\n    'https://gcore.jsdelivr.net/gh/bigmalove/galgame@main/dist/live2dcubismcore.min.js',\n  ]),\n  CUBISM2_CORE: 'https://cdn.jsdelivr.net/gh/dylanNew/live2d/webgl/Live2D/lib/live2d.min.js',\n  PIXI_LIVE2D_DISPLAY: 'https://cdn.jsdelivr.net/npm/pixi-live2d-display@0.4.0/dist/index.min.js',\n  CUBISM5_RUNTIME: 'https://cdn.jsdelivr.net/gh/bigmalove/galgame@main/dist/cubism5.runtime.min.js',\n  CUBISM5_RUNTIME_FALLBACK_URLS: Object.freeze([\n    'https://gcore.jsdelivr.net/gh/bigmalove/galgame@main/dist/cubism5.runtime.min.js',\n    'https://cdn.jsdelivr.net/gh/bigmalove/galgame@main/dist/cubism5.js',\n    'https://gcore.jsdelivr.net/gh/bigmalove/galgame@main/dist/cubism5.js',\n  ]),\n} as const;\n\n/**  */\nexport const RECOMMENDED_MODELS = [\n  {\n    name: 'Haru (Cubism 4)',\n    path: 'haru/haru_greeter_t03.model3.json',\n  },\n  {\n    name: 'Shizuku (Cubism 2)',\n    path: 'shizuku/shizuku.model.json',\n  },\n] as const;\n\n/**  */\nexport const COMMENT_STYLES = ['', '', '', '', ''] as const;\nexport type CommentStyle = (typeof COMMENT_STYLES)[number];\n\n/**  */\nexport const COMMENT_TRIGGER_MODES = ['user', 'ai', 'both'] as const;\nexport type CommentTriggerMode = (typeof COMMENT_TRIGGER_MODES)[number];\nexport const COMMENT_TRIGGER_MODE_OPTIONS: ReadonlyArray<{\n  value: CommentTriggerMode;\n  label: string;\n}> = [\n  { value: 'user', label: '' },\n  { value: 'ai', label: 'AI' },\n  { value: 'both', label: '' },\n];\n\n/**  COT  */\nexport const EMOTION_TAGS = [\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n] as const;\nexport type EmotionTag = (typeof EMOTION_TAGS)[number];\n\n/** API source  */\nexport const API_SOURCES = [\n  { value: 'openai', label: 'OpenAI ()' },\n  { value: 'claude', label: 'Claude' },\n  { value: 'makersuite', label: 'Google Gemini' },\n  { value: 'openrouter', label: 'OpenRouter' },\n] as const;\n\n/** Eikanya Live2D  */\nexport const EIKANYA_REPO = 'Eikanya/Live2d-model';\nexport const EIKANYA_API_BASE = 'https://api.github.com/repos/Eikanya/Live2d-model/contents/';\nexport const EIKANYA_CDN_BASE = 'https://cdn.jsdelivr.net/gh/Eikanya/Live2d-model@master/';\nexport const EIKANYA_RAW_BASE = 'https://raw.githubusercontent.com/Eikanya/Live2d-model/master/';\n\n/**  */\nexport const DEFAULTS = {\n  MODEL_PATH: 'shizuku/shizuku.model.json',\n  PET_SCALE: 0.3,\n  PET_POSITION: { x: -1, y: -1 }, // -1 \n  AUTO_MOTION_LOOP: true,\n  DOUBLE_TAP_RANDOM_MOTION_ENABLED: true,\n  GAZE_FOLLOW_MOUSE_ENABLED: true,\n  COMMENT_TRIGGER_MODE: 'ai' as CommentTriggerMode,\n  COMMENT_STYLE: '' as CommentStyle,\n  ROLEPLAY_NAME: '',\n  ROLEPLAY_IGNORE_COMMENT_STYLE: false,\n  SEND_CHARACTER_CARD_CONTENT: false,\n  AUTO_TRIGGER: true,\n  TRIGGER_INTERVAL: 3,\n  TRIGGER_PROBABILITY: 60,\n  MAX_CHAT_CONTEXT: 10,\n  USE_TAMAKO_TODAY_SPECIAL: false,\n  USE_DICE_DATABASE_REFERENCE: false,\n  TTS_BILINGUAL_ZH_JA_ENABLED: false,\n  PHONE_MESSAGE_AUTO_READ: true,\n  BAIBAI_PHONE_MESSAGE_AUTO_READ: false,\n  MAX_TOKENS: 150,\n  TEMPERATURE: 0.9,\n  FREQUENCY_PENALTY: 0,\n  PRESENCE_PENALTY: 0,\n  TOP_P: 1,\n  TOP_K: 0,\n  BUBBLE_DURATION: -1,\n} as const;\n","const __WEBPACK_NAMESPACE_OBJECT__ = z;","import { EMOTION_TAGS, type EmotionTag } from './constants';\n\nexport type EmotionMotionOverride = {\n  enabled: boolean;\n  group: string;\n  index: number;\n};\n\nexport type EmotionConfig = {\n  tag: EmotionTag;\n  aliases: string[];\n  ttsContext: string;\n  live2dExpression: string;\n  live2dMotion: EmotionMotionOverride;\n};\n\nfunction isRecord(value: unknown): value is Record<string, unknown> {\n  return !!value && typeof value === 'object' && !Array.isArray(value);\n}\n\nconst EMOTION_TAG_SET = new Set<string>(EMOTION_TAGS as unknown as string[]);\n\nfunction asEmotionTag(value: unknown): EmotionTag | null {\n  const s = String(value || '').trim();\n  if (!s) return null;\n  return EMOTION_TAG_SET.has(s) ? (s as EmotionTag) : null;\n}\n\nconst DEFAULT_ALIASES: Record<EmotionTag, string[]> = {\n  : ['', 'normal', 'default', 'neutral', 'idle', 'base'],\n  : ['', '', 'smile', 'happy', 'joy', 'glad'],\n  : ['', 'angry', 'mad', 'rage'],\n  : ['', 'sad', 'cry', 'sorrow', 'upset'],\n  : ['', 'surprised', 'shock', 'amazed', 'wow'],\n  : ['', 'smirk', 'mock', 'sneer', 'tease', 'sarcastic'],\n  : ['', 'shy', 'blush', 'embarrassed', 'bashful'],\n  : ['', 'think', 'ponder', 'confused', 'wonder', 'curious'],\n  : ['', 'laugh', 'lol', 'haha', 'giggle', 'rofl'],\n  : ['', 'wink', 'playful', 'silly', 'mischievous', 'fun'],\n};\n\nfunction dedupAliases(aliases: string[]): string[] {\n  const out: string[] = [];\n  const seen = new Set<string>();\n  for (const raw of Array.isArray(aliases) ? aliases : []) {\n    const trimmed = String(raw || '').trim();\n    if (!trimmed) continue;\n    const key = trimmed.toLowerCase();\n    if (seen.has(key)) continue;\n    seen.add(key);\n    out.push(trimmed);\n  }\n  return out;\n}\n\nexport function parseAliasesText(input: unknown): string[] {\n  const text = String(input || '');\n  const parts = text\n    .split(/[,\\n\\r]+/g)\n    .map((s) => s.trim())\n    .filter(Boolean);\n  return dedupAliases(parts);\n}\n\nexport function createDefaultEmotionConfigs(): EmotionConfig[] {\n  return EMOTION_TAGS.map((tag) => ({\n    tag,\n    aliases: [...(DEFAULT_ALIASES[tag] ?? [])],\n    ttsContext: '',\n    live2dExpression: '',\n    live2dMotion: { enabled: true, group: '', index: 0 },\n  }));\n}\n\nexport function normalizeEmotionConfigs(raw: unknown): EmotionConfig[] {\n  const byTag = new Map<EmotionTag, EmotionConfig>();\n\n  for (const item of Array.isArray(raw) ? raw : []) {\n    if (!isRecord(item)) continue;\n    const tag = asEmotionTag(item.tag);\n    if (!tag) continue;\n    if (byTag.has(tag)) continue;\n\n    const live2dMotionRaw = isRecord(item.live2dMotion) ? item.live2dMotion : {};\n    const enabled = (live2dMotionRaw.enabled as unknown) !== false;\n    const group = String(live2dMotionRaw.group || '').trim();\n    const indexRaw = Number(live2dMotionRaw.index);\n    const index = Number.isFinite(indexRaw) ? Math.max(0, Math.floor(indexRaw)) : 0;\n\n    const cfg: EmotionConfig = {\n      tag,\n      aliases: dedupAliases(\n        Array.isArray(item.aliases)\n          ? item.aliases.map((v) => String(v || '').trim()).filter(Boolean)\n          : [],\n      ),\n      ttsContext: String(item.ttsContext || '').trim(),\n      live2dExpression: String(item.live2dExpression || '').trim(),\n      live2dMotion: { enabled, group, index },\n    };\n\n    byTag.set(tag, cfg);\n  }\n\n  const defaults = createDefaultEmotionConfigs();\n  for (const def of defaults) {\n    if (!byTag.has(def.tag)) byTag.set(def.tag, def);\n  }\n\n  return EMOTION_TAGS.map((tag) => byTag.get(tag)!).map((cfg) => ({\n    tag: cfg.tag,\n    aliases: dedupAliases(cfg.aliases),\n    ttsContext: String(cfg.ttsContext || '').trim(),\n    live2dExpression: String(cfg.live2dExpression || '').trim(),\n    live2dMotion: {\n      enabled: cfg.live2dMotion?.enabled !== false,\n      group: String(cfg.live2dMotion?.group || '').trim(),\n      index: Number.isFinite(cfg.live2dMotion?.index) ? Math.max(0, Math.floor(cfg.live2dMotion.index)) : 0,\n    },\n  }));\n}\n\nexport function getEmotionConfigByTag(tag: EmotionTag, configs: unknown): EmotionConfig | null {\n  for (const cfg of Array.isArray(configs) ? (configs as EmotionConfig[]) : []) {\n    if (cfg?.tag === tag) return cfg;\n  }\n  return null;\n}\n\nexport function resolveEmotionTag(rawTag: unknown, configs: unknown): EmotionTag | null {\n  const s = String(rawTag || '').trim();\n  if (!s) return null;\n  const direct = asEmotionTag(s);\n  if (direct) return direct;\n\n  const needle = s.toLowerCase();\n  for (const cfg of Array.isArray(configs) ? (configs as EmotionConfig[]) : []) {\n    const aliases = Array.isArray(cfg?.aliases) ? cfg.aliases : [];\n    for (const alias of aliases) {\n      if (String(alias || '').trim().toLowerCase() === needle) {\n        const tag = asEmotionTag(cfg.tag);\n        if (tag) return tag;\n      }\n    }\n  }\n  return null;\n}\n\n","import { SCRIPT_NAME } from '../core/constants';\n\n/**\n *  DOM  body\n */\nexport function createContainer(id: string): JQuery<HTMLElement> {\n  // \n  $(`#${id}`).remove();\n  return $(`<div id=\"${id}\">`).appendTo('body');\n}\n\n/**\n *  ID \n */\nexport function removeContainer(id: string): void {\n  $(`#${id}`).remove();\n}\n\nfunction getTargetConsole(): Console {\n  try {\n    const top = window.parent ?? window;\n    if (top.console) return top.console;\n  } catch {\n    // ignore\n  }\n  return console;\n}\n\n/**\n * \n */\nexport function log(...args: unknown[]): void {\n  getTargetConsole().log(`[${SCRIPT_NAME}]`, ...args);\n}\n\nexport function warn(...args: unknown[]): void {\n  getTargetConsole().warn(`[${SCRIPT_NAME}]`, ...args);\n}\n\nexport function error(...args: unknown[]): void {\n  getTargetConsole().error(`[${SCRIPT_NAME}]`, ...args);\n}\n","import { klona } from 'klona';\r\nimport { defineStore } from 'pinia';\r\nimport { ref, watchEffect } from 'vue';\r\nimport { z } from 'zod';\r\nimport { COMMENT_STYLES, COMMENT_TRIGGER_MODES, DEFAULTS, EMOTION_TAGS } from './constants';\r\nimport { normalizeEmotionConfigs } from './emotion';\r\nimport { error as logError, warn } from '../utils/dom';\r\n\r\nfunction isRecord(value: unknown): value is Record<string, any> {\r\n  return !!value && typeof value === 'object' && !Array.isArray(value);\r\n}\r\n\r\nfunction deleteAtPath(target: any, path: (string | number)[]): void {\r\n  if (!target || typeof target !== 'object') return;\r\n  if (path.length === 0) return;\r\n\r\n  let current: any = target;\r\n  for (let i = 0; i < path.length - 1; i++) {\r\n    const key = path[i];\r\n    if (!current || typeof current !== 'object') return;\r\n    current = current[key as any];\r\n  }\r\n\r\n  const last = path[path.length - 1];\r\n  if (!current || typeof current !== 'object') return;\r\n  if (Array.isArray(current) && typeof last === 'number') {\r\n    current[last] = undefined;\r\n    return;\r\n  }\r\n  delete current[last as any];\r\n}\r\n\r\nfunction parseSettings(raw: unknown): Settings {\r\n  const rawObject = isRecord(raw) ? raw : {};\r\n  const first = SettingsSchema.safeParse(rawObject);\r\n  if (first.success) return first.data;\r\n\r\n  const cleaned = klona(rawObject);\r\n  for (const issue of first.error.issues) {\r\n    deleteAtPath(cleaned, issue.path);\r\n  }\r\n\r\n  const second = SettingsSchema.safeParse(cleaned);\r\n  if (second.success) {\r\n    warn('', first.error.issues);\r\n    return second.data;\r\n  }\r\n\r\n  logError('', first.error);\r\n  return SettingsSchema.parse({});\r\n}\r\n\r\n/**  Schema */\r\nconst SettingsSchema = z\r\n  .object({\r\n    // API \r\n    apiMode: z.enum(['custom', 'tavern']).default('tavern'),\r\n    apiConfig: z\r\n      .object({\r\n        url: z.string().default(''),\r\n        apiKey: z.string().default(''),\r\n        model: z.string().default('gpt-4o-mini'),\r\n        source: z.string().default('openai'),\r\n        max_tokens: z.number().min(1).max(4096).default(DEFAULTS.MAX_TOKENS),\r\n        temperature: z.number().min(0).max(2).default(DEFAULTS.TEMPERATURE),\r\n        frequency_penalty: z.number().min(-2).max(2).default(DEFAULTS.FREQUENCY_PENALTY),\r\n        presence_penalty: z.number().min(-2).max(2).default(DEFAULTS.PRESENCE_PENALTY),\r\n        top_p: z.number().min(0).max(1).default(DEFAULTS.TOP_P),\r\n        top_k: z.number().min(0).max(500).default(DEFAULTS.TOP_K),\r\n        usePresetSampling: z.boolean().default(false),\r\n        sendWorldInfo: z.boolean().default(false),\r\n      })\r\n      .default({}),\r\n\r\n    // Live2D \r\n    modelPath: z.string().default(DEFAULTS.MODEL_PATH),\r\n    useCdn: z.boolean().default(true),\r\n    petPosition: z\r\n      .object({\r\n        x: z.number().default(DEFAULTS.PET_POSITION.x),\r\n        y: z.number().default(DEFAULTS.PET_POSITION.y),\r\n      })\r\n      .default({}),\r\n    petScale: z.number().min(0.1).max(3).default(DEFAULTS.PET_SCALE),\r\n    autoMotionLoop: z.boolean().default(DEFAULTS.AUTO_MOTION_LOOP),\r\n    doubleTapRandomMotionEnabled: z.boolean().default(DEFAULTS.DOUBLE_TAP_RANDOM_MOTION_ENABLED),\r\n    gazeFollowMouseEnabled: z.boolean().default(DEFAULTS.GAZE_FOLLOW_MOUSE_ENABLED),\r\n\r\n    // \r\n    commentStyle: z.enum(COMMENT_STYLES).default(DEFAULTS.COMMENT_STYLE),\r\n    commentTriggerMode: z.enum(COMMENT_TRIGGER_MODES).default(DEFAULTS.COMMENT_TRIGGER_MODE),\r\n    customPrompt: z.string().default(''),\r\n    roleplayName: z.string().default(DEFAULTS.ROLEPLAY_NAME),\r\n    roleplayIgnoreCommentStyle: z.boolean().default(DEFAULTS.ROLEPLAY_IGNORE_COMMENT_STYLE),\r\n    sendCharacterCardContent: z.boolean().default(DEFAULTS.SEND_CHARACTER_CARD_CONTENT),\r\n    autoTrigger: z.boolean().default(DEFAULTS.AUTO_TRIGGER),\r\n    triggerInterval: z.number().min(1).max(100).default(DEFAULTS.TRIGGER_INTERVAL),\r\n    triggerProbability: z.number().min(0).max(100).default(DEFAULTS.TRIGGER_PROBABILITY),\r\n    maxChatContext: z.number().min(1).max(50).default(DEFAULTS.MAX_CHAT_CONTEXT),\r\n    bubbleDuration: z.number().min(-1).max(600000).default(DEFAULTS.BUBBLE_DURATION),\r\n    useTamakoTodaySpecial: z.boolean().default(DEFAULTS.USE_TAMAKO_TODAY_SPECIAL),\r\n    useDiceDatabaseReference: z.boolean().default(DEFAULTS.USE_DICE_DATABASE_REFERENCE),\r\n    diceReferenceVisibleSheets: z.array(z.string()).default([]),\r\n\r\n    //  COT \r\n    emotionCotEnabled: z.boolean().default(true),\r\n    emotionCotStripFromText: z.boolean().default(true),\r\n    emotionConfigs: z\r\n      .array(\r\n        z\r\n          .object({\r\n            tag: z.enum(EMOTION_TAGS).default(''),\r\n            aliases: z.array(z.string()).default([]),\r\n            ttsContext: z.string().default(''),\r\n            live2dExpression: z.string().default(''),\r\n            live2dMotion: z\r\n              .object({\r\n                enabled: z.boolean().default(true),\r\n                group: z.string().default(''),\r\n                index: z.number().min(0).max(999).default(0),\r\n              })\r\n              .default({}),\r\n          })\r\n          .default({}),\r\n      )\r\n      .default([]),\r\n    // TTS provider\n    ttsProvider: z.enum(['littlewhitebox', 'gpt_sovits_v2', 'edge_tts_direct']).default('littlewhitebox'),\n    ttsAutoPlay: z.boolean().default(true),\n    ttsBilingualZhJaEnabled: z.boolean().default(DEFAULTS.TTS_BILINGUAL_ZH_JA_ENABLED),\n    phoneMessageAutoRead: z.boolean().default(DEFAULTS.PHONE_MESSAGE_AUTO_READ),\n    baibaiPhoneMessageAutoRead: z.boolean().default(DEFAULTS.BAIBAI_PHONE_MESSAGE_AUTO_READ),\n    ttsDefaultSpeaker: z.string().default(''),\n    lipSyncManualParamsEnabled: z.boolean().default(false),\r\n    lipSyncManualParamIds: z.array(z.string()).default([]),\r\n    gptSoVits: z\r\n      .object({\r\n        apiUrl: z.string().default('http://127.0.0.1:9880'),\r\n        endpoint: z.string().default('/tts'),\r\n        useCorsProxy: z.boolean().default(true),\r\n        mediaType: z.enum(['wav', 'ogg', 'raw']).default('wav'),\r\n        streamingMode: z.boolean().default(true),\r\n        textLang: z.string().default('auto'),\r\n        textSplitMethod: z.string().default('cut5'),\r\n        speedFactor: z.number().min(0.1).max(3).default(1),\r\n        strictWeightSwitch: z.boolean().default(false),\n        probeOnAudioError: z.boolean().default(false),\n        modelSwitchMode: z.enum(['none', 'set_model', 'set_weights']).default('set_weights'),\n        setModelEndpoint: z.string().default('/set_model'),\n        rootDir: z.string().default(''),\n        importPathPrefix: z.string().default(''),\n        models: z\n          .array(\n            z\n              .object({\n                id: z.string().default(''),\n                name: z.string().default(''),\n                enabled: z.boolean().default(true),\n                desc: z.string().default(''),\n                paths: z\n                  .object({\n                    gptWeightsPath: z.string().default(''),\n                    sovitsWeightsPath: z.string().default(''),\n                    defaultRefAudioPath: z.string().default(''),\n                  })\n                  .default({}),\n                params: z\n                  .object({\n                    promptText: z.string().default(''),\n                    promptLang: z.string().default('zh'),\n                    textLang: z.string().default('auto'),\n                    textSplitMethod: z.string().default('cut5'),\n                    speedFactor: z.number().min(0.1).max(3).default(1),\n                    mediaType: z.enum(['wav', 'ogg', 'raw']).default('wav'),\n                    streamingMode: z.boolean().default(true),\n                    modelSwitchMode: z.enum(['none', 'set_model', 'set_weights']).default('set_weights'),\n                    setModelEndpoint: z.string().default('/set_model'),\n                    strictWeightSwitch: z.boolean().default(false),\n                  })\n                  .default({}),\n                refAudios: z\n                  .array(\n                    z\n                      .object({\n                        id: z.string().default(''),\n                        name: z.string().default(''),\n                        path: z.string().default(''),\n                        promptText: z.string().default(''),\n                        promptLang: z.string().default('zh'),\n                        textLang: z.string().default('auto'),\n                      })\n                      .default({}),\n                  )\n                  .default([]),\n                defaultRefId: z.string().default(''),\n                expressionRefMap: z.record(z.string(), z.string()).default({}),\n              })\n              .default({}),\n          )\n          .default([]),\n        voices: z\n          .array(\n            z\n              .object({\n                name: z.string().default(''),\r\n                desc: z.string().default(''),\r\n                refAudioPath: z.string().default(''),\r\n                promptText: z.string().default(''),\r\n                promptLang: z.string().default(''),\r\n                textLang: z.string().default(''),\r\n                gptWeightsPath: z.string().default(''),\n                sovitsWeightsPath: z.string().default(''),\n                modelSwitchMode: z.enum(['none', 'set_model', 'set_weights']).default('set_weights'),\n                setModelEndpoint: z.string().default('/set_model'),\n                strictWeightSwitch: z.boolean().default(false),\n              })\n              .default({}),\n          )\n          .default([]),\n      })\n      .default({}),\r\n  })\r\n  .default({});\r\n\r\nexport type Settings = z.infer<typeof SettingsSchema>;\r\n\r\n/** Pinia  Store */\r\nexport const useSettingsStore = defineStore('desktop-pet-settings', () => {\r\n  const raw = getVariables({ type: 'script', script_id: getScriptId() });\r\n  const parsed = parseSettings(raw);\r\n\r\n  //  Eikanya CDN  CDN\r\n  if (\r\n    parsed.modelPath.includes('live2d-widget-model/') ||\r\n    parsed.modelPath.includes('Live2D/Samples/')\r\n  ) {\r\n    parsed.modelPath = DEFAULTS.MODEL_PATH;\r\n  }\r\n\r\n  // jsDelivr / raw  Live2DManager \r\n  // \r\n  parsed.emotionConfigs = normalizeEmotionConfigs(parsed.emotionConfigs);\r\n\r\n  // > 600 \r\n  const rawBubbleDuration = Number((parsed as any).bubbleDuration);\r\n  if (Number.isFinite(rawBubbleDuration)) {\r\n    const bubbleDurationSeconds = rawBubbleDuration > 600 ? rawBubbleDuration / 1000 : rawBubbleDuration;\r\n    (parsed as any).bubbleDuration = Math.round(Math.max(-1, Math.min(600, bubbleDurationSeconds)));\r\n  } else {\r\n    (parsed as any).bubbleDuration = DEFAULTS.BUBBLE_DURATION;\r\n  }\r\n\r\n  const settings = ref<Settings>(parsed);\r\n\r\n  // \r\n  watchEffect(() => {\r\n    replaceVariables(klona(settings.value), { type: 'script', script_id: getScriptId() });\r\n  });\r\n\r\n  /**  */\r\n  function updateSettings(partial: Partial<Settings>) {\r\n    settings.value = SettingsSchema.parse({ ...klona(settings.value), ...partial });\r\n    settings.value.emotionConfigs = normalizeEmotionConfigs(settings.value.emotionConfigs);\r\n  }\r\n\r\n  /**  */\r\n  function resetSettings() {\r\n    const next = SettingsSchema.parse({});\r\n    next.emotionConfigs = normalizeEmotionConfigs(next.emotionConfigs);\r\n    settings.value = next;\r\n  }\r\n\r\n  return { settings, updateSettings, resetSettings };\r\n});\r\n\r\n\r\n","import type { TTSSpeakerVoice } from './tts-config';\n\nconst EDGE_BASE_URL = 'speech.platform.bing.com/consumer/speech/synthesize/readaloud';\nconst TRUSTED_CLIENT_TOKEN = '6A5AA1D4EAFF4E9FB37E23D68491D6F4';\nconst CHROMIUM_FULL_VERSION = '143.0.3537.57';\n\nconst WSS_URL = `wss://${EDGE_BASE_URL}/edge/v1?TrustedClientToken=${TRUSTED_CLIENT_TOKEN}`;\nconst VOICE_LIST_URL = `https://${EDGE_BASE_URL}/voices/list?trustedclienttoken=${TRUSTED_CLIENT_TOKEN}`;\nconst SEC_MS_GEC_VERSION = `1-${CHROMIUM_FULL_VERSION}`;\n\nconst WIN_EPOCH_SECONDS = 11644473600;\nconst SECONDS_TO_NANOSECONDS = 1e9;\n\nconst DEFAULT_RATE = '+0%';\nconst DEFAULT_VOLUME = '+0%';\nconst DEFAULT_PITCH = '+0Hz';\n\nlet clockSkewSeconds = 0;\n\ntype EdgeVoiceApiItem = {\n  ShortName?: string;\n  FriendlyName?: string;\n  Locale?: string;\n  Gender?: string;\n};\n\nexport type EdgeDirectSynthesisOptions = {\n  signal?: AbortSignal;\n  onSocket?: (socket: WebSocket | null) => void;\n  timeoutMs?: number;\n};\n\ntype EdgeTimestampMode = 'utc_string' | 'iso_compact';\n\ntype EdgeSecurityParams = {\n  secMsGec: string;\n  secMsGecVersion: string;\n};\n\ntype SecurityBuildResult = {\n  security: EdgeSecurityParams | null;\n  error: string;\n};\n\nconst EDGE_FALLBACK_SHORT_VOICES: ReadonlyArray<{ shortName: string; locale: string; gender: string }> = [\n  { shortName: 'zh-CN-XiaoxiaoNeural', locale: 'zh-CN', gender: 'Female' },\n  { shortName: 'zh-CN-YunxiNeural', locale: 'zh-CN', gender: 'Male' },\n  { shortName: 'zh-CN-YunyangNeural', locale: 'zh-CN', gender: 'Male' },\n  { shortName: 'zh-CN-XiaoyiNeural', locale: 'zh-CN', gender: 'Female' },\n  { shortName: 'en-US-JennyNeural', locale: 'en-US', gender: 'Female' },\n  { shortName: 'en-US-AriaNeural', locale: 'en-US', gender: 'Female' },\n  { shortName: 'en-US-GuyNeural', locale: 'en-US', gender: 'Male' },\n  { shortName: 'ja-JP-NanamiNeural', locale: 'ja-JP', gender: 'Female' },\n  { shortName: 'ja-JP-KeitaNeural', locale: 'ja-JP', gender: 'Male' },\n];\n\nfunction toAbortError(message = 'Aborted'): Error {\n  try {\n    return new DOMException(message, 'AbortError');\n  } catch {\n    const err = new Error(message);\n    (err as any).name = 'AbortError';\n    return err;\n  }\n}\n\nfunction buildConnectionId(): string {\n  const bytes = new Uint8Array(16);\n  if (globalThis.crypto?.getRandomValues) {\n    globalThis.crypto.getRandomValues(bytes);\n  } else {\n    for (let i = 0; i < bytes.length; i++) {\n      bytes[i] = Math.floor(Math.random() * 256);\n    }\n  }\n  bytes[6] = (bytes[6] & 0x0f) | 0x40;\n  bytes[8] = (bytes[8] & 0x3f) | 0x80;\n  return Array.from(bytes, b => b.toString(16).padStart(2, '0')).join('');\n}\n\nfunction dateToString(mode: EdgeTimestampMode = 'utc_string'): string {\n  const now = new Date();\n  if (mode === 'iso_compact') {\n    return now.toISOString().replace(/[-:.]/g, '').slice(0, -1);\n  }\n  return now.toUTCString().replace('GMT', 'GMT+0000 (Coordinated Universal Time)');\n}\n\nfunction removeIncompatibleCharacters(text: string): string {\n  let out = '';\n  for (let i = 0; i < text.length; i++) {\n    const code = text.charCodeAt(i);\n    const isControl =\n      (code >= 0x00 && code <= 0x08) || code === 0x0b || code === 0x0c || (code >= 0x0e && code <= 0x1f);\n    out += isControl ? ' ' : text[i];\n  }\n  return out;\n}\n\nexport function escapeXml(text: string): string {\n  return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&apos;');\n}\n\nfunction getVoiceName(voice: TTSSpeakerVoice | string): string {\n  if (typeof voice === 'string') return voice.trim();\n  return String(voice.value || voice.name || '').trim();\n}\n\nexport function buildSsml(text: string, voice: TTSSpeakerVoice | string): string {\n  const voiceName = getVoiceName(voice);\n  const escapedText = escapeXml(removeIncompatibleCharacters(String(text || '')));\n  return (\n    `<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xml:lang='en-US'>` +\n    `<voice name='${voiceName}'>` +\n    `<prosody pitch='${DEFAULT_PITCH}' rate='${DEFAULT_RATE}' volume='${DEFAULT_VOLUME}'>${escapedText}</prosody>` +\n    `</voice>` +\n    `</speak>`\n  );\n}\n\nfunction buildSpeechConfigMessage(timestamp: string): string {\n  return (\n    `X-Timestamp:${timestamp}\\r\\n` +\n    `Content-Type:application/json; charset=utf-8\\r\\n` +\n    `Path:speech.config\\r\\n\\r\\n` +\n    `{\"context\":{\"synthesis\":{\"audio\":{\"metadataoptions\":{\"sentenceBoundaryEnabled\":\"false\",\"wordBoundaryEnabled\":\"true\"},\"outputFormat\":\"audio-24khz-48kbitrate-mono-mp3\"}}}}\\r\\n`\n  );\n}\n\nfunction buildSsmlMessage(requestId: string, timestamp: string, ssml: string): string {\n  return (\n    `X-RequestId:${requestId}\\r\\n` +\n    `Content-Type:application/ssml+xml\\r\\n` +\n    `X-Timestamp:${timestamp}Z\\r\\n` +\n    `Path:ssml\\r\\n\\r\\n` +\n    `${ssml}`\n  );\n}\n\nfunction parseHeadersFromTextMessage(textMessage: string): Record<string, string> {\n  const headerEndIndex = textMessage.indexOf('\\r\\n\\r\\n');\n  const headerText = headerEndIndex >= 0 ? textMessage.slice(0, headerEndIndex) : textMessage;\n  const headers: Record<string, string> = {};\n  for (const line of headerText.split('\\r\\n')) {\n    const idx = line.indexOf(':');\n    if (idx <= 0) continue;\n    headers[line.slice(0, idx)] = line.slice(idx + 1).trim();\n  }\n  return headers;\n}\n\nfunction parseHeadersAndDataFromBinaryMessage(binary: Uint8Array): { headers: Record<string, string>; payload: Uint8Array } {\n  if (binary.length < 2) return { headers: {}, payload: new Uint8Array(0) };\n  const headerLength = (binary[0] << 8) | binary[1];\n  if (headerLength <= 0 || headerLength + 2 > binary.length) {\n    return { headers: {}, payload: binary.slice(2) };\n  }\n\n  const headers: Record<string, string> = {};\n  const headerBytes = binary.slice(2, headerLength + 2);\n  const headerText = new TextDecoder().decode(headerBytes);\n  for (const line of headerText.split('\\r\\n')) {\n    const idx = line.indexOf(':');\n    if (idx <= 0) continue;\n    headers[line.slice(0, idx)] = line.slice(idx + 1).trim();\n  }\n\n  return { headers, payload: binary.slice(headerLength + 2) };\n}\n\nfunction concatChunks(chunks: Uint8Array[]): Uint8Array {\n  if (chunks.length === 0) return new Uint8Array(0);\n  if (chunks.length === 1) return chunks[0];\n  const totalLength = chunks.reduce((sum, chunk) => sum + chunk.length, 0);\n  const merged = new Uint8Array(totalLength);\n  let offset = 0;\n  for (const chunk of chunks) {\n    merged.set(chunk, offset);\n    offset += chunk.length;\n  }\n  return merged;\n}\n\nasync function toSha256HexUpper(text: string): Promise<string> {\n  const bytes = new TextEncoder().encode(text);\n  const subtle = globalThis.crypto?.subtle;\n  if (subtle?.digest) {\n    try {\n      const digest = await subtle.digest('SHA-256', bytes);\n      return Array.from(new Uint8Array(digest))\n        .map(b => b.toString(16).padStart(2, '0'))\n        .join('')\n        .toUpperCase();\n    } catch {\n      // fallback to pure-js implementation\n    }\n  }\n  return sha256HexUpperFallback(bytes);\n}\n\nfunction rotateRight(value: number, bits: number): number {\n  return ((value >>> bits) | (value << (32 - bits))) >>> 0;\n}\n\nfunction sha256HexUpperFallback(message: Uint8Array): string {\n  const K = new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2,\n  ]);\n\n  const H = new Uint32Array([\n    0x6a09e667,\n    0xbb67ae85,\n    0x3c6ef372,\n    0xa54ff53a,\n    0x510e527f,\n    0x9b05688c,\n    0x1f83d9ab,\n    0x5be0cd19,\n  ]);\n\n  const withOneByte = message.length + 1;\n  const paddedLength = Math.ceil((withOneByte + 8) / 64) * 64;\n  const padded = new Uint8Array(paddedLength);\n  padded.set(message);\n  padded[message.length] = 0x80;\n\n  const bitLength = message.length * 8;\n  const high = Math.floor(bitLength / 0x100000000);\n  const low = bitLength >>> 0;\n  padded[paddedLength - 8] = (high >>> 24) & 0xff;\n  padded[paddedLength - 7] = (high >>> 16) & 0xff;\n  padded[paddedLength - 6] = (high >>> 8) & 0xff;\n  padded[paddedLength - 5] = high & 0xff;\n  padded[paddedLength - 4] = (low >>> 24) & 0xff;\n  padded[paddedLength - 3] = (low >>> 16) & 0xff;\n  padded[paddedLength - 2] = (low >>> 8) & 0xff;\n  padded[paddedLength - 1] = low & 0xff;\n\n  const w = new Uint32Array(64);\n  for (let offset = 0; offset < padded.length; offset += 64) {\n    for (let i = 0; i < 16; i++) {\n      const j = offset + i * 4;\n      w[i] = ((padded[j] << 24) | (padded[j + 1] << 16) | (padded[j + 2] << 8) | padded[j + 3]) >>> 0;\n    }\n\n    for (let i = 16; i < 64; i++) {\n      const s0 = rotateRight(w[i - 15], 7) ^ rotateRight(w[i - 15], 18) ^ (w[i - 15] >>> 3);\n      const s1 = rotateRight(w[i - 2], 17) ^ rotateRight(w[i - 2], 19) ^ (w[i - 2] >>> 10);\n      w[i] = (w[i - 16] + s0 + w[i - 7] + s1) >>> 0;\n    }\n\n    let a = H[0];\n    let b = H[1];\n    let c = H[2];\n    let d = H[3];\n    let e = H[4];\n    let f = H[5];\n    let g = H[6];\n    let h = H[7];\n\n    for (let i = 0; i < 64; i++) {\n      const S1 = rotateRight(e, 6) ^ rotateRight(e, 11) ^ rotateRight(e, 25);\n      const ch = (e & f) ^ (~e & g);\n      const temp1 = (h + S1 + ch + K[i] + w[i]) >>> 0;\n      const S0 = rotateRight(a, 2) ^ rotateRight(a, 13) ^ rotateRight(a, 22);\n      const maj = (a & b) ^ (a & c) ^ (b & c);\n      const temp2 = (S0 + maj) >>> 0;\n\n      h = g;\n      g = f;\n      f = e;\n      e = (d + temp1) >>> 0;\n      d = c;\n      c = b;\n      b = a;\n      a = (temp1 + temp2) >>> 0;\n    }\n\n    H[0] = (H[0] + a) >>> 0;\n    H[1] = (H[1] + b) >>> 0;\n    H[2] = (H[2] + c) >>> 0;\n    H[3] = (H[3] + d) >>> 0;\n    H[4] = (H[4] + e) >>> 0;\n    H[5] = (H[5] + f) >>> 0;\n    H[6] = (H[6] + g) >>> 0;\n    H[7] = (H[7] + h) >>> 0;\n  }\n\n  return Array.from(H)\n    .map(word => word.toString(16).padStart(8, '0'))\n    .join('')\n    .toUpperCase();\n}\n\nasync function buildSecurityParamsWithReason(): Promise<SecurityBuildResult> {\n  try {\n    let ticks = Date.now() / 1000 + clockSkewSeconds;\n    ticks += WIN_EPOCH_SECONDS;\n    ticks -= ticks % 300;\n    ticks *= SECONDS_TO_NANOSECONDS / 100;\n    const secMsGec = await toSha256HexUpper(`${ticks.toFixed(0)}${TRUSTED_CLIENT_TOKEN}`);\n    return {\n      security: { secMsGec, secMsGecVersion: SEC_MS_GEC_VERSION },\n      error: '',\n    };\n  } catch (e) {\n    return {\n      security: null,\n      error: e instanceof Error ? e.message : String(e),\n    };\n  }\n}\n\nexport async function buildSecurityParams(): Promise<EdgeSecurityParams | null> {\n  const { security } = await buildSecurityParamsWithReason();\n  return security;\n}\n\nfunction mapEdgeVoice(item: EdgeVoiceApiItem): TTSSpeakerVoice | null {\n  const shortName = String(item.ShortName || '').trim();\n  if (!shortName) return null;\n\n  const locale = String(item.Locale || '').trim();\n  const gender = String(item.Gender || '').trim();\n  const friendlyName = String(item.FriendlyName || '').trim();\n  const desc = [friendlyName, locale, gender].filter(Boolean).join(' | ');\n\n  return {\n    name: shortName,\n    value: shortName,\n    source: 'edge_tts_direct',\n    resourceId: null,\n    desc: desc || 'EdgeTTS Direct',\n  };\n}\n\nfunction dedupeVoices(list: TTSSpeakerVoice[]): TTSSpeakerVoice[] {\n  const seen = new Set<string>();\n  const result: TTSSpeakerVoice[] = [];\n  for (const voice of list) {\n    const key = String(voice.value || voice.name || '').trim().toLowerCase();\n    if (!key || seen.has(key)) continue;\n    seen.add(key);\n    result.push(voice);\n  }\n  return result.sort((a, b) => a.name.localeCompare(b.name));\n}\n\nfunction parseServerDateHeader(response: Response): number | null {\n  const date = response.headers.get('date') || response.headers.get('Date');\n  if (!date) return null;\n  const ts = new Date(date).getTime();\n  if (!Number.isFinite(ts)) return null;\n  return ts / 1000;\n}\n\nasync function fetchVoicesOnce(url: string): Promise<TTSSpeakerVoice[]> {\n  const response = await fetch(url, {\n    headers: {\n      Accept: '*/*',\n      'Accept-Language': 'en-US,en;q=0.9',\n    },\n  });\n\n  const serverDate = parseServerDateHeader(response);\n  if (serverDate !== null) {\n    const clientDate = Date.now() / 1000 + clockSkewSeconds;\n    clockSkewSeconds += serverDate - clientDate;\n  }\n\n  if (!response.ok) {\n    throw new Error(`EdgeTTS voices request failed (HTTP ${response.status})`);\n  }\n\n  const payload = (await response.json()) as EdgeVoiceApiItem[];\n  if (!Array.isArray(payload)) {\n    throw new Error('EdgeTTS voices response is not an array');\n  }\n\n  const mapped = payload.map(mapEdgeVoice).filter(Boolean) as TTSSpeakerVoice[];\n  return dedupeVoices(mapped);\n}\n\nexport async function fetchEdgeVoices(): Promise<TTSSpeakerVoice[]> {\n  const securityResult = await buildSecurityParamsWithReason();\n  const security = securityResult.security;\n  const urls: string[] = [];\n\n  if (security) {\n    urls.push(\n      `${VOICE_LIST_URL}&Sec-MS-GEC=${encodeURIComponent(security.secMsGec)}&Sec-MS-GEC-Version=${encodeURIComponent(security.secMsGecVersion)}`,\n    );\n  }\n  urls.push(VOICE_LIST_URL);\n\n  let lastError: unknown = null;\n  for (const url of urls) {\n    try {\n      const voices = await fetchVoicesOnce(url);\n      if (voices.length > 0) return voices;\n      lastError = new Error('EdgeTTS voices response is empty');\n    } catch (e) {\n      lastError = e;\n    }\n  }\n\n  if (!security && securityResult.error) {\n    const base = lastError instanceof Error ? lastError.message : String(lastError || 'unknown');\n    throw new Error(`EdgeTTS voices request failed. security-unavailable: ${securityResult.error}; last: ${base}`);\n  }\n  throw lastError instanceof Error ? lastError : new Error('EdgeTTS voices request failed');\n}\n\nexport function getEdgeFallbackVoices(): TTSSpeakerVoice[] {\n  return EDGE_FALLBACK_SHORT_VOICES.map(item => ({\n    name: item.shortName,\n    value: item.shortName,\n    source: 'edge_tts_direct',\n    resourceId: null,\n    desc: `${item.locale} | ${item.gender}`,\n  }));\n}\n\nasync function synthesizeWithSocketUrl(\n  socketUrl: string,\n  text: string,\n  voiceName: string,\n  options: EdgeDirectSynthesisOptions,\n  timestampMode: EdgeTimestampMode,\n  attemptLabel: string,\n): Promise<Blob> {\n  const timeoutMs = Number.isFinite(options.timeoutMs) ? Math.max(3000, Number(options.timeoutMs)) : 25000;\n\n  return new Promise<Blob>((resolve, reject) => {\n    let done = false;\n    let ws: WebSocket | null = null;\n    let timeoutId: number | null = null;\n    const chunks: Uint8Array[] = [];\n    let sawSocketError = false;\n    let sawOpen = false;\n    let closeCode = 0;\n    let closeReason = '';\n    let closeWasClean = false;\n\n    const finish = (fn: () => void) => {\n      if (done) return;\n      done = true;\n      if (timeoutId !== null) window.clearTimeout(timeoutId);\n      if (ws) {\n        ws.onopen = null;\n        ws.onmessage = null;\n        ws.onerror = null;\n        ws.onclose = null;\n      }\n      options.onSocket?.(null);\n      if (options.signal) {\n        options.signal.removeEventListener('abort', onAbort);\n      }\n      fn();\n    };\n\n    const fail = (error: unknown) => {\n      finish(() => reject(error instanceof Error ? error : new Error(String(error))));\n    };\n\n    const onAbort = () => {\n      try {\n        ws?.close(1000, 'abort');\n      } catch {\n        // ignore\n      }\n      fail(toAbortError('EdgeTTS direct synthesis aborted'));\n    };\n\n    if (options.signal?.aborted) {\n      fail(toAbortError('EdgeTTS direct synthesis aborted'));\n      return;\n    }\n\n    if (options.signal) {\n      options.signal.addEventListener('abort', onAbort, { once: true });\n    }\n\n    ws = new WebSocket(socketUrl);\n    ws.binaryType = 'arraybuffer';\n    options.onSocket?.(ws);\n\n    timeoutId = window.setTimeout(() => {\n      try {\n        ws?.close(1013, 'timeout');\n      } catch {\n        // ignore\n      }\n      fail(new Error(`EdgeTTS direct websocket timeout (${attemptLabel})`));\n    }, timeoutMs);\n\n    ws.onopen = () => {\n      sawOpen = true;\n      const timestamp = dateToString(timestampMode);\n      ws?.send(buildSpeechConfigMessage(timestamp));\n      ws?.send(buildSsmlMessage(buildConnectionId(), timestamp, buildSsml(text, voiceName)));\n    };\n\n    ws.onmessage = event => {\n      if (done) return;\n\n      if (typeof event.data === 'string') {\n        const headers = parseHeadersFromTextMessage(event.data);\n        const path = String(headers.Path || headers.path || '').toLowerCase();\n        if (path === 'turn.end') {\n          try {\n            ws?.close(1000, 'turn.end');\n          } catch {\n            // ignore\n          }\n        }\n        return;\n      }\n\n      const handleBinary = async () => {\n        const data = event.data;\n        let bytes: Uint8Array | null = null;\n\n        if (data instanceof ArrayBuffer) {\n          bytes = new Uint8Array(data);\n        } else if (ArrayBuffer.isView(data)) {\n          bytes = new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n        } else if (data instanceof Blob) {\n          bytes = new Uint8Array(await data.arrayBuffer());\n        }\n        if (!bytes || bytes.length < 2) return;\n\n        const { headers, payload } = parseHeadersAndDataFromBinaryMessage(bytes);\n        const path = String(headers.Path || headers.path || '').toLowerCase();\n        if (path !== 'audio') return;\n\n        const contentType = String(headers['Content-Type'] || headers['content-type'] || '').toLowerCase();\n        if (contentType && !contentType.startsWith('audio/')) return;\n        if (payload.length > 0) {\n          chunks.push(payload);\n        }\n      };\n\n      void handleBinary().catch(fail);\n    };\n\n    ws.onerror = () => {\n      // Browser WebSocket error events don't expose useful details.\n      // Keep the event and wait for onclose to obtain close code/reason.\n      sawSocketError = true;\n    };\n\n    ws.onclose = event => {\n      closeCode = event.code;\n      closeReason = String(event.reason || '').trim();\n      closeWasClean = !!event.wasClean;\n\n      if (done) return;\n      if (options.signal?.aborted) {\n        fail(toAbortError('EdgeTTS direct synthesis aborted'));\n        return;\n      }\n      if (chunks.length <= 0) {\n        fail(\n          new Error(\n            `No audio frame received from EdgeTTS direct websocket (${attemptLabel}; code=${closeCode}, clean=${closeWasClean}, opened=${sawOpen}, errorEvent=${sawSocketError}, reason=${closeReason || 'n/a'})`,\n          ),\n        );\n        return;\n      }\n\n      const merged = concatChunks(chunks);\n      const blob = new Blob([merged as unknown as ArrayBufferView], { type: 'audio/mpeg' });\n      finish(() => resolve(blob));\n    };\n  });\n}\n\nexport async function synthesizeToBlob(\n  text: string,\n  voice: TTSSpeakerVoice | string,\n  options: EdgeDirectSynthesisOptions = {},\n): Promise<Blob> {\n  const cleanText = removeIncompatibleCharacters(String(text || '')).trim();\n  if (!cleanText) {\n    throw new Error('EdgeTTS text is empty');\n  }\n\n  const voiceName = getVoiceName(voice);\n  if (!voiceName) {\n    throw new Error('EdgeTTS voice is empty');\n  }\n\n  const securityResult = await buildSecurityParamsWithReason();\n  const security = securityResult.security;\n  const attempts: Array<{ socketUrl: string; timestampMode: EdgeTimestampMode; label: string }> = [];\n  if (security) {\n    attempts.push({\n      socketUrl: `${WSS_URL}&Sec-MS-GEC=${encodeURIComponent(security.secMsGec)}&Sec-MS-GEC-Version=${encodeURIComponent(security.secMsGecVersion)}&ConnectionId=${buildConnectionId()}`,\n      timestampMode: 'utc_string',\n      label: 'with-sec/utc',\n    });\n    attempts.push({\n      socketUrl: `${WSS_URL}&Sec-MS-GEC=${encodeURIComponent(security.secMsGec)}&Sec-MS-GEC-Version=${encodeURIComponent(security.secMsGecVersion)}&ConnectionId=${buildConnectionId()}`,\n      timestampMode: 'iso_compact',\n      label: 'with-sec/iso',\n    });\n  }\n  const plainBase = `${WSS_URL}&ConnectionId=${buildConnectionId()}`;\n  attempts.push({\n    socketUrl: plainBase,\n    timestampMode: 'utc_string',\n    label: 'plain/utc',\n  });\n  attempts.push({\n    socketUrl: plainBase,\n    timestampMode: 'iso_compact',\n    label: 'plain/iso',\n  });\n\n  let lastError: unknown = null;\n  const attemptErrors: string[] = [];\n  for (const attempt of attempts) {\n    try {\n      return await synthesizeWithSocketUrl(\n        attempt.socketUrl,\n        cleanText,\n        voiceName,\n        options,\n        attempt.timestampMode,\n        attempt.label,\n      );\n    } catch (e) {\n      lastError = e;\n      const message = e instanceof Error ? e.message : String(e);\n      attemptErrors.push(`${attempt.label}: ${message}`);\n      if (options.signal?.aborted) {\n        throw toAbortError('EdgeTTS direct synthesis aborted');\n      }\n    }\n  }\n\n  if (attemptErrors.length > 0) {\n    const ua = String(globalThis.navigator?.userAgent || '');\n    const isEdgeUA = /Edg\\//i.test(ua);\n    const allUnopened = attemptErrors.every(msg => /opened=false/.test(msg));\n    const likelyUaRejected = !isEdgeUA && allUnopened;\n    const securityHint =\n      !security && securityResult.error ? ` security-unavailable=${securityResult.error};` : '';\n    const uaHint = likelyUaRejected ? ' likely-cause=ua-not-edg;' : '';\n    throw new Error(`EdgeTTS direct synthesis failed.${securityHint}${uaHint} ${attemptErrors.join(' | ')}`);\n  }\n  throw lastError instanceof Error ? lastError : new Error('EdgeTTS direct synthesis failed');\n}\n","import { SCRIPT_NAME } from '../core/constants';\nimport { useSettingsStore } from '../core/settings';\nimport { fetchEdgeVoices, getEdgeFallbackVoices } from './edge-tts-direct';\n// ============================================\n// TTS  (Providers)\n// : galgame/src/audio/tts-config.js\n// ============================================\nexport const TTS_PROVIDER = {\n    LITTLEWHITEBOX: 'littlewhitebox',\n    GPT_SOVITS_V2: 'gpt_sovits_v2',\n    EDGE_TTS_DIRECT: 'edge_tts_direct',\n};\nfunction normalizePathSep(path) {\n    return String(path || '').replace(/\\\\/g, '/');\n}\nfunction getTopWindow() {\n    try {\n        return window.parent ?? window;\n    }\n    catch {\n        return window;\n    }\n}\nfunction getStoragePrefix() {\n    try {\n        if (typeof getScriptId === 'function') {\n            const id = String(getScriptId() ?? '').trim();\n            if (id)\n                return id;\n        }\n    }\n    catch {\n        // ignore\n    }\n    return SCRIPT_NAME;\n}\nfunction getTtsEnabledKey() {\n    return `${getStoragePrefix()}_tts_enabled`;\n}\nfunction getCharTtsVoiceKey() {\n    return `${getStoragePrefix()}_char_tts_voice`;\n}\nexport function normalizeGptSoVitsSwitchMode(mode) {\n    const s = String(mode || '').trim().toLowerCase();\n    if (s === 'none' || s === 'off' || s === 'disabled')\n        return 'none';\n    if (s === 'set_model' || s === 'model')\n        return 'set_model';\n    return 'set_weights';\n}\nfunction normalizeSetModelEndpoint(endpoint) {\n    const raw = String(endpoint || '').trim();\n    if (!raw)\n        return '/set_model';\n    return raw.startsWith('/') ? raw : `/${raw}`;\n}\nfunction toFiniteNumber(value, fallback) {\n    const n = Number(value);\n    return Number.isFinite(n) ? n : fallback;\n}\nfunction safeObject(value) {\n    return (value && typeof value === 'object' ? value : {});\n}\nfunction safeArray(value) {\n    return Array.isArray(value) ? value : [];\n}\nfunction buildGptSoVitsModelId(seed = 'model') {\n    const base = String(seed || 'model')\n        .trim()\n        .replace(/[^\\w\\u4e00-\\u9fff.-]+/g, '_')\n        .replace(/^_+|_+$/g, '')\n        .toLowerCase();\n    const ts = Date.now().toString(36);\n    const rnd = Math.floor(Math.random() * 1e6).toString(36);\n    return `${base || 'model'}_${ts}_${rnd}`;\n}\nfunction normalizeGptSoVitsRefAudio(ref, index = 0, defaults = {}) {\n    const raw = safeObject(ref);\n    const path = normalizePathSep(String(raw.path || raw.refAudioPath || raw.ref_audio_path || '').trim());\n    if (!path)\n        return null;\n    const idRaw = String(raw.id || raw.refId || '').trim() || `ref_${index + 1}`;\n    const id = idRaw.replace(/[^\\w\\u4e00-\\u9fff.-]+/g, '_');\n    const name = String(raw.name || raw.label || id || `${index + 1}`).trim() || `${index + 1}`;\n    return {\n        id,\n        name,\n        path,\n        promptText: String(raw.promptText || raw.prompt_text || defaults.promptText || '').trim(),\n        promptLang: String(raw.promptLang || raw.prompt_lang || defaults.promptLang || 'zh').trim() || 'zh',\n        textLang: String(raw.textLang || raw.text_lang || defaults.textLang || 'auto').trim() || 'auto',\n    };\n}\nfunction normalizeGptSoVitsModel(model, globalDefaults, index = 0) {\n    const raw = safeObject(model);\n    const paths = safeObject(raw.paths);\n    const params = safeObject(raw.params);\n    const name = String(raw.name || raw.modelName || raw.voice || raw.speaker || '').trim();\n    if (!name)\n        return null;\n    const id = String(raw.id || '')\n        .trim()\n        .replace(/[^\\w\\u4e00-\\u9fff.-]+/g, '_') || buildGptSoVitsModelId(name || `model_${index + 1}`);\n    const modelParams = {\n        promptText: String(params.promptText || params.prompt_text || raw.promptText || raw.prompt_text || '').trim(),\n        promptLang: String(params.promptLang || params.prompt_lang || raw.promptLang || raw.prompt_lang || 'zh').trim() || 'zh',\n        textLang: String(params.textLang || params.text_lang || raw.textLang || raw.text_lang || globalDefaults.textLang || 'auto').trim() || 'auto',\n        textSplitMethod: String(params.textSplitMethod ||\n            params.text_split_method ||\n            raw.textSplitMethod ||\n            raw.text_split_method ||\n            globalDefaults.textSplitMethod ||\n            'cut5').trim() || 'cut5',\n        speedFactor: toFiniteNumber(params.speedFactor ?? params.speed_factor ?? raw.speedFactor ?? raw.speed_factor, toFiniteNumber(globalDefaults.speedFactor, 1)),\n        mediaType: String(params.mediaType || params.media_type || raw.mediaType || raw.media_type || globalDefaults.mediaType || 'wav')\n            .trim() || 'wav',\n        streamingMode: !!(params.streamingMode ??\n            params.streaming_mode ??\n            raw.streamingMode ??\n            raw.streaming_mode ??\n            globalDefaults.streamingMode),\n        modelSwitchMode: normalizeGptSoVitsSwitchMode(params.modelSwitchMode || raw.modelSwitchMode || globalDefaults.modelSwitchMode || 'set_weights'),\n        setModelEndpoint: normalizeSetModelEndpoint(params.setModelEndpoint || raw.setModelEndpoint || globalDefaults.setModelEndpoint || '/set_model'),\n        strictWeightSwitch: !!(params.strictWeightSwitch ?? raw.strictWeightSwitch ?? globalDefaults.strictWeightSwitch),\n    };\n    const gptWeightsPath = normalizePathSep(String(paths.gptWeightsPath || paths.gpt_weights_path || raw.gptWeightsPath || raw.gpt_weights_path || '').trim());\n    const sovitsWeightsPath = normalizePathSep(String(paths.sovitsWeightsPath || paths.sovits_weights_path || raw.sovitsWeightsPath || raw.sovits_weights_path || '').trim());\n    const defaultRefAudioPath = normalizePathSep(String(paths.defaultRefAudioPath || raw.defaultRefAudioPath || raw.refAudioPath || raw.ref_audio_path || '').trim());\n    const refAudioCandidates = [\n        ...safeArray(raw.refAudios),\n        ...safeArray(raw.references),\n        ...safeArray(raw.refAudioList),\n    ];\n    if (defaultRefAudioPath) {\n        refAudioCandidates.unshift({\n            id: String(raw.defaultRefId || 'ref_default').trim() || 'ref_default',\n            name: '',\n            path: defaultRefAudioPath,\n            promptText: modelParams.promptText,\n            promptLang: modelParams.promptLang,\n            textLang: modelParams.textLang,\n        });\n    }\n    const refAudios = [];\n    const refIds = new Set();\n    const refPaths = new Set();\n    for (const [refIndex, item] of refAudioCandidates.entries()) {\n        const normalized = normalizeGptSoVitsRefAudio(item, refIndex, modelParams);\n        if (!normalized)\n            continue;\n        if (refPaths.has(normalized.path))\n            continue;\n        let nextId = normalized.id || `ref_${refAudios.length + 1}`;\n        let dedupe = 2;\n        while (refIds.has(nextId)) {\n            nextId = `${normalized.id}_${dedupe++}`;\n        }\n        normalized.id = nextId;\n        refIds.add(nextId);\n        refPaths.add(normalized.path);\n        refAudios.push(normalized);\n    }\n    let defaultRefId = String(raw.defaultRefId || '').trim();\n    if (defaultRefId && !refAudios.some(item => item.id === defaultRefId)) {\n        defaultRefId = '';\n    }\n    if (!defaultRefId && defaultRefAudioPath) {\n        defaultRefId = refAudios.find(item => item.path === defaultRefAudioPath)?.id || '';\n    }\n    if (!defaultRefId && refAudios.length > 0) {\n        defaultRefId = refAudios[0].id;\n    }\n    const resolvedDefaultRefPath = refAudios.find(item => item.id === defaultRefId)?.path || defaultRefAudioPath || refAudios[0]?.path || '';\n    const rawMap = safeObject(raw.expressionRefMap || raw.expressionMap);\n    const expressionRefMap = {};\n    Object.entries(rawMap).forEach(([expr, refId]) => {\n        const exprText = String(expr || '').trim();\n        const resolvedRefId = String(refId || '').trim();\n        if (!exprText || !resolvedRefId)\n            return;\n        if (!refAudios.some(item => item.id === resolvedRefId))\n            return;\n        expressionRefMap[exprText] = resolvedRefId;\n    });\n    return {\n        id,\n        name,\n        enabled: raw.enabled !== false,\n        desc: String(raw.desc || raw.description || '').trim(),\n        paths: {\n            gptWeightsPath,\n            sovitsWeightsPath,\n            defaultRefAudioPath: resolvedDefaultRefPath,\n        },\n        params: modelParams,\n        refAudios,\n        defaultRefId,\n        expressionRefMap,\n    };\n}\nfunction normalizeGptSoVitsModelsForStoreInternal(modelList, globalDefaults) {\n    const out = [];\n    const idSet = new Set();\n    const nameSet = new Set();\n    for (const [index, model] of safeArray(modelList).entries()) {\n        const normalized = normalizeGptSoVitsModel(model, globalDefaults, index);\n        if (!normalized)\n            continue;\n        let id = normalized.id;\n        while (idSet.has(id))\n            id = buildGptSoVitsModelId(id);\n        normalized.id = id;\n        idSet.add(id);\n        const baseName = normalized.name;\n        let nextName = baseName;\n        let dedupe = 2;\n        while (nameSet.has(nextName)) {\n            nextName = `${baseName}_${dedupe++}`;\n        }\n        normalized.name = nextName;\n        nameSet.add(nextName);\n        out.push(normalized);\n    }\n    return out;\n}\nfunction buildRuntimeVoiceFromModel(model, globalCfg) {\n    if (!model || model.enabled === false)\n        return null;\n    const refs = safeArray(model.refAudios);\n    const defaultRef = refs.find(item => item.id === model.defaultRefId) ||\n        refs.find(item => item.path === model.paths?.defaultRefAudioPath) ||\n        refs[0] ||\n        null;\n    const params = safeObject(model.params);\n    const promptText = String(defaultRef?.promptText || params.promptText || '').trim();\n    const promptLang = String(defaultRef?.promptLang || params.promptLang || 'zh').trim() || 'zh';\n    const textLang = String(defaultRef?.textLang || params.textLang || globalCfg.textLang || 'auto').trim() || 'auto';\n    return {\n        name: model.name,\n        value: model.name,\n        source: TTS_PROVIDER.GPT_SOVITS_V2,\n        resourceId: null,\n        desc: model.desc || 'GPT-SoVITS',\n        gptSoVitsModel: model,\n        gptSoVits: {\n            refAudioPath: String(defaultRef?.path || model.paths?.defaultRefAudioPath || '').trim(),\n            promptText,\n            promptLang,\n            textLang,\n            gptWeightsPath: String(model.paths?.gptWeightsPath || '').trim(),\n            sovitsWeightsPath: String(model.paths?.sovitsWeightsPath || '').trim(),\n            textSplitMethod: String(params.textSplitMethod || globalCfg.textSplitMethod || 'cut5').trim() || 'cut5',\n            speedFactor: toFiniteNumber(params.speedFactor, toFiniteNumber(globalCfg.speedFactor, 1)),\n            mediaType: String(params.mediaType || globalCfg.mediaType || 'wav').trim() || 'wav',\n            streamingMode: !!(params.streamingMode ?? globalCfg.streamingMode),\n            modelSwitchMode: normalizeGptSoVitsSwitchMode(params.modelSwitchMode || globalCfg.modelSwitchMode || 'set_weights'),\n            setModelEndpoint: normalizeSetModelEndpoint(params.setModelEndpoint || globalCfg.setModelEndpoint || '/set_model'),\n            strictWeightSwitch: !!(params.strictWeightSwitch ?? globalCfg.strictWeightSwitch),\n        },\n    };\n}\nexport function getTTSProvider() {\n    try {\n        const store = useSettingsStore();\n        return store.settings.ttsProvider || TTS_PROVIDER.LITTLEWHITEBOX;\n    }\n    catch {\n        return TTS_PROVIDER.LITTLEWHITEBOX;\n    }\n}\nexport function getGptSoVitsConfig() {\n    const defaults = {\n        apiUrl: 'http://127.0.0.1:9880',\n        endpoint: '/tts',\n        useCorsProxy: true,\n        mediaType: 'wav',\n        streamingMode: false,\n        textLang: 'auto',\n        textSplitMethod: 'cut5',\n        speedFactor: 1,\n        strictWeightSwitch: false,\n        probeOnAudioError: false,\n        modelSwitchMode: 'set_weights',\n        setModelEndpoint: '/set_model',\n        rootDir: '',\n        importPathPrefix: '',\n        models: [],\n        voices: [],\n    };\n    try {\n        const store = useSettingsStore();\n        const cfg = store.settings.gptSoVits || {};\n        const normalizedRootDir = normalizePathSep(String(cfg.rootDir || cfg.importPathPrefix || '').trim());\n        const normalizedImportPrefix = normalizePathSep(String(cfg.importPathPrefix || normalizedRootDir || '').trim());\n        const merged = Object.assign(Object.assign({}, defaults), cfg, {\n            modelSwitchMode: normalizeGptSoVitsSwitchMode(cfg.modelSwitchMode || defaults.modelSwitchMode),\n            setModelEndpoint: normalizeSetModelEndpoint(cfg.setModelEndpoint || defaults.setModelEndpoint),\n            rootDir: normalizedRootDir || normalizedImportPrefix,\n            importPathPrefix: normalizedImportPrefix || normalizedRootDir,\n            models: Array.isArray(cfg.models) ? cfg.models : defaults.models,\n            voices: Array.isArray(cfg.voices) ? cfg.voices : defaults.voices,\n        });\n        const normalizedModels = merged.models.length > 0\n            ? normalizeGptSoVitsModelsForStoreInternal(merged.models, merged)\n            : legacyVoicesToModels(merged.voices, merged);\n        return Object.assign({}, merged, {\n            models: normalizedModels,\n        });\n    }\n    catch {\n        return defaults;\n    }\n}\nexport function normalizeGptSoVitsVoice(voice) {\n    if (!voice)\n        return null;\n    const rawCfg = voice?.gptSoVits || {};\n    const name = String(voice.name || voice.voice || voice.speaker || rawCfg.name || '').trim();\n    if (!name)\n        return null;\n    const refAudioPath = normalizePathSep(String(voice.refAudioPath ||\n        voice.ref_audio_path ||\n        voice.ref_audio ||\n        voice.ref ||\n        rawCfg.refAudioPath ||\n        '').trim());\n    const promptText = String(voice.promptText || voice.prompt_text || rawCfg.promptText || '').trim();\n    const promptLang = String(voice.promptLang || voice.prompt_lang || rawCfg.promptLang || '').trim();\n    const textLang = String(voice.textLang || voice.text_lang || rawCfg.textLang || '').trim();\n    const gptWeightsPath = normalizePathSep(String(voice.gptWeightsPath || voice.gpt_weights_path || voice.gptPath || voice.gpt || rawCfg.gptWeightsPath || '').trim());\n    const sovitsWeightsPath = normalizePathSep(String(voice.sovitsWeightsPath ||\n        voice.sovits_weights_path ||\n        voice.sovitsPath ||\n        voice.sovits ||\n        rawCfg.sovitsWeightsPath ||\n        '').trim());\n    const modelSwitchMode = normalizeGptSoVitsSwitchMode(voice.modelSwitchMode || voice.model_switch_mode || rawCfg.modelSwitchMode || '');\n    const setModelEndpoint = normalizeSetModelEndpoint(voice.setModelEndpoint || voice.set_model_endpoint || rawCfg.setModelEndpoint || '/set_model');\n    const strictWeightSwitch = !!(voice.strictWeightSwitch ??\n        voice.strict_weight_switch ??\n        rawCfg.strictWeightSwitch);\n    const desc = String(voice.desc || voice.description || '').trim();\n    return {\n        name,\n        value: name,\n        source: TTS_PROVIDER.GPT_SOVITS_V2,\n        resourceId: null,\n        desc: desc || 'GPT-SoVITS',\n        gptSoVits: {\n            refAudioPath,\n            promptText,\n            promptLang,\n            textLang,\n            gptWeightsPath,\n            sovitsWeightsPath,\n            modelSwitchMode,\n            setModelEndpoint,\n            strictWeightSwitch,\n        },\n    };\n}\nfunction toGptSoVitsVoiceConfig(voice, globalDefaults = null) {\n    const normalized = normalizeGptSoVitsVoice(voice);\n    if (!normalized)\n        return null;\n    const cfg = normalized.gptSoVits || {};\n    const globalCfg = globalDefaults || getGptSoVitsConfig();\n    const desc = String(voice?.desc || voice?.description || '').trim();\n    return {\n        name: normalized.name,\n        desc,\n        refAudioPath: normalizePathSep(String(cfg.refAudioPath || '').trim()),\n        promptText: String(cfg.promptText || '').trim(),\n        promptLang: String(cfg.promptLang || '').trim(),\n        textLang: String(cfg.textLang || '').trim(),\n        gptWeightsPath: normalizePathSep(String(cfg.gptWeightsPath || '').trim()),\n        sovitsWeightsPath: normalizePathSep(String(cfg.sovitsWeightsPath || '').trim()),\n        modelSwitchMode: normalizeGptSoVitsSwitchMode(cfg.modelSwitchMode || globalCfg.modelSwitchMode),\n        setModelEndpoint: normalizeSetModelEndpoint(cfg.setModelEndpoint || globalCfg.setModelEndpoint),\n        strictWeightSwitch: !!(cfg.strictWeightSwitch ?? globalCfg.strictWeightSwitch),\n    };\n}\nfunction legacyVoicesToModels(voiceList, globalDefaults) {\n    const models = [];\n    for (const [index, voice] of safeArray(voiceList).entries()) {\n        const cfg = toGptSoVitsVoiceConfig(voice, globalDefaults);\n        if (!cfg)\n            continue;\n        models.push({\n            id: buildGptSoVitsModelId(cfg.name || `model_${index + 1}`),\n            name: cfg.name || `${index + 1}`,\n            enabled: true,\n            desc: cfg.desc || '',\n            paths: {\n                gptWeightsPath: cfg.gptWeightsPath || '',\n                sovitsWeightsPath: cfg.sovitsWeightsPath || '',\n                defaultRefAudioPath: cfg.refAudioPath || '',\n            },\n            params: {\n                promptText: cfg.promptText || '',\n                promptLang: cfg.promptLang || 'zh',\n                textLang: cfg.textLang || globalDefaults.textLang || 'auto',\n                textSplitMethod: globalDefaults.textSplitMethod || 'cut5',\n                speedFactor: toFiniteNumber(globalDefaults.speedFactor, 1),\n                mediaType: globalDefaults.mediaType || 'wav',\n                streamingMode: !!globalDefaults.streamingMode,\n                modelSwitchMode: normalizeGptSoVitsSwitchMode(globalDefaults.modelSwitchMode || 'set_weights'),\n                setModelEndpoint: normalizeSetModelEndpoint(globalDefaults.setModelEndpoint || '/set_model'),\n                strictWeightSwitch: !!globalDefaults.strictWeightSwitch,\n            },\n            refAudios: cfg.refAudioPath\n                ? [\n                    {\n                        id: 'ref_default',\n                        name: '',\n                        path: cfg.refAudioPath,\n                        promptText: cfg.promptText || '',\n                        promptLang: cfg.promptLang || 'zh',\n                        textLang: cfg.textLang || globalDefaults.textLang || 'auto',\n                    },\n                ]\n                : [],\n            defaultRefId: cfg.refAudioPath ? 'ref_default' : '',\n            expressionRefMap: {},\n        });\n    }\n    return normalizeGptSoVitsModelsForStoreInternal(models, globalDefaults);\n}\nexport function normalizeGptSoVitsModelsForStore(modelList, globalDefaults = null) {\n    const defaults = globalDefaults || getGptSoVitsConfig();\n    return normalizeGptSoVitsModelsForStoreInternal(modelList, defaults);\n}\nexport function isGptSoVitsVoiceUsable(voice) {\n    const cfg = toGptSoVitsVoiceConfig(voice);\n    return !!String(cfg?.refAudioPath || '').trim();\n}\nexport function normalizeGptSoVitsVoicesForStore(voiceList, globalDefaults = null) {\n    const out = [];\n    let ignoredCount = 0;\n    let missingRefCount = 0;\n    for (const voice of Array.isArray(voiceList) ? voiceList : []) {\n        const cfg = toGptSoVitsVoiceConfig(voice, globalDefaults);\n        if (!cfg) {\n            ignoredCount += 1;\n            continue;\n        }\n        if (!cfg.refAudioPath)\n            missingRefCount += 1;\n        out.push(cfg);\n    }\n    return { voices: out, ignoredCount, missingRefCount };\n}\nexport function pickFirstUsableGptSoVitsVoice(voiceList) {\n    for (const voice of Array.isArray(voiceList) ? voiceList : []) {\n        if (isGptSoVitsVoiceUsable(voice))\n            return voice;\n    }\n    return null;\n}\nfunction getFileExtLower(name) {\n    const s = String(name || '');\n    const idx = s.lastIndexOf('.');\n    return idx >= 0 ? s.slice(idx + 1).toLowerCase() : '';\n}\nfunction stripFileExt(name) {\n    const s = String(name || '');\n    return s.replace(/\\.[^./\\\\]+$/, '');\n}\nexport function isAbsoluteFileSystemPath(pathStr) {\n    const p = String(pathStr || '').trim();\n    if (!p)\n        return false;\n    if (/^[a-zA-Z]:[\\\\/]/.test(p))\n        return true;\n    if (p.startsWith('\\\\\\\\'))\n        return true;\n    if (p.startsWith('/'))\n        return true;\n    return false;\n}\nfunction joinPathPrefix(prefix, relPath) {\n    const p = String(prefix || '').trim();\n    const rel = String(relPath || '').trim();\n    if (!p)\n        return rel;\n    const useBackslash = p.includes('\\\\') && !p.includes('/');\n    const sep = useBackslash ? '\\\\' : '/';\n    const cleanPrefix = p.replace(/[\\\\/]+$/, '');\n    const cleanRel = rel.replace(/^[\\\\/]+/, '');\n    if (!cleanRel)\n        return cleanPrefix;\n    const normalizedPrefix = useBackslash ? cleanPrefix.replace(/[\\\\/]+/g, '\\\\') : cleanPrefix.replace(/[\\\\/]+/g, '/');\n    const normalizedRel = useBackslash ? cleanRel.replace(/[\\\\/]+/g, '\\\\') : cleanRel.replace(/[\\\\/]+/g, '/');\n    const lowerPrefix = normalizedPrefix.toLowerCase();\n    const lowerRel = normalizedRel.toLowerCase();\n    if (lowerRel === lowerPrefix || lowerRel.startsWith(`${lowerPrefix}${sep}`)) {\n        return normalizedRel;\n    }\n    const prefixSegs = normalizedPrefix.split(/[\\\\/]+/).filter(Boolean);\n    const relSegs = normalizedRel.split(/[\\\\/]+/).filter(Boolean);\n    if (prefixSegs.length > 0 && relSegs.length > 0) {\n        const tail = prefixSegs[prefixSegs.length - 1];\n        const head = relSegs[0];\n        if (tail && head && tail.toLowerCase() === head.toLowerCase()) {\n            return prefixSegs.concat(relSegs.slice(1)).join(sep);\n        }\n    }\n    return `${normalizedPrefix}${sep}${normalizedRel}`;\n}\nfunction inferLangFromText(text) {\n    const t = String(text || '');\n    if (/[\\u3040-\\u30ff]/.test(t))\n        return 'ja';\n    if (/[\\uac00-\\ud7af]/.test(t))\n        return 'ko';\n    if (/[a-zA-Z]/.test(t) && !/[\\u4e00-\\u9fff]/.test(t))\n        return 'en';\n    if (/[\\u4e00-\\u9fff]/.test(t))\n        return 'zh';\n    return 'zh';\n}\nfunction cleanPromptTextFromFilenameBase(baseName) {\n    let t = String(baseName || '').trim();\n    if (!t)\n        return '';\n    t = t.replace(/^[\\s\\uFEFF]*(?:[\\(\\[][^\\)\\]]{1,10}[\\)\\]])\\s*/g, '');\n    t = t.replace(/[.!?,]+$/g, '');\n    t = t.replace(/\\.{3,}/g, '...');\n    return t.trim();\n}\nfunction cleanVoiceNameFromWeightsBase(baseName) {\n    let t = String(baseName || '').trim();\n    if (!t)\n        return '';\n    t = t.replace(/^[A-Za-z0-9]{2,8}[_-]+/, '');\n    const suffixes = [\n        /[_-]v\\d+(?:proplus|pro|pp|p)?$/i,\n        /[_-](?:v2pp|v2p|v2|v3|v4)$/i,\n        /[_-](?:proplus|pro|pp|p)$/i,\n        /[_-](?:gpt|sovits|so-vits|vits)$/i,\n    ];\n    for (let i = 0; i < 4; i++) {\n        const before = t;\n        for (const re of suffixes)\n            t = t.replace(re, '');\n        if (before === t)\n            break;\n        t = t.trim();\n    }\n    return t.trim();\n}\nfunction pickLargestFile(files) {\n    if (!Array.isArray(files) || files.length === 0)\n        return null;\n    return files.slice().sort((a, b) => Number(b?.size || 0) - Number(a?.size || 0))[0] || null;\n}\nfunction pickBestAudioFile(audioFiles) {\n    if (!Array.isArray(audioFiles) || audioFiles.length === 0)\n        return null;\n    const candidates = audioFiles.map(file => {\n        const base = stripFileExt(file.name);\n        const promptText = cleanPromptTextFromFilenameBase(base);\n        const ext = getFileExtLower(file.name);\n        const extScore = ext === 'wav' ? 3 : ext === 'flac' ? 2 : ext === 'ogg' ? 1 : 0;\n        const lenScore = Math.min(200, promptText.length);\n        return { file, score: extScore * 1000 + lenScore };\n    });\n    candidates.sort((a, b) => b.score - a.score);\n    return candidates[0]?.file || null;\n}\nfunction weightsStemKey(fileName) {\n    let stem = String(stripFileExt(fileName) || '').toLowerCase().trim();\n    if (!stem)\n        return '';\n    stem = stem.replace(/[\\s._-]+/g, '');\n    stem = stem.replace(/(gpt|sovits|sovit|vits)+$/g, '');\n    return stem;\n}\nfunction collectWeightCandidates(ckpts, pths) {\n    const ckptList = Array.isArray(ckpts) ? ckpts.slice() : [];\n    const pthList = Array.isArray(pths) ? pths.slice() : [];\n    if (ckptList.length === 0 && pthList.length === 0)\n        return [];\n    ckptList.sort((a, b) => Number(b?.size || 0) - Number(a?.size || 0));\n    pthList.sort((a, b) => Number(b?.size || 0) - Number(a?.size || 0));\n    const ckptByBase = new Map();\n    const ckptByStem = new Map();\n    ckptList.forEach(file => {\n        const base = stripFileExt(file.name).toLowerCase();\n        if (!ckptByBase.has(base))\n            ckptByBase.set(base, file);\n        const stem = weightsStemKey(file.name);\n        if (stem && !ckptByStem.has(stem))\n            ckptByStem.set(stem, file);\n    });\n    const out = [];\n    const used = new Set();\n    const addCandidate = (gptFile, sovitsFile) => {\n        if (!gptFile && !sovitsFile)\n            return;\n        const key = `${gptFile?.name || ''}::${sovitsFile?.name || ''}`.toLowerCase();\n        if (used.has(key))\n            return;\n        used.add(key);\n        out.push({ gptFile: gptFile || null, sovitsFile: sovitsFile || null });\n    };\n    pthList.forEach(pth => {\n        const base = stripFileExt(pth.name).toLowerCase();\n        const matched = ckptByBase.get(base) || null;\n        if (matched)\n            addCandidate(matched, pth);\n    });\n    pthList.forEach(pth => {\n        const stem = weightsStemKey(pth.name);\n        const matched = stem ? ckptByStem.get(stem) || null : null;\n        if (matched)\n            addCandidate(matched, pth);\n    });\n    if (out.length === 0) {\n        addCandidate(pickLargestFile(ckptList), pickLargestFile(pthList));\n    }\n    const usedGpt = new Set(out.map(item => item.gptFile?.name).filter(Boolean));\n    const usedSovits = new Set(out.map(item => item.sovitsFile?.name).filter(Boolean));\n    pthList.forEach(file => {\n        if (!usedSovits.has(file.name))\n            addCandidate(null, file);\n    });\n    ckptList.forEach(file => {\n        if (!usedGpt.has(file.name))\n            addCandidate(file, null);\n    });\n    return out;\n}\nexport function inferGptSoVitsVoicesFromFolderFiles(fileList, importPathPrefix = '') {\n    const files = Array.from(fileList || []).filter(Boolean);\n    if (files.length === 0)\n        return [];\n    const groups = new Map();\n    for (const file of files) {\n        const rel = normalizePathSep(file.webkitRelativePath || file.name || '');\n        const dir = rel.split('/').slice(0, -1).join('/');\n        const key = dir || '__root__';\n        if (!groups.has(key))\n            groups.set(key, []);\n        groups.get(key).push(file);\n    }\n    const result = [];\n    for (const [dirKey, groupFiles] of groups.entries()) {\n        const ckpts = [];\n        const pths = [];\n        const audios = [];\n        for (const file of groupFiles) {\n            const ext = getFileExtLower(file.name);\n            if (ext === 'ckpt')\n                ckpts.push(file);\n            else if (ext === 'pth')\n                pths.push(file);\n            else if (['wav', 'mp3', 'flac', 'ogg', 'm4a'].includes(ext))\n                audios.push(file);\n        }\n        const audioFile = pickBestAudioFile(audios);\n        const promptText = audioFile ? cleanPromptTextFromFilenameBase(stripFileExt(audioFile.name)) : '';\n        const inferredLang = promptText ? inferLangFromText(promptText) : 'zh';\n        const toServerPath = (file) => {\n            const abs = typeof file?.path === 'string' ? String(file.path) : '';\n            if (isAbsoluteFileSystemPath(abs))\n                return abs;\n            const rel = normalizePathSep(file?.webkitRelativePath || file?.name || '');\n            return joinPathPrefix(importPathPrefix, rel);\n        };\n        const dirName = dirKey !== '__root__' ? dirKey.split('/').pop() || '' : '';\n        const candidatesRaw = collectWeightCandidates(ckpts, pths);\n        const candidates = candidatesRaw.length > 0 ? candidatesRaw : [{ gptFile: null, sovitsFile: null }];\n        const usedName = new Set();\n        for (const pair of candidates) {\n            const gptFile = pair.gptFile || null;\n            const sovitsFile = pair.sovitsFile || null;\n            const weightsBase = stripFileExt((sovitsFile || gptFile || audioFile || {}).name || '');\n            const baseName = cleanVoiceNameFromWeightsBase(weightsBase) || cleanVoiceNameFromWeightsBase(dirName) || '';\n            let voiceName = baseName;\n            let idx = 2;\n            while (usedName.has(voiceName)) {\n                voiceName = `${baseName}_${idx++}`;\n            }\n            usedName.add(voiceName);\n            const voice = {\n                name: voiceName,\n                desc: '',\n                refAudioPath: audioFile ? toServerPath(audioFile) : '',\n                promptText,\n                promptLang: inferredLang,\n                textLang: inferredLang,\n                gptWeightsPath: gptFile ? toServerPath(gptFile) : '',\n                sovitsWeightsPath: sovitsFile ? toServerPath(sovitsFile) : '',\n                modelSwitchMode: 'set_weights',\n                setModelEndpoint: '/set_model',\n                strictWeightSwitch: false,\n            };\n            if (voice.refAudioPath) {\n                result.push(voice);\n            }\n        }\n    }\n    return result;\n}\nfunction inferExpressionTagFromAudioName(baseName) {\n    const name = String(baseName || '')\n        .trim()\n        .toLowerCase();\n    if (!name)\n        return '';\n    const rules = [\n        { tag: '', patterns: ['happy', 'smile', 'laugh', 'joy', '', '', '', '', ''] },\n        { tag: '', patterns: ['angry', 'mad', 'rage', '', '', ''] },\n        { tag: '', patterns: ['sad', 'cry', 'sob', '', '', ''] },\n        { tag: '', patterns: ['surprise', 'wow', '', '', ''] },\n        { tag: '', patterns: ['shy', 'blush', '', ''] },\n        { tag: '', patterns: ['calm', 'normal', 'neutral', '', '', ''] },\n    ];\n    for (const rule of rules) {\n        if (rule.patterns.some(pattern => name.includes(pattern)))\n            return rule.tag;\n    }\n    return '';\n}\nexport function inferGptSoVitsModelsFromFolderFiles(fileList, importPathPrefix = '', importOptions = {}) {\n    const files = Array.from(fileList || []).filter(Boolean);\n    if (files.length === 0)\n        return [];\n    const normalizedImportPrefix = normalizePathSep(String(importPathPrefix || '').trim());\n    const rootHintRaw = String(importOptions?.relativeRootName || '').trim();\n    const normalizedRootHint = normalizePathSep(rootHintRaw).replace(/^[\\\\/]+|[\\\\/]+$/g, '');\n    const normalizeRelativePath = (file) => {\n        let rel = normalizePathSep(String(file?.webkitRelativePath || file?.name || '').trim()).replace(/^[\\\\/]+/, '');\n        if (!rel)\n            return '';\n        if (!normalizedRootHint)\n            return rel;\n        const lowerRel = rel.toLowerCase();\n        const lowerRoot = normalizedRootHint.toLowerCase();\n        if (lowerRel === lowerRoot || lowerRel.startsWith(`${lowerRoot}/`))\n            return rel;\n        return `${normalizedRootHint}/${rel}`;\n    };\n    const groups = new Map();\n    for (const file of files) {\n        const rel = normalizeRelativePath(file);\n        const dir = rel.split('/').slice(0, -1).join('/');\n        const key = dir || '__root__';\n        if (!groups.has(key))\n            groups.set(key, []);\n        groups.get(key).push(file);\n    }\n    const cfg = getGptSoVitsConfig();\n    const models = [];\n    for (const [dirKey, groupFiles] of groups.entries()) {\n        const ckpts = [];\n        const pths = [];\n        const audios = [];\n        for (const file of groupFiles) {\n            const ext = getFileExtLower(file.name);\n            if (ext === 'ckpt')\n                ckpts.push(file);\n            else if (ext === 'pth')\n                pths.push(file);\n            else if (['wav', 'mp3', 'flac', 'ogg', 'm4a'].includes(ext))\n                audios.push(file);\n        }\n        if (ckpts.length === 0 && pths.length === 0 && audios.length === 0)\n            continue;\n        const toServerPath = (file) => {\n            const abs = normalizePathSep(typeof file?.path === 'string' ? String(file.path) : '');\n            if (isAbsoluteFileSystemPath(abs))\n                return abs;\n            const rel = normalizeRelativePath(file);\n            if (!rel)\n                return '';\n            const prefixed = normalizePathSep(joinPathPrefix(normalizedImportPrefix, rel));\n            return prefixed || rel;\n        };\n        const audioCandidates = audios\n            .map(file => {\n            const base = stripFileExt(file.name);\n            const promptText = cleanPromptTextFromFilenameBase(base);\n            const inferredTag = inferExpressionTagFromAudioName(base);\n            return { file, promptText, inferredTag };\n        })\n            .filter(item => !!item.file);\n        const bestAudio = pickBestAudioFile(audios);\n        const weightCandidatesRaw = collectWeightCandidates(ckpts, pths);\n        const weightCandidates = weightCandidatesRaw.length > 0 ? weightCandidatesRaw : [{ gptFile: null, sovitsFile: null }];\n        const dirName = dirKey !== '__root__' ? dirKey.split('/').pop() || '' : '';\n        const groupNameUsed = new Set();\n        for (const pair of weightCandidates) {\n            const gptFile = pair.gptFile || null;\n            const sovitsFile = pair.sovitsFile || null;\n            const weightsBase = stripFileExt((sovitsFile || gptFile || bestAudio || {}).name || '');\n            const baseName = cleanVoiceNameFromWeightsBase(weightsBase) || cleanVoiceNameFromWeightsBase(dirName) || '';\n            let modelName = baseName;\n            let idx = 2;\n            while (groupNameUsed.has(modelName)) {\n                modelName = `${baseName}_${idx++}`;\n            }\n            groupNameUsed.add(modelName);\n            const refAudios = [];\n            const expressionRefMap = {};\n            const defaultRefBase = bestAudio ? normalizePathSep(toServerPath(bestAudio)) : '';\n            audioCandidates.forEach((item, audioIndex) => {\n                const path = normalizePathSep(toServerPath(item.file));\n                if (!path)\n                    return;\n                const id = `ref_${audioIndex + 1}`;\n                const name = stripFileExt(item.file.name) || `${audioIndex + 1}`;\n                const text = String(item.promptText || '').trim();\n                const lang = text ? inferLangFromText(text) : 'zh';\n                refAudios.push({\n                    id,\n                    name,\n                    path,\n                    promptText: text,\n                    promptLang: lang,\n                    textLang: lang,\n                });\n                if (item.inferredTag && !expressionRefMap[item.inferredTag]) {\n                    expressionRefMap[item.inferredTag] = id;\n                }\n            });\n            const defaultRef = refAudios.find(item => item.path === defaultRefBase) || refAudios[0] || null;\n            const defaultPromptText = String(defaultRef?.promptText || '').trim();\n            const defaultLang = defaultPromptText ? inferLangFromText(defaultPromptText) : 'zh';\n            const model = {\n                id: buildGptSoVitsModelId(modelName),\n                name: modelName,\n                enabled: true,\n                desc: '',\n                paths: {\n                    gptWeightsPath: gptFile ? normalizePathSep(toServerPath(gptFile)) : '',\n                    sovitsWeightsPath: sovitsFile ? normalizePathSep(toServerPath(sovitsFile)) : '',\n                    defaultRefAudioPath: defaultRef?.path || '',\n                },\n                params: {\n                    promptText: defaultPromptText,\n                    promptLang: defaultRef?.promptLang || defaultLang,\n                    textLang: defaultRef?.textLang || defaultLang,\n                    textSplitMethod: cfg.textSplitMethod || 'cut5',\n                    speedFactor: toFiniteNumber(cfg.speedFactor, 1),\n                    mediaType: cfg.mediaType || 'wav',\n                    streamingMode: !!cfg.streamingMode,\n                    modelSwitchMode: normalizeGptSoVitsSwitchMode(cfg.modelSwitchMode || 'set_weights'),\n                    setModelEndpoint: normalizeSetModelEndpoint(cfg.setModelEndpoint || '/set_model'),\n                    strictWeightSwitch: !!cfg.strictWeightSwitch,\n                },\n                refAudios,\n                defaultRefId: defaultRef?.id || '',\n                expressionRefMap,\n            };\n            if (model.paths.defaultRefAudioPath) {\n                models.push(model);\n            }\n        }\n    }\n    return normalizeGptSoVitsModelsForStore(models, cfg);\n}\nexport async function getGptSoVitsVoiceListAsync() {\n    const cfg = getGptSoVitsConfig();\n    const modelList = safeArray(cfg.models);\n    if (modelList.length > 0) {\n        return modelList.map(model => buildRuntimeVoiceFromModel(model, cfg)).filter(Boolean);\n    }\n    const list = Array.isArray(cfg.voices) ? cfg.voices : [];\n    return list.map(normalizeGptSoVitsVoice).filter(Boolean);\n}\nexport function getGptSoVitsVoiceList() {\n    try {\n        const cfg = getGptSoVitsConfig();\n        const modelList = safeArray(cfg.models);\n        if (modelList.length > 0) {\n            return modelList.map(model => buildRuntimeVoiceFromModel(model, cfg)).filter(Boolean);\n        }\n        const list = Array.isArray(cfg.voices) ? cfg.voices : [];\n        return list.map(normalizeGptSoVitsVoice).filter(Boolean);\n    }\n    catch {\n        return [];\n    }\n}\n// LittleWhiteBox TTS \nlet _lwbTtsCache = null;\nlet _lwbTtsCacheTime = 0;\nconst LWB_TTS_CACHE_MS = 5000;\nlet _edgeTtsCache = null;\nlet _edgeTtsCacheTime = 0;\nconst EDGE_TTS_CACHE_MS = 2 * 60 * 1000;\nexport async function getEdgeDirectVoiceListAsync() {\n    const now = Date.now();\n    if (_edgeTtsCache && now - _edgeTtsCacheTime <= EDGE_TTS_CACHE_MS) {\n        return _edgeTtsCache;\n    }\n    try {\n        const voices = await fetchEdgeVoices();\n        if (voices.length > 0) {\n            _edgeTtsCache = voices;\n            _edgeTtsCacheTime = now;\n            return voices;\n        }\n    }\n    catch (e) {\n        console.warn(`[${SCRIPT_NAME}] EdgeTTS :`, e);\n    }\n    const fallback = getEdgeFallbackVoices();\n    _edgeTtsCache = fallback;\n    _edgeTtsCacheTime = now;\n    return fallback;\n}\nexport function getEdgeDirectVoiceList() {\n    if (_edgeTtsCache && _edgeTtsCache.length > 0) {\n        return _edgeTtsCache;\n    }\n    return getEdgeFallbackVoices();\n}\nasync function fetchLittleWhiteBoxTTSConfig() {\n    try {\n        const response = await fetch('/user/files/LittleWhiteBox_TTS.json', { cache: 'no-cache' });\n        if (!response.ok)\n            return null;\n        const data = await response.json();\n        return data?.volc?.mySpeakers || null;\n    }\n    catch (e) {\n        console.log(`[${SCRIPT_NAME}]  LittleWhiteBox TTS :`, e);\n        return null;\n    }\n}\nexport async function getTTSVoiceListAsync() {\n    const provider = getTTSProvider();\n    if (provider === TTS_PROVIDER.GPT_SOVITS_V2) {\n        return getGptSoVitsVoiceListAsync();\n    }\n    if (provider === TTS_PROVIDER.EDGE_TTS_DIRECT) {\n        return getEdgeDirectVoiceListAsync();\n    }\n    const now = Date.now();\n    if (!_lwbTtsCache || now - _lwbTtsCacheTime > LWB_TTS_CACHE_MS) {\n        const mySpeakers = await fetchLittleWhiteBoxTTSConfig();\n        if (mySpeakers && mySpeakers.length > 0) {\n            _lwbTtsCache = mySpeakers.map((s) => ({\n                name: s.name,\n                value: s.value,\n                source: s.source || (isFreeVoice(s.value) ? 'free' : 'auth'),\n                resourceId: s.resourceId || inferResourceId(s.value),\n                desc: getVoiceDesc(s.value),\n            }));\n            _lwbTtsCacheTime = now;\n            return _lwbTtsCache;\n        }\n    }\n    else if (_lwbTtsCache) {\n        return _lwbTtsCache;\n    }\n    const topAny = getTopWindow();\n    const xbTts = topAny?.xiaobaixTts || window?.xiaobaixTts;\n    if (xbTts?.getConfig) {\n        const config = xbTts.getConfig();\n        const mySpeakers = config?.volc?.mySpeakers || [];\n        if (mySpeakers.length > 0) {\n            return mySpeakers.map((s) => ({\n                name: s.name,\n                value: s.value,\n                source: s.source || (isFreeVoice(s.value) ? 'free' : 'auth'),\n                resourceId: s.resourceId || inferResourceId(s.value),\n                desc: getVoiceDesc(s.value),\n            }));\n        }\n    }\n    const xbVoiceData = topAny?.XB_TTS_VOICE_DATA || window?.XB_TTS_VOICE_DATA;\n    if (Array.isArray(xbVoiceData) && xbVoiceData.length > 0) {\n        return xbVoiceData.slice(0, 20).map((v) => ({\n            name: v.name,\n            value: v.value,\n            source: inferSource(v.value),\n            resourceId: inferResourceId(v.value),\n            desc: v.scene || '',\n        }));\n    }\n    return getDefaultFreeVoices();\n}\nexport function getTTSVoiceList() {\n    const provider = getTTSProvider();\n    if (provider === TTS_PROVIDER.GPT_SOVITS_V2) {\n        return getGptSoVitsVoiceList();\n    }\n    if (provider === TTS_PROVIDER.EDGE_TTS_DIRECT) {\n        return getEdgeDirectVoiceList();\n    }\n    if (_lwbTtsCache) {\n        return _lwbTtsCache;\n    }\n    const topAny = getTopWindow();\n    const xbTts = topAny?.xiaobaixTts || window?.xiaobaixTts;\n    if (xbTts?.getConfig) {\n        const config = xbTts.getConfig();\n        const mySpeakers = config?.volc?.mySpeakers || [];\n        if (mySpeakers.length > 0) {\n            return mySpeakers.map((s) => ({\n                name: s.name,\n                value: s.value,\n                source: s.source || (isFreeVoice(s.value) ? 'free' : 'auth'),\n                resourceId: s.resourceId || inferResourceId(s.value),\n                desc: getVoiceDesc(s.value),\n            }));\n        }\n    }\n    const xbVoiceData = topAny?.XB_TTS_VOICE_DATA || window?.XB_TTS_VOICE_DATA;\n    if (Array.isArray(xbVoiceData) && xbVoiceData.length > 0) {\n        return xbVoiceData.slice(0, 20).map((v) => ({\n            name: v.name,\n            value: v.value,\n            source: inferSource(v.value),\n            resourceId: inferResourceId(v.value),\n            desc: v.scene || '',\n        }));\n    }\n    return getDefaultFreeVoices();\n}\nfunction isFreeVoice(value) {\n    const freeVoices = [\n        'female_1',\n        'female_2',\n        'female_3',\n        'female_4',\n        'female_5',\n        'female_6',\n        'female_7',\n        'male_1',\n        'male_2',\n        'male_3',\n        'male_4',\n    ];\n    return freeVoices.includes(value);\n}\nfunction inferSource(value) {\n    return isFreeVoice(value) ? 'free' : 'auth';\n}\nexport function inferResourceId(value) {\n    const lower = (value || '').toLowerCase();\n    if (lower.startsWith('icl_') || lower.startsWith('s_'))\n        return 'seed-icl-2.0';\n    if (lower.startsWith('saturn_') ||\n        lower.startsWith('uranus_') ||\n        lower.includes('_saturn_') ||\n        lower.includes('_uranus_')) {\n        return 'seed-tts-2.0';\n    }\n    return 'seed-tts-1.0';\n}\nfunction getVoiceDesc(value) {\n    const descMap = {\n        female_1: '()',\n        female_2: '()',\n        female_3: '()',\n        female_4: '()',\n        female_5: '()',\n        female_6: '()',\n        female_7: '()',\n        male_1: '()',\n        male_2: '()',\n        male_3: '()',\n        male_4: '()',\n    };\n    return descMap[value] || '';\n}\nfunction getDefaultFreeVoices() {\n    return [\n        { name: '', value: 'female_1', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'male_1', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'female_2', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'female_3', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'female_4', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'female_5', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'female_6', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'female_7', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'male_2', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'male_3', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'male_4', source: 'free', resourceId: null, desc: '()' },\n    ];\n}\nexport async function resolveVoiceByName(voiceName) {\n    if (!voiceName)\n        return null;\n    const voiceList = await getTTSVoiceListAsync();\n    let voice = voiceList.find(v => v.name === voiceName);\n    if (voice)\n        return voice;\n    voice = voiceList.find(v => v.value === voiceName);\n    if (voice)\n        return voice;\n    const provider = getTTSProvider();\n    const defaultVoice = provider === TTS_PROVIDER.GPT_SOVITS_V2\n        ? (pickFirstUsableGptSoVitsVoice(voiceList) || voiceList[0])\n        : provider === TTS_PROVIDER.EDGE_TTS_DIRECT\n            ? voiceList[0]\n            : voiceList[0];\n    if (defaultVoice) {\n        console.warn(`[${SCRIPT_NAME}]  \"${voiceName}\": ${defaultVoice.name}`);\n        return defaultVoice;\n    }\n    return null;\n}\n// TTS_VOICE_LIST getter \ntry {\n    Object.defineProperty(getTopWindow(), 'TTS_VOICE_LIST', {\n        get: getTTSVoiceList,\n        configurable: true,\n    });\n}\ncatch {\n    // ignore\n}\nexport function getTTSEnabled() {\n    try {\n        const saved = localStorage.getItem(getTtsEnabledKey());\n        if (saved === null)\n            return true;\n        return saved === 'true';\n    }\n    catch {\n        return true;\n    }\n}\nexport function setTTSEnabled(enabled) {\n    try {\n        localStorage.setItem(getTtsEnabledKey(), String(enabled));\n    }\n    catch (e) {\n        console.error(`[${SCRIPT_NAME}] TTS:`, e);\n    }\n}\nexport function getCharacterTTSVoice(characterId) {\n    try {\n        const map = JSON.parse(localStorage.getItem(getCharTtsVoiceKey()) || '{}');\n        return map[characterId] || null;\n    }\n    catch {\n        return null;\n    }\n}\nexport function setCharacterTTSVoice(characterId, voiceName) {\n    try {\n        const map = JSON.parse(localStorage.getItem(getCharTtsVoiceKey()) || '{}');\n        if (voiceName) {\n            map[characterId] = voiceName;\n        }\n        else {\n            delete map[characterId];\n        }\n        localStorage.setItem(getCharTtsVoiceKey(), JSON.stringify(map));\n    }\n    catch (e) {\n        console.error(`[${SCRIPT_NAME}] TTS:`, e);\n    }\n}\nexport function getAllCharacterTTSVoices() {\n    try {\n        return JSON.parse(localStorage.getItem(getCharTtsVoiceKey()) || '{}');\n    }\n    catch {\n        return {};\n    }\n}\n","let _db: IDBDatabase | null = null;\n\nexport function getDb(): IDBDatabase | null {\n  return _db;\n}\n\nexport function setDb(value: IDBDatabase | null): void {\n  _db = value;\n}\n","import {\n  DB_NAME,\n  DB_VERSION,\n  SCRIPT_NAME,\n  STORE_LIVE2D_MODELS,\n  STORE_SDK_CACHE,\n} from '../core/constants';\nimport { getDb, setDb } from '../core/state';\n\nfunction ensureLive2DStore(database: IDBDatabase, transaction: IDBTransaction | null): void {\n  if (!database.objectStoreNames.contains(STORE_LIVE2D_MODELS)) {\n    const store = database.createObjectStore(STORE_LIVE2D_MODELS, { keyPath: 'modelId' });\n    store.createIndex('uploadTime', 'uploadTime', { unique: false });\n    store.createIndex('runtimeType', 'runtimeType', { unique: false });\n    return;\n  }\n\n  if (!transaction) return;\n  try {\n    const store = transaction.objectStore(STORE_LIVE2D_MODELS);\n    if (!store.indexNames.contains('uploadTime')) {\n      store.createIndex('uploadTime', 'uploadTime', { unique: false });\n    }\n    if (!store.indexNames.contains('runtimeType')) {\n      store.createIndex('runtimeType', 'runtimeType', { unique: false });\n    }\n  } catch {\n    // ignore\n  }\n}\n\nfunction ensureSdkCacheStore(database: IDBDatabase): void {\n  if (database.objectStoreNames.contains(STORE_SDK_CACHE)) {\n    return;\n  }\n\n  database.createObjectStore(STORE_SDK_CACHE, { keyPath: 'id' });\n}\n\nexport function initDB(): Promise<IDBDatabase> {\n  const existing = getDb();\n  if (existing) return Promise.resolve(existing);\n\n  return new Promise((resolve, reject) => {\n    const request = indexedDB.open(DB_NAME, DB_VERSION);\n    request.onerror = () => reject(request.error ?? new Error('IndexedDB '));\n    request.onsuccess = () => {\n      const db = request.result;\n      setDb(db);\n      try {\n        db.onversionchange = () => {\n          try {\n            db.close();\n          } catch {\n            // ignore\n          }\n          setDb(null);\n        };\n      } catch {\n        // ignore\n      }\n      try {\n        console.log(`[${SCRIPT_NAME}] IndexedDB `);\n      } catch {\n        // ignore\n      }\n      resolve(db);\n    };\n    request.onupgradeneeded = (event) => {\n      const database = request.result;\n      const transaction = (event.target as IDBOpenDBRequest | null)?.transaction ?? null;\n      ensureLive2DStore(database, transaction);\n      ensureSdkCacheStore(database);\n    };\n  });\n}\n","import type { Live2DRuntimeType } from '../core/constants';\n\nexport const LIVE2D_RUNTIME_TYPES = Object.freeze({\n  LEGACY: 'legacy' as Live2DRuntimeType,\n  CUBISM5: 'cubism5' as Live2DRuntimeType,\n});\n\nconst RUNTIME_TYPE_SET = new Set<string>(Object.values(LIVE2D_RUNTIME_TYPES));\n\nfunction parseMajorVersion(value: unknown): number | null {\n  if (typeof value === 'number' && Number.isFinite(value)) {\n    return Math.floor(value);\n  }\n\n  if (typeof value !== 'string') return null;\n  const match = value.trim().match(/(\\d+)(?:\\.\\d+)?/);\n  if (!match) return null;\n  const major = Number.parseInt(match[1], 10);\n  return Number.isFinite(major) ? major : null;\n}\n\nexport function normalizeCubismVersion(value: unknown): number | null {\n  const major = parseMajorVersion(value);\n  if (major == null) return null;\n  if (major >= 5) return 5;\n  if (major >= 3) return 4;\n  if (major === 2) return 2;\n  return null;\n}\n\nexport function inferCubismVersionFromModelJson(modelJson: unknown, fallback: unknown = null): number | null {\n  if (!modelJson || typeof modelJson !== 'object') {\n    return normalizeCubismVersion(fallback);\n  }\n\n  const jsonRecord = modelJson as Record<string, any>;\n  const directCandidates = [\n    jsonRecord.Version,\n    jsonRecord.version,\n    jsonRecord.Meta?.Version,\n    jsonRecord.meta?.version,\n  ];\n\n  for (const candidate of directCandidates) {\n    const parsed = normalizeCubismVersion(candidate);\n    if (parsed != null) return parsed;\n  }\n\n  if (jsonRecord.FileReferences && typeof jsonRecord.FileReferences === 'object') {\n    return normalizeCubismVersion(fallback) ?? 4;\n  }\n\n  if (typeof jsonRecord.model === 'string' || typeof jsonRecord.Model === 'string') {\n    return normalizeCubismVersion(fallback) ?? 2;\n  }\n\n  return normalizeCubismVersion(fallback);\n}\n\nexport function normalizeLive2DRuntimeType(\n  value: unknown,\n  fallback: Live2DRuntimeType | '' = LIVE2D_RUNTIME_TYPES.LEGACY,\n): Live2DRuntimeType | '' {\n  const normalized = String(value || '').trim().toLowerCase();\n  if (RUNTIME_TYPE_SET.has(normalized)) {\n    return normalized as Live2DRuntimeType;\n  }\n  return fallback;\n}\n\nexport function resolveRuntimeTypeFromCubismVersion(cubismVersion: unknown): Live2DRuntimeType {\n  const normalized = normalizeCubismVersion(cubismVersion);\n  if (normalized != null && normalized >= 5) {\n    return LIVE2D_RUNTIME_TYPES.CUBISM5;\n  }\n  return LIVE2D_RUNTIME_TYPES.LEGACY;\n}\n\nexport function resolveLive2DRuntime(modelData: Record<string, any> | null = null): {\n  runtimeType: Live2DRuntimeType;\n  cubismVersion: number | null;\n} {\n  const input = modelData && typeof modelData === 'object' ? modelData : {};\n  const inferredVersion = inferCubismVersionFromModelJson(input.modelJson, input.cubismVersion);\n  const explicitRuntime = normalizeLive2DRuntimeType(input.runtimeType || '', '');\n  const runtimeType = explicitRuntime || resolveRuntimeTypeFromCubismVersion(inferredVersion);\n  const cubismVersion = inferredVersion ?? (runtimeType === LIVE2D_RUNTIME_TYPES.CUBISM5 ? 5 : null);\n\n  return {\n    runtimeType,\n    cubismVersion,\n  };\n}\n\nexport function withResolvedLive2DRuntime<T extends Record<string, any>>(modelData: T | null = null): T & {\n  runtimeType: Live2DRuntimeType;\n  cubismVersion: number | null;\n} {\n  const input = modelData && typeof modelData === 'object' ? modelData : ({} as T);\n  const resolved = resolveLive2DRuntime(input);\n  return {\n    ...input,\n    runtimeType: resolved.runtimeType,\n    cubismVersion: resolved.cubismVersion,\n  };\n}\n","import { LOCAL_LIVE2D_MODEL_SLOT_ID, SCRIPT_NAME, type Live2DRuntimeType, STORE_LIVE2D_MODELS } from '../core/constants';\nimport { getDb } from '../core/state';\nimport { initDB } from './init';\nimport { LIVE2D_RUNTIME_TYPES, normalizeLive2DRuntimeType } from '../live2d/runtime-router';\n\nexport type StoredLive2DTexture = {\n  name: string;\n  data: Blob;\n};\n\nexport type StoredLive2DMotion = {\n  name: string;\n  data: ArrayBuffer;\n};\n\nexport type StoredLive2DExpression = {\n  name: string;\n  file?: string;\n  data: ArrayBuffer;\n};\n\nexport type StoredLive2DModel = {\n  modelId: string;\n  source: 'local';\n  fileName: string;\n  modelJson: any;\n  runtimeType: Live2DRuntimeType;\n  cubismVersion: number | null;\n  moc3Version?: number | null;\n  moc3: ArrayBuffer | null;\n  moc: ArrayBuffer | null;\n  textures: StoredLive2DTexture[];\n  motions: Record<string, StoredLive2DMotion[]>;\n  expressions: StoredLive2DExpression[];\n  physics: ArrayBuffer | null;\n  pose: ArrayBuffer | null;\n  uploadTime: number;\n  fileSize: number;\n};\n\nfunction resolveSlotId(_modelId?: string): string {\n  return LOCAL_LIVE2D_MODEL_SLOT_ID;\n}\n\nfunction normalizeStoredModel(modelData: StoredLive2DModel): StoredLive2DModel {\n  const runtimeType = normalizeLive2DRuntimeType(modelData?.runtimeType, LIVE2D_RUNTIME_TYPES.LEGACY);\n  const cubismVersionRaw = Number(modelData?.cubismVersion);\n  const cubismVersion = Number.isFinite(cubismVersionRaw) ? cubismVersionRaw : null;\n  const uploadTimeRaw = Number(modelData?.uploadTime);\n  const uploadTime = Number.isFinite(uploadTimeRaw) && uploadTimeRaw > 0 ? uploadTimeRaw : Date.now();\n  const fileSizeRaw = Number(modelData?.fileSize);\n  const fileSize = Number.isFinite(fileSizeRaw) && fileSizeRaw >= 0 ? fileSizeRaw : 0;\n\n  return {\n    ...modelData,\n    modelId: resolveSlotId(modelData?.modelId),\n    source: 'local',\n    fileName: String(modelData?.fileName || '').trim() || 'uploaded-live2d.zip',\n    runtimeType,\n    cubismVersion,\n    uploadTime,\n    fileSize,\n    moc3: modelData?.moc3 ?? null,\n    moc: modelData?.moc ?? null,\n    physics: modelData?.physics ?? null,\n    pose: modelData?.pose ?? null,\n    textures: Array.isArray(modelData?.textures) ? modelData.textures : [],\n    motions: modelData?.motions && typeof modelData.motions === 'object' ? modelData.motions : {},\n    expressions: Array.isArray(modelData?.expressions) ? modelData.expressions : [],\n  };\n}\n\nasync function ensureDb(): Promise<IDBDatabase> {\n  if (!getDb()) {\n    await initDB();\n  }\n  const db = getDb();\n  if (!db) {\n    throw new Error('IndexedDB ');\n  }\n  return db;\n}\n\nexport async function saveLive2DModel(modelData: StoredLive2DModel): Promise<void> {\n  const db = await ensureDb();\n  const normalized = normalizeStoredModel(modelData);\n  return new Promise((resolve, reject) => {\n    try {\n      const transaction = db.transaction([STORE_LIVE2D_MODELS], 'readwrite');\n      const store = transaction.objectStore(STORE_LIVE2D_MODELS);\n      store.put(normalized);\n      transaction.oncomplete = () => {\n        try {\n          console.log(`[${SCRIPT_NAME}]  Live2D : ${normalized.fileName}`);\n        } catch {\n          // ignore\n        }\n        resolve();\n      };\n      transaction.onerror = () => reject(transaction.error ?? new Error(''));\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\n\nexport async function getLive2DModel(modelId?: string): Promise<StoredLive2DModel | null> {\n  const db = await ensureDb();\n  const slotId = resolveSlotId(modelId);\n  return new Promise((resolve) => {\n    try {\n      if (!db.objectStoreNames.contains(STORE_LIVE2D_MODELS)) {\n        resolve(null);\n        return;\n      }\n      const transaction = db.transaction([STORE_LIVE2D_MODELS], 'readonly');\n      const store = transaction.objectStore(STORE_LIVE2D_MODELS);\n      const request = store.get(slotId);\n      request.onsuccess = () => {\n        const result = request.result as StoredLive2DModel | undefined;\n        resolve(result ?? null);\n      };\n      request.onerror = () => resolve(null);\n    } catch {\n      resolve(null);\n    }\n  });\n}\n\nexport async function deleteLive2DModel(modelId?: string): Promise<void> {\n  const db = await ensureDb();\n  const slotId = resolveSlotId(modelId);\n  return new Promise((resolve, reject) => {\n    try {\n      if (!db.objectStoreNames.contains(STORE_LIVE2D_MODELS)) {\n        resolve();\n        return;\n      }\n      const transaction = db.transaction([STORE_LIVE2D_MODELS], 'readwrite');\n      const store = transaction.objectStore(STORE_LIVE2D_MODELS);\n      store.delete(slotId);\n      transaction.oncomplete = () => {\n        try {\n          console.log(`[${SCRIPT_NAME}]  Live2D : ${slotId}`);\n        } catch {\n          // ignore\n        }\n        resolve();\n      };\n      transaction.onerror = () => reject(transaction.error ?? new Error(''));\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\n\nexport async function hasLive2DModel(modelId?: string): Promise<boolean> {\n  const model = await getLive2DModel(modelId);\n  return !!(model && model.modelJson);\n}\n","import { SCRIPT_NAME, DB_NAME, DB_VERSION, STORE_SDK_CACHE, type Live2DRuntimeType } from '../core/constants';\r\n\r\ntype Live2DRuntime = {\r\n  pixi: any;\r\n  live2dModel: any;\r\n  pixiVersion: string;\r\n  loadedAt: number;\r\n  runtimeType: Live2DRuntimeType;\r\n};\n\n// ============================================\n// Live2D SDK ?\n// ============================================\nexport const Live2DLoader = {\n  PIXI_URL: 'https://cdn.jsdelivr.net/npm/pixi.js@6.5.10/dist/browser/pixi.min.js',\n  CUBISM4_CORE_URL: 'https://cdn.jsdelivr.net/npm/live2dcubismcore@1.0.2/live2dcubismcore.min.js',\n  CUBISM4_CORE_FALLBACK_URLS: Object.freeze([\n    'https://gcore.jsdelivr.net/npm/live2dcubismcore@1.0.2/live2dcubismcore.min.js',\n    'https://unpkg.com/live2dcubismcore@1.0.2/live2dcubismcore.min.js',\n    'https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js',\n  ]),\n  CUBISM5_CORE_URL: 'https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js',\n  CUBISM5_CORE_FALLBACK_URLS: Object.freeze([\n    'https://cdn.jsdelivr.net/gh/bigmalove/galgame@main/dist/live2dcubismcore.min.js',\n    'https://gcore.jsdelivr.net/gh/bigmalove/galgame@main/dist/live2dcubismcore.min.js',\n  ]),\n  CUBISM2_CORE_URL: 'https://cdn.jsdelivr.net/gh/dylanNew/live2d/webgl/Live2D/lib/live2d.min.js',\n  SDK_URL: 'https://cdn.jsdelivr.net/npm/pixi-live2d-display/dist/index.min.js',\n  CUBISM5_RUNTIME_URL: 'https://cdn.jsdelivr.net/gh/bigmalove/galgame@main/dist/cubism5.runtime.min.js',\n  CUBISM5_RUNTIME_FALLBACK_URLS: Object.freeze([\n    'https://gcore.jsdelivr.net/gh/bigmalove/galgame@main/dist/cubism5.runtime.min.js',\n    'https://cdn.jsdelivr.net/gh/bigmalove/galgame@main/dist/cubism5.js',\n    'https://gcore.jsdelivr.net/gh/bigmalove/galgame@main/dist/cubism5.js',\n  ]),\n  SDK_CACHE_KEY: 'live2d_sdk_v3',\r\n  _READY_MARK: '__desktopPetLive2dLoaderReady_v3',\r\n  _RUNTIME_KEY: '__desktopPetLive2dRuntime_v3',\n\n  isLoaded: false,\n  loadPromise: null,\n  legacyCoreLoaded: false,\n  legacyCorePromise: null,\n  legacyCoreSource: null,\n  cubism5CoreLoaded: false,\n  cubism5CorePromise: null,\n  cubism5CoreSource: null,\n  cubism5RuntimeLoaded: false,\n  cubism5RuntimePromise: null,\n  cubism5RuntimeSource: null,\n  legacyLive2DNamespace: null,\n  cubism5Live2DNamespace: null,\n  patchedResolveUrlPrototypes: new WeakSet(),\n  patchedXhrLoaderNamespaces: new WeakSet(),\n  pixiUrlResolvePatched: false,\n  pixiUrlResolveOriginal: null,\n  legacyCoreObject: null,\n  cubism5CoreObject: null,\n  activeCoreType: null,\n  loadedScriptUrls: new Set(),\n\n  _getUrlBase(url) {\n    try {\n      const resolved = new URL(url, window.location.href);\n      resolved.hash = '';\n      resolved.search = '';\n      const text = resolved.toString();\n      const slashIndex = text.lastIndexOf('/');\n      return slashIndex >= 0 ? text.slice(0, slashIndex + 1) : text;\n    } catch (e) {\n      const value = this._normalizeRuntimeUrl(url);\n      const slashIndex = value.lastIndexOf('/');\n      return slashIndex >= 0 ? value.slice(0, slashIndex + 1) : value;\n    }\n  },\n\n  _ensureCubismCoreLocateFile(_topWindow, coreUrl) {\n    if (!_topWindow) return;\n    const baseUrl = this._getUrlBase(coreUrl);\n    if (!baseUrl) return;\n\n    const existing = _topWindow.Live2DCubismCore;\n    if (existing && typeof existing === 'object') {\n      if (typeof existing.locateFile !== 'function') {\n        existing.locateFile = (path) => `${baseUrl}${path}`;\n      }\n      return;\n    }\n\n    _topWindow.Live2DCubismCore = {\n      locateFile: (path) => `${baseUrl}${path}`,\n    };\n  },\n\n  _loadScriptSrc(url, timeoutMs = 12000) {\n    return new Promise((resolve, reject) => {\n      if (!url) {\n        reject(new Error('Script URL is empty'));\n        return;\n      }\n\n      if (this.loadedScriptUrls.has(url)) {\n        resolve(true);\n        return;\n      }\n\n      const _topWindow = typeof window.parent !== 'undefined' ? window.parent : window;\n      const doc = _topWindow?.document || document;\n      const script = doc.createElement('script');\n      let done = false;\n\n      const finish = (ok, err) => {\n        if (done) return;\n        done = true;\n        if (ok) {\n          this.loadedScriptUrls.add(url);\n          resolve(true);\n        } else {\n          reject(err || new Error(`Script load failed: ${url}`));\n        }\n      };\n\n      const timer = setTimeout(() => {\n        finish(false, new Error(`Script load timeout: ${url}`));\n      }, timeoutMs);\n\n      script.async = true;\n      script.src = url;\n      script.crossOrigin = 'anonymous';\n      script.onload = () => {\n        clearTimeout(timer);\n        finish(true);\n      };\n      script.onerror = () => {\n        clearTimeout(timer);\n        finish(false, new Error(`Script load failed: ${url}`));\n      };\n      doc.head.appendChild(script);\n    });\n  },\n\n  async load() {\n    const _topWindow = typeof window.parent !== 'undefined' ? window.parent : window;\n\n    if (this.isLoaded) {\n      const runtime = this._getRuntime(_topWindow);\n      if (runtime) return true;\n      this.isLoaded = false;\n      this.loadPromise = null;\n    }\n\n    const existingRuntime = this.getRuntime(_topWindow);\n    if (existingRuntime) {\n      this.isLoaded = true;\n      _topWindow[this._READY_MARK] = true;\n      return true;\n    }\n\n    if (this.loadPromise) return this.loadPromise;\n\n    this.loadPromise = this._doLoad();\n    return this.loadPromise;\n  },\n\n  getRuntime(targetWindow) {\n    const _topWindow = targetWindow ?? (typeof window.parent !== 'undefined' ? window.parent : window);\n    const runtime = this._getRuntime(_topWindow);\n    if (runtime) return runtime;\n    return this._setRuntime(_topWindow, this._detectActiveRuntimeType(_topWindow));\n  },\n\n  getPixi(targetWindow) {\n    return this.getRuntime(targetWindow)?.pixi ?? null;\n  },\n\n  _detectActiveRuntimeType(_topWindow) {\n    const activeNamespace = _topWindow?.PIXI?.live2d;\n    if (\n      this.cubism5Live2DNamespace &&\n      activeNamespace &&\n      activeNamespace === this.cubism5Live2DNamespace &&\n      !!activeNamespace.Live2DModel\n    ) {\n      return 'cubism5';\n    }\n    return 'legacy';\n  },\n\n  _getRuntime(_topWindow) {\n    const runtime = _topWindow?.[this._RUNTIME_KEY];\n    if (!runtime || typeof runtime !== 'object') return null;\n\n    const pixi = runtime.pixi;\n    const live2dModel = runtime.live2dModel;\n    if (!pixi || !live2dModel) return null;\n\n    if (_topWindow?.PIXI !== pixi) return null;\n    if (_topWindow?.PIXI?.live2d?.Live2DModel !== live2dModel) return null;\n\n    return runtime;\n  },\n\n  _setRuntime(_topWindow, runtimeType = 'legacy') {\n    const pixi = _topWindow?.PIXI;\n    const live2dNamespace = this.getRuntimeNamespace(runtimeType) || pixi?.live2d;\n    const live2dModel = live2dNamespace?.Live2DModel;\n    if (!pixi || !live2dModel) return null;\n\n    const runtime = {\n      pixi,\n      live2dModel,\n      pixiVersion: String(pixi?.VERSION || 'unknown'),\n      loadedAt: Date.now(),\n      runtimeType,\n    };\n    _topWindow[this._RUNTIME_KEY] = runtime;\n    return runtime;\n  },\n\n  _getLatestMocVersion(_topWindow) {\n    try {\n      return Number(_topWindow?.Live2DCubismCore?.Version?.csmGetLatestMocVersion?.() || 0) || 0;\n    } catch (e) {\n      return 0;\n    }\n  },\n\n  async _waitForLatestMocVersion(_topWindow, expectedMajor = 5, timeoutMs = 4000, intervalMs = 50) {\n    const startedAt = Date.now();\n    while (Date.now() - startedAt < timeoutMs) {\n      const latestVersion = this._getLatestMocVersion(_topWindow);\n      if (latestVersion >= expectedMajor) return latestVersion;\n      await new Promise(r => setTimeout(r, intervalMs));\n    }\n    return this._getLatestMocVersion(_topWindow);\n  },\n\n  _isLegacyMocVersion(latestMocVersion) {\n    const value = Number(latestMocVersion || 0) || 0;\n    return value > 0 && value <= 4;\n  },\n\n  _isCubism5MocVersion(latestMocVersion, requiredVersion = 5) {\n    const value = Number(latestMocVersion || 0) || 0;\n    const required = Math.max(5, Number(requiredVersion || 0) || 0);\n    return value >= required;\n  },\n\n  _setGlobalCubismCore(_topWindow, coreObject) {\n    if (!_topWindow) return;\n    if (coreObject) {\n      _topWindow.Live2DCubismCore = coreObject;\n      return;\n    }\n    try {\n      delete _topWindow.Live2DCubismCore;\n    } catch (e) {\n      _topWindow.Live2DCubismCore = undefined;\n    }\n  },\n\n  async ensureLegacyCore() {\n    const _topWindow = typeof window.parent !== 'undefined' ? window.parent : window;\n    const latestVersion = this._getLatestMocVersion(_topWindow);\n    if (this._isLegacyMocVersion(latestVersion)) {\n      this.legacyCoreLoaded = true;\n      this.cubism5CoreLoaded = false;\n      this.activeCoreType = 'legacy';\n      this.legacyCoreObject = _topWindow.Live2DCubismCore || this.legacyCoreObject;\n      if (!this.legacyCoreSource) {\n        this.legacyCoreSource = 'window.Live2DCubismCore(existing)';\n      }\n      return true;\n    }\n\n    if (this._isLegacyMocVersion(this._getLatestMocVersion({ Live2DCubismCore: this.legacyCoreObject }))) {\n      this._setGlobalCubismCore(_topWindow, this.legacyCoreObject);\n      if (this._isLegacyMocVersion(this._getLatestMocVersion(_topWindow))) {\n        this.legacyCoreLoaded = true;\n        this.cubism5CoreLoaded = false;\n        this.activeCoreType = 'legacy';\n        if (!this.legacyCoreSource) {\n          this.legacyCoreSource = 'window.Live2DCubismCore(snapshot)';\n        }\n        return true;\n      }\n    }\n\n    if (this.legacyCorePromise) return this.legacyCorePromise;\n\n    this.legacyCorePromise = (async () => {\n      const previousCore = _topWindow.Live2DCubismCore;\n      const coreUrls = this._getCubism4CoreUrls();\n      if (!coreUrls.length) {\n        console.error(`[${SCRIPT_NAME}] Cubism 4 Core load failed: no core URL candidates`);\n        this.legacyCorePromise = null;\n        return false;\n      }\n\n      let lastError = null;\n      try {\n        for (const coreUrl of coreUrls) {\n          try {\n            const coreText = await fetch(coreUrl).then(r => {\n              if (!r.ok) throw new Error(`Cubism 4 Core load failed: ${r.status}`);\n              return r.text();\n            });\n            this._setGlobalCubismCore(_topWindow, null);\n            await this._executeScript(coreText, _topWindow);\n\n            const startedAt = Date.now();\n            let loadedVersion = this._getLatestMocVersion(_topWindow);\n            while (Date.now() - startedAt < 5000 && !this._isLegacyMocVersion(loadedVersion)) {\n              await new Promise(r => setTimeout(r, 80));\n              loadedVersion = this._getLatestMocVersion(_topWindow);\n            }\n\n            if (!this._isLegacyMocVersion(loadedVersion)) {\n              throw new Error(`latest moc version check failed: ${loadedVersion}`);\n            }\n\n            this.legacyCoreLoaded = true;\n            this.legacyCoreObject = _topWindow.Live2DCubismCore || this.legacyCoreObject;\n            this.legacyCoreSource = coreUrl;\n            this.cubism5CoreLoaded = false;\n            this.activeCoreType = 'legacy';\n            console.log(`[${SCRIPT_NAME}] Cubism 4 Core loaded from ${coreUrl}`);\n            return true;\n          } catch (candidateError) {\n            this._setGlobalCubismCore(_topWindow, previousCore);\n            lastError = candidateError;\n            console.warn(`[${SCRIPT_NAME}] Cubism 4 Core candidate failed: ${coreUrl}`, candidateError);\n          }\n        }\n\n        this._setGlobalCubismCore(_topWindow, previousCore);\n        if (this._isLegacyMocVersion(this._getLatestMocVersion(_topWindow))) {\n          this.legacyCoreLoaded = true;\n          this.cubism5CoreLoaded = false;\n          this.activeCoreType = 'legacy';\n          this.legacyCoreObject = _topWindow.Live2DCubismCore || this.legacyCoreObject;\n          if (!this.legacyCoreSource) {\n            this.legacyCoreSource = 'window.Live2DCubismCore(existing)';\n          }\n          console.warn(`[${SCRIPT_NAME}] Cubism 4 Core candidates failed; fallback to existing core`);\n          return true;\n        }\n\n        console.warn(`[${SCRIPT_NAME}] Cubism 4 Core load failed: all candidates failed`, {\n          candidates: coreUrls,\n          lastError: String(lastError?.message || lastError || ''),\n        });\n        if (lastError) {\n          this._setGlobalCubismCore(_topWindow, previousCore);\n          throw lastError;\n        }\n        return false;\n      } catch (e) {\n        this._setGlobalCubismCore(_topWindow, previousCore);\n        console.error(`[${SCRIPT_NAME}] Cubism 4 Core load failed:`, e);\n        return false;\n      } finally {\n        this.legacyCorePromise = null;\n      }\n    })();\n\n    return this.legacyCorePromise;\n  },\n\n  async ensureCubism5Core(requiredLatestVersion = 5) {\n    const _topWindow = typeof window.parent !== 'undefined' ? window.parent : window;\n\n    const requiredVersion = Math.max(5, Number(requiredLatestVersion || 0) || 0);\n    const latestVersion = this._getLatestMocVersion(_topWindow);\n    const existingIsCubism5 = latestVersion >= requiredVersion;\n    const hasPinnedCubism5Source =\n      typeof this.cubism5CoreSource === 'string' &&\n      /^https?:/i.test(this.cubism5CoreSource);\n    if (existingIsCubism5 && hasPinnedCubism5Source) {\n      this.cubism5CoreLoaded = true;\n      this.legacyCoreLoaded = false;\n      this.activeCoreType = 'cubism5';\n      this.cubism5CoreObject = _topWindow.Live2DCubismCore || this.cubism5CoreObject;\n      return true;\n    }\n\n    if (existingIsCubism5 && !hasPinnedCubism5Source) {\n      this.cubism5CoreObject = _topWindow.Live2DCubismCore || this.cubism5CoreObject;\n      console.warn(\n        `[${SCRIPT_NAME}] Existing Cubism Core detected without pinned source, will try configured Cubism 5 core URL candidates`,\n      );\n    }\n\n    if (this._isCubism5MocVersion(this._getLatestMocVersion({ Live2DCubismCore: this.cubism5CoreObject }), requiredVersion)) {\n      this._setGlobalCubismCore(_topWindow, this.cubism5CoreObject);\n      if (this._isCubism5MocVersion(this._getLatestMocVersion(_topWindow), requiredVersion)) {\n        this.cubism5CoreLoaded = true;\n        this.legacyCoreLoaded = false;\n        this.activeCoreType = 'cubism5';\n        if (!this.cubism5CoreSource) {\n          this.cubism5CoreSource = 'window.Live2DCubismCore(snapshot)';\n        }\n        return true;\n      }\n    }\n    if (this.cubism5CorePromise) return this.cubism5CorePromise;\n\n    this.cubism5CorePromise = (async () => {\n      const coreUrls = this._getCubism5CoreUrls(_topWindow);\n      if (!coreUrls.length) {\n        console.error(`[${SCRIPT_NAME}] Cubism 5 Core load failed: no core URL candidates`);\n        this.cubism5CorePromise = null;\n        return false;\n      }\n\n      let lastError = null;\n      const previousCore = _topWindow.Live2DCubismCore;\n      try {\n        for (const coreUrl of coreUrls) {\n          try {\n            this._setGlobalCubismCore(_topWindow, null);\n            this._ensureCubismCoreLocateFile(_topWindow, coreUrl);\n            await this._loadScriptSrc(coreUrl);\n\n            const loadedVersion = await this._waitForLatestMocVersion(_topWindow, requiredVersion, 8000, 80);\n            if (loadedVersion >= requiredVersion) {\n              this.cubism5CoreLoaded = true;\n              this.legacyCoreLoaded = false;\n              this.activeCoreType = 'cubism5';\n              this.cubism5CoreObject = _topWindow.Live2DCubismCore || this.cubism5CoreObject;\n              this.cubism5CoreSource = coreUrl;\n              console.log(`[${SCRIPT_NAME}] Cubism 5 Core loaded from ${coreUrl}`);\n              return true;\n            }\n\n            throw new Error(`latest moc version check failed: ${loadedVersion} (required >= ${requiredVersion})`);\n          } catch (candidateError) {\n            this._setGlobalCubismCore(_topWindow, previousCore);\n            lastError = candidateError;\n            console.warn(`[${SCRIPT_NAME}] Cubism 5 Core candidate failed: ${coreUrl}`, candidateError);\n          }\n        }\n\n        this._setGlobalCubismCore(_topWindow, previousCore);\n        if (this._isCubism5MocVersion(this._getLatestMocVersion(_topWindow), requiredVersion)) {\n          this.cubism5CoreLoaded = true;\n          this.legacyCoreLoaded = false;\n          this.activeCoreType = 'cubism5';\n          this.cubism5CoreObject = _topWindow.Live2DCubismCore || this.cubism5CoreObject;\n          if (!this.cubism5CoreSource) {\n            this.cubism5CoreSource = 'window.Live2DCubismCore(existing)';\n          }\n          console.warn(`[${SCRIPT_NAME}] Cubism 5 Core candidates failed; fallback to existing core`);\n          return true;\n        }\n        this.cubism5CoreLoaded = false;\n        this.cubism5CoreSource = null;\n        console.error(`[${SCRIPT_NAME}] Cubism 5 Core load failed: all candidates failed`, {\n          candidates: coreUrls,\n          lastError: String(lastError?.message || lastError || ''),\n        });\n        return false;\n      } finally {\n        this.cubism5CorePromise = null;\n      }\n    })();\n\n    return this.cubism5CorePromise;\n  },\n\n  _normalizeRuntimeUrl(url) {\n    if (typeof url !== 'string') return '';\n    return url.trim();\n  },\n\n  _isDirectResourceUrl(url) {\n    const value = this._normalizeRuntimeUrl(url);\n    if (!value) return false;\n    if (value.startsWith('//')) return true;\n    return /^(?:blob|data|https?|file|stscript|chrome-extension|moz-extension|capacitor|app):/i.test(value);\n  },\n\n  _patchPixiUrlResolve(_topWindow) {\n    if (this.pixiUrlResolvePatched) return true;\n    const utils = _topWindow?.PIXI?.utils;\n    const urlApi = utils?.url;\n    const originalResolve = urlApi?.resolve;\n    if (typeof originalResolve !== 'function') return false;\n\n    const loaderRef = this;\n    this.pixiUrlResolveOriginal = originalResolve;\n    urlApi.resolve = function patchedPixiUrlResolve(baseUrl, resourcePath) {\n      if (loaderRef._isDirectResourceUrl(resourcePath)) {\n        return loaderRef._normalizeRuntimeUrl(resourcePath);\n      }\n      return originalResolve.call(this, baseUrl, resourcePath);\n    };\n\n    this.pixiUrlResolvePatched = true;\n    console.log(`[${SCRIPT_NAME}] Patched PIXI.utils.url.resolve`);\n    return true;\n  },\n\n  _patchModelSettingsResolveURL(runtimeNamespace, runtimeLabel = 'unknown') {\n    if (!runtimeNamespace || typeof runtimeNamespace !== 'object') return 0;\n\n    const candidates = [\n      'ModelSettings',\n      'Cubism2ModelSettings',\n      'Cubism4ModelSettings',\n      'Cubism5ModelSettings',\n    ];\n    let patchedCount = 0;\n\n    for (const ctorName of candidates) {\n      const proto = runtimeNamespace?.[ctorName]?.prototype;\n      if (!proto || typeof proto.resolveURL !== 'function') continue;\n      if (this.patchedResolveUrlPrototypes.has(proto) || proto.__galgameResolveUrlPatched) continue;\n\n      const originalResolveURL = proto.resolveURL;\n      const loaderRef = this;\n      proto.resolveURL = function patchedResolveURL(resourcePath) {\n        if (loaderRef._isDirectResourceUrl(resourcePath)) {\n          return loaderRef._normalizeRuntimeUrl(resourcePath);\n        }\n        return originalResolveURL.call(this, resourcePath);\n      };\n\n      try {\n        proto.__galgameResolveUrlPatched = true;\n      } catch (e) {}\n      this.patchedResolveUrlPrototypes.add(proto);\n      patchedCount++;\n      console.log(`[${SCRIPT_NAME}] Patched ModelSettings.resolveURL (${runtimeLabel}:${ctorName})`);\n    }\n\n    return patchedCount;\n  },\n\n  _patchXhrLoader(runtimeNamespace, runtimeLabel = 'unknown') {\n    if (!runtimeNamespace || typeof runtimeNamespace !== 'object') return false;\n    if (this.patchedXhrLoaderNamespaces.has(runtimeNamespace)) return true;\n\n    const XHRLoader = runtimeNamespace.XHRLoader;\n    const originalLoader = XHRLoader?.loader;\n    if (typeof originalLoader !== 'function') {\n      console.warn(`[${SCRIPT_NAME}] XHRLoader.loader missing (${runtimeLabel})`, {\n        hasNamespace: !!runtimeNamespace,\n        hasXHRLoader: !!XHRLoader,\n        loaderType: typeof originalLoader,\n      });\n      return false;\n    }\n\n    const loaderRef = this;\n    XHRLoader.loader = (context) => {\n      const rawUrl = context?.settings ? context.settings.resolveURL(context.url) : context?.url;\n      const requestUrl = loaderRef._normalizeRuntimeUrl(rawUrl);\n      if (!loaderRef._isDirectResourceUrl(requestUrl)) {\n        return originalLoader(context);\n      }\n\n      const requestType = String(context?.type || '').toLowerCase();\n      return fetch(requestUrl)\n        .then((response) => {\n          if (!response.ok) {\n            throw new Error(`Fetch failed (${response.status}) for ${requestUrl}`);\n          }\n          if (requestType === 'json') return response.json();\n          if (requestType === 'text') return response.text();\n          return response.arrayBuffer();\n        })\n        .then((payload) => {\n          if (requestType !== 'json' && requestType !== 'text' && payload instanceof ArrayBuffer) {\n            const header = new Uint8Array(payload, 0, Math.min(4, payload.byteLength));\n            const signature = String.fromCharCode(...header);\n            console.log(`[${SCRIPT_NAME}] XHRLoader patched fetch arraybuffer`, {\n              url: requestUrl.slice(0, 128),\n              byteLength: payload.byteLength,\n              signature,\n            });\n          }\n          context.result = payload;\n        });\n    };\n\n    this.patchedXhrLoaderNamespaces.add(runtimeNamespace);\n    console.log(`[${SCRIPT_NAME}] Patched XHRLoader.loader (${runtimeLabel})`);\n    return true;\n  },\n\n  _getCubism5RuntimeUrls() {\n    const urls = [];\n    const seen = new Set();\n    const pushUrl = (value) => {\n      const normalized = this._normalizeRuntimeUrl(value);\n      if (!normalized || seen.has(normalized)) return;\n      seen.add(normalized);\n      urls.push(normalized);\n    };\n\n    pushUrl(this.CUBISM5_RUNTIME_URL);\n    for (const fallbackUrl of this.CUBISM5_RUNTIME_FALLBACK_URLS) {\n      pushUrl(fallbackUrl);\n    }\n\n    return urls;\n  },\n\n  _getCubism5CoreUrls() {\n    const urls = [];\n    const seen = new Set();\n    const pushUrl = (value) => {\n      const normalized = this._normalizeRuntimeUrl(value);\n      if (!normalized || seen.has(normalized)) return;\n      seen.add(normalized);\n      urls.push(normalized);\n    };\n\n    pushUrl(this.CUBISM5_CORE_URL);\n    for (const fallbackUrl of this.CUBISM5_CORE_FALLBACK_URLS) {\n      pushUrl(fallbackUrl);\n    }\n\n    return urls;\n  },\n\n  _getCubism4CoreUrls() {\n    const urls = [];\n    const seen = new Set();\n    const pushUrl = (value) => {\n      const normalized = this._normalizeRuntimeUrl(value);\n      if (!normalized || seen.has(normalized)) return;\n      seen.add(normalized);\n      urls.push(normalized);\n    };\n\n    pushUrl(this.CUBISM4_CORE_URL);\n    for (const fallbackUrl of this.CUBISM4_CORE_FALLBACK_URLS) {\n      pushUrl(fallbackUrl);\n    }\n    return urls;\n  },\n\n  async ensureCubism5Runtime() {\n    if (this.cubism5RuntimeLoaded && this.cubism5Live2DNamespace?.Live2DModel) {\n      if (!this.cubism5RuntimeSource) {\n        this.cubism5RuntimeSource = 'window.PIXI.live2d(existing)';\n      }\n      return true;\n    }\n    if (this.cubism5RuntimePromise) return this.cubism5RuntimePromise;\n\n    this.cubism5RuntimePromise = (async () => {\n      const _topWindow = typeof window.parent !== 'undefined' ? window.parent : window;\n\n      if (!this.isLoaded) {\n        const loaded = await this.load();\n        if (!loaded) return false;\n      }\n\n      const coreReady = await this.ensureCubism5Core();\n      if (!coreReady) {\n        console.error(`[${SCRIPT_NAME}] Cubism 5 runtime load aborted: core unavailable`);\n        return false;\n      }\n\n      try {\n        const runtimeUrls = this._getCubism5RuntimeUrls();\n        if (!runtimeUrls.length) {\n          console.error(`[${SCRIPT_NAME}] Cubism 5 runtime load failed: no runtime URL candidates`);\n          return false;\n        }\n\n        let lastError = null;\n        for (const runtimeUrl of runtimeUrls) {\n          try {\n            const runtimeText = await fetch(runtimeUrl).then(r => {\n              if (!r.ok) throw new Error(`Cubism 5 runtime load failed: ${r.status}`);\n              return r.text();\n            });\n            await this._executeScript(runtimeText, _topWindow);\n            await new Promise(r => setTimeout(r, 100));\n\n            const runtimeNamespace = _topWindow?.PIXI?.live2d;\n            if (!runtimeNamespace?.Live2DModel) {\n              throw new Error('Live2DModel is unavailable after Cubism 5 runtime script execution');\n            }\n\n            this._patchModelSettingsResolveURL(runtimeNamespace, 'cubism5');\n            this._patchXhrLoader(runtimeNamespace, 'cubism5');\n\n            this.cubism5Live2DNamespace = runtimeNamespace;\n            this.cubism5RuntimeLoaded = true;\n            this.cubism5RuntimeSource = runtimeUrl;\n\n            if (this.legacyLive2DNamespace?.Live2DModel) {\n              _topWindow.PIXI.live2d = this.legacyLive2DNamespace;\n            }\n            console.log(`[${SCRIPT_NAME}] Cubism 5 runtime loaded from ${runtimeUrl}`);\n            return true;\n          } catch (candidateError) {\n            lastError = candidateError;\n            console.warn(`[${SCRIPT_NAME}] Cubism 5 runtime candidate failed: ${runtimeUrl}`, candidateError);\n          }\n        }\n\n        console.error(`[${SCRIPT_NAME}] Cubism 5 runtime load failed: all candidates failed`, {\n          candidates: runtimeUrls,\n          lastError: String(lastError?.message || lastError || ''),\n        });\n        return false;\n      } catch (e) {\n        console.error(`[${SCRIPT_NAME}] Cubism 5 runtime load failed:`, e);\n        return false;\n      } finally {\n        this.cubism5RuntimePromise = null;\n      }\n    })();\n\n    return this.cubism5RuntimePromise;\n  },\n\n  getRuntimeNamespace(runtimeType = 'legacy') {\n    if (runtimeType === 'cubism5' && this.cubism5Live2DNamespace?.Live2DModel) {\n      return this.cubism5Live2DNamespace;\n    }\n    if (this.legacyLive2DNamespace?.Live2DModel) return this.legacyLive2DNamespace;\n\n    const _topWindow = typeof window.parent !== 'undefined' ? window.parent : window;\n    return _topWindow?.PIXI?.live2d || null;\n  },\n\n  activateRuntime(runtimeType = 'legacy') {\n    const _topWindow = typeof window.parent !== 'undefined' ? window.parent : window;\n    if (!_topWindow?.PIXI) return false;\n\n    const target = this.getRuntimeNamespace(runtimeType);\n    if (!target?.Live2DModel) return false;\n\n    _topWindow.PIXI.live2d = target;\n    this._setRuntime(_topWindow, runtimeType);\n    return true;\n  },\n\n  async _doLoad() {\n    const _topWindow = typeof window.parent !== 'undefined' ? window.parent : window;\n\n    try {\n      if (_topWindow.PIXI?.live2d?.Live2DModel) {\n        console.log(`[${SCRIPT_NAME}] Live2D SDK already available`);\n        this._patchPixiUrlResolve(_topWindow);\n        this.legacyLive2DNamespace = _topWindow.PIXI.live2d;\n        this._patchModelSettingsResolveURL(this.legacyLive2DNamespace, 'legacy-existing');\n        this._patchXhrLoader(this.legacyLive2DNamespace, 'legacy-existing');\n        this.activateRuntime('legacy');\n        _topWindow[this._READY_MARK] = true;\n        this.isLoaded = true;\n        this.loadPromise = null;\n        return true;\n      }\n\n      if (!_topWindow.PIXI) {\n        console.log(`[${SCRIPT_NAME}]  PIXI.js...`);\n        const pixiText = await fetch(this.PIXI_URL).then(r => {\n          if (!r.ok) throw new Error(`PIXI.js : ${r.status}`);\n          return r.text();\n        });\n        await this._executeScript(pixiText, _topWindow);\n        console.log(`[${SCRIPT_NAME}] PIXI.js `);\n      }\n\n      if (!_topWindow.window.PIXI) {\n        _topWindow.window.PIXI = _topWindow.PIXI;\n      }\n\n      this._patchPixiUrlResolve(_topWindow);\n\n      if (!_topWindow.Live2DCubismCore) {\n        console.log(`[${SCRIPT_NAME}]  Cubism 4 Core...`);\n        try {\n          const coreText = await fetch(this.CUBISM4_CORE_URL).then(r => {\n            if (!r.ok) throw new Error(`Cubism 4 Core : ${r.status}`);\n            return r.text();\n          });\n          await this._executeScript(coreText, _topWindow);\n          this.legacyCoreLoaded = true;\n          this.legacyCoreSource = this.CUBISM4_CORE_URL;\n          this.legacyCoreObject = _topWindow.Live2DCubismCore || this.legacyCoreObject;\n          this.activeCoreType = 'legacy';\n          console.log(`[${SCRIPT_NAME}] Cubism 4 Core `);\n        } catch (e) {\n          console.warn(`[${SCRIPT_NAME}] Cubism 4 Core ...`, e);\n        }\n      } else {\n        const latestMocVersion = this._getLatestMocVersion(_topWindow);\n        if (latestMocVersion >= 5) {\n          this.cubism5CoreLoaded = true;\n          this.cubism5CoreSource = this.cubism5CoreSource || 'window.Live2DCubismCore(existing)';\n          this.cubism5CoreObject = _topWindow.Live2DCubismCore || this.cubism5CoreObject;\n          this.activeCoreType = 'cubism5';\n        } else if (this._isLegacyMocVersion(latestMocVersion)) {\n          this.legacyCoreLoaded = true;\n          this.legacyCoreSource = this.legacyCoreSource || 'window.Live2DCubismCore(existing)';\n          this.legacyCoreObject = _topWindow.Live2DCubismCore || this.legacyCoreObject;\n          this.activeCoreType = 'legacy';\n        }\n      }\n\n      if (!_topWindow.Live2D) {\n        console.log(`[${SCRIPT_NAME}]  Cubism 2.1 Core...`);\n        try {\n          const core2Text = await fetch(this.CUBISM2_CORE_URL).then(r => {\n            if (!r.ok) throw new Error(`Cubism 2.1 Core : ${r.status}`);\n            return r.text();\n          });\n          await this._executeScript(core2Text, _topWindow);\n          console.log(`[${SCRIPT_NAME}] Cubism 2.1 Core `);\n        } catch (e) {\n          console.warn(`[${SCRIPT_NAME}] Cubism 2.1 Core :`, e);\n        }\n      }\n\n      const cached = await this._getFromCache();\n      if (cached && cached.sdk) {\n        console.log(`[${SCRIPT_NAME}] ?pixi-live2d-display`);\n        await this._executeScript(cached.sdk, _topWindow);\n      } else {\n        console.log(`[${SCRIPT_NAME}] ?CDN  pixi-live2d-display...`);\n        const sdkText = await fetch(this.SDK_URL).then(r => {\n          if (!r.ok) throw new Error(`pixi-live2d-display : ${r.status}`);\n          return r.text();\n        });\n        await this._saveToCache({ sdk: sdkText });\n        await this._executeScript(sdkText, _topWindow);\n      }\n\n      await new Promise(r => setTimeout(r, 100));\n      this._patchPixiUrlResolve(_topWindow);\n\n      if (_topWindow.PIXI?.live2d?.Live2DModel) {\n        this.legacyLive2DNamespace = _topWindow.PIXI.live2d;\n        this._patchModelSettingsResolveURL(this.legacyLive2DNamespace, 'legacy');\n        this._patchXhrLoader(this.legacyLive2DNamespace, 'legacy');\n      }\n\n      this.activateRuntime('legacy');\n      this._setRuntime(_topWindow, 'legacy');\n      this.isLoaded = true;\n      _topWindow[this._READY_MARK] = true;\n      this.loadPromise = null;\n      console.log(`[${SCRIPT_NAME}] Live2D SDK `);\n      return true;\n    } catch (e) {\n      console.error(`[${SCRIPT_NAME}] Live2D SDK :`, e);\n      _topWindow[this._READY_MARK] = false;\n      _topWindow[this._RUNTIME_KEY] = null;\n      this.isLoaded = false;\n      this.loadPromise = null;\n      return false;\n    }\n  },\n\n  _executeScript(code, targetWindow) {\n    return new Promise((resolve, reject) => {\n      try {\n        const script = targetWindow.document.createElement('script');\n        script.textContent = code;\n        targetWindow.document.head.appendChild(script);\n        setTimeout(resolve, 10);\n      } catch (e) {\n        reject(e);\n      }\n    });\n  },\n\n  async _getFromCache() {\n    return new Promise((resolve) => {\n      try {\n        const request = indexedDB.open(DB_NAME, DB_VERSION);\n        request.onsuccess = (e) => {\n          const database = e.target.result;\n          if (!database.objectStoreNames.contains(STORE_SDK_CACHE)) {\n            database.close();\n            resolve(null);\n            return;\n          }\n          const tx = database.transaction(STORE_SDK_CACHE, 'readonly');\n          const store = tx.objectStore(STORE_SDK_CACHE);\n          const get = store.get(this.SDK_CACHE_KEY);\n          get.onsuccess = () => {\n            database.close();\n            resolve(get.result?.data || null);\n          };\n          get.onerror = () => {\n            database.close();\n            resolve(null);\n          };\n        };\n        request.onerror = () => resolve(null);\n      } catch (e) {\n        resolve(null);\n      }\n    });\n  },\n\n  async _saveToCache(data) {\n    return new Promise((resolve) => {\n      try {\n        const request = indexedDB.open(DB_NAME, DB_VERSION);\n        request.onsuccess = (e) => {\n          const database = e.target.result;\n          if (!database.objectStoreNames.contains(STORE_SDK_CACHE)) {\n            database.close();\n            resolve();\n            return;\n          }\n          const tx = database.transaction(STORE_SDK_CACHE, 'readwrite');\n          const store = tx.objectStore(STORE_SDK_CACHE);\n          store.put({ id: this.SDK_CACHE_KEY, data, timestamp: Date.now() });\n          tx.oncomplete = () => {\n            database.close();\n            console.log(`[${SCRIPT_NAME}] Live2D SDK  IndexedDB`);\n            resolve();\n          };\n          tx.onerror = () => {\n            database.close();\n            resolve();\n          };\n        };\n        request.onerror = () => resolve();\n      } catch (e) {\n        resolve();\n      }\n    });\n  },\n\n  async clearCache() {\n    return new Promise((resolve) => {\n      try {\n        const request = indexedDB.open(DB_NAME, DB_VERSION);\n        request.onsuccess = (e) => {\n          const database = e.target.result;\n          if (!database.objectStoreNames.contains(STORE_SDK_CACHE)) {\n            database.close();\n            resolve();\n            return;\n          }\n          const tx = database.transaction(STORE_SDK_CACHE, 'readwrite');\n          const store = tx.objectStore(STORE_SDK_CACHE);\n          store.delete(this.SDK_CACHE_KEY);\n          tx.oncomplete = () => {\n            database.close();\n            this.isLoaded = false;\n            this.loadPromise = null;\n            this.legacyCoreLoaded = false;\n            this.legacyCorePromise = null;\n            this.legacyCoreSource = null;\n            this.cubism5CoreLoaded = false;\n            this.cubism5CorePromise = null;\n            this.cubism5CoreSource = null;\n            this.cubism5RuntimeLoaded = false;\n            this.cubism5RuntimePromise = null;\n            this.cubism5RuntimeSource = null;\n            this.legacyLive2DNamespace = null;\n            this.cubism5Live2DNamespace = null;\n            this.patchedResolveUrlPrototypes = new WeakSet();\n            this.patchedXhrLoaderNamespaces = new WeakSet();\n            this.pixiUrlResolvePatched = false;\n            this.pixiUrlResolveOriginal = null;\n            this.legacyCoreObject = null;\n            this.cubism5CoreObject = null;\n            this.activeCoreType = null;\n            this.loadedScriptUrls = new Set();\n            console.log(`[${SCRIPT_NAME}] Live2D SDK cache cleared`);\n            resolve();\n          };\n        };\n        request.onerror = () => resolve();\n      } catch (e) {\n        resolve();\n      }\n    });\n  }\n};\n\n\r\n\r\n\r\n\r\n\r\n\r\n","/**\n * \n *  jQueryUI draggable  //  LLM\n *  jQueryUI draggable \n *\n * \n * IDLE  pointerdown  PENDING\n * PENDING   >   IDLE jQueryUI\n * PENDING  longPressDelay   LONG_PRESS  IDLE\n * PENDING  pointerup  WAIT_DOUBLE\n * WAIT_DOUBLE  doubleClickWindow  pointerdown+up  DOUBLE_TAP  IDLE\n * WAIT_DOUBLE    TAP  IDLE\n */\n\nexport type GestureType = 'tap' | 'double-tap' | 'long-press';\n\nexport interface GestureEvent {\n  type: GestureType;\n  clientX: number;\n  clientY: number;\n}\n\nexport interface GestureConfig {\n  /** (ms) */\n  longPressDelay: number;\n  /** (ms) */\n  doubleClickWindow: number;\n  /** (px) */\n  moveThreshold: number;\n}\n\nconst DEFAULT_CONFIG: GestureConfig = {\n  longPressDelay: 500,\n  doubleClickWindow: 300,\n  moveThreshold: 8,\n};\n\nfunction isTouchDevice(): boolean {\n  return 'ontouchstart' in window || navigator.maxTouchPoints > 0;\n}\n\nexport class GestureRecognizer {\n  private element: HTMLElement;\n  private config: GestureConfig;\n  private onGesture: (event: GestureEvent) => void;\n  private isDraggingCheck: () => boolean;\n\n  private state: 'idle' | 'pending' | 'wait-double' = 'idle';\n  private startPos = { x: 0, y: 0 };\n  private longPressTimer: number | null = null;\n  private doubleClickTimer: number | null = null;\n  private longPressFired = false;\n  private moved = false;\n  private activePointerId: number | null = null;\n  private destroyed = false;\n\n  private boundPointerDown: (e: PointerEvent) => void;\n  private boundPointerMove: (e: PointerEvent) => void;\n  private boundPointerUp: (e: PointerEvent) => void;\n  private boundContextMenu: (e: Event) => void;\n\n  /**\n   * @param element \n   * @param config \n   * @param onGesture \n   * @param isDraggingCheck  jQueryUI draggable \n   */\n  constructor(\n    element: HTMLElement,\n    config: Partial<GestureConfig>,\n    onGesture: (event: GestureEvent) => void,\n    isDraggingCheck: () => boolean = () => false,\n  ) {\n    this.element = element;\n    this.config = {\n      ...DEFAULT_CONFIG,\n      moveThreshold: isTouchDevice() ? 12 : 8,\n      ...config,\n    };\n    this.onGesture = onGesture;\n    this.isDraggingCheck = isDraggingCheck;\n\n    this.boundPointerDown = this.handlePointerDown.bind(this);\n    this.boundPointerMove = this.handlePointerMove.bind(this);\n    this.boundPointerUp = this.handlePointerUp.bind(this);\n    this.boundContextMenu = (e: Event) => e.preventDefault();\n\n    element.addEventListener('pointerdown', this.boundPointerDown);\n    element.addEventListener('pointermove', this.boundPointerMove);\n    element.addEventListener('pointerup', this.boundPointerUp);\n    element.addEventListener('pointercancel', this.boundPointerUp);\n    element.addEventListener('contextmenu', this.boundContextMenu);\n  }\n\n  destroy(): void {\n    this.destroyed = true;\n    this.clearAllTimers();\n    this.element.removeEventListener('pointerdown', this.boundPointerDown);\n    this.element.removeEventListener('pointermove', this.boundPointerMove);\n    this.element.removeEventListener('pointerup', this.boundPointerUp);\n    this.element.removeEventListener('pointercancel', this.boundPointerUp);\n    this.element.removeEventListener('contextmenu', this.boundContextMenu);\n  }\n\n  private handlePointerDown(_e: PointerEvent): void {\n    if (this.destroyed) return;\n    if (_e.pointerType === 'touch' && _e.isPrimary === false) {\n      this.resetState();\n      return;\n    }\n\n    if (this.activePointerId !== null && _e.pointerId !== this.activePointerId) {\n      return;\n    }\n    this.activePointerId = _e.pointerId;\n\n    this.startPos = { x: _e.clientX, y: _e.clientY };\n    this.longPressFired = false;\n    this.moved = false;\n\n    if (this.state === 'wait-double') {\n      //  pointerup \n      return;\n    }\n\n    this.state = 'pending';\n    this.clearLongPressTimer();\n\n    this.longPressTimer = window.setTimeout(() => {\n      if (this.state === 'pending' && !this.moved && !this.isDraggingCheck()) {\n        this.longPressFired = true;\n        this.state = 'idle';\n        this.onGesture({\n          type: 'long-press',\n          clientX: this.startPos.x,\n          clientY: this.startPos.y,\n        });\n      }\n    }, this.config.longPressDelay);\n  }\n\n  private handlePointerMove(_e: PointerEvent): void {\n    if (this.destroyed || this.state !== 'pending') return;\n    if (this.activePointerId !== _e.pointerId) return;\n\n    const dx = _e.clientX - this.startPos.x;\n    const dy = _e.clientY - this.startPos.y;\n\n    if (Math.sqrt(dx * dx + dy * dy) > this.config.moveThreshold) {\n      //    idle jQueryUI \n      this.moved = true;\n      this.clearLongPressTimer();\n      this.state = 'idle';\n    }\n  }\n\n  private handlePointerUp(_e: PointerEvent): void {\n    if (this.destroyed) return;\n    if (this.activePointerId !== _e.pointerId) return;\n    this.activePointerId = null;\n    this.clearLongPressTimer();\n\n    // jQueryUI  \n    if (this.moved || this.isDraggingCheck()) {\n      this.state = 'idle';\n      return;\n    }\n\n    //    idle\n    if (this.longPressFired) {\n      this.state = 'idle';\n      return;\n    }\n\n    if (this.state === 'wait-double') {\n      // \n      this.clearDoubleClickTimer();\n      this.state = 'idle';\n      this.onGesture({\n        type: 'double-tap',\n        clientX: _e.clientX,\n        clientY: _e.clientY,\n      });\n      return;\n    }\n\n    if (this.state === 'pending' && !this.moved) {\n      //   \n      this.state = 'wait-double';\n      const x = _e.clientX;\n      const y = _e.clientY;\n      this.doubleClickTimer = window.setTimeout(() => {\n        //   \n        this.state = 'idle';\n        this.onGesture({ type: 'tap', clientX: x, clientY: y });\n      }, this.config.doubleClickWindow);\n    }\n  }\n\n  private resetState(): void {\n    this.activePointerId = null;\n    this.longPressFired = false;\n    this.moved = false;\n    this.state = 'idle';\n    this.clearAllTimers();\n  }\n\n  private clearLongPressTimer(): void {\n    if (this.longPressTimer !== null) {\n      window.clearTimeout(this.longPressTimer);\n      this.longPressTimer = null;\n    }\n  }\n\n  private clearDoubleClickTimer(): void {\n    if (this.doubleClickTimer !== null) {\n      window.clearTimeout(this.doubleClickTimer);\n      this.doubleClickTimer = null;\n    }\n  }\n\n  private clearAllTimers(): void {\n    this.clearLongPressTimer();\n    this.clearDoubleClickTimer();\n  }\n}\n","import { log, warn } from '../utils/dom';\r\nimport { GestureRecognizer, type GestureEvent } from '../utils/gesture-recognizer';\r\nimport { Live2DLoader } from './loader';\r\n\r\n/**\r\n * Live2D PIXI \r\n *  fixed  canvas\r\n */\r\nexport const Live2DStage = {\r\n  app: null as any,\r\n  canvas: null as HTMLCanvasElement | null,\r\n  glContext: null as WebGLRenderingContext | WebGL2RenderingContext | null,\r\n  container: null as HTMLDivElement | null,\r\n  mountStack: [] as Array<{\r\n    parent: ParentNode | null;\r\n    nextSibling: ChildNode | null;\r\n    styleText: string;\r\n    width: number;\r\n    height: number;\r\n    onPositionChange: ((x: number, y: number) => void) | null;\r\n  }>,\r\n  mountMode: 'floating' as 'floating' | 'preview',\r\n  _pendingFloatingResize: null as { width: number; height: number } | null,\r\n  loadingOverlay: null as HTMLDivElement | null,\r\n  loadingText: null as HTMLDivElement | null,\r\n  loadingBarFill: null as HTMLDivElement | null,\r\n  interactionLayer: null as HTMLDivElement | null,\r\n  gestureRecognizer: null as GestureRecognizer | null,\r\n  _dragClass: 'desktop-pet-dragging',\r\n  _minVisiblePx: 48,\r\n  _interactionPaddingPx: 14,\r\n  _alphaHitThreshold: 10,\r\n  _maxPixelScanSamples: 360000,\r\n  _onPositionChange: null as ((x: number, y: number) => void) | null,\r\n  _boundWindowResize: null as (() => void) | null,\r\n  _interactionSyncTimer: null as number | null,\r\n  _pixelReadBuffer: null as Uint8Array | null,\r\n  _lastClampLogAt: 0,\r\n\r\n  _clampPosition(\r\n    x: number,\r\n    y: number,\r\n    width: number,\r\n    height: number,\r\n    minVisible: number = 0,\r\n  ): { x: number; y: number; clamped: boolean } {\r\n    const top = this._top();\r\n    const viewportWidth = top.innerWidth || top.document.documentElement.clientWidth || width;\r\n    const viewportHeight = top.innerHeight || top.document.documentElement.clientHeight || height;\r\n\r\n    const safeWidth = Number.isFinite(width) && width > 0 ? width : viewportWidth;\r\n    const safeHeight = Number.isFinite(height) && height > 0 ? height : viewportHeight;\r\n    const safeMinVisibleX = Math.max(0, Math.min(minVisible, safeWidth, viewportWidth));\r\n    const safeMinVisibleY = Math.max(0, Math.min(minVisible, safeHeight, viewportHeight));\r\n\r\n    const minX = Math.min(0, -safeWidth + safeMinVisibleX);\r\n    const minY = Math.min(0, -safeHeight + safeMinVisibleY);\r\n    const maxX = Math.max(0, viewportWidth - safeMinVisibleX);\r\n    const maxY = Math.max(0, viewportHeight - safeMinVisibleY);\r\n    const safeX = Number.isFinite(x) ? x : 0;\r\n    const safeY = Number.isFinite(y) ? y : 0;\r\n    const clampedX = Math.min(Math.max(safeX, minX), maxX);\r\n    const clampedY = Math.min(Math.max(safeY, minY), maxY);\r\n    return { x: clampedX, y: clampedY, clamped: clampedX !== safeX || clampedY !== safeY };\r\n  },\r\n\r\n  _shouldClampCurrentPosition(): boolean {\r\n    if (!this.container) return false;\r\n    if (this.mountMode === 'preview') return false;\r\n\r\n    //  right/bottom  resize  left/top\r\n    const hasCustom = this.container.style.right === 'auto' || this.container.style.bottom === 'auto';\r\n    const hasExplicitLeftTop = !!this.container.style.left || !!this.container.style.top;\r\n    return hasCustom || hasExplicitLeftTop;\r\n  },\r\n\r\n  _getContainerRectSize(options: { width: number; height: number }): { width: number; height: number } {\r\n    const rect = this.container?.getBoundingClientRect?.();\r\n    return {\r\n      width: rect?.width && rect.width > 0 ? rect.width : options.width,\r\n      height: rect?.height && rect.height > 0 ? rect.height : options.height,\r\n    };\r\n  },\r\n\r\n  _isRectFullyOutsideViewport(rect: DOMRect): boolean {\r\n    const top = this._top();\r\n    const viewportWidth = top.innerWidth || top.document.documentElement.clientWidth || 0;\r\n    const viewportHeight = top.innerHeight || top.document.documentElement.clientHeight || 0;\r\n    if (viewportWidth <= 0 || viewportHeight <= 0) return false;\r\n    return rect.right <= 0 || rect.bottom <= 0 || rect.left >= viewportWidth || rect.top >= viewportHeight;\r\n  },\r\n\r\n  _getVisibleAreaRatio(rect: DOMRect, viewportWidth: number, viewportHeight: number): number {\r\n    const rectWidth = Number.isFinite(rect.width) ? rect.width : 0;\r\n    const rectHeight = Number.isFinite(rect.height) ? rect.height : 0;\r\n    if (rectWidth <= 0 || rectHeight <= 0) return 1;\r\n    if (viewportWidth <= 0 || viewportHeight <= 0) return 1;\r\n\r\n    const visibleLeft = Math.max(0, rect.left);\r\n    const visibleTop = Math.max(0, rect.top);\r\n    const visibleRight = Math.min(viewportWidth, rect.right);\r\n    const visibleBottom = Math.min(viewportHeight, rect.bottom);\r\n    const visibleWidth = Math.max(0, visibleRight - visibleLeft);\r\n    const visibleHeight = Math.max(0, visibleBottom - visibleTop);\r\n    const visibleArea = visibleWidth * visibleHeight;\r\n    const totalArea = rectWidth * rectHeight;\r\n    if (totalArea <= 0) return 1;\r\n\r\n    return Math.max(0, Math.min(1, visibleArea / totalArea));\r\n  },\r\n\r\n  _clampPositionByAxis(value: number, size: number, viewportSize: number, minVisible: number): number {\r\n    const safeSize = Number.isFinite(size) && size > 0 ? size : viewportSize;\r\n    const safeViewport = Number.isFinite(viewportSize) && viewportSize > 0 ? viewportSize : safeSize;\r\n    const safeMinVisible = Math.max(0, Math.min(minVisible, safeSize, safeViewport));\r\n    const min = Math.min(0, -safeSize + safeMinVisible);\r\n    const max = Math.max(0, safeViewport - safeMinVisible);\r\n    const safeValue = Number.isFinite(value) ? value : 0;\r\n    return Math.min(Math.max(safeValue, min), max);\r\n  },\r\n\r\n  _clampContainerToViewport(options: { width: number; height: number }, reason: string): void {\r\n    if (!this.container) return;\r\n    const rect = this.container.getBoundingClientRect();\r\n    const size = this._getContainerRectSize(options);\r\n    const top = this._top();\r\n    const viewportWidth = top.innerWidth || top.document.documentElement.clientWidth || size.width;\r\n    const viewportHeight = top.innerHeight || top.document.documentElement.clientHeight || size.height;\r\n    const shouldClamp = this._shouldClampCurrentPosition();\r\n    const fullyOutside = this._isRectFullyOutsideViewport(rect);\r\n    const visibleRatio = this._getVisibleAreaRatio(rect, viewportWidth, viewportHeight);\r\n    const isResizeClamp = reason.includes('resize');\r\n    const forceFullVisible = (fullyOutside || isResizeClamp) && visibleRatio < 0.72;\r\n    if (!shouldClamp && !fullyOutside && !forceFullVisible) return;\r\n\r\n    const minVisibleX = forceFullVisible\r\n      ? Math.min(size.width, viewportWidth)\r\n      : Math.max(0, Math.min(this._minVisiblePx, size.width, viewportWidth));\r\n    const minVisibleY = forceFullVisible\r\n      ? Math.min(size.height, viewportHeight)\r\n      : Math.max(0, Math.min(this._minVisiblePx, size.height, viewportHeight));\r\n\r\n    const nextX = this._clampPositionByAxis(rect.left, size.width, viewportWidth, minVisibleX);\r\n    const nextY = this._clampPositionByAxis(rect.top, size.height, viewportHeight, minVisibleY);\r\n    const hasPositionChange = Math.abs(nextX - rect.left) > 0.5 || Math.abs(nextY - rect.top) > 0.5;\r\n    if (!hasPositionChange) return;\r\n\r\n    this.container.style.left = `${nextX}px`;\r\n    this.container.style.top = `${nextY}px`;\r\n    this.container.style.right = 'auto';\r\n    this.container.style.bottom = 'auto';\r\n\r\n    const now = Date.now();\r\n    if (now - this._lastClampLogAt > 600) {\r\n      this._lastClampLogAt = now;\r\n      log(`(${reason})`, {\r\n        from: { x: rect.left, y: rect.top },\r\n        to: { x: nextX, y: nextY },\r\n        fullyOutside,\r\n        visibleRatio,\r\n        forceFullVisible,\r\n      });\r\n    }\r\n\r\n    this._onPositionChange?.(nextX, nextY);\r\n  },\r\n\r\n  _bindWindowResize(options: { width: number; height: number }): void {\r\n    const top = this._top();\r\n    this._unbindWindowResize();\r\n\r\n    this._boundWindowResize = () => {\r\n      this._clampContainerToViewport(options, 'window-resize');\r\n    };\r\n\r\n    try {\r\n      top.addEventListener('resize', this._boundWindowResize, { passive: true });\r\n    } catch (e) {\r\n      warn(' window.resize ', e);\r\n      this._boundWindowResize = null;\r\n    }\r\n  },\r\n\r\n  _unbindWindowResize(): void {\r\n    const top = this._top();\r\n    if (!this._boundWindowResize) return;\r\n    try {\r\n      top.removeEventListener('resize', this._boundWindowResize);\r\n    } catch {\r\n      // ignore\r\n    } finally {\r\n      this._boundWindowResize = null;\r\n    }\r\n  },\r\n\r\n  /**  */\r\n  _top(): Window {\r\n    return window.parent ?? window;\r\n  },\r\n\r\n  /**  PIXI */\r\n  _getPIXI(): any {\r\n    const top = this._top();\r\n    return Live2DLoader.getPixi(top);\r\n  },\r\n\r\n  _measureOpaqueBoundsFromCanvas(\r\n    containerWidth: number,\r\n    containerHeight: number,\r\n  ): { left: number; top: number; width: number; height: number } | null {\r\n    const gl = this.glContext;\r\n    if (!gl) return null;\r\n\r\n    const bufferWidth = gl.drawingBufferWidth;\r\n    const bufferHeight = gl.drawingBufferHeight;\r\n    if (bufferWidth <= 0 || bufferHeight <= 0) return null;\r\n\r\n    const byteLength = bufferWidth * bufferHeight * 4;\r\n    if (!this._pixelReadBuffer || this._pixelReadBuffer.length !== byteLength) {\r\n      this._pixelReadBuffer = new Uint8Array(byteLength);\r\n    }\r\n    const pixels = this._pixelReadBuffer;\r\n\r\n    try {\r\n      gl.readPixels(0, 0, bufferWidth, bufferHeight, gl.RGBA, gl.UNSIGNED_BYTE, pixels);\r\n    } catch {\r\n      return null;\r\n    }\r\n\r\n    const scanStep = Math.max(1, Math.floor(Math.sqrt((bufferWidth * bufferHeight) / this._maxPixelScanSamples)));\r\n    const alphaThreshold = Math.max(0, Math.min(255, this._alphaHitThreshold));\r\n\r\n    let minX = bufferWidth;\r\n    let minY = bufferHeight;\r\n    let maxX = -1;\r\n    let maxY = -1;\r\n\r\n    for (let y = 0; y < bufferHeight; y += scanStep) {\r\n      const rowOffset = y * bufferWidth * 4;\r\n      for (let x = 0; x < bufferWidth; x += scanStep) {\r\n        const alpha = pixels[rowOffset + x * 4 + 3];\r\n        if (alpha <= alphaThreshold) continue;\r\n\r\n        if (x < minX) minX = x;\r\n        if (y < minY) minY = y;\r\n        if (x > maxX) maxX = x;\r\n        if (y > maxY) maxY = y;\r\n      }\r\n    }\r\n\r\n    if (maxX < 0 || maxY < 0) return null;\r\n\r\n    if (scanStep > 1) {\r\n      maxX = Math.min(bufferWidth - 1, maxX + scanStep);\r\n      maxY = Math.min(bufferHeight - 1, maxY + scanStep);\r\n    }\r\n\r\n    const scaleX = containerWidth / bufferWidth;\r\n    const scaleY = containerHeight / bufferHeight;\r\n    const left = Math.max(0, Math.floor(minX * scaleX));\r\n    const right = Math.min(Math.ceil(containerWidth), Math.ceil((maxX + 1) * scaleX));\r\n    const top = Math.max(0, Math.floor(containerHeight - (maxY + 1) * scaleY));\r\n    const bottom = Math.min(Math.ceil(containerHeight), Math.ceil(containerHeight - minY * scaleY));\r\n    const width = right - left;\r\n    const height = bottom - top;\r\n    if (width < 8 || height < 8) return null;\r\n\r\n    return { left, top, width, height };\r\n  },\r\n\r\n  _syncInteractionLayerBounds(): void {\r\n    if (!this.container || !this.interactionLayer) return;\r\n\r\n    const layer = this.interactionLayer;\r\n    const container = this.container;\r\n    const disableLayer = () => {\r\n      layer.style.left = '0px';\r\n      layer.style.top = '0px';\r\n      layer.style.width = '100%';\r\n      layer.style.height = '100%';\r\n      layer.style.pointerEvents = 'none';\r\n      layer.style.cursor = 'default';\r\n    };\r\n\r\n    if (this.mountMode === 'preview') {\r\n      disableLayer();\r\n      return;\r\n    }\r\n\r\n    const rect = container.getBoundingClientRect();\r\n    const containerWidth =\r\n      rect.width > 0 ? rect.width : Number.parseFloat(String(container.style.width || '').replace('px', ''));\r\n    const containerHeight =\r\n      rect.height > 0 ? rect.height : Number.parseFloat(String(container.style.height || '').replace('px', ''));\r\n\r\n    if (!Number.isFinite(containerWidth) || !Number.isFinite(containerHeight) || containerWidth <= 0 || containerHeight <= 0) {\r\n      return;\r\n    }\r\n\r\n    const applyBounds = (left: number, top: number, width: number, height: number): boolean => {\r\n      const padding = Math.max(0, this._interactionPaddingPx);\r\n      const x1 = Math.max(0, Math.floor(left - padding));\r\n      const y1 = Math.max(0, Math.floor(top - padding));\r\n      const x2 = Math.min(Math.ceil(containerWidth), Math.ceil(left + width + padding));\r\n      const y2 = Math.min(Math.ceil(containerHeight), Math.ceil(top + height + padding));\r\n      const w = x2 - x1;\r\n      const h = y2 - y1;\r\n      if (w < 16 || h < 16) return false;\r\n\r\n      layer.style.left = `${x1}px`;\r\n      layer.style.top = `${y1}px`;\r\n      layer.style.width = `${w}px`;\r\n      layer.style.height = `${h}px`;\r\n      layer.style.pointerEvents = 'auto';\r\n      layer.style.cursor = 'pointer';\r\n      return true;\r\n    };\r\n\r\n    const model = this.app?.stage?.children?.[0] as any;\r\n    if (!model) {\r\n      disableLayer();\r\n      return;\r\n    }\r\n\r\n    const alphaBounds = this._measureOpaqueBoundsFromCanvas(containerWidth, containerHeight);\r\n    if (alphaBounds) {\r\n      const suspiciouslyHuge =\r\n        alphaBounds.width >= containerWidth * 0.95 && alphaBounds.height >= containerHeight * 0.95;\r\n      if (!suspiciouslyHuge && applyBounds(alphaBounds.left, alphaBounds.top, alphaBounds.width, alphaBounds.height)) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    if (typeof model.getBounds === 'function') {\r\n      try {\r\n        const bounds = model.getBounds();\r\n        const x = Number(bounds?.x);\r\n        const y = Number(bounds?.y);\r\n        const width = Number(bounds?.width);\r\n        const height = Number(bounds?.height);\r\n        const isValid =\r\n          Number.isFinite(x) &&\r\n          Number.isFinite(y) &&\r\n          Number.isFinite(width) &&\r\n          Number.isFinite(height) &&\r\n          width > 0 &&\r\n          height > 0;\r\n        if (isValid) {\r\n          const suspiciouslyHuge = width >= containerWidth * 0.95 && height >= containerHeight * 0.95;\r\n          if (!suspiciouslyHuge && applyBounds(x, y, width, height)) {\r\n            return;\r\n          }\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    const fallbackWidth = Math.max(80, Math.round(containerWidth * 0.62));\r\n    const fallbackHeight = Math.max(120, Math.round(containerHeight * 0.88));\r\n    const fallbackLeft = Math.max(0, Math.round((containerWidth - fallbackWidth) / 2));\r\n    const fallbackTop = Math.max(0, Math.round(containerHeight - fallbackHeight));\r\n    if (!applyBounds(fallbackLeft, fallbackTop, fallbackWidth, fallbackHeight)) {\r\n      disableLayer();\r\n      return;\r\n    }\r\n  },\r\n\r\n  _startInteractionSyncTimer(): void {\r\n    this._stopInteractionSyncTimer();\r\n    this._syncInteractionLayerBounds();\r\n    this._interactionSyncTimer = window.setInterval(() => {\r\n      this._syncInteractionLayerBounds();\r\n    }, 250);\r\n  },\r\n\r\n  _stopInteractionSyncTimer(): void {\r\n    if (this._interactionSyncTimer === null) return;\r\n    window.clearInterval(this._interactionSyncTimer);\r\n    this._interactionSyncTimer = null;\r\n  },\r\n\r\n  _enablePointerDrag(\r\n    $container: JQuery<HTMLElement>,\r\n    options: {\r\n      width: number;\r\n      height: number;\r\n      onPositionChange?: (x: number, y: number) => void;\r\n    },\r\n  ): void {\r\n    if (!this.container) return;\r\n\r\n    const top = this._top();\r\n    const container = this.container;\r\n    const dragTarget = this.interactionLayer ?? container;\r\n    const onPositionChange = options.onPositionChange;\r\n\r\n    const state = {\r\n      pointerId: null as number | null,\r\n      startClientX: 0,\r\n      startClientY: 0,\r\n      startLeft: 0,\r\n      startTop: 0,\r\n      dragging: false,\r\n      touchPointerIds: new Set<number>(),\r\n    };\r\n\r\n    const getRectLeftTop = () => {\r\n      const rect = container.getBoundingClientRect();\r\n      return { left: rect.left, top: rect.top };\r\n    };\r\n\r\n    const getRectSize = () => {\r\n      const rect = container.getBoundingClientRect();\r\n      return {\r\n        width: rect.width > 0 ? rect.width : options.width,\r\n        height: rect.height > 0 ? rect.height : options.height,\r\n      };\r\n    };\r\n\r\n    const cleanup = () => {\r\n      state.pointerId = null;\r\n      state.dragging = false;\r\n      $container.removeClass(this._dragClass);\r\n    };\r\n\r\n    dragTarget.addEventListener('pointerdown', (e: PointerEvent) => {\r\n      if (e.button !== 0) return;\r\n      if (e.pointerType === 'touch') {\r\n        state.touchPointerIds.add(e.pointerId);\r\n        if (state.touchPointerIds.size > 1) {\r\n          cleanup();\r\n          return;\r\n        }\r\n      }\r\n      if (state.pointerId !== null) return;\r\n\r\n      state.pointerId = e.pointerId;\r\n      state.startClientX = e.clientX;\r\n      state.startClientY = e.clientY;\r\n\r\n      const { left, top } = getRectLeftTop();\r\n      state.startLeft = left;\r\n      state.startTop = top;\r\n\r\n      try {\r\n        dragTarget.setPointerCapture(e.pointerId);\r\n      } catch {\r\n        // ignore\r\n      }\r\n    });\r\n\r\n    dragTarget.addEventListener('pointermove', (e: PointerEvent) => {\r\n      if (state.pointerId === null || e.pointerId !== state.pointerId) return;\r\n      if (e.pointerType === 'touch' && state.touchPointerIds.size > 1) {\r\n        cleanup();\r\n        return;\r\n      }\r\n\r\n      const dx = e.clientX - state.startClientX;\r\n      const dy = e.clientY - state.startClientY;\r\n      const dist = Math.sqrt(dx * dx + dy * dy);\r\n\r\n      if (!state.dragging) {\r\n        if (dist < 8) return;\r\n        state.dragging = true;\r\n        $container.addClass(this._dragClass);\r\n\r\n        container.style.left = `${state.startLeft}px`;\r\n        container.style.top = `${state.startTop}px`;\r\n        container.style.right = 'auto';\r\n        container.style.bottom = 'auto';\r\n      }\r\n\r\n      const clamped = this._clampPosition(\r\n        state.startLeft + dx,\r\n        state.startTop + dy,\r\n        getRectSize().width,\r\n        getRectSize().height,\r\n        this._minVisiblePx,\r\n      );\r\n\r\n      container.style.left = `${clamped.x}px`;\r\n      container.style.top = `${clamped.y}px`;\r\n      container.style.right = 'auto';\r\n      container.style.bottom = 'auto';\r\n      e.preventDefault();\r\n    }, { passive: false });\r\n\r\n    const onPointerUp = (e: PointerEvent) => {\r\n      if (e.pointerType === 'touch') {\r\n        state.touchPointerIds.delete(e.pointerId);\r\n      }\r\n      if (state.pointerId === null || e.pointerId !== state.pointerId) return;\r\n\r\n      const dragging = state.dragging;\r\n      cleanup();\r\n\r\n      if (!dragging) return;\r\n\r\n      const left = parseFloat(container.style.left || '0');\r\n      const topPx = parseFloat(container.style.top || '0');\r\n      const size = getRectSize();\r\n      const clamped = this._clampPosition(left, topPx, size.width, size.height, this._minVisiblePx);\r\n\r\n      container.style.left = `${clamped.x}px`;\r\n      container.style.top = `${clamped.y}px`;\r\n      container.style.right = 'auto';\r\n      container.style.bottom = 'auto';\r\n\r\n      this._onPositionChange = onPositionChange ?? this._onPositionChange;\r\n      this._onPositionChange?.(clamped.x, clamped.y);\r\n\r\n      try {\r\n        dragTarget.releasePointerCapture(e.pointerId);\r\n      } catch {\r\n        // ignore\r\n      }\r\n\r\n      // iOS  pointerup  selection\r\n      try {\r\n        top.getSelection?.()?.removeAllRanges?.();\r\n      } catch {\r\n        // ignore\r\n      }\r\n    };\r\n\r\n    dragTarget.addEventListener('pointerup', onPointerUp);\r\n    dragTarget.addEventListener('pointercancel', onPointerUp);\r\n  },\r\n\r\n  _ensureLoadingOverlay(): boolean {\r\n    if (!this.container) return false;\r\n\r\n    const overlay = this.loadingOverlay;\r\n    const overlayAlive = !!overlay && !!overlay.ownerDocument?.documentElement?.contains(overlay);\r\n    if (overlayAlive) return true;\r\n\r\n    this.hideLoadingProgress();\r\n\r\n    const doc = this.container.ownerDocument;\r\n    const panel = doc.createElement('div');\r\n    panel.style.cssText = `\r\n      position: absolute;\r\n      left: 8px;\r\n      right: 8px;\r\n      bottom: 8px;\r\n      padding: 8px 10px;\r\n      border-radius: 8px;\r\n      background: rgba(15, 23, 42, 0.72);\r\n      backdrop-filter: blur(3px);\r\n      pointer-events: none;\r\n      z-index: 5;\r\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);\r\n      color: #e2e8f0;\r\n      font-size: 12px;\r\n      line-height: 1.4;\r\n    `;\r\n\r\n    const text = doc.createElement('div');\r\n    text.style.cssText = 'margin-bottom: 6px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;';\r\n    text.textContent = ' (0%)';\r\n\r\n    const track = doc.createElement('div');\r\n    track.style.cssText = 'width: 100%; height: 6px; border-radius: 999px; background: rgba(148, 163, 184, 0.35); overflow: hidden;';\r\n\r\n    const fill = doc.createElement('div');\r\n    fill.style.cssText = 'height: 100%; width: 0%; border-radius: 999px; background: linear-gradient(90deg, #60a5fa, #22d3ee); transition: width 0.2s ease;';\r\n\r\n    track.appendChild(fill);\r\n    panel.appendChild(text);\r\n    panel.appendChild(track);\r\n    this.container.appendChild(panel);\r\n\r\n    this.loadingOverlay = panel;\r\n    this.loadingText = text;\r\n    this.loadingBarFill = fill;\r\n    return true;\r\n  },\r\n\r\n  showLoadingProgress(percent: number, message: string): void {\r\n    if (!this._ensureLoadingOverlay()) return;\r\n\r\n    const safePercent = Math.max(0, Math.min(100, Math.round(percent)));\r\n    if (this.loadingText) {\r\n      this.loadingText.textContent = `${message} (${safePercent}%)`;\r\n    }\r\n    if (this.loadingBarFill) {\r\n      this.loadingBarFill.style.width = `${safePercent}%`;\r\n    }\r\n  },\r\n\r\n  hideLoadingProgress(): void {\r\n    if (this.loadingOverlay) {\r\n      try {\r\n        this.loadingOverlay.remove();\r\n      } catch (e) {\r\n        warn('Failed to remove loading progress overlay', e);\r\n      }\r\n    }\r\n    this.loadingOverlay = null;\r\n    this.loadingText = null;\r\n    this.loadingBarFill = null;\r\n  },\r\n\r\n  /**\r\n   *  PIXI Application\r\n   */\r\n  create(options: {\r\n    width: number;\r\n    height: number;\r\n    position: { x: number; y: number };\r\n    scale: number;\r\n    onPositionChange?: (x: number, y: number) => void;\r\n    onScaleChange?: (scale: number) => void;\r\n    onTap?: (e: GestureEvent) => void;\r\n    onDoubleTap?: (e: GestureEvent) => void;\r\n    onLongPress?: (e: GestureEvent) => void;\r\n  }): boolean {\r\n    const top = this._top();\r\n    const PIXI = this._getPIXI();\r\n    if (!PIXI) {\r\n      warn('PIXI ');\r\n      return false;\r\n    }\r\n\r\n    // \r\n    this.destroy();\r\n    this._onPositionChange = options.onPositionChange ?? null;\r\n    this._bindWindowResize({ width: options.width, height: options.height });\r\n    const stale = top.document.getElementById('desktop-pet-stage');\r\n    if (stale) stale.remove();\r\n\r\n    //  div\r\n    this.container = top.document.createElement('div');\r\n    this.container.id = 'desktop-pet-stage';\r\n    this.container.style.cssText = `\r\n      position: fixed;\r\n      right: 20px;\r\n      bottom: 20px;\r\n      width: ${options.width}px;\r\n      height: ${options.height}px;\r\n      overflow: hidden;\r\n      z-index: 10000;\r\n      pointer-events: none;\r\n      cursor: default;\r\n      touch-action: none;\r\n    `;\r\n\r\n    // Apply persisted position.\r\n    const hasSavedPosition =\r\n      Number.isFinite(options.position.x) &&\r\n      Number.isFinite(options.position.y) &&\r\n      !(options.position.x === -1 && options.position.y === -1);\r\n\r\n    if (hasSavedPosition) {\r\n      const clamped = this._clampPosition(\r\n        options.position.x,\r\n        options.position.y,\r\n        options.width,\r\n        options.height,\r\n        this._minVisiblePx,\r\n      );\r\n\r\n      this.container.style.left = `${clamped.x}px`;\r\n      this.container.style.top = `${clamped.y}px`;\r\n      this.container.style.right = 'auto';\r\n      this.container.style.bottom = 'auto';\r\n\r\n      if (clamped.clamped) {\r\n        log('', {\r\n          from: options.position,\r\n          to: { x: clamped.x, y: clamped.y },\r\n        });\r\n        options.onPositionChange?.(clamped.x, clamped.y);\r\n      }\r\n    }\r\n\r\n    top.document.body.appendChild(this.container);\r\n\r\n    //  canvas\r\n    this.canvas = top.document.createElement('canvas');\r\n    this.canvas.style.cssText = 'width: 100%; height: 100%; pointer-events: none;';\r\n    this.container.appendChild(this.canvas);\r\n\r\n    this.interactionLayer = top.document.createElement('div');\r\n    this.interactionLayer.className = 'desktop-pet-interaction-layer';\r\n    this.interactionLayer.style.cssText = `\r\n      position: absolute;\r\n      left: 0;\r\n      top: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n      pointer-events: auto;\r\n      cursor: pointer;\r\n      touch-action: none;\r\n      z-index: 4;\r\n    `;\r\n    this.container.appendChild(this.interactionLayer);\r\n\r\n    //  PIXI Application\r\n    const dpr = top.devicePixelRatio || 1;\r\n    this.canvas.width = Math.floor(options.width * dpr);\r\n    this.canvas.height = Math.floor(options.height * dpr);\r\n\r\n    const glContext =\r\n      this.canvas.getContext('webgl2', {\r\n        alpha: true,\r\n        antialias: true,\r\n        stencil: true,\r\n        depth: true,\r\n        preserveDrawingBuffer: true,\r\n        premultipliedAlpha: true,\r\n      }) ||\r\n      this.canvas.getContext('webgl', {\r\n        alpha: true,\r\n        antialias: true,\r\n        stencil: true,\r\n        depth: true,\r\n        preserveDrawingBuffer: true,\r\n        premultipliedAlpha: true,\r\n      });\r\n\r\n    if (!glContext) {\r\n      warn('WebGL is unavailable');\r\n      return false;\r\n    }\r\n    this.glContext = glContext as WebGLRenderingContext | WebGL2RenderingContext;\r\n    this._pixelReadBuffer = null;\r\n\r\n    try {\r\n      const attrs = (glContext as WebGLRenderingContext | WebGL2RenderingContext).getContextAttributes?.();\r\n      if (attrs && attrs.stencil === false) {\r\n        warn('Current WebGL context has no stencil buffer; mask rendering may be abnormal');\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    this.app = new PIXI.Application({\r\n      view: this.canvas,\r\n      context: glContext,\r\n      backgroundAlpha: 0,\r\n      autoStart: true,\r\n      width: options.width,\r\n      height: options.height,\r\n      resolution: dpr,\r\n      autoDensity: true,\r\n      antialias: true,\r\n    });\r\n\r\n    //  jQueryUI \r\n    const $container = $(this.container);\r\n    const draggable = ($container as any).draggable;\r\n    if (typeof draggable === 'function') {\r\n      try {\r\n        $container.draggable({\r\n          handle: '.desktop-pet-interaction-layer',\r\n          start: (_e: any, ui: any) => {\r\n            $container.addClass(this._dragClass);\r\n\r\n            const rect = this.container?.getBoundingClientRect?.();\r\n            if (!rect) return;\r\n\r\n            this.container!.style.left = `${rect.left}px`;\r\n            this.container!.style.top = `${rect.top}px`;\r\n            this.container!.style.right = 'auto';\r\n            this.container!.style.bottom = 'auto';\r\n\r\n            if (ui?.position) {\r\n              ui.position.left = rect.left;\r\n              ui.position.top = rect.top;\r\n            }\r\n          },\r\n          drag: (_e: any, ui: any) => {\r\n            const rect = this.container?.getBoundingClientRect?.();\r\n            const width = rect?.width && rect.width > 0 ? rect.width : options.width;\r\n            const height = rect?.height && rect.height > 0 ? rect.height : options.height;\r\n\r\n            const clamped = this._clampPosition(ui.position.left, ui.position.top, width, height, this._minVisiblePx);\r\n            ui.position.left = clamped.x;\r\n            ui.position.top = clamped.y;\r\n          },\r\n          stop: (_e: any, ui: any) => {\r\n            $container.removeClass(this._dragClass);\r\n\r\n            const rect = this.container?.getBoundingClientRect?.();\r\n            const width = rect?.width && rect.width > 0 ? rect.width : options.width;\r\n            const height = rect?.height && rect.height > 0 ? rect.height : options.height;\r\n\r\n            const clamped = this._clampPosition(\r\n              ui.position.left,\r\n              ui.position.top,\r\n              width,\r\n              height,\r\n              this._minVisiblePx,\r\n            );\r\n\r\n            this.container!.style.left = `${clamped.x}px`;\r\n            this.container!.style.top = `${clamped.y}px`;\r\n            this.container!.style.right = 'auto';\r\n            this.container!.style.bottom = 'auto';\r\n\r\n            this._onPositionChange?.(clamped.x, clamped.y);\r\n          },\r\n        });\r\n      } catch (e) {\r\n        warn('Failed to initialize jQueryUI draggable, fallback to native pointer drag', e);\r\n        this._enablePointerDrag($container, {\r\n          width: options.width,\r\n          height: options.height,\r\n          onPositionChange: options.onPositionChange,\r\n        });\r\n      }\r\n    } else {\r\n      warn('jQueryUI draggable not found, fallback to native pointer drag');\r\n      this._enablePointerDrag($container, {\r\n        width: options.width,\r\n        height: options.height,\r\n        onPositionChange: options.onPositionChange,\r\n      });\r\n    }\r\n\r\n    // Mouse wheel + touch pinch zoom.\r\n    const interactionTarget = this.interactionLayer ?? this.container;\r\n    const SCALE_MIN = 0.1;\r\n    const SCALE_MAX = 3;\r\n    const SCALE_EPSILON = 0.002;\r\n    let currentScale = Number.isFinite(options.scale) ? options.scale : 1;\r\n    let isPinching = false;\r\n    let pinchStartDistance = 0;\r\n    let pinchStartScale = currentScale;\r\n    const activeTouchPointers = new Map<number, { x: number; y: number }>();\r\n\r\n    const emitScaleChange = (nextScale: number) => {\r\n      const safeScale = Math.max(SCALE_MIN, Math.min(SCALE_MAX, nextScale));\r\n      if (Math.abs(safeScale - currentScale) < SCALE_EPSILON) return;\r\n      currentScale = safeScale;\r\n      options.scale = safeScale;\r\n      options.onScaleChange?.(safeScale);\r\n    };\r\n\r\n    const getPinchDistance = () => {\r\n      if (activeTouchPointers.size < 2) return 0;\r\n      const points = Array.from(activeTouchPointers.values());\r\n      const a = points[0];\r\n      const b = points[1];\r\n      const dx = a.x - b.x;\r\n      const dy = a.y - b.y;\r\n      return Math.sqrt(dx * dx + dy * dy);\r\n    };\r\n\r\n    const setDraggableState = (enabled: boolean) => {\r\n      if (typeof draggable !== 'function') return;\r\n      try {\r\n        $container.draggable(enabled ? 'enable' : 'disable');\r\n      } catch {\r\n        // ignore\r\n      }\r\n    };\r\n\r\n    const onTouchPointerDown = (e: PointerEvent) => {\r\n      if (e.pointerType !== 'touch') return;\r\n      activeTouchPointers.set(e.pointerId, { x: e.clientX, y: e.clientY });\r\n      if (activeTouchPointers.size < 2) return;\r\n\r\n      const distance = getPinchDistance();\r\n      if (distance <= 0) return;\r\n\r\n      if (!isPinching) {\r\n        isPinching = true;\r\n        setDraggableState(false);\r\n      }\r\n      pinchStartDistance = distance;\r\n      pinchStartScale = currentScale;\r\n      e.preventDefault();\r\n    };\r\n\r\n    const onTouchPointerMove = (e: PointerEvent) => {\r\n      if (e.pointerType !== 'touch') return;\r\n      if (!activeTouchPointers.has(e.pointerId)) return;\r\n\r\n      activeTouchPointers.set(e.pointerId, { x: e.clientX, y: e.clientY });\r\n      if (!isPinching || activeTouchPointers.size < 2) return;\r\n\r\n      const distance = getPinchDistance();\r\n      if (distance <= 0 || pinchStartDistance <= 0) return;\r\n\r\n      const ratio = distance / pinchStartDistance;\r\n      emitScaleChange(pinchStartScale * ratio);\r\n      e.preventDefault();\r\n    };\r\n\r\n    const onTouchPointerEnd = (e: PointerEvent) => {\r\n      if (e.pointerType !== 'touch') return;\r\n      activeTouchPointers.delete(e.pointerId);\r\n\r\n      if (activeTouchPointers.size >= 2) {\r\n        const distance = getPinchDistance();\r\n        if (distance > 0) {\r\n          pinchStartDistance = distance;\r\n          pinchStartScale = currentScale;\r\n        }\r\n        return;\r\n      }\r\n\r\n      pinchStartDistance = 0;\r\n      pinchStartScale = currentScale;\r\n      if (isPinching) {\r\n        isPinching = false;\r\n        setDraggableState(true);\r\n      }\r\n    };\r\n\r\n    interactionTarget.addEventListener('pointerdown', onTouchPointerDown, { passive: false });\r\n    interactionTarget.addEventListener('pointermove', onTouchPointerMove, { passive: false });\r\n    interactionTarget.addEventListener('pointerup', onTouchPointerEnd);\r\n    interactionTarget.addEventListener('pointercancel', onTouchPointerEnd);\r\n\r\n    interactionTarget.addEventListener('wheel', (e: WheelEvent) => {\r\n      e.preventDefault();\r\n      const delta = e.deltaY > 0 ? -0.05 : 0.05;\r\n      emitScaleChange(currentScale + delta);\r\n    }, { passive: false });\r\n\r\n    // Gesture recognizer (replaces raw click handler).\r\n    this.gestureRecognizer = new GestureRecognizer(\r\n      interactionTarget,\r\n      {},\r\n      (event: GestureEvent) => {\r\n        switch (event.type) {\r\n          case 'tap':\r\n            options.onTap?.(event);\r\n            break;\r\n          case 'double-tap':\r\n            options.onDoubleTap?.(event);\r\n            break;\r\n          case 'long-press':\r\n            options.onLongPress?.(event);\r\n            break;\r\n        }\r\n      },\r\n      () =>\r\n        isPinching ||\r\n        $container.hasClass('ui-draggable-dragging') ||\r\n        $container.hasClass(this._dragClass),\r\n    );\r\n    this._startInteractionSyncTimer();\r\n\r\n    log('Live2D ');\r\n    return true;\r\n  },\r\n\r\n  /**\r\n   *  PIXI Application  stage\r\n   */\r\n  getStage(): any {\r\n    return this.app?.stage;\r\n  },\r\n\r\n  /**\r\n   * \r\n   */\r\n  isPreviewMounted(): boolean {\r\n    return this.mountMode === 'preview';\r\n  },\r\n\r\n  pushMount(mountEl: HTMLElement | null): boolean {\r\n    if (!this.container || !this.app || !this.canvas) return false;\r\n    if (!mountEl || !mountEl.isConnected) return false;\r\n\r\n    const top = this._top();\r\n\r\n    const rect = this.container.getBoundingClientRect?.();\r\n    const width =\r\n      rect?.width && rect.width > 0\r\n        ? Math.round(rect.width)\r\n        : Number(String(this.container.style.width || '').replace('px', '')) || 1;\r\n    const height =\r\n      rect?.height && rect.height > 0\r\n        ? Math.round(rect.height)\r\n        : Number(String(this.container.style.height || '').replace('px', '')) || 1;\r\n\r\n    this.mountStack.push({\r\n      parent: this.container.parentNode,\r\n      nextSibling: this.container.nextSibling,\r\n      styleText: this.container.style.cssText,\r\n      width,\r\n      height,\r\n      onPositionChange: this._onPositionChange,\r\n    });\r\n\r\n    try {\r\n      const pos = top.getComputedStyle(mountEl).position;\r\n      if (pos === 'static') {\r\n        mountEl.style.position = 'relative';\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    // \r\n    this._onPositionChange = null;\r\n    this._unbindWindowResize();\r\n\r\n    try {\r\n      mountEl.appendChild(this.container);\r\n    } catch {\r\n      return false;\r\n    }\r\n\r\n    this.mountMode = 'preview';\r\n    this.container.style.cssText = `\r\n      position: absolute;\r\n      inset: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n      overflow: hidden;\r\n      z-index: 1;\r\n      pointer-events: none;\r\n      cursor: default;\r\n      touch-action: none;\r\n    `;\r\n    if (this.interactionLayer) {\r\n      this.interactionLayer.style.left = '0px';\r\n      this.interactionLayer.style.top = '0px';\r\n      this.interactionLayer.style.width = '100%';\r\n      this.interactionLayer.style.height = '100%';\r\n      this.interactionLayer.style.pointerEvents = 'none';\r\n      this.interactionLayer.style.cursor = 'default';\r\n    }\r\n\r\n    try {\r\n      const $container = $(this.container);\r\n      const draggable = ($container as any).draggable;\r\n      if (typeof draggable === 'function') {\r\n        $container.draggable('disable');\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    return true;\r\n  },\r\n\r\n  popMount(): { width: number; height: number } | null {\r\n    if (!this.container || !this.app || !this.canvas) return null;\r\n    const entry = this.mountStack.pop();\r\n    if (!entry) return null;\r\n\r\n    try {\r\n      const parent = entry.parent;\r\n      if (parent) {\r\n        if (entry.nextSibling && entry.nextSibling.parentNode === parent) {\r\n          parent.insertBefore(this.container, entry.nextSibling);\r\n        } else {\r\n          parent.appendChild(this.container);\r\n        }\r\n      } else {\r\n        this._top().document.body.appendChild(this.container);\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    this.container.style.cssText = entry.styleText;\r\n    this._onPositionChange = entry.onPositionChange;\r\n    this.mountMode = this.mountStack.length > 0 ? 'preview' : 'floating';\r\n    this._syncInteractionLayerBounds();\r\n\r\n    try {\r\n      const $container = $(this.container);\r\n      const draggable = ($container as any).draggable;\r\n      if (typeof draggable === 'function') {\r\n        $container.draggable('enable');\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    //  resize clamp\r\n    this._bindWindowResize({ width: entry.width, height: entry.height });\r\n\r\n    const restore = this._pendingFloatingResize ?? { width: entry.width, height: entry.height };\r\n    this._pendingFloatingResize = null;\r\n    this.resize(restore.width, restore.height);\r\n\r\n    return restore;\r\n  },\r\n\r\n  /**\r\n   *  popMount \r\n   */\r\n  resizeFloating(width: number, height: number): void {\r\n    if (this.mountMode === 'preview') {\r\n      this._pendingFloatingResize = { width, height };\r\n      return;\r\n    }\r\n\r\n    if (this.container) {\r\n      this.container.style.width = `${width}px`;\r\n      this.container.style.height = `${height}px`;\r\n      this._clampContainerToViewport({ width, height }, 'stage-resize');\r\n      this._syncInteractionLayerBounds();\r\n    }\r\n    if (this.app) {\r\n      try {\r\n        this.app.renderer.resize(width, height);\r\n      } catch (e) {\r\n        warn('renderer.resize ', e);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  width/height \r\n   */\r\n  resizePreview(width: number, height: number): void {\r\n    if (this.mountMode !== 'preview') return;\r\n    if (!this.app) return;\r\n    try {\r\n      this.app.renderer.resize(width, height);\r\n      this._syncInteractionLayerBounds();\r\n    } catch (e) {\r\n      warn('renderer.resize ', e);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  resizeFloating\r\n   */\r\n  resize(width: number, height: number): void {\r\n    this.resizeFloating(width, height);\r\n  },\r\n\r\n  /**\n   * \n   */\n  destroy(): void {\n    this.hideLoadingProgress();\r\n    this._unbindWindowResize();\r\n    this._stopInteractionSyncTimer();\r\n    this.mountStack = [];\r\n    this.mountMode = 'floating';\r\n    this._pendingFloatingResize = null;\r\n\r\n    if (this.gestureRecognizer) {\r\n      this.gestureRecognizer.destroy();\r\n      this.gestureRecognizer = null;\r\n    }\r\n\r\n    if (this.app) {\r\n      try {\r\n        this.app.destroy(true);\r\n      } catch (e) {\r\n        warn('Failed to destroy PIXI Application', e);\r\n      }\r\n      this.app = null;\r\n    }\r\n    if (this.container) {\r\n      try {\r\n        this.container.remove();\r\n      } catch (e) {\r\n        warn('', e);\r\n      }\r\n      this.container = null;\r\n    }\r\n    this.interactionLayer = null;\r\n    this.canvas = null;\r\n    this.glContext = null;\r\n    this._pixelReadBuffer = null;\r\n  },\r\n};\r\n\r\n","import type { EmotionTag } from '../core/constants';\n\nexport const BUILTIN_EXPR_TOKEN_PREFIX = '__builtin_expr__:';\nexport const BUILTIN_MOTION_TOKEN_PREFIX = '__builtin_motion__:';\n\nexport type BuiltinExpressionDefinition = {\n  key: string;\n  label: string;\n  fadeIn: number;\n  fadeOut: number;\n  parameters: Record<string, number>;\n};\n\nexport type BuiltinMotionKeyframe = {\n  t: number;\n  params: Record<string, number>;\n};\n\nexport type BuiltinMotionDefinition = {\n  key: string;\n  label: string;\n  durationMs: number;\n  loop: boolean;\n  easing: string;\n  keyframes: BuiltinMotionKeyframe[];\n};\n\nconst BUILTIN_EXPRESSION_DEFS: BuiltinExpressionDefinition[] = [\n  {\n    key: 'default',\n    label: '',\n    fadeIn: 0.24,\n    fadeOut: 0.24,\n    parameters: {\n      ParamAngleX: 0,\n      ParamAngleY: 0,\n      ParamAngleZ: 0,\n      ParamEyeLOpen: 1,\n      ParamEyeROpen: 1,\n      ParamEyeLSmile: 0,\n      ParamEyeRSmile: 0,\n      ParamEyeBallX: 0,\n      ParamEyeBallY: 0,\n      ParamBrowLY: 0,\n      ParamBrowRY: 0,\n      ParamBrowLX: 0,\n      ParamBrowRX: 0,\n      ParamBrowLAngle: 0,\n      ParamBrowRAngle: 0,\n      ParamBrowLForm: 0,\n      ParamBrowRForm: 0,\n      ParamMouthForm: 0,\n      ParamMouthOpenY: 0,\n      ParamCheek: 0,\n      ParamBodyAngleX: 0,\n      ParamBodyAngleY: 0,\n      ParamBodyAngleZ: 0,\n    },\n  },\n  {\n    key: 'smile',\n    label: '',\n    fadeIn: 0.22,\n    fadeOut: 0.2,\n    parameters: {\n      ParamEyeLOpen: 0.88,\n      ParamEyeROpen: 0.88,\n      ParamEyeLSmile: 0.72,\n      ParamEyeRSmile: 0.72,\n      ParamBrowLY: 0.22,\n      ParamBrowRY: 0.22,\n      ParamMouthForm: 0.62,\n      ParamMouthOpenY: 0.22,\n      ParamCheek: 0.35,\n    },\n  },\n  {\n    key: 'angry',\n    label: '',\n    fadeIn: 0.18,\n    fadeOut: 0.16,\n    parameters: {\n      ParamEyeLOpen: 0.72,\n      ParamEyeROpen: 0.72,\n      ParamBrowLY: -0.24,\n      ParamBrowRY: -0.24,\n      ParamBrowLX: 0.52,\n      ParamBrowRX: -0.52,\n      ParamBrowLAngle: -0.84,\n      ParamBrowRAngle: -0.84,\n      ParamMouthForm: -0.72,\n      ParamMouthOpenY: 0.34,\n      ParamAngleZ: 0.1,\n    },\n  },\n  {\n    key: 'sad',\n    label: '',\n    fadeIn: 0.2,\n    fadeOut: 0.2,\n    parameters: {\n      ParamEyeLOpen: 0.56,\n      ParamEyeROpen: 0.56,\n      ParamBrowLY: -0.12,\n      ParamBrowRY: -0.12,\n      ParamBrowLAngle: 0.35,\n      ParamBrowRAngle: 0.35,\n      ParamMouthForm: -0.44,\n      ParamMouthOpenY: 0.08,\n      ParamBodyAngleX: -0.12,\n    },\n  },\n  {\n    key: 'surprised',\n    label: '',\n    fadeIn: 0.12,\n    fadeOut: 0.16,\n    parameters: {\n      ParamEyeLOpen: 1,\n      ParamEyeROpen: 1,\n      ParamEyeBallY: 0.25,\n      ParamBrowLY: 0.66,\n      ParamBrowRY: 0.66,\n      ParamMouthForm: 0.2,\n      ParamMouthOpenY: 0.92,\n      ParamBodyAngleY: 0.12,\n    },\n  },\n  {\n    key: 'smirk',\n    label: '',\n    fadeIn: 0.18,\n    fadeOut: 0.16,\n    parameters: {\n      ParamEyeLOpen: 0.82,\n      ParamEyeROpen: 0.72,\n      ParamEyeLSmile: 0.4,\n      ParamEyeRSmile: 0.08,\n      ParamBrowLY: 0.18,\n      ParamBrowRY: 0.04,\n      ParamMouthForm: 0.44,\n      ParamMouthOpenY: 0.12,\n      ParamAngleZ: 0.14,\n    },\n  },\n  {\n    key: 'shy',\n    label: '',\n    fadeIn: 0.2,\n    fadeOut: 0.22,\n    parameters: {\n      ParamEyeLOpen: 0.66,\n      ParamEyeROpen: 0.66,\n      ParamEyeLSmile: 0.45,\n      ParamEyeRSmile: 0.45,\n      ParamBrowLY: 0.18,\n      ParamBrowRY: 0.18,\n      ParamMouthForm: 0.22,\n      ParamMouthOpenY: 0.14,\n      ParamCheek: 0.86,\n      ParamAngleY: -0.14,\n      ParamBodyAngleZ: -0.18,\n    },\n  },\n  {\n    key: 'thinking',\n    label: '',\n    fadeIn: 0.2,\n    fadeOut: 0.2,\n    parameters: {\n      ParamEyeLOpen: 0.84,\n      ParamEyeROpen: 0.84,\n      ParamEyeBallX: -0.32,\n      ParamEyeBallY: 0.28,\n      ParamBrowLY: 0.32,\n      ParamBrowRY: 0.32,\n      ParamMouthForm: -0.08,\n      ParamMouthOpenY: 0,\n      ParamAngleY: -0.12,\n    },\n  },\n  {\n    key: 'laugh',\n    label: '',\n    fadeIn: 0.14,\n    fadeOut: 0.18,\n    parameters: {\n      ParamEyeLOpen: 0.2,\n      ParamEyeROpen: 0.2,\n      ParamEyeLSmile: 1,\n      ParamEyeRSmile: 1,\n      ParamBrowLY: 0.36,\n      ParamBrowRY: 0.36,\n      ParamMouthForm: 0.85,\n      ParamMouthOpenY: 0.95,\n      ParamCheek: 0.4,\n      ParamAngleY: 0.08,\n    },\n  },\n  {\n    key: 'playful',\n    label: '',\n    fadeIn: 0.16,\n    fadeOut: 0.16,\n    parameters: {\n      ParamEyeLOpen: 0.24,\n      ParamEyeROpen: 1,\n      ParamEyeLSmile: 0.65,\n      ParamEyeBallX: 0.42,\n      ParamMouthForm: 0.7,\n      ParamMouthOpenY: 0.42,\n      ParamBrowLY: 0.24,\n      ParamBrowRY: 0.08,\n      ParamAngleZ: 0.26,\n    },\n  },\n];\n\nconst BUILTIN_MOTION_DEFS: BuiltinMotionDefinition[] = [\n  {\n    key: 'idle_breath',\n    label: '',\n    durationMs: 2200,\n    loop: true,\n    easing: 'easeInOut',\n    keyframes: [\n      { t: 0, params: { ParamBodyAngleY: 0, ParamBodyAngleX: 0, ParamAngleX: 0, ParamMouthOpenY: 0 } },\n      { t: 0.25, params: { ParamBodyAngleY: 0.08, ParamBodyAngleX: -0.04, ParamAngleX: -0.05, ParamMouthOpenY: 0.04 } },\n      { t: 0.5, params: { ParamBodyAngleY: 0, ParamBodyAngleX: 0, ParamAngleX: 0, ParamMouthOpenY: 0 } },\n      { t: 0.75, params: { ParamBodyAngleY: -0.06, ParamBodyAngleX: 0.03, ParamAngleX: 0.04, ParamMouthOpenY: 0.02 } },\n      { t: 1, params: { ParamBodyAngleY: 0, ParamBodyAngleX: 0, ParamAngleX: 0, ParamMouthOpenY: 0 } },\n    ],\n  },\n  {\n    key: 'nod',\n    label: '',\n    durationMs: 760,\n    loop: false,\n    easing: 'easeOut',\n    keyframes: [\n      { t: 0, params: { ParamAngleY: 0, ParamBodyAngleY: 0, ParamAngleZ: 0 } },\n      { t: 0.35, params: { ParamAngleY: -0.46, ParamBodyAngleY: -0.24, ParamAngleZ: 0.02 } },\n      { t: 0.65, params: { ParamAngleY: 0.28, ParamBodyAngleY: 0.1, ParamAngleZ: -0.02 } },\n      { t: 1, params: { ParamAngleY: 0, ParamBodyAngleY: 0, ParamAngleZ: 0 } },\n    ],\n  },\n  {\n    key: 'shake_head',\n    label: '',\n    durationMs: 940,\n    loop: false,\n    easing: 'easeInOut',\n    keyframes: [\n      { t: 0, params: { ParamAngleX: 0, ParamAngleZ: 0, ParamBodyAngleX: 0 } },\n      { t: 0.2, params: { ParamAngleX: 0.5, ParamAngleZ: 0.1, ParamBodyAngleX: 0.16 } },\n      { t: 0.45, params: { ParamAngleX: -0.56, ParamAngleZ: -0.12, ParamBodyAngleX: -0.2 } },\n      { t: 0.7, params: { ParamAngleX: 0.34, ParamAngleZ: 0.08, ParamBodyAngleX: 0.12 } },\n      { t: 1, params: { ParamAngleX: 0, ParamAngleZ: 0, ParamBodyAngleX: 0 } },\n    ],\n  },\n  {\n    key: 'tilt_body',\n    label: '',\n    durationMs: 980,\n    loop: false,\n    easing: 'easeInOut',\n    keyframes: [\n      { t: 0, params: { ParamBodyAngleZ: 0, ParamAngleZ: 0, ParamBodyAngleX: 0 } },\n      { t: 0.35, params: { ParamBodyAngleZ: 0.36, ParamAngleZ: 0.2, ParamBodyAngleX: -0.08 } },\n      { t: 0.7, params: { ParamBodyAngleZ: -0.14, ParamAngleZ: -0.08, ParamBodyAngleX: 0.04 } },\n      { t: 1, params: { ParamBodyAngleZ: 0, ParamAngleZ: 0, ParamBodyAngleX: 0 } },\n    ],\n  },\n  {\n    key: 'surprised_back',\n    label: '',\n    durationMs: 820,\n    loop: false,\n    easing: 'easeOut',\n    keyframes: [\n      { t: 0, params: { ParamBodyAngleY: 0, ParamAngleX: 0, ParamMouthOpenY: 0.1 } },\n      { t: 0.28, params: { ParamBodyAngleY: 0.4, ParamAngleX: 0.24, ParamMouthOpenY: 0.88 } },\n      { t: 0.68, params: { ParamBodyAngleY: 0.12, ParamAngleX: 0.08, ParamMouthOpenY: 0.42 } },\n      { t: 1, params: { ParamBodyAngleY: 0, ParamAngleX: 0, ParamMouthOpenY: 0.16 } },\n    ],\n  },\n];\n\nconst BUILTIN_EXPRESSION_TAG_MAP: Record<EmotionTag, string> = {\n  : 'default',\n  : 'smile',\n  : 'angry',\n  : 'sad',\n  : 'surprised',\n  : 'smirk',\n  : 'shy',\n  : 'thinking',\n  : 'laugh',\n  : 'playful',\n};\n\nconst BUILTIN_MOTION_TAG_MAP: Record<EmotionTag, string> = {\n  : 'idle_breath',\n  : 'nod',\n  : 'shake_head',\n  : 'tilt_body',\n  : 'surprised_back',\n  : 'shake_head',\n  : 'tilt_body',\n  : 'nod',\n  : 'nod',\n  : 'shake_head',\n};\n\nconst BUILTIN_EXPRESSIONS_BY_KEY = new Map(BUILTIN_EXPRESSION_DEFS.map(item => [item.key, item]));\nconst BUILTIN_MOTIONS_BY_KEY = new Map(BUILTIN_MOTION_DEFS.map(item => [item.key, item]));\n\nfunction normalizeTokenValue(raw: unknown, prefix: string): string {\n  const text = String(raw || '').trim();\n  if (!text.toLowerCase().startsWith(prefix.toLowerCase())) return '';\n  return text.slice(prefix.length).trim();\n}\n\nexport function makeBuiltinExpressionToken(key: string): string {\n  const normalized = String(key || '').trim();\n  if (!normalized) return '';\n  return `${BUILTIN_EXPR_TOKEN_PREFIX}${normalized}`;\n}\n\nexport function makeBuiltinMotionToken(key: string): string {\n  const normalized = String(key || '').trim();\n  if (!normalized) return '';\n  return `${BUILTIN_MOTION_TOKEN_PREFIX}${normalized}`;\n}\n\nexport function parseBuiltinExpressionToken(value: unknown): string {\n  const key = normalizeTokenValue(value, BUILTIN_EXPR_TOKEN_PREFIX);\n  return BUILTIN_EXPRESSIONS_BY_KEY.has(key) ? key : '';\n}\n\nexport function parseBuiltinMotionToken(value: unknown): string {\n  const key = normalizeTokenValue(value, BUILTIN_MOTION_TOKEN_PREFIX);\n  return BUILTIN_MOTIONS_BY_KEY.has(key) ? key : '';\n}\n\nexport function isBuiltinExpressionToken(value: unknown): boolean {\n  return !!parseBuiltinExpressionToken(value);\n}\n\nexport function isBuiltinMotionToken(value: unknown): boolean {\n  return !!parseBuiltinMotionToken(value);\n}\n\nexport function getBuiltinExpressionByKey(key: string): BuiltinExpressionDefinition | null {\n  const normalized = String(key || '').trim();\n  if (!normalized) return null;\n  return BUILTIN_EXPRESSIONS_BY_KEY.get(normalized) || null;\n}\n\nexport function getBuiltinMotionByKey(key: string): BuiltinMotionDefinition | null {\n  const normalized = String(key || '').trim();\n  if (!normalized) return null;\n  return BUILTIN_MOTIONS_BY_KEY.get(normalized) || null;\n}\n\nexport function getBuiltinExpressionForTag(tag: EmotionTag): BuiltinExpressionDefinition | null {\n  const key = BUILTIN_EXPRESSION_TAG_MAP[String(tag || '').trim() as EmotionTag] || BUILTIN_EXPRESSION_TAG_MAP.;\n  return getBuiltinExpressionByKey(key);\n}\n\nexport function getBuiltinMotionForTag(tag: EmotionTag): BuiltinMotionDefinition | null {\n  const key = BUILTIN_MOTION_TAG_MAP[String(tag || '').trim() as EmotionTag] || BUILTIN_MOTION_TAG_MAP.;\n  return getBuiltinMotionByKey(key);\n}\n\nexport function getBuiltinExpressionOptions(): Array<{ key: string; label: string; token: string }> {\n  return BUILTIN_EXPRESSION_DEFS.map(item => ({\n    key: item.key,\n    label: item.label,\n    token: makeBuiltinExpressionToken(item.key),\n  }));\n}\n\nexport function getBuiltinMotionOptions(): Array<{ key: string; label: string; token: string }> {\n  return BUILTIN_MOTION_DEFS.map(item => ({\n    key: item.key,\n    label: item.label,\n    token: makeBuiltinMotionToken(item.key),\n  }));\n}\n","import { EMPTY_MOTION_GROUP_VALUE, type EmotionTag } from '../core/constants';\nimport type { EmotionMotionOverride } from '../core/emotion';\nimport {\n  getBuiltinExpressionForTag,\n  getBuiltinMotionForTag,\n  parseBuiltinExpressionToken,\n  parseBuiltinMotionToken,\n} from './builtin-expression-motion';\n\nexport const EXPRESSION_LIVE2D_MAP: Record<\n  EmotionTag,\n  {\n    expressions: string[];\n    motions: string[];\n  }\n> = {\n  : {\n    expressions: ['normal', 'default', 'neutral', 'idle', 'base'],\n    motions: ['idle', 'normal', 'wait', 'default', 'stand'],\n  },\n  : {\n    expressions: ['smile', 'happy', 'joy', 'glad', 'pleased'],\n    motions: ['happy', 'smile', 'joy', 'weixiao', 'xiao', ''],\n  },\n  : {\n    expressions: ['angry', 'anger', 'mad', 'rage', 'annoyed'],\n    motions: ['angry', 'rage', 'mad', 'shengqi', 'duqi', ''],\n  },\n  : {\n    expressions: ['sad', 'sorrow', 'cry', 'upset', 'depressed'],\n    motions: ['sad', 'cry', 'sorrow', 'nanguo', 'leiw', ''],\n  },\n  : {\n    expressions: ['surprised', 'shock', 'amazed', 'wow', 'astonished'],\n    motions: ['surprised', 'shock', 'amazed', 'jingya', 'jingxi', ''],\n  },\n  : {\n    expressions: ['smirk', 'mock', 'sneer', 'tease', 'sarcastic'],\n    motions: ['mock', 'tease', 'tiaoxi', ''],\n  },\n  : {\n    expressions: ['shy', 'blush', 'embarrassed', 'bashful', 'timid'],\n    motions: ['shy', 'embarrassed', 'blush', 'haixiu', 'shame', ''],\n  },\n  : {\n    expressions: ['think', 'ponder', 'confused', 'wonder', 'curious'],\n    motions: ['think', 'ponder', 'wonder', 'sikao', ''],\n  },\n  : {\n    expressions: ['laugh', 'lol', 'haha', 'giggle', 'rofl'],\n    motions: ['laugh', 'giggle', 'haha', 'daxiao', 'oowarai', ''],\n  },\n  : {\n    expressions: ['playful', 'wink', 'silly', 'fun', 'mischievous'],\n    motions: ['playful', 'wink', 'fun', 'gaoguai', 'silly', ''],\n  },\n};\n\nfunction uniquePush(list: string[], seen: Set<string>, value: unknown): void {\n  const normalized = String(value ?? '').trim();\n  if (!normalized || seen.has(normalized)) return;\n  seen.add(normalized);\n  list.push(normalized);\n}\n\nfunction uniquePushAllowEmpty(list: string[], seen: Set<string>, value: unknown): void {\n  const raw = String(value ?? '');\n  const normalized = raw.trim();\n  if (!normalized && raw !== '') return;\n  const finalValue = normalized || '';\n  if (seen.has(finalValue)) return;\n  seen.add(finalValue);\n  list.push(finalValue);\n}\n\nexport type Live2DMotionEntry = {\n  group: string;\n  index: number;\n  name: string;\n};\n\nfunction uniqueMotionPush(list: Live2DMotionEntry[], seen: Set<string>, entry: Live2DMotionEntry): void {\n  const group = String(entry.group ?? '');\n  const index = Number.isFinite(entry.index) ? Math.max(0, Math.floor(entry.index)) : 0;\n  const name = String(entry.name ?? '').trim();\n  if (!name) return;\n  const key = `${group}#${index}#${name.toLowerCase()}`;\n  if (seen.has(key)) return;\n  seen.add(key);\n  list.push({ group, index, name });\n}\n\nfunction normalizeFileStem(input: unknown): string {\n  const raw = String(input ?? '').trim();\n  if (!raw) return '';\n\n  const noHash = raw.split('#')[0];\n  const noQuery = noHash.split('?')[0];\n  const filePart = noQuery.split('/').pop() || noQuery;\n  let decoded = filePart;\n  try {\n    decoded = decodeURIComponent(filePart);\n  } catch {\n    // ignore\n  }\n\n  return decoded\n    .replace(/\\.exp3\\.json$/i, '')\n    .replace(/\\.motion3\\.json$/i, '')\n    .replace(/\\.mtn$/i, '')\n    .replace(/\\.json$/i, '')\n    .trim();\n}\n\nfunction normalizeDefinitionName(def: unknown, fallback = ''): string {\n  if (typeof def === 'string') {\n    return normalizeFileStem(def) || def.trim();\n  }\n  if (!def || typeof def !== 'object') {\n    return fallback;\n  }\n\n  const obj = def as any;\n  const directName = obj.Name || obj.name || obj.Id || obj.id || '';\n  if (String(directName ?? '').trim()) {\n    return String(directName).trim();\n  }\n\n  const fileLike = obj.File || obj.file || obj.Path || obj.path || '';\n  const stem = normalizeFileStem(fileLike);\n  if (stem) return stem;\n\n  return fallback;\n}\n\nfunction collectSettingsCandidates(model: any): any[] {\n  const candidates: any[] = [];\n  const seen = new Set<any>();\n\n  const add = (obj: any) => {\n    if (!obj || typeof obj !== 'object') return;\n    if (seen.has(obj)) return;\n    seen.add(obj);\n    candidates.push(obj);\n  };\n\n  const motionManager = model?.internalModel?.motionManager;\n  const settings = model?.internalModel?.settings;\n\n  add(settings);\n  add(settings?.json);\n  add(settings?.rawSettings);\n  add(settings?.modelJson);\n  add(motionManager?.settings);\n  add(motionManager?.settings?.json);\n  add(motionManager?.settings?.rawSettings);\n  add(motionManager?.settings?.modelJson);\n\n  return candidates;\n}\n\nfunction isExpressionFileLike(input: unknown): boolean {\n  const raw = String(input ?? '').trim().toLowerCase();\n  if (!raw) return false;\n  return /\\.exp3\\.json($|[?#])/.test(raw) || /\\.exp\\.json($|[?#])/.test(raw) || /\\.exp($|[?#])/.test(raw);\n}\n\nfunction isMotionFileLike(input: unknown): boolean {\n  const raw = String(input ?? '').trim().toLowerCase();\n  if (!raw) return false;\n  return /\\.motion3\\.json($|[?#])/.test(raw) || /\\.mtn($|[?#])/.test(raw);\n}\n\nfunction isMotionDefinition(node: unknown): boolean {\n  if (typeof node === 'string') {\n    return isMotionFileLike(node);\n  }\n  if (!node || typeof node !== 'object') return false;\n\n  const obj = node as any;\n  const fileLike = obj.File || obj.file || obj.Path || obj.path || '';\n  if (isMotionFileLike(fileLike)) return true;\n\n  const soundLike = obj.Sound || obj.sound || '';\n  if (typeof soundLike === 'string' && soundLike.trim()) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction countMotionDefinitions(list: unknown[]): number {\n  let count = 0;\n  for (const item of list) {\n    if (isMotionDefinition(item)) count++;\n  }\n  return count > 0 ? count : list.length;\n}\n\nfunction mergeGroupCount(target: Record<string, number>, key: unknown, count: unknown): void {\n  const keyRaw = String(key ?? '');\n  const normalized = keyRaw.trim();\n  if (!normalized && keyRaw !== '') return;\n\n  const groupName = normalized || '';\n  const parsedCount = Number(count);\n  const safeCount = Number.isFinite(parsedCount) && parsedCount > 0 ? Math.max(1, Math.floor(parsedCount)) : 1;\n  const prev = target[groupName];\n  target[groupName] = Number.isFinite(prev) && prev > 0 ? Math.max(prev, safeCount) : safeCount;\n}\n\nfunction pushFromContainer(names: string[], seen: Set<string>, container: unknown, fallbackPrefix: string): void {\n  const pushFromList = (list: unknown[], fallbackPrefixInner: string) => {\n    for (let i = 0; i < list.length; i++) {\n      const normalized = normalizeDefinitionName(list[i], `${fallbackPrefixInner}_${i + 1}`);\n      uniquePush(names, seen, normalized);\n    }\n  };\n\n  if (Array.isArray(container)) {\n    pushFromList(container, fallbackPrefix);\n    return;\n  }\n  if (!container || typeof container !== 'object') return;\n\n  let i = 0;\n  for (const [key, value] of Object.entries(container as Record<string, unknown>)) {\n    const fallbackName = normalizeFileStem(key) || String(key || '').trim() || `${fallbackPrefix}_${i + 1}`;\n    const normalized = normalizeDefinitionName(value, fallbackName);\n    uniquePush(names, seen, normalized || fallbackName);\n    i++;\n  }\n}\n\nexport function collectExpressionNamesFromUnknown(raw: unknown): string[] {\n  const names: string[] = [];\n  const seen = new Set<string>();\n  const visited = new Set<any>();\n\n  const visit = (node: unknown, context = ''): void => {\n    if (node == null) return;\n\n    if (typeof node === 'string') {\n      const text = node.trim();\n      if (!text) return;\n      if (isExpressionFileLike(text) || /exp|expression/.test(context)) {\n        uniquePush(names, seen, normalizeFileStem(text) || text);\n      }\n      return;\n    }\n\n    if (Array.isArray(node)) {\n      for (let i = 0; i < node.length; i++) {\n        const item = node[i];\n        const fallback = `${context || 'expression'}_${i + 1}`;\n        if (typeof item === 'string') {\n          if (isExpressionFileLike(item) || /exp|expression/.test(context)) {\n            uniquePush(names, seen, normalizeFileStem(item) || item);\n          }\n          continue;\n        }\n\n        if (item && typeof item === 'object') {\n          const normalized = normalizeDefinitionName(item, fallback);\n          const itemAny = item as any;\n          const fileLike = itemAny.File || itemAny.file || itemAny.Path || itemAny.path || '';\n          if (/exp|expression/.test(context) || isExpressionFileLike(fileLike)) {\n            uniquePush(names, seen, normalized || fallback);\n          }\n        }\n\n        visit(item, context);\n      }\n      return;\n    }\n\n    if (typeof node !== 'object') return;\n    if (visited.has(node)) return;\n    visited.add(node);\n\n    const obj = node as Record<string, unknown>;\n    const anyObj = obj as any;\n    const directFile = anyObj.File || anyObj.file || anyObj.Path || anyObj.path || '';\n    if (isExpressionFileLike(directFile)) {\n      uniquePush(names, seen, normalizeDefinitionName(obj, normalizeFileStem(directFile)));\n    }\n\n    for (const [rawKey, value] of Object.entries(obj)) {\n      const key = String(rawKey || '').trim();\n      if (!key) continue;\n      const keyLower = key.toLowerCase();\n      const keyIsExpression = keyLower.includes('expression') || keyLower.includes('expr') || keyLower === 'exp';\n      const nextContext = keyIsExpression ? 'expression' : context;\n\n      if (typeof value === 'string') {\n        const text = value.trim();\n        if (!text) continue;\n        if (isExpressionFileLike(text) || keyIsExpression || /exp|expression/.test(context)) {\n          const fallback = normalizeFileStem(key) || key;\n          const normalized = normalizeDefinitionName({ Name: fallback, File: text }, fallback);\n          uniquePush(names, seen, normalized || fallback);\n        }\n        continue;\n      }\n\n      if (Array.isArray(value)) {\n        if (keyIsExpression || /exp|expression/.test(context)) {\n          pushFromContainer(names, seen, value, normalizeFileStem(key) || 'expression');\n        }\n        visit(value, nextContext);\n        continue;\n      }\n\n      if (value && typeof value === 'object') {\n        if (keyIsExpression) {\n          const fallback = normalizeFileStem(key) || key;\n          uniquePush(names, seen, normalizeDefinitionName(value, fallback));\n        }\n        visit(value, nextContext);\n      }\n    }\n  };\n\n  visit(raw, '');\n  return names;\n}\n\nexport function collectMotionGroupCountsFromUnknown(raw: unknown): Record<string, number> {\n  const groups: Record<string, number> = {};\n  const visited = new Set<any>();\n\n  const visit = (node: unknown, parentKey = '', context = ''): void => {\n    if (node == null) return;\n\n    if (Array.isArray(node)) {\n      const count = countMotionDefinitions(node);\n      if ((parentKey === '' || !!parentKey) && count > 0 && (context === 'motion' || node.some(item => isMotionDefinition(item)))) {\n        mergeGroupCount(groups, parentKey, count);\n      }\n\n      for (const item of node) {\n        if (item && typeof item === 'object') {\n          visit(item, parentKey, context);\n        }\n      }\n      return;\n    }\n\n    if (typeof node !== 'object') return;\n    if (visited.has(node)) return;\n    visited.add(node);\n\n    const obj = node as Record<string, unknown>;\n    for (const [rawKey, value] of Object.entries(obj)) {\n      const keyRaw = String(rawKey ?? '');\n      const keyTrimmed = keyRaw.trim();\n      const key = keyTrimmed || (keyRaw === '' ? '' : '');\n      if (!key && keyRaw !== '') continue;\n\n      const keyLower = key.toLowerCase();\n      const keyIsMotionContainer =\n        keyLower.includes('motions') ||\n        keyLower.includes('motion') ||\n        keyLower.includes('anim') ||\n        keyLower.includes('mtn');\n      const nextContext = keyIsMotionContainer ? 'motion' : context;\n\n      if (Array.isArray(value)) {\n        const count = countMotionDefinitions(value);\n        if (count > 0 && (nextContext === 'motion' || value.some(item => isMotionDefinition(item)))) {\n          mergeGroupCount(groups, key, count);\n        }\n        visit(value, key, nextContext);\n        continue;\n      }\n\n      if (typeof value === 'string') {\n        if (isMotionFileLike(value) && parentKey) {\n          mergeGroupCount(groups, parentKey, 1);\n        }\n        continue;\n      }\n\n      if (value && typeof value === 'object') {\n        if (keyIsMotionContainer) {\n          const nested = value as Record<string, unknown>;\n          for (const [nestedRawKey, nestedValue] of Object.entries(nested)) {\n            const nestedRaw = String(nestedRawKey ?? '');\n            const nestedTrimmed = nestedRaw.trim();\n            const nestedKey = nestedTrimmed || (nestedRaw === '' ? '' : '');\n            if (!nestedKey && nestedRaw !== '') continue;\n            if (!Array.isArray(nestedValue)) continue;\n            const nestedCount = countMotionDefinitions(nestedValue);\n            if (nestedCount > 0) {\n              mergeGroupCount(groups, nestedKey, nestedCount);\n            }\n          }\n        }\n        visit(value, key, nextContext);\n      }\n    }\n  };\n\n  visit(raw, '', '');\n  return groups;\n}\n\nfunction pushMotionEntriesFromGroupContainer(entries: Live2DMotionEntry[], seen: Set<string>, container: unknown): void {\n  if (!container) return;\n\n  const pushFromList = (group: string, list: unknown[]) => {\n    const isKnownMotionDef = (def: unknown): boolean => {\n      if (typeof def === 'string') return String(def).trim().length > 0;\n      if (!def || typeof def !== 'object') return false;\n      const obj = def as any;\n      if (String(obj.File || obj.file || obj.Path || obj.path || '').trim()) return true;\n      if (String(obj.Name || obj.name || obj.Id || obj.id || '').trim()) return true;\n      return isMotionDefinition(def);\n    };\n\n    for (let i = 0; i < list.length; i++) {\n      const def = list[i];\n      if (!isKnownMotionDef(def)) continue;\n      const name = normalizeDefinitionName(def, `motion_${i + 1}`);\n      uniqueMotionPush(entries, seen, { group, index: i, name });\n    }\n  };\n\n  if (Array.isArray(container)) {\n    pushFromList('', container);\n    return;\n  }\n\n  if (typeof container !== 'object') return;\n\n  for (const [rawKey, value] of Object.entries(container as Record<string, unknown>)) {\n    const groupRaw = String(rawKey ?? '');\n    const groupTrimmed = groupRaw.trim();\n    if (!groupTrimmed && groupRaw !== '') continue;\n    const group = groupTrimmed || '';\n    if (!Array.isArray(value)) continue;\n    pushFromList(group, value);\n  }\n}\n\nexport function collectMotionEntries(model: any): Live2DMotionEntry[] {\n  const entries: Live2DMotionEntry[] = [];\n  const seen = new Set<string>();\n\n  const motionManager = model?.internalModel?.motionManager;\n  pushMotionEntriesFromGroupContainer(entries, seen, motionManager?.definitions);\n\n  const settingsCandidates = collectSettingsCandidates(model);\n  for (const settings of settingsCandidates) {\n    pushMotionEntriesFromGroupContainer(entries, seen, settings?.motions);\n    pushMotionEntriesFromGroupContainer(entries, seen, settings?.Motions);\n    pushMotionEntriesFromGroupContainer(entries, seen, settings?.FileReferences?.Motions);\n  }\n\n  return entries;\n}\n\nexport function collectExpressionNames(model: any): string[] {\n  const names: string[] = [];\n  const seen = new Set<string>();\n  const expressionManager = model?.internalModel?.motionManager?.expressionManager;\n\n  pushFromContainer(names, seen, expressionManager?.definitions, 'definition');\n  pushFromContainer(names, seen, expressionManager?.expressions, 'expression');\n  for (const name of collectExpressionNamesFromUnknown(expressionManager?.definitions)) {\n    uniquePush(names, seen, name);\n  }\n  for (const name of collectExpressionNamesFromUnknown(expressionManager?.expressions)) {\n    uniquePush(names, seen, name);\n  }\n\n  const settingsCandidates = collectSettingsCandidates(model);\n  for (const settings of settingsCandidates) {\n    pushFromContainer(names, seen, settings?.expressions, 'settings_expr');\n    pushFromContainer(names, seen, settings?.Expressions, 'settings_expr');\n    pushFromContainer(names, seen, settings?.FileReferences?.Expressions, 'file_ref_expr');\n    for (const name of collectExpressionNamesFromUnknown(settings)) {\n      uniquePush(names, seen, name);\n    }\n  }\n\n  const settings = model?.internalModel?.settings;\n  if (settings && typeof settings === 'object') {\n    if (typeof (settings as any).getExpressionCount === 'function') {\n      let count = 0;\n      try {\n        count = Number((settings as any).getExpressionCount()) || 0;\n      } catch {\n        // ignore\n      }\n      count = Math.max(0, Math.min(count, 1000));\n\n      for (let i = 0; i < count; i++) {\n        let name = '';\n        if (typeof (settings as any).getExpressionName === 'function') {\n          try {\n            name = String((settings as any).getExpressionName(i) ?? '').trim();\n          } catch {\n            // ignore\n          }\n        }\n        if (!name && typeof (settings as any).getExpressionFile === 'function') {\n          try {\n            name = normalizeFileStem((settings as any).getExpressionFile(i));\n          } catch {\n            // ignore\n          }\n        }\n        uniquePush(names, seen, name || `expression_${i + 1}`);\n      }\n    }\n  }\n\n  return names;\n}\n\nexport function collectMotionGroupNames(model: any): string[] {\n  const groupNames: string[] = [];\n  const seen = new Set<string>();\n  const motionManager = model?.internalModel?.motionManager;\n\n  const pushFromObject = (obj: unknown) => {\n    if (!obj || typeof obj !== 'object') return;\n    for (const key of Object.keys(obj as Record<string, unknown>)) {\n      uniquePushAllowEmpty(groupNames, seen, key);\n    }\n  };\n\n  pushFromObject(motionManager?.motionGroups);\n  pushFromObject(motionManager?.groups);\n  pushFromObject(motionManager?.definitions);\n  for (const [groupName] of Object.entries(collectMotionGroupCountsFromUnknown(motionManager?.definitions))) {\n    uniquePushAllowEmpty(groupNames, seen, groupName);\n  }\n\n  const settingsCandidates = collectSettingsCandidates(model);\n  for (const settings of settingsCandidates) {\n    pushFromObject(settings?.motions);\n    pushFromObject(settings?.Motions);\n    pushFromObject(settings?.FileReferences?.Motions);\n    for (const [groupName] of Object.entries(collectMotionGroupCountsFromUnknown(settings))) {\n      uniquePushAllowEmpty(groupNames, seen, groupName);\n    }\n  }\n\n  const settings = model?.internalModel?.settings;\n  if (settings && typeof settings === 'object') {\n    const anySettings = settings as any;\n    if (typeof anySettings.getMotionGroupCount === 'function' && typeof anySettings.getMotionGroupName === 'function') {\n      let count = 0;\n      try {\n        count = Number(anySettings.getMotionGroupCount()) || 0;\n      } catch {\n        // ignore\n      }\n      count = Math.max(0, Math.min(count, 1000));\n\n      for (let i = 0; i < count; i++) {\n        try {\n          uniquePushAllowEmpty(groupNames, seen, String(anySettings.getMotionGroupName(i) ?? ''));\n        } catch {\n          // ignore\n        }\n      }\n    } else if (typeof anySettings.getMotionGroupNames === 'function') {\n      try {\n        const names = anySettings.getMotionGroupNames();\n        if (Array.isArray(names)) {\n          for (const name of names) uniquePushAllowEmpty(groupNames, seen, name);\n        }\n      } catch {\n        // ignore\n      }\n    }\n  }\n\n  return groupNames;\n}\n\nexport function matchLive2DExpression(model: any, targetExpression: EmotionTag, override?: string): string | null {\n  const overrideName = String(override || '').trim();\n  if (overrideName) {\n    if (parseBuiltinExpressionToken(overrideName)) return null;\n    return overrideName;\n  }\n\n  const mapping = EXPRESSION_LIVE2D_MAP[targetExpression];\n  const candidates = mapping?.expressions || [String(targetExpression || '').toLowerCase()];\n\n  const definitions = collectExpressionNames(model);\n  if (!definitions.length) return null;\n\n  for (const candidateRaw of candidates) {\n    const candidate = String(candidateRaw || '').toLowerCase();\n    const exact = definitions.find((def) => String(def || '').toLowerCase() === candidate);\n    if (exact) return exact;\n  }\n\n  for (const candidateRaw of candidates) {\n    const candidate = String(candidateRaw || '').toLowerCase();\n    for (const def of definitions) {\n      const name = String(def || '').toLowerCase();\n      if (name.includes(candidate) || candidate.includes(name)) {\n        return def;\n      }\n    }\n  }\n\n  return null;\n}\n\nexport type Live2DMotionMatch = { group: string; index: number; name?: string };\n\nfunction normalizeMotionOverrideGroup(rawGroup: unknown): string {\n  const normalized = String(rawGroup ?? '').trim();\n  if (normalized === EMPTY_MOTION_GROUP_VALUE) return '';\n  return normalized;\n}\n\nexport function matchLive2DMotion(\n  model: any,\n  targetExpression: EmotionTag,\n  override?: EmotionMotionOverride,\n): Live2DMotionMatch | null {\n  if (override && override.enabled === false) return null;\n\n  const overrideGroupRaw = String(override?.group ?? '');\n  if (parseBuiltinMotionToken(overrideGroupRaw)) return null;\n  const hasEmptyGroupMarker = overrideGroupRaw.trim() === EMPTY_MOTION_GROUP_VALUE;\n  const overrideGroup = normalizeMotionOverrideGroup(override?.group);\n  const overrideIndexRaw = Number(override?.index);\n  const overrideIndex = Number.isFinite(overrideIndexRaw) ? Math.max(0, Math.floor(overrideIndexRaw)) : 0;\n  const hasExplicitOverride = hasEmptyGroupMarker || !!overrideGroup || overrideIndex > 0;\n  if (hasExplicitOverride) {\n    const entries = collectMotionEntries(model);\n    const groupNames = collectMotionGroupNames(model);\n    const lower = overrideGroup.toLowerCase();\n\n    const exactByGroupIndex = entries.find((e) => {\n      const groupLower = String(e.group || '').trim().toLowerCase();\n      return groupLower === lower && e.index === overrideIndex;\n    });\n    if (exactByGroupIndex) {\n      return { group: exactByGroupIndex.group, index: exactByGroupIndex.index, name: exactByGroupIndex.name };\n    }\n\n    const exactGroup = groupNames.find((name) => String(name || '').trim().toLowerCase() === lower);\n    if (exactGroup !== undefined) {\n      const exactInGroup = entries.find((e) => String(e.group || '').trim() === exactGroup && e.index === overrideIndex);\n      if (exactInGroup) {\n        return { group: exactInGroup.group, index: exactInGroup.index, name: exactInGroup.name };\n      }\n      const firstInGroup = entries.find((e) => String(e.group || '').trim() === exactGroup);\n      if (firstInGroup) {\n        return { group: firstInGroup.group, index: firstInGroup.index, name: firstInGroup.name };\n      }\n      return { group: exactGroup, index: overrideIndex };\n    }\n\n    if (lower) {\n      // group  motion name\n      const exactByName =\n        entries.find((e) => e.name.toLowerCase() === lower && e.index === overrideIndex) ||\n        entries.find((e) => e.name.toLowerCase() === lower);\n      if (exactByName) {\n        return { group: exactByName.group, index: exactByName.index, name: exactByName.name };\n      }\n\n      const fuzzyByName = entries.find((e) => {\n        const nameLower = e.name.toLowerCase();\n        return nameLower.includes(lower) || lower.includes(nameLower);\n      });\n      if (fuzzyByName) {\n        return { group: fuzzyByName.group, index: fuzzyByName.index, name: fuzzyByName.name };\n      }\n\n      const fuzzyGroup = groupNames.find((name) => {\n        const nameLower = String(name || '').trim().toLowerCase();\n        return !!nameLower && (nameLower.includes(lower) || lower.includes(nameLower));\n      });\n      if (fuzzyGroup !== undefined) {\n        const exactInGroup = entries.find(\n          (e) => String(e.group || '').trim() === fuzzyGroup && e.index === overrideIndex,\n        );\n        if (exactInGroup) {\n          return { group: exactInGroup.group, index: exactInGroup.index, name: exactInGroup.name };\n        }\n        const firstInGroup = entries.find((e) => String(e.group || '').trim() === fuzzyGroup);\n        if (firstInGroup) {\n          return { group: firstInGroup.group, index: firstInGroup.index, name: firstInGroup.name };\n        }\n        return { group: fuzzyGroup, index: overrideIndex };\n      }\n    }\n  }\n\n  const mapping = EXPRESSION_LIVE2D_MAP[targetExpression];\n  if (!mapping?.motions?.length) return null;\n\n  const groupNames = collectMotionGroupNames(model);\n  if (!groupNames.length) return null;\n\n  for (const candidateRaw of mapping.motions) {\n    const candidate = String(candidateRaw || '').trim().toLowerCase();\n    if (!candidate) continue;\n    const exact = groupNames.find((name) => String(name || '').trim().toLowerCase() === candidate);\n    if (exact) {\n      return { group: exact, index: 0 };\n    }\n  }\n\n  for (const candidateRaw of mapping.motions) {\n    const candidate = String(candidateRaw || '').toLowerCase();\n    if (!candidate) continue;\n    for (const groupName of groupNames) {\n      const nameLower = String(groupName || '').toLowerCase();\n      if (!nameLower) continue;\n      if (nameLower.includes(candidate) || candidate.includes(nameLower)) {\n        return { group: groupName, index: 0 };\n      }\n    }\n  }\n\n  const entries = collectMotionEntries(model);\n  if (!entries.length) return null;\n\n  for (const candidateRaw of mapping.motions) {\n    const candidate = String(candidateRaw || '').trim().toLowerCase();\n    if (!candidate) continue;\n    const exact = entries.find((e) => e.name.toLowerCase() === candidate);\n    if (exact) return { group: exact.group, index: exact.index, name: exact.name };\n  }\n\n  for (const candidateRaw of mapping.motions) {\n    const candidate = String(candidateRaw || '').trim().toLowerCase();\n    if (!candidate) continue;\n    const fuzzy = entries.find((e) => {\n      const nameLower = e.name.toLowerCase();\n      return nameLower.includes(candidate) || candidate.includes(nameLower);\n    });\n    if (fuzzy) return { group: fuzzy.group, index: fuzzy.index, name: fuzzy.name };\n  }\n\n  if (entries.length > 0) {\n    const first = entries[0];\n    return { group: first.group, index: first.index, name: first.name };\n  }\n\n  if (groupNames.length > 0) {\n    return { group: groupNames[0], index: 0 };\n  }\n\n  return null;\n}\n\nexport type Live2DExpressionResolveResult =\n  | { type: 'native'; name: string; source: 'override-native' | 'auto-native' }\n  | { type: 'builtin'; key: string; source: 'override-builtin' | 'auto-builtin' };\n\nexport type Live2DMotionResolveResult =\n  | { type: 'native'; group: string; index: number; name?: string; source: 'override-native' | 'auto-native' }\n  | { type: 'builtin'; key: string; source: 'override-builtin' | 'auto-builtin' }\n  | { type: 'disabled'; source: 'override-disabled' };\n\nexport function resolveLive2DExpression(\n  model: any,\n  targetExpression: EmotionTag,\n  override?: string,\n): Live2DExpressionResolveResult | null {\n  const overrideName = String(override || '').trim();\n  if (overrideName) {\n    const builtinKey = parseBuiltinExpressionToken(overrideName);\n    if (builtinKey) {\n      return { type: 'builtin', key: builtinKey, source: 'override-builtin' };\n    }\n    return { type: 'native', name: overrideName, source: 'override-native' };\n  }\n\n  const nativeName = matchLive2DExpression(model, targetExpression);\n  if (nativeName) {\n    return { type: 'native', name: nativeName, source: 'auto-native' };\n  }\n\n  const builtinDef = getBuiltinExpressionForTag(targetExpression);\n  if (builtinDef?.key) {\n    return { type: 'builtin', key: builtinDef.key, source: 'auto-builtin' };\n  }\n\n  return null;\n}\n\nexport function resolveLive2DMotion(\n  model: any,\n  targetExpression: EmotionTag,\n  override?: EmotionMotionOverride,\n): Live2DMotionResolveResult | null {\n  if (override && override.enabled === false) {\n    return { type: 'disabled', source: 'override-disabled' };\n  }\n\n  const overrideGroupRaw = String(override?.group ?? '');\n  const explicitBuiltin = parseBuiltinMotionToken(overrideGroupRaw);\n  if (explicitBuiltin) {\n    return { type: 'builtin', key: explicitBuiltin, source: 'override-builtin' };\n  }\n\n  const overrideIndexRaw = Number(override?.index);\n  const overrideIndex = Number.isFinite(overrideIndexRaw) ? Math.max(0, Math.floor(overrideIndexRaw)) : 0;\n  const hasExplicitOverride =\n    String(overrideGroupRaw).trim() === EMPTY_MOTION_GROUP_VALUE ||\n    !!normalizeMotionOverrideGroup(overrideGroupRaw) ||\n    overrideIndex > 0;\n\n  if (hasExplicitOverride) {\n    const matched = matchLive2DMotion(model, targetExpression, override);\n    if (matched) {\n      return {\n        type: 'native',\n        group: matched.group,\n        index: matched.index,\n        name: matched.name,\n        source: 'override-native',\n      };\n    }\n\n    return {\n      type: 'native',\n      group: normalizeMotionOverrideGroup(overrideGroupRaw),\n      index: overrideIndex,\n      source: 'override-native',\n    };\n  }\n\n  const nativeMotion = matchLive2DMotion(model, targetExpression);\n  if (nativeMotion) {\n    return {\n      type: 'native',\n      group: nativeMotion.group,\n      index: nativeMotion.index,\n      name: nativeMotion.name,\n      source: 'auto-native',\n    };\n  }\n\n  const builtinDef = getBuiltinMotionForTag(targetExpression);\n  if (builtinDef?.key) {\n    return { type: 'builtin', key: builtinDef.key, source: 'auto-builtin' };\n  }\n\n  return null;\n}\n","import {\r\n  EIKANYA_CDN_BASE,\r\n  EIKANYA_RAW_BASE,\r\n  LIVE2D_CDN_BASE,\r\n  LOCAL_LIVE2D_MODEL_PATH_PREFIX,\r\n  LOCAL_LIVE2D_MODEL_SLOT_ID,\r\n  type Live2DRuntimeType,\r\n} from '../core/constants';\r\nimport { useSettingsStore } from '../core/settings';\nimport { error, log, warn } from '../utils/dom';\nimport { getLive2DModel, type StoredLive2DModel } from '../db/live2d-models';\r\nimport { Live2DLoader } from './loader';\r\nimport { LIVE2D_RUNTIME_TYPES, resolveLive2DRuntime, withResolvedLive2DRuntime } from './runtime-router';\nimport { Live2DStage } from './stage';\nimport {\n  collectExpressionNames,\n  collectExpressionNamesFromUnknown,\n  collectMotionEntries,\n  collectMotionGroupCountsFromUnknown,\n  collectMotionGroupNames,\n  type Live2DMotionEntry,\n} from './expression-motion';\nimport { getBuiltinExpressionByKey, getBuiltinMotionByKey } from './builtin-expression-motion';\n\nconst TICKER_REGISTERED_FLAG = '__desktopPetLive2dTickerV1';\nconst TICKER_RUNTIME_REGISTRY_KEY = '__desktopPetLive2dTickerRuntimeRegistryV1';\n\nexport type ModelLoadProgress = {\n  percent: number;\n  message: string;\n};\n\ntype BuiltinMotionFrameState = {\n  params: Record<string, number>;\n  weight: number;\n};\n\ntype BuiltinMotionPlayerState = {\n  rafId: number;\n  stopped: boolean;\n  startedAt: number;\n  resetParams: Record<string, number> | null;\n  currentParams?: Record<string, number>;\n  weight: number;\n};\n\r\n/**\n * Live2D \n * /\n */\nexport const Live2DManager = {\n  _JSDELIVR_HOSTS: [\n    'cdn.jsdelivr.net',\n    'fastly.jsdelivr.net',\n    'testingcf.jsdelivr.net',\n    'gcore.jsdelivr.net',\n  ],\n  _runtime: null as any,\n  _runtimeType: LIVE2D_RUNTIME_TYPES.LEGACY as Live2DRuntimeType,\n  _runtimeInfo: withResolvedLive2DRuntime({}),\n  _localBlobUrls: [] as string[],\n  _xhrBlobUrlSupport: null as boolean | null,\n  _xhrBlobUrlSupportPromise: null as Promise<boolean> | null,\n  _hasLoggedBlobUrlDisabled: false,\n  model: null as any,\n  isReady: false,\n  modelBaseWidth: null as number | null,\n  modelBaseHeight: null as number | null,\n  modelBaseBounds: null as { x: number; y: number; width: number; height: number } | null,\n  _lastModelJson: null as any,\n  _lastModelJsonSourceUrl: '' as string,\n  _autoMotionTimer: null as number | null,\n  autoMotionLoopEnabled: true,\n  _mouthParamCore: null as any,\n  _mouthParamIds: [] as string[],\n  _mouthParamIndexes: [] as number[],\n  _mouthParamRangeMins: [] as number[],\r\n  _mouthParamRangeMaxs: [] as number[],\r\n  _mouthParamWarned: false,\r\n  _mouthCurrentValue: 0,\r\n  _lipSyncActive: false,\r\n  _inModelUpdate: false,\r\n  _writeMaskCore: null as any,\r\n  _writeMaskRestore: null as (() => void) | null,\r\n  _updateHookModel: null as any,\r\n  _updateHookRestore: null as (() => void) | null,\r\n  _manualMouthParamEnabled: false,\n  _manualMouthParamIds: [] as string[],\n  _manualMouthParamIdSet: new Set<string>(),\n  _builtinMotionPlayer: null as BuiltinMotionPlayerState | null,\n  _builtinMotionFrameState: null as BuiltinMotionFrameState | null,\n\r\n  /**  */\n  _top(): Window {\n    return window.parent ?? window;\n  },\n\n  /**  PIXI  */\r\n  _getPIXI(): any {\r\n    const runtimePixi = Live2DLoader.getPixi(this._top());\r\n    if (runtimePixi) return runtimePixi;\r\n    return this._runtime?.pixi ?? null;\r\n  },\r\n\r\n  _setRuntimeInfo(runtimeInfo: Record<string, any> | null): {\n    runtimeType: Live2DRuntimeType;\n    cubismVersion: number | null;\n    moc3Version?: number | null;\n  } {\n    const resolved = withResolvedLive2DRuntime(runtimeInfo || {});\n    this._runtimeInfo = resolved;\n    this._runtimeType = resolved.runtimeType;\n    return resolved;\n  },\n\n  _registerLocalBlobUrl(url: string): void {\n    const value = String(url || '').trim();\n    if (!value) return;\n    if (!this._localBlobUrls.includes(value)) {\n      this._localBlobUrls.push(value);\n    }\n  },\n\n  _revokeLocalBlobUrls(): void {\n    if (!Array.isArray(this._localBlobUrls) || this._localBlobUrls.length === 0) {\n      this._localBlobUrls = [];\n      return;\n    }\n\n    const top = this._top() as any;\n    const topURL = top?.URL || URL;\n    for (const url of this._localBlobUrls) {\n      try {\n        topURL.revokeObjectURL(url);\n      } catch {\n        // ignore\n      }\n    }\n    this._localBlobUrls = [];\n  },\n\n  _disableXhrBlobUrls(reason: string): void {\n    this._xhrBlobUrlSupport = false;\n    this._xhrBlobUrlSupportPromise = null;\n    if (!this._hasLoggedBlobUrlDisabled) {\n      this._hasLoggedBlobUrlDisabled = true;\n      warn(` Live2D XHR  blob URL Data URL${reason}`);\n    }\n  },\n\n  async _supportsXhrBlobUrls(): Promise<boolean> {\n    if (this._xhrBlobUrlSupport === true || this._xhrBlobUrlSupport === false) {\n      return this._xhrBlobUrlSupport;\n    }\n    if (this._xhrBlobUrlSupportPromise) {\n      return await this._xhrBlobUrlSupportPromise;\n    }\n\n    this._xhrBlobUrlSupportPromise = (async () => {\n      try {\n        const top = this._top() as any;\n        const topURL = top?.URL || URL;\n        const XHR = top?.XMLHttpRequest;\n        if (!topURL?.createObjectURL || !topURL?.revokeObjectURL || typeof XHR !== 'function') {\n          return false;\n        }\n\n        const payload = new Uint8Array([1, 2, 3, 4]);\n        const blob = new Blob([payload], { type: 'application/octet-stream' });\n        const blobUrl = topURL.createObjectURL(blob);\n\n        const ok = await new Promise<boolean>((resolve) => {\n          let done = false;\n          const finish = (value: boolean) => {\n            if (done) return;\n            done = true;\n            resolve(value);\n          };\n\n          try {\n            const xhr = new XHR();\n            xhr.open('GET', blobUrl, true);\n            xhr.responseType = 'arraybuffer';\n            xhr.timeout = 1500;\n            xhr.onload = () => {\n              const buf = xhr.response;\n              finish(!!buf && buf.byteLength === payload.byteLength);\n            };\n            xhr.onerror = () => finish(false);\n            xhr.onabort = () => finish(false);\n            xhr.ontimeout = () => finish(false);\n            xhr.send();\n          } catch {\n            finish(false);\n          }\n        });\n\n        try {\n          topURL.revokeObjectURL(blobUrl);\n        } catch {\n          // ignore\n        }\n        return ok;\n      } catch {\n        return false;\n      }\n    })().finally(() => {\n      this._xhrBlobUrlSupportPromise = null;\n    });\n\n    const supported = await this._xhrBlobUrlSupportPromise;\n    this._xhrBlobUrlSupport = supported;\n    if (!supported) {\n      this._disableXhrBlobUrls('xhr-probe-failed');\n    }\n    return supported;\n  },\n\n  _isLocalModelPath(path: string): boolean {\n    return String(path || '').trim().toLowerCase().startsWith(LOCAL_LIVE2D_MODEL_PATH_PREFIX.toLowerCase());\n  },\n\n  _normalizeLocalModelId(_path: string): string {\n    return LOCAL_LIVE2D_MODEL_SLOT_ID;\n  },\n\n  _toArrayBuffer(input: unknown): ArrayBuffer | null {\n    if (!input) return null;\n    if (input instanceof ArrayBuffer) return input;\n    if (ArrayBuffer.isView(input)) {\n      return input.buffer.slice(input.byteOffset, input.byteOffset + input.byteLength) as ArrayBuffer;\n    }\n    return null;\n  },\n\n  _normalizeMocVersion(rawMocVersion: unknown): number | null {\n    const value = Number(rawMocVersion || 0);\n    if (!Number.isFinite(value)) return null;\n    if (value >= 5) return 5;\n    if (value >= 1 && value <= 4) return 4;\n    return null;\n  },\n\n  _readMoc3HeaderVersion(moc3Data: unknown): number | null {\n    const moc3Buffer = this._toArrayBuffer(moc3Data);\n    if (!moc3Buffer || moc3Buffer.byteLength < 8) return null;\n\n    try {\n      const header = new Uint8Array(moc3Buffer, 0, 4);\n      const signature = String.fromCharCode(...header);\n      if (signature !== 'MOC3') return null;\n      const view = new DataView(moc3Buffer);\n      return Number(view.getUint32(4, true) || 0) || null;\n    } catch {\n      return null;\n    }\n  },\n\n  _detectCubismVersionFromMoc3Buffer(moc3Data: unknown): number | null {\n    const moc3Buffer = this._toArrayBuffer(moc3Data);\n    if (!moc3Buffer) return null;\n\n    const top = this._top() as any;\n    const core = top?.Live2DCubismCore;\n    const Moc = core?.Moc;\n    const Version = core?.Version;\n    if (typeof Moc?.fromArrayBuffer !== 'function' || typeof Version?.csmGetMocVersion !== 'function') {\n      return null;\n    }\n\n    let mocRef: any = null;\n    try {\n      mocRef = Moc.fromArrayBuffer(moc3Buffer);\n      if (!mocRef) return null;\n\n      const rawMocVersion = Number(Version.csmGetMocVersion(mocRef, moc3Buffer) || 0) || 0;\n      const latestMocVersion = Number(Version?.csmGetLatestMocVersion?.() || 0) || 0;\n      const normalized = this._normalizeMocVersion(rawMocVersion);\n      if (latestMocVersion > 0 && rawMocVersion > latestMocVersion) {\n        return null;\n      }\n      return normalized;\n    } catch {\n      return null;\n    } finally {\n      try {\n        if (mocRef && typeof mocRef._release === 'function') {\n          mocRef._release();\n        } else if (mocRef && typeof mocRef.release === 'function') {\n          mocRef.release();\n        }\n      } catch {\n        // ignore\n      }\n    }\n  },\n\n  async _detectRuntimeFromMoc3(\n    moc3Data: unknown,\n    runtimeInfo: Record<string, any> | null = null,\n  ): Promise<{\n    runtimeType: Live2DRuntimeType;\n    cubismVersion: number | null;\n    moc3Version?: number | null;\n  }> {\n    const resolvedRuntime = resolveLive2DRuntime(runtimeInfo || this._runtimeInfo || null);\n    const moc3Buffer = this._toArrayBuffer(moc3Data);\n    if (!moc3Buffer) {\n      return this._setRuntimeInfo(resolvedRuntime);\n    }\n\n    const headerVersionRaw = this._readMoc3HeaderVersion(moc3Buffer);\n    const headerVersion = this._normalizeMocVersion(headerVersionRaw);\n    const runtimeWithHeader = {\n      ...resolvedRuntime,\n      moc3Version: headerVersionRaw ?? null,\n    };\n\n    try {\n      const requiredLatestVersion = headerVersionRaw && headerVersionRaw >= 5 ? headerVersionRaw : 5;\n      await Live2DLoader.ensureCubism5Core(requiredLatestVersion);\n    } catch {\n      // ignore\n    }\n\n    const mocVersion = this._detectCubismVersionFromMoc3Buffer(moc3Buffer);\n    const resolvedVersion = mocVersion ?? headerVersion ?? runtimeWithHeader.cubismVersion ?? null;\n    return this._setRuntimeInfo({\n      ...runtimeWithHeader,\n      cubismVersion: resolvedVersion,\n    });\n  },\n\n  _isCoreParseError(err: unknown): boolean {\n    const message = String((err as any)?.message || err || '');\n    const stack = String((err as any)?.stack || '');\n    return /unknown error/i.test(message) || /createcoremodel/i.test(stack) || /be\\.create/i.test(stack);\n  },\n\n  async _ensureRuntimeDependencies(\n    runtimeInfo: Record<string, any> | null,\n    contextLabel: string,\n  ): Promise<{\n    runtimeType: Live2DRuntimeType;\n    cubismVersion: number | null;\n    moc3Version?: number | null;\n  }> {\n    const resolvedRuntime = this._setRuntimeInfo(runtimeInfo || null);\n    const requiredMocVersion = Number((resolvedRuntime as any)?.moc3Version || 0) || 0;\n    const requiredLatestVersion = requiredMocVersion >= 5 ? requiredMocVersion : 5;\n\n    if (resolvedRuntime.runtimeType === LIVE2D_RUNTIME_TYPES.CUBISM5) {\n      const coreLoaded = await Live2DLoader.ensureCubism5Core(requiredLatestVersion);\n      if (!coreLoaded) {\n        throw new Error(`Cubism5 Core ${contextLabel}`);\n      }\n      const runtimeLoaded = await Live2DLoader.ensureCubism5Runtime();\n      if (!runtimeLoaded) {\n        throw new Error(`Cubism5 runtime ${contextLabel}`);\n      }\n      Live2DLoader.activateRuntime(LIVE2D_RUNTIME_TYPES.CUBISM5);\n      this._setRuntimeInfo(resolvedRuntime);\n      return resolvedRuntime;\n    }\n\n    if (requiredMocVersion >= 5) {\n      const coreLoaded = await Live2DLoader.ensureCubism5Core(requiredLatestVersion);\n      if (!coreLoaded) {\n        throw new Error(`Cubism5 Core legacy+core5${contextLabel}`);\n      }\n      Live2DLoader.activateRuntime(LIVE2D_RUNTIME_TYPES.LEGACY);\n      const patched = this._setRuntimeInfo({\n        ...resolvedRuntime,\n        runtimeType: LIVE2D_RUNTIME_TYPES.LEGACY,\n        cubismVersion: resolvedRuntime.cubismVersion ?? 5,\n      });\n      log('legacy runtime + Cubism5 core ', {\n        context: contextLabel,\n        runtimeType: patched.runtimeType,\n        cubismVersion: patched.cubismVersion,\n        moc3Version: (patched as any).moc3Version ?? null,\n      });\n      return patched;\n    }\n\n    const legacyLoaded = await Live2DLoader.ensureLegacyCore();\n    if (!legacyLoaded) {\n      const top = this._top() as any;\n      const latestMocVersion = Number(top?.Live2DCubismCore?.Version?.csmGetLatestMocVersion?.() || 0) || 0;\n      if (latestMocVersion >= 5) {\n        const fallbackRuntime = this._setRuntimeInfo({\n          ...resolvedRuntime,\n          runtimeType: LIVE2D_RUNTIME_TYPES.CUBISM5,\n          cubismVersion: 5,\n        });\n        const coreLoaded = await Live2DLoader.ensureCubism5Core(requiredLatestVersion);\n        if (!coreLoaded) {\n          throw new Error(`Cubism5 Core ${contextLabel}`);\n        }\n        const runtimeLoaded = await Live2DLoader.ensureCubism5Runtime();\n        if (!runtimeLoaded) {\n          throw new Error(`Cubism5 runtime ${contextLabel}`);\n        }\n        Live2DLoader.activateRuntime(LIVE2D_RUNTIME_TYPES.CUBISM5);\n        return fallbackRuntime;\n      }\n      throw new Error(`legacy Core ${contextLabel}`);\n    }\n\n    Live2DLoader.activateRuntime(LIVE2D_RUNTIME_TYPES.LEGACY);\n    this._setRuntimeInfo(resolvedRuntime);\n    return resolvedRuntime;\n  },\n\n  _getLive2DModelClass(runtimeType: Live2DRuntimeType): any {\n    const top = this._top() as any;\n    const namespace = Live2DLoader.getRuntimeNamespace(runtimeType) || top?.PIXI?.live2d;\n    return namespace?.Live2DModel || null;\n  },\n\n  _getTickerRuntimeRegistry(): Record<string, boolean> {\n    const top = this._top() as any;\n    const raw = top?.[TICKER_RUNTIME_REGISTRY_KEY];\n    if (raw && typeof raw === 'object') return raw as Record<string, boolean>;\n\n    const registry: Record<string, boolean> = {};\n    try {\n      top[TICKER_RUNTIME_REGISTRY_KEY] = registry;\n    } catch {\n      // ignore\n    }\n    return registry;\n  },\n\n  _registerTickerForRuntime(Live2DModel: any, PIXI: any): void {\n    if (!Live2DModel || !PIXI || typeof Live2DModel.registerTicker !== 'function') {\n      return;\n    }\n    const runtimeType = this._runtimeType || LIVE2D_RUNTIME_TYPES.LEGACY;\n    const registry = this._getTickerRuntimeRegistry();\n    if (registry[runtimeType] === true) {\n      log(`Live2D ticker  runtime(${runtimeType}) `);\n      return;\n    }\n    const lastRegisteredTicker = (Live2DModel as any)[TICKER_REGISTERED_FLAG] as unknown;\n    if (lastRegisteredTicker !== PIXI.Ticker) {\n      Live2DModel.registerTicker(PIXI.Ticker);\n      (Live2DModel as any)[TICKER_REGISTERED_FLAG] = PIXI.Ticker;\n      log('Live2D ticker ');\n    } else {\n      log('Live2D ticker ');\n    }\n    registry[runtimeType] = true;\n  },\n\n  _blobToDataUrl(blob: Blob): Promise<string> {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = () => resolve(String(reader.result || ''));\n      reader.onerror = () => reject(reader.error || new Error('Blob  DataURL '));\n      reader.readAsDataURL(blob);\n    });\n  },\n\n  _normalizeStoredPath(path: unknown): string {\n    return String(path || '')\n      .replace(/\\\\/g, '/')\n      .trim();\n  },\n\n  _getPathBaseName(path: unknown): string {\n    const normalized = this._normalizeStoredPath(path);\n    const lastSlash = normalized.lastIndexOf('/');\n    return lastSlash >= 0 ? normalized.slice(lastSlash + 1) : normalized;\n  },\n\n  _guessMimeTypeByPath(path: unknown, fallback = 'application/octet-stream'): string {\n    const lower = this._normalizeStoredPath(path).toLowerCase();\n    if (lower.endsWith('.png')) return 'image/png';\n    if (lower.endsWith('.webp')) return 'image/webp';\n    if (lower.endsWith('.jpg') || lower.endsWith('.jpeg')) return 'image/jpeg';\n    if (lower.endsWith('.json') || lower.endsWith('.model3.json') || lower.endsWith('.model.json')) {\n      return 'application/json';\n    }\n    if (lower.endsWith('.moc') || lower.endsWith('.moc3')) return 'application/octet-stream';\n    return fallback;\n  },\n\n  _findStoredTextureBlob(modelData: StoredLive2DModel, targetPath: unknown, index = -1): Blob | null {\n    const textures = Array.isArray(modelData?.textures) ? modelData.textures : [];\n    if (!textures.length) return null;\n\n    const normalizedTarget = this._normalizeStoredPath(targetPath);\n    const targetBaseName = this._getPathBaseName(normalizedTarget);\n\n    const exact = textures.find((item) => this._normalizeStoredPath(item?.name) === normalizedTarget);\n    if (exact?.data instanceof Blob) return exact.data;\n\n    const byBase = textures.find((item) => this._getPathBaseName(item?.name) === targetBaseName);\n    if (byBase?.data instanceof Blob) return byBase.data;\n\n    const indexed = index >= 0 ? textures[index] : null;\n    if (indexed?.data instanceof Blob) return indexed.data;\n\n    return null;\n  },\n\n  _findStoredMotionData(\n    modelData: StoredLive2DModel,\n    groupName: string,\n    targetPath: unknown,\n    index = -1,\n  ): ArrayBuffer | null {\n    const motions = modelData?.motions && typeof modelData.motions === 'object' ? modelData.motions : {};\n    const targetNormalized = this._normalizeStoredPath(targetPath);\n    const targetBaseName = this._getPathBaseName(targetNormalized);\n    const targetGroup = String(groupName || '');\n\n    const groupList = Array.isArray((motions as any)?.[targetGroup]) ? (motions as any)[targetGroup] : [];\n    const exact = groupList.find((item: any) => this._normalizeStoredPath(item?.name) === targetNormalized);\n    if (exact?.data instanceof ArrayBuffer) return exact.data;\n\n    const byBase = groupList.find((item: any) => this._getPathBaseName(item?.name) === targetBaseName);\n    if (byBase?.data instanceof ArrayBuffer) return byBase.data;\n\n    const indexed = index >= 0 ? groupList[index] : null;\n    if (indexed?.data instanceof ArrayBuffer) return indexed.data;\n\n    for (const value of Object.values(motions)) {\n      const list = Array.isArray(value) ? value : [];\n      const crossExact = list.find((item: any) => this._normalizeStoredPath(item?.name) === targetNormalized);\n      if (crossExact?.data instanceof ArrayBuffer) return crossExact.data;\n      const crossByBase = list.find((item: any) => this._getPathBaseName(item?.name) === targetBaseName);\n      if (crossByBase?.data instanceof ArrayBuffer) return crossByBase.data;\n    }\n\n    return null;\n  },\n\n  _findStoredExpressionData(modelData: StoredLive2DModel, targetPath: unknown, index = -1): ArrayBuffer | null {\n    const expressions = Array.isArray(modelData?.expressions) ? modelData.expressions : [];\n    if (!expressions.length) return null;\n\n    const targetNormalized = this._normalizeStoredPath(targetPath);\n    const targetBaseName = this._getPathBaseName(targetNormalized);\n\n    const exact = expressions.find((item) => this._normalizeStoredPath(item?.file || item?.name) === targetNormalized);\n    if (exact?.data instanceof ArrayBuffer) return exact.data;\n\n    const byBase = expressions.find((item) => this._getPathBaseName(item?.file || item?.name) === targetBaseName);\n    if (byBase?.data instanceof ArrayBuffer) return byBase.data;\n\n    const indexed = index >= 0 ? expressions[index] : null;\n    if (indexed?.data instanceof ArrayBuffer) return indexed.data;\n\n    return null;\n  },\n\n  _toLocalBlobUrl(payload: Blob | ArrayBuffer, mimeType = 'application/octet-stream'): string {\n    const top = this._top() as any;\n    const topURL = top?.URL || URL;\n    const blob = payload instanceof Blob ? payload : new Blob([payload], { type: mimeType });\n    const url = topURL.createObjectURL(blob);\n    this._registerLocalBlobUrl(url);\n    return url;\n  },\n\n  async _toLocalDataUrl(payload: Blob | ArrayBuffer, mimeType = 'application/octet-stream'): Promise<string> {\n    const blob = payload instanceof Blob ? payload : new Blob([payload], { type: mimeType });\n    return await this._blobToDataUrl(blob);\n  },\n\n  async _buildLocalModelBlobUrl(modelData: StoredLive2DModel): Promise<string> {\n    const modifiedModelJson = JSON.parse(JSON.stringify(modelData?.modelJson || {}));\n    this._normalizeLegacyCubism2Settings(modifiedModelJson);\n\n    const mapFile = (\n      payload: Blob | ArrayBuffer | null,\n      pathHint: unknown,\n      fallbackMime = 'application/octet-stream',\n    ): string | null => {\n      if (!payload) return null;\n      const mimeType =\n        payload instanceof Blob ? payload.type || this._guessMimeTypeByPath(pathHint, fallbackMime) : this._guessMimeTypeByPath(pathHint, fallbackMime);\n      return this._toLocalBlobUrl(payload, mimeType || fallbackMime);\n    };\n\n    const isModel3 = !!modifiedModelJson?.FileReferences;\n    if (isModel3) {\n      const refs = modifiedModelJson.FileReferences;\n      if (refs && typeof refs === 'object') {\n        const mocUrl = mapFile(modelData?.moc3 ?? null, refs.Moc, 'application/octet-stream');\n        if (mocUrl) refs.Moc = mocUrl;\n\n        if (Array.isArray(refs.Textures)) {\n          refs.Textures = refs.Textures.map((texPath: unknown, index: number) => {\n            const textureBlob = this._findStoredTextureBlob(modelData, texPath, index);\n            return mapFile(textureBlob, texPath, 'image/png') || texPath;\n          });\n        }\n\n        const physicsUrl = mapFile(modelData?.physics ?? null, refs.Physics, 'application/json');\n        if (physicsUrl && typeof refs.Physics === 'string') refs.Physics = physicsUrl;\n        const poseUrl = mapFile(modelData?.pose ?? null, refs.Pose, 'application/json');\n        if (poseUrl && typeof refs.Pose === 'string') refs.Pose = poseUrl;\n\n        if (!refs.Motions || typeof refs.Motions !== 'object') {\n          refs.Motions = {};\n        }\n        if (modelData?.motions && typeof modelData.motions === 'object') {\n          for (const [groupName, motionListRaw] of Object.entries(modelData.motions)) {\n            const motionList = Array.isArray(motionListRaw) ? motionListRaw : [];\n            if (!Array.isArray((refs as any).Motions[groupName])) {\n              (refs as any).Motions[groupName] = [];\n            }\n            const targetList = (refs as any).Motions[groupName] as any[];\n\n            for (let index = 0; index < motionList.length; index++) {\n              const storedMotion = motionList[index];\n              const existingDef = targetList[index];\n              const motionPath =\n                (existingDef && typeof existingDef === 'object'\n                  ? (existingDef as any).File || (existingDef as any).file\n                  : existingDef) ||\n                storedMotion?.name;\n              const motionData =\n                this._findStoredMotionData(modelData, groupName, motionPath, index) ?? storedMotion?.data ?? null;\n              const motionUrl = mapFile(motionData, motionPath || storedMotion?.name, 'application/json');\n              if (!motionUrl) continue;\n\n              if (existingDef && typeof existingDef === 'object') {\n                if (typeof (existingDef as any).File === 'string') (existingDef as any).File = motionUrl;\n                else (existingDef as any).file = motionUrl;\n                const existingName = String((existingDef as any).Name || (existingDef as any).name || '').trim();\n                if (!existingName) {\n                  (existingDef as any).Name = this._getPathBaseName(motionPath || storedMotion?.name);\n                }\n              } else if (typeof existingDef === 'string') {\n                targetList[index] = motionUrl;\n              } else {\n                targetList.push({\n                  Name: this._getPathBaseName(storedMotion?.name || motionPath || `motion_${index + 1}`),\n                  File: motionUrl,\n                });\n              }\n            }\n          }\n        }\n\n        if (!Array.isArray(refs.Expressions)) {\n          refs.Expressions = [];\n        }\n        if (Array.isArray(modelData?.expressions)) {\n          for (let index = 0; index < modelData.expressions.length; index++) {\n            const storedExpr = modelData.expressions[index];\n            const existingDef = refs.Expressions[index];\n            const exprPath =\n              (existingDef && typeof existingDef === 'object'\n                ? (existingDef as any).File || (existingDef as any).file\n                : existingDef) ||\n              storedExpr?.file ||\n              storedExpr?.name;\n            const exprData =\n              this._findStoredExpressionData(modelData, exprPath, index) ?? storedExpr?.data ?? null;\n            const exprUrl = mapFile(exprData, exprPath || storedExpr?.name, 'application/json');\n            if (!exprUrl) continue;\n\n            if (existingDef && typeof existingDef === 'object') {\n              if (typeof (existingDef as any).File === 'string') (existingDef as any).File = exprUrl;\n              else (existingDef as any).file = exprUrl;\n              const existingName = String((existingDef as any).Name || (existingDef as any).name || '').trim();\n              if (!existingName) {\n                (existingDef as any).Name = this._getPathBaseName(storedExpr?.name || exprPath);\n              }\n            } else if (typeof existingDef === 'string') {\n              refs.Expressions[index] = exprUrl;\n            } else {\n              refs.Expressions.push({\n                Name: this._getPathBaseName(storedExpr?.name || exprPath || `expression_${index + 1}`),\n                File: exprUrl,\n              });\n            }\n          }\n        }\n      }\n    } else {\n      const mocPath = modifiedModelJson.model || modifiedModelJson.Model;\n      const mocUrl = mapFile(modelData?.moc ?? null, mocPath, 'application/octet-stream');\n      if (mocUrl) {\n        if (typeof modifiedModelJson.model === 'string') modifiedModelJson.model = mocUrl;\n        else if (typeof modifiedModelJson.Model === 'string') modifiedModelJson.Model = mocUrl;\n        else modifiedModelJson.model = mocUrl;\n      }\n\n      const textureList = modifiedModelJson.textures || modifiedModelJson.Textures;\n      if (Array.isArray(textureList)) {\n        for (let index = 0; index < textureList.length; index++) {\n          const texturePath = textureList[index];\n          const textureBlob = this._findStoredTextureBlob(modelData, texturePath, index);\n          const textureUrl = mapFile(textureBlob, texturePath, 'image/png');\n          if (textureUrl) textureList[index] = textureUrl;\n        }\n      }\n\n      const physicsPath = modifiedModelJson.physics || modifiedModelJson.Physics;\n      const physicsUrl = mapFile(modelData?.physics ?? null, physicsPath, 'application/json');\n      if (physicsUrl) {\n        if (typeof modifiedModelJson.physics === 'string') modifiedModelJson.physics = physicsUrl;\n        if (typeof modifiedModelJson.Physics === 'string') modifiedModelJson.Physics = physicsUrl;\n      }\n\n      const posePath = modifiedModelJson.pose || modifiedModelJson.Pose;\n      const poseUrl = mapFile(modelData?.pose ?? null, posePath, 'application/json');\n      if (poseUrl) {\n        if (typeof modifiedModelJson.pose === 'string') modifiedModelJson.pose = poseUrl;\n        if (typeof modifiedModelJson.Pose === 'string') modifiedModelJson.Pose = poseUrl;\n      }\n\n      const motions = modifiedModelJson.motions || modifiedModelJson.Motions;\n      if (motions && typeof motions === 'object') {\n        for (const groupName of Object.keys(motions)) {\n          const motionList = motions[groupName];\n          if (!Array.isArray(motionList)) continue;\n          for (let index = 0; index < motionList.length; index++) {\n            const motionDef = motionList[index];\n            const motionPath =\n              typeof motionDef === 'string' ? motionDef : (motionDef as any)?.file || (motionDef as any)?.File;\n            const motionData = this._findStoredMotionData(modelData, groupName, motionPath, index);\n            const motionUrl = mapFile(motionData, motionPath, 'application/octet-stream');\n            if (!motionUrl) continue;\n\n            if (typeof motionDef === 'string') {\n              motionList[index] = motionUrl;\n            } else if (typeof (motionDef as any).file === 'string') {\n              (motionDef as any).file = motionUrl;\n            } else {\n              (motionDef as any).File = motionUrl;\n            }\n          }\n        }\n      }\n\n      const expressions = modifiedModelJson.expressions || modifiedModelJson.Expressions;\n      if (Array.isArray(expressions)) {\n        for (let index = 0; index < expressions.length; index++) {\n          const exprDef = expressions[index];\n          const exprPath = typeof exprDef === 'string' ? exprDef : (exprDef as any)?.file || (exprDef as any)?.File;\n          const exprData = this._findStoredExpressionData(modelData, exprPath, index);\n          const exprUrl = mapFile(exprData, exprPath, 'application/json');\n          if (!exprUrl) continue;\n\n          if (typeof exprDef === 'string') {\n            expressions[index] = exprUrl;\n          } else if (typeof (exprDef as any).file === 'string') {\n            (exprDef as any).file = exprUrl;\n          } else {\n            (exprDef as any).File = exprUrl;\n          }\n        }\n      }\n    }\n\n    this._lastModelJson = JSON.parse(JSON.stringify(modifiedModelJson));\n\n    const modelBlob = new Blob([JSON.stringify(modifiedModelJson)], { type: 'application/json' });\n    return this._toLocalBlobUrl(modelBlob, 'application/json');\n  },\n\n  async _buildLocalModelDataUrl(modelData: StoredLive2DModel): Promise<string> {\n    const modifiedModelJson = JSON.parse(JSON.stringify(modelData?.modelJson || {}));\n    this._normalizeLegacyCubism2Settings(modifiedModelJson);\n\n    const mapFile = async (\n      payload: Blob | ArrayBuffer | null,\n      pathHint: unknown,\n      fallbackMime = 'application/octet-stream',\n    ): Promise<string | null> => {\n      if (!payload) return null;\n      const mimeType =\n        payload instanceof Blob ? payload.type || this._guessMimeTypeByPath(pathHint, fallbackMime) : this._guessMimeTypeByPath(pathHint, fallbackMime);\n      return await this._toLocalDataUrl(payload, mimeType || fallbackMime);\n    };\n\n    const isModel3 = !!modifiedModelJson?.FileReferences;\n    if (isModel3) {\n      const refs = modifiedModelJson.FileReferences;\n      if (refs && typeof refs === 'object') {\n        const mocUrl = await mapFile(modelData?.moc3 ?? null, refs.Moc, 'application/octet-stream');\n        if (mocUrl) refs.Moc = mocUrl;\n\n        if (Array.isArray(refs.Textures)) {\n          for (let index = 0; index < refs.Textures.length; index++) {\n            const texturePath = refs.Textures[index];\n            const textureBlob = this._findStoredTextureBlob(modelData, texturePath, index);\n            const textureUrl = await mapFile(textureBlob, texturePath, 'image/png');\n            if (textureUrl) refs.Textures[index] = textureUrl;\n          }\n        }\n\n        const physicsUrl = await mapFile(modelData?.physics ?? null, refs.Physics, 'application/json');\n        if (physicsUrl && typeof refs.Physics === 'string') refs.Physics = physicsUrl;\n        const poseUrl = await mapFile(modelData?.pose ?? null, refs.Pose, 'application/json');\n        if (poseUrl && typeof refs.Pose === 'string') refs.Pose = poseUrl;\n\n        if (!refs.Motions || typeof refs.Motions !== 'object') {\n          refs.Motions = {};\n        }\n        if (modelData?.motions && typeof modelData.motions === 'object') {\n          for (const [groupName, motionListRaw] of Object.entries(modelData.motions)) {\n            const motionList = Array.isArray(motionListRaw) ? motionListRaw : [];\n            if (!Array.isArray((refs as any).Motions[groupName])) {\n              (refs as any).Motions[groupName] = [];\n            }\n            const targetList = (refs as any).Motions[groupName] as any[];\n\n            for (let index = 0; index < motionList.length; index++) {\n              const storedMotion = motionList[index];\n              const existingDef = targetList[index];\n              const motionPath =\n                (existingDef && typeof existingDef === 'object'\n                  ? (existingDef as any).File || (existingDef as any).file\n                  : existingDef) ||\n                storedMotion?.name;\n              const motionData =\n                this._findStoredMotionData(modelData, groupName, motionPath, index) ?? storedMotion?.data ?? null;\n              const motionUrl = await mapFile(motionData, motionPath || storedMotion?.name, 'application/json');\n              if (!motionUrl) continue;\n\n              if (existingDef && typeof existingDef === 'object') {\n                if (typeof (existingDef as any).File === 'string') (existingDef as any).File = motionUrl;\n                else (existingDef as any).file = motionUrl;\n                const existingName = String((existingDef as any).Name || (existingDef as any).name || '').trim();\n                if (!existingName) {\n                  (existingDef as any).Name = this._getPathBaseName(motionPath || storedMotion?.name);\n                }\n              } else if (typeof existingDef === 'string') {\n                targetList[index] = motionUrl;\n              } else {\n                targetList.push({\n                  Name: this._getPathBaseName(storedMotion?.name || motionPath || `motion_${index + 1}`),\n                  File: motionUrl,\n                });\n              }\n            }\n          }\n        }\n\n        if (!Array.isArray(refs.Expressions)) {\n          refs.Expressions = [];\n        }\n        if (Array.isArray(modelData?.expressions)) {\n          for (let index = 0; index < modelData.expressions.length; index++) {\n            const storedExpr = modelData.expressions[index];\n            const existingDef = refs.Expressions[index];\n            const exprPath =\n              (existingDef && typeof existingDef === 'object'\n                ? (existingDef as any).File || (existingDef as any).file\n                : existingDef) ||\n              storedExpr?.file ||\n              storedExpr?.name;\n            const exprData =\n              this._findStoredExpressionData(modelData, exprPath, index) ?? storedExpr?.data ?? null;\n            const exprUrl = await mapFile(exprData, exprPath || storedExpr?.name, 'application/json');\n            if (!exprUrl) continue;\n\n            if (existingDef && typeof existingDef === 'object') {\n              if (typeof (existingDef as any).File === 'string') (existingDef as any).File = exprUrl;\n              else (existingDef as any).file = exprUrl;\n              const existingName = String((existingDef as any).Name || (existingDef as any).name || '').trim();\n              if (!existingName) {\n                (existingDef as any).Name = this._getPathBaseName(storedExpr?.name || exprPath);\n              }\n            } else if (typeof existingDef === 'string') {\n              refs.Expressions[index] = exprUrl;\n            } else {\n              refs.Expressions.push({\n                Name: this._getPathBaseName(storedExpr?.name || exprPath || `expression_${index + 1}`),\n                File: exprUrl,\n              });\n            }\n          }\n        }\n      }\n    } else {\n      const mocPath = modifiedModelJson.model || modifiedModelJson.Model;\n      const mocUrl = await mapFile(modelData?.moc ?? null, mocPath, 'application/octet-stream');\n      if (mocUrl) {\n        if (typeof modifiedModelJson.model === 'string') modifiedModelJson.model = mocUrl;\n        else if (typeof modifiedModelJson.Model === 'string') modifiedModelJson.Model = mocUrl;\n        else modifiedModelJson.model = mocUrl;\n      }\n\n      const textureList = modifiedModelJson.textures || modifiedModelJson.Textures;\n      if (Array.isArray(textureList)) {\n        for (let index = 0; index < textureList.length; index++) {\n          const texturePath = textureList[index];\n          const textureBlob = this._findStoredTextureBlob(modelData, texturePath, index);\n          const textureUrl = await mapFile(textureBlob, texturePath, 'image/png');\n          if (textureUrl) textureList[index] = textureUrl;\n        }\n      }\n\n      const physicsPath = modifiedModelJson.physics || modifiedModelJson.Physics;\n      const physicsUrl = await mapFile(modelData?.physics ?? null, physicsPath, 'application/json');\n      if (physicsUrl) {\n        if (typeof modifiedModelJson.physics === 'string') modifiedModelJson.physics = physicsUrl;\n        if (typeof modifiedModelJson.Physics === 'string') modifiedModelJson.Physics = physicsUrl;\n      }\n\n      const posePath = modifiedModelJson.pose || modifiedModelJson.Pose;\n      const poseUrl = await mapFile(modelData?.pose ?? null, posePath, 'application/json');\n      if (poseUrl) {\n        if (typeof modifiedModelJson.pose === 'string') modifiedModelJson.pose = poseUrl;\n        if (typeof modifiedModelJson.Pose === 'string') modifiedModelJson.Pose = poseUrl;\n      }\n\n      const motions = modifiedModelJson.motions || modifiedModelJson.Motions;\n      if (motions && typeof motions === 'object') {\n        for (const groupName of Object.keys(motions)) {\n          const motionList = motions[groupName];\n          if (!Array.isArray(motionList)) continue;\n          for (let index = 0; index < motionList.length; index++) {\n            const motionDef = motionList[index];\n            const motionPath =\n              typeof motionDef === 'string' ? motionDef : (motionDef as any)?.file || (motionDef as any)?.File;\n            const motionData = this._findStoredMotionData(modelData, groupName, motionPath, index);\n            const motionUrl = await mapFile(motionData, motionPath, 'application/octet-stream');\n            if (!motionUrl) continue;\n\n            if (typeof motionDef === 'string') {\n              motionList[index] = motionUrl;\n            } else if (typeof (motionDef as any).file === 'string') {\n              (motionDef as any).file = motionUrl;\n            } else {\n              (motionDef as any).File = motionUrl;\n            }\n          }\n        }\n      }\n\n      const expressions = modifiedModelJson.expressions || modifiedModelJson.Expressions;\n      if (Array.isArray(expressions)) {\n        for (let index = 0; index < expressions.length; index++) {\n          const exprDef = expressions[index];\n          const exprPath = typeof exprDef === 'string' ? exprDef : (exprDef as any)?.file || (exprDef as any)?.File;\n          const exprData = this._findStoredExpressionData(modelData, exprPath, index);\n          const exprUrl = await mapFile(exprData, exprPath, 'application/json');\n          if (!exprUrl) continue;\n\n          if (typeof exprDef === 'string') {\n            expressions[index] = exprUrl;\n          } else if (typeof (exprDef as any).file === 'string') {\n            (exprDef as any).file = exprUrl;\n          } else {\n            (exprDef as any).File = exprUrl;\n          }\n        }\n      }\n    }\n\n    this._lastModelJson = JSON.parse(JSON.stringify(modifiedModelJson));\n\n    const modelBlob = new Blob([JSON.stringify(modifiedModelJson)], { type: 'application/json' });\n    return await this._blobToDataUrl(modelBlob);\n  },\n\n  _encodePathSegment(segment: string): string {\n    if (typeof segment !== 'string' || !segment) return segment;\n\r\n    let decoded = segment;\r\n    try {\r\n      decoded = decodeURIComponent(segment);\r\n    } catch {\r\n      return segment;\r\n    }\r\n\r\n    const safeChar = /[A-Za-z0-9\\-._~!$&'()*+,;=:@]/;\r\n    let encoded = '';\r\n    for (const ch of decoded) {\r\n      encoded += safeChar.test(ch) ? ch : encodeURIComponent(ch);\r\n    }\r\n    return encoded;\r\n  },\r\n\r\n  _normalizeRemoteUrl(inputUrl: string): string {\r\n    const url = String(inputUrl || '').trim();\r\n    if (!url) return url;\r\n\r\n    try {\r\n      const urlObj = new URL(url);\r\n      urlObj.pathname = urlObj.pathname\r\n        .split('/')\r\n        .map(segment => this._encodePathSegment(segment))\r\n        .join('/');\r\n      return urlObj.toString();\r\n    } catch {\r\n      return url;\r\n    }\r\n  },\r\n\r\n  _normalizeResourceRef(inputRef: string): string {\r\n    const raw = String(inputRef || '').trim();\r\n    if (!raw) return raw;\r\n\r\n    //  #  %23 URL \r\n    const hashSafe = raw.replace(/#/g, '%23');\r\n    const normalized = hashSafe.replace(/\\\\/g, '/');\r\n\r\n    const qIndex = normalized.indexOf('?');\r\n    const pathPart = qIndex >= 0 ? normalized.slice(0, qIndex) : normalized;\r\n    const queryPart = qIndex >= 0 ? normalized.slice(qIndex) : '';\r\n\r\n    const encodedPath = pathPart\r\n      .split('/')\r\n      .map(segment => this._encodePathSegment(segment))\r\n      .join('/');\r\n\r\n    return `${encodedPath}${queryPart.replace(/#/g, '%23')}`;\r\n  },\r\n\r\n  _getMirrorEikanyaModelUrl(modelUrl: string): string | null {\r\n    const url = String(modelUrl || '').trim();\r\n    if (!url) return null;\r\n\r\n    if (url.startsWith(EIKANYA_CDN_BASE)) {\r\n      return `${EIKANYA_RAW_BASE}${url.slice(EIKANYA_CDN_BASE.length)}`;\r\n    }\r\n    if (url.startsWith(EIKANYA_RAW_BASE)) {\r\n      return `${EIKANYA_CDN_BASE}${url.slice(EIKANYA_RAW_BASE.length)}`;\r\n    }\r\n    return null;\r\n  },\r\n\r\n  _expandJsDelivrHosts(inputUrl: string): string[] {\r\n    const url = String(inputUrl || '').trim();\r\n    if (!url) return [];\r\n\r\n    let urlObj: URL;\r\n    try {\r\n      urlObj = new URL(url);\r\n    } catch {\r\n      return [];\r\n    }\r\n\r\n    if (!urlObj.hostname.toLowerCase().endsWith('jsdelivr.net')) return [];\r\n\r\n    const results: string[] = [];\r\n    for (const host of this._JSDELIVR_HOSTS) {\r\n      try {\r\n        const u = new URL(url);\r\n        u.hostname = host;\r\n        results.push(u.toString());\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n    return results;\r\n  },\r\n\r\n  _convertJsDelivrGhToRawCandidates(inputUrl: string): string[] {\r\n    const url = String(inputUrl || '').trim();\r\n    if (!url) return [];\r\n\r\n    let urlObj: URL;\r\n    try {\r\n      urlObj = new URL(url);\r\n    } catch {\r\n      return [];\r\n    }\r\n\r\n    const host = urlObj.hostname.toLowerCase();\r\n    if (!host.endsWith('jsdelivr.net')) return [];\r\n    if (!urlObj.pathname.startsWith('/gh/')) return [];\r\n\r\n    const rest = urlObj.pathname.slice('/gh/'.length);\r\n    const parts = rest.split('/').filter(Boolean);\r\n    if (parts.length < 2) return [];\r\n\r\n    const owner = parts[0];\r\n    const repoWithRef = parts[1];\r\n    const filePath = parts.slice(2).join('/');\r\n    if (!owner || !repoWithRef || !filePath) return [];\r\n\r\n    const [repo, ref] = repoWithRef.split('@');\r\n    const suffix = `${urlObj.search || ''}${urlObj.hash || ''}`;\r\n\r\n    if (ref) {\r\n      return [`https://raw.githubusercontent.com/${owner}/${repo}/${ref}/${filePath}${suffix}`];\r\n    }\r\n\r\n    return [\r\n      `https://raw.githubusercontent.com/${owner}/${repo}/master/${filePath}${suffix}`,\r\n      `https://raw.githubusercontent.com/${owner}/${repo}/main/${filePath}${suffix}`,\r\n    ];\r\n  },\r\n\r\n  _buildModelUrlCandidates(modelUrl: string): string[] {\r\n    const bases: string[] = [];\r\n    const addBase = (url: string) => {\r\n      const normalized = this._normalizeRemoteUrl(url);\r\n      if (!normalized) return;\r\n      if (!bases.includes(normalized)) bases.push(normalized);\r\n    };\r\n\r\n    addBase(modelUrl);\r\n    const mirrorUrl = this._getMirrorEikanyaModelUrl(modelUrl);\r\n    if (mirrorUrl) addBase(mirrorUrl);\r\n\r\n    const candidates: string[] = [];\r\n    const add = (url: string) => {\r\n      const normalized = this._normalizeRemoteUrl(url);\r\n      if (!normalized) return;\r\n      if (!candidates.includes(normalized)) candidates.push(normalized);\r\n    };\r\n\r\n    for (const base of bases) {\r\n      add(base);\r\n      for (const variant of this._expandJsDelivrHosts(base)) add(variant);\r\n      for (const raw of this._convertJsDelivrGhToRawCandidates(base)) add(raw);\r\n    }\r\n\r\n    return candidates;\r\n  },\r\n\r\n  async _createModelWithTimeout(Live2DModel: any, dataUrl: string, timeoutMs = 30000): Promise<any> {\n    let timer: number | null = null;\n    try {\n      const timeoutPromise = new Promise<never>((_resolve, reject) => {\n        timer = window.setTimeout(() => {\n          reject(new Error(` (${timeoutMs}ms)`));\n        }, timeoutMs);\n      });\n\n      return await Promise.race([\n        Live2DModel.from(dataUrl, {\n          //  galgame  WebGL renderer  autoUpdate\n          //  Cubism2/ WebGL program \n          autoUpdate: false,\n          autoInteract: false,\n        }),\n        timeoutPromise,\n      ]);\n    } finally {\n      if (timer !== null) {\n        window.clearTimeout(timer);\n      }\n    }\n  },\n\r\n  async _fetchWithTimeout(url: string, init: RequestInit, timeoutMs = 12000): Promise<Response> {\r\n    if (typeof AbortController === 'undefined') {\r\n      return fetch(url, init);\r\n    }\r\n\r\n    const controller = new AbortController();\r\n    const timer = window.setTimeout(() => controller.abort(), timeoutMs);\r\n\r\n    try {\r\n      return await fetch(url, { ...init, signal: controller.signal });\r\n    } catch (e: any) {\r\n      if (e?.name === 'AbortError') {\r\n        throw new Error(` (${timeoutMs}ms): ${url}`);\r\n      }\r\n      throw e;\r\n    } finally {\r\n      window.clearTimeout(timer);\r\n    }\r\n  },\r\n\r\n  _toPositiveNumber(value: unknown, fallback: number): number {\r\n    const n = typeof value === 'number' ? value : Number(value);\r\n    return Number.isFinite(n) && n > 0 ? n : fallback;\r\n  },\r\n\r\n  _toScale(value: unknown, fallback = 1): number {\n    const n = typeof value === 'number' ? value : Number(value);\n    if (!Number.isFinite(n) || n <= 0) return fallback;\n    return Math.min(20, Math.max(0.01, n));\n  },\n\n  _readModelBaseBounds(model: any): { x: number; y: number; width: number; height: number } | null {\n    if (!model || typeof model.getLocalBounds !== 'function') return null;\n    try {\n      const bounds = model.getLocalBounds();\n      if (!bounds) return null;\n      const width = Number(bounds.width);\n      const height = Number(bounds.height);\n      if (!Number.isFinite(width) || !Number.isFinite(height) || width <= 0 || height <= 0) {\n        return null;\n      }\n      const x = Number.isFinite(Number(bounds.x)) ? Number(bounds.x) : 0;\n      const y = Number.isFinite(Number(bounds.y)) ? Number(bounds.y) : 0;\n      return { x, y, width, height };\n    } catch {\n      return null;\n    }\n  },\n\n  _resolveModelBaseBounds(): { x: number; y: number; width: number; height: number } {\n    if (this.modelBaseBounds) return this.modelBaseBounds;\n\n    const measured = this._readModelBaseBounds(this.model);\n    if (measured) {\n      this.modelBaseBounds = measured;\n      this.modelBaseWidth = measured.width;\n      this.modelBaseHeight = measured.height;\n      return measured;\n    }\n\n    return {\n      x: 0,\n      y: 0,\n      width: this._toPositiveNumber(this.modelBaseWidth, 500),\n      height: this._toPositiveNumber(this.modelBaseHeight, 800),\n    };\n  },\n\n  _applyStageTransform(stageWidth: number, stageHeight: number, scale: number): {\n    finalScale: number;\n    stageWidth: number;\n    stageHeight: number;\n    modelWidth: number;\n    modelHeight: number;\n  } | null {\n    if (!this.model) return null;\n\n    const safeStageWidth = this._toPositiveNumber(stageWidth, 280);\n    const safeStageHeight = this._toPositiveNumber(stageHeight, 360);\n    const bounds = this._resolveModelBaseBounds();\n    const safeModelWidth = this._toPositiveNumber(bounds.width, 500);\n    const safeModelHeight = this._toPositiveNumber(bounds.height, 800);\n    const fitScale = Math.min(safeStageWidth / safeModelWidth, safeStageHeight / safeModelHeight) * 0.9;\n    const finalScale = this._toScale(fitScale * this._toScale(scale, 1), 0.3);\n\n    this.model.visible = true;\n    this.model.alpha = 1;\n    this.model.scale.set(finalScale);\n\n    if (this.model.anchor?.set) {\n      this.model.anchor.set(0.5, 1);\n      this.model.x = safeStageWidth / 2;\n      this.model.y = safeStageHeight;\n    } else if (this.model.pivot?.set) {\n      this.model.pivot.set(bounds.x + safeModelWidth / 2, bounds.y + safeModelHeight);\n      this.model.x = safeStageWidth / 2;\n      this.model.y = safeStageHeight;\n    } else {\n      this.model.x = safeStageWidth / 2;\n      this.model.y = safeStageHeight / 2;\n    }\n\n    return {\n      finalScale,\n      stageWidth: safeStageWidth,\n      stageHeight: safeStageHeight,\n      modelWidth: safeModelWidth,\n      modelHeight: safeModelHeight,\n    };\n  },\n\r\n  _normalizeLegacyCubism2Settings(modelJson: any): void {\r\n    if (!modelJson || modelJson.FileReferences) return;\r\n\r\n    const textures = modelJson.textures || modelJson.Textures;\r\n    if (Array.isArray(textures)) return;\r\n    if (!textures || typeof textures !== 'object') return;\r\n\r\n    const entries = Object.entries(textures)\r\n      .filter((entry): entry is [string, string[]] => Array.isArray(entry[1]) && entry[1].length > 0);\r\n    if (entries.length === 0) return;\r\n\r\n    const hintKeys = [\r\n      modelJson.config?.texture,\r\n      modelJson.config?.textureId,\r\n      modelJson.config?.skin,\r\n      modelJson.config?.modelId,\r\n      modelJson.config?.defaultTexture,\r\n      modelJson.config?.defaultSkin,\r\n    ]\r\n      .map(v => (v === undefined || v === null ? '' : String(v).trim()))\r\n      .filter(Boolean);\r\n\r\n    let selected = entries[0];\r\n    for (const hint of hintKeys) {\r\n      const matched = entries.find(([key]) => key === hint);\r\n      if (matched) {\r\n        selected = matched;\r\n        break;\r\n      }\r\n    }\r\n\r\n    const normalizedTextures = selected[1].map((item: string) => {\r\n      const raw = String(item || '').trim();\r\n      if (!raw) return raw;\r\n      if (/^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(raw)) return raw;\r\n      if (raw.startsWith('/')) return raw;\r\n      if (raw.includes('/')) return raw;\r\n      //  textures/  JSON \r\n      return `textures/${raw}`;\r\n    });\r\n    modelJson.textures = normalizedTextures;\r\n    modelJson.Textures = normalizedTextures;\r\n    log(' Cubism2 ', {\r\n      key: selected[0],\r\n      textureCount: normalizedTextures.length,\r\n    });\r\n  },\r\n\r\n  _clearAutoMotionLoop(): void {\r\n    if (this._autoMotionTimer !== null) {\r\n      window.clearInterval(this._autoMotionTimer);\r\n      this._autoMotionTimer = null;\r\n    }\r\n  },\r\n\r\n  _stopCurrentMotion(reason = 'manual'): void {\n    const model = this.model;\n    if (!model) return;\n\r\n    let stopped = false;\r\n    const tryCall = (obj: any, method: string) => {\r\n      if (!obj || typeof obj[method] !== 'function') return;\r\n      try {\r\n        obj[method]();\r\n        stopped = true;\r\n      } catch {\r\n        // ignore\r\n      }\r\n    };\r\n\r\n    const mm = model?.internalModel?.motionManager as any;\r\n    const animator = model?.internalModel?.animator as any;\r\n    const internal = model?.internalModel as any;\r\n\r\n    tryCall(model, 'stopMotions');\r\n    tryCall(mm, 'stopAllMotions');\r\n    tryCall(mm, 'stopAllMotion');\r\n    tryCall(mm, 'stopMotion');\r\n    tryCall(mm, 'stop');\r\n    tryCall(animator, 'stopAllMotions');\r\n    tryCall(animator, 'stopAllMotion');\r\n    tryCall(animator, 'stop');\r\n    tryCall(internal, 'stopAllMotions');\r\n\r\n    if (stopped) {\n      log('', { reason });\n    }\n  },\n\n  stopCurrentMotion(reason = 'manual'): void {\n    this._stopCurrentMotion(reason);\n  },\n\r\n  _refreshManualMouthParams(): void {\r\n    let enabled = false;\r\n    const ids: string[] = [];\r\n    try {\n      const store = useSettingsStore();\n      const s = store.settings as any;\n      enabled = !!s?.lipSyncManualParamsEnabled;\n      const raw = Array.isArray(s?.lipSyncManualParamIds) ? s.lipSyncManualParamIds : [];\n      const set = new Set<string>();\n      for (const item of raw) {\n        const id = String(item || '').trim();\n        if (!id) continue;\r\n        const low = id.toLowerCase();\r\n        if (set.has(low)) continue;\r\n        set.add(low);\r\n        ids.push(id);\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    this._manualMouthParamEnabled = enabled;\r\n    this._manualMouthParamIds = ids;\r\n    this._manualMouthParamIdSet = new Set(ids.map(id => id.toLowerCase()));\r\n  },\r\n\r\n  _setLipSyncActive(active: boolean): void {\r\n    const next = !!active;\r\n    if (this._lipSyncActive === next) return;\r\n\r\n    this._lipSyncActive = next;\r\n    if (next) {\r\n      this._refreshManualMouthParams();\r\n      const model = this.model;\r\n      const coreModel = model?.internalModel?.coreModel;\r\n      if (model) this._ensureLipSyncHooks(model);\r\n      if (coreModel) this._installCoreWriteMask(coreModel);\r\n    }\r\n    log(`LipSync active=${next}`);\r\n  },\r\n\r\n  setAutoMotionLoopEnabled(enabled: boolean): void {\r\n    this.autoMotionLoopEnabled = Boolean(enabled);\r\n\r\n    if (!this.model) {\r\n      this._clearAutoMotionLoop();\r\n      return;\r\n    }\r\n\r\n    if (this.autoMotionLoopEnabled) {\r\n      this._startAutoMotionLoop();\r\n    } else {\r\n      this._clearAutoMotionLoop();\r\n      this._stopCurrentMotion('auto-motion-disabled');\r\n    }\r\n  },\r\n\r\n  _pickDefaultMotionGroup(groups: Record<string, number>): string | null {\r\n    const keys = Object.keys(groups).filter(key => groups[key] > 0);\r\n    if (keys.length === 0) return null;\r\n\r\n    const preferred = ['idle', 'home', 'stand', 'normal', 'default', 'main', 'loop', 'wait'];\r\n    for (const key of keys) {\r\n      const lower = key.toLowerCase();\r\n      if (preferred.some(token => lower.includes(token))) {\r\n        return key;\r\n      }\r\n    }\r\n\r\n    if (keys.includes('')) {\r\n      return '';\r\n    }\r\n\r\n    return null;\r\n  },\r\n\r\n  _startAutoMotionLoop(): void {\r\n    this._clearAutoMotionLoop();\r\n    if (!this.model) return;\r\n\r\n    const initialGroups = this.getMotionGroups();\r\n    const motionGroup = this._pickDefaultMotionGroup(initialGroups);\r\n    const allGroupNames = Object.keys(initialGroups).filter(key => initialGroups[key] > 0);\r\n    if (allGroupNames.length === 0) {\r\n      log('');\r\n      return;\r\n    }\r\n\r\n    const playOne = () => {\r\n      if (!this.model) return;\r\n      const groups = this.getMotionGroups();\r\n\r\n      if (motionGroup !== null) {\r\n        const count = groups[motionGroup] ?? 0;\r\n        if (count <= 0) return;\r\n        const idx = Math.floor(Math.random() * count);\r\n        this.playMotion(motionGroup, idx);\r\n        return;\r\n      }\r\n\r\n      const groupNames = Object.keys(groups).filter(key => groups[key] > 0);\r\n      if (groupNames.length === 0) return;\r\n      const randGroup = groupNames[Math.floor(Math.random() * groupNames.length)];\r\n      const count = groups[randGroup];\r\n      if (count <= 0) return;\r\n      const randIndex = Math.floor(Math.random() * count);\r\n      this.playMotion(randGroup, randIndex);\r\n    };\r\n\r\n    playOne();\r\n    this._autoMotionTimer = window.setInterval(playOne, 10000);\r\n    if (motionGroup !== null) {\r\n      log('', {\r\n        mode: 'preferred-group',\r\n        group: motionGroup || '(empty)',\r\n        intervalMs: 10000,\r\n      });\r\n    } else {\r\n      log('', {\r\n        mode: 'random-all-groups',\r\n        groupCount: allGroupNames.length,\r\n        intervalMs: 10000,\r\n      });\r\n    }\r\n  },\r\n\r\n  _stripJsonComments(text: string): string {\r\n    let output = '';\r\n    let inString = false;\r\n    let quoteChar = '\"';\r\n    let escaping = false;\r\n    let inLineComment = false;\r\n    let inBlockComment = false;\r\n\r\n    for (let i = 0; i < text.length; i++) {\r\n      const ch = text[i];\r\n      const next = i + 1 < text.length ? text[i + 1] : '';\r\n\r\n      if (inLineComment) {\r\n        if (ch === '\\n') {\r\n          inLineComment = false;\r\n          output += ch;\r\n        }\r\n        continue;\r\n      }\r\n\r\n      if (inBlockComment) {\r\n        if (ch === '*' && next === '/') {\r\n          inBlockComment = false;\r\n          i++;\r\n        }\r\n        continue;\r\n      }\r\n\r\n      if (inString) {\r\n        output += ch;\r\n        if (escaping) {\r\n          escaping = false;\r\n        } else if (ch === '\\\\') {\r\n          escaping = true;\r\n        } else if (ch === quoteChar) {\r\n          inString = false;\r\n        }\r\n        continue;\r\n      }\r\n\r\n      if (ch === '/' && next === '/') {\r\n        inLineComment = true;\r\n        i++;\r\n        continue;\r\n      }\r\n\r\n      if (ch === '/' && next === '*') {\r\n        inBlockComment = true;\r\n        i++;\r\n        continue;\r\n      }\r\n\r\n      if (ch === '\"' || ch === '\\'') {\r\n        inString = true;\r\n        quoteChar = ch;\r\n      }\r\n\r\n      output += ch;\r\n    }\r\n\r\n    return output;\r\n  },\r\n\r\n  _tryParseModelJson(text: string): any | null {\r\n    const raw = String(text ?? '').replace(/^\\uFEFF/, '').trim();\r\n    if (!raw) return null;\r\n\r\n    try {\r\n      return JSON.parse(raw);\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    let cleaned = this._stripJsonComments(raw);\r\n    cleaned = cleaned.replace(/,\\s*([}\\]])/g, '$1');\r\n    cleaned = cleaned.replace(/}(\\s*){/g, '},$1{');\r\n    cleaned = cleaned.replace(/](\\s*){/g, '],$1{');\r\n    cleaned = cleaned.replace(/([}\\]0-9\"'])(\\s*)(?=\"[^\"]+\"\\s*:)/g, '$1,$2');\r\n\r\n    try {\r\n      return JSON.parse(cleaned);\r\n    } catch {\r\n      return null;\r\n    }\r\n  },\r\n\r\n  _buildModelJsonCandidates(modelUrl: string): string[] {\r\n    const candidates = [modelUrl];\r\n\r\n    const addCandidate = (url: string) => {\r\n      if (!url) return;\r\n      if (!candidates.includes(url)) candidates.push(url);\r\n    };\r\n\r\n    addCandidate(modelUrl.replace(/\\/model\\.json(?=([?#].*)?$)/i, '/model.model.json'));\r\n    addCandidate(modelUrl.replace(/\\/model3\\.json(?=([?#].*)?$)/i, '/model.model3.json'));\r\n\r\n    return candidates;\r\n  },\r\n\r\n  async _fetchModelJsonCandidate(modelUrl: string, useProxy: boolean): Promise<any | null> {\r\n    const requestUrl = useProxy ? this._getProxiedUrl(modelUrl) : modelUrl;\r\n    const resp = await this._fetchWithTimeout(requestUrl, { method: 'GET', cache: 'no-store' }, 12000);\r\n    if (!resp.ok) return null;\r\n\r\n    const text = await resp.text();\r\n    const modelJson = this._tryParseModelJson(text);\r\n    if (!modelJson) return null;\r\n\r\n    return { modelJson, sourceUrl: modelUrl, useProxy };\r\n  },\r\n\r\n  /**\n   *  CORS  URL\n   * : getCorsProxyUrl -> enableCorsProxy -> corsProxy.getProxyUrl -> /proxy?url=\n   */\n  _getProxiedUrl(originalUrl: string): string {\n    const top = this._top() as any;\n    const url = String(originalUrl || '').trim();\n    if (!url) return url;\n    //  URL\n    if (url.toLowerCase().includes('/proxy?url=')) return url;\n\r\n    // SillyTavern  CORS \n    if (typeof top.getCorsProxyUrl === 'function') {\r\n      try {\r\n        const proxied = top.getCorsProxyUrl(url);\r\n        if (typeof proxied === 'string' && proxied) return proxied;\r\n      } catch (_e) { /* ignore */ }\r\n    }\r\n\r\n    if (typeof top.enableCorsProxy === 'function') {\r\n      try {\r\n        const proxied = top.enableCorsProxy(url);\r\n        if (typeof proxied === 'string' && proxied) return proxied;\r\n      } catch (_e) { /* ignore */ }\r\n    }\r\n\r\n    if (top.corsProxy?.getProxyUrl) {\r\n      try {\r\n        const proxied = top.corsProxy.getProxyUrl(url);\r\n        if (typeof proxied === 'string' && proxied) return proxied;\r\n      } catch (_e) { /* ignore */ }\r\n    }\r\n\r\n    // \n    const origin = top.location?.origin;\n    if (origin) {\n      return `${origin}/proxy?url=${encodeURIComponent(url)}`;\n    }\n\r\n    return url;\r\n  },\r\n\r\n  /**\n   *  SDK  Ticker\n   */\n  async init(): Promise<boolean> {\n    if (this.isReady) {\r\n      const runtime = Live2DLoader.getRuntime(this._top());\r\n      if (runtime) {\r\n        this._runtime = runtime;\r\n        return true;\r\n      }\r\n      this.isReady = false;\r\n    }\r\n\r\n    const sdkLoaded = await Live2DLoader.load();\r\n    if (!sdkLoaded) {\r\n      error('SDK  Live2DManager');\r\n      return false;\r\n    }\r\n\r\n    //  runtime \r\n    let runtime = Live2DLoader.getRuntime(this._top());\r\n    let retries = 30;\r\n    while (!runtime && retries > 0) {\r\n      await new Promise(r => setTimeout(r, 100));\r\n      runtime = Live2DLoader.getRuntime(this._top());\r\n      retries--;\r\n    }\r\n\r\n    if (!runtime?.pixi || !runtime?.live2dModel) {\r\n      error(' Live2D runtime ');\r\n      return false;\r\n    }\r\n\r\n    try {\n      const PIXI = runtime.pixi;\n      const Live2DModel = runtime.live2dModel;\n      if (typeof Live2DModel?.registerTicker !== 'function') {\n        throw new Error('Live2DModel.registerTicker ');\n      }\n\n      //  ticker\n      const lastRegisteredTicker = (Live2DModel as any)[TICKER_REGISTERED_FLAG] as unknown;\n      if (lastRegisteredTicker !== PIXI.Ticker) {\n        Live2DModel.registerTicker(PIXI.Ticker);\n        (Live2DModel as any)[TICKER_REGISTERED_FLAG] = PIXI.Ticker;\n        log('Live2D ticker ');\n      } else {\n        log('Live2D ticker ');\n      }\n\n      this._runtime = runtime;\n      this.isReady = true;\n      log('Live2DManager ');\n      return true;\n    } catch (e) {\r\n      error('Live2DManager ', e);\r\n      return false;\r\n    }\r\n  },\r\n\r\n  /**\n   *  URL + \n   * - :  model JSON runtime \n   * - :  IndexedDB  blob/data URL runtime \n   */\n  async loadModel(\n    modelPath: string,\n    onProgress?: (progress: ModelLoadProgress) => void,\n  ): Promise<boolean> {\n    let progress = 0;\n    const reportProgress = (percent: number, message: string): void => {\n      if (!onProgress) return;\n      progress = Math.max(progress, Math.round(percent));\n      onProgress({\n        percent: Math.max(0, Math.min(100, progress)),\n        message,\n      });\n    };\n\n    const loadWithRuntime = async (\n      modelUrl: string,\n      runtimeInfo: Record<string, any> | null,\n      contextLabel: string,\n      progressStart: number,\n      progressSuffix = '',\n    ): Promise<{\n      model: any;\n      texturesReady: boolean;\n      runtimeInfo: {\n        runtimeType: Live2DRuntimeType;\n        cubismVersion: number | null;\n        moc3Version?: number | null;\n      };\n    }> => {\n      const resolvedRuntime = await this._ensureRuntimeDependencies(runtimeInfo, contextLabel);\n      const PIXI = this._getPIXI();\n      const Live2DModel = this._getLive2DModelClass(resolvedRuntime.runtimeType);\n      if (!PIXI || !Live2DModel) {\n        throw new Error(`Live2D ${contextLabel}`);\n      }\n\n      this._registerTickerForRuntime(Live2DModel, PIXI);\n      reportProgress(progressStart, `${progressSuffix}`);\n      const model = await this._createModelWithTimeout(Live2DModel, modelUrl);\n      reportProgress(progressStart + 10, `${progressSuffix}`);\n      const texturesReady = await this._waitForTextures(model, (loadedCount, totalCount) => {\n        if (totalCount <= 0) return;\n        const ratio = Math.max(0, Math.min(1, loadedCount / totalCount));\n        reportProgress(\n          progressStart + 10 + ratio * 10,\n          ` ${loadedCount}/${totalCount}${progressSuffix}`,\n        );\n      });\n\n      return {\n        model,\n        texturesReady,\n        runtimeInfo: resolvedRuntime,\n      };\n    };\n\n    reportProgress(2, '');\n    if (!this.isReady) {\n      reportProgress(8, ' Live2D ');\n      const ready = await this.init();\n      if (!ready) {\n        reportProgress(100, 'Live2D ');\n        return false;\n      }\n    }\n\n    try {\n      log(':', modelPath);\n      reportProgress(14, '');\n      this.destroyModel();\n      this._revokeLocalBlobUrls();\n\n      let model: any = null;\n      let texturesReady = false;\n      let loadedFrom = modelPath;\n      let lastError: unknown = null;\n\n      if (this._isLocalModelPath(modelPath)) {\n        reportProgress(20, '');\n        const localModelId = this._normalizeLocalModelId(modelPath);\n        const localModelData = await getLive2DModel(localModelId);\n        if (!localModelData) {\n          throw new Error(' ZIP ');\n        }\n\n        this._lastModelJson = JSON.parse(JSON.stringify(localModelData.modelJson || {}));\n        this._lastModelJsonSourceUrl = modelPath;\n\n        let runtimeInfo = this._setRuntimeInfo(localModelData);\n        if (localModelData.moc3) {\n          runtimeInfo = await this._detectRuntimeFromMoc3(localModelData.moc3, runtimeInfo);\n        }\n\n        const buildLocalUrl = async (preferBlob: boolean): Promise<string> => {\n          if (!preferBlob) {\n            return await this._buildLocalModelDataUrl(localModelData);\n          }\n          const supported = await this._supportsXhrBlobUrls();\n          if (!supported) {\n            return await this._buildLocalModelDataUrl(localModelData);\n          }\n          return await this._buildLocalModelBlobUrl(localModelData);\n        };\n\n        let usedBlobUrl = false;\n        try {\n          reportProgress(30, '');\n          const localUrl = await buildLocalUrl(true);\n          usedBlobUrl = String(localUrl || '').startsWith('blob:');\n          const loaded = await loadWithRuntime(localUrl, runtimeInfo, 'local-model', 42, ' ()');\n          model = loaded.model;\n          texturesReady = loaded.texturesReady;\n          runtimeInfo = loaded.runtimeInfo;\n          loadedFrom = modelPath;\n        } catch (localError) {\n          lastError = localError;\n          warn('', localError);\n\n          if (usedBlobUrl) {\n            this._disableXhrBlobUrls('local-load-failed');\n            this._revokeLocalBlobUrls();\n            try {\n              const localDataUrl = await buildLocalUrl(false);\n              const loaded = await loadWithRuntime(\n                localDataUrl,\n                runtimeInfo,\n                'local-model-data-fallback',\n                46,\n                ' ( DataURL )',\n              );\n              model = loaded.model;\n              texturesReady = loaded.texturesReady;\n              runtimeInfo = loaded.runtimeInfo;\n              loadedFrom = `${modelPath}#data`;\n              lastError = null;\n            } catch (dataFallbackError) {\n              lastError = dataFallbackError;\n            }\n          }\n\n          const shouldForceCubism5 =\n            !model && this._isCoreParseError(lastError) && runtimeInfo.runtimeType === LIVE2D_RUNTIME_TYPES.LEGACY;\n          if (shouldForceCubism5) {\n            warn('local legacy runtime  Cubism5 runtime ', lastError);\n            this._revokeLocalBlobUrls();\n            try {\n              const forcedRuntime = {\n                ...runtimeInfo,\n                runtimeType: LIVE2D_RUNTIME_TYPES.CUBISM5,\n                cubismVersion: 5,\n              };\n              const retryLocalUrl = await buildLocalUrl(false);\n              const loaded = await loadWithRuntime(\n                retryLocalUrl,\n                forcedRuntime,\n                'local-force-cubism5-retry',\n                50,\n                ' ( Cubism5 )',\n              );\n              model = loaded.model;\n              texturesReady = loaded.texturesReady;\n              loadedFrom = `${modelPath}#cubism5`;\n              lastError = null;\n            } catch (forcedRetryError) {\n              lastError = forcedRetryError;\n            }\n          }\n        }\n\n        if (!model) {\n          throw (lastError instanceof Error ? lastError : new Error(''));\n        }\n      } else {\n        reportProgress(20, '');\n        let modelUrl: string;\n        if (modelPath.startsWith('http://') || modelPath.startsWith('https://')) {\n          modelUrl = modelPath;\n        } else {\n          modelUrl = `${LIVE2D_CDN_BASE}${modelPath}`;\n        }\n        modelUrl = this._normalizeRemoteUrl(modelUrl);\n\n        const modelUrlCandidates = this._buildModelUrlCandidates(modelUrl);\n        for (let i = 0; i < modelUrlCandidates.length; i++) {\n          const candidateUrl = modelUrlCandidates[i];\n          const attemptLabel =\n            modelUrlCandidates.length > 1 ? ` (${i + 1}/${modelUrlCandidates.length})` : '';\n          const attemptProgressStart = 24 + Math.floor((i / Math.max(1, modelUrlCandidates.length)) * 36);\n          let attemptModel: any = null;\n          let attemptTexturesReady = false;\n          let attemptError: unknown = null;\n\n          const tryCreate = async (dataUrl: string, suffix = ''): Promise<void> => {\n            const runtimeHint = this._runtimeInfo;\n            const loaded = await loadWithRuntime(\n              dataUrl,\n              runtimeHint,\n              `remote:${candidateUrl}`,\n              attemptProgressStart + 10,\n              `${attemptLabel}${suffix}`,\n            );\n            attemptModel = loaded.model;\n            attemptTexturesReady = loaded.texturesReady;\n          };\n\n          try {\n            if (i > 0) {\n              log(':', candidateUrl);\n            }\n\n            reportProgress(attemptProgressStart, `${attemptLabel}`);\n            const dataUrl = await this._buildRemoteModelDataUrl(candidateUrl);\n            await tryCreate(dataUrl);\n          } catch (firstError) {\n            attemptError = firstError;\n            if (this._isCoreParseError(firstError) && this._runtimeType === LIVE2D_RUNTIME_TYPES.LEGACY) {\n              warn('remote legacy runtime  Cubism5 runtime ', firstError);\n              try {\n                const forcedRuntime = {\n                  ...this._runtimeInfo,\n                  runtimeType: LIVE2D_RUNTIME_TYPES.CUBISM5,\n                  cubismVersion: 5,\n                };\n                const dataUrl = await this._buildRemoteModelDataUrl(candidateUrl);\n                const loaded = await loadWithRuntime(\n                  dataUrl,\n                  forcedRuntime,\n                  `remote-force-cubism5:${candidateUrl}`,\n                  attemptProgressStart + 12,\n                  `${attemptLabel} ( Cubism5 )`,\n                );\n                attemptModel = loaded.model;\n                attemptTexturesReady = loaded.texturesReady;\n                attemptError = null;\n              } catch (forcedRetryError) {\n                attemptError = forcedRetryError;\n              }\n            }\n\n            if (!attemptModel) {\n              warn('', firstError);\n              try {\n                reportProgress(attemptProgressStart + 6, `${attemptLabel}`);\n                const proxyDataUrl = await this._buildRemoteModelDataUrl(candidateUrl, true);\n                await tryCreate(proxyDataUrl, ' ()');\n                attemptError = null;\n              } catch (proxyError) {\n                attemptError = proxyError;\n                if (this._isCoreParseError(proxyError) && this._runtimeType === LIVE2D_RUNTIME_TYPES.LEGACY) {\n                  try {\n                    const forcedRuntime = {\n                      ...this._runtimeInfo,\n                      runtimeType: LIVE2D_RUNTIME_TYPES.CUBISM5,\n                      cubismVersion: 5,\n                    };\n                    const proxyDataUrl = await this._buildRemoteModelDataUrl(candidateUrl, true);\n                    const loaded = await loadWithRuntime(\n                      proxyDataUrl,\n                      forcedRuntime,\n                      `remote-force-cubism5-proxy:${candidateUrl}`,\n                      attemptProgressStart + 14,\n                      `${attemptLabel} ( Cubism5 )`,\n                    );\n                    attemptModel = loaded.model;\n                    attemptTexturesReady = loaded.texturesReady;\n                    attemptError = null;\n                  } catch (proxyForcedRetryError) {\n                    attemptError = proxyForcedRetryError;\n                  }\n                }\n              }\n            }\n          }\n\n          if (attemptModel) {\n            model = attemptModel;\n            texturesReady = attemptTexturesReady;\n            loadedFrom = candidateUrl;\n            lastError = null;\n            break;\n          }\n\n          lastError = attemptError;\n          warn(` (${i + 1}/${modelUrlCandidates.length})`, candidateUrl, attemptError);\n          try {\n            attemptModel?.destroy?.();\n          } catch {\n            // ignore\n          }\n        }\n\n        if (!model) {\n          throw (lastError instanceof Error ? lastError : new Error(''));\n        }\n      }\n\n      this.model = model;\n      const measuredBounds = this._readModelBaseBounds(model);\n      if (measuredBounds) {\n        this.modelBaseBounds = measuredBounds;\n        this.modelBaseWidth = measuredBounds.width;\n        this.modelBaseHeight = measuredBounds.height;\n      } else {\n        this.modelBaseBounds = null;\n        this.modelBaseWidth = model.width > 0 ? model.width : 500;\n        this.modelBaseHeight = model.height > 0 ? model.height : 800;\n      }\n\n      reportProgress(95, '');\n      log('', this.getExpressions());\n      log('', this.getMotionGroups());\n      if (!texturesReady) {\n        warn('');\n      }\n      if (loadedFrom !== modelPath) {\n        log(':', loadedFrom);\n      }\n      reportProgress(100, '');\n      log('');\n      return true;\n    } catch (e) {\n      reportProgress(100, '');\n      error(':', e);\n      return false;\n    }\n  },\n\r\n  /**\n   *  model JSON URL\n   *  JSON  data URL \n   */\n  async _buildRemoteModelDataUrl(modelUrl: string, forceProxyResources = false): Promise<string> {\n    const candidateUrls = this._buildModelJsonCandidates(modelUrl);\r\n\r\n    let modelJson: any = null;\r\n    let sourceModelUrl = modelUrl;\r\n    let useProxy = false;\r\n\r\n    for (const candidateUrl of candidateUrls) {\r\n      try {\r\n        const direct = await this._fetchModelJsonCandidate(candidateUrl, false);\r\n        if (direct) {\r\n          modelJson = direct.modelJson;\r\n          sourceModelUrl = direct.sourceUrl;\r\n          useProxy = false;\r\n          break;\r\n        }\r\n      } catch (directError) {\r\n        warn(' JSON ', candidateUrl, directError);\r\n      }\r\n\r\n      try {\r\n        const proxied = await this._fetchModelJsonCandidate(candidateUrl, true);\r\n        if (proxied) {\r\n          modelJson = proxied.modelJson;\r\n          sourceModelUrl = proxied.sourceUrl;\r\n          useProxy = true;\r\n          break;\r\n        }\r\n      } catch (proxyError) {\r\n        warn(' JSON ', candidateUrl, proxyError);\r\n      }\r\n    }\r\n\r\n    if (!modelJson) {\r\n      throw new Error(' JSON ');\r\n    }\r\n\r\n    if (sourceModelUrl !== modelUrl) {\r\n      log(' JSON :', sourceModelUrl);\r\n    }\r\n\r\n    const modifiedModelJson = JSON.parse(JSON.stringify(modelJson));\r\n    this._normalizeLegacyCubism2Settings(modifiedModelJson);\r\n\r\n    //  URL\n    const resolveUrl = (p: string): string => {\n      if (typeof p !== 'string') return p;\r\n      const raw = p.trim();\r\n      if (!raw) return p;\r\n\r\n      const normalized = this._normalizeResourceRef(raw);\r\n      const hasScheme = /^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(normalized);\r\n      const abs = hasScheme\r\n        ? this._normalizeRemoteUrl(normalized)\r\n        : this._normalizeRemoteUrl(new URL(normalized, sourceModelUrl).toString());\r\n\r\n      if ((useProxy || forceProxyResources) && (abs.startsWith('http://') || abs.startsWith('https://'))) {\r\n        return this._getProxiedUrl(abs);\r\n      }\r\n      return abs;\r\n    };\r\n\r\n    //  Cubism 3/4 model3.json\n    if (modifiedModelJson?.FileReferences) {\r\n      const refs = modifiedModelJson.FileReferences;\r\n      for (const key of Object.keys(refs)) {\r\n        if (typeof refs[key] === 'string') {\r\n          refs[key] = resolveUrl(refs[key]);\r\n        }\r\n      }\r\n\r\n      if (typeof refs.Moc === 'string') refs.Moc = resolveUrl(refs.Moc);\r\n      if (Array.isArray(refs.Textures)) refs.Textures = refs.Textures.map(resolveUrl);\r\n      if (typeof refs.Physics === 'string') refs.Physics = resolveUrl(refs.Physics);\r\n      if (typeof refs.Pose === 'string') refs.Pose = resolveUrl(refs.Pose);\r\n      if (typeof refs.UserData === 'string') refs.UserData = resolveUrl(refs.UserData);\r\n\r\n      if (refs.Motions && typeof refs.Motions === 'object') {\r\n        for (const groupName of Object.keys(refs.Motions)) {\r\n          const motionList = refs.Motions[groupName];\r\n          if (!Array.isArray(motionList)) continue;\r\n          for (const motionDef of motionList) {\r\n            if (!motionDef || typeof motionDef !== 'object') continue;\r\n            if (typeof motionDef.File === 'string') motionDef.File = resolveUrl(motionDef.File);\r\n            if (typeof motionDef.Sound === 'string') motionDef.Sound = resolveUrl(motionDef.Sound);\r\n          }\r\n        }\r\n      }\r\n\r\n      if (Array.isArray(refs.Expressions)) {\r\n        for (const exprDef of refs.Expressions) {\r\n          if (!exprDef || typeof exprDef !== 'object') continue;\r\n          if (typeof exprDef.File === 'string') exprDef.File = resolveUrl(exprDef.File);\r\n        }\r\n      }\r\n    } else {\n      //  Cubism 2.1 model.json\n      if (typeof modifiedModelJson.model === 'string') {\n        modifiedModelJson.model = resolveUrl(modifiedModelJson.model);\n      } else if (typeof modifiedModelJson.Model === 'string') {\n        modifiedModelJson.Model = resolveUrl(modifiedModelJson.Model);\r\n      }\r\n\r\n      const textures = modifiedModelJson.textures || modifiedModelJson.Textures;\r\n      if (Array.isArray(textures)) {\r\n        for (let i = 0; i < textures.length; i++) {\r\n          if (typeof textures[i] === 'string') textures[i] = resolveUrl(textures[i]);\r\n        }\r\n      }\r\n\r\n      if (typeof modifiedModelJson.physics === 'string') modifiedModelJson.physics = resolveUrl(modifiedModelJson.physics);\r\n      if (typeof modifiedModelJson.Physics === 'string') modifiedModelJson.Physics = resolveUrl(modifiedModelJson.Physics);\r\n      if (typeof modifiedModelJson.pose === 'string') modifiedModelJson.pose = resolveUrl(modifiedModelJson.pose);\r\n      if (typeof modifiedModelJson.Pose === 'string') modifiedModelJson.Pose = resolveUrl(modifiedModelJson.Pose);\r\n\r\n      const motions = modifiedModelJson.motions || modifiedModelJson.Motions;\r\n      if (motions && typeof motions === 'object') {\r\n        for (const groupName of Object.keys(motions)) {\r\n          const motionList = motions[groupName];\r\n          if (!Array.isArray(motionList)) continue;\r\n          for (const motionDef of motionList) {\r\n            if (!motionDef || typeof motionDef !== 'object') continue;\r\n            if (typeof motionDef.file === 'string') motionDef.file = resolveUrl(motionDef.file);\r\n            if (typeof motionDef.File === 'string') motionDef.File = resolveUrl(motionDef.File);\r\n            if (typeof motionDef.sound === 'string') motionDef.sound = resolveUrl(motionDef.sound);\r\n            if (typeof motionDef.Sound === 'string') motionDef.Sound = resolveUrl(motionDef.Sound);\r\n          }\r\n        }\r\n      }\r\n\r\n      const expressions = modifiedModelJson.expressions || modifiedModelJson.Expressions;\r\n      if (Array.isArray(expressions)) {\n        for (const exprDef of expressions) {\n          if (!exprDef || typeof exprDef !== 'object') continue;\n          if (typeof exprDef.file === 'string') exprDef.file = resolveUrl(exprDef.file);\n          if (typeof exprDef.File === 'string') exprDef.File = resolveUrl(exprDef.File);\n        }\n      }\n    }\n\n    let runtimeHint = this._setRuntimeInfo({\n      ...this._runtimeInfo,\n      modelJson: modifiedModelJson,\n    });\n\n    if (modifiedModelJson?.FileReferences?.Moc) {\n      const remoteMocUrl = String(modifiedModelJson.FileReferences.Moc || '').trim();\n      if (remoteMocUrl) {\n        try {\n          const mocResponse = await this._fetchWithTimeout(\n            remoteMocUrl,\n            { method: 'GET', cache: 'no-store' },\n            12000,\n          );\n          if (mocResponse.ok) {\n            const mocBuffer = await mocResponse.arrayBuffer();\n            runtimeHint = await this._detectRuntimeFromMoc3(mocBuffer, runtimeHint);\n          } else {\n            warn(` moc3 HTTP ${mocResponse.status}`, remoteMocUrl);\n          }\n        } catch (mocProbeError) {\n          warn(' moc3 ', mocProbeError);\n        }\n      }\n    } else {\n      runtimeHint = this._setRuntimeInfo({\n        ...runtimeHint,\n        runtimeType: LIVE2D_RUNTIME_TYPES.LEGACY,\n        cubismVersion: runtimeHint.cubismVersion ?? 2,\n      });\n    }\n\n    log(' runtime ', {\n      sourceModelUrl,\n      runtimeType: runtimeHint.runtimeType,\n      cubismVersion: runtimeHint.cubismVersion,\n      moc3Version: (runtimeHint as any)?.moc3Version ?? null,\n    });\n\n    //  model json/\n    this._lastModelJson = modifiedModelJson;\n    this._lastModelJsonSourceUrl = sourceModelUrl;\n\n    //  data URL\n    const modelJsonStr = JSON.stringify(modifiedModelJson);\n    const modelJsonBase64 = btoa(unescape(encodeURIComponent(modelJsonStr)));\n    return `data:application/json;base64,${modelJsonBase64}`;\n  },\n\r\n  /**\n   *  PIXI \n   */\n  mountToStage(stageWidth: number, stageHeight: number, scale: number): void {\n    if (!this.model) return;\n\r\n    const stage = Live2DStage.getStage();\r\n    if (!stage) return;\r\n\r\n    // \n    while (stage.children.length > 0) {\n      stage.removeChildAt(0);\n    }\r\n\r\n    const transform = this._applyStageTransform(stageWidth, stageHeight, scale);\n    if (!transform) return;\n\n    stage.addChild(this.model);\n\n    try {\n      if ('autoUpdate' in this.model) {\n        (this.model as any).autoUpdate = true;\n      }\n    } catch {\n      // ignore\n    }\n\n    log('', {\n      stageWidth: transform.stageWidth,\n      stageHeight: transform.stageHeight,\n      scale: transform.finalScale,\n      modelWidth: transform.modelWidth,\n      modelHeight: transform.modelHeight,\n    });\n\r\n    //  idle\r\n    if (this.autoMotionLoopEnabled) {\r\n      this._startAutoMotionLoop();\r\n    } else {\r\n      this._clearAutoMotionLoop();\r\n    }\r\n  },\r\n\r\n  /**\n   * \n   */\n  updateScale(stageWidth: number, stageHeight: number, scale: number): void {\n    if (!this.model) return;\n    this._applyStageTransform(stageWidth, stageHeight, scale);\n  },\n\r\n  /**\n   * \n   */\n  _getModelBaseSize(): { width: number; height: number } {\n    if (this.modelBaseBounds) {\n      return {\n        width: this.modelBaseBounds.width,\n        height: this.modelBaseBounds.height,\n      };\n    }\n\n    if (this.modelBaseWidth && this.modelBaseHeight) {\n      return {\n        width: this.modelBaseWidth,\n        height: this.modelBaseHeight,\r\n      };\r\n    }\r\n\r\n    if (!this.model) {\r\n      return { width: 500, height: 800 };\r\n    }\r\n\r\n    const scaleX = this.model.scale?.x || 1;\r\n    const scaleY = this.model.scale?.y || 1;\r\n    const width = this.model.width > 0 && scaleX !== 0 ? this.model.width / scaleX : 500;\r\n    const height = this.model.height > 0 && scaleY !== 0 ? this.model.height / scaleY : 800;\r\n\r\n    return { width, height };\r\n  },\r\n\r\n  /**\n   * \n   */\n  getExpressions(): string[] {\n    if (!this.model) return [];\n    try {\n      const names = collectExpressionNames(this.model);\n      if (names.length > 0) return names;\n\n      const cached = this._lastModelJson;\n      if (cached) {\n        const fallbackNames = collectExpressionNamesFromUnknown(cached);\n        if (fallbackNames.length > 0) return fallbackNames;\n      }\n\n      return [];\n    } catch (e) {\n      warn('', e);\n      return [];\n    }\n  },\n\r\n  /**\n   * \n   */\n  getMotionGroups(): Record<string, number> {\n    const groups: Record<string, number> = {};\n    if (!this.model) return groups;\n\n    const mergeGroupMap = (source: Record<string, number> | null | undefined): void => {\n      if (!source || typeof source !== 'object') return;\n      for (const [name, count] of Object.entries(source)) {\n        const keyRaw = String(name ?? '');\n        const keyTrimmed = keyRaw.trim();\n        if (!keyTrimmed && keyRaw !== '') continue;\n        const groupName = keyTrimmed || '';\n        const parsedCount = Number(count);\n        const safeCount = Number.isFinite(parsedCount) && parsedCount > 0 ? Math.max(1, Math.floor(parsedCount)) : 1;\n        const prev = groups[groupName];\n        groups[groupName] = Number.isFinite(prev) && prev > 0 ? Math.max(prev, safeCount) : safeCount;\n      }\n    };\n\n    const motionManager = this.model?.internalModel?.motionManager as any;\n    const defs = motionManager?.definitions;\n    if (defs && typeof defs === 'object') {\n      for (const [group, motions] of Object.entries(defs)) {\n        if (Array.isArray(motions)) {\n          groups[group] = motions.length;\n        }\n      }\n    }\n\n    try {\n      const groupNames = collectMotionGroupNames(this.model);\n      for (const groupName of groupNames) {\n        if (!Object.prototype.hasOwnProperty.call(groups, groupName)) {\n          groups[groupName] = 1;\n        } else if (!Number.isFinite(groups[groupName]) || groups[groupName] <= 0) {\n          groups[groupName] = 1;\n        }\n      }\n    } catch (e) {\n      warn('', e);\n    }\n\n    try {\n      mergeGroupMap(collectMotionGroupCountsFromUnknown(this.model?.internalModel?.settings));\n      mergeGroupMap(collectMotionGroupCountsFromUnknown(this.model?.internalModel?.motionManager?.settings));\n    } catch (e) {\n      warn('', e);\n    }\n\n    try {\n      const cached = this._lastModelJson;\n      if (cached) {\n        mergeGroupMap(collectMotionGroupCountsFromUnknown(cached));\n      }\n    } catch (e) {\n      warn('', e);\n    }\n    return groups;\n  },\n\n  /**\n   *  +  group/index\n   */\n  getMotions(): Live2DMotionEntry[] {\n    if (!this.model) return [];\n\n    try {\n      const merged: Live2DMotionEntry[] = [];\n      const seen = new Set<string>();\n\n      const pushAll = (items: Live2DMotionEntry[]) => {\n        for (const item of Array.isArray(items) ? items : []) {\n          const group = String(item?.group ?? '');\n          const indexRaw = Number(item?.index);\n          const index = Number.isFinite(indexRaw) ? Math.max(0, Math.floor(indexRaw)) : 0;\n          const name = String(item?.name ?? '').trim();\n          if (!name) continue;\n          const key = `${group}#${index}#${name.toLowerCase()}`;\n          if (seen.has(key)) continue;\n          seen.add(key);\n          merged.push({ group, index, name });\n        }\n      };\n\n      pushAll(collectMotionEntries(this.model));\n\n      const cached = this._lastModelJson;\n      if (cached) {\n        const cachedAny = cached as any;\n        const motionsContainer =\n          cachedAny?.FileReferences?.Motions ?? cachedAny?.Motions ?? cachedAny?.motions ?? null;\n        if (motionsContainer) {\n          pushAll(\n            collectMotionEntries({\n              internalModel: { motionManager: { definitions: motionsContainer }, settings: cached },\n            } as any),\n          );\n        }\n      }\n\n      return merged;\n    } catch (e) {\n      warn('', e);\n      return [];\n    }\n  },\n\n  _getCoreModel(): any | null {\n    return this.model?.internalModel?.coreModel ?? null;\n  },\n\n  _getBuiltinParameterAliases(paramId: string): string[] {\n    const pid = String(paramId || '').trim();\n    if (!pid) return [];\n\n    const aliasMap: Record<string, string[]> = {\n      ParamAngleX: ['ParamAngleX', 'PARAM_ANGLE_X', 'PARAM_HEAD_X'],\n      ParamAngleY: ['ParamAngleY', 'PARAM_ANGLE_Y', 'PARAM_HEAD_Y'],\n      ParamAngleZ: ['ParamAngleZ', 'PARAM_ANGLE_Z', 'PARAM_HEAD_Z'],\n      ParamEyeLOpen: ['ParamEyeLOpen', 'PARAM_EYE_L_OPEN', 'PARAM_EYE_OPEN', 'ParamEyeOpen'],\n      ParamEyeROpen: ['ParamEyeROpen', 'PARAM_EYE_R_OPEN', 'PARAM_EYE_OPEN', 'ParamEyeOpen'],\n      ParamEyeLSmile: ['ParamEyeLSmile', 'PARAM_EYE_L_SMILE', 'PARAM_EYE_SMILE'],\n      ParamEyeRSmile: ['ParamEyeRSmile', 'PARAM_EYE_R_SMILE', 'PARAM_EYE_SMILE'],\n      ParamEyeBallX: ['ParamEyeBallX', 'PARAM_EYE_BALL_X'],\n      ParamEyeBallY: ['ParamEyeBallY', 'PARAM_EYE_BALL_Y'],\n      ParamBrowLY: ['ParamBrowLY', 'PARAM_BROW_L_Y', 'PARAM_BROW_Y'],\n      ParamBrowRY: ['ParamBrowRY', 'PARAM_BROW_R_Y', 'PARAM_BROW_Y'],\n      ParamBrowLX: ['ParamBrowLX', 'PARAM_BROW_L_X', 'PARAM_BROW_X'],\n      ParamBrowRX: ['ParamBrowRX', 'PARAM_BROW_R_X', 'PARAM_BROW_X'],\n      ParamBrowLAngle: ['ParamBrowLAngle', 'PARAM_BROW_L_ANGLE', 'PARAM_BROW_ANGLE'],\n      ParamBrowRAngle: ['ParamBrowRAngle', 'PARAM_BROW_R_ANGLE', 'PARAM_BROW_ANGLE'],\n      ParamBrowLForm: ['ParamBrowLForm', 'PARAM_BROW_L_FORM', 'PARAM_BROW_FORM'],\n      ParamBrowRForm: ['ParamBrowRForm', 'PARAM_BROW_R_FORM', 'PARAM_BROW_FORM'],\n      ParamMouthForm: ['ParamMouthForm', 'PARAM_MOUTH_FORM', 'PARAM_MOUTH_SHAPE'],\n      ParamMouthOpenY: ['ParamMouthOpenY', 'PARAM_MOUTH_OPEN_Y', 'ParamMouthOpen', 'PARAM_MOUTH_OPEN'],\n      ParamCheek: ['ParamCheek', 'PARAM_CHEEK', 'PARAM_BLUSH'],\n      ParamBodyAngleX: ['ParamBodyAngleX', 'PARAM_BODY_ANGLE_X'],\n      ParamBodyAngleY: ['ParamBodyAngleY', 'PARAM_BODY_ANGLE_Y'],\n      ParamBodyAngleZ: ['ParamBodyAngleZ', 'PARAM_BODY_ANGLE_Z'],\n    };\n\n    const mapped = aliasMap[pid] || [pid];\n    const deduped: string[] = [];\n    const seen = new Set<string>();\n    for (const candidate of mapped) {\n      const value = String(candidate || '').trim();\n      if (!value || seen.has(value)) continue;\n      seen.add(value);\n      deduped.push(value);\n    }\n    return deduped;\n  },\n\n  _getBuiltinParamFallbackRange(paramId: string): { min: number; max: number } | null {\n    const id = String(paramId || '').trim().toLowerCase();\n    if (!id) return null;\n    if (id.includes('mouthopen') || id === 'parama') {\n      return { min: 0, max: 1 };\n    }\n    if (id.includes('open') || id.includes('smile') || id.includes('cheek')) {\n      return { min: 0, max: 1 };\n    }\n    return { min: -1, max: 1 };\n  },\n\n  _getCoreParameterIndex(coreModel: any, paramId: string): number {\n    if (!coreModel) return -1;\n    const pid = String(paramId || '').trim();\n    if (!pid) return -1;\n\n    try {\n      if (typeof coreModel.getParameterIndex === 'function') {\n        const idx = Number(coreModel.getParameterIndex(pid));\n        if (Number.isFinite(idx) && idx >= 0) return idx;\n      }\n    } catch {\n      // ignore\n    }\n\n    try {\n      if (typeof coreModel.getParamIndex === 'function') {\n        const idx = Number(coreModel.getParamIndex(pid));\n        if (Number.isFinite(idx) && idx >= 0) return idx;\n      }\n    } catch {\n      // ignore\n    }\n\n    try {\n      if (typeof coreModel.getParameterCount === 'function' && typeof coreModel.getParameterId === 'function') {\n        const count = Number(coreModel.getParameterCount()) || 0;\n        const lower = pid.toLowerCase();\n        for (let i = 0; i < count; i++) {\n          const id = String(coreModel.getParameterId(i) || '').trim();\n          if (!id) continue;\n          if (id.toLowerCase() === lower) return i;\n        }\n      }\n    } catch {\n      // ignore\n    }\n\n    return -1;\n  },\n\n  _getCoreParameterRange(coreModel: any, paramId: string, paramIndex = -1): { min: number; max: number } {\n    let min = Number.NaN;\n    let max = Number.NaN;\n    const pid = String(paramId || '').trim();\n    const idx = Number.isFinite(paramIndex) ? paramIndex : -1;\n\n    const asNumber = (value: unknown): number => {\n      const parsed = Number(value);\n      return Number.isFinite(parsed) ? parsed : Number.NaN;\n    };\n\n    if (idx >= 0) {\n      try {\n        if (typeof coreModel.getParameterMinimumValue === 'function') {\n          min = asNumber(coreModel.getParameterMinimumValue(idx));\n        }\n      } catch {\n        // ignore\n      }\n      try {\n        if (typeof coreModel.getParameterMaximumValue === 'function') {\n          max = asNumber(coreModel.getParameterMaximumValue(idx));\n        }\n      } catch {\n        // ignore\n      }\n    }\n\n    if (!Number.isFinite(min)) {\n      try {\n        if (typeof coreModel.getParamMin === 'function') {\n          min = asNumber(coreModel.getParamMin(pid));\n        }\n      } catch {\n        // ignore\n      }\n    }\n    if (!Number.isFinite(max)) {\n      try {\n        if (typeof coreModel.getParamMax === 'function') {\n          max = asNumber(coreModel.getParamMax(pid));\n        }\n      } catch {\n        // ignore\n      }\n    }\n\n    if (!Number.isFinite(min) || !Number.isFinite(max) || max <= min) {\n      const fallback = this._getBuiltinParamFallbackRange(pid);\n      if (fallback) {\n        if (!Number.isFinite(min)) min = fallback.min;\n        if (!Number.isFinite(max) || max <= min) max = fallback.max;\n      }\n    }\n\n    if (!Number.isFinite(min)) min = 0;\n    if (!Number.isFinite(max) || max <= min) max = min + 1;\n    return { min, max };\n  },\n\n  _mapBuiltinNormalizedValue(normalizedValue: unknown, min: number, max: number): number | null {\n    const normalized = Number(normalizedValue);\n    if (!Number.isFinite(normalized)) return null;\n\n    if (min < 0 && max > 0) {\n      const clamped = Math.max(-1, Math.min(1, normalized));\n      return clamped >= 0 ? clamped * max : clamped * Math.abs(min);\n    }\n\n    const clampedUnit = Math.max(0, Math.min(1, normalized));\n    return min + (max - min) * clampedUnit;\n  },\n\n  _writeCoreParameterById(coreModel: any, paramId: string, value: number, weight = 1): boolean {\n    const pid = String(paramId || '').trim();\n    if (!pid || !coreModel || !Number.isFinite(value)) return false;\n    const safeWeight = Number.isFinite(weight) ? Math.max(0, Math.min(1, Number(weight))) : 1;\n    const paramIndex = this._getCoreParameterIndex(coreModel, pid);\n    const targetValue = Number(value);\n\n    const tryInvoke = (method: string, ...args: unknown[]): boolean => {\n      const fn = coreModel?.[method];\n      if (typeof fn !== 'function') return false;\n      try {\n        fn.apply(coreModel, args);\n        return true;\n      } catch {\n        return false;\n      }\n    };\n\n    if (paramIndex >= 0) {\n      if (tryInvoke('setParameterValueByIndex', paramIndex, targetValue, safeWeight)) return true;\n      if (tryInvoke('addParameterValueByIndex', paramIndex, targetValue, safeWeight)) return true;\n      if (tryInvoke('setParameterValue', paramIndex, targetValue, safeWeight)) return true;\n      if (tryInvoke('addParameterValue', paramIndex, targetValue, safeWeight)) return true;\n      if (tryInvoke('setParamFloat', paramIndex, targetValue, safeWeight)) return true;\n      if (tryInvoke('addParamFloat', paramIndex, targetValue, safeWeight)) return true;\n    }\n\n    if (tryInvoke('setParameterValueById', pid, targetValue, safeWeight)) return true;\n    if (tryInvoke('addParameterValueById', pid, targetValue, safeWeight)) return true;\n    if (tryInvoke('setParamFloat', pid, targetValue, safeWeight)) return true;\n    if (tryInvoke('addParamFloat', pid, targetValue, safeWeight)) return true;\n\n    return false;\n  },\n\n  _applyBuiltinNormalizedParam(coreModel: any, paramId: string, normalizedValue: number, weight = 1): boolean {\n    const pid = String(paramId || '').trim();\n    if (!pid || !coreModel) return false;\n    const paramIndex = this._getCoreParameterIndex(coreModel, pid);\n    const range = this._getCoreParameterRange(coreModel, pid, paramIndex);\n    const mapped = this._mapBuiltinNormalizedValue(normalizedValue, range.min, range.max);\n    if (mapped == null || !Number.isFinite(mapped)) return false;\n    return this._writeCoreParameterById(coreModel, pid, Number(mapped), weight);\n  },\n\n  _applyBuiltinParamWithAliases(coreModel: any, paramId: string, normalizedValue: number, weight = 1): boolean {\n    const aliases = this._getBuiltinParameterAliases(paramId);\n    for (const alias of aliases) {\n      if (this._applyBuiltinNormalizedParam(coreModel, alias, normalizedValue, weight)) {\n        return true;\n      }\n    }\n    return false;\n  },\n\n  _setBuiltinMotionFrameState(params: Record<string, number> | null, weight = 1): void {\n    if (!params || typeof params !== 'object' || Object.keys(params).length === 0) {\n      this._builtinMotionFrameState = null;\n      return;\n    }\n    this._builtinMotionFrameState = {\n      params: { ...params },\n      weight: Number.isFinite(weight) ? Number(weight) : 1,\n    };\n  },\n\n  _applyBuiltinPostUpdate(model: any): boolean {\n    const coreModel = model?.internalModel?.coreModel;\n    if (!coreModel) return false;\n    const motionState = this._builtinMotionFrameState;\n    if (!motionState) return false;\n\n    const params = motionState.params && typeof motionState.params === 'object' ? motionState.params : {};\n    const weight = Number.isFinite(motionState.weight) ? motionState.weight : 1;\n    let applied = false;\n    for (const [paramId, normalizedValue] of Object.entries(params)) {\n      if (this._applyBuiltinParamWithAliases(coreModel, paramId, Number(normalizedValue), weight)) {\n        applied = true;\n      }\n    }\n    return applied;\n  },\n\n  applyBuiltinExpression(builtinExpressionKey: string, options: { weight?: number } = {}): boolean {\n    const expressionDef = getBuiltinExpressionByKey(builtinExpressionKey);\n    if (!expressionDef) return false;\n    const coreModel = this._getCoreModel();\n    if (!coreModel) return false;\n\n    const params =\n      expressionDef.parameters && typeof expressionDef.parameters === 'object' ? expressionDef.parameters : {};\n    const weight = Number.isFinite(options.weight) ? Number(options.weight) : 1;\n    let appliedCount = 0;\n\n    for (const [paramId, normalizedValue] of Object.entries(params)) {\n      if (this._applyBuiltinParamWithAliases(coreModel, paramId, Number(normalizedValue), weight)) {\n        appliedCount += 1;\n      }\n    }\n\n    return appliedCount > 0;\n  },\n\n  stopBuiltinMotion(): boolean {\n    const state = this._builtinMotionPlayer;\n    if (!state) {\n      this._setBuiltinMotionFrameState(null);\n      return false;\n    }\n\n    state.stopped = true;\n    const topWindow = this._top() as any;\n    try {\n      if (Number.isFinite(state.rafId)) {\n        (topWindow.cancelAnimationFrame || window.cancelAnimationFrame)?.call(topWindow, state.rafId);\n      }\n    } catch {\n      // ignore\n    }\n\n    const coreModel = this._getCoreModel();\n    const resetParams = state.resetParams && typeof state.resetParams === 'object' ? state.resetParams : null;\n    const resetWeight = Number.isFinite(state.weight) ? Number(state.weight) : 1;\n    if (coreModel && resetParams) {\n      for (const [paramId, normalizedValue] of Object.entries(resetParams)) {\n        this._applyBuiltinParamWithAliases(coreModel, paramId, Number(normalizedValue), resetWeight);\n      }\n    }\n\n    this._setBuiltinMotionFrameState(null);\n    this._builtinMotionPlayer = null;\n    return true;\n  },\n\n  playBuiltinMotion(builtinMotionKey: string, options: { weight?: number; easing?: string } = {}): boolean {\n    const motionDef = getBuiltinMotionByKey(builtinMotionKey);\n    if (!motionDef) return false;\n\n    const model = this.model;\n    const coreModel = this._getCoreModel();\n    if (!model || !coreModel) return false;\n\n    const keyframes = Array.isArray(motionDef.keyframes)\n      ? motionDef.keyframes\n          .map(frame => ({\n            t: Number(frame?.t),\n            params: frame?.params && typeof frame.params === 'object' ? frame.params : {},\n          }))\n          .filter(frame => Number.isFinite(frame.t) && frame.t >= 0 && frame.t <= 1)\n          .sort((a, b) => a.t - b.t)\n      : [];\n    if (keyframes.length === 0) return false;\n\n    this.stopBuiltinMotion();\n    this._ensureLipSyncHooks(model);\n\n    const durationMs = Math.max(120, Number(motionDef.durationMs) || 600);\n    const loop = motionDef.loop === true;\n    const easing = String(options.easing || motionDef.easing || 'linear').trim().toLowerCase();\n    const weight = Number.isFinite(options.weight) ? Number(options.weight) : 1;\n    const topWindow = this._top() as any;\n    const requestFrame: ((callback: FrameRequestCallback) => number) | undefined =\n      topWindow.requestAnimationFrame || window.requestAnimationFrame;\n    if (typeof requestFrame !== 'function') return false;\n    const perfNow = (): number => topWindow.performance?.now?.() ?? Date.now();\n\n    const applyEasing = (value: number): number => {\n      const t = Math.max(0, Math.min(1, Number(value) || 0));\n      if (easing === 'easeout') return 1 - Math.pow(1 - t, 2);\n      if (easing === 'easeinout') {\n        return t < 0.5 ? 2 * t * t : 1 - Math.pow(-2 * t + 2, 2) / 2;\n      }\n      return t;\n    };\n\n    const resetParams =\n      keyframes[0]?.params && typeof keyframes[0].params === 'object'\n        ? { ...(keyframes[0].params as Record<string, number>) }\n        : null;\n    const state: BuiltinMotionPlayerState = {\n      rafId: 0,\n      stopped: false,\n      startedAt: perfNow(),\n      resetParams,\n      weight,\n    };\n    this._builtinMotionPlayer = state;\n\n    const step = () => {\n      const currentState = this._builtinMotionPlayer;\n      if (!currentState || currentState !== state || state.stopped) return;\n      if (!this.model || this.model !== model) {\n        this.stopBuiltinMotion();\n        return;\n      }\n\n      const elapsed = perfNow() - state.startedAt;\n      let progress = elapsed / durationMs;\n      if (loop) {\n        progress = progress % 1;\n      } else {\n        progress = Math.max(0, Math.min(1, progress));\n      }\n      const easedProgress = applyEasing(progress);\n\n      let prevFrame = keyframes[0];\n      let nextFrame = keyframes[keyframes.length - 1];\n      for (let i = 0; i < keyframes.length; i++) {\n        const frame = keyframes[i];\n        if (frame.t <= easedProgress) prevFrame = frame;\n        if (frame.t >= easedProgress) {\n          nextFrame = frame;\n          break;\n        }\n      }\n\n      const frameSpan = Math.max(1e-6, (nextFrame.t - prevFrame.t) || 0);\n      const localAlpha =\n        nextFrame.t === prevFrame.t ? 0 : Math.max(0, Math.min(1, (easedProgress - prevFrame.t) / frameSpan));\n      const paramNames = new Set<string>([\n        ...Object.keys(prevFrame.params || {}),\n        ...Object.keys(nextFrame.params || {}),\n      ]);\n\n      const currentParams: Record<string, number> = {};\n      for (const paramId of paramNames) {\n        const prevValue = Number(prevFrame.params?.[paramId]);\n        const nextValue = Number(nextFrame.params?.[paramId]);\n        const a = Number.isFinite(prevValue) ? prevValue : Number.isFinite(nextValue) ? nextValue : 0;\n        const b = Number.isFinite(nextValue) ? nextValue : a;\n        const blended = a + (b - a) * localAlpha;\n        this._applyBuiltinParamWithAliases(coreModel, paramId, blended, weight);\n        currentParams[paramId] = blended;\n      }\n      state.currentParams = currentParams;\n      this._setBuiltinMotionFrameState(currentParams, weight);\n\n      if (!loop && elapsed >= durationMs) {\n        this.stopBuiltinMotion();\n        return;\n      }\n\n      state.rafId = requestFrame.call(topWindow, step);\n    };\n\n    state.rafId = requestFrame.call(topWindow, step);\n    return true;\n  },\n\n  /**\n   * \n   */\n  playExpression(name?: string): void {\n    if (!this.model) return;\r\n    try {\r\n      if (name) {\r\n        this.model.expression(name);\r\n      } else {\r\n        const expressions = this.getExpressions();\r\n        if (expressions.length > 0) {\r\n          const idx = Math.floor(Math.random() * expressions.length);\r\n          this.model.expression(expressions[idx]);\r\n        }\r\n      }\r\n    } catch (e) {\r\n      warn(':', e);\r\n    }\r\n  },\r\n\r\n  /**\n   * \n   */\n  playMotion(group?: string, index?: number): void {\n    if (!this.model) return;\n    this.stopBuiltinMotion();\n    this._stopCurrentMotion('play-motion');\n    const runMotionWithRuntimeFallback = (groupName: string, motionIndex: number) => {\n      try {\n        this.model.motion(groupName, motionIndex);\n        return;\n      } catch (firstError) {\n        const mm = this.model?.internalModel?.motionManager as any;\n        if (typeof mm?.startMotion === 'function') {\n          mm.startMotion(groupName, motionIndex, 3);\n          return;\n        }\n        if (typeof mm?.startRandomMotion === 'function') {\n          mm.startRandomMotion(groupName, 3);\n          return;\n        }\n        throw firstError;\n      }\n    };\n\n    const tryRecoverByKnownEntries = (): boolean => {\n      try {\n        const motions = this.getMotions();\n        if (!motions.length) return false;\n        const preferred =\n          motions.find((item) => item.group === String(group ?? '') && item.index === (index ?? 0)) ||\n          motions.find((item) => String(item.group || '').trim().toLowerCase() === 'default') ||\n          motions[0];\n        if (!preferred) return false;\n        runMotionWithRuntimeFallback(preferred.group, preferred.index);\n        return true;\n      } catch {\n        return false;\n      }\n    };\n\n    try {\n      //  motions key  \"\"\n      if (typeof group === 'string') {\n        runMotionWithRuntimeFallback(group, index ?? 0);\n      } else {\n        const groups = this.getMotionGroups();\n        const groupNames = Object.keys(groups);\n        if (groupNames.length > 0) {\n          const randGroup = groupNames[Math.floor(Math.random() * groupNames.length)];\n          const count = groups[randGroup];\n          const randIndex = Math.floor(Math.random() * count);\n          runMotionWithRuntimeFallback(randGroup, randIndex);\n        }\n      }\n    } catch (e) {\n      if (typeof group === 'string' && this.model) {\n        const recovered = tryRecoverByKnownEntries();\n        if (recovered) return;\n      }\n      warn(':', e);\n    }\n  },\n\r\n  /**\n   * \n   */\n  playRandomAnimation(): void {\n    this.playExpression();\n    this.playMotion();\n  },\n\n  /**\n   *  client \n   *  focus  no-op\n   */\n  focusByClientPoint(clientX: number, clientY: number, immediate = false): void {\n    const model = this.model;\n    if (!model) return;\n    if (!Number.isFinite(clientX) || !Number.isFinite(clientY)) return;\n\n    try {\n      if (typeof model.focus === 'function') {\n        model.focus(clientX, clientY, immediate);\n        return;\n      }\n    } catch {\n      return;\n    }\n\n    try {\n      const controller = model?.internalModel?.focusController;\n      if (!controller || typeof controller.focus !== 'function') return;\n\n      const rect = Live2DStage.container?.getBoundingClientRect?.();\n      if (!rect || rect.width <= 0 || rect.height <= 0) return;\n\n      const normalizedX = ((clientX - rect.left) / rect.width) * 2 - 1;\n      const normalizedY = ((clientY - rect.top) / rect.height) * 2 - 1;\n      controller.focus(\n        Math.max(-1, Math.min(1, normalizedX)),\n        Math.max(-1, Math.min(1, -normalizedY)),\n        immediate,\n      );\n    } catch {\n      // ignore\n    }\n  },\n\n  /**\n   * \n   */\n  focusCenter(immediate = true): void {\n    const model = this.model;\n    if (!model) return;\n\n    const rect = Live2DStage.container?.getBoundingClientRect?.();\n    if (rect && rect.width > 0 && rect.height > 0) {\n      this.focusByClientPoint(rect.left + rect.width / 2, rect.top + rect.height / 2, immediate);\n      return;\n    }\n\n    try {\n      const controller = model?.internalModel?.focusController;\n      if (!controller || typeof controller.focus !== 'function') return;\n      controller.focus(0, 0, immediate);\n    } catch {\n      // ignore\n    }\n  },\n\n  /**\n   *  TTS \n   * -  galgame  Live2DManager.setMouthOpen\n   * -  model characterId \r\n   */\r\n  setMouthOpen(_characterId: string, value: number): boolean {\r\n    const model = this.model;\r\n    if (!model?.internalModel?.coreModel) return false;\r\n\r\n    const coreModel = model.internalModel.coreModel;\r\n    const clampedValue = Math.max(0, Math.min(1, value));\r\n    this._mouthCurrentValue = clampedValue;\r\n    const topAny = this._top() as any;\n    const logPrefix = '[] LipSync';\n    this._ensureLipSyncHooks(model);\n    this._installCoreWriteMask(coreModel);\n\r\n    const getParamRange = (paramId: string, paramIndex: number): { min: number; max: number } => {\r\n      let min = Number.NaN;\r\n      let max = Number.NaN;\r\n\r\n      const readNumber = (v: any): number => {\r\n        const n = Number(v);\r\n        return Number.isFinite(n) ? n : Number.NaN;\r\n      };\r\n\r\n      if (Number.isFinite(paramIndex) && paramIndex >= 0) {\r\n        try {\r\n          if (typeof coreModel.getParameterMinimumValue === 'function') {\r\n            min = readNumber(coreModel.getParameterMinimumValue(paramIndex));\r\n          }\r\n        } catch {\r\n          // ignore\r\n        }\r\n        try {\r\n          if (typeof coreModel.getParameterMaximumValue === 'function') {\r\n            max = readNumber(coreModel.getParameterMaximumValue(paramIndex));\r\n          }\r\n        } catch {\r\n          // ignore\r\n        }\r\n      }\r\n\r\n      if (!Number.isFinite(min)) {\r\n        try {\r\n          if (typeof coreModel.getParamMin === 'function') {\r\n            min = readNumber(coreModel.getParamMin(paramId));\r\n          }\r\n        } catch {\r\n          // ignore\r\n        }\r\n      }\r\n      if (!Number.isFinite(max)) {\r\n        try {\r\n          if (typeof coreModel.getParamMax === 'function') {\r\n            max = readNumber(coreModel.getParamMax(paramId));\r\n          }\r\n        } catch {\r\n          // ignore\r\n        }\r\n      }\r\n\r\n      if (!Number.isFinite(min)) min = 0;\r\n      if (!Number.isFinite(max) || max <= min) max = 1;\r\n      return { min, max };\r\n    };\r\n\r\n    const mapToParamValue = (paramId: string, paramIndex: number): number => {\r\n      const { min, max } = getParamRange(paramId, paramIndex);\r\n      //  [-x, +x]  0 \r\n      if (min < 0 && max > 0) {\r\n        return clampedValue * max;\r\n      }\r\n      return min + (max - min) * clampedValue;\r\n    };\r\n\r\n    const getIndexById = (paramId: string): number => {\r\n      try {\r\n        if (typeof coreModel.getParameterIndex === 'function') {\r\n          return coreModel.getParameterIndex(paramId);\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.getParamIndex === 'function') {\r\n          return coreModel.getParamIndex(paramId);\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      return -1;\r\n    };\r\n\r\n    const applyById = (paramId: string): boolean => {\r\n      const paramIndex = getIndexById(paramId);\r\n      const mappedValue = mapToParamValue(paramId, paramIndex);\r\n      try {\r\n        if (typeof coreModel.setParameterValueById === 'function') {\r\n          coreModel.setParameterValueById(paramId, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.addParameterValueById === 'function') {\r\n          coreModel.addParameterValueById(paramId, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.setParamFloat === 'function') {\r\n          coreModel.setParamFloat(paramId, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.addParamFloat === 'function') {\r\n          coreModel.addParamFloat(paramId, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      return false;\r\n    };\r\n\r\n    const applyByIndex = (paramIndex: number): boolean => {\r\n      if (!Number.isFinite(paramIndex) || paramIndex < 0) return false;\r\n      const paramId = (() => {\r\n        try {\r\n          if (typeof coreModel.getParameterId === 'function') {\r\n            return String(coreModel.getParameterId(paramIndex) || '');\r\n          }\r\n        } catch {\r\n          // ignore\r\n        }\r\n        return '';\r\n      })();\r\n      const mappedValue = mapToParamValue(paramId || `__idx_${paramIndex}`, paramIndex);\r\n      try {\r\n        if (typeof coreModel.setParameterValueByIndex === 'function') {\r\n          coreModel.setParameterValueByIndex(paramIndex, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.addParameterValueByIndex === 'function') {\r\n          coreModel.addParameterValueByIndex(paramIndex, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.setParameterValue === 'function') {\r\n          coreModel.setParameterValue(paramIndex, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.addParameterValue === 'function') {\r\n          coreModel.addParameterValue(paramIndex, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      return false;\r\n    };\r\n\r\n    const paramNames = [\r\n      'ParamMouthOpenY',\r\n      'PARAM_MOUTH_OPEN_Y',\r\n      'ParamMouthOpen',\r\n      'ParamA',\r\n      'Param58',\r\n      'Param61',\r\n      'Param_Mouth_Open',\r\n      'mouth_open',\r\n    ];\r\n\r\n    let appliedAny = false;\r\n    if (this._manualMouthParamEnabled && this._manualMouthParamIds.length > 0) {\r\n      for (const manualId of this._manualMouthParamIds) {\r\n        const idx = getIndexById(manualId);\r\n        if (applyById(manualId)) appliedAny = true;\r\n        if (applyByIndex(idx)) appliedAny = true;\r\n      }\r\n    }\r\n\r\n    const visited = new Set<string>();\r\n    for (const paramName of paramNames) {\r\n      if (visited.has(paramName)) continue;\r\n      visited.add(paramName);\r\n      const paramIndex = getIndexById(paramName);\r\n      if (paramIndex >= 0) {\r\n        if (applyById(paramName)) appliedAny = true;\r\n        if (applyByIndex(paramIndex)) appliedAny = true;\r\n      }\r\n    }\r\n    if (appliedAny) return true;\r\n\r\n    //  mouth/lip/ParamA\r\n    if (this._mouthParamCore !== coreModel) {\r\n      this._mouthParamCore = coreModel;\r\n      this._mouthParamIds = [];\r\n      this._mouthParamIndexes = [];\r\n      this._mouthParamRangeMins = [];\r\n      this._mouthParamRangeMaxs = [];\r\n      this._mouthParamWarned = false;\r\n      try {\r\n        if (typeof coreModel.getParameterCount === 'function' && typeof coreModel.getParameterId === 'function') {\r\n          const count = Number(coreModel.getParameterCount()) || 0;\r\n          const numericFallback: Array<{ id: string; idx: number; min: number; max: number }> = [];\r\n          for (let i = 0; i < count; i++) {\r\n            const pid = String(coreModel.getParameterId(i) || '');\r\n            const low = pid.toLowerCase();\r\n            const range = getParamRange(pid, i);\r\n            if (low.includes('mouth') || low.includes('lip') || pid === 'ParamA') {\r\n              this._mouthParamIds.push(pid);\r\n              this._mouthParamIndexes.push(i);\r\n              this._mouthParamRangeMins.push(range.min);\r\n              this._mouthParamRangeMaxs.push(range.max);\r\n              continue;\r\n            }\r\n\r\n            // Cubism2  Param58/Param61\r\n            if (/^param\\d+$/i.test(pid) && range.max >= 8 && range.min >= -1) {\r\n              numericFallback.push({ id: pid, idx: i, min: range.min, max: range.max });\r\n            }\r\n          }\r\n\r\n          if (this._mouthParamIds.length === 0 && numericFallback.length > 0) {\r\n            numericFallback.sort((a, b) => b.max - a.max);\r\n            const picked = numericFallback.slice(0, 3);\r\n            for (const item of picked) {\r\n              this._mouthParamIds.push(item.id);\r\n              this._mouthParamIndexes.push(item.idx);\r\n              this._mouthParamRangeMins.push(item.min);\r\n              this._mouthParamRangeMaxs.push(item.max);\r\n            }\r\n            try {\r\n              topAny?.console?.log?.(`${logPrefix}: `, picked);\r\n            } catch {\r\n              // ignore\r\n            }\r\n          }\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    for (let i = 0; i < this._mouthParamIds.length; i++) {\r\n      const pid = this._mouthParamIds[i];\r\n      const pidx = this._mouthParamIndexes[i] ?? -1;\r\n      if (applyById(pid)) appliedAny = true;\r\n      if (applyByIndex(pidx)) appliedAny = true;\r\n    }\r\n    if (appliedAny) return true;\r\n\r\n    if (!this._mouthParamWarned) {\r\n      this._mouthParamWarned = true;\r\n      const msg = `${logPrefix}: `;\r\n      try {\r\n        topAny?.console?.warn?.(msg, {\r\n          presetCandidates: paramNames,\r\n          scannedIds: this._mouthParamIds,\r\n        });\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    return false;\r\n  },\r\n\r\n  _isMouthParam(paramIdOrIndex: string | number, coreModel: any): boolean {\r\n    const preset = [\r\n      'parammouthopeny',\r\n      'param_mouth_open_y',\r\n      'parammouthopen',\r\n      'parama',\r\n      'param58',\r\n      'param61',\r\n      'param_mouth_open',\r\n      'mouth_open',\r\n    ];\r\n\r\n    if (typeof paramIdOrIndex === 'number') {\r\n      if (this._mouthParamIndexes.includes(paramIdOrIndex)) return true;\r\n      try {\r\n        if (typeof coreModel?.getParameterId === 'function') {\r\n          const pid = String(coreModel.getParameterId(paramIdOrIndex) || '').trim();\r\n          if (pid) return this._isMouthParam(pid, coreModel);\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      return false;\r\n    }\r\n\r\n    const id = String(paramIdOrIndex || '').trim().toLowerCase();\r\n    if (!id) return false;\r\n\r\n    if (this._manualMouthParamEnabled && this._manualMouthParamIdSet.size > 0) {\r\n      if (this._manualMouthParamIdSet.has(id)) return true;\r\n    }\r\n\r\n    if (preset.includes(id)) return true;\r\n\r\n    return this._mouthParamIds.some(pid => String(pid || '').trim().toLowerCase() === id);\r\n  },\r\n\r\n  _installCoreWriteMask(coreModel: any): void {\r\n    if (!coreModel) return;\r\n    if (this._writeMaskCore === coreModel) return;\r\n\r\n    if (this._writeMaskRestore) {\r\n      try {\r\n        this._writeMaskRestore();\r\n      } catch {\r\n        // ignore\r\n      }\r\n      this._writeMaskCore = null;\r\n      this._writeMaskRestore = null;\r\n    }\r\n\r\n    const restoreEntries: Array<{ method: string; raw: any }> = [];\r\n    const methods = [\r\n      'setParameterValueById',\r\n      'addParameterValueById',\r\n      'setParamFloat',\r\n      'addParamFloat',\r\n      'setParameterValueByIndex',\r\n      'addParameterValueByIndex',\r\n      'setParameterValue',\r\n      'addParameterValue',\r\n    ];\r\n\r\n    const getParamRef = (method: string, args: any[]): string | number | null => {\r\n      if (!Array.isArray(args) || args.length === 0) return null;\r\n      const first = args[0];\r\n      if (method.includes('ById') || method === 'setParamFloat' || method === 'addParamFloat') {\r\n        return typeof first === 'string' ? first : null;\r\n      }\r\n      if (method.includes('ByIndex')) {\r\n        return typeof first === 'number' ? first : null;\r\n      }\r\n      if (method === 'setParameterValue' || method === 'addParameterValue') {\r\n        if (typeof first === 'number' || typeof first === 'string') return first;\r\n      }\r\n      return null;\r\n    };\r\n\r\n    for (const method of methods) {\r\n      const raw = coreModel?.[method];\r\n      if (typeof raw !== 'function') continue;\r\n      restoreEntries.push({ method, raw });\r\n      coreModel[method] = (...args: any[]) => {\r\n        const paramRef = getParamRef(method, args);\r\n        if (\r\n          paramRef !== null &&\r\n          this._lipSyncActive &&\r\n          this._inModelUpdate &&\r\n          this._isMouthParam(paramRef, coreModel)\r\n        ) {\r\n          return undefined;\r\n        }\r\n        return raw.apply(coreModel, args);\r\n      };\r\n    }\r\n\r\n    this._writeMaskCore = coreModel;\r\n    this._writeMaskRestore = () => {\r\n      for (const entry of restoreEntries) {\r\n        try {\r\n          coreModel[entry.method] = entry.raw;\r\n        } catch {\r\n          // ignore\r\n        }\r\n      }\r\n    };\r\n  },\r\n\r\n  _ensureLipSyncHooks(model: any): void {\r\n    if (!model) return;\r\n    if (this._updateHookModel === model) return;\r\n\r\n    if (this._updateHookRestore) {\r\n      try {\r\n        this._updateHookRestore();\r\n      } catch {\r\n        // ignore\r\n      }\r\n      this._updateHookRestore = null;\r\n      this._updateHookModel = null;\r\n    }\r\n\r\n    const internal = model?.internalModel;\r\n    const updater = internal?.update;\r\n    if (typeof updater !== 'function') return;\r\n\r\n    const rawUpdate = updater.bind(internal);\r\n    const self = this;\r\n    internal.update = function (...args: any[]) {\n      self._inModelUpdate = true;\n      let ret: any;\n      try {\n        ret = rawUpdate(...args);\n      } finally {\n        self._inModelUpdate = false;\n        try {\n          self._applyBuiltinPostUpdate(model);\n        } catch {\n          // ignore\n        }\n        if (self._lipSyncActive) {\n          try {\n            self._applyMouthValueToModel(model);\n          } catch {\n            // ignore\n          }\r\n        }\r\n      }\r\n      return ret;\r\n    };\r\n\r\n    this._updateHookModel = model;\r\n    this._updateHookRestore = () => {\r\n      try {\r\n        internal.update = updater;\r\n      } catch {\r\n        // ignore\r\n      }\r\n    };\r\n  },\r\n\r\n  _applyMouthValueToModel(model: any): boolean {\r\n    if (!model?.internalModel?.coreModel) return false;\r\n    const targetValue = Math.max(0, Math.min(1, this._mouthCurrentValue || 0));\r\n    const oldValue = this._mouthCurrentValue;\r\n    this._mouthCurrentValue = targetValue;\r\n    const applied = this.setMouthOpen('__mouth_hook__', targetValue);\r\n    this._mouthCurrentValue = oldValue;\r\n    return applied;\r\n  },\r\n\r\n  _getMouthParamSource(): 'manual' | 'auto' {\r\n    if (this._manualMouthParamEnabled && this._manualMouthParamIdSet.size > 0) {\r\n      return 'manual';\r\n    }\r\n    return 'auto';\r\n  },\r\n\r\n  getLipSyncDebugInfo(): {\n    lipSyncOverride: 'active' | 'inactive';\n    mouthParamsSource: 'manual' | 'auto';\n    mouthParamsCount: number;\n  } {\n    this._refreshManualMouthParams();\n    const source = this._getMouthParamSource();\n    const count = source === 'manual' ? this._manualMouthParamIdSet.size : this._mouthParamIds.length;\n    return {\n      lipSyncOverride: this._lipSyncActive ? 'active' : 'inactive',\n      mouthParamsSource: source,\r\n      mouthParamsCount: count,\r\n    };\r\n  },\r\n\r\n  /**\n   * \n   */\n  destroyModel(): void {\n    this._clearAutoMotionLoop();\n    this.stopBuiltinMotion();\n    this._setBuiltinMotionFrameState(null);\n    this._lipSyncActive = false;\n    this._inModelUpdate = false;\n\n    if (this.model) {\r\n      try {\r\n        if (this.model.parent) {\r\n          this.model.parent.removeChild(this.model);\r\n        }\r\n        this.model.destroy();\r\n      } catch (e) {\r\n        warn('', e);\r\n      }\r\n      this.model = null;\r\n    }\r\n    this._mouthParamCore = null;\r\n    this._mouthParamIds = [];\r\n    this._mouthParamIndexes = [];\r\n    this._mouthParamRangeMins = [];\r\n    this._mouthParamRangeMaxs = [];\r\n    this._mouthParamWarned = false;\r\n    this._mouthCurrentValue = 0;\r\n    if (this._writeMaskRestore) {\r\n      try {\r\n        this._writeMaskRestore();\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n    this._writeMaskCore = null;\r\n    this._writeMaskRestore = null;\r\n    if (this._updateHookRestore) {\r\n      try {\r\n        this._updateHookRestore();\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n    this._updateHookModel = null;\r\n    this._updateHookRestore = null;\r\n    this._manualMouthParamEnabled = false;\n    this._manualMouthParamIds = [];\n    this._manualMouthParamIdSet.clear();\n    this._builtinMotionPlayer = null;\n    this._builtinMotionFrameState = null;\n    this.modelBaseWidth = null;\n    this.modelBaseHeight = null;\n    this.modelBaseBounds = null;\n    this._lastModelJson = null;\n    this._lastModelJsonSourceUrl = '';\n    this._revokeLocalBlobUrls();\n  },\n\r\n  /**\n   * \n   */\n  async _waitForTextures(\n    model: any,\r\n    onProgress?: (loadedCount: number, totalCount: number) => void,\r\n  ): Promise<boolean> {\r\n    return new Promise((resolve) => {\r\n      let retryCount = 0;\r\n      const maxRetries = 80;\r\n\r\n      const check = () => {\r\n        retryCount++;\r\n        if (retryCount > maxRetries) {\r\n          const internal = model.internalModel;\r\n          const textures = internal?.textures || internal?._textures || [];\r\n          const textureList = Array.isArray(textures) ? textures : [];\r\n          const loadedCount = textureList.filter((tex: any) => !!tex?.baseTexture?.valid).length;\r\n          onProgress?.(loadedCount, textureList.length);\r\n          warn(` (${loadedCount}/${textureList.length})`);\r\n          resolve(false);\r\n          return;\r\n        }\r\n\r\n        const internal = model.internalModel;\r\n        if (!internal) {\r\n          setTimeout(check, 100);\r\n          return;\r\n        }\r\n\r\n        const textures = internal.textures || internal._textures || [];\r\n        if (textures.length === 0) {\r\n          onProgress?.(1, 1);\r\n          resolve(true);\r\n          return;\r\n        }\r\n\r\n        const loadedCount = textures.filter((tex: any) => {\r\n          if (!tex) return false;\r\n          if (tex.baseTexture) return tex.baseTexture.valid;\r\n          return true;\r\n        }).length;\r\n        onProgress?.(loadedCount, textures.length);\r\n\r\n        const allLoaded = textures.every((tex: any) => {\r\n          if (!tex) return false;\r\n          if (tex.baseTexture) return tex.baseTexture.valid;\r\n          return true;\r\n        });\r\n\r\n        if (allLoaded) {\r\n          resolve(true);\r\n        } else {\r\n          setTimeout(check, 100);\r\n        }\r\n      };\r\n\r\n      check();\r\n    });\r\n  },\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import { SCRIPT_NAME } from '../core/constants';\nimport { Live2DManager } from './manager';\n\n// : TTSManager._getProxiedAudioUrl ( audio/tts-manager.ts)\nlet _ttsGetProxiedAudioUrlRef: ((url: string) => string) | null = null;\nexport function setLipSyncRefs({ getProxiedAudioUrl }: { getProxiedAudioUrl?: (url: string) => string }): void {\n  if (getProxiedAudioUrl) _ttsGetProxiedAudioUrlRef = getProxiedAudioUrl;\n}\n\nfunction getTopWindow(): Window {\n  try {\n    return window.parent ?? window;\n  } catch {\n    return window;\n  }\n}\n\n// ============================================\n// LipSync  ()\n// : galgame/src/live2d/lip-sync.js\n// ============================================\nexport const LipSyncManager = {\n  audioContext: null as AudioContext | null,\n  analyser: null as AnalyserNode | null,\n  dataArray: null as Uint8Array | null,\n  source: null as MediaElementAudioSourceNode | null,\n  animationFrameId: null as number | null,\n  currentCharacterId: null as string | null,\n  lastVolume: 0,\n  connectedAudioElements: new WeakSet<HTMLAudioElement>(),\n  _proxyAudio: null as HTMLAudioElement | null,\n  _proxyAudioCleanup: null as (() => void) | null,\n\n  config: {\n    fftSize: 256,\n    smoothingFactor: 0.5,\n    sensitivity: 2.5,\n    minThreshold: 0.01,\n  },\n\n  init(): void {\n    if (this.audioContext) {\n      if (this.audioContext.state === 'suspended') {\n        this.audioContext.resume().then(() => {\n          console.log(`[${SCRIPT_NAME}] LipSync: AudioContext `);\n        });\n      }\n      return;\n    }\n\n    const topAny: any = getTopWindow() as any;\n    const AudioContextClass = topAny.AudioContext || topAny.webkitAudioContext;\n    if (!AudioContextClass) {\n      console.warn(`[${SCRIPT_NAME}] LipSync:  Web Audio API`);\n      return;\n    }\n\n    this.audioContext = new AudioContextClass();\n    this.analyser = this.audioContext.createAnalyser();\n    this.analyser.fftSize = this.config.fftSize;\n    this.analyser.smoothingTimeConstant = this.config.smoothingFactor;\n    this.dataArray = new Uint8Array(this.analyser.frequencyBinCount);\n    console.log(`[${SCRIPT_NAME}] LipSyncManager `);\n  },\n\n  _getProxiedAudioUrl(originalUrl: string): string {\n    if (_ttsGetProxiedAudioUrlRef) {\n      return _ttsGetProxiedAudioUrlRef(originalUrl);\n    }\n\n    const topAny: any = getTopWindow() as any;\n\n    if (typeof topAny.getCorsProxyUrl === 'function') {\n      try {\n        const proxied = topAny.getCorsProxyUrl(originalUrl);\n        console.log(`[${SCRIPT_NAME}] LipSync:  getCorsProxyUrl `);\n        return proxied;\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] LipSync: getCorsProxyUrl `, e);\n      }\n    }\n\n    if (typeof topAny.enableCorsProxy === 'function') {\n      try {\n        const proxied = topAny.enableCorsProxy(originalUrl);\n        if (typeof proxied === 'string' && proxied) {\n          console.log(`[${SCRIPT_NAME}] LipSync:  enableCorsProxy `);\n          return proxied;\n        }\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] LipSync: enableCorsProxy `, e);\n      }\n    }\n\n    if (topAny.corsProxy?.getProxyUrl) {\n      try {\n        const proxied = topAny.corsProxy.getProxyUrl(originalUrl);\n        console.log(`[${SCRIPT_NAME}] LipSync:  corsProxy.getProxyUrl `);\n        return proxied;\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] LipSync: corsProxy.getProxyUrl `, e);\n      }\n    }\n\n    if (topAny.location) {\n      const origin = topAny.location.origin;\n      console.log(`[${SCRIPT_NAME}] LipSync:  /proxy`);\n      return `${origin}/proxy?url=${encodeURIComponent(originalUrl)}`;\n    }\n\n    return originalUrl;\n  },\n\n  connectAudio(audioElement: HTMLAudioElement): boolean {\n    if (!audioElement) return false;\n\n    if (this.connectedAudioElements.has(audioElement)) {\n      this.init();\n      if (this.audioContext?.state === 'suspended') {\n        this.audioContext.resume();\n      }\n      return true;\n    }\n\n    this.init();\n    if (!this.audioContext || !this.analyser) return false;\n\n    if (this.audioContext.state === 'suspended') {\n      this.audioContext.resume().catch(e => console.warn('AudioContext resume failed:', e));\n    }\n\n    try {\n      if (this.source) {\n        try {\n          this.source.disconnect();\n        } catch {\n          // ignore\n        }\n      }\n\n      const topAny: any = getTopWindow() as any;\n      let targetAudio: HTMLAudioElement = audioElement;\n      const src = audioElement.src || '';\n      const isLocalhost = src.includes('127.0.0.1') || src.includes('localhost');\n      const isDataUrl = src.startsWith('data:');\n      const isBlobUrl = src.startsWith('blob:');\n      let isSameOrigin = false;\n      try {\n        const base = topAny.location?.origin || window.location.origin;\n        const url = new URL(src, base);\n        isSameOrigin = url.origin === base;\n      } catch {\n        // ignore\n      }\n\n      if (!isLocalhost && !isDataUrl && !isBlobUrl && !isSameOrigin) {\n        console.log(`[${SCRIPT_NAME}] LipSync: `);\n        const proxiedUrl = this._getProxiedAudioUrl(src);\n        if (proxiedUrl && proxiedUrl !== src) {\n          targetAudio = new Audio(proxiedUrl);\n          targetAudio.crossOrigin = 'anonymous';\n          console.log(`[${SCRIPT_NAME}] LipSync: `, proxiedUrl.substring(0, 50) + '...');\n\n          targetAudio.currentTime = audioElement.currentTime;\n          targetAudio.volume = 0.001;\n\n          if (!audioElement.paused) {\n            targetAudio.play().catch(e => {\n              console.warn(`[${SCRIPT_NAME}] LipSync: `, e);\n            });\n          }\n\n          const syncPlay = () => {\n            if (this._proxyAudio && this._proxyAudio.paused) {\n              this._proxyAudio.currentTime = audioElement.currentTime;\n              this._proxyAudio.play().catch(() => {});\n            }\n          };\n          const syncPause = () => {\n            if (this._proxyAudio) {\n              this._proxyAudio.pause();\n            }\n          };\n          const syncSeek = () => {\n            if (this._proxyAudio) {\n              this._proxyAudio.currentTime = audioElement.currentTime;\n            }\n          };\n\n          audioElement.addEventListener('play', syncPlay);\n          audioElement.addEventListener('playing', syncPlay);\n          audioElement.addEventListener('pause', syncPause);\n          audioElement.addEventListener('ended', syncPause);\n          audioElement.addEventListener('seeked', syncSeek);\n\n          this._proxyAudio = targetAudio;\n          this._proxyAudioCleanup = () => {\n            audioElement.removeEventListener('play', syncPlay);\n            audioElement.removeEventListener('playing', syncPlay);\n            audioElement.removeEventListener('pause', syncPause);\n            audioElement.removeEventListener('ended', syncPause);\n            audioElement.removeEventListener('seeked', syncSeek);\n          };\n        }\n      }\n\n      console.log(`[${SCRIPT_NAME}] LipSync: `, targetAudio.src?.substring(0, 50) + '...');\n      this.source = this.audioContext.createMediaElementSource(targetAudio);\n      this.source.connect(this.analyser);\n      this.analyser.connect(this.audioContext.destination);\n      this.connectedAudioElements.add(audioElement);\n      return true;\n    } catch (e) {\n      console.warn(`[${SCRIPT_NAME}] LipSync:  ( Source )`, e);\n      return false;\n    }\n  },\n\n  getVolume(): number {\n    if (!this.analyser || !this.dataArray) return 0;\n    this.analyser.getByteFrequencyData(this.dataArray);\n\n    let sum = 0;\n    const length = Math.floor(this.dataArray.length * 0.75);\n    for (let i = 0; i < length; i++) {\n      sum += this.dataArray[i];\n    }\n    const average = sum / length / 255;\n    return Math.min(1, average * this.config.sensitivity);\n  },\n\n  async startSync(characterId: string): Promise<void> {\n    this.stopSync();\n    this.currentCharacterId = characterId;\n    Live2DManager._setLipSyncActive(true);\n\n    if (this.audioContext?.state === 'suspended') {\n      try {\n        await this.audioContext.resume();\n        console.log(`[${SCRIPT_NAME}] LipSync: AudioContext `);\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] LipSync: AudioContext `, e);\n      }\n    }\n\n    console.log(\n      `[${SCRIPT_NAME}] LipSync:  - characterId=${characterId}, AudioContext.state=${this.audioContext?.state}`,\n    );\n\n    let frameCount = 0;\n    const update = () => {\n      if (!this.currentCharacterId) return;\n\n      let volume = this.getVolume();\n      if (volume < this.config.minThreshold) volume = 0;\n\n      volume = this.lastVolume * 0.4 + volume * 0.6;\n      this.lastVolume = volume;\n\n      frameCount++;\n      if (frameCount % 30 === 0) {\n        console.log(`[${SCRIPT_NAME}] LipSync: =${volume.toFixed(3)}, rawData[0]=${this.dataArray?.[0]}`);\n      }\n\n      Live2DManager.setMouthOpen(this.currentCharacterId, volume);\n      this.animationFrameId = requestAnimationFrame(update);\n    };\n    update();\n  },\n\n  stopSync(): void {\n    if (this.animationFrameId) {\n      cancelAnimationFrame(this.animationFrameId);\n      this.animationFrameId = null;\n    }\n\n    if (this.currentCharacterId) {\n      Live2DManager.setMouthOpen(this.currentCharacterId, 0);\n    }\n    this.currentCharacterId = null;\n    this.lastVolume = 0;\n    Live2DManager._setLipSyncActive(false);\n\n    if (this._proxyAudioCleanup) {\n      try {\n        this._proxyAudioCleanup();\n      } catch {\n        // ignore\n      }\n      this._proxyAudioCleanup = null;\n    }\n\n    if (this._proxyAudio) {\n      try {\n        this._proxyAudio.pause();\n        this._proxyAudio.src = '';\n      } catch {\n        // ignore\n      }\n      this._proxyAudio = null;\n    }\n  },\n\n  cleanup(): void {\n    this.stopSync();\n    if (this.source) {\n      try {\n        this.source.disconnect();\n      } catch {\n        // ignore\n      }\n      this.source = null;\n    }\n  },\n};\n","import { SCRIPT_NAME } from '../core/constants';\nimport { useSettingsStore } from '../core/settings';\nimport { Live2DManager } from '../live2d/manager';\nimport { LipSyncManager } from '../live2d/lip-sync';\nimport { TTS_PROVIDER, getTTSProvider, getGptSoVitsConfig, getCharacterTTSVoice, resolveVoiceByName, inferResourceId, normalizeGptSoVitsSwitchMode, } from './tts-config';\nimport { synthesizeToBlob } from './edge-tts-direct';\nfunction getTopWindow() {\n    try {\n        return window.parent ?? window;\n    }\n    catch {\n        return window;\n    }\n}\nfunction getSettingsSnapshot() {\n    try {\n        const store = useSettingsStore();\n        return store.settings;\n    }\n    catch {\n        return {};\n    }\n}\n// : showToast ( UI )\nlet _showToastRef = null;\nexport function setTTSManagerRefs({ showToast }) {\n    if (showToast)\n        _showToastRef = showToast;\n}\nfunction showToast(msg) {\n    if (_showToastRef) {\n        _showToastRef(msg);\n        return;\n    }\n    try {\n        const topAny = getTopWindow();\n        const t = topAny?.toastr || window?.toastr;\n        if (t?.info) {\n            t.info(msg);\n            return;\n        }\n    }\n    catch {\n        // ignore\n    }\n    console.log(`[${SCRIPT_NAME}]`, msg);\n}\nfunction clipText(text, max = 160) {\n    const value = String(text || '');\n    if (value.length <= max)\n        return value;\n    return `${value.slice(0, max)}...`;\n}\nfunction isProxyNotFound(status, bodyText = '') {\n    if (status !== 404)\n        return false;\n    const body = String(bodyText || '').toLowerCase();\n    return body.includes('not found') || body.includes('/proxy') || body.includes('cannot get');\n}\nfunction safeUrl(input) {\n    try {\n        return new URL(String(input || ''));\n    }\n    catch {\n        return null;\n    }\n}\nfunction safeArray(value) {\n    return Array.isArray(value) ? value : [];\n}\nfunction safeObject(value) {\n    return (value && typeof value === 'object' && !Array.isArray(value) ? value : {});\n}\nfunction normalizePathSepForGpt(path) {\n    return String(path || '').replace(/\\\\+/g, '/').trim();\n}\nfunction looksLikeAbsoluteFsPath(path) {\n    const text = String(path || '');\n    return /^[a-zA-Z]:[\\\\/]/.test(text) || text.startsWith('/');\n}\nfunction hasLive2D() {\n    return !!Live2DManager.model;\n}\nexport const TTSManager = {\n    enabled: true,\n    provider: TTS_PROVIDER.LITTLEWHITEBOX,\n    autoPlay: true,\n    isPlaying: false,\n    isLoading: false,\n    currentAudio: null,\n    currentSegmentId: null,\n    littleWhiteBox: null,\n    xiaobaixTts: null,\n    _gptSoVitsResolvedProxyRoute: '',\n    _gptSoVitsActiveWeights: { gpt: '', sovits: '' },\n    _gptSoVitsWeightSwitchUnavailable: false,\n    _gptSoVitsWeightSwitchWarned: false,\n    _gptSoVitsProxyWarned: false,\n    _gptSoVitsFetchController: null,\n    _edgeDirectFetchController: null,\n    _edgeDirectSocket: null,\n    _edgeDirectObjectUrl: '',\n    _refreshProviderState() {\n        const provider = getTTSProvider();\n        this.provider = provider;\n        this.autoPlay = getSettingsSnapshot()?.ttsAutoPlay !== false;\n        const topAny = getTopWindow();\n        if (provider === TTS_PROVIDER.LITTLEWHITEBOX) {\n            this.xiaobaixTts = null;\n            this.littleWhiteBox = null;\n            if (topAny?.xiaobaixTts) {\n                this.xiaobaixTts = topAny.xiaobaixTts;\n                console.log(`[${SCRIPT_NAME}] TTSManager:  xiaobaixTts`);\n            }\n            else if (topAny?.LittleWhiteBox) {\n                this.littleWhiteBox = topAny.LittleWhiteBox;\n                console.log(`[${SCRIPT_NAME}] TTSManager:  LittleWhiteBox`);\n            }\n            if (!this.xiaobaixTts && !this.littleWhiteBox) {\n                console.warn(`[${SCRIPT_NAME}] TTSManager:  xiaobaixTts/LittleWhiteBoxTTS`);\n                this.enabled = false;\n                return false;\n            }\n            this.enabled = true;\n            return true;\n        }\n        if (provider === TTS_PROVIDER.GPT_SOVITS_V2) {\n            this.enabled = true;\n            return true;\n        }\n        if (provider === TTS_PROVIDER.EDGE_TTS_DIRECT) {\n            this.enabled = true;\n            return true;\n        }\n        this.enabled = true;\n        return true;\n    },\n    _onPlaybackEnded(reason = 'unknown') {\n        this._cleanupEdgeDirectResources();\n        console.log(`[${SCRIPT_NAME}] TTS:  - reason=${reason}`);\n        this.isPlaying = false;\n        this.isLoading = false;\n        this.currentAudio = null;\n        this.currentSegmentId = null;\n        this.hideLoadingIndicator();\n        LipSyncManager.stopSync();\n    },\n    init() {\n        this._refreshProviderState();\n        try {\n            const topAny = getTopWindow();\n            const jq = topAny?.jQuery || topAny?.$;\n            if (jq) {\n                jq(topAny).on('tts_complete tts_end', () => {\n                    this._onPlaybackEnded('littlewhitebox_event');\n                });\n            }\n        }\n        catch {\n            // ignore\n        }\n    },\n    showLoadingIndicator() {\n        try {\n            const top = getTopWindow();\n            top.document.getElementById('desktop-pet-stage')?.classList.add('desktop-pet-tts-active');\n        }\n        catch {\n            // ignore\n        }\n    },\n    hideLoadingIndicator() {\n        try {\n            const top = getTopWindow();\n            top.document.getElementById('desktop-pet-stage')?.classList.remove('desktop-pet-tts-active');\n        }\n        catch {\n            // ignore\n        }\n    },\n    _abortGptSoVitsFetch(reason = 'manual') {\n        if (this._gptSoVitsFetchController) {\n            try {\n                this._gptSoVitsFetchController.abort(reason);\n            }\n            catch {\n                // ignore\n            }\n            this._gptSoVitsFetchController = null;\n        }\n    },\n    _cleanupEdgeDirectResources() {\n        if (this._edgeDirectFetchController) {\n            try {\n                this._edgeDirectFetchController.abort('cleanup');\n            }\n            catch {\n                // ignore\n            }\n            this._edgeDirectFetchController = null;\n        }\n        if (this._edgeDirectSocket) {\n            try {\n                this._edgeDirectSocket.close(1000, 'cleanup');\n            }\n            catch {\n                // ignore\n            }\n            this._edgeDirectSocket = null;\n        }\n        if (this._edgeDirectObjectUrl) {\n            try {\n                URL.revokeObjectURL(this._edgeDirectObjectUrl);\n            }\n            catch {\n                // ignore\n            }\n            this._edgeDirectObjectUrl = '';\n        }\n    },\n    stop() {\n        if (!this.isPlaying &&\n            !this.isLoading &&\n            !this._edgeDirectSocket &&\n            !this._edgeDirectFetchController &&\n            !this._edgeDirectObjectUrl) {\n            return;\n        }\n        this._abortGptSoVitsFetch('stop');\n        this._cleanupEdgeDirectResources();\n        console.log(`[${SCRIPT_NAME}] TTS: `);\n        try {\n            if (this.currentAudio && typeof this.currentAudio.pause === 'function') {\n                try {\n                    this.currentAudio.pause();\n                }\n                catch {\n                    // ignore\n                }\n                try {\n                    this.currentAudio.src = '';\n                    if (typeof this.currentAudio.load === 'function')\n                        this.currentAudio.load();\n                }\n                catch {\n                    // ignore\n                }\n            }\n            if (this.xiaobaixTts && this.xiaobaixTts.player) {\n                const player = this.xiaobaixTts.player;\n                if (typeof player._stopCurrent === 'function') {\n                    player._stopCurrent();\n                }\n                if (typeof player.clear === 'function') {\n                    player.clear();\n                    console.log(`[${SCRIPT_NAME}] TTS: `);\n                }\n            }\n            else if (this.xiaobaixTts && typeof this.xiaobaixTts.stop === 'function') {\n                this.xiaobaixTts.stop();\n            }\n            else if (this.littleWhiteBox && typeof this.littleWhiteBox.stop === 'function') {\n                this.littleWhiteBox.stop();\n            }\n        }\n        catch (e) {\n            console.warn(`[${SCRIPT_NAME}] TTS: `, e);\n        }\n        this.isPlaying = false;\n        this.isLoading = false;\n        this.currentAudio = null;\n        this.currentSegmentId = null;\n        this.hideLoadingIndicator();\n        LipSyncManager.stopSync();\n    },\n    _getCurrentAudioElement() {\n        if (this.currentAudio)\n            return this.currentAudio;\n        if (this.xiaobaixTts?.player?.currentAudio) {\n            return this.xiaobaixTts.player.currentAudio;\n        }\n        if (this.xiaobaixTts?.player?.audio) {\n            return this.xiaobaixTts.player.audio;\n        }\n        if (this.xiaobaixTts?.player?.audioElements?.length > 0) {\n            return this.xiaobaixTts.player.audioElements[0];\n        }\n        if (this.xiaobaixTts?.audio) {\n            return this.xiaobaixTts.audio;\n        }\n        const top = getTopWindow();\n        const allAudio = top.document.querySelectorAll('audio');\n        for (const audio of allAudio) {\n            if (audio.src && !audio.paused) {\n                return audio;\n            }\n        }\n        const anyAudio = top.document.querySelector('audio[src]');\n        if (anyAudio)\n            return anyAudio;\n        return null;\n    },\n    _getPreferredAudioElement() {\n        if (this.currentAudio)\n            return this.currentAudio;\n        if (this.xiaobaixTts?.player?.currentAudio) {\n            return this.xiaobaixTts.player.currentAudio;\n        }\n        if (this.xiaobaixTts?.player?.audio) {\n            return this.xiaobaixTts.player.audio;\n        }\n        if (this.xiaobaixTts?.player?.audioElements?.length > 0) {\n            return this.xiaobaixTts.player.audioElements[0];\n        }\n        if (this.xiaobaixTts?.audio) {\n            return this.xiaobaixTts.audio;\n        }\n        return null;\n    },\n    _resolveGptSoVitsServerPath(pathStr, cfg = null) {\n        const raw = normalizePathSepForGpt(pathStr);\n        if (!raw)\n            return '';\n        if (/^https?:\\/\\//i.test(raw))\n            return raw;\n        if (looksLikeAbsoluteFsPath(raw))\n            return raw;\n        const resolvedCfg = safeObject(cfg || getGptSoVitsConfig());\n        const prefix = normalizePathSepForGpt(resolvedCfg.importPathPrefix || resolvedCfg.rootDir || '');\n        if (!prefix || !looksLikeAbsoluteFsPath(prefix))\n            return raw;\n        const root = prefix.replace(/[\\\\/]+$/g, '');\n        const tail = raw.replace(/^[\\\\/]+/g, '');\n        return tail ? `${root}/${tail}` : root;\n    },\n    _buildGptSoVitsRefAudioPathCandidates(pathStr, options = null) {\n        const opts = safeObject(options);\n        const modelCfg = safeObject(opts.modelCfg);\n        const voiceCfg = safeObject(opts.voiceCfg);\n        const rawSeed = normalizePathSepForGpt(pathStr);\n        const rawFromVoice = normalizePathSepForGpt(opts.rawRefPath || voiceCfg.refAudioPath || '');\n        const out = [];\n        const seen = new Set();\n        const addOne = (value) => {\n            const next = normalizePathSepForGpt(value);\n            if (!next || seen.has(next))\n                return;\n            seen.add(next);\n            out.push(next);\n        };\n        const addPath = (value) => {\n            const next = normalizePathSepForGpt(value);\n            if (!next)\n                return;\n            addOne(next);\n            try {\n                addOne(next.normalize('NFC'));\n            }\n            catch {\n                // ignore\n            }\n            try {\n                addOne(next.normalize('NFD'));\n            }\n            catch {\n                // ignore\n            }\n            try {\n                addOne(next.normalize('NFKC'));\n            }\n            catch {\n                // ignore\n            }\n            try {\n                addOne(next.normalize('NFKD'));\n            }\n            catch {\n                // ignore\n            }\n            addOne(next.replace(/\\//g, '\\\\'));\n            addOne(next.replace(/\\\\/g, '/'));\n        };\n        const dirname = (input) => {\n            const next = normalizePathSepForGpt(input);\n            if (!next)\n                return '';\n            const index = next.lastIndexOf('/');\n            if (index <= 0)\n                return '';\n            return next.slice(0, index);\n        };\n        const basename = (input) => {\n            const next = normalizePathSepForGpt(input);\n            if (!next)\n                return '';\n            const index = next.lastIndexOf('/');\n            return index < 0 ? next : next.slice(index + 1);\n        };\n        const extractDrive = (input) => {\n            const matched = String(input || '').match(/^([a-zA-Z]):[\\\\/]/);\n            return matched ? matched[1].toUpperCase() : '';\n        };\n        const seedSources = [];\n        const pushSeed = (value) => {\n            const next = normalizePathSepForGpt(value);\n            if (!next || seedSources.includes(next))\n                return;\n            seedSources.push(next);\n        };\n        pushSeed(rawSeed);\n        pushSeed(rawFromVoice);\n        pushSeed(modelCfg?.paths?.defaultRefAudioPath);\n        for (const ref of safeArray(modelCfg?.refAudios)) {\n            pushSeed(ref?.path);\n        }\n        for (const seed of seedSources) {\n            addPath(seed);\n        }\n        const mainSeed = seedSources[0] || '';\n        const fileName = basename(mainSeed);\n        const segments = normalizePathSepForGpt(mainSeed).split('/').filter(Boolean);\n        const tail2 = segments.length >= 2 ? `${segments[segments.length - 2]}/${segments[segments.length - 1]}` : '';\n        const tail3 = segments.length >= 3\n            ? `${segments[segments.length - 3]}/${segments[segments.length - 2]}/${segments[segments.length - 1]}`\n            : '';\n        const weightPaths = []\n            .concat([\n            voiceCfg.gptWeightsPath,\n            voiceCfg.sovitsWeightsPath,\n            modelCfg?.paths?.gptWeightsPath,\n            modelCfg?.paths?.sovitsWeightsPath,\n        ])\n            .map(value => normalizePathSepForGpt(value))\n            .filter(Boolean);\n        const weightDirs = [];\n        for (const weightPath of weightPaths) {\n            const dir = dirname(weightPath);\n            if (dir && !weightDirs.includes(dir)) {\n                weightDirs.push(dir);\n            }\n        }\n        for (const dir of weightDirs) {\n            if (fileName)\n                addPath(`${dir}/${fileName}`);\n            if (tail2)\n                addPath(`${dir}/${tail2}`);\n            if (tail3)\n                addPath(`${dir}/${tail3}`);\n        }\n        const seedDrive = extractDrive(mainSeed);\n        const altDrives = [];\n        for (const weightPath of weightPaths) {\n            const drive = extractDrive(weightPath);\n            if (drive && drive !== seedDrive && !altDrives.includes(drive)) {\n                altDrives.push(drive);\n            }\n        }\n        if (seedDrive) {\n            const snapshot = out.slice();\n            for (const item of snapshot) {\n                if (!new RegExp(`^${seedDrive}:`, 'i').test(item))\n                    continue;\n                for (const drive of altDrives) {\n                    addPath(item.replace(new RegExp(`^${seedDrive}:`, 'i'), `${drive}:`));\n                }\n            }\n        }\n        const wavePairs = [\n            ['\\u301C', '\\uFF5E'],\n            ['\\u301C', '~'],\n            ['\\uFF5E', '\\u301C'],\n            ['\\uFF5E', '~'],\n            ['~', '\\u301C'],\n            ['~', '\\uFF5E'],\n        ];\n        for (const [from, to] of wavePairs) {\n            const snapshot = out.slice();\n            for (const item of snapshot) {\n                if (!item.includes(from))\n                    continue;\n                addPath(item.split(from).join(to));\n            }\n        }\n        return out.slice(0, 64);\n    },\n    _isProxyUrl(url) {\n        const parsed = safeUrl(url);\n        if (!parsed)\n            return false;\n        return /^\\/proxy(\\/|\\?|$)/i.test(parsed.pathname);\n    },\n    _getGptSoVitsProxyUrlFromHelpers(directUrl) {\n        const url = String(directUrl || '').trim();\n        if (!url)\n            return '';\n        const topAny = getTopWindow();\n        const helperFns = [\n            topAny?.getCorsProxyUrl,\n            topAny?.enableCorsProxy,\n            topAny?.corsProxy?.getProxyUrl,\n            window?.getCorsProxyUrl,\n            window?.enableCorsProxy,\n            window?.corsProxy?.getProxyUrl,\n        ].filter(fn => typeof fn === 'function');\n        for (const fn of helperFns) {\n            try {\n                const proxied = fn.call(topAny, url);\n                if (typeof proxied === 'string' && proxied.trim())\n                    return proxied.trim();\n            }\n            catch {\n                // ignore\n            }\n        }\n        return '';\n    },\n    _buildGptSoVitsProxyUrl(route, originalUrl) {\n        const direct = String(originalUrl || '').trim();\n        if (!direct)\n            return '';\n        const topAny = getTopWindow();\n        const origin = String(topAny?.location?.origin || window.location?.origin || '').replace(/\\/+$/, '');\n        const encoded = encodeURIComponent(direct);\n        const buildProxyPathRawTarget = (url) => {\n            const raw = String(url || '').trim();\n            if (!raw)\n                return '';\n            const noHash = raw.split('#')[0] || raw;\n            const qIdx = noHash.indexOf('?');\n            if (qIdx < 0)\n                return noHash;\n            const base = noHash.slice(0, qIdx);\n            const query = noHash.slice(qIdx + 1);\n            return `${base}%3F${query.replace(/&/g, '%26').replace(/=/g, '%3D')}`;\n        };\n        const rawTarget = buildProxyPathRawTarget(direct);\n        switch (route) {\n            case 'helper':\n                return this._getGptSoVitsProxyUrlFromHelpers(direct);\n            case 'proxy_path_raw_relative':\n                return rawTarget ? `/proxy/${rawTarget}` : '';\n            case 'proxy_path_raw_origin':\n                return origin && rawTarget ? `${origin}/proxy/${rawTarget}` : '';\n            case 'proxy_path_relative':\n                return `/proxy/${encoded}`;\n            case 'proxy_path_origin':\n                return origin ? `${origin}/proxy/${encoded}` : '';\n            case 'proxy_query_relative':\n                return `/proxy?url=${encoded}`;\n            case 'proxy_query_origin':\n                return origin ? `${origin}/proxy?url=${encoded}` : '';\n            case 'direct':\n                return direct;\n            default:\n                return '';\n        }\n    },\n    _rememberProxyRoute(route, url) {\n        if (!route)\n            return;\n        if (this._gptSoVitsResolvedProxyRoute !== route) {\n            this._gptSoVitsResolvedProxyRoute = route;\n            console.log(`[${SCRIPT_NAME}] GPT-SoVITS : ${route} -> ${clipText(url, 96)}`);\n        }\n    },\n    _getProxiedAudioUrl(originalUrl) {\n        const directUrl = String(originalUrl || '').trim();\n        if (!directUrl)\n            return directUrl;\n        if (this._isProxyUrl(directUrl))\n            return directUrl;\n        const helperUrl = this._getGptSoVitsProxyUrlFromHelpers(directUrl);\n        if (helperUrl)\n            return helperUrl;\n        const remembered = String(this._gptSoVitsResolvedProxyRoute || '').trim();\n        if (remembered && remembered !== 'direct') {\n            const rememberedUrl = this._buildGptSoVitsProxyUrl(remembered, directUrl);\n            if (rememberedUrl)\n                return rememberedUrl;\n        }\n        return (this._buildGptSoVitsProxyUrl('proxy_path_raw_relative', directUrl) ||\n            this._buildGptSoVitsProxyUrl('proxy_path_relative', directUrl) ||\n            this._buildGptSoVitsProxyUrl('proxy_query_relative', directUrl) ||\n            directUrl);\n    },\n    _buildGptSoVitsTtsUrl(text, resolvedVoice) {\n        const cfg = getGptSoVitsConfig();\n        const base = String(cfg.apiUrl || '').replace(/\\/$/, '');\n        const endpointRaw = String(cfg.endpoint || '/tts').trim();\n        const endpoint = endpointRaw.startsWith('/') ? endpointRaw : `/${endpointRaw}`;\n        if (!base)\n            return '';\n        try {\n            const url = new URL(base + endpoint);\n            const modelCfg = resolvedVoice?.gptSoVitsModel || null;\n            const refs = safeArray(modelCfg?.refAudios);\n            const defaultRefPath = String(modelCfg?.paths?.defaultRefAudioPath || '').trim();\n            const defaultRef = refs.find(item => item?.path === defaultRefPath) ||\n                refs.find(item => String(item?.id || '').trim() === String(modelCfg?.defaultRefId || '').trim()) ||\n                refs[0] ||\n                null;\n            const modelParams = modelCfg?.params || {};\n            const vcfg = resolvedVoice?.gptSoVits || {};\n            const textLang = String(vcfg.textLang || modelParams.textLang || cfg.textLang || 'auto').trim() || 'auto';\n            const promptLang = String(vcfg.promptLang || defaultRef?.promptLang || modelParams.promptLang || 'zh').trim() || 'zh';\n            const refAudioPathRaw = String(defaultRef?.path || defaultRefPath || vcfg.refAudioPath || '').trim();\n            const refAudioPath = this._resolveGptSoVitsServerPath(refAudioPathRaw, cfg);\n            const promptText = String(vcfg.promptText || defaultRef?.promptText || modelParams.promptText || '').trim();\n            const textSplitMethod = String(vcfg.textSplitMethod || modelParams.textSplitMethod || cfg.textSplitMethod || '').trim();\n            const mediaType = String(vcfg.mediaType || modelParams.mediaType || cfg.mediaType || '').trim();\n            const streamingMode = !!(vcfg.streamingMode ?? modelParams.streamingMode ?? cfg.streamingMode);\n            const speedFactor = Number(vcfg.speedFactor ?? modelParams.speedFactor ?? cfg.speedFactor);\n            url.searchParams.set('text', text);\n            url.searchParams.set('text_lang', textLang);\n            url.searchParams.set('ref_audio_path', refAudioPath);\n            url.searchParams.set('prompt_lang', promptLang);\n            url.searchParams.set('prompt_text', promptText);\n            if (textSplitMethod)\n                url.searchParams.set('text_split_method', textSplitMethod);\n            if (mediaType)\n                url.searchParams.set('media_type', mediaType);\n            url.searchParams.set('streaming_mode', streamingMode ? 'true' : 'false');\n            if (Number.isFinite(speedFactor) && speedFactor > 0) {\n                url.searchParams.set('speed_factor', String(speedFactor));\n            }\n            return url.toString();\n        }\n        catch (e) {\n            console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: URL`, e);\n            return '';\n        }\n    },\n    async _requestGptSoVitsApi(method, pathname, queryParams = {}, jsonBody = undefined) {\n        const cfg = getGptSoVitsConfig();\n        const base = String(cfg.apiUrl || '').replace(/\\/$/, '');\n        const pathRaw = String(pathname || '').trim() || '/';\n        const path = pathRaw.startsWith('/') ? pathRaw : `/${pathRaw}`;\n        if (!base)\n            throw new Error('GPT-SoVITS API ');\n        const directUrlObj = new URL(base + path);\n        Object.entries(queryParams || {}).forEach(([key, value]) => {\n            if (value !== undefined && value !== null && value !== '') {\n                directUrlObj.searchParams.set(String(key), String(value));\n            }\n        });\n        const directUrl = directUrlObj.toString();\n        const attemptTargets = [];\n        if (!cfg.useCorsProxy) {\n            attemptTargets.push({ route: 'direct', url: directUrl });\n        }\n        else {\n            const preferred = String(this._gptSoVitsResolvedProxyRoute || '').trim();\n            const seen = new Set();\n            const addTarget = (route, url) => {\n                if (!url || seen.has(url))\n                    return;\n                seen.add(url);\n                attemptTargets.push({ route, url });\n            };\n            if (preferred)\n                addTarget(preferred, this._buildGptSoVitsProxyUrl(preferred, directUrl));\n            addTarget('helper', this._buildGptSoVitsProxyUrl('helper', directUrl));\n            addTarget('proxy_path_raw_relative', this._buildGptSoVitsProxyUrl('proxy_path_raw_relative', directUrl));\n            addTarget('proxy_path_raw_origin', this._buildGptSoVitsProxyUrl('proxy_path_raw_origin', directUrl));\n            addTarget('proxy_path_relative', this._buildGptSoVitsProxyUrl('proxy_path_relative', directUrl));\n            addTarget('proxy_path_origin', this._buildGptSoVitsProxyUrl('proxy_path_origin', directUrl));\n            addTarget('proxy_query_relative', this._buildGptSoVitsProxyUrl('proxy_query_relative', directUrl));\n            addTarget('proxy_query_origin', this._buildGptSoVitsProxyUrl('proxy_query_origin', directUrl));\n            addTarget('direct', directUrl);\n        }\n        const errors = [];\n        for (const target of attemptTargets) {\n            const controller = new AbortController();\n            this._gptSoVitsFetchController = controller;\n            try {\n                const options = {\n                    method,\n                    mode: 'cors',\n                    credentials: 'omit',\n                    signal: controller.signal,\n                    headers: {},\n                };\n                if (jsonBody !== undefined) {\n                    options.headers['Content-Type'] = 'application/json';\n                    options.body = JSON.stringify(jsonBody);\n                }\n                const response = await fetch(target.url, options);\n                const text = await response.text();\n                if (response.ok) {\n                    if (target.route !== 'direct') {\n                        this._rememberProxyRoute(target.route, target.url);\n                    }\n                    return { text, status: response.status, url: target.url, route: target.route };\n                }\n                if (target.route !== 'direct' && isProxyNotFound(response.status, text)) {\n                    errors.push(`${target.route}:HTTP${response.status}(proxy-not-found)`);\n                    continue;\n                }\n                errors.push(`${target.route}:HTTP${response.status}:${clipText(text, 120)}`);\n            }\n            catch (e) {\n                const msg = e?.message || String(e);\n                errors.push(`${target.route}:${msg}`);\n            }\n            finally {\n                if (this._gptSoVitsFetchController === controller) {\n                    this._gptSoVitsFetchController = null;\n                }\n            }\n        }\n        throw new Error(`${method} ${path}  -> ${errors.join(' | ')}`);\n    },\n    async _fetchGptSoVitsApi(pathname, queryParams = {}) {\n        const { text } = await this._requestGptSoVitsApi('GET', pathname, queryParams);\n        return text;\n    },\n    async _postGptSoVitsApi(pathname, jsonBody = {}) {\n        const { text } = await this._requestGptSoVitsApi('POST', pathname, {}, jsonBody);\n        return text;\n    },\n    async _setGptSoVitsWeights(kind, weightsPath) {\n        const normalizedKind = kind === 'gpt' ? 'gpt' : 'sovits';\n        const path = String(weightsPath || '').trim();\n        if (!path)\n            return;\n        const endpoint = `/set_${normalizedKind}_weights`;\n        await this._fetchGptSoVitsApi(endpoint, { weights_path: path });\n    },\n    async _setGptSoVitsModelPair(gptWeightsPath, sovitsWeightsPath, endpointOverride = '') {\n        const cfg = getGptSoVitsConfig();\n        const endpoint = String(endpointOverride || cfg.setModelEndpoint || '/set_model').trim() || '/set_model';\n        try {\n            await this._postGptSoVitsApi(endpoint, {\n                gpt_model_path: String(gptWeightsPath || '').trim(),\n                sovits_model_path: String(sovitsWeightsPath || '').trim(),\n            });\n            return;\n        }\n        catch {\n            await this._fetchGptSoVitsApi(endpoint, {\n                gpt_model_path: String(gptWeightsPath || '').trim(),\n                sovits_model_path: String(sovitsWeightsPath || '').trim(),\n            });\n        }\n    },\n    async _ensureGptSoVitsWeights(resolvedVoice) {\n        const cfg = getGptSoVitsConfig();\n        const modelCfg = resolvedVoice?.gptSoVitsModel || null;\n        const vcfg = resolvedVoice?.gptSoVits || {};\n        const modelParams = modelCfg?.params || {};\n        const modelPaths = modelCfg?.paths || {};\n        const strictWeightSwitch = !!(vcfg.strictWeightSwitch ?? modelParams.strictWeightSwitch ?? cfg.strictWeightSwitch);\n        let switchMode = normalizeGptSoVitsSwitchMode(vcfg.modelSwitchMode || modelParams.modelSwitchMode || cfg.modelSwitchMode);\n        const setModelEndpoint = String(vcfg.setModelEndpoint || modelParams.setModelEndpoint || cfg.setModelEndpoint || '/set_model').trim() || '/set_model';\n        const desiredGpt = this._resolveGptSoVitsServerPath(String(vcfg.gptWeightsPath || modelPaths.gptWeightsPath || '').trim(), cfg);\n        const desiredSovits = this._resolveGptSoVitsServerPath(String(vcfg.sovitsWeightsPath || modelPaths.sovitsWeightsPath || '').trim(), cfg);\n        if (switchMode === 'none')\n            return false;\n        if (!desiredGpt && !desiredSovits)\n            return true;\n        if (this._gptSoVitsWeightSwitchUnavailable) {\n            if (!this._gptSoVitsWeightSwitchWarned) {\n                this._gptSoVitsWeightSwitchWarned = true;\n                showToast('GPT-SoVITS:  /set_*CORS/');\n            }\n            if (strictWeightSwitch) {\n                throw new Error(' CORS ');\n            }\n            return false;\n        }\n        const failures = [];\n        const trySetModelFallback = async (triggerMsg) => {\n            const canFallback = switchMode === 'set_weights' && !!desiredGpt && !!desiredSovits && !strictWeightSwitch;\n            if (!canFallback)\n                return false;\n            const msg = String(triggerMsg || '');\n            const looksLikeEndpointMismatch = /404|405|not found|cannot\\s+(get|post)|method not allowed/i.test(msg);\n            if (!looksLikeEndpointMismatch)\n                return false;\n            try {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: set_weights  set_model`);\n                await this._setGptSoVitsModelPair(desiredGpt, desiredSovits, setModelEndpoint);\n                this._gptSoVitsActiveWeights.gpt = desiredGpt;\n                this._gptSoVitsActiveWeights.sovits = desiredSovits;\n                return true;\n            }\n            catch (fallbackErr) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: set_model `, fallbackErr);\n                return false;\n            }\n        };\n        if (switchMode === 'set_model' && desiredGpt && desiredSovits) {\n            const needPairSwitch = desiredGpt !== this._gptSoVitsActiveWeights.gpt || desiredSovits !== this._gptSoVitsActiveWeights.sovits;\n            if (needPairSwitch) {\n                let setModelError = '';\n                let setModelFetchBlocked = false;\n                try {\n                    await this._setGptSoVitsModelPair(desiredGpt, desiredSovits, setModelEndpoint);\n                    this._gptSoVitsActiveWeights.gpt = desiredGpt;\n                    this._gptSoVitsActiveWeights.sovits = desiredSovits;\n                }\n                catch (e) {\n                    setModelError = String(e?.message || e || 'unknown error');\n                    setModelFetchBlocked = /failed to fetch/i.test(setModelError);\n                    console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: set_model `, e);\n                }\n                if (setModelError && !strictWeightSwitch) {\n                    console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: set_model  set_weights `);\n                    try {\n                        if (desiredGpt && desiredGpt !== this._gptSoVitsActiveWeights.gpt) {\n                            await this._setGptSoVitsWeights('gpt', desiredGpt);\n                            this._gptSoVitsActiveWeights.gpt = desiredGpt;\n                        }\n                        if (desiredSovits && desiredSovits !== this._gptSoVitsActiveWeights.sovits) {\n                            await this._setGptSoVitsWeights('sovits', desiredSovits);\n                            this._gptSoVitsActiveWeights.sovits = desiredSovits;\n                        }\n                        setModelError = '';\n                    }\n                    catch (fallbackErr) {\n                        const fallbackMsg = String(fallbackErr?.message || fallbackErr || 'unknown error');\n                        setModelError = `${setModelError} | fallback_set_weights: ${fallbackMsg}`;\n                    }\n                }\n                if (setModelError && setModelFetchBlocked) {\n                    this._gptSoVitsWeightSwitchUnavailable = true;\n                    console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: /set_model `);\n                    if (!strictWeightSwitch) {\n                        if (!this._gptSoVitsWeightSwitchWarned) {\n                            this._gptSoVitsWeightSwitchWarned = true;\n                            showToast('GPT-SoVITS:  /set_*CORS/');\n                        }\n                        return false;\n                    }\n                }\n                if (setModelError) {\n                    failures.push(`set_model: ${setModelError}`);\n                }\n            }\n            if (failures.length > 0) {\n                if (strictWeightSwitch) {\n                    throw new Error(`: ${failures.join(' | ')}`);\n                }\n                const clipped = failures[0].length > 120 ? `${failures[0].slice(0, 120)}...` : failures[0];\n                showToast(`GPT-SoVITS ${clipped}`);\n            }\n            return true;\n        }\n        if (switchMode === 'set_model' && (!desiredGpt || !desiredSovits)) {\n            console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: modelSwitchMode=set_model  set_weights `);\n            switchMode = 'set_weights';\n        }\n        if (switchMode === 'set_weights') {\n            if (desiredGpt && desiredGpt !== this._gptSoVitsActiveWeights.gpt) {\n                try {\n                    await this._setGptSoVitsWeights('gpt', desiredGpt);\n                    this._gptSoVitsActiveWeights.gpt = desiredGpt;\n                }\n                catch (e) {\n                    const msg = String(e?.message || e || 'unknown error');\n                    if (await trySetModelFallback(msg)) {\n                        return true;\n                    }\n                    failures.push(`gpt: ${msg}`);\n                    const fetchBlocked = /failed to fetch/i.test(msg);\n                    if (fetchBlocked)\n                        this._gptSoVitsWeightSwitchUnavailable = true;\n                    if (fetchBlocked) {\n                        console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: /set_gpt_weights `);\n                        if (!strictWeightSwitch) {\n                            if (!this._gptSoVitsWeightSwitchWarned) {\n                                this._gptSoVitsWeightSwitchWarned = true;\n                                showToast('GPT-SoVITS:  /set_*CORS/');\n                            }\n                            return false;\n                        }\n                    }\n                    else {\n                        console.warn(`[${SCRIPT_NAME}] GPT-SoVITS:  gpt `, e);\n                    }\n                }\n            }\n            if (desiredSovits && desiredSovits !== this._gptSoVitsActiveWeights.sovits) {\n                try {\n                    await this._setGptSoVitsWeights('sovits', desiredSovits);\n                    this._gptSoVitsActiveWeights.sovits = desiredSovits;\n                }\n                catch (e) {\n                    const msg = String(e?.message || e || 'unknown error');\n                    if (await trySetModelFallback(msg)) {\n                        return true;\n                    }\n                    failures.push(`sovits: ${msg}`);\n                    const fetchBlocked = /failed to fetch/i.test(msg);\n                    if (fetchBlocked)\n                        this._gptSoVitsWeightSwitchUnavailable = true;\n                    if (fetchBlocked) {\n                        console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: /set_sovits_weights `);\n                        if (!strictWeightSwitch) {\n                            if (!this._gptSoVitsWeightSwitchWarned) {\n                                this._gptSoVitsWeightSwitchWarned = true;\n                                showToast('GPT-SoVITS:  /set_*CORS/');\n                            }\n                            return false;\n                        }\n                    }\n                    else {\n                        console.warn(`[${SCRIPT_NAME}] GPT-SoVITS:  sovits `, e);\n                    }\n                }\n            }\n        }\n        if (failures.length > 0) {\n            const detail = failures[0];\n            const clipped = detail.length > 120 ? `${detail.slice(0, 120)}...` : detail;\n            if (strictWeightSwitch) {\n                throw new Error(`: ${failures.join(' | ')}`);\n            }\n            showToast(`GPT-SoVITS ${clipped}`);\n        }\n        return true;\n    },\n    async _speakWithGptSoVits(segment, segmentId, resolvedVoice) {\n        const cfg = getGptSoVitsConfig();\n        const vcfg = resolvedVoice?.gptSoVits || {};\n        const modelCfg = resolvedVoice?.gptSoVitsModel || null;\n        if (!cfg.apiUrl) {\n            showToast('GPT-SoVITS:  API ');\n            return false;\n        }\n        const refs = safeArray(modelCfg?.refAudios);\n        const defaultRefPath = String(modelCfg?.paths?.defaultRefAudioPath || '').trim();\n        const defaultRef = refs.find(item => item?.path === defaultRefPath) ||\n            refs.find(item => String(item?.id || '').trim() === String(modelCfg?.defaultRefId || '').trim()) ||\n            refs[0] ||\n            null;\n        const refAudioRaw = String(defaultRef?.path || defaultRefPath || vcfg.refAudioPath || '').trim();\n        const refAudioPath = this._resolveGptSoVitsServerPath(refAudioRaw, cfg);\n        if (!refAudioPath) {\n            showToast('GPT-SoVITS:  refAudioPath');\n            return false;\n        }\n        try {\n            await this._ensureGptSoVitsWeights(resolvedVoice);\n        }\n        catch (e) {\n            const reason = String(e?.message || e || 'unknown error');\n            showToast(`GPT-SoVITS ${clipText(reason, 120)}`);\n            return false;\n        }\n        const requestText = String(segment.text || '');\n        const refAudioPathCandidatesSeed = this._buildGptSoVitsRefAudioPathCandidates(refAudioPath, {\n            cfg,\n            modelCfg,\n            voiceCfg: vcfg,\n            rawRefPath: refAudioRaw,\n        });\n        const refAudioPathCandidates = [];\n        const seenRefAudioPath = new Set();\n        const addRefAudioPathCandidate = (pathStr) => {\n            const normalized = normalizePathSepForGpt(pathStr);\n            if (!normalized || seenRefAudioPath.has(normalized))\n                return;\n            seenRefAudioPath.add(normalized);\n            refAudioPathCandidates.push(normalized);\n        };\n        addRefAudioPathCandidate(refAudioRaw);\n        addRefAudioPathCandidate(refAudioPath);\n        for (const path of refAudioPathCandidatesSeed) {\n            addRefAudioPathCandidate(path);\n            addRefAudioPathCandidate(this._resolveGptSoVitsServerPath(path, cfg));\n        }\n        if (refAudioPathCandidates.length === 0) {\n            refAudioPathCandidates.push(refAudioPath);\n        }\n        const directUrlCandidates = [];\n        const seenDirectUrl = new Set();\n        for (const candidateRefPath of refAudioPathCandidates) {\n            const voiceForRequest = {\n                ...resolvedVoice,\n                gptSoVits: {\n                    ...resolvedVoice?.gptSoVits,\n                    refAudioPath: candidateRefPath,\n                },\n            };\n            const directUrl = this._buildGptSoVitsTtsUrl(requestText, voiceForRequest);\n            if (!directUrl || seenDirectUrl.has(directUrl))\n                continue;\n            seenDirectUrl.add(directUrl);\n            directUrlCandidates.push(directUrl);\n        }\n        if (directUrlCandidates.length === 0) {\n            showToast('GPT-SoVITS: URL');\n            return false;\n        }\n        const audioUrlCandidates = [];\n        const seenAudioUrl = new Set();\n        const addAudioUrl = (url) => {\n            const next = String(url || '').trim();\n            if (!next || seenAudioUrl.has(next))\n                return;\n            seenAudioUrl.add(next);\n            audioUrlCandidates.push(next);\n        };\n        for (const directUrl of directUrlCandidates) {\n            if (cfg.useCorsProxy) {\n                addAudioUrl(this._getProxiedAudioUrl(directUrl));\n            }\n            //  /proxy  HTML  NotSupportedError\n            addAudioUrl(directUrl);\n        }\n        console.log(`[${SCRIPT_NAME}] GPT-SoVITS audio candidates`, audioUrlCandidates.map(item => clipText(item, 180)));\n        const audio = new Audio();\n        audio.crossOrigin = 'anonymous';\n        this.currentAudio = audio;\n        this.currentSegmentId = segmentId;\n        const onEnded = () => {\n            if (this.currentAudio === audio) {\n                this._onPlaybackEnded('gpt_sovits_audio_ended');\n            }\n        };\n        const onError = (e) => {\n            console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: audio error`, e);\n            if (!this._gptSoVitsProxyWarned && cfg.useCorsProxy) {\n                this._gptSoVitsProxyWarned = true;\n                showToast('GPT-SoVITS  /proxy  CORS ');\n            }\n            else {\n                showToast('GPT-SoVITS //CORS');\n            }\n            onEnded();\n        };\n        let playError = null;\n        let started = false;\n        for (let i = 0; i < audioUrlCandidates.length; i += 1) {\n            const nextUrl = audioUrlCandidates[i];\n            if (!nextUrl)\n                continue;\n            audio.src = nextUrl;\n            try {\n                await audio.play();\n                started = true;\n                if (i > 0) {\n                    console.warn(`[${SCRIPT_NAME}] GPT-SoVITS refAudioPath fallback hit`, {\n                        candidateIndex: i,\n                        totalCandidates: audioUrlCandidates.length,\n                    });\n                }\n                break;\n            }\n            catch (e) {\n                playError = e;\n            }\n        }\n        if (!started) {\n            const msg = String(playError?.message || '').toLowerCase();\n            const blockedByAutoplay = /autoplay|notallowederror|user.*interact|play\\(\\) failed/i.test(msg);\n            console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: play() `, playError);\n            showToast(blockedByAutoplay\n                ? 'GPT-SoVITS '\n                : cfg.useCorsProxy\n                    ? 'GPT-SoVITS / /proxyCORS  refAudioPath'\n                    : 'GPT-SoVITS  refAudioPath ');\n            onEnded();\n            return false;\n        }\n        audio.addEventListener('ended', onEnded, { once: true });\n        audio.addEventListener('error', onError, { once: true });\n        this.isPlaying = true;\n        if (hasLive2D()) {\n            const lipId = segment.speaker || 'pet';\n            console.log(`[${SCRIPT_NAME}] TTS: : hasLive2D=true, speaker=${lipId}`);\n            this._startLipSyncOnPlay(lipId);\n        }\n        else {\n            console.log(`[${SCRIPT_NAME}] TTS: Live2D `);\n        }\n        return true;\n    },\n    async _speakWithEdgeDirect(segment, segmentId, resolvedVoice) {\n        const voiceName = String(resolvedVoice.value || resolvedVoice.name || '').trim();\n        if (!voiceName) {\n            showToast('EdgeTTS ');\n            return false;\n        }\n        this._cleanupEdgeDirectResources();\n        const controller = new AbortController();\n        this._edgeDirectFetchController = controller;\n        let blob;\n        try {\n            blob = await synthesizeToBlob(segment.text, resolvedVoice, {\n                signal: controller.signal,\n                onSocket: socket => {\n                    this._edgeDirectSocket = socket;\n                },\n            });\n        }\n        catch (e) {\n            const isAbort = e?.name === 'AbortError';\n            if (!isAbort) {\n                const reason = clipText(e?.message || String(e), 180);\n                const blockedHint = /likely-cause=ua-not-edg/i.test(reason)\n                    ? ' Edge Edge '\n                    : /1006|403|websocket/i.test(reason)\n                        ? ' CSP/ wss  Edge '\n                        : '';\n                console.warn(`[${SCRIPT_NAME}] EdgeTTS :`, e);\n                showToast(`EdgeTTS ${reason}${blockedHint}`);\n            }\n            return false;\n        }\n        finally {\n            if (this._edgeDirectFetchController === controller) {\n                this._edgeDirectFetchController = null;\n            }\n            this._edgeDirectSocket = null;\n        }\n        if (!blob || blob.size <= 0) {\n            showToast('EdgeTTS ');\n            return false;\n        }\n        const objectUrl = URL.createObjectURL(blob);\n        this._edgeDirectObjectUrl = objectUrl;\n        const audio = new Audio();\n        audio.crossOrigin = 'anonymous';\n        audio.src = objectUrl;\n        this.currentAudio = audio;\n        this.currentSegmentId = segmentId;\n        const onEnded = () => {\n            if (this.currentAudio === audio) {\n                this._onPlaybackEnded('edge_direct_audio_ended');\n            }\n        };\n        const onError = (err) => {\n            console.warn(`[${SCRIPT_NAME}] EdgeTTS :`, err);\n            showToast('EdgeTTS  Edge ');\n            onEnded();\n        };\n        audio.addEventListener('ended', onEnded, { once: true });\n        audio.addEventListener('error', onError, { once: true });\n        try {\n            await audio.play();\n        }\n        catch (e) {\n            console.warn(`[${SCRIPT_NAME}] EdgeTTS  play() :`, e);\n            showToast('EdgeTTS ');\n            onEnded();\n            return false;\n        }\n        this.isPlaying = true;\n        if (hasLive2D()) {\n            const lipId = segment.speaker || 'pet';\n            this._startLipSyncOnPlay(lipId);\n        }\n        return true;\n    },\n    _startLipSyncWhenModelReady(characterId, maxWait = 5000) {\n        const startTime = Date.now();\n        const tryWait = () => {\n            if (hasLive2D()) {\n                this._startLipSyncOnPlay(characterId, maxWait);\n                return;\n            }\n            if (Date.now() - startTime < maxWait) {\n                setTimeout(tryWait, 120);\n            }\n            else {\n                console.warn(`[${SCRIPT_NAME}] LipSync:  - characterId=${characterId}`);\n            }\n        };\n        tryWait();\n    },\n    async _waitForModelReadyBeforeTTS(_characterId, maxWait = 5000) {\n        const startTime = Date.now();\n        while (Date.now() - startTime < maxWait) {\n            if (hasLive2D())\n                return true;\n            await new Promise(r => setTimeout(r, 120));\n        }\n        console.warn(`[${SCRIPT_NAME}] TTS: TTS`);\n        return false;\n    },\n    _startLipSyncOnPlay(characterId, maxWait = 5000) {\n        console.log(`[${SCRIPT_NAME}] LipSync: _startLipSyncOnPlay  - characterId=${characterId}`);\n        const startTime = Date.now();\n        let hasStarted = false;\n        const tryBind = () => {\n            const preferredAudio = this._getPreferredAudioElement();\n            const audioElement = preferredAudio || this._getCurrentAudioElement();\n            console.log(`[${SCRIPT_NAME}] LipSync:  -`, audioElement\n                ? `src=${audioElement.src?.substring(0, 50)}... paused=${audioElement.paused} currentTime=${audioElement.currentTime}`\n                : 'null');\n            if (!audioElement) {\n                if (Date.now() - startTime < maxWait && !hasStarted) {\n                    setTimeout(tryBind, 100);\n                }\n                else if (!hasStarted) {\n                    console.warn(`[${SCRIPT_NAME}] LipSync: `);\n                }\n                return;\n            }\n            if (!audioElement.paused) {\n                console.log(`[${SCRIPT_NAME}] LipSync: `);\n                hasStarted = true;\n                this._bindLipSyncToAudio(audioElement, characterId);\n                return;\n            }\n            if (!preferredAudio) {\n                if (Date.now() - startTime < maxWait && !hasStarted) {\n                    setTimeout(tryBind, 100);\n                }\n                else if (!hasStarted) {\n                    console.warn(`[${SCRIPT_NAME}] LipSync: `);\n                    if (audioElement.src) {\n                        this._bindLipSyncToAudio(audioElement, characterId);\n                    }\n                }\n                return;\n            }\n            console.log(`[${SCRIPT_NAME}] LipSync: ...`);\n            const onPlaying = () => {\n                if (hasStarted)\n                    return;\n                hasStarted = true;\n                console.log(`[${SCRIPT_NAME}] LipSync: `);\n                this._bindLipSyncToAudio(audioElement, characterId);\n            };\n            audioElement.addEventListener('playing', onPlaying, { once: true });\n            audioElement.addEventListener('play', onPlaying, { once: true });\n            const onTimeUpdate = () => {\n                if (hasStarted)\n                    return;\n                if (audioElement.currentTime > 0 && !audioElement.paused) {\n                    console.log(`[${SCRIPT_NAME}] LipSync: timeupdate `);\n                    onPlaying();\n                }\n            };\n            audioElement.addEventListener('timeupdate', onTimeUpdate);\n            setTimeout(() => {\n                audioElement.removeEventListener('playing', onPlaying);\n                audioElement.removeEventListener('play', onPlaying);\n                audioElement.removeEventListener('timeupdate', onTimeUpdate);\n                if (!hasStarted) {\n                    console.warn(`[${SCRIPT_NAME}] LipSync: `);\n                    if (audioElement.src) {\n                        this._bindLipSyncToAudio(audioElement, characterId);\n                    }\n                }\n            }, maxWait);\n        };\n        tryBind();\n    },\n    _bindLipSyncToAudio(audioElement, characterId) {\n        if (LipSyncManager.connectAudio(audioElement)) {\n            void LipSyncManager.startSync(characterId);\n        }\n        const onEnd = () => {\n            console.log(`[${SCRIPT_NAME}] LipSync: /`);\n            LipSyncManager.stopSync();\n            audioElement.removeEventListener('ended', onEnd);\n            audioElement.removeEventListener('pause', onEnd);\n        };\n        audioElement.addEventListener('ended', onEnd, { once: true });\n        audioElement.addEventListener('pause', onEnd, { once: true });\n    },\n    async speak(segment, segmentId) {\n        if (!segment || segment.type !== 'dialogue') {\n            if (segment && segment.type === 'narration') {\n                console.log(`[${SCRIPT_NAME}] TTS:  - ${segment.text.substring(0, 30)}...`);\n            }\n            return;\n        }\n        if (!segment.text)\n            return;\n        const provider = getTTSProvider();\n        if (provider !== this.provider || !this.enabled) {\n            this._refreshProviderState();\n        }\n        if (!this.enabled)\n            return;\n        const settings = getSettingsSnapshot();\n        const ttsConfig = segment.tts || {};\n        const boundVoice = getCharacterTTSVoice(segment.speaker);\n        let voiceName = ttsConfig.speaker || boundVoice || settings.ttsDefaultSpeaker;\n        if (!voiceName) {\n            voiceName = provider === TTS_PROVIDER.GPT_SOVITS_V2 ? segment.speaker || '' : '';\n        }\n        if (!voiceName)\n            voiceName = '';\n        const context = ttsConfig.context || '';\n        const resolvedVoice = await resolveVoiceByName(String(voiceName || ''));\n        if (!resolvedVoice) {\n            console.error(`[${SCRIPT_NAME}] TTS:  \"${voiceName}\" (provider=${provider})`);\n            if (provider === TTS_PROVIDER.GPT_SOVITS_V2) {\n                showToast('GPT-SoVITS: ');\n            }\n            return;\n        }\n        console.log(`[${SCRIPT_NAME}] TTS: provider=${provider}, voiceName=${voiceName}, context=${context || ''}, text=${segment.text.substring(0, 30)}...`);\n        if (hasLive2D()) {\n            try {\n                const info = Live2DManager.getLipSyncDebugInfo();\n                console.log(`[${SCRIPT_NAME}] TTS: lipSyncOverride=active, mouthParamsSource=${info.mouthParamsSource}, count=${info.mouthParamsCount}`);\n            }\n            catch {\n                // ignore\n            }\n        }\n        this.isLoading = true;\n        this.showLoadingIndicator();\n        try {\n            await this._waitForModelReadyBeforeTTS(segment.speaker);\n            if (provider === TTS_PROVIDER.GPT_SOVITS_V2) {\n                await this._speakWithGptSoVits(segment, segmentId, resolvedVoice);\n                return;\n            }\n            if (provider === TTS_PROVIDER.EDGE_TTS_DIRECT) {\n                await this._speakWithEdgeDirect(segment, segmentId, resolvedVoice);\n                return;\n            }\n            const speakerValue = resolvedVoice.value;\n            const resourceId = inferResourceId(speakerValue);\n            if (this.xiaobaixTts && typeof this.xiaobaixTts.speak === 'function') {\n                await this.xiaobaixTts.speak(segment.text, {\n                    speaker: speakerValue,\n                    resourceId,\n                    contextTexts: context ? [context] : [],\n                });\n                this.isPlaying = true;\n                this.currentSegmentId = segmentId;\n                if (hasLive2D()) {\n                    this._startLipSyncOnPlay(segment.speaker || 'pet');\n                }\n                return;\n            }\n            if (this.littleWhiteBox && typeof this.littleWhiteBox.callGenerate === 'function') {\n                await this.littleWhiteBox.callGenerate({\n                    message: segment.text,\n                    speaker: speakerValue,\n                    resourceId,\n                    contextTexts: context ? [context] : [],\n                });\n                this.isPlaying = true;\n                this.currentSegmentId = segmentId;\n                if (hasLive2D()) {\n                    this._startLipSyncOnPlay(segment.speaker || 'pet');\n                }\n                return;\n            }\n            console.warn(`[${SCRIPT_NAME}] TTS:  TTS  LittleWhiteBox `);\n        }\n        catch (err) {\n            console.error(`[${SCRIPT_NAME}] TTS:`, err);\n        }\n        finally {\n            this.isLoading = false;\n            this.hideLoadingIndicator();\n        }\n    },\n};\n","const JP_SPLIT_MARKER_RE = /\\s*JP\\s*/i;\n\nexport type ZhJaSplitResult = {\n  displayText: string;\n  ttsText: string;\n  hasJa: boolean;\n};\n\n/**\n * TTS \n * JP\n */\nexport function splitZhJaForDisplayAndTts(input: unknown, enabled: boolean): ZhJaSplitResult {\n  const raw = String(input ?? '');\n  if (!enabled) {\n    return {\n      displayText: raw,\n      ttsText: raw,\n      hasJa: false,\n    };\n  }\n\n  const matched = raw.match(JP_SPLIT_MARKER_RE);\n  if (!matched || matched.index === undefined) {\n    return {\n      displayText: raw,\n      ttsText: raw,\n      hasJa: false,\n    };\n  }\n\n  const markerStart = matched.index;\n  const markerEnd = markerStart + matched[0].length;\n  const zhPart = raw.slice(0, markerStart).trim();\n  const jaPart = raw.slice(markerEnd).trim();\n  const fallback = raw.trim();\n\n  return {\n    displayText: zhPart || fallback,\n    ttsText: jaPart || zhPart || fallback,\n    hasJa: !!jaPart,\n  };\n}\n","import { log, warn } from '../utils/dom';\nimport type { CommentTriggerMode } from '../core/constants';\n\ntype MonitorCallback = () => void;\ntype StopHandle = { stop: () => void };\ntype UserSignalSource = 'message_sent' | 'generation_after_commands' | 'user_message_rendered';\ntype TriggerSource = 'user' | 'ai';\n\n/**\n * Chat message monitor.\n * Uses event-gating to separate real user/AI turns from the plugin's own generateRaw flow.\n */\nexport const ChatMonitor = {\n  /** Count since last trigger. */\n  messageCount: 0,\n\n  /** Ignore next N GENERATION_ENDED events (our own generateRaw). */\n  ignoreNextCount: 0,\n\n  /** Trigger callback. */\n  _onTrigger: null as MonitorCallback | null,\n\n  /** Event stop handles. */\n  _stops: [] as StopHandle[],\n\n  /** Latest user-side signal time (for dedupe). */\n  _lastUserSignalAt: 0,\n\n  /** Runtime config. */\n  _config: {\n    autoTrigger: true,\n    triggerInterval: 3,\n    triggerProbability: 60,\n    commentTriggerMode: 'ai' as CommentTriggerMode,\n  },\n\n  init(\n    config: {\n      autoTrigger: boolean;\n      triggerInterval: number;\n      triggerProbability: number;\n      commentTriggerMode: CommentTriggerMode;\n    },\n    onTrigger: MonitorCallback,\n  ): void {\n    this._config = { ...config };\n    this._onTrigger = onTrigger;\n    this._lastUserSignalAt = 0;\n\n    const messageSentStop = this._bindEvent('MESSAGE_SENT', (_messageId: number) => {\n      log('(MESSAGE_SENT)');\n      this._recordUserSignal('message_sent');\n    });\n    if (messageSentStop) {\n      this._stops.push(messageSentStop);\n    }\n\n    // Fallback for environments where MESSAGE_SENT exists but does not fire.\n    const userRenderedStop = this._bindEvent('USER_MESSAGE_RENDERED', (_messageId: number) => {\n      log('(USER_MESSAGE_RENDERED)');\n      this._recordUserSignal('user_message_rendered');\n    });\n    if (userRenderedStop) {\n      this._stops.push(userRenderedStop);\n    }\n\n    // Fallback for some /send command paths.\n    const afterCommandsStop = this._bindEvent(\n      'GENERATION_AFTER_COMMANDS',\n      (_type: string, option: { quiet_prompt?: string }, dryRun: boolean) => {\n        if (dryRun) return;\n        if (option?.quiet_prompt) return;\n        log('(GENERATION_AFTER_COMMANDS)');\n        this._recordUserSignal('generation_after_commands');\n      },\n    );\n    if (afterCommandsStop) {\n      this._stops.push(afterCommandsStop);\n    }\n\n    const generationStartedStop = this._bindEvent(\n      'GENERATION_STARTED',\n      (_type: string, option: { quiet_prompt?: string }, dryRun: boolean) => {\n        if (dryRun) return;\n        if (option?.quiet_prompt) return;\n      },\n    );\n    if (generationStartedStop) {\n      this._stops.push(generationStartedStop);\n    }\n\n    const generationEndedStop = this._bindEvent('GENERATION_ENDED', (_messageId: number) => {\n      if (this.ignoreNextCount > 0) {\n        this.ignoreNextCount--;\n        return;\n      }\n      this._handleTriggerCount('ai');\n    });\n    if (generationEndedStop) {\n      this._stops.push(generationEndedStop);\n    }\n\n    log(\n      `(mode=${this._config.commentTriggerMode}, interval=${this._config.triggerInterval}, prob=${this._config.triggerProbability})`,\n    );\n  },\n\n  _resolveEventName(eventKey: string): string | null {\n    try {\n      const top = window.parent ?? window;\n      const fromSillyTavern = (top as any)?.SillyTavern?.eventTypes?.[eventKey];\n      if (fromSillyTavern) return String(fromSillyTavern);\n    } catch {\n      // ignore\n    }\n\n    try {\n      const fromLegacy = (tavern_events as any)?.[eventKey];\n      if (fromLegacy) return String(fromLegacy);\n    } catch {\n      // ignore\n    }\n\n    return null;\n  },\n\n  _bindEvent(eventKey: string, handler: (...args: any[]) => void): StopHandle | null {\n    const eventName = this._resolveEventName(eventKey);\n    if (!eventName) {\n      warn(`: ${eventKey}`);\n      return null;\n    }\n\n    try {\n      const top = window.parent ?? window;\n      const eventSource = (top as any)?.SillyTavern?.eventSource;\n      if (eventSource && typeof eventSource.on === 'function') {\n        eventSource.on(eventName, handler);\n        log(`(${eventKey} -> ${eventName}, via eventSource)`);\n        return {\n          stop: () => {\n            try {\n              if (typeof eventSource.off === 'function') {\n                eventSource.off(eventName, handler);\n              }\n            } catch {\n              // ignore\n            }\n          },\n        };\n      }\n    } catch {\n      // ignore\n    }\n\n    if (typeof eventOn === 'function') {\n      const stop = eventOn(eventName as any, handler);\n      log(`(${eventKey} -> ${eventName}, via eventOn)`);\n      return stop;\n    }\n\n    warn(`: ${eventKey}`);\n    return null;\n  },\n\n  updateConfig(config: {\n    autoTrigger: boolean;\n    triggerInterval: number;\n    triggerProbability: number;\n    commentTriggerMode: CommentTriggerMode;\n  }): void {\n    this._config = { ...config };\n  },\n\n  _shouldCountBySource(source: TriggerSource): boolean {\n    const mode = this._config.commentTriggerMode;\n    return mode === 'both' || mode === source;\n  },\n\n  _recordUserSignal(source: UserSignalSource): void {\n    const now = Date.now();\n\n    // MESSAGE_SENT / USER_MESSAGE_RENDERED / GENERATION_AFTER_COMMANDS may fire in one send flow.\n    if (now - this._lastUserSignalAt < 800) {\n      log(`(${source})`);\n      return;\n    }\n\n    this._lastUserSignalAt = now;\n    this._handleTriggerCount('user');\n  },\n\n  _handleTriggerCount(source: TriggerSource): void {\n    if (!this._shouldCountBySource(source)) return;\n    this.messageCount++;\n    log(`(${source}): ${this.messageCount}`);\n    this._checkAutoTrigger();\n  },\n\n  _checkAutoTrigger(): void {\n    if (!this._config.autoTrigger || !this._onTrigger) return;\n    if (this.messageCount < this._config.triggerInterval) return;\n\n    const roll = Math.random() * 100;\n    if (roll > this._config.triggerProbability) {\n      log(`(${roll.toFixed(1)} > ${this._config.triggerProbability})`);\n      return;\n    }\n\n    this.messageCount = 0;\n    log('');\n    this._onTrigger();\n  },\n\n  manualTrigger(): void {\n    if (!this._onTrigger) return;\n    log('');\n    this._onTrigger();\n  },\n\n  resetState(): void {\n    this.messageCount = 0;\n    this.ignoreNextCount = 0;\n    this._lastUserSignalAt = 0;\n    log('');\n  },\n\n  markSelfGeneration(): void {\n    this.ignoreNextCount++;\n  },\n\n  destroy(): void {\n    for (const s of this._stops) {\n      s.stop();\n    }\n    this._stops = [];\n    this._onTrigger = null;\n    this.messageCount = 0;\n    this.ignoreNextCount = 0;\n    this._lastUserSignalAt = 0;\n  },\n};\n","import { EMOTION_TAGS, type CommentStyle } from '../core/constants';\n\n/**  */\ninterface StyleTemplate {\n  systemPrompt: string;\n  responseFormat: string;\n}\n\nexport interface RoleplayPromptOptions {\n  roleName?: string;\n  characterCardContent?: string;\n  ignoreCommentStyle?: boolean;\n}\n\nexport interface DiceReferencePromptOptions {\n  referenceText?: string;\n}\n\n/**  */\nexport const PROMPT_TEMPLATES: Record<Exclude<CommentStyle, ''>, StyleTemplate> = {\n  : {\n    systemPrompt: `\n\n`,\n    responseFormat: '1-250',\n  },\n\n  : {\n    systemPrompt: `\n`,\n    responseFormat: '1-250()(><)(  )',\n  },\n\n  : {\n    systemPrompt: `\n`,\n    responseFormat: '1-250',\n  },\n\n  : {\n    systemPrompt: `\n\"\"\"\"`,\n    responseFormat: '1-250',\n  },\n};\n\nfunction resolvePromptTemplate(\n  style: CommentStyle,\n  customPrompt: string,\n): { systemPrompt: string; responseFormat: string } {\n  if (style === '' && customPrompt) {\n    return {\n      systemPrompt: customPrompt,\n      responseFormat: '1-250',\n    };\n  }\n\n  const template = PROMPT_TEMPLATES[style as Exclude<CommentStyle, ''>] ?? PROMPT_TEMPLATES[''];\n\n  return {\n    systemPrompt: template.systemPrompt,\n    responseFormat: template.responseFormat,\n  };\n}\n\nfunction getChatResponseFormat(style: CommentStyle): string {\n  switch (style) {\n    case '':\n      return '1-380()(><)(  )';\n    case '':\n      return '1-380';\n    case '':\n      return '1-380';\n    case '':\n      return '1-380';\n    case '':\n    default:\n      return '1-380';\n  }\n}\n\nfunction appendEmotionCotFormat(responseFormat: string): string {\n  const tags = EMOTION_TAGS.join('');\n  return (\n    `${responseFormat}\\n\\n` +\n    `COT\\n` +\n    `- [|]: \\n` +\n    `-  1 ${tags}\\n` +\n    `- \\n` +\n    `-  Markdown//`\n  );\n}\n\nfunction appendZhJaBilingualFormat(responseFormat: string): string {\n  return (\n    `${responseFormat}\\n\\n` +\n    `TTS \\n` +\n    `- JP\\n` +\n    `-  COT[|]: \\n` +\n    `- JP\\n` +\n    `- TTS JP\\n` +\n    `- `\n  );\n}\n\nfunction buildRoleplayInstruction(roleplay?: RoleplayPromptOptions): string {\n  const roleName = String(roleplay?.roleName || '').trim();\n  if (!roleName) {\n    return '';\n  }\n\n  const lines = [\n    '',\n    `- ${roleName}`,\n    '- ',\n    '-  AI',\n  ];\n\n  const characterCardContent = String(roleplay?.characterCardContent || '').trim();\n  if (characterCardContent) {\n    lines.push('');\n    lines.push(characterCardContent);\n  }\n\n  return lines.join('\\n');\n}\n\nfunction shouldIgnoreStyleByRoleplay(roleplay?: RoleplayPromptOptions): boolean {\n  const roleName = String(roleplay?.roleName || '').trim();\n  return !!roleName && roleplay?.ignoreCommentStyle === true;\n}\n\nfunction buildContextLines(chatContext: Array<{ role: string; name: string; message: string }>): string {\n  return chatContext.map(msg => `${msg.name}(${msg.role}): ${String(msg.message ?? '')}`).join('\\n');\n}\n\nfunction getDiceReferenceText(diceReference?: DiceReferencePromptOptions): string {\n  return String(diceReference?.referenceText || '').trim();\n}\n\nfunction buildDiceReferenceInstruction(diceReference?: DiceReferencePromptOptions): string {\n  const referenceText = getDiceReferenceText(diceReference);\n  if (!referenceText) {\n    return '';\n  }\n\n  return (\n    `\\n` +\n    `\\n` +\n    `${referenceText}`\n  );\n}\n\nfunction appendDiceAdviceRequirement(responseFormat: string, diceReference?: DiceReferencePromptOptions): string {\n  const referenceText = getDiceReferenceText(diceReference);\n  if (!referenceText) {\n    return responseFormat;\n  }\n  return `${responseFormat}\\n 1 `;\n}\n\n/**\n *  LLM \n */\nexport function buildPrompt(\n  style: CommentStyle,\n  customPrompt: string,\n  chatContext: Array<{ role: string; name: string; message: string }>,\n  emotionCotEnabled = false,\n  roleplay?: RoleplayPromptOptions,\n  diceReference?: DiceReferencePromptOptions,\n  bilingualZhJaEnabled = false,\n): { system: string; user: string } {\n  const ignoreStyleByRoleplay = shouldIgnoreStyleByRoleplay(roleplay);\n  const { systemPrompt, responseFormat } = ignoreStyleByRoleplay\n    ? {\n        systemPrompt: '',\n        responseFormat: '1-250',\n      }\n    : resolvePromptTemplate(style, customPrompt);\n  const responseFormatWithAdvice = appendDiceAdviceRequirement(responseFormat, diceReference);\n  const responseFormatWithEmotion = emotionCotEnabled\n    ? appendEmotionCotFormat(responseFormatWithAdvice)\n    : responseFormatWithAdvice;\n  const finalFormat = bilingualZhJaEnabled\n    ? appendZhJaBilingualFormat(responseFormatWithEmotion)\n    : responseFormatWithEmotion;\n  const roleplayInstruction = buildRoleplayInstruction(roleplay);\n  const diceReferenceInstruction = buildDiceReferenceInstruction(diceReference);\n\n  // \n  const contextLines = buildContextLines(chatContext);\n\n  const systemParts = [systemPrompt];\n  if (roleplayInstruction) {\n    systemParts.push(roleplayInstruction);\n  }\n  if (diceReferenceInstruction) {\n    systemParts.push(diceReferenceInstruction);\n  }\n  systemParts.push(`${finalFormat}`);\n\n  const system = systemParts.join('\\n\\n');\n  const user = `\\n\\n${contextLines}`;\n\n  return { system, user };\n}\n\n/**\n * \n */\nexport function buildChatPrompt(\n  style: CommentStyle,\n  customPrompt: string,\n  chatContext: Array<{ role: string; name: string; message: string }>,\n  userMessage: string,\n  emotionCotEnabled = false,\n  roleplay?: RoleplayPromptOptions,\n  diceReference?: DiceReferencePromptOptions,\n  bilingualZhJaEnabled = false,\n): { system: string; user: string } {\n  const ignoreStyleByRoleplay = shouldIgnoreStyleByRoleplay(roleplay);\n  const { systemPrompt } = ignoreStyleByRoleplay\n    ? {\n        systemPrompt: '',\n      }\n    : resolvePromptTemplate(style, customPrompt);\n  const responseFormat = ignoreStyleByRoleplay ? '1-380' : getChatResponseFormat(style);\n  const responseFormatWithAdvice = appendDiceAdviceRequirement(responseFormat, diceReference);\n  const responseFormatWithEmotion = emotionCotEnabled\n    ? appendEmotionCotFormat(responseFormatWithAdvice)\n    : responseFormatWithAdvice;\n  const finalFormat = bilingualZhJaEnabled\n    ? appendZhJaBilingualFormat(responseFormatWithEmotion)\n    : responseFormatWithEmotion;\n  const roleplayInstruction = buildRoleplayInstruction(roleplay);\n  const diceReferenceInstruction = buildDiceReferenceInstruction(diceReference);\n  const roleName = String(roleplay?.roleName || '').trim();\n\n  const contextLines = buildContextLines(chatContext);\n  const safeUserMessage = String(userMessage || '').trim();\n\n  const systemParts = [systemPrompt];\n  if (roleplayInstruction) {\n    systemParts.push(roleplayInstruction);\n  }\n  if (diceReferenceInstruction) {\n    systemParts.push(diceReferenceInstruction);\n  }\n  systemParts.push(`${finalFormat}`);\n  systemParts.push(roleName ? '' : '');\n\n  const system = systemParts.join('\\n\\n');\n\n  const user =\n    `\\n\\n` +\n    `${contextLines || '()'}\\n\\n` +\n    `\\n${safeUserMessage}\\n\\n` +\n    ``;\n\n  return { system, user };\n}\n","import { useSettingsStore } from '../core/settings';\nimport { error, log, warn } from '../utils/dom';\nimport { ChatMonitor } from './monitor';\nimport {\n  buildChatPrompt,\n  buildPrompt,\n  type DiceReferencePromptOptions,\n  type RoleplayPromptOptions,\n} from './prompt-templates';\n\ntype CommentCallback = (text: string, isDone: boolean) => void;\n\n/**\n * \n *  LLM / UI\n */\nexport const Commentator = {\n  isGenerating: false,\n\n  _onComment: null as CommentCallback | null,\n  _streamStop: null as { stop: () => void } | null,\n  _latestStreamText: '',\n\n  setCallback(cb: CommentCallback): void {\n    this._onComment = cb;\n  },\n\n  async generate(): Promise<void> {\n    if (this.isGenerating) {\n      log('');\n      return;\n    }\n\n    this.isGenerating = true;\n    log('');\n    let emittedDone = false;\n\n    try {\n      this._onComment?.('', false);\n\n      const store = useSettingsStore();\n      const s = store.settings;\n\n      let chatMessages = this._getChatContext(s.maxChatContext);\n      if (s.useTamakoTodaySpecial) {\n        const todaySpecial = this._getTamakoTodaySpecialContent();\n        if (todaySpecial) {\n          chatMessages = [\n            ...chatMessages,\n            {\n              role: 'system',\n              name: '',\n              message: todaySpecial,\n            },\n          ];\n          log(`${todaySpecial.length} `);\n        } else {\n          log('');\n        }\n      }\n\n      if (chatMessages.length === 0) {\n        log('');\n        return;\n      }\n\n      const roleplayOptions = this._resolveRoleplayOptions({\n        roleName: s.roleplayName,\n        ignoreCommentStyle: !!s.roleplayIgnoreCommentStyle,\n        sendCharacterCardContent: !!s.sendCharacterCardContent,\n      });\n      const diceReferenceOptions = this._resolveDiceReferenceOptions(\n        !!s.useDiceDatabaseReference,\n        (s as any).diceReferenceVisibleSheets,\n      );\n      const { system, user } = buildPrompt(\n        s.commentStyle,\n        s.customPrompt,\n        chatMessages,\n        !!s.emotionCotEnabled,\n        roleplayOptions,\n        diceReferenceOptions,\n        !!s.ttsBilingualZhJaEnabled,\n      );\n\n      this._latestStreamText = '';\n      let result: string;\n\n      if (s.apiMode === 'custom' && s.apiConfig.url) {\n        result = await this._generateCustom(system, user, s.apiConfig);\n      } else {\n        ChatMonitor.markSelfGeneration();\n        result = await this._generateTavern(\n          system,\n          user,\n          s.apiConfig.max_tokens,\n          s.apiConfig.temperature,\n          !!s.apiConfig.sendWorldInfo,\n        );\n      }\n\n      const finalText = String(result || '').trim() || String(this._latestStreamText || '').trim();\n      if (finalText) {\n        this._onComment?.(finalText, true);\n        emittedDone = true;\n      } else {\n        warn('');\n      }\n    } catch (e) {\n      error(':', e);\n    } finally {\n      if (!emittedDone) {\n        this._onComment?.('', true);\n      }\n      this.isGenerating = false;\n    }\n  },\n\n  /**\n   * \n   * - \n   * -  API  API /  API\n   */\n  async chat(userMessage: string): Promise<void> {\n    const input = String(userMessage || '').trim();\n    if (!input) return;\n\n    if (this.isGenerating) {\n      log('');\n      return;\n    }\n\n    this.isGenerating = true;\n    log('');\n    let emittedDone = false;\n\n    try {\n      this._onComment?.('', false);\n\n      const store = useSettingsStore();\n      const s = store.settings;\n\n      const chatMessages = this._getChatContext(s.maxChatContext);\n      const roleplayOptions = this._resolveRoleplayOptions({\n        roleName: s.roleplayName,\n        ignoreCommentStyle: !!s.roleplayIgnoreCommentStyle,\n        sendCharacterCardContent: !!s.sendCharacterCardContent,\n      });\n      const diceReferenceOptions = this._resolveDiceReferenceOptions(\n        !!s.useDiceDatabaseReference,\n        (s as any).diceReferenceVisibleSheets,\n      );\n      const { system, user } = buildChatPrompt(\n        s.commentStyle,\n        s.customPrompt,\n        chatMessages,\n        input,\n        !!s.emotionCotEnabled,\n        roleplayOptions,\n        diceReferenceOptions,\n        !!s.ttsBilingualZhJaEnabled,\n      );\n\n      this._latestStreamText = '';\n      let result: string;\n\n      if (s.apiMode === 'custom' && s.apiConfig.url) {\n        result = await this._generateCustom(system, user, s.apiConfig);\n      } else {\n        ChatMonitor.markSelfGeneration();\n        result = await this._generateTavern(\n          system,\n          user,\n          s.apiConfig.max_tokens,\n          s.apiConfig.temperature,\n          !!s.apiConfig.sendWorldInfo,\n        );\n      }\n\n      const finalText = String(result || '').trim() || String(this._latestStreamText || '').trim();\n      if (finalText) {\n        this._onComment?.(finalText, true);\n        emittedDone = true;\n      } else {\n        warn('');\n      }\n    } catch (e) {\n      error(':', e);\n    } finally {\n      if (!emittedDone) {\n        this._onComment?.('', true);\n      }\n      this.isGenerating = false;\n    }\n  },\n\n  async _generateTavern(\n    system: string,\n    user: string,\n    maxTokens: number,\n    temperature: number,\n    sendWorldInfo: boolean,\n  ): Promise<string> {\n    this._setupStreamListener();\n    const orderedPrompts: Array<\n      'world_info_before' | 'world_info_after' | { role: 'system' | 'assistant' | 'user'; content: string }\n    > = sendWorldInfo\n      ? ['world_info_before', { role: 'system', content: system }, 'world_info_after', { role: 'user', content: user }]\n      : [\n          { role: 'system', content: system },\n          { role: 'user', content: user },\n        ];\n\n    try {\n      return await generateRaw({\n        should_silence: true,\n        should_stream: true,\n        ordered_prompts: orderedPrompts,\n        custom_api: undefined,\n      });\n    } finally {\n      this._cleanupStreamListener();\n    }\n  },\n\n  async _generateCustom(\n    system: string,\n    user: string,\n    apiConfig: {\n      url: string;\n      apiKey: string;\n      model: string;\n      source: string;\n      max_tokens: number;\n      temperature: number;\n      frequency_penalty: number;\n      presence_penalty: number;\n      top_p: number;\n      top_k: number;\n      usePresetSampling: boolean;\n      sendWorldInfo?: boolean;\n    },\n  ): Promise<string> {\n    const apiUrl = String(apiConfig.url || '').trim();\n    const apiKey = String(apiConfig.apiKey || '').trim();\n    const model = String(apiConfig.model || '')\n      .trim()\n      .replace(/^models\\//, '');\n\n    if (!apiUrl) {\n      throw new Error(' API URL ');\n    }\n    if (!model) {\n      throw new Error(' API ');\n    }\n\n    const usePreset = !!apiConfig.usePresetSampling;\n    const sendWorldInfo = !!apiConfig.sendWorldInfo;\n    const requestUrl = '/api/backends/chat-completions/generate';\n    const orderedPrompts = [\n      { role: 'system', content: system },\n      { role: 'user', content: user },\n    ];\n\n    const buildAttemptBody = (attempt: 'full' | 'safe' | 'minimal') => {\n      const body: Record<string, unknown> = {\n        messages: orderedPrompts,\n        model,\n        stream: false,\n        chat_completion_source: 'custom',\n        custom_prompt_post_processing: sendWorldInfo ? 'strict' : 'none',\n        reverse_proxy: apiUrl,\n        custom_url: apiUrl,\n        custom_include_headers: apiKey ? `Authorization: Bearer ${apiKey}` : '',\n      };\n\n      //  OpenAI \n      if (!usePreset && attempt !== 'minimal') {\n        body.max_tokens = apiConfig.max_tokens;\n        body.temperature = apiConfig.temperature;\n        body.top_p = apiConfig.top_p;\n      }\n\n      if (!usePreset && attempt === 'full') {\n        body.frequency_penalty = apiConfig.frequency_penalty;\n        body.presence_penalty = apiConfig.presence_penalty;\n        body.top_k = apiConfig.top_k;\n      }\n\n      return body;\n    };\n\n    const requestWithAttempt = async (attempt: 'full' | 'safe' | 'minimal'): Promise<string> => {\n      const response = await fetch(requestUrl, {\n        method: 'POST',\n        headers: {\n          ...SillyTavern.getRequestHeaders(),\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(buildAttemptBody(attempt)),\n      });\n\n      if (!response.ok) {\n        const errTxt = await response.text();\n        const err = new Error(`API: ${response.status} ${errTxt || response.statusText}`);\n        (err as Error & { status?: number }).status = response.status;\n        throw err;\n      }\n\n      const data = (await response.json()) as any;\n      if (data?.choices?.[0]?.message?.content) {\n        return String(data.choices[0].message.content).trim();\n      }\n      if (typeof data?.content === 'string') {\n        return data.content.trim();\n      }\n      if (typeof data?.text === 'string') {\n        return data.text.trim();\n      }\n\n      const details = typeof data === 'object' ? JSON.stringify(data) : String(data);\n      throw new Error(`API: ${details}`);\n    };\n\n    const attempts: Array<'full' | 'safe' | 'minimal'> = ['full', 'safe', 'minimal'];\n    let lastError: unknown = null;\n\n    for (let i = 0; i < attempts.length; i++) {\n      const attempt = attempts[i];\n      try {\n        if (i > 0) {\n          warn(` API ${attempt}`);\n        }\n        return await requestWithAttempt(attempt);\n      } catch (e) {\n        lastError = e;\n        const status = (e as { status?: number } | null)?.status;\n        const msg = e instanceof Error ? e.message : String(e);\n        const is422 = status === 422 || /\\b422\\b/.test(msg);\n        const canRetry = is422 && i < attempts.length - 1;\n        if (!canRetry) throw e;\n        warn(` API  422${attempt} -> ${attempts[i + 1]}`);\n      }\n    }\n\n    throw lastError instanceof Error ? lastError : new Error(String(lastError));\n  },\n\n  _setupStreamListener(): void {\n    this._cleanupStreamListener();\n    this._streamStop = eventOn(iframe_events.STREAM_TOKEN_RECEIVED_FULLY, (fullText: string) => {\n      this._latestStreamText = String(fullText || '');\n      this._onComment?.(fullText, false);\n    });\n  },\n\n  _cleanupStreamListener(): void {\n    if (this._streamStop) {\n      this._streamStop.stop();\n      this._streamStop = null;\n    }\n  },\n\n  _getChatContext(maxCount: number): Array<{ role: string; name: string; message: string }> {\n    try {\n      const messages = getChatMessages(`0-{{lastMessageId}}`, {\n        role: 'all',\n        hide_state: 'unhidden',\n      });\n\n      const list = Array.isArray(messages) ? messages : [];\n      const safeMaxCount = Number.isFinite(maxCount) && maxCount > 0 ? Math.floor(maxCount) : 20;\n      const recent = list.slice(-safeMaxCount);\n\n      return recent.map(msg => ({\n        role: msg.role,\n        name: msg.name,\n        message: msg.message,\n      }));\n    } catch (e) {\n      warn(':', e);\n      return [];\n    }\n  },\n\n  _resolveRoleplayOptions(config: {\n    roleName?: string;\n    ignoreCommentStyle?: boolean;\n    sendCharacterCardContent?: boolean;\n  }): RoleplayPromptOptions | undefined {\n    const roleName = String(config.roleName || '').trim();\n    if (!roleName) {\n      return undefined;\n    }\n\n    const roleplay: RoleplayPromptOptions = {\n      roleName,\n      ignoreCommentStyle: config.ignoreCommentStyle === true,\n    };\n    if (config.sendCharacterCardContent) {\n      const characterCardContent = this._getCurrentCharacterCardContent();\n      if (characterCardContent) {\n        roleplay.characterCardContent = characterCardContent;\n      } else {\n        log('');\n      }\n    }\n\n    return roleplay;\n  },\n\n  _resolveDiceReferenceOptions(enabled: boolean, visibleSheets?: unknown): DiceReferencePromptOptions | undefined {\n    if (!enabled) {\n      return undefined;\n    }\n\n    const visibleSheetNames = this._normalizeDiceVisibleSheetNames(visibleSheets);\n    const referenceText = this._getDiceDatabaseReferenceContent(visibleSheetNames);\n    if (!referenceText) {\n      log('');\n      return undefined;\n    }\n\n    log(`${referenceText.length} `);\n    return { referenceText };\n  },\n\n  _getDiceDatabaseReferenceContent(visibleSheetNames: string[]): string {\n    const apiData = this._getDiceDatabaseDataFromApi();\n    if (apiData) {\n      const apiSummary = this._summarizeDiceDatabasePayload(\n        apiData,\n        'AutoCardUpdaterAPI.exportTableAsJson',\n        visibleSheetNames,\n      );\n      if (apiSummary) {\n        return apiSummary;\n      }\n    }\n\n    const chatData = this._getDiceDatabaseDataFromChatContext();\n    if (!chatData) {\n      return '';\n    }\n\n    return this._summarizeDiceDatabasePayload(chatData, ' TavernDB_ACU_* ', visibleSheetNames);\n  },\n\n  _getDiceDatabaseDataFromApi(): Record<string, unknown> | null {\n    try {\n      const topWindow = window.parent ?? window;\n      const api = (topWindow as any)?.AutoCardUpdaterAPI;\n      if (!api || typeof api.exportTableAsJson !== 'function') {\n        return null;\n      }\n\n      return this._normalizeDiceDatabasePayload(api.exportTableAsJson());\n    } catch (e) {\n      warn(' API :', e);\n      return null;\n    }\n  },\n\n  _getDiceDatabaseDataFromChatContext(): Record<string, unknown> | null {\n    try {\n      const messages = getChatMessages(`0-{{lastMessageId}}`, {\n        role: 'all',\n        hide_state: 'all',\n      });\n      const list = Array.isArray(messages) ? messages : [];\n\n      for (let i = list.length - 1; i >= 0; i--) {\n        const payload = this._pickDiceDatabasePayloadFromMessage(list[i] as any);\n        if (payload) {\n          return payload;\n        }\n      }\n    } catch (e) {\n      warn(':', e);\n    }\n\n    return null;\n  },\n\n  _pickDiceDatabasePayloadFromMessage(message: any): Record<string, unknown> | null {\n    if (!message || typeof message !== 'object') {\n      return null;\n    }\n\n    const directCandidates: unknown[] = [\n      message.TavernDB_ACU_IndependentData,\n      message.TavernDB_ACU_Data,\n      message.TavernDB_ACU_SummaryData,\n      message.data?.TavernDB_ACU_IndependentData,\n      message.data?.TavernDB_ACU_Data,\n      message.data?.TavernDB_ACU_SummaryData,\n    ];\n    for (const candidate of directCandidates) {\n      const payload = this._normalizeDiceDatabasePayload(candidate);\n      if (payload) {\n        return payload;\n      }\n    }\n\n    const isolatedCandidates: unknown[] = [message.TavernDB_ACU_IsolatedData, message.data?.TavernDB_ACU_IsolatedData];\n    for (const candidate of isolatedCandidates) {\n      const payload = this._pickDiceDatabasePayloadFromIsolatedData(candidate);\n      if (payload) {\n        return payload;\n      }\n    }\n\n    return null;\n  },\n\n  _pickDiceDatabasePayloadFromIsolatedData(value: unknown): Record<string, unknown> | null {\n    const isolated = this._parseMaybeJsonRecord(value);\n    if (!isolated) {\n      return null;\n    }\n\n    const keys = Object.keys(isolated);\n    for (let i = keys.length - 1; i >= 0; i--) {\n      const slot = this._parseMaybeJsonRecord(isolated[keys[i]]);\n      if (!slot) {\n        continue;\n      }\n      const payload = this._normalizeDiceDatabasePayload(slot.independentData);\n      if (payload) {\n        return payload;\n      }\n    }\n\n    return null;\n  },\n\n  _normalizeDiceDatabasePayload(value: unknown): Record<string, unknown> | null {\n    const record = this._parseMaybeJsonRecord(value);\n    if (!record) {\n      return null;\n    }\n    if (this._isDiceDatabasePayload(record)) {\n      return record;\n    }\n\n    const independentData = this._parseMaybeJsonRecord(record.independentData);\n    if (independentData && this._isDiceDatabasePayload(independentData)) {\n      return independentData;\n    }\n\n    return null;\n  },\n\n  _parseMaybeJsonRecord(value: unknown): Record<string, unknown> | null {\n    if (typeof value === 'string') {\n      const text = value.trim();\n      if (!text) {\n        return null;\n      }\n      try {\n        return this._parseMaybeJsonRecord(JSON.parse(text));\n      } catch {\n        return null;\n      }\n    }\n\n    if (!value || typeof value !== 'object' || Array.isArray(value)) {\n      return null;\n    }\n    return value as Record<string, unknown>;\n  },\n\n  _isDiceDatabasePayload(value: Record<string, unknown>): boolean {\n    return Object.keys(value).some(key => key.startsWith('sheet_'));\n  },\n\n  _summarizeDiceDatabasePayload(\n    data: Record<string, unknown>,\n    sourceLabel: string,\n    visibleSheetNames: string[],\n  ): string {\n    const visibleNameSet = new Set(\n      visibleSheetNames.map(name => this._normalizeReferenceText(name)).filter(name => !!name),\n    );\n    const sheets = Object.keys(data)\n      .filter(key => key.startsWith('sheet_'))\n      .map(key => this._parseMaybeJsonRecord(data[key]))\n      .filter((sheet): sheet is Record<string, unknown> => !!sheet)\n      .map(sheet => {\n        const name = this._normalizeReferenceText(sheet.name || '');\n        return {\n          name,\n          priority: this._getDiceSheetPriority(name),\n          text: this._buildDiceSheetSummary(sheet),\n        };\n      })\n      .filter(item => !!item.text)\n      .filter(item => visibleNameSet.size === 0 || visibleNameSet.has(item.name))\n      .sort((a, b) => a.priority - b.priority || a.name.localeCompare(b.name, 'zh-CN'))\n      .slice(0, 8);\n\n    if (sheets.length === 0) {\n      return '';\n    }\n\n    const maxLength = 1800;\n    const lines = [`${sourceLabel}`, ''];\n\n    for (const item of sheets) {\n      const nextLine = `- ${item.text}`;\n      const nextText = `${lines.join('\\n')}\\n${nextLine}`;\n      if (nextText.length > maxLength) {\n        break;\n      }\n      lines.push(nextLine);\n    }\n\n    return lines.join('\\n');\n  },\n\n  _normalizeDiceVisibleSheetNames(value: unknown): string[] {\n    if (!Array.isArray(value)) {\n      return [];\n    }\n    const list: string[] = [];\n    const seen = new Set<string>();\n    for (const item of value) {\n      const name = this._normalizeReferenceText(item);\n      if (!name) {\n        continue;\n      }\n      if (seen.has(name)) {\n        continue;\n      }\n      seen.add(name);\n      list.push(name);\n    }\n    return list;\n  },\n\n  _getDiceSheetPriority(sheetName: string): number {\n    const map: Record<string, number> = {\n      : 0,\n      : 1,\n      : 2,\n      : 3,\n      : 4,\n      : 5,\n    };\n    return map[sheetName] ?? 99;\n  },\n\n  _buildDiceSheetSummary(sheet: Record<string, unknown>): string {\n    const sheetName = this._normalizeReferenceText(sheet.name || '') || '';\n    const content = Array.isArray(sheet.content) ? (sheet.content as unknown[]) : [];\n    const rows = content.filter((row): row is unknown[] => Array.isArray(row));\n\n    if (rows.length === 0) {\n      return '';\n    }\n\n    const headerRow = Array.isArray(rows[0]) ? rows[0] : [];\n    const headers = headerRow.map((cell, index) => this._normalizeReferenceText(cell) || `${index}`);\n    const dataRows = rows\n      .slice(1)\n      .filter(row => row.some((cell, index) => index > 0 && !!this._normalizeReferenceText(cell)));\n\n    if (dataRows.length === 0) {\n      return `${sheetName}: `;\n    }\n\n    const rowText = dataRows\n      .slice(-2)\n      .map(row => this._formatDiceSheetRow(headers, row))\n      .filter(text => !!text);\n    if (rowText.length === 0) {\n      return `${sheetName}: `;\n    }\n\n    return `${sheetName}: ${rowText.join(' | ')}`;\n  },\n\n  _formatDiceSheetRow(headers: string[], row: unknown[]): string {\n    const pairs: string[] = [];\n    for (let index = 1; index < row.length; index++) {\n      const value = this._normalizeReferenceText(row[index]);\n      if (!value) {\n        continue;\n      }\n      const label = headers[index] || `${index}`;\n      pairs.push(`${label}: ${this._truncateReferenceText(value, 56)}`);\n      if (pairs.length >= 3) {\n        break;\n      }\n    }\n\n    if (pairs.length > 0) {\n      return pairs.join('');\n    }\n\n    const fallback = row.map(cell => this._normalizeReferenceText(cell)).find(text => !!text) || '';\n    return this._truncateReferenceText(fallback, 90);\n  },\n\n  _normalizeReferenceText(value: unknown): string {\n    return String(value ?? '')\n      .replace(/\\u00a0/g, ' ')\n      .replace(/\\r\\n/g, '\\n')\n      .replace(/\\n+/g, ' ')\n      .replace(/\\s{2,}/g, ' ')\n      .trim();\n  },\n\n  _truncateReferenceText(text: string, maxLength: number): string {\n    if (text.length <= maxLength) {\n      return text;\n    }\n    return `${text.slice(0, Math.max(0, maxLength - 1))}`;\n  },\n\n  _getCurrentCharacterCardContent(): string {\n    try {\n      const context = SillyTavern?.getContext?.() as any;\n      if (!context) {\n        return '';\n      }\n\n      const characters = Array.isArray(context.characters) ? context.characters : [];\n      if (characters.length === 0) {\n        return '';\n      }\n\n      const charIdRaw = context.characterId;\n      let current: any = null;\n\n      if (charIdRaw !== undefined && charIdRaw !== null) {\n        const idText = String(charIdRaw).trim();\n        const idNum = Number(idText);\n        if (Number.isFinite(idNum) && idNum >= 0 && idNum < characters.length) {\n          current = characters[idNum];\n        }\n      }\n\n      if (!current) {\n        const currentName = String(context.name2 || '').trim();\n        if (currentName) {\n          current = characters.find((item: any) => String(item?.name || '').trim() === currentName) || null;\n        }\n      }\n\n      if (!current && characters.length === 1) {\n        current = characters[0];\n      }\n\n      if (!current) {\n        return '';\n      }\n\n      const fields: Array<[string, unknown]> = [\n        ['', current.name],\n        ['', current.description ?? current.data?.description],\n        ['', current.personality ?? current.data?.personality],\n        ['', current.scenario ?? current.data?.scenario],\n        ['', current.first_mes ?? current.data?.first_mes],\n        ['', current.mes_example ?? current.data?.mes_example],\n        ['', current.data?.system_prompt],\n        ['', current.data?.post_history_instructions],\n      ];\n\n      const lines = fields\n        .map(([label, value]) => {\n          const text = this._normalizeCharacterCardField(value);\n          return text ? `${label}: ${text}` : '';\n        })\n        .filter(line => !!line);\n\n      return lines.join('\\n');\n    } catch (e) {\n      warn(':', e);\n      return '';\n    }\n  },\n\n  _normalizeCharacterCardField(value: unknown): string {\n    return String(value ?? '')\n      .replace(/\\u00a0/g, ' ')\n      .replace(/\\r\\n/g, '\\n')\n      .replace(/\\n{3,}/g, '\\n\\n')\n      .trim();\n  },\n\n  _getTamakoTodaySpecialContent(): string {\n    try {\n      const topWindow = window.parent ?? window;\n      const topDocument = topWindow.document ?? document;\n      const currentSelector = '#tamako-market-window .tamako-content[data-content=\"current\"]';\n\n      const emptyMessage = topDocument.querySelector(`${currentSelector} .tamako-empty .message`);\n      if (emptyMessage) {\n        return '';\n      }\n\n      const plotContent = topDocument.querySelector(`${currentSelector} .tamako-plot-content`) as HTMLElement | null;\n      const directText = this._sanitizeTamakoText(plotContent?.innerText || plotContent?.textContent || '');\n      if (directText) {\n        return directText;\n      }\n\n      const beautifierFrame = topDocument.querySelector(\n        `${currentSelector} iframe.tamako-beautifier-frame`,\n      ) as HTMLIFrameElement | null;\n      const payload = this._readTamakoPayloadFromIframe(beautifierFrame);\n      const payloadText = this._extractTamakoTextFromPayload(payload);\n      if (payloadText) {\n        return payloadText;\n      }\n\n      const currentContent = topDocument.querySelector(currentSelector) as HTMLElement | null;\n      return this._sanitizeTamakoText(currentContent?.innerText || currentContent?.textContent || '');\n    } catch (e) {\n      warn(':', e);\n      return '';\n    }\n  },\n\n  _readTamakoPayloadFromIframe(iframe: HTMLIFrameElement | null): any | null {\n    if (!iframe) {\n      return null;\n    }\n    const name = String(iframe.name || '').trim();\n    if (!name.startsWith('TAMAKO_DATA:')) {\n      return null;\n    }\n    try {\n      return JSON.parse(name.slice('TAMAKO_DATA:'.length));\n    } catch (e) {\n      warn(' payload :', e);\n      return null;\n    }\n  },\n\n  _extractTamakoTextFromPayload(payload: any): string {\n    if (!payload || typeof payload !== 'object') {\n      return '';\n    }\n\n    const captureTags = this._getTamakoCaptureTags();\n    const tags = payload.tags && typeof payload.tags === 'object' ? payload.tags : {};\n    const valuesFromTags: string[] = [];\n    for (const tag of captureTags) {\n      const value = this._sanitizeTamakoText(tags[tag]);\n      if (value) {\n        valuesFromTags.push(value);\n      }\n    }\n    if (valuesFromTags.length > 0) {\n      return valuesFromTags.join('\\n\\n');\n    }\n\n    const raw = String(payload.raw || '');\n    if (!raw) {\n      return '';\n    }\n    return this._extractTamakoTagText(raw, captureTags);\n  },\n\n  _getTamakoCaptureTags(): string[] {\n    try {\n      const context = SillyTavern?.getContext?.() as any;\n      const tags = context?.extensionSettings?.TamakoMarket?.captureTags;\n      if (Array.isArray(tags)) {\n        const normalized = tags.map(tag => String(tag || '').trim()).filter(tag => !!tag);\n        if (normalized.length > 0) {\n          return normalized;\n        }\n      }\n    } catch {\n      // ignore\n    }\n    return ['recall', 'scene_direction'];\n  },\n\n  _extractTamakoTagText(raw: string, tags: string[]): string {\n    const values: string[] = [];\n    for (const tag of tags) {\n      const safeTag = String(tag || '').trim();\n      if (!safeTag) {\n        continue;\n      }\n      const escapedTag = safeTag.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n      const regex = new RegExp(`<${escapedTag}(?:\\\\s[^>]*)?>([\\\\s\\\\S]*?)<\\\\/${escapedTag}>`, 'gi');\n      let match: RegExpExecArray | null;\n      while ((match = regex.exec(raw)) !== null) {\n        const value = this._sanitizeTamakoText(match[1] || '');\n        if (value) {\n          values.push(value);\n        }\n      }\n    }\n    return values.join('\\n\\n');\n  },\n\n  _sanitizeTamakoText(value: unknown): string {\n    const text = String(value ?? '')\n      .replace(/\\u00a0/g, ' ')\n      .replace(/\\r\\n/g, '\\n')\n      .replace(/\\n{3,}/g, '\\n\\n')\n      .trim();\n    if (!text) {\n      return '';\n    }\n    if (/^(~|\\.\\.\\.||\\.\\.\\.|\\.\\.\\.|\\.\\.\\.)$/.test(text)) {\n      return '';\n    }\n    return text;\n  },\n\n  destroy(): void {\n    this._cleanupStreamListener();\n    this._onComment = null;\n    this._latestStreamText = '';\n    this.isGenerating = false;\n  },\n};\n","import type { EmotionTag } from '../core/constants';\nimport { resolveEmotionTag, type EmotionConfig } from '../core/emotion';\n\nconst RE_THINK_CLOSED = /<(think|thinking)>[\\s\\S]*?<\\/\\1>/gi;\nconst RE_THINK_UNCLOSED = /<(think|thinking)>[\\s\\S]*$/gi;\n\nexport type EmotionCotParseResult = {\n  cleanText: string;\n  rawTag: string | null;\n  normalizedTag: EmotionTag | null;\n  context: string | null;\n};\n\nexport function stripThinkBlocks(input: unknown): string {\n  const text = String(input || '');\n  return text.replace(RE_THINK_CLOSED, '').replace(RE_THINK_UNCLOSED, '');\n}\n\nfunction parseBracketContent(bracketContent: string): { rawTag: string; context: string | null } {\n  const content = String(bracketContent || '').trim();\n  if (!content) return { rawTag: '', context: null };\n\n  const pipeParts = content.split('|');\n  const exprVoicePart = (pipeParts[0] || '').trim();\n  const context = (pipeParts[1] || '').trim();\n\n  const expression = (exprVoicePart.split(',')[0] || '').trim();\n  return { rawTag: expression, context: context || null };\n}\n\nfunction isPendingPrefix(text: string): boolean {\n  const t = String(text || '').trimStart();\n  if (!t) return false;\n\n  if (t.startsWith('[')) {\n    const close = t.indexOf(']');\n    if (close === -1) return true;\n    const body = t.slice(close + 1);\n    return !body.trim();\n  }\n\n  const open = t.indexOf('[');\n  if (open > 0 && open < 30) {\n    const close = t.indexOf(']', open + 1);\n    if (close === -1) return true;\n    const after = t.slice(close + 1);\n    if (!/^\\s*[:]/.test(after)) return true;\n    const body = after.replace(/^\\s*[:]\\s*/, '');\n    return !body.trim();\n  }\n\n  return false;\n}\n\nexport function parseEmotionCotText(\n  input: unknown,\n  options: {\n    enabled: boolean;\n    stripFromText: boolean;\n    configs: EmotionConfig[];\n  },\n): EmotionCotParseResult {\n  const rawText = stripThinkBlocks(input);\n\n  if (!options.enabled) {\n    return {\n      cleanText: rawText,\n      rawTag: null,\n      normalizedTag: null,\n      context: null,\n    };\n  }\n\n  if (isPendingPrefix(rawText)) {\n    return {\n      cleanText: '',\n      rawTag: null,\n      normalizedTag: null,\n      context: null,\n    };\n  }\n\n  // Speaker : [|]: \n  const speakerMatch = rawText.match(/^\\s*([^\\[\\]\\n\\r]{1,40})\\s*\\[([^\\]]+)\\]\\s*[:]\\s*([\\s\\S]*)$/);\n  if (speakerMatch) {\n    const bracketContent = speakerMatch[2] || '';\n    const body = speakerMatch[3] || '';\n    const { rawTag, context } = parseBracketContent(bracketContent);\n    const normalizedTag = resolveEmotionTag(rawTag, options.configs);\n\n    return {\n      cleanText: normalizedTag && options.stripFromText ? body.trimStart() : rawText,\n      rawTag: rawTag || null,\n      normalizedTag,\n      context,\n    };\n  }\n\n  // : [|] \n  const prefixMatch = rawText.match(/^\\s*\\[([^\\]]+)\\]\\s*([\\s\\S]*)$/);\n  if (prefixMatch) {\n    const bracketContent = prefixMatch[1] || '';\n    const body = prefixMatch[2] || '';\n    const { rawTag, context } = parseBracketContent(bracketContent);\n    const normalizedTag = resolveEmotionTag(rawTag, options.configs);\n\n    return {\n      cleanText: normalizedTag && options.stripFromText ? body.trimStart() : rawText,\n      rawTag: rawTag || null,\n      normalizedTag,\n      context,\n    };\n  }\n\n  return {\n    cleanText: rawText,\n    rawTag: null,\n    normalizedTag: null,\n    context: null,\n  };\n}\n","import { defineStore } from 'pinia';\nimport { ref } from 'vue';\n\n/**\n *  UI \n */\nexport const useUiStore = defineStore('desktop-pet-ui', () => {\n  const showSettings = ref(false);\n\n  function openSettings(): void {\n    showSettings.value = true;\n  }\n\n  function closeSettings(): void {\n    showSettings.value = false;\n  }\n\n  return { showSettings, openSettings, closeSettings };\n});\n\n","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"bubble-content\" };\nconst _hoisted_2 = { class: \"bubble-text\" };\nconst _hoisted_3 = {\n    key: 1,\n    class: \"cursor\"\n};\nimport { onUnmounted, ref, watch } from 'vue';\nimport { Live2DManager } from '../live2d/manager';\nconst HEAD_ANCHOR_RATIO = 0.2;\nconst BUBBLE_GAP = 12;\nconst MIN_BUBBLE_TOP = 8;\nconst EDGE_PADDING = 8;\nconst LOADING_INTERVAL_MS = 340;\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ChatBubble',\n    props: {\n        text: {},\n        isDone: { type: Boolean },\n        autoCloseDelaySeconds: {}\n    },\n    emits: [\"hidden\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const visible = ref(false);\n        const displayText = ref('');\n        const bubbleStyle = ref({});\n        const LOADING_FRAMES = ['', '', '', ''];\n        let positionTimer = null;\n        let loadingTimer = null;\n        let autoCloseTimer = null;\n        let loadingFrameIndex = 0;\n        function getTopWindow() {\n            try {\n                return window.parent ?? window;\n            }\n            catch {\n                return window;\n            }\n        }\n        function getFiniteNumber(value) {\n            const n = typeof value === 'number' ? value : Number(value);\n            return Number.isFinite(n) ? n : null;\n        }\n        function getModelHeadAnchor(rect) {\n            const model = Live2DManager.model;\n            if (!model || typeof model.getBounds !== 'function')\n                return null;\n            try {\n                const bounds = model.getBounds?.();\n                const x = getFiniteNumber(bounds?.x);\n                const y = getFiniteNumber(bounds?.y);\n                const width = getFiniteNumber(bounds?.width);\n                const height = getFiniteNumber(bounds?.height);\n                if (x === null || y === null || width === null || height === null || width <= 0 || height <= 0) {\n                    return null;\n                }\n                return {\n                    x: rect.left + x + width / 2,\n                    y: rect.top + y + height * HEAD_ANCHOR_RATIO,\n                };\n            }\n            catch {\n                return null;\n            }\n        }\n        function updateBubblePosition() {\n            try {\n                const top = getTopWindow();\n                const stage = top.document.getElementById('desktop-pet-stage');\n                const rect = stage?.getBoundingClientRect?.();\n                const vw = top.innerWidth || top.document.documentElement.clientWidth || 0;\n                const vh = top.innerHeight || top.document.documentElement.clientHeight || 0;\n                if (rect && rect.width > 0 && rect.height > 0) {\n                    const anchor = getModelHeadAnchor(rect);\n                    const fallbackX = rect.left + rect.width / 2;\n                    const fallbackY = rect.top + rect.height * 0.22;\n                    const rawLeft = anchor?.x ?? fallbackX;\n                    const rawTop = (anchor?.y ?? fallbackY) - BUBBLE_GAP;\n                    const safeLeft = Math.max(EDGE_PADDING, Math.min(rawLeft, Math.max(EDGE_PADDING, vw - EDGE_PADDING)));\n                    const safeTop = Math.max(MIN_BUBBLE_TOP, Math.min(rawTop, Math.max(MIN_BUBBLE_TOP, vh - EDGE_PADDING)));\n                    bubbleStyle.value = {\n                        left: `${Math.round(safeLeft)}px`,\n                        top: `${Math.round(safeTop)}px`,\n                    };\n                    return;\n                }\n                bubbleStyle.value = {\n                    left: `${Math.round(vw * 0.5)}px`,\n                    top: `${Math.round(Math.max(8, vh * 0.2))}px`,\n                };\n            }\n            catch {\n                bubbleStyle.value = {\n                    left: '50vw',\n                    top: '20vh',\n                };\n            }\n        }\n        function startPositionSync() {\n            stopPositionSync();\n            updateBubblePosition();\n            positionTimer = setInterval(updateBubblePosition, 100);\n        }\n        function stopPositionSync() {\n            if (!positionTimer)\n                return;\n            clearInterval(positionTimer);\n            positionTimer = null;\n        }\n        function startLoadingAnimation() {\n            if (loadingTimer)\n                return;\n            loadingFrameIndex = 0;\n            displayText.value = LOADING_FRAMES[loadingFrameIndex];\n            loadingTimer = setInterval(() => {\n                loadingFrameIndex = (loadingFrameIndex + 1) % LOADING_FRAMES.length;\n                displayText.value = LOADING_FRAMES[loadingFrameIndex];\n            }, LOADING_INTERVAL_MS);\n        }\n        function stopLoadingAnimation() {\n            if (!loadingTimer)\n                return;\n            clearInterval(loadingTimer);\n            loadingTimer = null;\n        }\n        function stopAutoCloseTimer() {\n            if (!autoCloseTimer)\n                return;\n            clearTimeout(autoCloseTimer);\n            autoCloseTimer = null;\n        }\n        function getAutoCloseDelayMs() {\n            const delaySeconds = typeof props.autoCloseDelaySeconds === 'number'\n                ? props.autoCloseDelaySeconds\n                : Number(props.autoCloseDelaySeconds ?? Number.NaN);\n            if (!Number.isFinite(delaySeconds))\n                return -1;\n            const normalizedSeconds = Math.round(delaySeconds);\n            if (normalizedSeconds < 0)\n                return normalizedSeconds;\n            return normalizedSeconds * 1000;\n        }\n        function scheduleAutoClose() {\n            stopAutoCloseTimer();\n            if (!props.isDone)\n                return;\n            if (!String(props.text || '').trim())\n                return;\n            const delayMs = getAutoCloseDelayMs();\n            if (delayMs < 0)\n                return;\n            autoCloseTimer = setTimeout(() => {\n                autoCloseTimer = null;\n                closeBubble();\n            }, delayMs);\n        }\n        function syncBubbleState() {\n            const text = String(props.text || '');\n            if (text) {\n                visible.value = true;\n                displayText.value = text;\n                stopLoadingAnimation();\n                startPositionSync();\n                scheduleAutoClose();\n                return;\n            }\n            if (!props.isDone) {\n                visible.value = true;\n                startLoadingAnimation();\n                startPositionSync();\n                stopAutoCloseTimer();\n                return;\n            }\n            visible.value = false;\n            displayText.value = '';\n            stopLoadingAnimation();\n            stopPositionSync();\n            stopAutoCloseTimer();\n        }\n        watch([() => props.text, () => props.isDone, () => props.autoCloseDelaySeconds], syncBubbleState, {\n            immediate: true,\n        });\n        function closeBubble() {\n            visible.value = false;\n            displayText.value = '';\n            stopLoadingAnimation();\n            stopPositionSync();\n            stopAutoCloseTimer();\n            emit('hidden');\n        }\n        onUnmounted(() => {\n            stopLoadingAnimation();\n            stopPositionSync();\n            stopAutoCloseTimer();\n        });\n        return (_ctx, _cache) => {\n            return (visible.value)\n                ? (_openBlock(), _createElementBlock(\"div\", {\n                    key: 0,\n                    class: \"chat-bubble\",\n                    style: _normalizeStyle(bubbleStyle.value)\n                }, [\n                    _createElementVNode(\"div\", _hoisted_1, [\n                        (__props.isDone)\n                            ? (_openBlock(), _createElementBlock(\"button\", {\n                                key: 0,\n                                type: \"button\",\n                                class: \"bubble-close\",\n                                \"aria-label\": \"\",\n                                onClick: closeBubble\n                            }, \"  \"))\n                            : _createCommentVNode(\"v-if\", true),\n                        _createElementVNode(\"span\", _hoisted_2, _toDisplayString(displayText.value), 1 /* TEXT */),\n                        (!__props.isDone)\n                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_3, \"|\"))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]),\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"bubble-arrow\" }, null, -1 /* CACHED */))\n                ], 4 /* STYLE */))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ChatBubble.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ChatBubble.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ChatBubble.vue?vue&type=style&index=0&id=98097aea&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-98097aea\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, toDisplayString as _toDisplayString, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, Transition as _Transition, withCtx as _withCtx, createVNode as _createVNode, withModifiers as _withModifiers, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"menu-panel\" };\nconst _hoisted_2 = { class: \"command-sub\" };\nconst _hoisted_3 = { class: \"command-sub\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"chat-drawer\"\n};\nconst _hoisted_5 = { class: \"drawer-head\" };\nconst _hoisted_6 = { class: \"drawer-actions\" };\nconst _hoisted_7 = [\"disabled\"];\nimport { computed, nextTick, onUnmounted, ref, watch } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'FunctionMenu',\n    props: {\n        visible: { type: Boolean },\n        x: {},\n        y: {},\n        placement: {},\n        motionLoopEnabled: { type: Boolean },\n        commentStyle: {}\n    },\n    emits: [\"close\", \"send-chat\", \"toggle-motion-loop\", \"switch-model\", \"switch-persona\", \"close-model\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const menuEl = ref(null);\n        const inputEl = ref(null);\n        const input = ref('');\n        const chatOpen = ref(false);\n        const posX = ref(0);\n        const posY = ref(0);\n        function getTopWindow() {\n            try {\n                return window.parent ?? window;\n            }\n            catch {\n                return window;\n            }\n        }\n        const panelTransform = computed(() => (props.placement === 'left'\n            ? 'translate(-100%, -50%)'\n            : 'translate(0, -50%)'));\n        const panelStyle = computed(() => ({\n            left: `${posX.value}px`,\n            top: `${posY.value}px`,\n            transform: panelTransform.value,\n        }));\n        function clampIntoViewport() {\n            const el = menuEl.value;\n            if (!el)\n                return;\n            const top = getTopWindow();\n            const vw = top.innerWidth || top.document.documentElement.clientWidth || 0;\n            const vh = top.innerHeight || top.document.documentElement.clientHeight || 0;\n            const margin = 8;\n            const rect = el.getBoundingClientRect();\n            if (vw > 0) {\n                if (rect.left < margin) {\n                    posX.value += margin - rect.left;\n                }\n                else if (rect.right > vw - margin) {\n                    posX.value -= rect.right - (vw - margin);\n                }\n            }\n            if (vh > 0) {\n                if (rect.top < margin) {\n                    posY.value += margin - rect.top;\n                }\n                else if (rect.bottom > vh - margin) {\n                    posY.value -= rect.bottom - (vh - margin);\n                }\n            }\n        }\n        function close() {\n            chatOpen.value = false;\n            emit('close');\n        }\n        function send() {\n            const message = input.value.trim();\n            if (!message)\n                return;\n            emit('send-chat', message);\n            input.value = '';\n        }\n        function openChat() {\n            chatOpen.value = true;\n            void nextTick(() => {\n                clampIntoViewport();\n                inputEl.value?.focus();\n                inputEl.value?.select();\n            });\n        }\n        function onInputKeydown(e) {\n            if (e.key === 'Escape') {\n                e.preventDefault();\n                close();\n                return;\n            }\n            if (e.key === 'Enter' && !e.shiftKey) {\n                e.preventDefault();\n                send();\n            }\n        }\n        const onGlobalKeydown = (e) => {\n            if (!props.visible)\n                return;\n            if (e.key === 'Escape') {\n                e.preventDefault();\n                close();\n            }\n        };\n        watch(() => props.visible, async (visible) => {\n            if (!visible) {\n                chatOpen.value = false;\n                return;\n            }\n            posX.value = Number.isFinite(props.x) ? props.x : 0;\n            posY.value = Number.isFinite(props.y) ? props.y : 0;\n            chatOpen.value = false;\n            await nextTick();\n            clampIntoViewport();\n        }, { immediate: true });\n        watch(() => [props.x, props.y, props.placement, chatOpen.value], async () => {\n            if (!props.visible)\n                return;\n            posX.value = Number.isFinite(props.x) ? props.x : 0;\n            posY.value = Number.isFinite(props.y) ? props.y : 0;\n            await nextTick();\n            clampIntoViewport();\n        });\n        try {\n            getTopWindow().addEventListener('keydown', onGlobalKeydown);\n        }\n        catch {\n            // ignore\n        }\n        onUnmounted(() => {\n            try {\n                getTopWindow().removeEventListener('keydown', onGlobalKeydown);\n            }\n            catch {\n                // ignore\n            }\n        });\n        return (_ctx, _cache) => {\n            return (__props.visible)\n                ? (_openBlock(), _createElementBlock(\"div\", {\n                    key: 0,\n                    class: \"menu-overlay\",\n                    onClick: _withModifiers(close, [\"self\"])\n                }, [\n                    _createElementVNode(\"div\", {\n                        ref_key: \"menuEl\",\n                        ref: menuEl,\n                        class: _normalizeClass([\"menu-cluster\", [`is-${__props.placement}`, { 'chat-open': chatOpen.value }]]),\n                        style: _normalizeStyle(panelStyle.value),\n                        onClick: _cache[6] || (_cache[6] = _withModifiers(() => { }, [\"stop\"]))\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_1, [\n                            _createElementVNode(\"div\", { class: \"panel-top\" }, [\n                                _cache[7] || (_cache[7] = _createElementVNode(\"span\", { class: \"panel-title\" }, \"TACTICAL\", -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"icon-btn\",\n                                    type: \"button\",\n                                    onClick: close\n                                }, \"\")\n                            ]),\n                            _createElementVNode(\"button\", {\n                                class: _normalizeClass([\"command-btn\", { active: chatOpen.value }]),\n                                type: \"button\",\n                                onClick: openChat\n                            }, [...(_cache[8] || (_cache[8] = [\n                                    _createElementVNode(\"span\", { class: \"command-index\" }, \"01\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-main\" }, \"CHAT\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-sub\" }, \"MESSAGE LINK\", -1 /* CACHED */)\n                                ]))], 2 /* CLASS */),\n                            _createElementVNode(\"button\", {\n                                class: \"command-btn\",\n                                type: \"button\",\n                                onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('toggle-motion-loop')))\n                            }, [\n                                _cache[9] || (_cache[9] = _createElementVNode(\"span\", { class: \"command-index\" }, \"02\", -1 /* CACHED */)),\n                                _cache[10] || (_cache[10] = _createElementVNode(\"span\", { class: \"command-main\" }, \"MOTION\", -1 /* CACHED */)),\n                                _createElementVNode(\"span\", _hoisted_2, _toDisplayString(__props.motionLoopEnabled ? 'ON' : 'OFF'), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"button\", {\n                                class: \"command-btn\",\n                                type: \"button\",\n                                onClick: _cache[1] || (_cache[1] = ($event) => (_ctx.$emit('switch-model')))\n                            }, [...(_cache[11] || (_cache[11] = [\n                                    _createElementVNode(\"span\", { class: \"command-index\" }, \"03\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-main\" }, \"MODEL\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-sub\" }, \"SWITCH\", -1 /* CACHED */)\n                                ]))]),\n                            _createElementVNode(\"button\", {\n                                class: \"command-btn\",\n                                type: \"button\",\n                                onClick: _cache[2] || (_cache[2] = ($event) => (_ctx.$emit('switch-persona')))\n                            }, [\n                                _cache[12] || (_cache[12] = _createElementVNode(\"span\", { class: \"command-index\" }, \"04\", -1 /* CACHED */)),\n                                _cache[13] || (_cache[13] = _createElementVNode(\"span\", { class: \"command-main\" }, \"PERSONA\", -1 /* CACHED */)),\n                                _createElementVNode(\"span\", _hoisted_3, _toDisplayString(__props.commentStyle), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"button\", {\n                                class: \"command-btn danger\",\n                                type: \"button\",\n                                onClick: _cache[3] || (_cache[3] = ($event) => (_ctx.$emit('close-model')))\n                            }, [...(_cache[14] || (_cache[14] = [\n                                    _createElementVNode(\"span\", { class: \"command-index\" }, \"05\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-main\" }, \"CLOSE\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-sub\" }, \"MODEL OFF\", -1 /* CACHED */)\n                                ]))])\n                        ]),\n                        _createVNode(_Transition, { name: \"drawer\" }, {\n                            default: _withCtx(() => [\n                                (chatOpen.value)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                                        _createElementVNode(\"div\", _hoisted_5, [\n                                            _cache[15] || (_cache[15] = _createElementVNode(\"span\", { class: \"drawer-title\" }, \"MESSAGE LINK\", -1 /* CACHED */)),\n                                            _createElementVNode(\"button\", {\n                                                class: \"drawer-close\",\n                                                type: \"button\",\n                                                onClick: _cache[4] || (_cache[4] = ($event) => (chatOpen.value = false))\n                                            }, \"\")\n                                        ]),\n                                        _withDirectives(_createElementVNode(\"textarea\", {\n                                            ref_key: \"inputEl\",\n                                            ref: inputEl,\n                                            \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event) => ((input).value = $event)),\n                                            class: \"chat-input\",\n                                            rows: \"4\",\n                                            placeholder: \"... (Enter  / Shift+Enter )\",\n                                            onKeydown: onInputKeydown\n                                        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                            [_vModelText, input.value]\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_6, [\n                                            _createElementVNode(\"button\", {\n                                                class: \"send-btn\",\n                                                type: \"button\",\n                                                disabled: !input.value.trim(),\n                                                onClick: send\n                                            }, \" SEND \", 8 /* PROPS */, _hoisted_7)\n                                        ]),\n                                        _cache[16] || (_cache[16] = _createElementVNode(\"div\", { class: \"drawer-hint\" }, \"\", -1 /* CACHED */))\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]),\n                            _: 1 /* STABLE */\n                        })\n                    ], 6 /* CLASS, STYLE */)\n                ]))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./FunctionMenu.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FunctionMenu.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./FunctionMenu.vue?vue&type=style&index=0&id=ff4f8948&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-ff4f8948\"]])\n\nexport default __exports__","import { EIKANYA_API_BASE, EIKANYA_CDN_BASE, EIKANYA_RAW_BASE } from '../core/constants';\nimport { Live2DManager } from './manager';\n\n/**  */\nexport interface RepoEntry {\n  name: string;\n  path: string;\n  type: 'file' | 'dir';\n  isModel: boolean;\n}\n\n/**  */\nconst cache = new Map<string, RepoEntry[]>();\n\n/**  Live2D  JSON */\nexport function isModelFile(name: string): boolean {\n  const lower = name.toLowerCase();\n  return (\n    lower === 'model.json' ||\n    lower === 'model3.json' ||\n    lower.endsWith('.model.json') ||\n    lower.endsWith('.model3.json')\n  );\n}\n\n/**  */\nconst FILTERED_EXTENSIONS = ['.zip', '.rar', '.7z', '.md', '.txt', '.png', '.jpg', '.jpeg', '.gif', '.bmp', '.psd', '.webp', '.mp3', '.wav', '.ogg', '.mp4', '.mtn'];\n\nfunction shouldShow(entry: { name: string; type: string }): boolean {\n  if (entry.type === 'dir') return true;\n  if (isModelFile(entry.name)) return true;\n  // \n  const lower = entry.name.toLowerCase();\n  for (const ext of FILTERED_EXTENSIONS) {\n    if (lower.endsWith(ext)) return false;\n  }\n  //  JSON \n  return isModelFile(entry.name);\n}\n\n/**  GitHub API  */\nexport async function fetchDirectory(path: string): Promise<RepoEntry[]> {\n  // \n  const cached = cache.get(path);\n  if (cached) return cached;\n\n  const apiUrl = `${EIKANYA_API_BASE}${path}`;\n\n  let data: any[];\n  try {\n    //  GitHub API CORS\n    const resp = await fetch(apiUrl, {\n      headers: { Accept: 'application/vnd.github.v3+json' },\n    });\n\n    if (resp.status === 403) {\n      const remaining = resp.headers.get('X-RateLimit-Remaining');\n      const resetTime = resp.headers.get('X-RateLimit-Reset');\n      const resetDate = resetTime ? new Date(parseInt(resetTime) * 1000) : null;\n      throw new RateLimitError(remaining, resetDate);\n    }\n\n    if (!resp.ok) throw new Error(`HTTP ${resp.status}`);\n    data = await resp.json();\n  } catch (e) {\n    if (e instanceof RateLimitError) throw e;\n    //  CORS \n    const proxiedUrl = Live2DManager._getProxiedUrl(apiUrl);\n    const resp = await fetch(proxiedUrl, {\n      headers: { Accept: 'application/vnd.github.v3+json' },\n    });\n\n    if (resp.status === 403) {\n      throw new RateLimitError(null, null);\n    }\n    if (!resp.ok) throw new Error(`: HTTP ${resp.status}`);\n    data = await resp.json();\n  }\n\n  if (!Array.isArray(data)) {\n    throw new Error('GitHub API ');\n  }\n\n  const entries: RepoEntry[] = data\n    .map((item: any) => ({\n      name: item.name as string,\n      path: item.path as string,\n      type: (item.type === 'dir' ? 'dir' : 'file') as 'file' | 'dir',\n      isModel: item.type === 'file' && isModelFile(item.name),\n    }))\n    .filter(shouldShow)\n    .sort((a, b) => {\n      // \n      if (a.type !== b.type) return a.type === 'dir' ? -1 : 1;\n      return a.name.localeCompare(b.name);\n    });\n\n  cache.set(path, entries);\n  return entries;\n}\n\n/**  GitHub  CDN  raw URL ASCII  */\nexport function buildCdnUrl(path: string, useCdn: boolean = true): string {\n  const encodedPath = path.split('/').map(s => encodeURIComponent(s)).join('/');\n  const base = useCdn ? EIKANYA_CDN_BASE : EIKANYA_RAW_BASE;\n  return `${base}${encodedPath}`;\n}\n\n/**  */\nexport function clearCache(): void {\n  cache.clear();\n}\n\n/** API  */\nexport class RateLimitError extends Error {\n  remaining: string | null;\n  resetDate: Date | null;\n\n  constructor(remaining: string | null, resetDate: Date | null) {\n    const resetStr = resetDate ? resetDate.toLocaleTimeString() : '';\n    super(`GitHub API  ${resetStr} `);\n    this.name = 'RateLimitError';\n    this.remaining = remaining;\n    this.resetDate = resetDate;\n  }\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode, Fragment as _Fragment, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, renderList as _renderList, resolveComponent as _resolveComponent, createBlock as _createBlock, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = { class: \"tree-node\" };\nconst _hoisted_2 = {\n    key: 1,\n    class: \"expand-icon placeholder\"\n};\nconst _hoisted_3 = { class: \"node-icon\" };\nconst _hoisted_4 = [\"title\"];\nconst _hoisted_5 = {\n    key: 2,\n    class: \"node-spinner\"\n};\nimport { ref, computed } from 'vue';\nimport { fetchDirectory, RateLimitError } from '../live2d/model-browser';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'TreeNode',\n    props: {\n        entry: {},\n        depth: {},\n        searchQuery: {}\n    },\n    emits: [\"select-model\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const expanded = ref(false);\n        const children = ref([]);\n        const loading = ref(false);\n        const loadedOnce = ref(false);\n        const childError = ref('');\n        const isSelected = ref(false);\n        const filteredChildren = computed(() => {\n            if (!props.searchQuery.trim())\n                return children.value;\n            const q = props.searchQuery.toLowerCase();\n            return children.value.filter(c => c.name.toLowerCase().includes(q) || c.type === 'dir');\n        });\n        async function loadChildren() {\n            loading.value = true;\n            childError.value = '';\n            try {\n                children.value = await fetchDirectory(props.entry.path);\n                loadedOnce.value = true;\n            }\n            catch (e) {\n                if (e instanceof RateLimitError) {\n                    childError.value = e.message;\n                }\n                else {\n                    childError.value = `: ${e.message || ''}`;\n                }\n            }\n            finally {\n                loading.value = false;\n            }\n        }\n        function handleClick() {\n            if (props.entry.type === 'dir') {\n                expanded.value = !expanded.value;\n                if (expanded.value && !loadedOnce.value) {\n                    loadChildren();\n                }\n            }\n            else if (props.entry.isModel) {\n                isSelected.value = true;\n                emit('select-model', props.entry.path);\n            }\n        }\n        return (_ctx, _cache) => {\n            const _component_TreeNode = _resolveComponent(\"TreeNode\", true);\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", {\n                    class: _normalizeClass([\"node-row\", { 'is-model': __props.entry.isModel, 'is-selected': isSelected.value }]),\n                    style: _normalizeStyle({ paddingLeft: __props.depth * 16 + 'px' }),\n                    onClick: handleClick\n                }, [\n                    _createCommentVNode(\" / \"),\n                    (__props.entry.type === 'dir')\n                        ? (_openBlock(), _createElementBlock(\"span\", {\n                            key: 0,\n                            class: _normalizeClass([\"expand-icon\", { expanded: expanded.value }])\n                        }, \"  \", 2 /* CLASS */))\n                        : (_openBlock(), _createElementBlock(\"span\", _hoisted_2)),\n                    _createCommentVNode(\"  \"),\n                    _createElementVNode(\"span\", _hoisted_3, [\n                        (__props.entry.type === 'dir')\n                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                                _createTextVNode(\"\")\n                            ], 64 /* STABLE_FRAGMENT */))\n                            : (__props.entry.isModel)\n                                ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                    _createTextVNode(\"\")\n                                ], 64 /* STABLE_FRAGMENT */))\n                                : (_openBlock(), _createElementBlock(_Fragment, { key: 2 }, [\n                                    _createTextVNode(\"\")\n                                ], 64 /* STABLE_FRAGMENT */))\n                    ]),\n                    _createCommentVNode(\"  \"),\n                    _createElementVNode(\"span\", {\n                        class: \"node-name\",\n                        title: __props.entry.path\n                    }, _toDisplayString(__props.entry.name), 9 /* TEXT, PROPS */, _hoisted_4),\n                    _createCommentVNode(\"  \"),\n                    (loading.value)\n                        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5))\n                        : _createCommentVNode(\"v-if\", true)\n                ], 6 /* CLASS, STYLE */),\n                _createCommentVNode(\"  \"),\n                (expanded.value && children.value.length > 0)\n                    ? (_openBlock(true), _createElementBlock(_Fragment, { key: 0 }, _renderList(filteredChildren.value, (child) => {\n                        return (_openBlock(), _createBlock(_component_TreeNode, {\n                            key: child.path,\n                            entry: child,\n                            depth: __props.depth + 1,\n                            \"search-query\": __props.searchQuery,\n                            onSelectModel: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('select-model', $event)))\n                        }, null, 8 /* PROPS */, [\"entry\", \"depth\", \"search-query\"]));\n                    }), 128 /* KEYED_FRAGMENT */))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\"  \"),\n                (expanded.value && !loading.value && children.value.length === 0 && loadedOnce.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 1,\n                        class: \"empty-hint\",\n                        style: _normalizeStyle({ paddingLeft: (__props.depth + 1) * 16 + 8 + 'px' })\n                    }, \"  \", 4 /* STYLE */))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\"  \"),\n                (expanded.value && childError.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 2,\n                        class: \"child-error\",\n                        style: _normalizeStyle({ paddingLeft: (__props.depth + 1) * 16 + 8 + 'px' })\n                    }, [\n                        _createTextVNode(_toDisplayString(childError.value) + \" \", 1 /* TEXT */),\n                        _createElementVNode(\"button\", {\n                            class: \"retry-link\",\n                            onClick: _withModifiers(loadChildren, [\"stop\"])\n                        }, \"\")\n                    ], 4 /* STYLE */))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./TreeNode.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TreeNode.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TreeNode.vue?vue&type=style&index=0&id=3a6a95ba&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3a6a95ba\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"model-browser\" };\nconst _hoisted_2 = { class: \"search-box\" };\nconst _hoisted_3 = {\n    key: 0,\n    class: \"error-bar\"\n};\nconst _hoisted_4 = { class: \"tree-container\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"loading-state\"\n};\nconst _hoisted_6 = {\n    key: 0,\n    class: \"empty-state\"\n};\nconst _hoisted_7 = { class: \"browser-footer\" };\nconst _hoisted_8 = {\n    key: 0,\n    class: \"selected-info\"\n};\nconst _hoisted_9 = { class: \"selected-path\" };\nconst _hoisted_10 = {\n    key: 1,\n    class: \"selected-info\"\n};\nconst _hoisted_11 = { class: \"footer-actions\" };\nconst _hoisted_12 = [\"disabled\"];\nimport { ref, computed } from 'vue';\nimport { fetchDirectory, buildCdnUrl, RateLimitError } from '../live2d/model-browser';\nimport TreeNode from './TreeNode.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ModelBrowser',\n    props: {\n        useCdn: { type: Boolean }\n    },\n    emits: [\"cancel\", \"load-model\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const rootEntries = ref([]);\n        const rootLoading = ref(false);\n        const errorMsg = ref('');\n        const searchQuery = ref('');\n        const selectedPath = ref('');\n        const selectedName = computed(() => {\n            if (!selectedPath.value)\n                return '';\n            const parts = selectedPath.value.split('/');\n            return parts[parts.length - 1];\n        });\n        const filteredRootEntries = computed(() => {\n            if (!searchQuery.value.trim())\n                return rootEntries.value;\n            const q = searchQuery.value.toLowerCase();\n            return rootEntries.value.filter(e => e.name.toLowerCase().includes(q));\n        });\n        function onSelectModel(path) {\n            selectedPath.value = path;\n        }\n        function confirmLoad() {\n            if (!selectedPath.value)\n                return;\n            const cdnUrl = buildCdnUrl(selectedPath.value, props.useCdn);\n            emit('load-model', cdnUrl);\n        }\n        async function loadRoot() {\n            rootLoading.value = true;\n            errorMsg.value = '';\n            try {\n                rootEntries.value = await fetchDirectory('');\n            }\n            catch (e) {\n                if (e instanceof RateLimitError) {\n                    errorMsg.value = e.message;\n                }\n                else {\n                    errorMsg.value = `: ${e.message || ''}`;\n                }\n            }\n            finally {\n                rootLoading.value = false;\n            }\n        }\n        // \n        loadRoot();\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _cache[5] || (_cache[5] = _createElementVNode(\"div\", { class: \"browser-header\" }, [\n                    _createElementVNode(\"span\", { class: \"browser-title\" }, \"\"),\n                    _createElementVNode(\"span\", { class: \"browser-hint\" }, \"Eikanya/Live2d-model\")\n                ], -1 /* CACHED */)),\n                _createCommentVNode(\"  \"),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _withDirectives(_createElementVNode(\"input\", {\n                        type: \"text\",\n                        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((searchQuery).value = $event)),\n                        placeholder: \"...\"\n                    }, null, 512 /* NEED_PATCH */), [\n                        [_vModelText, searchQuery.value]\n                    ])\n                ]),\n                _createCommentVNode(\"  \"),\n                (errorMsg.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                        _createElementVNode(\"span\", null, _toDisplayString(errorMsg.value), 1 /* TEXT */),\n                        _createElementVNode(\"button\", {\n                            class: \"retry-btn\",\n                            onClick: loadRoot\n                        }, \"\")\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\"  \"),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    (rootLoading.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [...(_cache[2] || (_cache[2] = [\n                                _createElementVNode(\"span\", { class: \"spinner\" }, null, -1 /* CACHED */),\n                                _createTextVNode(\" ... \", -1 /* CACHED */)\n                            ]))]))\n                        : (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredRootEntries.value, (entry) => {\n                                return (_openBlock(), _createBlock(TreeNode, {\n                                    key: entry.path,\n                                    entry: entry,\n                                    depth: 0,\n                                    \"search-query\": searchQuery.value,\n                                    onSelectModel: onSelectModel\n                                }, null, 8 /* PROPS */, [\"entry\", \"search-query\"]));\n                            }), 128 /* KEYED_FRAGMENT */)),\n                            (rootEntries.value.length === 0 && !rootLoading.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, \"  \"))\n                                : _createCommentVNode(\"v-if\", true)\n                        ], 64 /* STABLE_FRAGMENT */))\n                ]),\n                _createCommentVNode(\"  &  \"),\n                _createElementVNode(\"div\", _hoisted_7, [\n                    (selectedPath.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n                            _cache[3] || (_cache[3] = _createTextVNode(\" : \", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", _hoisted_9, _toDisplayString(selectedName.value), 1 /* TEXT */)\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [...(_cache[4] || (_cache[4] = [\n                                _createElementVNode(\"span\", { class: \"no-selection\" }, \"\", -1 /* CACHED */)\n                            ]))])),\n                    _createElementVNode(\"div\", _hoisted_11, [\n                        _createElementVNode(\"button\", {\n                            class: \"btn btn-secondary\",\n                            onClick: _cache[1] || (_cache[1] = ($event) => (_ctx.$emit('cancel')))\n                        }, \"\"),\n                        _createElementVNode(\"button\", {\n                            class: \"btn btn-primary\",\n                            disabled: !selectedPath.value,\n                            onClick: confirmLoad\n                        }, \"  \", 8 /* PROPS */, _hoisted_12)\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ModelBrowser.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ModelBrowser.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ModelBrowser.vue?vue&type=style&index=0&id=7ee23a0a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7ee23a0a\"]])\n\nexport default __exports__","import { LOCAL_LIVE2D_MODEL_SLOT_ID, SCRIPT_NAME } from '../core/constants';\nimport { saveLive2DModel, type StoredLive2DModel } from '../db/live2d-models';\nimport { Live2DLoader } from './loader';\nimport {\n  LIVE2D_RUNTIME_TYPES,\n  inferCubismVersionFromModelJson,\n  resolveRuntimeTypeFromCubismVersion,\n} from './runtime-router';\n\ntype JSZipLike = {\n  file(path: string): any;\n  forEach(callback: (path: string, file: any) => void): void;\n};\n\ntype ModelJsonEntry = {\n  path: string;\n  file: any;\n  priority: number;\n};\n\nexport const Live2DUploader = {\n  JSZip: null as any,\n\n  async _loadJSZip(): Promise<any> {\n    if (this.JSZip) return this.JSZip;\n\n    const topWindow = window.parent ?? window;\n    if ((topWindow as any).JSZip) {\n      this.JSZip = (topWindow as any).JSZip;\n      return this.JSZip;\n    }\n\n    return new Promise((resolve, reject) => {\n      const script = topWindow.document.createElement('script');\n      script.src = 'https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js';\n      script.async = true;\n      script.onload = () => {\n        this.JSZip = (topWindow as any).JSZip;\n        if (!this.JSZip) {\n          reject(new Error('JSZip '));\n          return;\n        }\n        try {\n          console.log(`[${SCRIPT_NAME}] JSZip `);\n        } catch {\n          // ignore\n        }\n        resolve(this.JSZip);\n      };\n      script.onerror = () => reject(new Error('JSZip '));\n      topWindow.document.head.appendChild(script);\n    });\n  },\n\n  async uploadZip(file: File): Promise<StoredLive2DModel> {\n    const JSZip = await this._loadJSZip();\n    const zip = (await JSZip.loadAsync(file)) as JSZipLike;\n\n    try {\n      console.log(\n        `[${SCRIPT_NAME}] Live2DUploader:  ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)`,\n      );\n    } catch {\n      // ignore\n    }\n\n    const modelJsonEntry = await this._findModelJson(zip);\n    if (!modelJsonEntry) {\n      throw new Error(' Live2D model3.json / model.json / *.model.json / model*.json');\n    }\n\n    const modelDir = modelJsonEntry.path.substring(0, modelJsonEntry.path.lastIndexOf('/') + 1);\n    const modelJsonText = String(await modelJsonEntry.file.async('text')).replace(/^\\uFEFF/, '');\n    const modelJson = JSON.parse(modelJsonText);\n\n    const entryPathLower = String(modelJsonEntry.path || '').toLowerCase();\n    const isModel3 = entryPathLower.endsWith('model3.json') || !!modelJson?.FileReferences;\n    const isModel2 =\n      !isModel3 &&\n      (typeof modelJson?.model === 'string' ||\n        typeof modelJson?.Model === 'string' ||\n        Array.isArray(modelJson?.textures) ||\n        Array.isArray(modelJson?.expressions) ||\n        typeof modelJson?.motions === 'object');\n\n    try {\n      console.log(\n        `[${SCRIPT_NAME}] Live2DUploader: : ${modelDir || ''}: ${\n          isModel3 ? 'Cubism 3/4/5' : 'Cubism 2.1'\n        }`,\n      );\n    } catch {\n      // ignore\n    }\n\n    let modelData: StoredLive2DModel;\n    if (isModel3) {\n      const moc3Data = await this._extractFile(zip, modelDir, modelJson.FileReferences?.Moc);\n      const moc3HeaderVersion = this._readMoc3HeaderVersion(moc3Data);\n      const detectedCubismVersion = await this._resolveModel3CubismVersion(modelJson, moc3Data);\n      const runtimeType = resolveRuntimeTypeFromCubismVersion(detectedCubismVersion);\n      modelData = {\n        modelId: LOCAL_LIVE2D_MODEL_SLOT_ID,\n        source: 'local',\n        fileName: String(file.name || '').trim() || 'uploaded-live2d.zip',\n        runtimeType,\n        cubismVersion: detectedCubismVersion,\n        moc3Version: moc3HeaderVersion ?? null,\n        modelJson,\n        moc3: moc3Data,\n        moc: null,\n        textures: await this._extractTextures(zip, modelDir, modelJson),\n        motions: await this._extractMotions(zip, modelDir, modelJson),\n        expressions: await this._extractExpressions(zip, modelDir, modelJson),\n        physics: modelJson.FileReferences?.Physics\n          ? await this._extractFileOptional(zip, modelDir, modelJson.FileReferences.Physics)\n          : null,\n        pose: modelJson.FileReferences?.Pose\n          ? await this._extractFileOptional(zip, modelDir, modelJson.FileReferences.Pose)\n          : null,\n        uploadTime: Date.now(),\n        fileSize: file.size,\n      };\n    } else if (isModel2) {\n      const mocPath = modelJson?.model || modelJson?.Model;\n      const physicsPath = modelJson?.physics || modelJson?.Physics;\n      const posePath = modelJson?.pose || modelJson?.Pose;\n      modelData = {\n        modelId: LOCAL_LIVE2D_MODEL_SLOT_ID,\n        source: 'local',\n        fileName: String(file.name || '').trim() || 'uploaded-live2d.zip',\n        runtimeType: LIVE2D_RUNTIME_TYPES.LEGACY,\n        cubismVersion: 2,\n        modelJson,\n        moc3Version: null,\n        moc3: null,\n        moc: await this._extractFile(zip, modelDir, mocPath),\n        textures: await this._extractTexturesV2(zip, modelDir, modelJson),\n        motions: await this._extractMotionsV2(zip, modelDir, modelJson),\n        expressions: await this._extractExpressionsV2(zip, modelDir, modelJson),\n        physics: physicsPath ? await this._extractFileOptional(zip, modelDir, physicsPath) : null,\n        pose: posePath ? await this._extractFileOptional(zip, modelDir, posePath) : null,\n        uploadTime: Date.now(),\n        fileSize: file.size,\n      };\n    } else {\n      throw new Error(' Live2D  zip  model3.json / model.json');\n    }\n\n    await saveLive2DModel(modelData);\n\n    try {\n      console.log(`[${SCRIPT_NAME}] Live2DUploader: `, {\n        modelId: modelData.modelId,\n        runtimeType: modelData.runtimeType,\n        cubismVersion: modelData.cubismVersion,\n      });\n    } catch {\n      // ignore\n    }\n\n    return modelData;\n  },\n\n  _toArrayBuffer(input: unknown): ArrayBuffer | null {\n    if (!input) return null;\n    if (input instanceof ArrayBuffer) return input;\n    if (ArrayBuffer.isView(input)) {\n      return input.buffer.slice(input.byteOffset, input.byteOffset + input.byteLength);\n    }\n    return null;\n  },\n\n  _normalizeMocVersion(rawMocVersion: unknown): number | null {\n    const value = Number(rawMocVersion || 0);\n    if (!Number.isFinite(value)) return null;\n    if (value >= 5) return 5;\n    if (value >= 1 && value <= 4) return 4;\n    return null;\n  },\n\n  _readMoc3HeaderVersion(moc3Data: unknown): number | null {\n    const moc3Buffer = this._toArrayBuffer(moc3Data);\n    if (!moc3Buffer || moc3Buffer.byteLength < 8) return null;\n\n    try {\n      const header = new Uint8Array(moc3Buffer, 0, 4);\n      const signature = String.fromCharCode(...header);\n      if (signature !== 'MOC3') return null;\n      const view = new DataView(moc3Buffer);\n      return Number(view.getUint32(4, true) || 0) || null;\n    } catch {\n      return null;\n    }\n  },\n\n  _detectCubismVersionFromMoc3Buffer(moc3Data: unknown): number | null {\n    const moc3Buffer = this._toArrayBuffer(moc3Data);\n    if (!moc3Buffer) return null;\n\n    const topWindow = window.parent ?? window;\n    const core = (topWindow as any)?.Live2DCubismCore;\n    const Moc = core?.Moc;\n    const Version = core?.Version;\n    if (typeof Moc?.fromArrayBuffer !== 'function' || typeof Version?.csmGetMocVersion !== 'function') {\n      return null;\n    }\n\n    let mocRef: any = null;\n    try {\n      mocRef = Moc.fromArrayBuffer(moc3Buffer);\n      if (!mocRef) return null;\n\n      const rawMocVersion = Number(Version.csmGetMocVersion(mocRef, moc3Buffer) || 0) || 0;\n      const latestMocVersion = Number(Version?.csmGetLatestMocVersion?.() || 0) || 0;\n      const normalized = this._normalizeMocVersion(rawMocVersion);\n      if (latestMocVersion > 0 && rawMocVersion > latestMocVersion) {\n        return null;\n      }\n      return normalized;\n    } catch {\n      return null;\n    } finally {\n      try {\n        if (mocRef && typeof mocRef._release === 'function') {\n          mocRef._release();\n        } else if (mocRef && typeof mocRef.release === 'function') {\n          mocRef.release();\n        }\n      } catch {\n        // ignore\n      }\n    }\n  },\n\n  async _resolveModel3CubismVersion(modelJson: any, moc3Data: ArrayBuffer): Promise<number> {\n    const jsonFallbackVersion = inferCubismVersionFromModelJson(modelJson, 4) || 4;\n    const headerVersionRaw = this._readMoc3HeaderVersion(moc3Data);\n    const headerVersion = this._normalizeMocVersion(headerVersionRaw);\n    if (headerVersion != null) {\n      return headerVersion;\n    }\n\n    try {\n      const requiredLatestVersion = headerVersionRaw && headerVersionRaw >= 5 ? headerVersionRaw : 5;\n      await Live2DLoader.ensureCubism5Core(requiredLatestVersion);\n    } catch {\n      // ignore\n    }\n\n    const mocVersion = this._detectCubismVersionFromMoc3Buffer(moc3Data);\n    return mocVersion ?? headerVersion ?? jsonFallbackVersion;\n  },\n\n  async _findModelJson(zip: JSZipLike): Promise<ModelJsonEntry | null> {\n    const candidates: ModelJsonEntry[] = [];\n    const jsonEntries: Array<{ path: string; file: any }> = [];\n\n    zip.forEach((path, file) => {\n      if (file?.dir) return;\n      if (/(^|\\/)model3\\.json$/i.test(path) || /\\.model3\\.json$/i.test(path)) {\n        candidates.push({ path, file, priority: 1 });\n      } else if (/(^|\\/)model\\.json$/i.test(path) || /\\.model\\.json$/i.test(path)) {\n        candidates.push({ path, file, priority: 2 });\n      } else if (/(^|\\/)model[_-]?\\d+\\.json$/i.test(path)) {\n        candidates.push({ path, file, priority: 3 });\n      }\n\n      if (/\\.json$/i.test(path)) {\n        jsonEntries.push({ path, file });\n      }\n    });\n\n    if (candidates.length > 0) {\n      candidates.sort((a, b) => a.priority - b.priority);\n      return candidates[0];\n    }\n\n    let best: { path: string; file: any } | null = null;\n    let bestScore = 0;\n    for (const entry of jsonEntries) {\n      try {\n        const text = await entry.file.async('text');\n        const json = JSON.parse(text);\n        if (!json || typeof json !== 'object') continue;\n\n        let score = 0;\n        const fileName = String(entry.path).split('/').pop()?.toLowerCase() ?? '';\n        if (fileName.includes('model')) score += 50;\n        if (json.FileReferences && typeof json.FileReferences === 'object') {\n          score += 100;\n          if (typeof json.FileReferences.Moc === 'string') score += 1000;\n          if (Array.isArray(json.FileReferences.Textures)) score += 200;\n        }\n        if (typeof json.model === 'string' || typeof json.Model === 'string') score += 900;\n        if (Array.isArray(json.textures) || Array.isArray(json.Textures)) score += 200;\n\n        if (score > bestScore) {\n          best = entry;\n          bestScore = score;\n        }\n      } catch {\n        // ignore\n      }\n    }\n\n    if (!best) return null;\n    return { path: best.path, file: best.file, priority: 99 };\n  },\n\n  async _extractFile(zip: JSZipLike, baseDir: string, relativePath: string): Promise<ArrayBuffer> {\n    const target = String(relativePath || '').trim();\n    if (!target) {\n      throw new Error('');\n    }\n\n    const fullPath = `${baseDir}${target}`;\n    let file = zip.file(fullPath);\n    if (!file) {\n      file = zip.file(target);\n    }\n    if (!file) {\n      const normalizedPath = target.replace(/\\\\/g, '/');\n      file = zip.file(`${baseDir}${normalizedPath}`) || zip.file(normalizedPath);\n    }\n    if (!file) {\n      throw new Error(`: ${fullPath}`);\n    }\n\n    return await file.async('arraybuffer');\n  },\n\n  async _extractFileOptional(zip: JSZipLike, baseDir: string, relativePath: string): Promise<ArrayBuffer | null> {\n    try {\n      return await this._extractFile(zip, baseDir, relativePath);\n    } catch {\n      return null;\n    }\n  },\n\n  async _extractTextures(zip: JSZipLike, baseDir: string, modelJson: any): Promise<StoredLive2DModel['textures']> {\n    const textures: StoredLive2DModel['textures'] = [];\n    const textureList = Array.isArray(modelJson?.FileReferences?.Textures) ? modelJson.FileReferences.Textures : [];\n\n    for (const texPathRaw of textureList) {\n      const texPath = String(texPathRaw || '').trim();\n      if (!texPath) continue;\n      try {\n        const data = await this._extractFile(zip, baseDir, texPath);\n        const lower = texPath.toLowerCase();\n        const mimeType = lower.endsWith('.png') ? 'image/png' : lower.endsWith('.webp') ? 'image/webp' : 'image/jpeg';\n        textures.push({\n          name: texPath,\n          data: new Blob([data], { type: mimeType }),\n        });\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${texPath}`, e);\n      }\n    }\n\n    return textures;\n  },\n\n  async _extractTexturesV2(zip: JSZipLike, baseDir: string, modelJson: any): Promise<StoredLive2DModel['textures']> {\n    const textures: StoredLive2DModel['textures'] = [];\n    const textureList = modelJson?.textures || modelJson?.Textures || [];\n    if (!Array.isArray(textureList)) return textures;\n\n    for (const texPathRaw of textureList) {\n      const texPath = String(texPathRaw || '').trim();\n      if (!texPath) continue;\n      try {\n        const data = await this._extractFile(zip, baseDir, texPath);\n        const lower = texPath.toLowerCase();\n        const mimeType = lower.endsWith('.png') ? 'image/png' : lower.endsWith('.webp') ? 'image/webp' : 'image/jpeg';\n        textures.push({\n          name: texPath,\n          data: new Blob([data], { type: mimeType }),\n        });\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${texPath}`, e);\n      }\n    }\n\n    return textures;\n  },\n\n  async _extractMotions(zip: JSZipLike, baseDir: string, modelJson: any): Promise<StoredLive2DModel['motions']> {\n    const motions: StoredLive2DModel['motions'] = {};\n    const motionGroups = modelJson?.FileReferences?.Motions || {};\n\n    for (const [groupName, motionList] of Object.entries(motionGroups)) {\n      motions[groupName] = [];\n      if (!Array.isArray(motionList)) continue;\n      for (const motionDef of motionList) {\n        const filePath = typeof motionDef === 'string' ? motionDef : (motionDef as any)?.File;\n        if (!filePath) continue;\n        try {\n          const data = await this._extractFile(zip, baseDir, filePath);\n          motions[groupName].push({ name: filePath, data });\n        } catch (e) {\n          console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${filePath}`, e);\n        }\n      }\n    }\n\n    const extractedCount = Object.values(motions).reduce(\n      (sum, list) => sum + (Array.isArray(list) ? list.length : 0),\n      0,\n    );\n\n    if (extractedCount === 0) {\n      const collectScannedMotions = (scanAllZip = false): string[] => {\n        const scanned: string[] = [];\n        zip.forEach((path, file) => {\n          if (file?.dir) return;\n          if (!scanAllZip && !path.startsWith(baseDir)) return;\n          if (!/\\.motion3\\.json$/i.test(path)) return;\n          scanned.push(path.startsWith(baseDir) ? path.substring(baseDir.length) : path);\n        });\n        return scanned;\n      };\n\n      let scannedMotions = collectScannedMotions(false);\n      if (scannedMotions.length === 0) {\n        scannedMotions = collectScannedMotions(true);\n      }\n\n      if (scannedMotions.length > 0) {\n        scannedMotions.sort((a, b) => a.localeCompare(b, 'zh-CN'));\n        motions.default = [];\n        for (const filePath of scannedMotions) {\n          try {\n            const data = await this._extractFile(zip, baseDir, filePath);\n            motions.default.push({ name: filePath, data });\n          } catch (e) {\n            console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${filePath}`, e);\n          }\n        }\n      }\n    }\n\n    return motions;\n  },\n\n  async _extractMotionsV2(zip: JSZipLike, baseDir: string, modelJson: any): Promise<StoredLive2DModel['motions']> {\n    const motions: StoredLive2DModel['motions'] = {};\n    const motionGroups = modelJson?.motions || modelJson?.Motions || {};\n\n    for (const [groupName, motionList] of Object.entries(motionGroups || {})) {\n      motions[groupName] = [];\n      if (!Array.isArray(motionList)) continue;\n      for (const motionDef of motionList) {\n        const filePath =\n          typeof motionDef === 'string' ? motionDef : (motionDef as any)?.file || (motionDef as any)?.File;\n        if (!filePath) continue;\n        try {\n          const data = await this._extractFile(zip, baseDir, filePath);\n          motions[groupName].push({ name: filePath, data });\n        } catch (e) {\n          console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${filePath}`, e);\n        }\n      }\n    }\n\n    const extractedCount = Object.values(motions).reduce(\n      (sum, list) => sum + (Array.isArray(list) ? list.length : 0),\n      0,\n    );\n    if (extractedCount === 0) {\n      const scannedMotions: string[] = [];\n      zip.forEach((path, file) => {\n        if (file?.dir) return;\n        if (path.startsWith(baseDir) && /\\.mtn$/i.test(path)) {\n          scannedMotions.push(path.substring(baseDir.length));\n        }\n      });\n\n      if (scannedMotions.length > 0) {\n        motions.default = [];\n        for (const filePath of scannedMotions) {\n          try {\n            const data = await this._extractFile(zip, baseDir, filePath);\n            motions.default.push({ name: filePath, data });\n          } catch (e) {\n            console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${filePath}`, e);\n          }\n        }\n      }\n    }\n\n    return motions;\n  },\n\n  async _extractExpressions(\n    zip: JSZipLike,\n    baseDir: string,\n    modelJson: any,\n  ): Promise<StoredLive2DModel['expressions']> {\n    const expressions: StoredLive2DModel['expressions'] = [];\n    const exprList = modelJson?.FileReferences?.Expressions || [];\n\n    for (const exprDef of exprList) {\n      const filePath = typeof exprDef === 'string' ? exprDef : exprDef?.File;\n      const name = typeof exprDef === 'object' ? exprDef?.Name : filePath;\n      if (!filePath) continue;\n      try {\n        const data = await this._extractFile(zip, baseDir, filePath);\n        expressions.push({ name: String(name || filePath), file: String(filePath), data });\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${filePath}`, e);\n      }\n    }\n\n    if (expressions.length === 0) {\n      const scannedExprs: string[] = [];\n      zip.forEach((path, file) => {\n        if (file?.dir) return;\n        if (path.startsWith(baseDir) && /\\.exp3\\.json$/i.test(path)) {\n          scannedExprs.push(path.substring(baseDir.length));\n        }\n      });\n\n      for (const filePath of scannedExprs) {\n        try {\n          const data = await this._extractFile(zip, baseDir, filePath);\n          const name = filePath.replace(/\\.exp3\\.json$/i, '').split('/').pop() || filePath;\n          expressions.push({ name, file: filePath, data });\n        } catch (e) {\n          console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${filePath}`, e);\n        }\n      }\n    }\n\n    return expressions;\n  },\n\n  async _extractExpressionsV2(\n    zip: JSZipLike,\n    baseDir: string,\n    modelJson: any,\n  ): Promise<StoredLive2DModel['expressions']> {\n    const expressions: StoredLive2DModel['expressions'] = [];\n    const exprList = modelJson?.expressions || modelJson?.Expressions || [];\n\n    if (Array.isArray(exprList)) {\n      for (const exprDef of exprList) {\n        const filePath = typeof exprDef === 'string' ? exprDef : exprDef?.file || exprDef?.File;\n        const name = typeof exprDef === 'string' ? exprDef : exprDef?.name || exprDef?.Name || filePath;\n        if (!filePath) continue;\n        try {\n          const data = await this._extractFile(zip, baseDir, filePath);\n          expressions.push({ name: String(name || filePath), file: String(filePath), data });\n        } catch (e) {\n          console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${filePath}`, e);\n        }\n      }\n    }\n\n    if (expressions.length === 0) {\n      const scannedExprs: string[] = [];\n      zip.forEach((path, file) => {\n        if (file?.dir) return;\n        if (path.startsWith(baseDir) && /\\.exp\\.json$/i.test(path)) {\n          scannedExprs.push(path.substring(baseDir.length));\n        }\n      });\n\n      for (const filePath of scannedExprs) {\n        try {\n          const data = await this._extractFile(zip, baseDir, filePath);\n          const name = filePath.replace(/\\.exp\\.json$/i, '').split('/').pop() || filePath;\n          expressions.push({ name, file: filePath, data });\n        } catch (e) {\n          console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${filePath}`, e);\n        }\n      }\n    }\n\n    return expressions;\n  },\n};\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, unref as _unref, vModelSelect as _vModelSelect, withDirectives as _withDirectives, vModelText as _vModelText, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, createTextVNode as _createTextVNode, vShow as _vShow, withKeys as _withKeys, withModifiers as _withModifiers, createVNode as _createVNode, createStaticVNode as _createStaticVNode } from \"vue\";\nconst _hoisted_1 = { class: \"panel-main\" };\nconst _hoisted_2 = { class: \"panel-nav\" };\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"nav-index\" };\nconst _hoisted_5 = { class: \"nav-label\" };\nconst _hoisted_6 = { class: \"nav-sub\" };\nconst _hoisted_7 = { class: \"panel-body\" };\nconst _hoisted_8 = { class: \"setting-section\" };\nconst _hoisted_9 = { class: \"form-group\" };\nconst _hoisted_10 = { class: \"form-group\" };\nconst _hoisted_11 = [\"value\"];\nconst _hoisted_12 = { class: \"form-group\" };\nconst _hoisted_13 = { class: \"form-group\" };\nconst _hoisted_14 = { class: \"form-group\" };\nconst _hoisted_15 = { class: \"input-with-btn\" };\nconst _hoisted_16 = [\"value\"];\nconst _hoisted_17 = [\"disabled\"];\nconst _hoisted_18 = {\n    key: 0,\n    class: \"hint hint-error\"\n};\nconst _hoisted_19 = { class: \"form-group\" };\nconst _hoisted_20 = [\"disabled\"];\nconst _hoisted_21 = {\n    key: 0,\n    class: \"status-badge status-success\"\n};\nconst _hoisted_22 = {\n    key: 1,\n    class: \"status-badge status-fail\"\n};\nconst _hoisted_23 = { class: \"form-group\" };\nconst _hoisted_24 = { class: \"form-group\" };\nconst _hoisted_25 = { class: \"form-row\" };\nconst _hoisted_26 = { class: \"form-group half\" };\nconst _hoisted_27 = { class: \"form-group half\" };\nconst _hoisted_28 = { class: \"toggle-icon\" };\nconst _hoisted_29 = {\n    key: 0,\n    class: \"advanced-params\"\n};\nconst _hoisted_30 = { class: \"form-row\" };\nconst _hoisted_31 = { class: \"form-group half\" };\nconst _hoisted_32 = { class: \"form-group half\" };\nconst _hoisted_33 = { class: \"form-row\" };\nconst _hoisted_34 = { class: \"form-group half\" };\nconst _hoisted_35 = { class: \"form-group half\" };\nconst _hoisted_36 = { class: \"setting-section\" };\nconst _hoisted_37 = { class: \"form-group\" };\nconst _hoisted_38 = { class: \"input-with-btn\" };\nconst _hoisted_39 = [\"disabled\"];\nconst _hoisted_40 = { class: \"form-group\" };\nconst _hoisted_41 = { class: \"model-list\" };\nconst _hoisted_42 = [\"onClick\"];\nconst _hoisted_43 = { class: \"form-group\" };\nconst _hoisted_44 = { class: \"model-list\" };\nconst _hoisted_45 = [\"disabled\"];\nconst _hoisted_46 = [\"disabled\"];\nconst _hoisted_47 = [\"disabled\"];\nconst _hoisted_48 = { class: \"hint\" };\nconst _hoisted_49 = {\n    key: 0,\n    class: \"hint\"\n};\nconst _hoisted_50 = {\n    key: 1,\n    class: \"hint hint-error\"\n};\nconst _hoisted_51 = {\n    key: 2,\n    class: \"local-model-info\"\n};\nconst _hoisted_52 = {\n    key: 3,\n    class: \"hint\"\n};\nconst _hoisted_53 = { class: \"form-group\" };\nconst _hoisted_54 = { class: \"form-group\" };\nconst _hoisted_55 = { class: \"form-group\" };\nconst _hoisted_56 = { class: \"form-group\" };\nconst _hoisted_57 = { class: \"setting-section\" };\nconst _hoisted_58 = { class: \"form-group\" };\nconst _hoisted_59 = [\"value\"];\nconst _hoisted_60 = {\n    key: 0,\n    class: \"form-group\"\n};\nconst _hoisted_61 = { class: \"form-group\" };\nconst _hoisted_62 = { class: \"form-group\" };\nconst _hoisted_63 = [\"disabled\"];\nconst _hoisted_64 = { class: \"form-group\" };\nconst _hoisted_65 = [\"disabled\"];\nconst _hoisted_66 = { class: \"form-group\" };\nconst _hoisted_67 = { class: \"form-group\" };\nconst _hoisted_68 = [\"value\"];\nconst _hoisted_69 = { class: \"form-row\" };\nconst _hoisted_70 = { class: \"form-group half\" };\nconst _hoisted_71 = { class: \"form-group half\" };\nconst _hoisted_72 = { class: \"form-group\" };\nconst _hoisted_73 = { class: \"form-group\" };\nconst _hoisted_74 = { class: \"form-group\" };\nconst _hoisted_75 = { class: \"form-group\" };\nconst _hoisted_76 = { class: \"form-group\" };\nconst _hoisted_77 = { class: \"form-group\" };\nconst _hoisted_78 = {\n    key: 2,\n    class: \"form-group\"\n};\nconst _hoisted_79 = { class: \"form-row\" };\nconst _hoisted_80 = { class: \"form-group half\" };\nconst _hoisted_81 = [\"disabled\"];\nconst _hoisted_82 = { class: \"form-group\" };\nconst _hoisted_83 = { class: \"hint\" };\nconst _hoisted_84 = {\n    key: 0,\n    class: \"dice-sheet-list\"\n};\nconst _hoisted_85 = [\"checked\", \"onChange\"];\nconst _hoisted_86 = {\n    key: 1,\n    class: \"hint\"\n};\nconst _hoisted_87 = { class: \"setting-section\" };\nconst _hoisted_88 = { class: \"emotion-layout\" };\nconst _hoisted_89 = { class: \"emotion-configs\" };\nconst _hoisted_90 = { class: \"form-group\" };\nconst _hoisted_91 = { class: \"hint\" };\nconst _hoisted_92 = {\n    key: 0,\n    class: \"form-group\"\n};\nconst _hoisted_93 = { class: \"form-row\" };\nconst _hoisted_94 = { class: \"form-group half\" };\nconst _hoisted_95 = [\"disabled\"];\nconst _hoisted_96 = { class: \"form-row\" };\nconst _hoisted_97 = { class: \"form-group half\" };\nconst _hoisted_98 = { class: \"form-group half\" };\nconst _hoisted_99 = { class: \"form-group\" };\nconst _hoisted_100 = { class: \"hint\" };\nconst _hoisted_101 = { class: \"form-group\" };\nconst _hoisted_102 = { class: \"toggle-icon\" };\nconst _hoisted_103 = { class: \"emotion-map-table\" };\nconst _hoisted_104 = { class: \"emotion-map-tag\" };\nconst _hoisted_105 = [\"onUpdate:modelValue\"];\nconst _hoisted_106 = [\"value\"];\nconst _hoisted_107 = [\"value\"];\nconst _hoisted_108 = [\"value\", \"disabled\", \"onChange\"];\nconst _hoisted_109 = [\"value\"];\nconst _hoisted_110 = [\"value\"];\nconst _hoisted_111 = [\"onClick\"];\nconst _hoisted_112 = {\n    key: 1,\n    class: \"emotion-advanced-list\"\n};\nconst _hoisted_113 = { class: \"emotion-advanced-title\" };\nconst _hoisted_114 = { class: \"form-row\" };\nconst _hoisted_115 = { class: \"form-group half\" };\nconst _hoisted_116 = [\"value\", \"onBlur\"];\nconst _hoisted_117 = { class: \"form-group half\" };\nconst _hoisted_118 = [\"onUpdate:modelValue\"];\nconst _hoisted_119 = { class: \"form-group\" };\nconst _hoisted_120 = [\"onUpdate:modelValue\"];\nconst _hoisted_121 = { class: \"emotion-preview-panel\" };\nconst _hoisted_122 = { class: \"emotion-preview-header\" };\nconst _hoisted_123 = { class: \"emotion-preview-tag\" };\nconst _hoisted_124 = {\n    key: 0,\n    class: \"emotion-preview-empty\"\n};\nconst _hoisted_125 = { class: \"emotion-preview-controls\" };\nconst _hoisted_126 = { class: \"emotion-zoom-row\" };\nconst _hoisted_127 = { class: \"zoom-value\" };\nconst _hoisted_128 = [\"title\"];\nconst _hoisted_129 = { class: \"setting-section\" };\nconst _hoisted_130 = { class: \"form-group\" };\nconst _hoisted_131 = { class: \"form-group\" };\nconst _hoisted_132 = [\"value\"];\nconst _hoisted_133 = [\"value\"];\nconst _hoisted_134 = [\"value\"];\nconst _hoisted_135 = { class: \"form-group\" };\nconst _hoisted_136 = { class: \"form-group\" };\nconst _hoisted_137 = { class: \"form-group\" };\nconst _hoisted_138 = { class: \"form-group\" };\nconst _hoisted_139 = { class: \"form-group\" };\nconst _hoisted_140 = { class: \"input-with-btn\" };\nconst _hoisted_141 = [\"value\"];\nconst _hoisted_142 = [\"disabled\"];\nconst _hoisted_143 = { class: \"hint\" };\nconst _hoisted_144 = { class: \"toggle-icon\" };\nconst _hoisted_145 = {\n    key: 0,\n    class: \"advanced-params\"\n};\nconst _hoisted_146 = { class: \"form-group\" };\nconst _hoisted_147 = { class: \"form-group\" };\nconst _hoisted_148 = {\n    key: 1,\n    class: \"advanced-params\"\n};\nconst _hoisted_149 = { class: \"form-group\" };\nconst _hoisted_150 = { class: \"form-group\" };\nconst _hoisted_151 = { class: \"form-group\" };\nconst _hoisted_152 = { class: \"form-group\" };\nconst _hoisted_153 = {\n    key: 0,\n    class: \"form-group\"\n};\nconst _hoisted_154 = { class: \"form-group\" };\nconst _hoisted_155 = { class: \"form-group\" };\nconst _hoisted_156 = { class: \"local-model-info\" };\nconst _hoisted_157 = { class: \"form-row\" };\nconst _hoisted_158 = { class: \"form-group half\" };\nconst _hoisted_159 = [\"disabled\"];\nconst _hoisted_160 = { class: \"form-row\" };\nconst _hoisted_161 = { class: \"form-group half\" };\nconst _hoisted_162 = [\"disabled\"];\nconst _hoisted_163 = { class: \"form-group half\" };\nconst _hoisted_164 = {\n    key: 2,\n    class: \"form-group\"\n};\nconst _hoisted_165 = [\"disabled\"];\nconst _hoisted_166 = { class: \"setting-section\" };\nconst _hoisted_167 = { class: \"browser-dialog-body gpt-model-body\" };\nconst _hoisted_168 = { class: \"gpt-model-tools\" };\nconst _hoisted_169 = {\n    key: 0,\n    class: \"local-model-info\"\n};\nconst _hoisted_170 = {\n    key: 1,\n    class: \"gpt-model-card-list\"\n};\nconst _hoisted_171 = { class: \"gpt-model-card-head\" };\nconst _hoisted_172 = [\"onUpdate:modelValue\"];\nconst _hoisted_173 = { class: \"gpt-model-id\" };\nconst _hoisted_174 = { class: \"form-row\" };\nconst _hoisted_175 = { class: \"form-group half\" };\nconst _hoisted_176 = [\"onUpdate:modelValue\"];\nconst _hoisted_177 = { class: \"form-group half\" };\nconst _hoisted_178 = [\"onUpdate:modelValue\"];\nconst _hoisted_179 = { class: \"form-row\" };\nconst _hoisted_180 = { class: \"form-group half\" };\nconst _hoisted_181 = [\"onUpdate:modelValue\"];\nconst _hoisted_182 = { class: \"form-group half\" };\nconst _hoisted_183 = [\"onUpdate:modelValue\"];\nconst _hoisted_184 = { class: \"form-row\" };\nconst _hoisted_185 = { class: \"form-group half\" };\nconst _hoisted_186 = [\"onUpdate:modelValue\"];\nconst _hoisted_187 = [\"value\"];\nconst _hoisted_188 = { class: \"form-group half\" };\nconst _hoisted_189 = [\"onUpdate:modelValue\"];\nconst _hoisted_190 = { class: \"hint\" };\nconst _hoisted_191 = { class: \"gpt-model-card-actions\" };\nconst _hoisted_192 = [\"onClick\"];\nconst _hoisted_193 = [\"onClick\"];\nconst _hoisted_194 = [\"onClick\"];\nconst _hoisted_195 = [\"onClick\"];\nconst _hoisted_196 = [\"onClick\"];\nconst _hoisted_197 = { class: \"browser-dialog-header gpt-model-header\" };\nconst _hoisted_198 = { class: \"browser-dialog-body gpt-model-body\" };\nconst _hoisted_199 = { class: \"form-row\" };\nconst _hoisted_200 = { class: \"form-group half\" };\nconst _hoisted_201 = { class: \"form-group half\" };\nconst _hoisted_202 = { class: \"form-row\" };\nconst _hoisted_203 = { class: \"form-group half\" };\nconst _hoisted_204 = { class: \"form-group half\" };\nconst _hoisted_205 = { class: \"form-row\" };\nconst _hoisted_206 = { class: \"form-group half\" };\nconst _hoisted_207 = { class: \"form-group half\" };\nconst _hoisted_208 = { class: \"form-row\" };\nconst _hoisted_209 = { class: \"form-group half\" };\nconst _hoisted_210 = { class: \"form-group half\" };\nconst _hoisted_211 = { class: \"form-row\" };\nconst _hoisted_212 = { class: \"form-group half\" };\nconst _hoisted_213 = { class: \"form-group half\" };\nconst _hoisted_214 = { class: \"form-row\" };\nconst _hoisted_215 = { class: \"form-group half\" };\nconst _hoisted_216 = { class: \"form-group half\" };\nconst _hoisted_217 = { class: \"form-row\" };\nconst _hoisted_218 = { class: \"form-group half\" };\nconst _hoisted_219 = { class: \"form-group half\" };\nconst _hoisted_220 = { class: \"form-row\" };\nconst _hoisted_221 = { class: \"form-group half\" };\nconst _hoisted_222 = { class: \"form-group half\" };\nconst _hoisted_223 = { class: \"form-group\" };\nconst _hoisted_224 = { class: \"gpt-ref-list\" };\nconst _hoisted_225 = { class: \"form-row\" };\nconst _hoisted_226 = { class: \"form-group half\" };\nconst _hoisted_227 = [\"onUpdate:modelValue\"];\nconst _hoisted_228 = { class: \"form-group half\" };\nconst _hoisted_229 = [\"onUpdate:modelValue\"];\nconst _hoisted_230 = { class: \"form-group\" };\nconst _hoisted_231 = [\"onUpdate:modelValue\"];\nconst _hoisted_232 = { class: \"form-row\" };\nconst _hoisted_233 = { class: \"form-group half\" };\nconst _hoisted_234 = [\"onUpdate:modelValue\"];\nconst _hoisted_235 = { class: \"form-group half\" };\nconst _hoisted_236 = [\"onUpdate:modelValue\"];\nconst _hoisted_237 = { class: \"form-row\" };\nconst _hoisted_238 = { class: \"form-group half\" };\nconst _hoisted_239 = [\"onUpdate:modelValue\"];\nconst _hoisted_240 = { class: \"form-group half gpt-ref-actions\" };\nconst _hoisted_241 = [\"onClick\"];\nconst _hoisted_242 = [\"onClick\"];\nconst _hoisted_243 = { class: \"form-group\" };\nconst _hoisted_244 = { class: \"gpt-expression-map-list\" };\nconst _hoisted_245 = [\"onUpdate:modelValue\"];\nconst _hoisted_246 = [\"onUpdate:modelValue\"];\nconst _hoisted_247 = [\"value\"];\nconst _hoisted_248 = [\"onClick\"];\nconst _hoisted_249 = { class: \"browser-dialog-header\" };\nconst _hoisted_250 = { class: \"browser-dialog-body\" };\nimport { storeToRefs } from 'pinia';\nimport { computed, nextTick, onBeforeUnmount, ref, watch } from 'vue';\nimport { getGptSoVitsVoiceList, getTTSEnabled, getTTSVoiceListAsync, inferGptSoVitsModelsFromFolderFiles, inferGptSoVitsVoicesFromFolderFiles, isAbsoluteFileSystemPath, normalizeGptSoVitsModelsForStore, normalizeGptSoVitsSwitchMode, normalizeGptSoVitsVoicesForStore, pickFirstUsableGptSoVitsVoice, setTTSEnabled, TTS_PROVIDER, } from '../audio/tts-config';\nimport { TTSManager } from '../audio/tts-manager';\nimport { API_SOURCES, COMMENT_STYLES, COMMENT_TRIGGER_MODE_OPTIONS, DEFAULTS, EMOTION_TAGS, EMPTY_MOTION_GROUP_VALUE, LOCAL_LIVE2D_MODEL_PATH, LOCAL_LIVE2D_MODEL_SLOT_ID, RECOMMENDED_MODELS, SCRIPT_NAME, } from '../core/constants';\nimport { createDefaultEmotionConfigs, parseAliasesText } from '../core/emotion';\nimport { useSettingsStore } from '../core/settings';\nimport { deleteLive2DModel, getLive2DModel, hasLive2DModel } from '../db/live2d-models';\nimport { getBuiltinExpressionByKey, getBuiltinExpressionOptions, getBuiltinMotionByKey, getBuiltinMotionOptions, makeBuiltinExpressionToken, makeBuiltinMotionToken, parseBuiltinMotionToken, } from '../live2d/builtin-expression-motion';\nimport { resolveLive2DExpression, resolveLive2DMotion } from '../live2d/expression-motion';\nimport { Live2DManager } from '../live2d/manager';\nimport { Live2DStage } from '../live2d/stage';\nimport { Live2DUploader } from '../live2d/uploader';\nimport ModelBrowser from './ModelBrowser.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SettingsPanel',\n    props: {\n        visible: { type: Boolean }\n    },\n    emits: [\"close\", \"model-change\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const sectionTabs = [\n            { key: 'api', index: '01', label: 'API ', en: 'API CONTROL' },\n            { key: 'live2d', index: '02', label: 'Live2D', en: 'MODEL CONTROL' },\n            { key: 'comment', index: '03', label: '', en: 'COMMENT SYSTEM' },\n            { key: 'expression', index: '04', label: '', en: 'EMOTION COT' },\n            { key: 'tts', index: '05', label: 'TTS', en: 'VOICE CONTROL' },\n            { key: 'about', index: '06', label: '', en: 'ABOUT & LICENSE' },\n        ];\n        const activeSection = ref('api');\n        const store = useSettingsStore();\n        const { settings } = storeToRefs(store);\n        function toBoundedNumber(value, fallback, min, max) {\n            const parsed = typeof value === 'number' ? value : Number(value);\n            if (!Number.isFinite(parsed))\n                return fallback;\n            return clamp(parsed, min, max);\n        }\n        function ensureNumericSettingsIntegrity() {\n            if (!settings.value.apiConfig || typeof settings.value.apiConfig !== 'object') {\n                settings.value.apiConfig = {\n                    url: '',\n                    apiKey: '',\n                    model: 'gpt-4o-mini',\n                    source: 'openai',\n                    max_tokens: DEFAULTS.MAX_TOKENS,\n                    temperature: DEFAULTS.TEMPERATURE,\n                    frequency_penalty: DEFAULTS.FREQUENCY_PENALTY,\n                    presence_penalty: DEFAULTS.PRESENCE_PENALTY,\n                    top_p: DEFAULTS.TOP_P,\n                    top_k: DEFAULTS.TOP_K,\n                    usePresetSampling: false,\n                    sendWorldInfo: false,\n                };\n            }\n            const api = settings.value.apiConfig;\n            api.max_tokens = Math.round(toBoundedNumber(api.max_tokens, DEFAULTS.MAX_TOKENS, 1, 4096));\n            api.temperature = toBoundedNumber(api.temperature, DEFAULTS.TEMPERATURE, 0, 2);\n            api.frequency_penalty = toBoundedNumber(api.frequency_penalty, DEFAULTS.FREQUENCY_PENALTY, -2, 2);\n            api.presence_penalty = toBoundedNumber(api.presence_penalty, DEFAULTS.PRESENCE_PENALTY, -2, 2);\n            api.top_p = toBoundedNumber(api.top_p, DEFAULTS.TOP_P, 0, 1);\n            api.top_k = Math.round(toBoundedNumber(api.top_k, DEFAULTS.TOP_K, 0, 500));\n            if (typeof api.url !== 'string')\n                api.url = String(api.url ?? '');\n            if (typeof api.apiKey !== 'string')\n                api.apiKey = String(api.apiKey ?? '');\n            if (typeof api.model !== 'string')\n                api.model = String(api.model ?? 'gpt-4o-mini');\n            if (typeof api.source !== 'string')\n                api.source = String(api.source ?? 'openai');\n            api.usePresetSampling = api.usePresetSampling === true;\n            api.sendWorldInfo = api.sendWorldInfo === true;\n            settings.value.petScale = toBoundedNumber(settings.value.petScale, DEFAULTS.PET_SCALE, 0.1, 3);\n            const rawBubbleDuration = typeof settings.value.bubbleDuration === 'number'\n                ? settings.value.bubbleDuration\n                : Number(settings.value.bubbleDuration ?? Number.NaN);\n            const bubbleDurationSeconds = Number.isFinite(rawBubbleDuration) && rawBubbleDuration > 600 ? rawBubbleDuration / 1000 : rawBubbleDuration;\n            settings.value.bubbleDuration = Math.round(toBoundedNumber(bubbleDurationSeconds, DEFAULTS.BUBBLE_DURATION, -1, 600));\n        }\n        const temperatureLabel = computed(() => toBoundedNumber(settings.value.apiConfig?.temperature, DEFAULTS.TEMPERATURE, 0, 2).toFixed(1));\n        const frequencyPenaltyLabel = computed(() => toBoundedNumber(settings.value.apiConfig?.frequency_penalty, DEFAULTS.FREQUENCY_PENALTY, -2, 2).toFixed(1));\n        const presencePenaltyLabel = computed(() => toBoundedNumber(settings.value.apiConfig?.presence_penalty, DEFAULTS.PRESENCE_PENALTY, -2, 2).toFixed(1));\n        const topPLabel = computed(() => toBoundedNumber(settings.value.apiConfig?.top_p, DEFAULTS.TOP_P, 0, 1).toFixed(2));\n        const petScaleLabel = computed(() => toBoundedNumber(settings.value.petScale, DEFAULTS.PET_SCALE, 0.1, 3).toFixed(2));\n        ensureNumericSettingsIntegrity();\n        const recommendedModels = RECOMMENDED_MODELS;\n        const commentStyles = COMMENT_STYLES;\n        const commentTriggerModeOptions = COMMENT_TRIGGER_MODE_OPTIONS;\n        const apiSources = API_SOURCES;\n        const showBrowser = ref(false);\n        const customModelUrl = ref(settings.value.modelPath || '');\n        const localModelFileInput = ref(null);\n        const uploadingLocalModel = ref(false);\n        const localModelActionBusy = ref(false);\n        const localModelStatus = ref('');\n        const localModelError = ref('');\n        const localModelInfo = ref(null);\n        const localModelBusy = computed(() => uploadingLocalModel.value || localModelActionBusy.value);\n        const localModelExists = computed(() => !!localModelInfo.value);\n        const diceReferenceSheetOptions = ref([]);\n        const refreshingDiceSheetOptions = ref(false);\n        function normalizeDiceReferenceSheetName(value) {\n            return String(value ?? '')\n                .replace(/\\u00a0/g, ' ')\n                .replace(/\\r\\n/g, '\\n')\n                .replace(/\\n+/g, ' ')\n                .replace(/\\s{2,}/g, ' ')\n                .trim();\n        }\n        function dedupeDiceReferenceSheetNames(values) {\n            const seen = new Set();\n            const list = [];\n            for (const value of values) {\n                const name = normalizeDiceReferenceSheetName(value);\n                if (!name)\n                    continue;\n                if (seen.has(name))\n                    continue;\n                seen.add(name);\n                list.push(name);\n            }\n            return list;\n        }\n        function parseDiceReferenceRecord(value) {\n            if (typeof value === 'string') {\n                const text = value.trim();\n                if (!text)\n                    return null;\n                try {\n                    return parseDiceReferenceRecord(JSON.parse(text));\n                }\n                catch {\n                    return null;\n                }\n            }\n            if (!value || typeof value !== 'object' || Array.isArray(value)) {\n                return null;\n            }\n            return value;\n        }\n        function isDiceReferencePayload(record) {\n            return Object.keys(record).some(key => key.startsWith('sheet_'));\n        }\n        function extractDiceReferenceSheetNamesFromPayload(payload) {\n            const record = parseDiceReferenceRecord(payload);\n            if (!record)\n                return [];\n            let tableRecord = record;\n            if (!isDiceReferencePayload(tableRecord)) {\n                const nested = parseDiceReferenceRecord(tableRecord.independentData);\n                if (!nested || !isDiceReferencePayload(nested)) {\n                    return [];\n                }\n                tableRecord = nested;\n            }\n            return dedupeDiceReferenceSheetNames(Object.keys(tableRecord)\n                .filter(key => key.startsWith('sheet_'))\n                .map(key => {\n                const sheet = parseDiceReferenceRecord(tableRecord?.[key]);\n                return sheet?.name ?? '';\n            }));\n        }\n        function pickDiceReferencePayloadFromIsolatedData(value) {\n            const isolated = parseDiceReferenceRecord(value);\n            if (!isolated)\n                return null;\n            const keys = Object.keys(isolated);\n            for (let i = keys.length - 1; i >= 0; i--) {\n                const slot = parseDiceReferenceRecord(isolated[keys[i]]);\n                if (!slot)\n                    continue;\n                const payload = parseDiceReferenceRecord(slot.independentData);\n                if (payload && isDiceReferencePayload(payload)) {\n                    return payload;\n                }\n            }\n            return null;\n        }\n        function pickDiceReferencePayloadFromMessage(message) {\n            if (!message || typeof message !== 'object')\n                return null;\n            const directCandidates = [\n                message.TavernDB_ACU_IndependentData,\n                message.TavernDB_ACU_Data,\n                message.TavernDB_ACU_SummaryData,\n                message.data?.TavernDB_ACU_IndependentData,\n                message.data?.TavernDB_ACU_Data,\n                message.data?.TavernDB_ACU_SummaryData,\n            ];\n            for (const candidate of directCandidates) {\n                const payload = parseDiceReferenceRecord(candidate);\n                if (!payload)\n                    continue;\n                if (isDiceReferencePayload(payload)) {\n                    return payload;\n                }\n                const nested = parseDiceReferenceRecord(payload.independentData);\n                if (nested && isDiceReferencePayload(nested)) {\n                    return nested;\n                }\n            }\n            const isolatedCandidates = [message.TavernDB_ACU_IsolatedData, message.data?.TavernDB_ACU_IsolatedData];\n            for (const candidate of isolatedCandidates) {\n                const payload = pickDiceReferencePayloadFromIsolatedData(candidate);\n                if (payload)\n                    return payload;\n            }\n            return null;\n        }\n        function readDiceReferenceSheetNamesFromApi() {\n            try {\n                const topWindow = window.parent ?? window;\n                const api = topWindow?.AutoCardUpdaterAPI;\n                if (!api || typeof api.exportTableAsJson !== 'function') {\n                    return [];\n                }\n                return extractDiceReferenceSheetNamesFromPayload(api.exportTableAsJson());\n            }\n            catch {\n                return [];\n            }\n        }\n        function readDiceReferenceSheetNamesFromChat() {\n            try {\n                const messages = getChatMessages(`0-{{lastMessageId}}`, {\n                    role: 'all',\n                    hide_state: 'all',\n                });\n                const list = Array.isArray(messages) ? messages : [];\n                for (let i = list.length - 1; i >= 0; i--) {\n                    const payload = pickDiceReferencePayloadFromMessage(list[i]);\n                    if (!payload)\n                        continue;\n                    const names = extractDiceReferenceSheetNamesFromPayload(payload);\n                    if (names.length > 0)\n                        return names;\n                }\n            }\n            catch {\n                // ignore\n            }\n            return [];\n        }\n        function getDiceReferenceSelectedSheets() {\n            const raw = Array.isArray(settings.value.diceReferenceVisibleSheets)\n                ? settings.value.diceReferenceVisibleSheets\n                : [];\n            return dedupeDiceReferenceSheetNames(raw.map(item => String(item ?? '')));\n        }\n        function setDiceReferenceSelectedSheets(next) {\n            settings.value.diceReferenceVisibleSheets = dedupeDiceReferenceSheetNames(next);\n        }\n        function isDiceSheetVisible(sheetName) {\n            const selected = getDiceReferenceSelectedSheets();\n            if (selected.length === 0)\n                return true;\n            return selected.includes(sheetName);\n        }\n        function onToggleDiceSheetVisibility(sheetName, event) {\n            const target = event?.target;\n            const checked = !!target?.checked;\n            const options = diceReferenceSheetOptions.value;\n            const current = getDiceReferenceSelectedSheets();\n            let next = current.length === 0 ? [...options] : [...current];\n            if (checked) {\n                if (!next.includes(sheetName)) {\n                    next.push(sheetName);\n                }\n            }\n            else {\n                next = next.filter(name => name !== sheetName);\n            }\n            // \n            if (options.length > 0 && next.length === options.length) {\n                next = [];\n            }\n            setDiceReferenceSelectedSheets(next);\n        }\n        const diceReferenceSheetSummary = computed(() => {\n            const optionsCount = diceReferenceSheetOptions.value.length;\n            const selected = getDiceReferenceSelectedSheets();\n            if (optionsCount <= 0) {\n                return '';\n            }\n            if (selected.length === 0) {\n                return `${optionsCount}/${optionsCount}`;\n            }\n            return ` ${selected.length}/${optionsCount}`;\n        });\n        function refreshDiceReferenceSheetOptions() {\n            refreshingDiceSheetOptions.value = true;\n            try {\n                const fromApi = readDiceReferenceSheetNamesFromApi();\n                const fromChat = fromApi.length > 0 ? [] : readDiceReferenceSheetNamesFromChat();\n                const selected = getDiceReferenceSelectedSheets();\n                diceReferenceSheetOptions.value = dedupeDiceReferenceSheetNames([\n                    ...fromApi,\n                    ...fromChat,\n                    ...selected,\n                ]);\n            }\n            finally {\n                refreshingDiceSheetOptions.value = false;\n            }\n        }\n        function selectAllDiceReferenceSheets() {\n            // \n            setDiceReferenceSelectedSheets([]);\n        }\n        function clearDiceReferenceSheets() {\n            // \n            setDiceReferenceSelectedSheets([]);\n        }\n        const ttsEnabled = ref(getTTSEnabled());\n        const ttsVoiceList = ref([]);\n        const refreshingTtsVoices = ref(false);\n        const gptSoVitsModelsJson = ref('');\n        const gptSoVitsVoicesJson = ref('');\n        const ttsTestText = ref(' TTS ');\n        const gptModelImportJsonInputRef = ref(null);\n        const gptModelImportFolderInputRef = ref(null);\n        const gptImportJsonInputRef = ref(null);\n        const gptImportFolderInputRef = ref(null);\n        const showGptModelManager = ref(false);\n        const showGptModelEditor = ref(false);\n        const gptModelManagerSearch = ref('');\n        const gptModelManagerModels = ref([]);\n        const gptModelManagerImportJsonInputRef = ref(null);\n        const gptModelManagerImportFolderInputRef = ref(null);\n        const gptModelEditor = ref(null);\n        const gptModelEditorModelId = ref('');\n        const gptModelEditorExpressionRows = ref([]);\n        const isGptSetModelMode = computed(() => normalizeGptSoVitsSwitchMode(settings.value.gptSoVits?.modelSwitchMode) === 'set_model');\n        const ttsVoiceHint = computed(() => {\n            const providerHint = settings.value.ttsProvider === TTS_PROVIDER.GPT_SOVITS_V2\n                ? 'GPT-SoVITS name '\n                : settings.value.ttsProvider === TTS_PROVIDER.EDGE_TTS_DIRECT\n                    ? 'EdgeTTS Edge '\n                    : 'LittleWhiteBox/';\n            const emptyHint = ttsVoiceList.value.length === 0 ? '' : '';\n            return `${providerHint}${emptyHint}`;\n        });\n        const gptModelSummaryHint = computed(() => {\n            const models = Array.isArray(settings.value.gptSoVits?.models) ? settings.value.gptSoVits.models : [];\n            const enabledCount = models.filter((item) => item?.enabled !== false).length;\n            const refCount = models.reduce((sum, item) => {\n                const refs = Array.isArray(item?.refAudios) ? item.refAudios.length : 0;\n                return sum + refs;\n            }, 0);\n            const defaultSpeaker = String(settings.value.ttsDefaultSpeaker || '').trim() || '';\n            return ` ${models.length}  ${enabledCount}  ${refCount} ${defaultSpeaker}`;\n        });\n        const filteredGptModelManagerModels = computed(() => {\n            const list = Array.isArray(gptModelManagerModels.value) ? gptModelManagerModels.value : [];\n            const keyword = String(gptModelManagerSearch.value || '').trim().toLowerCase();\n            if (!keyword)\n                return list;\n            return list.filter(model => {\n                const text = [\n                    String(model?.name || ''),\n                    String(model?.desc || ''),\n                    String(model?.id || ''),\n                    String(model?.paths?.gptWeightsPath || ''),\n                    String(model?.paths?.sovitsWeightsPath || ''),\n                ]\n                    .join(' ')\n                    .toLowerCase();\n                return text.includes(keyword);\n            });\n        });\n        const emotionTags = EMOTION_TAGS;\n        const live2dExpressions = ref([]);\n        const live2dMotionGroups = ref([]);\n        const live2dMotions = ref([]);\n        const refreshingLive2dLists = ref(false);\n        const live2dExpressionOptions = computed(() => {\n            const dedup = new Set();\n            const list = [];\n            for (const item of live2dExpressions.value) {\n                const value = String(item ?? '').trim();\n                if (!value)\n                    continue;\n                if (dedup.has(value))\n                    continue;\n                dedup.add(value);\n                list.push(value);\n            }\n            return list.sort((a, b) => a.localeCompare(b));\n        });\n        const live2dExpressionSelectOptions = computed(() => {\n            const options = [];\n            const seen = new Set();\n            for (const expr of live2dExpressionOptions.value) {\n                const value = String(expr || '').trim();\n                if (!value || seen.has(value))\n                    continue;\n                seen.add(value);\n                options.push({\n                    key: `native_expr_${value}`.replace(/\\s+/g, '_'),\n                    value,\n                    label: value,\n                });\n            }\n            for (const builtin of getBuiltinExpressionOptions()) {\n                if (!builtin?.token || seen.has(builtin.token))\n                    continue;\n                seen.add(builtin.token);\n                options.push({\n                    key: `builtin_expr_${builtin.key}`,\n                    value: builtin.token,\n                    label: `${builtin.label}`,\n                });\n            }\n            return options.sort((a, b) => a.label.localeCompare(b.label, 'zh-CN'));\n        });\n        const live2dExpressionOptionSet = computed(() => {\n            return new Set(live2dExpressionSelectOptions.value.map(option => option.value));\n        });\n        function normalizeMotionIndex(value) {\n            const parsed = Number(value);\n            return Number.isFinite(parsed) ? Math.max(0, Math.floor(parsed)) : 0;\n        }\n        function normalizeMotionGroupValue(value) {\n            const raw = String(value ?? '').trim();\n            if (raw === EMPTY_MOTION_GROUP_VALUE)\n                return '';\n            return raw;\n        }\n        function isEmptyMotionGroupMarker(value) {\n            return String(value ?? '').trim() === EMPTY_MOTION_GROUP_VALUE;\n        }\n        function normalizeMotionOverridePayload(payload) {\n            const explicitEmptyGroup = payload.explicitEmptyGroup === true || isEmptyMotionGroupMarker(payload.group);\n            return {\n                group: normalizeMotionGroupValue(payload.group),\n                index: normalizeMotionIndex(payload.index),\n                name: String(payload.name ?? '').trim(),\n                explicitEmptyGroup,\n            };\n        }\n        function encodeMotionOption(payload) {\n            const normalized = normalizeMotionOverridePayload(payload);\n            const hasExplicitEmpty = normalized.explicitEmptyGroup === true && normalized.group === '';\n            if (!normalized.group && normalized.index === 0 && !hasExplicitEmpty)\n                return '';\n            return JSON.stringify({\n                ...normalized,\n                group: normalized.group === '' && hasExplicitEmpty ? EMPTY_MOTION_GROUP_VALUE : normalized.group,\n            });\n        }\n        function decodeMotionOption(raw) {\n            const text = String(raw || '').trim();\n            if (!text)\n                return null;\n            try {\n                const parsed = JSON.parse(text);\n                if (!parsed || typeof parsed !== 'object')\n                    return null;\n                const explicitEmptyGroup = isEmptyMotionGroupMarker(parsed.group);\n                const group = normalizeMotionGroupValue(parsed.group ?? '');\n                const index = normalizeMotionIndex(parsed.index);\n                if (!group && index === 0 && !explicitEmptyGroup)\n                    return null;\n                return {\n                    group,\n                    index,\n                    name: String(parsed.name ?? '').trim(),\n                    explicitEmptyGroup,\n                };\n            }\n            catch {\n                return null;\n            }\n        }\n        function resolveMotionOverridePayload(cfg) {\n            const rawGroup = String(cfg?.live2dMotion?.group ?? '');\n            const explicitEmptyGroup = isEmptyMotionGroupMarker(rawGroup);\n            const overrideGroup = normalizeMotionGroupValue(rawGroup);\n            const overrideIndex = normalizeMotionIndex(cfg?.live2dMotion?.index);\n            const hasExplicitOverride = explicitEmptyGroup || !!overrideGroup || overrideIndex > 0;\n            if (!hasExplicitOverride)\n                return null;\n            const exactByGroupIndex = live2dMotions.value.find((motion) => {\n                const group = normalizeMotionGroupValue(motion?.group);\n                const index = normalizeMotionIndex(motion?.index);\n                return group === overrideGroup && index === overrideIndex;\n            });\n            if (exactByGroupIndex) {\n                return normalizeMotionOverridePayload({\n                    group: exactByGroupIndex.group,\n                    index: exactByGroupIndex.index,\n                    name: exactByGroupIndex.name,\n                });\n            }\n            // group  motion name\n            const lower = overrideGroup.toLowerCase();\n            if (lower) {\n                const byName = live2dMotions.value.find((motion) => {\n                    const name = String(motion?.name ?? '').trim().toLowerCase();\n                    const index = normalizeMotionIndex(motion?.index);\n                    return name === lower && index === overrideIndex;\n                }) ||\n                    live2dMotions.value.find((motion) => String(motion?.name ?? '').trim().toLowerCase() === lower);\n                if (byName) {\n                    return normalizeMotionOverridePayload({\n                        group: byName.group,\n                        index: byName.index,\n                        name: byName.name,\n                    });\n                }\n            }\n            return normalizeMotionOverridePayload({\n                group: overrideGroup,\n                index: overrideIndex,\n                explicitEmptyGroup,\n            });\n        }\n        function getMotionOverrideValue(cfg) {\n            const payload = resolveMotionOverridePayload(cfg);\n            if (!payload)\n                return '';\n            return encodeMotionOption(payload);\n        }\n        function getMotionOverrideLabel(cfg) {\n            const payload = resolveMotionOverridePayload(cfg);\n            if (!payload)\n                return '';\n            const builtinKey = parseBuiltinMotionToken(payload.group);\n            if (builtinKey) {\n                const builtinDef = getBuiltinMotionByKey(builtinKey);\n                return builtinDef ? `${builtinDef.label}` : ` ${builtinKey}`;\n            }\n            if (payload.name) {\n                const groupLabel = payload.group ? `${payload.group}#${payload.index}` : `#${payload.index}`;\n                return `${payload.name} ${groupLabel}`;\n            }\n            return `${payload.group || '()'}#${payload.index}`;\n        }\n        function setMotionOverrideValue(cfg, rawValue) {\n            const parsed = decodeMotionOption(String(rawValue || '').trim());\n            if (!parsed) {\n                cfg.live2dMotion.group = '';\n                cfg.live2dMotion.index = 0;\n                return;\n            }\n            cfg.live2dMotion.group =\n                parsed.group === '' && parsed.explicitEmptyGroup === true ? EMPTY_MOTION_GROUP_VALUE : parsed.group;\n            cfg.live2dMotion.index = parsed.index;\n        }\n        function onMotionOverrideChange(cfg, event) {\n            const target = event?.target;\n            setMotionOverrideValue(cfg, target?.value || '');\n        }\n        const live2dMotionSelectOptions = computed(() => {\n            const seen = new Set();\n            const options = [];\n            for (const motion of live2dMotions.value) {\n                const group = normalizeMotionGroupValue(motion?.group);\n                const index = normalizeMotionIndex(motion?.index);\n                const name = String(motion?.name ?? '').trim();\n                const value = encodeMotionOption({ group, index, name, explicitEmptyGroup: group === '' });\n                if (!value || seen.has(value))\n                    continue;\n                seen.add(value);\n                const groupLabel = `${group || '()'}#${index}`;\n                const safeName = name || '()';\n                options.push({\n                    key: `motion_${groupLabel}_${safeName}`.replace(/\\s+/g, '_'),\n                    value,\n                    label: `${safeName} ${groupLabel}`,\n                });\n            }\n            for (const group of live2dMotionGroups.value) {\n                const groupName = normalizeMotionGroupValue(group?.name);\n                const value = encodeMotionOption({\n                    group: groupName,\n                    index: 0,\n                    explicitEmptyGroup: groupName === '',\n                });\n                if (!value || seen.has(value))\n                    continue;\n                seen.add(value);\n                const groupLabel = groupName || '()';\n                options.push({\n                    key: `group_${groupLabel}_${group.count}`.replace(/\\s+/g, '_'),\n                    value,\n                    label: `${groupLabel} ${group.count}`,\n                });\n            }\n            for (const builtin of getBuiltinMotionOptions()) {\n                const token = makeBuiltinMotionToken(builtin.key);\n                const value = encodeMotionOption({\n                    group: token,\n                    index: 0,\n                    name: builtin.label,\n                    explicitEmptyGroup: false,\n                });\n                if (!value || seen.has(value))\n                    continue;\n                seen.add(value);\n                options.push({\n                    key: `builtin_motion_${builtin.key}`,\n                    value,\n                    label: `${builtin.label}`,\n                });\n            }\n            return options.sort((a, b) => a.label.localeCompare(b.label, 'zh-CN'));\n        });\n        const live2dMotionOptionSet = computed(() => {\n            return new Set(live2dMotionSelectOptions.value.map(option => option.value));\n        });\n        const live2dListSummary = computed(() => {\n            const exprCount = live2dExpressions.value.length;\n            const motionCount = live2dMotions.value.length;\n            const groupCount = live2dMotionGroups.value.length;\n            if (!Live2DManager.model)\n                return ' Live2D ';\n            const exprHint = exprCount === 0 ? ' Expressions' : '';\n            const motionHint = motionCount === 0 ? ' motions' : '';\n            return ` ${exprCount} ${exprHint} ${motionCount} ${motionHint} ${groupCount} `;\n        });\n        const live2dPreviewMountEl = ref(null);\n        const live2dPreviewInteractEl = ref(null);\n        const previewMounted = ref(false);\n        const previewTag = ref('');\n        const previewStatus = ref('');\n        const previewZoomFactor = ref(1.8);\n        let previewPanOffsetX = 0;\n        let previewPanOffsetY = 0;\n        let previewBasePose = { x: 0, y: 0, scale: 1 };\n        let previewIsDragging = false;\n        let previewDragStart = { x: 0, y: 0 };\n        let previewDragOrigin = { x: 0, y: 0 };\n        let previewMountPromise = null;\n        let previewResizeObserver = null;\n        let previewAutoMotionLoopEnabled = true;\n        function clamp(value, min, max) {\n            return Math.max(min, Math.min(max, value));\n        }\n        function getPreviewCanvasSize() {\n            const el = live2dPreviewMountEl.value;\n            const rect = el?.getBoundingClientRect?.();\n            const width = Math.max(1, Math.floor(rect?.width || el?.clientWidth || 320));\n            const height = Math.max(1, Math.floor(rect?.height || el?.clientHeight || 260));\n            return { width, height };\n        }\n        function capturePreviewBasePose() {\n            const model = Live2DManager.model;\n            if (!model)\n                return;\n            const baseScale = Number(model.scale?.x);\n            previewBasePose = {\n                x: Number(model.x) || 0,\n                y: Number(model.y) || 0,\n                scale: Number.isFinite(baseScale) && baseScale > 0 ? baseScale : 1,\n            };\n        }\n        function applyPreviewViewport() {\n            if (!previewMounted.value)\n                return;\n            const model = Live2DManager.model;\n            if (!model)\n                return;\n            const { width, height } = getPreviewCanvasSize();\n            const maxOffsetX = Math.max(60, width * 0.45);\n            const maxOffsetY = Math.max(60, height * 0.45);\n            previewPanOffsetX = clamp(previewPanOffsetX, -maxOffsetX, maxOffsetX);\n            previewPanOffsetY = clamp(previewPanOffsetY, -maxOffsetY, maxOffsetY);\n            previewZoomFactor.value = clamp(previewZoomFactor.value, 0.5, 4);\n            const finalScale = previewBasePose.scale * previewZoomFactor.value;\n            if (model.scale?.set) {\n                model.scale.set(finalScale);\n            }\n            model.x = previewBasePose.x + previewPanOffsetX;\n            model.y = previewBasePose.y + previewPanOffsetY;\n        }\n        function resetPreviewViewport() {\n            previewZoomFactor.value = 1.8;\n            previewPanOffsetX = 0;\n            previewPanOffsetY = 0;\n            applyPreviewViewport();\n        }\n        function getPreviewDragPoint(event) {\n            const ev = event?.originalEvent || event;\n            if (ev?.touches?.length)\n                return { x: ev.touches[0].clientX, y: ev.touches[0].clientY };\n            if (ev?.changedTouches?.length)\n                return { x: ev.changedTouches[0].clientX, y: ev.changedTouches[0].clientY };\n            if (Number.isFinite(ev?.clientX) && Number.isFinite(ev?.clientY))\n                return { x: ev.clientX, y: ev.clientY };\n            return null;\n        }\n        function unbindPreviewViewportEvents() {\n            const interactEl = live2dPreviewInteractEl.value;\n            if (!interactEl)\n                return;\n            const top = window.parent ?? window;\n            const doc = top.document;\n            const handlers = interactEl.__dpPreviewHandlers;\n            if (!handlers)\n                return;\n            try {\n                interactEl.removeEventListener('mousedown', handlers.onDown);\n                interactEl.removeEventListener('touchstart', handlers.onDown);\n                interactEl.removeEventListener('wheel', handlers.onWheel);\n                doc.removeEventListener('mousemove', handlers.onMove);\n                doc.removeEventListener('touchmove', handlers.onMove);\n                doc.removeEventListener('mouseup', handlers.onUp);\n                doc.removeEventListener('touchend', handlers.onUp);\n                doc.removeEventListener('touchcancel', handlers.onUp);\n            }\n            catch {\n                // ignore\n            }\n            interactEl.__dpPreviewHandlers = null;\n        }\n        function bindPreviewViewportEvents() {\n            const interactEl = live2dPreviewInteractEl.value;\n            if (!interactEl)\n                return;\n            if (interactEl.__dpPreviewHandlers)\n                return;\n            const top = window.parent ?? window;\n            const doc = top.document;\n            const onDown = (event) => {\n                if (!previewMounted.value)\n                    return;\n                const point = getPreviewDragPoint(event);\n                if (!point)\n                    return;\n                previewIsDragging = true;\n                previewDragStart = point;\n                previewDragOrigin = { x: previewPanOffsetX, y: previewPanOffsetY };\n                interactEl.style.cursor = 'grabbing';\n                if (typeof event.preventDefault === 'function')\n                    event.preventDefault();\n            };\n            const onMove = (event) => {\n                if (!previewIsDragging)\n                    return;\n                const point = getPreviewDragPoint(event);\n                if (!point)\n                    return;\n                previewPanOffsetX = previewDragOrigin.x + (point.x - previewDragStart.x);\n                previewPanOffsetY = previewDragOrigin.y + (point.y - previewDragStart.y);\n                applyPreviewViewport();\n                if (typeof event.preventDefault === 'function')\n                    event.preventDefault();\n            };\n            const onUp = () => {\n                if (!previewIsDragging)\n                    return;\n                previewIsDragging = false;\n                interactEl.style.cursor = 'grab';\n            };\n            const onWheel = (event) => {\n                if (!previewMounted.value)\n                    return;\n                event.preventDefault();\n                const delta = event.deltaY > 0 ? -0.1 : 0.1;\n                previewZoomFactor.value = clamp(previewZoomFactor.value + delta, 0.5, 4);\n                applyPreviewViewport();\n            };\n            interactEl.style.cursor = 'grab';\n            interactEl.addEventListener('mousedown', onDown);\n            interactEl.addEventListener('touchstart', onDown, { passive: false });\n            interactEl.addEventListener('wheel', onWheel, { passive: false });\n            doc.addEventListener('mousemove', onMove);\n            doc.addEventListener('touchmove', onMove, { passive: false });\n            doc.addEventListener('mouseup', onUp);\n            doc.addEventListener('touchend', onUp);\n            doc.addEventListener('touchcancel', onUp);\n            interactEl.__dpPreviewHandlers = { onDown, onMove, onUp, onWheel };\n        }\n        function disconnectPreviewResizeObserver() {\n            try {\n                previewResizeObserver?.disconnect();\n            }\n            catch {\n                // ignore\n            }\n            finally {\n                previewResizeObserver = null;\n            }\n        }\n        function bindPreviewResizeObserver() {\n            const mountEl = live2dPreviewMountEl.value;\n            if (!mountEl)\n                return;\n            disconnectPreviewResizeObserver();\n            if (typeof ResizeObserver === 'undefined')\n                return;\n            try {\n                previewResizeObserver = new ResizeObserver(() => {\n                    if (!previewMounted.value)\n                        return;\n                    const { width, height } = getPreviewCanvasSize();\n                    Live2DStage.resizePreview(width, height);\n                    applyPreviewViewport();\n                });\n                previewResizeObserver.observe(mountEl);\n            }\n            catch {\n                previewResizeObserver = null;\n            }\n        }\n        async function ensurePreviewMounted() {\n            if (previewMounted.value)\n                return true;\n            if (previewMountPromise)\n                return previewMountPromise;\n            previewMountPromise = (async () => {\n                await nextTick();\n                const mountEl = live2dPreviewMountEl.value;\n                if (!mountEl)\n                    return false;\n                if (!Live2DManager.model) {\n                    previewStatus.value = ' Live2D ';\n                    return false;\n                }\n                if (!Live2DStage.container) {\n                    previewStatus.value = 'Live2D ';\n                    return false;\n                }\n                previewStatus.value = '...';\n                const attached = Live2DStage.pushMount(mountEl);\n                if (!attached) {\n                    previewStatus.value = '';\n                    return false;\n                }\n                previewAutoMotionLoopEnabled = Live2DManager.autoMotionLoopEnabled !== false;\n                Live2DManager.setAutoMotionLoopEnabled(false);\n                Live2DManager.stopBuiltinMotion();\n                Live2DManager.stopCurrentMotion('preview-enter');\n                previewMounted.value = true;\n                bindPreviewViewportEvents();\n                bindPreviewResizeObserver();\n                const { width, height } = getPreviewCanvasSize();\n                Live2DStage.resizePreview(width, height);\n                Live2DManager.mountToStage(width, height, 1);\n                capturePreviewBasePose();\n                resetPreviewViewport();\n                // \n                refreshLive2DLists();\n                previewStatus.value = '/';\n                return true;\n            })().finally(() => {\n                previewMountPromise = null;\n            });\n            return previewMountPromise;\n        }\n        function cleanupPreviewMount(reloadModel = true) {\n            disconnectPreviewResizeObserver();\n            unbindPreviewViewportEvents();\n            previewIsDragging = false;\n            Live2DManager.stopBuiltinMotion();\n            Live2DManager.stopCurrentMotion('preview-cleanup');\n            if (!previewMounted.value)\n                return;\n            previewMounted.value = false;\n            const restored = Live2DStage.popMount();\n            if (restored && Live2DManager.model) {\n                Live2DManager.mountToStage(restored.width, restored.height, 1);\n            }\n            Live2DManager.setAutoMotionLoopEnabled(previewAutoMotionLoopEnabled);\n            if (reloadModel) {\n                const currentPath = String(settings.value.modelPath || '').trim();\n                if (currentPath) {\n                    emit('model-change', currentPath);\n                }\n            }\n            previewStatus.value = '';\n        }\n        function replayPreview() {\n            void previewEmotion(previewTag.value);\n        }\n        watch(() => ({ visible: props.visible, section: activeSection.value }), ({ visible, section }) => {\n            if (visible && section === 'expression') {\n                void (async () => {\n                    const mounted = await ensurePreviewMounted();\n                    if (mounted) {\n                        void previewEmotion(previewTag.value);\n                    }\n                })();\n                return;\n            }\n            cleanupPreviewMount();\n        }, { immediate: true });\n        onBeforeUnmount(() => {\n            cleanupPreviewMount(false);\n        });\n        const modelList = ref([]);\n        const fetchingModels = ref(false);\n        const modelFetchError = ref('');\n        const testingConnection = ref(false);\n        const connectionStatus = ref('idle');\n        const connectionError = ref('');\n        const showAdvanced = ref(false);\n        const showEmotionAdvanced = ref(false);\n        const showLipSyncAdvanced = ref(false);\n        const lipSyncManualParamsText = ref('');\n        const overlayFallbackStyle = {\n            position: 'fixed',\n            inset: '0',\n            width: '100vw',\n            height: '100vh',\n            minHeight: '100vh',\n            zIndex: '10001',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n        };\n        const panelFallbackStyle = {\n            position: 'relative',\n            display: 'flex',\n            flexDirection: 'column',\n            width: 'min(1080px, calc(100vw - 24px))',\n            maxHeight: 'calc(100vh - 24px)',\n            minHeight: '280px',\n        };\n        function normalizeModelList(list) {\n            if (!Array.isArray(list))\n                return [];\n            const out = [];\n            for (const item of list) {\n                if (typeof item === 'string') {\n                    const trimmed = item.trim();\n                    if (trimmed)\n                        out.push(trimmed);\n                    continue;\n                }\n                if (item && typeof item === 'object') {\n                    const maybeId = item.id;\n                    const maybeModel = item.model;\n                    const maybeName = item.name;\n                    const picked = typeof maybeId === 'string'\n                        ? maybeId\n                        : typeof maybeModel === 'string'\n                            ? maybeModel\n                            : typeof maybeName === 'string'\n                                ? maybeName\n                                : '';\n                    const trimmed = picked.trim();\n                    if (trimmed)\n                        out.push(trimmed);\n                }\n            }\n            return [...new Set(out)];\n        }\n        async function getModelListByHttp(customApi) {\n            const base = String(customApi.apiurl || '')\n                .trim()\n                .replace(/\\/+$/, '');\n            if (!base)\n                throw new Error('API URL ');\n            const headers = { Accept: 'application/json' };\n            if (customApi.key)\n                headers.Authorization = `Bearer ${customApi.key}`;\n            const request = async (path) => fetch(`${base}${path}`, {\n                method: 'GET',\n                headers,\n                cache: 'no-cache',\n            });\n            let response = await request('/v1/models');\n            if (!response.ok && (response.status === 404 || response.status === 405)) {\n                response = await request('/models');\n            }\n            if (!response.ok) {\n                throw new Error(` (HTTP ${response.status})`);\n            }\n            const payload = (await response.json());\n            return normalizeModelList(payload.data ?? payload.models ?? payload);\n        }\n        async function getModelListSafe(customApi) {\n            const helperGetModelList = window?.TavernHelper?.getModelList;\n            if (typeof helperGetModelList === 'function') {\n                try {\n                    const models = await helperGetModelList(customApi);\n                    const normalized = normalizeModelList(models);\n                    if (normalized.length > 0)\n                        return normalized;\n                }\n                catch (e) {\n                    console.warn(`[${SCRIPT_NAME}] TavernHelper.getModelList  HTTP `, e);\n                }\n            }\n            if (typeof getModelList === 'function') {\n                try {\n                    const models = await getModelList(customApi);\n                    const normalized = normalizeModelList(models);\n                    if (normalized.length > 0)\n                        return normalized;\n                }\n                catch (e) {\n                    console.warn(`[${SCRIPT_NAME}] getModelList  HTTP `, e);\n                }\n            }\n            return getModelListByHttp(customApi);\n        }\n        async function fetchModels() {\n            const url = settings.value.apiConfig.url;\n            if (!url)\n                return;\n            fetchingModels.value = true;\n            modelFetchError.value = '';\n            modelList.value = [];\n            try {\n                const models = await getModelListSafe({\n                    apiurl: url,\n                    key: settings.value.apiConfig.apiKey || undefined,\n                });\n                modelList.value = models;\n                if (models.length > 0 && !models.includes(settings.value.apiConfig.model)) {\n                    settings.value.apiConfig.model = models[0];\n                }\n            }\n            catch (e) {\n                modelFetchError.value = `: ${e instanceof Error ? e.message : String(e)}`;\n            }\n            finally {\n                fetchingModels.value = false;\n            }\n        }\n        async function testConnection() {\n            const url = settings.value.apiConfig.url;\n            if (!url)\n                return;\n            testingConnection.value = true;\n            connectionStatus.value = 'idle';\n            connectionError.value = '';\n            try {\n                const models = await getModelListSafe({\n                    apiurl: url,\n                    key: settings.value.apiConfig.apiKey || undefined,\n                });\n                if (models && models.length >= 0) {\n                    connectionStatus.value = 'success';\n                }\n                else {\n                    connectionStatus.value = 'fail';\n                    connectionError.value = '';\n                }\n            }\n            catch (e) {\n                connectionStatus.value = 'fail';\n                connectionError.value = e instanceof Error ? e.message : String(e);\n            }\n            finally {\n                testingConnection.value = false;\n            }\n        }\n        function formatFileSize(fileSize) {\n            const bytes = Number(fileSize || 0);\n            if (!Number.isFinite(bytes) || bytes <= 0)\n                return '0 B';\n            if (bytes < 1024)\n                return `${Math.round(bytes)} B`;\n            if (bytes < 1024 * 1024)\n                return `${(bytes / 1024).toFixed(1)} KB`;\n            return `${(bytes / 1024 / 1024).toFixed(2)} MB`;\n        }\n        function formatLocalUploadTime(timestamp) {\n            const value = Number(timestamp || 0);\n            if (!Number.isFinite(value) || value <= 0)\n                return '';\n            try {\n                return new Date(value).toLocaleString();\n            }\n            catch {\n                return '';\n            }\n        }\n        function runtimeLabel(runtimeType) {\n            const runtime = String(runtimeType || '').trim().toLowerCase();\n            if (runtime === 'cubism5')\n                return 'cubism5';\n            return 'legacy';\n        }\n        async function refreshLocalModelInfo() {\n            try {\n                const model = await getLive2DModel(LOCAL_LIVE2D_MODEL_SLOT_ID);\n                localModelInfo.value = model;\n                if (!model && settings.value.modelPath === LOCAL_LIVE2D_MODEL_PATH) {\n                    localModelStatus.value = ' ZIP ';\n                }\n                else if (model) {\n                    localModelStatus.value = `${model.fileName}`;\n                }\n            }\n            catch (e) {\n                localModelInfo.value = null;\n                localModelError.value = `: ${e instanceof Error ? e.message : String(e)}`;\n            }\n        }\n        function triggerLocalModelUpload() {\n            localModelError.value = '';\n            localModelStatus.value = '';\n            const inputEl = localModelFileInput.value;\n            if (!inputEl)\n                return;\n            inputEl.value = '';\n            inputEl.click();\n        }\n        async function onLocalModelFileChange(event) {\n            const inputEl = event.target;\n            const file = inputEl?.files?.[0];\n            if (!file)\n                return;\n            uploadingLocalModel.value = true;\n            localModelError.value = '';\n            localModelStatus.value = ` ${file.name}...`;\n            try {\n                const storedModel = await Live2DUploader.uploadZip(file);\n                localModelStatus.value = `${storedModel.fileName}`;\n                await refreshLocalModelInfo();\n                settings.value.modelPath = LOCAL_LIVE2D_MODEL_PATH;\n                customModelUrl.value = LOCAL_LIVE2D_MODEL_PATH;\n                emit('model-change', LOCAL_LIVE2D_MODEL_PATH);\n                toastr.success('');\n            }\n            catch (e) {\n                const message = e instanceof Error ? e.message : String(e);\n                localModelError.value = `${message}`;\n                localModelStatus.value = '';\n                toastr.error(`${message}`);\n            }\n            finally {\n                uploadingLocalModel.value = false;\n                if (inputEl)\n                    inputEl.value = '';\n            }\n        }\n        async function useUploadedModel() {\n            localModelActionBusy.value = true;\n            localModelError.value = '';\n            try {\n                const exists = await hasLive2DModel(LOCAL_LIVE2D_MODEL_SLOT_ID);\n                if (!exists) {\n                    localModelStatus.value = ' ZIP';\n                    toastr.warning(' ZIP');\n                    return;\n                }\n                await refreshLocalModelInfo();\n                settings.value.modelPath = LOCAL_LIVE2D_MODEL_PATH;\n                customModelUrl.value = LOCAL_LIVE2D_MODEL_PATH;\n                localModelStatus.value = '';\n                emit('model-change', LOCAL_LIVE2D_MODEL_PATH);\n            }\n            catch (e) {\n                localModelError.value = `: ${e instanceof Error ? e.message : String(e)}`;\n            }\n            finally {\n                localModelActionBusy.value = false;\n            }\n        }\n        async function clearUploadedModel() {\n            localModelActionBusy.value = true;\n            localModelError.value = '';\n            try {\n                await deleteLive2DModel(LOCAL_LIVE2D_MODEL_SLOT_ID);\n                localModelInfo.value = null;\n                localModelStatus.value = '';\n                if (settings.value.modelPath === LOCAL_LIVE2D_MODEL_PATH) {\n                    settings.value.modelPath = DEFAULTS.MODEL_PATH;\n                    customModelUrl.value = DEFAULTS.MODEL_PATH;\n                    emit('model-change', DEFAULTS.MODEL_PATH);\n                }\n                toastr.success('');\n            }\n            catch (e) {\n                localModelError.value = `: ${e instanceof Error ? e.message : String(e)}`;\n            }\n            finally {\n                localModelActionBusy.value = false;\n            }\n        }\n        function selectModel(path) {\n            settings.value.modelPath = path;\n            customModelUrl.value = path;\n            emit('model-change', path);\n        }\n        function onBrowserLoad(url) {\n            settings.value.modelPath = url;\n            customModelUrl.value = url;\n            showBrowser.value = false;\n            emit('model-change', url);\n        }\n        function loadCustomUrl() {\n            let url = customModelUrl.value.trim();\n            if (!url)\n                return;\n            const blobMatch = url.match(/^https?:\\/\\/github\\.com\\/([^/]+\\/[^/]+)\\/blob\\/(.+)$/);\n            if (blobMatch) {\n                url = `https://raw.githubusercontent.com/${blobMatch[1]}/${blobMatch[2]}`;\n                customModelUrl.value = url;\n            }\n            settings.value.modelPath = url;\n            emit('model-change', url);\n        }\n        function resetSettings() {\n            store.resetSettings();\n        }\n        function resetEmotionConfigs() {\n            settings.value.emotionConfigs = createDefaultEmotionConfigs();\n            try {\n                toastr.success('');\n            }\n            catch {\n                // ignore\n            }\n        }\n        function onAliasesBlur(cfg, ev) {\n            const input = ev.target;\n            if (!input)\n                return;\n            cfg.aliases = parseAliasesText(input.value);\n        }\n        function refreshLive2DLists() {\n            refreshingLive2dLists.value = true;\n            try {\n                live2dExpressions.value = Live2DManager.getExpressions();\n                live2dMotions.value = Live2DManager.getMotions()\n                    .map(m => ({ name: m.name, group: m.group, index: m.index }))\n                    .sort((a, b) => a.name.localeCompare(b.name));\n                const groups = Live2DManager.getMotionGroups();\n                live2dMotionGroups.value = Object.entries(groups)\n                    .map(([name, count]) => ({ name, count }))\n                    .sort((a, b) => a.name.localeCompare(b.name));\n                try {\n                    toastr.info('/');\n                }\n                catch {\n                    // ignore\n                }\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] /:`, e);\n                live2dExpressions.value = [];\n                live2dMotions.value = [];\n                live2dMotionGroups.value = [];\n                try {\n                    toastr.error('');\n                }\n                catch {\n                    // ignore\n                }\n            }\n            finally {\n                refreshingLive2dLists.value = false;\n            }\n        }\n        function autoMatchLive2DOverrides(overwrite = false) {\n            const model = Live2DManager.model;\n            if (!model) {\n                try {\n                    toastr.warning('');\n                }\n                catch {\n                    // ignore\n                }\n                return;\n            }\n            let filled = 0;\n            for (const cfg of settings.value.emotionConfigs) {\n                const exprOverride = String(cfg.live2dExpression || '').trim();\n                if (overwrite || !exprOverride) {\n                    const resolvedExpr = resolveLive2DExpression(model, cfg.tag);\n                    if (resolvedExpr) {\n                        cfg.live2dExpression =\n                            resolvedExpr.type === 'builtin' ? makeBuiltinExpressionToken(resolvedExpr.key) : resolvedExpr.name;\n                        filled += 1;\n                    }\n                }\n                const motionEnabled = cfg.live2dMotion?.enabled !== false;\n                const motionGroupOverride = String(cfg.live2dMotion?.group || '').trim();\n                if (motionEnabled && (overwrite || !motionGroupOverride)) {\n                    const resolvedMotion = resolveLive2DMotion(model, cfg.tag);\n                    if (resolvedMotion?.type === 'native') {\n                        cfg.live2dMotion.group = resolvedMotion.group;\n                        cfg.live2dMotion.index = resolvedMotion.index;\n                        filled += 1;\n                    }\n                    else if (resolvedMotion?.type === 'builtin') {\n                        cfg.live2dMotion.group = makeBuiltinMotionToken(resolvedMotion.key);\n                        cfg.live2dMotion.index = 0;\n                        filled += 1;\n                    }\n                }\n            }\n            try {\n                if (overwrite) {\n                    toastr.success(filled > 0 ? ` ${filled} ` : '');\n                }\n                else {\n                    toastr.success(filled > 0 ? ` ${filled} ` : '');\n                }\n            }\n            catch {\n                // ignore\n            }\n        }\n        function clearLive2DOverrides() {\n            let cleared = 0;\n            for (const cfg of settings.value.emotionConfigs) {\n                const hadExpr = !!String(cfg.live2dExpression || '').trim();\n                const hadGroup = !!String(cfg.live2dMotion?.group || '').trim();\n                if (hadExpr) {\n                    cfg.live2dExpression = '';\n                    cleared += 1;\n                }\n                if (hadGroup) {\n                    cfg.live2dMotion.group = '';\n                    cfg.live2dMotion.index = 0;\n                    cleared += 1;\n                }\n            }\n            try {\n                toastr.info(cleared > 0 ? ` ${cleared}  Live2D ` : ' Live2D ');\n            }\n            catch {\n                // ignore\n            }\n        }\n        async function previewEmotion(tag) {\n            previewTag.value = tag;\n            const mounted = await ensurePreviewMounted();\n            if (!mounted)\n                return;\n            const model = Live2DManager.model;\n            if (!model) {\n                previewStatus.value = '';\n                return;\n            }\n            applyPreviewViewport();\n            const cfg = settings.value.emotionConfigs.find(c => c.tag === tag);\n            const exprResolved = resolveLive2DExpression(model, tag, cfg?.live2dExpression);\n            let exprText = ': ()';\n            if (exprResolved?.type === 'native') {\n                Live2DManager.playExpression(exprResolved.name);\n                exprText = `: ${exprResolved.name}`;\n            }\n            else if (exprResolved?.type === 'builtin') {\n                Live2DManager.applyBuiltinExpression(exprResolved.key);\n                const builtinDef = getBuiltinExpressionByKey(exprResolved.key);\n                exprText = `: ${builtinDef?.label || exprResolved.key}`;\n            }\n            const motionResolved = resolveLive2DMotion(model, tag, cfg?.live2dMotion);\n            let motionText = ': ()';\n            if (motionResolved?.type === 'native') {\n                Live2DManager.playMotion(motionResolved.group, motionResolved.index);\n                motionText = motionResolved.name\n                    ? `: ${motionResolved.name} (${motionResolved.group || '()'}#${motionResolved.index})`\n                    : `: ${motionResolved.group || '()'}#${motionResolved.index}`;\n            }\n            else if (motionResolved?.type === 'builtin') {\n                Live2DManager.playBuiltinMotion(motionResolved.key);\n                const builtinDef = getBuiltinMotionByKey(motionResolved.key);\n                motionText = `: ${builtinDef?.label || motionResolved.key}`;\n            }\n            else if (motionResolved?.type === 'disabled') {\n                Live2DManager.stopBuiltinMotion();\n                motionText = ': ';\n            }\n            previewStatus.value = `${tag} | ${exprText} | ${motionText}`;\n            if (!exprResolved && !motionResolved) {\n                try {\n                    toastr.info('/');\n                }\n                catch {\n                    // ignore\n                }\n            }\n        }\n        function onToggleTtsEnabled() {\n            setTTSEnabled(ttsEnabled.value);\n            if (!ttsEnabled.value) {\n                try {\n                    TTSManager.stop();\n                }\n                catch {\n                    // ignore\n                }\n            }\n        }\n        async function refreshTtsVoices() {\n            refreshingTtsVoices.value = true;\n            try {\n                ttsVoiceList.value = await getTTSVoiceListAsync();\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}]  TTS :`, e);\n                ttsVoiceList.value = [];\n            }\n            finally {\n                refreshingTtsVoices.value = false;\n            }\n        }\n        function normalizePathSepLocal(input) {\n            return String(input || '').replace(/\\\\/g, '/').trim();\n        }\n        function normalizeImportRootPathLocal(input) {\n            let normalized = normalizePathSepLocal(input).replace(/[\\\\/]+$/g, '');\n            if (/^[a-zA-Z]:$/.test(normalized))\n                normalized = `${normalized}/`;\n            return normalized;\n        }\n        function getRelativeRootNameFromFiles(fileList) {\n            const files = Array.from(fileList || []);\n            for (const file of files) {\n                const rel = String(file?.webkitRelativePath || '').trim().replace(/\\\\/g, '/');\n                const first = String(rel.split('/')[0] || '').trim();\n                if (first)\n                    return first;\n            }\n            return '';\n        }\n        function syncGptImportPrefix(prefixInput) {\n            const normalized = normalizeImportRootPathLocal(prefixInput);\n            settings.value.gptSoVits.rootDir = normalized;\n            settings.value.gptSoVits.importPathPrefix = normalized;\n            return normalized;\n        }\n        function promptGptImportPrefix(defaultPrefix) {\n            const initial = normalizeImportRootPathLocal(defaultPrefix);\n            const result = window.prompt('\\n I:/Downloads/GPT-SoVITS v2 pro plus/MyGO!!!!!/\\n I:/Downloads/GPT-SoVITS v2 pro plus/MyGO!!!!!\\n I:/Downloads/GPT-SoVITS v2 pro plus/MyGO!!!!!/ /  \\\\\\\\ ', initial || '');\n            return normalizeImportRootPathLocal(String(result || '').trim());\n        }\n        function onGptSwitchModeChange() {\n            settings.value.gptSoVits.modelSwitchMode = normalizeGptSoVitsSwitchMode(settings.value.gptSoVits.modelSwitchMode);\n        }\n        function onGptImportPrefixChange() {\n            syncGptImportPrefix(settings.value.gptSoVits.importPathPrefix);\n        }\n        function modelToLegacyVoice(model) {\n            if (!model)\n                return null;\n            const refs = Array.isArray(model.refAudios) ? model.refAudios : [];\n            const defRef = refs.find(item => String(item?.id || '').trim() === String(model.defaultRefId || '').trim()) ||\n                refs.find(item => String(item?.path || '').trim() === String(model?.paths?.defaultRefAudioPath || '').trim()) ||\n                refs[0] ||\n                null;\n            const params = model?.params || {};\n            return {\n                name: String(model.name || '').trim(),\n                desc: String(model.desc || '').trim(),\n                refAudioPath: String(defRef?.path || model?.paths?.defaultRefAudioPath || '').trim(),\n                promptText: String(defRef?.promptText || params.promptText || '').trim(),\n                promptLang: String(defRef?.promptLang || params.promptLang || 'zh').trim() || 'zh',\n                textLang: String(defRef?.textLang || params.textLang || 'auto').trim() || 'auto',\n                gptWeightsPath: String(model?.paths?.gptWeightsPath || '').trim(),\n                sovitsWeightsPath: String(model?.paths?.sovitsWeightsPath || '').trim(),\n                modelSwitchMode: String(params.modelSwitchMode || settings.value.gptSoVits.modelSwitchMode || 'set_weights').trim(),\n                setModelEndpoint: String(params.setModelEndpoint || settings.value.gptSoVits.setModelEndpoint || '/set_model').trim(),\n                strictWeightSwitch: !!(params.strictWeightSwitch ??\n                    settings.value.gptSoVits.strictWeightSwitch),\n            };\n        }\n        function syncLegacyVoicesFromModels(models) {\n            return (Array.isArray(models) ? models : [])\n                .map(modelToLegacyVoice)\n                .filter(Boolean)\n                .filter(voice => String(voice?.name || '').trim());\n        }\n        function setGptSoVitsModelsTextarea(models) {\n            try {\n                gptSoVitsModelsJson.value = JSON.stringify(models || [], null, 2);\n            }\n            catch {\n                gptSoVitsModelsJson.value = '[]';\n            }\n        }\n        function getGptModelsFromTextarea() {\n            const raw = gptSoVitsModelsJson.value || '[]';\n            const parsed = JSON.parse(raw);\n            if (!Array.isArray(parsed)) {\n                throw new Error('models must be array');\n            }\n            return normalizeGptSoVitsModelsForStore(parsed);\n        }\n        function setGptSoVitsVoicesTextarea(voices) {\n            try {\n                gptSoVitsVoicesJson.value = JSON.stringify(voices || [], null, 2);\n            }\n            catch {\n                gptSoVitsVoicesJson.value = '[]';\n            }\n        }\n        function getGptVoicesFromTextarea() {\n            const raw = gptSoVitsVoicesJson.value || '[]';\n            const parsed = JSON.parse(raw);\n            if (!Array.isArray(parsed)) {\n                throw new Error('voices must be array');\n            }\n            return normalizeGptSoVitsVoicesForStore(parsed);\n        }\n        function mergeGptSoVitsVoicesByName(existing, incoming) {\n            const out = Array.isArray(existing) ? existing.slice() : [];\n            const used = new Set(out.map(v => String(v?.name || '').trim()).filter(Boolean));\n            for (const voiceRaw of Array.isArray(incoming) ? incoming : []) {\n                if (!voiceRaw)\n                    continue;\n                const voice = { ...voiceRaw };\n                const base = String(voice.name || '').trim() || '';\n                let name = base;\n                let idx = 2;\n                while (used.has(name)) {\n                    name = `${base}_${idx++}`;\n                }\n                voice.name = name;\n                used.add(name);\n                out.push(voice);\n            }\n            return out;\n        }\n        function normalizeGptModelMatchKey(value) {\n            let text = String(value || '').trim();\n            if (!text)\n                return '';\n            try {\n                text = text.normalize('NFKC');\n            }\n            catch {\n                // ignore\n            }\n            return text.toLowerCase();\n        }\n        function mergeGptSoVitsModelsByName(existing, incoming) {\n            const out = Array.isArray(existing) ? existing.slice() : [];\n            const used = new Set(out\n                .map(v => normalizeGptModelMatchKey(v?.name))\n                .filter(Boolean));\n            for (const modelRaw of Array.isArray(incoming) ? incoming : []) {\n                if (!modelRaw)\n                    continue;\n                const model = { ...modelRaw };\n                const incomingNameKey = normalizeGptModelMatchKey(model?.name);\n                const incomingIdKey = normalizeGptModelMatchKey(model?.id);\n                const hitIndex = out.findIndex(item => {\n                    const itemNameKey = normalizeGptModelMatchKey(item?.name);\n                    const itemIdKey = normalizeGptModelMatchKey(item?.id);\n                    if (incomingNameKey && incomingNameKey === itemNameKey)\n                        return true;\n                    if (incomingIdKey && incomingIdKey === itemIdKey)\n                        return true;\n                    return false;\n                });\n                if (hitIndex >= 0) {\n                    out[hitIndex] = model;\n                    const nextNameKey = normalizeGptModelMatchKey(model?.name);\n                    if (nextNameKey)\n                        used.add(nextNameKey);\n                    continue;\n                }\n                const base = String(model.name || '').trim() || '';\n                let name = base;\n                let idx = 2;\n                while (used.has(normalizeGptModelMatchKey(name))) {\n                    name = `${base}_${idx++}`;\n                }\n                model.name = name;\n                used.add(normalizeGptModelMatchKey(name));\n                out.push(model);\n            }\n            return out;\n        }\n        function deepCloneGptModels(models) {\n            try {\n                return JSON.parse(JSON.stringify(Array.isArray(models) ? models : []));\n            }\n            catch {\n                return Array.isArray(models) ? models.slice() : [];\n            }\n        }\n        function createGptSoVitsModelTemplateConfig() {\n            return {\n                id: `model_${Date.now().toString(36)}`,\n                name: '',\n                enabled: true,\n                desc: '',\n                paths: {\n                    gptWeightsPath: '',\n                    sovitsWeightsPath: '',\n                    defaultRefAudioPath: '',\n                },\n                params: {\n                    promptText: '',\n                    promptLang: 'zh',\n                    textLang: 'zh',\n                    textSplitMethod: 'cut5',\n                    speedFactor: 1,\n                    mediaType: 'wav',\n                    streamingMode: false,\n                    modelSwitchMode: normalizeGptSoVitsSwitchMode(settings.value.gptSoVits.modelSwitchMode || 'set_weights'),\n                    setModelEndpoint: String(settings.value.gptSoVits.setModelEndpoint || '/set_model').trim() || '/set_model',\n                    strictWeightSwitch: !!settings.value.gptSoVits.strictWeightSwitch,\n                },\n                refAudios: [],\n                defaultRefId: '',\n                expressionRefMap: {},\n            };\n        }\n        function syncGptModelManagerFromSettings() {\n            const normalized = normalizeGptSoVitsModelsForStore(settings.value.gptSoVits.models || []);\n            gptModelManagerModels.value = deepCloneGptModels(normalized);\n        }\n        function openGptModelManager() {\n            syncGptModelManagerFromSettings();\n            gptModelManagerSearch.value = '';\n            closeGptModelEditor();\n            showGptModelManager.value = true;\n        }\n        function closeGptModelManager() {\n            showGptModelManager.value = false;\n            closeGptModelEditor();\n        }\n        async function applyGptModelManagerModelsToSettings(showSuccessMessage = '') {\n            const normalized = normalizeGptSoVitsModelsForStore(gptModelManagerModels.value || []);\n            const legacyVoices = syncLegacyVoicesFromModels(normalized);\n            gptModelManagerModels.value = deepCloneGptModels(normalized);\n            settings.value.gptSoVits.models = normalized;\n            settings.value.gptSoVits.voices = legacyVoices;\n            setGptSoVitsModelsTextarea(normalized);\n            setGptSoVitsVoicesTextarea(legacyVoices);\n            const firstUsable = pickFirstUsableGptSoVitsVoice(getGptSoVitsVoiceList());\n            if (!settings.value.ttsDefaultSpeaker && firstUsable?.name) {\n                settings.value.ttsDefaultSpeaker = firstUsable.name;\n            }\n            await refreshTtsVoices();\n            if (showSuccessMessage) {\n                toastr.success(showSuccessMessage);\n            }\n        }\n        async function saveGptModelManager() {\n            await applyGptModelManagerModelsToSettings(`GPT-SoVITS ${gptModelManagerModels.value.length} `);\n        }\n        async function saveGptModelManagerAndClose() {\n            await applyGptModelManagerModelsToSettings(`GPT-SoVITS ${gptModelManagerModels.value.length} `);\n            closeGptModelManager();\n        }\n        function addGptModelManagerModel() {\n            const merged = mergeGptSoVitsModelsByName(gptModelManagerModels.value, [createGptSoVitsModelTemplateConfig()]);\n            gptModelManagerModels.value = deepCloneGptModels(normalizeGptSoVitsModelsForStore(merged));\n            toastr.success('');\n        }\n        function getGptModelManagerIndexById(modelId) {\n            const targetId = String(modelId || '').trim();\n            if (!targetId)\n                return -1;\n            return gptModelManagerModels.value.findIndex(item => String(item?.id || '').trim() === targetId);\n        }\n        function removeGptModelManagerModel(modelId) {\n            const index = getGptModelManagerIndexById(modelId);\n            if (index < 0)\n                return;\n            gptModelManagerModels.value.splice(index, 1);\n            if (gptModelEditorModelId.value === modelId) {\n                closeGptModelEditor();\n            }\n        }\n        function duplicateGptModelManagerModel(modelId) {\n            const index = getGptModelManagerIndexById(modelId);\n            if (index < 0)\n                return;\n            const source = gptModelManagerModels.value[index];\n            const cloned = deepCloneGptModels([source])[0] || createGptSoVitsModelTemplateConfig();\n            cloned.id = `${String(source?.id || 'model').trim() || 'model'}_${Date.now().toString(36)}`;\n            const merged = mergeGptSoVitsModelsByName(gptModelManagerModels.value, [cloned]);\n            gptModelManagerModels.value = deepCloneGptModels(normalizeGptSoVitsModelsForStore(merged));\n            toastr.success('');\n        }\n        function setGptModelManagerDefaultSpeaker(model) {\n            const name = String(model?.name || '').trim();\n            if (!name) {\n                toastr.error('');\n                return;\n            }\n            settings.value.ttsDefaultSpeaker = name;\n            toastr.success(`${name}`);\n        }\n        async function testGptModelManagerModel(modelId) {\n            const index = getGptModelManagerIndexById(modelId);\n            if (index < 0)\n                return;\n            const model = gptModelManagerModels.value[index];\n            const name = String(model?.name || '').trim();\n            if (!name) {\n                toastr.error('');\n                return;\n            }\n            settings.value.ttsDefaultSpeaker = name;\n            await applyGptModelManagerModelsToSettings('');\n            await testTts();\n        }\n        function openGptModelManagerImportJson() {\n            gptModelManagerImportJsonInputRef.value?.click();\n        }\n        function openGptModelManagerImportFolder() {\n            gptModelManagerImportFolderInputRef.value?.click();\n        }\n        async function onGptModelManagerImportJsonChange(event) {\n            const input = event.target;\n            const file = input?.files?.[0];\n            if (!file)\n                return;\n            try {\n                const text = await file.text();\n                const parsed = JSON.parse(String(text || '[]'));\n                if (!Array.isArray(parsed)) {\n                    toastr.error('JSON ');\n                    return;\n                }\n                const normalizedIncoming = normalizeGptSoVitsModelsForStore(parsed);\n                const merged = mergeGptSoVitsModelsByName(gptModelManagerModels.value, normalizedIncoming);\n                gptModelManagerModels.value = deepCloneGptModels(normalizeGptSoVitsModelsForStore(merged));\n                toastr.success(`${normalizedIncoming.length} `);\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS  JSON :`, e);\n                toastr.error('JSON ');\n            }\n            finally {\n                if (input)\n                    input.value = '';\n            }\n        }\n        async function onGptModelManagerImportFolderChange(event) {\n            const input = event.target;\n            const fileList = input?.files;\n            if (!fileList || fileList.length === 0)\n                return;\n            try {\n                const previousPrefix = normalizeImportRootPathLocal(settings.value.gptSoVits.importPathPrefix || settings.value.gptSoVits.rootDir || '');\n                const prefix = promptGptImportPrefix(previousPrefix);\n                if (!prefix) {\n                    toastr.info('');\n                    return;\n                }\n                syncGptImportPrefix(prefix);\n                const rootName = getRelativeRootNameFromFiles(Array.from(fileList));\n                const inferred = inferGptSoVitsModelsFromFolderFiles(fileList, prefix, { relativeRootName: rootName });\n                if (!inferred || inferred.length === 0) {\n                    toastr.warning('');\n                    return;\n                }\n                const merged = mergeGptSoVitsModelsByName(gptModelManagerModels.value, inferred);\n                gptModelManagerModels.value = deepCloneGptModels(normalizeGptSoVitsModelsForStore(merged));\n                const hasRelativePath = inferred.some(model => {\n                    const p = String(model?.paths?.defaultRefAudioPath || '').trim();\n                    return p && !isAbsoluteFileSystemPath(p);\n                });\n                let msg = `${inferred.length} `;\n                if (hasRelativePath) {\n                    msg += '';\n                }\n                toastr.success(msg);\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS :`, e);\n                toastr.error('');\n            }\n            finally {\n                if (input)\n                    input.value = '';\n            }\n        }\n        function exportGptModelManagerModels() {\n            try {\n                const normalized = normalizeGptSoVitsModelsForStore(gptModelManagerModels.value || []);\n                const blob = new Blob([JSON.stringify(normalized, null, 2)], { type: 'application/json' });\n                const url = URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = 'gpt_sovits_models.json';\n                a.click();\n                setTimeout(() => URL.revokeObjectURL(url), 1000);\n                toastr.success(' gpt_sovits_models.json');\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS :`, e);\n                toastr.error('');\n            }\n        }\n        function normalizeGptModelEditorRefAudio(raw, index) {\n            const id = String(raw?.id || `ref_${index + 1}`).trim() || `ref_${index + 1}`;\n            return {\n                id,\n                name: String(raw?.name || id).trim() || id,\n                path: normalizePathSepLocal(raw?.path || ''),\n                promptText: String(raw?.promptText || '').trim(),\n                promptLang: String(raw?.promptLang || 'zh').trim() || 'zh',\n                textLang: String(raw?.textLang || 'auto').trim() || 'auto',\n            };\n        }\n        function ensureGptModelEditorStructure() {\n            const model = gptModelEditor.value;\n            if (!model)\n                return;\n            model.paths = {\n                gptWeightsPath: normalizePathSepLocal(model?.paths?.gptWeightsPath || ''),\n                sovitsWeightsPath: normalizePathSepLocal(model?.paths?.sovitsWeightsPath || ''),\n                defaultRefAudioPath: normalizePathSepLocal(model?.paths?.defaultRefAudioPath || ''),\n            };\n            model.params = {\n                promptText: String(model?.params?.promptText || '').trim(),\n                promptLang: String(model?.params?.promptLang || 'zh').trim() || 'zh',\n                textLang: String(model?.params?.textLang || 'auto').trim() || 'auto',\n                textSplitMethod: String(model?.params?.textSplitMethod || 'cut5').trim() || 'cut5',\n                speedFactor: Number.isFinite(Number(model?.params?.speedFactor)) ? Number(model?.params?.speedFactor) : 1,\n                mediaType: String(model?.params?.mediaType || 'wav').trim() || 'wav',\n                streamingMode: !!model?.params?.streamingMode,\n                modelSwitchMode: normalizeGptSoVitsSwitchMode(model?.params?.modelSwitchMode || 'set_weights'),\n                setModelEndpoint: String(model?.params?.setModelEndpoint || '/set_model').trim() || '/set_model',\n                strictWeightSwitch: !!model?.params?.strictWeightSwitch,\n            };\n            model.refAudios = (Array.isArray(model.refAudios) ? model.refAudios : []).map((item, index) => normalizeGptModelEditorRefAudio(item, index));\n            if (!model.defaultRefId && model.refAudios.length > 0) {\n                model.defaultRefId = model.refAudios[0].id;\n            }\n            if (model.defaultRefId && !model.refAudios.some(item => item.id === model.defaultRefId)) {\n                model.defaultRefId = model.refAudios[0]?.id || '';\n            }\n            model.expressionRefMap = model.expressionRefMap && typeof model.expressionRefMap === 'object'\n                ? model.expressionRefMap\n                : {};\n        }\n        function syncGptModelEditorExpressionRowsFromModel() {\n            const model = gptModelEditor.value;\n            if (!model) {\n                gptModelEditorExpressionRows.value = [];\n                return;\n            }\n            const rows = [];\n            const map = model.expressionRefMap && typeof model.expressionRefMap === 'object' ? model.expressionRefMap : {};\n            Object.entries(map).forEach(([expression, refId]) => {\n                const exprText = String(expression || '').trim();\n                const targetRefId = String(refId || '').trim();\n                if (!exprText || !targetRefId)\n                    return;\n                rows.push({ expression: exprText, refId: targetRefId });\n            });\n            gptModelEditorExpressionRows.value = rows;\n        }\n        function applyGptModelEditorExpressionRowsToModel() {\n            const model = gptModelEditor.value;\n            if (!model)\n                return;\n            const validRefIds = new Set(model.refAudios.map(item => String(item?.id || '').trim()).filter(Boolean));\n            const nextMap = {};\n            for (const row of gptModelEditorExpressionRows.value) {\n                const expression = String(row?.expression || '').trim();\n                const refId = String(row?.refId || '').trim();\n                if (!expression || !refId)\n                    continue;\n                if (!validRefIds.has(refId))\n                    continue;\n                nextMap[expression] = refId;\n            }\n            model.expressionRefMap = nextMap;\n        }\n        function openGptModelEditor(modelId) {\n            const index = getGptModelManagerIndexById(modelId);\n            if (index < 0)\n                return;\n            const source = gptModelManagerModels.value[index];\n            gptModelEditor.value = deepCloneGptModels([source])[0] || null;\n            gptModelEditorModelId.value = String(source?.id || '').trim();\n            ensureGptModelEditorStructure();\n            syncGptModelEditorExpressionRowsFromModel();\n            showGptModelEditor.value = true;\n        }\n        function closeGptModelEditor() {\n            showGptModelEditor.value = false;\n            gptModelEditor.value = null;\n            gptModelEditorModelId.value = '';\n            gptModelEditorExpressionRows.value = [];\n        }\n        function addGptModelEditorRefAudio() {\n            const model = gptModelEditor.value;\n            if (!model)\n                return;\n            ensureGptModelEditorStructure();\n            const used = new Set(model.refAudios.map(item => String(item.id || '').trim()).filter(Boolean));\n            const base = `ref_${model.refAudios.length + 1}`;\n            let nextId = base;\n            let index = 2;\n            while (used.has(nextId)) {\n                nextId = `${base}_${index++}`;\n            }\n            model.refAudios.push({\n                id: nextId,\n                name: `${model.refAudios.length + 1}`,\n                path: '',\n                promptText: String(model.params.promptText || '').trim(),\n                promptLang: String(model.params.promptLang || 'zh').trim() || 'zh',\n                textLang: String(model.params.textLang || 'auto').trim() || 'auto',\n            });\n            if (!model.defaultRefId) {\n                model.defaultRefId = nextId;\n            }\n        }\n        function removeGptModelEditorRefAudio(refIndex) {\n            const model = gptModelEditor.value;\n            if (!model)\n                return;\n            if (refIndex < 0 || refIndex >= model.refAudios.length)\n                return;\n            const removedId = String(model.refAudios[refIndex]?.id || '').trim();\n            model.refAudios.splice(refIndex, 1);\n            if (removedId && model.defaultRefId === removedId) {\n                model.defaultRefId = model.refAudios[0]?.id || '';\n            }\n            if (removedId) {\n                gptModelEditorExpressionRows.value = gptModelEditorExpressionRows.value.filter(row => row.refId !== removedId);\n            }\n        }\n        function setGptModelEditorDefaultRef(refId) {\n            const model = gptModelEditor.value;\n            if (!model)\n                return;\n            const id = String(refId || '').trim();\n            if (!id)\n                return;\n            model.defaultRefId = id;\n        }\n        function addGptModelEditorExpressionRow() {\n            const model = gptModelEditor.value;\n            if (!model)\n                return;\n            const fallbackRefId = String(model.defaultRefId || model.refAudios[0]?.id || '').trim();\n            gptModelEditorExpressionRows.value.push({\n                expression: '',\n                refId: fallbackRefId,\n            });\n        }\n        function removeGptModelEditorExpressionRow(index) {\n            if (index < 0 || index >= gptModelEditorExpressionRows.value.length)\n                return;\n            gptModelEditorExpressionRows.value.splice(index, 1);\n        }\n        function saveGptModelEditor() {\n            const model = gptModelEditor.value;\n            if (!model)\n                return;\n            if (!String(model.name || '').trim()) {\n                toastr.error('');\n                return;\n            }\n            ensureGptModelEditorStructure();\n            applyGptModelEditorExpressionRowsToModel();\n            const targetIndex = getGptModelManagerIndexById(gptModelEditorModelId.value);\n            if (targetIndex < 0) {\n                toastr.error('');\n                return;\n            }\n            const list = gptModelManagerModels.value.slice();\n            list[targetIndex] = deepCloneGptModels([model])[0] || model;\n            gptModelManagerModels.value = deepCloneGptModels(normalizeGptSoVitsModelsForStore(list));\n            toastr.success('');\n            closeGptModelEditor();\n        }\n        function openGptModelImportJson() {\n            gptModelImportJsonInputRef.value?.click();\n        }\n        function openGptModelImportFolder() {\n            gptModelImportFolderInputRef.value?.click();\n        }\n        function openGptImportJson() {\n            gptImportJsonInputRef.value?.click();\n        }\n        function openGptImportFolder() {\n            gptImportFolderInputRef.value?.click();\n        }\n        async function onGptModelImportJsonChange(event) {\n            const input = event.target;\n            const file = input?.files?.[0];\n            if (!file)\n                return;\n            try {\n                const text = await file.text();\n                const parsed = JSON.parse(String(text || '[]'));\n                if (!Array.isArray(parsed)) {\n                    toastr.error('JSON ');\n                    return;\n                }\n                const normalizedIncoming = normalizeGptSoVitsModelsForStore(parsed);\n                const existingNormalized = normalizeGptSoVitsModelsForStore(settings.value.gptSoVits.models || []);\n                const merged = mergeGptSoVitsModelsByName(existingNormalized, normalizedIncoming);\n                const legacyVoices = syncLegacyVoicesFromModels(merged);\n                settings.value.gptSoVits.models = merged;\n                settings.value.gptSoVits.voices = legacyVoices;\n                setGptSoVitsModelsTextarea(merged);\n                setGptSoVitsVoicesTextarea(legacyVoices);\n                syncGptModelManagerFromSettings();\n                await refreshTtsVoices();\n                toastr.success(`${normalizedIncoming.length} `);\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS  JSON :`, e);\n                toastr.error('JSON ');\n            }\n            finally {\n                if (input)\n                    input.value = '';\n            }\n        }\n        async function onGptModelImportFolderChange(event) {\n            const input = event.target;\n            const fileList = input?.files;\n            if (!fileList || fileList.length === 0)\n                return;\n            try {\n                const previousPrefix = normalizeImportRootPathLocal(settings.value.gptSoVits.importPathPrefix || settings.value.gptSoVits.rootDir || '');\n                const prefix = promptGptImportPrefix(previousPrefix);\n                if (!prefix) {\n                    toastr.info('');\n                    return;\n                }\n                syncGptImportPrefix(prefix);\n                const rootName = getRelativeRootNameFromFiles(Array.from(fileList));\n                const inferred = inferGptSoVitsModelsFromFolderFiles(fileList, prefix, { relativeRootName: rootName });\n                if (!inferred || inferred.length === 0) {\n                    toastr.warning('');\n                    return;\n                }\n                const existingNormalized = normalizeGptSoVitsModelsForStore(settings.value.gptSoVits.models || []);\n                const merged = mergeGptSoVitsModelsByName(existingNormalized, inferred);\n                const legacyVoices = syncLegacyVoicesFromModels(merged);\n                settings.value.gptSoVits.models = merged;\n                settings.value.gptSoVits.voices = legacyVoices;\n                setGptSoVitsModelsTextarea(merged);\n                setGptSoVitsVoicesTextarea(legacyVoices);\n                syncGptModelManagerFromSettings();\n                await refreshTtsVoices();\n                const hasRelativePath = inferred.some(model => {\n                    const p = String(model?.paths?.defaultRefAudioPath || '').trim();\n                    return p && !isAbsoluteFileSystemPath(p);\n                });\n                let msg = `${inferred.length} `;\n                if (hasRelativePath) {\n                    msg += '';\n                }\n                toastr.success(msg);\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS :`, e);\n                toastr.error('');\n            }\n            finally {\n                if (input)\n                    input.value = '';\n            }\n        }\n        async function onGptImportJsonChange(event) {\n            const input = event.target;\n            const file = input?.files?.[0];\n            if (!file)\n                return;\n            try {\n                const text = await file.text();\n                const parsed = JSON.parse(String(text || '[]'));\n                if (!Array.isArray(parsed)) {\n                    toastr.error('JSON ');\n                    return;\n                }\n                const normalizedIncoming = normalizeGptSoVitsVoicesForStore(parsed);\n                const existingNormalized = normalizeGptSoVitsVoicesForStore(settings.value.gptSoVits.voices || []).voices;\n                const merged = mergeGptSoVitsVoicesByName(existingNormalized, normalizedIncoming.voices);\n                settings.value.gptSoVits.voices = merged;\n                settings.value.gptSoVits.models = [];\n                setGptSoVitsModelsTextarea([]);\n                setGptSoVitsVoicesTextarea(merged);\n                syncGptModelManagerFromSettings();\n                await refreshTtsVoices();\n                let msg = `${normalizedIncoming.voices.length} `;\n                if (normalizedIncoming.ignoredCount > 0)\n                    msg += ` ${normalizedIncoming.ignoredCount} `;\n                if (normalizedIncoming.missingRefCount > 0)\n                    msg += ` ${normalizedIncoming.missingRefCount}  refAudioPath`;\n                toastr.success(msg);\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS  JSON :`, e);\n                toastr.error('JSON ');\n            }\n            finally {\n                if (input)\n                    input.value = '';\n            }\n        }\n        async function onGptImportFolderChange(event) {\n            const input = event.target;\n            const fileList = input?.files;\n            if (!fileList || fileList.length === 0)\n                return;\n            try {\n                const previousPrefix = normalizeImportRootPathLocal(settings.value.gptSoVits.importPathPrefix || settings.value.gptSoVits.rootDir || '');\n                const prefix = promptGptImportPrefix(previousPrefix);\n                if (!prefix) {\n                    toastr.info('');\n                    return;\n                }\n                syncGptImportPrefix(prefix);\n                const inferred = inferGptSoVitsVoicesFromFolderFiles(fileList, prefix);\n                if (!inferred || inferred.length === 0) {\n                    toastr.warning('');\n                    return;\n                }\n                const normalizedIncoming = normalizeGptSoVitsVoicesForStore(inferred);\n                const existingNormalized = normalizeGptSoVitsVoicesForStore(settings.value.gptSoVits.voices || []).voices;\n                const merged = mergeGptSoVitsVoicesByName(existingNormalized, normalizedIncoming.voices);\n                settings.value.gptSoVits.voices = merged;\n                settings.value.gptSoVits.models = [];\n                setGptSoVitsModelsTextarea([]);\n                setGptSoVitsVoicesTextarea(merged);\n                syncGptModelManagerFromSettings();\n                await refreshTtsVoices();\n                const hasRelativePath = normalizedIncoming.voices.some(v => !isAbsoluteFileSystemPath(v.refAudioPath || ''));\n                let msg = `${normalizedIncoming.voices.length} `;\n                if (hasRelativePath) {\n                    msg += '';\n                }\n                toastr.success(msg);\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS :`, e);\n                toastr.error('');\n            }\n            finally {\n                if (input)\n                    input.value = '';\n            }\n        }\n        function exportGptSoVitsVoices() {\n            try {\n                const voices = settings.value.gptSoVits?.voices || [];\n                const blob = new Blob([JSON.stringify(voices, null, 2)], { type: 'application/json' });\n                const url = URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = 'gpt_sovits_voices.json';\n                a.click();\n                setTimeout(() => URL.revokeObjectURL(url), 1000);\n                toastr.success(' gpt_sovits_voices.json');\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS :`, e);\n                toastr.error('');\n            }\n        }\n        function exportGptSoVitsModels() {\n            try {\n                const models = settings.value.gptSoVits?.models || [];\n                const blob = new Blob([JSON.stringify(models, null, 2)], { type: 'application/json' });\n                const url = URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = 'gpt_sovits_models.json';\n                a.click();\n                setTimeout(() => URL.revokeObjectURL(url), 1000);\n                toastr.success(' gpt_sovits_models.json');\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS :`, e);\n                toastr.error('');\n            }\n        }\n        async function addGptSoVitsModelTemplate() {\n            try {\n                const current = getGptModelsFromTextarea();\n                const template = createGptSoVitsModelTemplateConfig();\n                const merged = mergeGptSoVitsModelsByName(current, [template]);\n                const legacyVoices = syncLegacyVoicesFromModels(merged);\n                settings.value.gptSoVits.models = merged;\n                settings.value.gptSoVits.voices = legacyVoices;\n                setGptSoVitsModelsTextarea(merged);\n                setGptSoVitsVoicesTextarea(legacyVoices);\n                syncGptModelManagerFromSettings();\n                await refreshTtsVoices();\n                toastr.success('');\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS :`, e);\n                toastr.error(' JSON');\n            }\n        }\n        function saveGptSoVitsModels() {\n            let parsed = null;\n            try {\n                parsed = JSON.parse(gptSoVitsModelsJson.value || '[]');\n            }\n            catch {\n                toastr.error(' JSON ');\n                return;\n            }\n            if (!Array.isArray(parsed)) {\n                toastr.error('');\n                return;\n            }\n            const normalized = normalizeGptSoVitsModelsForStore(parsed);\n            const legacyVoices = syncLegacyVoicesFromModels(normalized);\n            settings.value.gptSoVits.models = normalized;\n            settings.value.gptSoVits.voices = legacyVoices;\n            setGptSoVitsModelsTextarea(normalized);\n            setGptSoVitsVoicesTextarea(legacyVoices);\n            syncGptModelManagerFromSettings();\n            const firstUsable = pickFirstUsableGptSoVitsVoice(getGptSoVitsVoiceList());\n            if (!settings.value.ttsDefaultSpeaker && firstUsable?.name) {\n                settings.value.ttsDefaultSpeaker = firstUsable.name;\n            }\n            void refreshTtsVoices();\n            toastr.success(`GPT-SoVITS ${normalized.length} `);\n        }\n        async function addGptSoVitsVoiceTemplate() {\n            try {\n                const current = getGptVoicesFromTextarea().voices;\n                const template = {\n                    name: '',\n                    desc: '',\n                    refAudioPath: '',\n                    promptText: '',\n                    promptLang: 'zh',\n                    textLang: 'zh',\n                    gptWeightsPath: '',\n                    sovitsWeightsPath: '',\n                    modelSwitchMode: 'set_weights',\n                    setModelEndpoint: '/set_model',\n                    strictWeightSwitch: false,\n                };\n                const merged = mergeGptSoVitsVoicesByName(current, [template]);\n                settings.value.gptSoVits.voices = merged;\n                settings.value.gptSoVits.models = [];\n                setGptSoVitsModelsTextarea([]);\n                setGptSoVitsVoicesTextarea(merged);\n                syncGptModelManagerFromSettings();\n                await refreshTtsVoices();\n                toastr.success('');\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS :`, e);\n                toastr.error(' JSON');\n            }\n        }\n        function saveGptSoVitsVoices() {\n            let parsed = null;\n            try {\n                parsed = JSON.parse(gptSoVitsVoicesJson.value || '[]');\n            }\n            catch {\n                toastr.error(' JSON ');\n                return;\n            }\n            if (!Array.isArray(parsed)) {\n                toastr.error('');\n                return;\n            }\n            const normalized = normalizeGptSoVitsVoicesForStore(parsed);\n            settings.value.gptSoVits.voices = normalized.voices;\n            settings.value.gptSoVits.models = [];\n            setGptSoVitsModelsTextarea([]);\n            setGptSoVitsVoicesTextarea(normalized.voices);\n            syncGptModelManagerFromSettings();\n            const firstUsable = pickFirstUsableGptSoVitsVoice(getGptSoVitsVoiceList());\n            if (!settings.value.ttsDefaultSpeaker && firstUsable?.name) {\n                settings.value.ttsDefaultSpeaker = firstUsable.name;\n            }\n            void refreshTtsVoices();\n            let msg = `GPT-SoVITS ${normalized.voices.length} `;\n            if (normalized.ignoredCount > 0)\n                msg += ` ${normalized.ignoredCount} `;\n            if (normalized.missingRefCount > 0)\n                msg += `${normalized.missingRefCount}  refAudioPath`;\n            toastr.success(msg);\n        }\n        function getCurrentCharacterId() {\n            try {\n                const ctx = SillyTavern?.getContext?.();\n                if (ctx?.characterId !== undefined && ctx?.characterId !== null) {\n                    return String(ctx.characterId);\n                }\n            }\n            catch {\n                // ignore\n            }\n            return 'default';\n        }\n        async function testTts() {\n            if (!ttsEnabled.value)\n                return;\n            const text = String(ttsTestText.value || '').trim() || ' TTS ';\n            const speaker = getCurrentCharacterId();\n            let voiceName = String(settings.value.ttsDefaultSpeaker || '').trim();\n            if (settings.value.ttsProvider === TTS_PROVIDER.GPT_SOVITS_V2) {\n                const voices = getGptSoVitsVoiceList();\n                const selected = voices.find(v => v.name === voiceName) || null;\n                const selectedUsable = !!String(selected?.gptSoVits?.refAudioPath || '').trim();\n                const fallback = pickFirstUsableGptSoVitsVoice(voices);\n                const target = selectedUsable ? selected : fallback;\n                const targetName = String(target?.name || '').trim();\n                if (!targetName) {\n                    toastr.error('refAudioPath ');\n                    return;\n                }\n                if (voiceName !== targetName) {\n                    settings.value.ttsDefaultSpeaker = targetName;\n                    voiceName = targetName;\n                    toastr.info(`${targetName}`);\n                }\n            }\n            else if (settings.value.ttsProvider === TTS_PROVIDER.EDGE_TTS_DIRECT && !voiceName) {\n                const voices = ttsVoiceList.value.length > 0 ? ttsVoiceList.value : await getTTSVoiceListAsync();\n                const fallbackName = String(voices[0]?.name || voices[0]?.value || '').trim();\n                if (!fallbackName) {\n                    toastr.error(' EdgeTTS ');\n                    return;\n                }\n                settings.value.ttsDefaultSpeaker = fallbackName;\n                voiceName = fallbackName;\n            }\n            try {\n                TTSManager.stop();\n                await TTSManager.speak({ type: 'dialogue', speaker, text, tts: voiceName ? { speaker: voiceName } : undefined }, `desktop_pet_tts_test_${Date.now()}`);\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] TTS :`, e);\n            }\n        }\n        function stopTts() {\n            try {\n                TTSManager.stop();\n            }\n            catch {\n                // ignore\n            }\n        }\n        function applyLipSyncManualParams() {\n            const raw = String(lipSyncManualParamsText.value || '');\n            const parts = raw\n                .split(/[\\n,]/)\n                .map(item => String(item || '').trim())\n                .filter(Boolean);\n            const dedup = Array.from(new Set(parts));\n            settings.value.lipSyncManualParamIds = dedup;\n            lipSyncManualParamsText.value = dedup.join('\\n');\n        }\n        function close() {\n            applyLipSyncManualParams();\n            closeGptModelManager();\n            emit('close');\n        }\n        watch(() => props.visible, visible => {\n            if (!visible) {\n                closeGptModelManager();\n                return;\n            }\n            ensureNumericSettingsIntegrity();\n            activeSection.value = 'api';\n            customModelUrl.value = settings.value.modelPath || '';\n            showEmotionAdvanced.value = false;\n            ttsEnabled.value = getTTSEnabled();\n            localModelStatus.value = '';\n            localModelError.value = '';\n            lipSyncManualParamsText.value = Array.isArray(settings.value.lipSyncManualParamIds)\n                ? settings.value.lipSyncManualParamIds.join('\\n')\n                : '';\n            settings.value.gptSoVits.modelSwitchMode = normalizeGptSoVitsSwitchMode(settings.value.gptSoVits.modelSwitchMode);\n            const syncedPrefix = normalizeImportRootPathLocal(settings.value.gptSoVits.importPathPrefix || settings.value.gptSoVits.rootDir || '');\n            settings.value.gptSoVits.rootDir = syncedPrefix;\n            settings.value.gptSoVits.importPathPrefix = syncedPrefix;\n            settings.value.gptSoVits.setModelEndpoint = String(settings.value.gptSoVits.setModelEndpoint || '/set_model').trim()\n                || '/set_model';\n            if (!Array.isArray(settings.value.gptSoVits.models)) {\n                settings.value.gptSoVits.models = [];\n            }\n            if (!Array.isArray(settings.value.gptSoVits.voices)) {\n                settings.value.gptSoVits.voices = [];\n            }\n            try {\n                gptSoVitsModelsJson.value = JSON.stringify(settings.value.gptSoVits?.models || [], null, 2);\n            }\n            catch {\n                gptSoVitsModelsJson.value = '[]';\n            }\n            try {\n                gptSoVitsVoicesJson.value = JSON.stringify(settings.value.gptSoVits?.voices || [], null, 2);\n            }\n            catch {\n                gptSoVitsVoicesJson.value = '[]';\n            }\n            syncGptModelManagerFromSettings();\n            void refreshTtsVoices();\n            refreshDiceReferenceSheetOptions();\n            void refreshLocalModelInfo();\n        }, { immediate: true });\n        watch(() => settings.value.ttsProvider, () => {\n            try {\n                TTSManager._refreshProviderState();\n            }\n            catch {\n                // ignore\n            }\n            void refreshTtsVoices();\n        });\n        watch(() => settings.value.useDiceDatabaseReference, enabled => {\n            if (!enabled)\n                return;\n            refreshDiceReferenceSheetOptions();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", null, [\n                (__props.visible)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"settings-overlay dp-settings-overlay\",\n                        style: overlayFallbackStyle,\n                        onClick: _withModifiers(close, [\"self\"])\n                    }, [\n                        _createElementVNode(\"div\", {\n                            class: \"settings-panel dp-settings-panel\",\n                            style: panelFallbackStyle\n                        }, [\n                            _createElementVNode(\"div\", { class: \"panel-header\" }, [\n                                _cache[80] || (_cache[80] = _createElementVNode(\"div\", { class: \"header-title\" }, [\n                                    _createElementVNode(\"h3\", null, \"\"),\n                                    _createElementVNode(\"p\", null, \"SYSTEM // SETTINGS\")\n                                ], -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-btn\",\n                                    type: \"button\",\n                                    onClick: close\n                                }, \"CLOSE\")\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_1, [\n                                _createElementVNode(\"aside\", _hoisted_2, [\n                                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(sectionTabs, (item) => {\n                                        return _createElementVNode(\"button\", {\n                                            key: item.key,\n                                            class: _normalizeClass([\"nav-btn\", { active: activeSection.value === item.key }]),\n                                            type: \"button\",\n                                            onClick: ($event) => (activeSection.value = item.key)\n                                        }, [\n                                            _createElementVNode(\"span\", _hoisted_4, _toDisplayString(item.index), 1 /* TEXT */),\n                                            _createElementVNode(\"span\", _hoisted_5, _toDisplayString(item.label), 1 /* TEXT */),\n                                            _createElementVNode(\"span\", _hoisted_6, _toDisplayString(item.en), 1 /* TEXT */)\n                                        ], 10 /* CLASS, PROPS */, _hoisted_3);\n                                    }), 64 /* STABLE_FRAGMENT */))\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_7, [\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_8, [\n                                        _cache[94] || (_cache[94] = _createElementVNode(\"h4\", null, [\n                                            _createElementVNode(\"span\", { class: \"section-index\" }, \"01\"),\n                                            _createElementVNode(\"span\", { class: \"section-label\" }, \"API \"),\n                                            _createElementVNode(\"span\", { class: \"section-sub\" }, \"API CONTROL\")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_9, [\n                                            _cache[82] || (_cache[82] = _createElementVNode(\"label\", null, \"API \", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"select\", {\n                                                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((_unref(settings).apiMode) = $event))\n                                            }, [...(_cache[81] || (_cache[81] = [\n                                                    _createElementVNode(\"option\", { value: \"tavern\" }, \" API\", -1 /* CACHED */),\n                                                    _createElementVNode(\"option\", { value: \"custom\" }, \" API\", -1 /* CACHED */)\n                                                ]))], 512 /* NEED_PATCH */), [\n                                                [_vModelSelect, _unref(settings).apiMode]\n                                            ])\n                                        ]),\n                                        (_unref(settings).apiMode === 'custom')\n                                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                                                _createElementVNode(\"div\", _hoisted_10, [\n                                                    _cache[83] || (_cache[83] = _createElementVNode(\"label\", null, \"API Source\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"select\", {\n                                                        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((_unref(settings).apiConfig.source) = $event))\n                                                    }, [\n                                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(apiSources), (src) => {\n                                                            return (_openBlock(), _createElementBlock(\"option\", {\n                                                                key: src.value,\n                                                                value: src.value\n                                                            }, _toDisplayString(src.label), 9 /* TEXT, PROPS */, _hoisted_11));\n                                                        }), 128 /* KEYED_FRAGMENT */))\n                                                    ], 512 /* NEED_PATCH */), [\n                                                        [_vModelSelect, _unref(settings).apiConfig.source]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_12, [\n                                                    _cache[84] || (_cache[84] = _createElementVNode(\"label\", null, \"API URL\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"input\", {\n                                                        type: \"text\",\n                                                        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event) => ((_unref(settings).apiConfig.url) = $event)),\n                                                        placeholder: \"https://api.openai.com/v1\"\n                                                    }, null, 512 /* NEED_PATCH */), [\n                                                        [_vModelText, _unref(settings).apiConfig.url]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_13, [\n                                                    _cache[85] || (_cache[85] = _createElementVNode(\"label\", null, \"API Key\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"input\", {\n                                                        type: \"password\",\n                                                        \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event) => ((_unref(settings).apiConfig.apiKey) = $event)),\n                                                        placeholder: \"sk-...\"\n                                                    }, null, 512 /* NEED_PATCH */), [\n                                                        [_vModelText, _unref(settings).apiConfig.apiKey]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_14, [\n                                                    _cache[86] || (_cache[86] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"div\", _hoisted_15, [\n                                                        (modelList.value.length === 0)\n                                                            ? _withDirectives((_openBlock(), _createElementBlock(\"input\", {\n                                                                key: 0,\n                                                                type: \"text\",\n                                                                \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event) => ((_unref(settings).apiConfig.model) = $event)),\n                                                                placeholder: \"gpt-4o-mini\"\n                                                            }, null, 512 /* NEED_PATCH */)), [\n                                                                [_vModelText, _unref(settings).apiConfig.model]\n                                                            ])\n                                                            : _withDirectives((_openBlock(), _createElementBlock(\"select\", {\n                                                                key: 1,\n                                                                \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event) => ((_unref(settings).apiConfig.model) = $event))\n                                                            }, [\n                                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(modelList.value, (m) => {\n                                                                    return (_openBlock(), _createElementBlock(\"option\", {\n                                                                        key: m,\n                                                                        value: m\n                                                                    }, _toDisplayString(m), 9 /* TEXT, PROPS */, _hoisted_16));\n                                                                }), 128 /* KEYED_FRAGMENT */))\n                                                            ], 512 /* NEED_PATCH */)), [\n                                                                [_vModelSelect, _unref(settings).apiConfig.model]\n                                                            ]),\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"input-btn\",\n                                                            type: \"button\",\n                                                            onClick: fetchModels,\n                                                            disabled: !_unref(settings).apiConfig.url || fetchingModels.value\n                                                        }, _toDisplayString(fetchingModels.value ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_17)\n                                                    ]),\n                                                    (modelFetchError.value)\n                                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18, _toDisplayString(modelFetchError.value), 1 /* TEXT */))\n                                                        : _createCommentVNode(\"v-if\", true)\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_19, [\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-test\",\n                                                        type: \"button\",\n                                                        disabled: !_unref(settings).apiConfig.url || testingConnection.value,\n                                                        onClick: testConnection\n                                                    }, _toDisplayString(testingConnection.value ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_20),\n                                                    (connectionStatus.value === 'success')\n                                                        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_21, \"\"))\n                                                        : _createCommentVNode(\"v-if\", true),\n                                                    (connectionStatus.value === 'fail')\n                                                        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_22, _toDisplayString(connectionError.value), 1 /* TEXT */))\n                                                        : _createCommentVNode(\"v-if\", true)\n                                                ])\n                                            ], 64 /* STABLE_FRAGMENT */))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        _createElementVNode(\"div\", _hoisted_23, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[6] || (_cache[6] = ($event) => ((_unref(settings).apiConfig.usePresetSampling) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).apiConfig.usePresetSampling]\n                                                ]),\n                                                _cache[87] || (_cache[87] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[88] || (_cache[88] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_24, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event) => ((_unref(settings).apiConfig.sendWorldInfo) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).apiConfig.sendWorldInfo]\n                                                ]),\n                                                _cache[89] || (_cache[89] = _createTextVNode(\" World Info \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[90] || (_cache[90] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        (!_unref(settings).apiConfig.usePresetSampling)\n                                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                                _createElementVNode(\"div\", _hoisted_25, [\n                                                    _createElementVNode(\"div\", _hoisted_26, [\n                                                        _cache[91] || (_cache[91] = _createElementVNode(\"label\", null, \"Max Tokens\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"number\",\n                                                            \"onUpdate:modelValue\": _cache[8] || (_cache[8] = ($event) => ((_unref(settings).apiConfig.max_tokens) = $event)),\n                                                            min: \"1\",\n                                                            max: \"4096\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).apiConfig.max_tokens,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_27, [\n                                                        _createElementVNode(\"label\", null, \"Temperature (\" + _toDisplayString(temperatureLabel.value) + \")\", 1 /* TEXT */),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"range\",\n                                                            \"onUpdate:modelValue\": _cache[9] || (_cache[9] = ($event) => ((_unref(settings).apiConfig.temperature) = $event)),\n                                                            min: \"0\",\n                                                            max: \"2\",\n                                                            step: \"0.1\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).apiConfig.temperature,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", {\n                                                    class: \"advanced-toggle\",\n                                                    onClick: _cache[10] || (_cache[10] = ($event) => (showAdvanced.value = !showAdvanced.value))\n                                                }, [\n                                                    _createElementVNode(\"span\", _hoisted_28, _toDisplayString(showAdvanced.value ? '' : ''), 1 /* TEXT */),\n                                                    _cache[92] || (_cache[92] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                                ]),\n                                                (showAdvanced.value)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_29, [\n                                                        _createElementVNode(\"div\", _hoisted_30, [\n                                                            _createElementVNode(\"div\", _hoisted_31, [\n                                                                _createElementVNode(\"label\", null, \"Frequency Penalty (\" + _toDisplayString(frequencyPenaltyLabel.value) + \")\", 1 /* TEXT */),\n                                                                _withDirectives(_createElementVNode(\"input\", {\n                                                                    type: \"range\",\n                                                                    \"onUpdate:modelValue\": _cache[11] || (_cache[11] = ($event) => ((_unref(settings).apiConfig.frequency_penalty) = $event)),\n                                                                    min: \"-2\",\n                                                                    max: \"2\",\n                                                                    step: \"0.1\"\n                                                                }, null, 512 /* NEED_PATCH */), [\n                                                                    [\n                                                                        _vModelText,\n                                                                        _unref(settings).apiConfig.frequency_penalty,\n                                                                        void 0,\n                                                                        { number: true }\n                                                                    ]\n                                                                ])\n                                                            ]),\n                                                            _createElementVNode(\"div\", _hoisted_32, [\n                                                                _createElementVNode(\"label\", null, \"Presence Penalty (\" + _toDisplayString(presencePenaltyLabel.value) + \")\", 1 /* TEXT */),\n                                                                _withDirectives(_createElementVNode(\"input\", {\n                                                                    type: \"range\",\n                                                                    \"onUpdate:modelValue\": _cache[12] || (_cache[12] = ($event) => ((_unref(settings).apiConfig.presence_penalty) = $event)),\n                                                                    min: \"-2\",\n                                                                    max: \"2\",\n                                                                    step: \"0.1\"\n                                                                }, null, 512 /* NEED_PATCH */), [\n                                                                    [\n                                                                        _vModelText,\n                                                                        _unref(settings).apiConfig.presence_penalty,\n                                                                        void 0,\n                                                                        { number: true }\n                                                                    ]\n                                                                ])\n                                                            ])\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_33, [\n                                                            _createElementVNode(\"div\", _hoisted_34, [\n                                                                _createElementVNode(\"label\", null, \"Top P (\" + _toDisplayString(topPLabel.value) + \")\", 1 /* TEXT */),\n                                                                _withDirectives(_createElementVNode(\"input\", {\n                                                                    type: \"range\",\n                                                                    \"onUpdate:modelValue\": _cache[13] || (_cache[13] = ($event) => ((_unref(settings).apiConfig.top_p) = $event)),\n                                                                    min: \"0\",\n                                                                    max: \"1\",\n                                                                    step: \"0.01\"\n                                                                }, null, 512 /* NEED_PATCH */), [\n                                                                    [\n                                                                        _vModelText,\n                                                                        _unref(settings).apiConfig.top_p,\n                                                                        void 0,\n                                                                        { number: true }\n                                                                    ]\n                                                                ])\n                                                            ]),\n                                                            _createElementVNode(\"div\", _hoisted_35, [\n                                                                _cache[93] || (_cache[93] = _createElementVNode(\"label\", null, \"Top K\", -1 /* CACHED */)),\n                                                                _withDirectives(_createElementVNode(\"input\", {\n                                                                    type: \"number\",\n                                                                    \"onUpdate:modelValue\": _cache[14] || (_cache[14] = ($event) => ((_unref(settings).apiConfig.top_k) = $event)),\n                                                                    min: \"0\",\n                                                                    max: \"500\"\n                                                                }, null, 512 /* NEED_PATCH */), [\n                                                                    [\n                                                                        _vModelText,\n                                                                        _unref(settings).apiConfig.top_k,\n                                                                        void 0,\n                                                                        { number: true }\n                                                                    ]\n                                                                ])\n                                                            ])\n                                                        ])\n                                                    ]))\n                                                    : _createCommentVNode(\"v-if\", true)\n                                            ], 64 /* STABLE_FRAGMENT */))\n                                            : _createCommentVNode(\"v-if\", true)\n                                    ], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'api']\n                                    ]),\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_36, [\n                                        _cache[104] || (_cache[104] = _createElementVNode(\"h4\", null, [\n                                            _createElementVNode(\"span\", { class: \"section-index\" }, \"02\"),\n                                            _createElementVNode(\"span\", { class: \"section-label\" }, \"Live2D \"),\n                                            _createElementVNode(\"span\", { class: \"section-sub\" }, \"MODEL CONTROL\")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_37, [\n                                            _cache[95] || (_cache[95] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_38, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"text\",\n                                                    \"onUpdate:modelValue\": _cache[15] || (_cache[15] = ($event) => ((customModelUrl).value = $event)),\n                                                    placeholder: \" .model.json  .model3.json  URL\",\n                                                    onKeydown: _withKeys(loadCustomUrl, [\"enter\"])\n                                                }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                                    [_vModelText, customModelUrl.value]\n                                                ]),\n                                                _createElementVNode(\"button\", {\n                                                    class: \"input-btn\",\n                                                    type: \"button\",\n                                                    onClick: loadCustomUrl,\n                                                    disabled: !customModelUrl.value.trim()\n                                                }, \"  \", 8 /* PROPS */, _hoisted_39)\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_40, [\n                                            _cache[96] || (_cache[96] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_41, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(recommendedModels), (m) => {\n                                                    return (_openBlock(), _createElementBlock(\"button\", {\n                                                        key: m.path,\n                                                        class: _normalizeClass([\"model-btn\", { active: _unref(settings).modelPath === m.path }]),\n                                                        type: \"button\",\n                                                        onClick: ($event) => (selectModel(m.path))\n                                                    }, _toDisplayString(m.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_42));\n                                                }), 128 /* KEYED_FRAGMENT */)),\n                                                _createElementVNode(\"button\", {\n                                                    class: \"model-btn browse-btn\",\n                                                    type: \"button\",\n                                                    onClick: _cache[16] || (_cache[16] = ($event) => (showBrowser.value = true))\n                                                }, \"\")\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_43, [\n                                            _cache[97] || (_cache[97] = _createElementVNode(\"label\", null, \" ZIP \", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_44, [\n                                                _createElementVNode(\"button\", {\n                                                    class: \"model-btn\",\n                                                    type: \"button\",\n                                                    disabled: localModelBusy.value,\n                                                    onClick: triggerLocalModelUpload\n                                                }, _toDisplayString(uploadingLocalModel.value ? '...' : ' ZIP '), 9 /* TEXT, PROPS */, _hoisted_45),\n                                                _createElementVNode(\"button\", {\n                                                    class: \"model-btn\",\n                                                    type: \"button\",\n                                                    disabled: localModelBusy.value || !localModelExists.value,\n                                                    onClick: useUploadedModel\n                                                }, \"  \", 8 /* PROPS */, _hoisted_46),\n                                                _createElementVNode(\"button\", {\n                                                    class: \"model-btn\",\n                                                    type: \"button\",\n                                                    disabled: localModelBusy.value || !localModelExists.value,\n                                                    onClick: clearUploadedModel\n                                                }, \"  \", 8 /* PROPS */, _hoisted_47)\n                                            ]),\n                                            _createElementVNode(\"input\", {\n                                                ref_key: \"localModelFileInput\",\n                                                ref: localModelFileInput,\n                                                class: \"hidden-file-input\",\n                                                type: \"file\",\n                                                accept: \".zip,application/zip\",\n                                                onChange: onLocalModelFileChange\n                                            }, null, 544 /* NEED_HYDRATION, NEED_PATCH */),\n                                            _createElementVNode(\"div\", _hoisted_48, \"\" + _toDisplayString(_unref(LOCAL_LIVE2D_MODEL_PATH)), 1 /* TEXT */),\n                                            (localModelStatus.value)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_49, _toDisplayString(localModelStatus.value), 1 /* TEXT */))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            (localModelError.value)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_50, _toDisplayString(localModelError.value), 1 /* TEXT */))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            (localModelInfo.value)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_51, [\n                                                    _createElementVNode(\"div\", null, \"\" + _toDisplayString(localModelInfo.value.fileName), 1 /* TEXT */),\n                                                    _createElementVNode(\"div\", null, \"Cubism \" + _toDisplayString(localModelInfo.value.cubismVersion ?? ''), 1 /* TEXT */),\n                                                    _createElementVNode(\"div\", null, \"Runtime\" + _toDisplayString(runtimeLabel(localModelInfo.value.runtimeType)), 1 /* TEXT */),\n                                                    _createElementVNode(\"div\", null, \"\" + _toDisplayString(formatLocalUploadTime(localModelInfo.value.uploadTime)), 1 /* TEXT */),\n                                                    _createElementVNode(\"div\", null, \"\" + _toDisplayString(formatFileSize(localModelInfo.value.fileSize)), 1 /* TEXT */)\n                                                ]))\n                                                : (_openBlock(), _createElementBlock(\"div\", _hoisted_52, \"\"))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_53, [\n                                            _createElementVNode(\"label\", null, \" (\" + _toDisplayString(petScaleLabel.value) + \")\", 1 /* TEXT */),\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"range\",\n                                                \"onUpdate:modelValue\": _cache[17] || (_cache[17] = ($event) => ((_unref(settings).petScale) = $event)),\n                                                min: \"0.1\",\n                                                max: \"3\",\n                                                step: \"0.05\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [\n                                                    _vModelText,\n                                                    _unref(settings).petScale,\n                                                    void 0,\n                                                    { number: true }\n                                                ]\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_54, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[18] || (_cache[18] = ($event) => ((_unref(settings).useCdn) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).useCdn]\n                                                ]),\n                                                _cache[98] || (_cache[98] = _createTextVNode(\"  CDN jsDelivr \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[99] || (_cache[99] = _createElementVNode(\"div\", { class: \"hint\" }, \" GitHub  CDN \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_55, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[19] || (_cache[19] = ($event) => ((_unref(settings).doubleTapRandomMotionEnabled) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).doubleTapRandomMotionEnabled]\n                                                ]),\n                                                _cache[100] || (_cache[100] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[101] || (_cache[101] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_56, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[20] || (_cache[20] = ($event) => ((_unref(settings).gazeFollowMouseEnabled) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).gazeFollowMouseEnabled]\n                                                ]),\n                                                _cache[102] || (_cache[102] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[103] || (_cache[103] = _createElementVNode(\"div\", { class: \"hint\" }, \"/\", -1 /* CACHED */))\n                                        ])\n                                    ], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'live2d']\n                                    ]),\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_57, [\n                                        _cache[128] || (_cache[128] = _createElementVNode(\"h4\", null, [\n                                            _createElementVNode(\"span\", { class: \"section-index\" }, \"03\"),\n                                            _createElementVNode(\"span\", { class: \"section-label\" }, \"\"),\n                                            _createElementVNode(\"span\", { class: \"section-sub\" }, \"COMMENT SYSTEM\")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_58, [\n                                            _cache[105] || (_cache[105] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"select\", {\n                                                \"onUpdate:modelValue\": _cache[21] || (_cache[21] = ($event) => ((_unref(settings).commentStyle) = $event))\n                                            }, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(commentStyles), (style) => {\n                                                    return (_openBlock(), _createElementBlock(\"option\", {\n                                                        key: style,\n                                                        value: style\n                                                    }, _toDisplayString(style), 9 /* TEXT, PROPS */, _hoisted_59));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ], 512 /* NEED_PATCH */), [\n                                                [_vModelSelect, _unref(settings).commentStyle]\n                                            ])\n                                        ]),\n                                        (_unref(settings).commentStyle === '')\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_60, [\n                                                _cache[106] || (_cache[106] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                _withDirectives(_createElementVNode(\"textarea\", {\n                                                    \"onUpdate:modelValue\": _cache[22] || (_cache[22] = ($event) => ((_unref(settings).customPrompt) = $event)),\n                                                    rows: \"4\",\n                                                    placeholder: \"...\"\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelText, _unref(settings).customPrompt]\n                                                ])\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        _createElementVNode(\"div\", _hoisted_61, [\n                                            _cache[107] || (_cache[107] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"text\",\n                                                \"onUpdate:modelValue\": _cache[23] || (_cache[23] = ($event) => ((_unref(settings).roleplayName) = $event)),\n                                                placeholder: \"\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [_vModelText, _unref(settings).roleplayName]\n                                            ]),\n                                            _cache[108] || (_cache[108] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_62, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[24] || (_cache[24] = ($event) => ((_unref(settings).roleplayIgnoreCommentStyle) = $event)),\n                                                    disabled: !_unref(settings).roleplayName.trim()\n                                                }, null, 8 /* PROPS */, _hoisted_63), [\n                                                    [_vModelCheckbox, _unref(settings).roleplayIgnoreCommentStyle]\n                                                ]),\n                                                _cache[109] || (_cache[109] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[110] || (_cache[110] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_64, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[25] || (_cache[25] = ($event) => ((_unref(settings).sendCharacterCardContent) = $event)),\n                                                    disabled: !_unref(settings).roleplayName.trim()\n                                                }, null, 8 /* PROPS */, _hoisted_65), [\n                                                    [_vModelCheckbox, _unref(settings).sendCharacterCardContent]\n                                                ]),\n                                                _cache[111] || (_cache[111] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[112] || (_cache[112] = _createElementVNode(\"div\", { class: \"hint\" }, \"//\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_66, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[26] || (_cache[26] = ($event) => ((_unref(settings).autoTrigger) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).autoTrigger]\n                                                ]),\n                                                _cache[113] || (_cache[113] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ])\n                                        ]),\n                                        (_unref(settings).autoTrigger)\n                                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                                _createElementVNode(\"div\", _hoisted_67, [\n                                                    _cache[114] || (_cache[114] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"select\", {\n                                                        \"onUpdate:modelValue\": _cache[27] || (_cache[27] = ($event) => ((_unref(settings).commentTriggerMode) = $event))\n                                                    }, [\n                                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(commentTriggerModeOptions), (option) => {\n                                                            return (_openBlock(), _createElementBlock(\"option\", {\n                                                                key: option.value,\n                                                                value: option.value\n                                                            }, _toDisplayString(option.label), 9 /* TEXT, PROPS */, _hoisted_68));\n                                                        }), 128 /* KEYED_FRAGMENT */))\n                                                    ], 512 /* NEED_PATCH */), [\n                                                        [_vModelSelect, _unref(settings).commentTriggerMode]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_69, [\n                                                    _createElementVNode(\"div\", _hoisted_70, [\n                                                        _cache[115] || (_cache[115] = _createElementVNode(\"label\", null, \" N \", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"number\",\n                                                            \"onUpdate:modelValue\": _cache[28] || (_cache[28] = ($event) => ((_unref(settings).triggerInterval) = $event)),\n                                                            min: \"1\",\n                                                            max: \"100\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).triggerInterval,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_71, [\n                                                        _createElementVNode(\"label\", null, \"\" + _toDisplayString(_unref(settings).triggerProbability) + \"%\", 1 /* TEXT */),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"range\",\n                                                            \"onUpdate:modelValue\": _cache[29] || (_cache[29] = ($event) => ((_unref(settings).triggerProbability) = $event)),\n                                                            min: \"0\",\n                                                            max: \"100\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).triggerProbability,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ])\n                                                    ])\n                                                ])\n                                            ], 64 /* STABLE_FRAGMENT */))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        _createElementVNode(\"div\", _hoisted_72, [\n                                            _cache[116] || (_cache[116] = _createElementVNode(\"label\", null, \" LLM \", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"number\",\n                                                \"onUpdate:modelValue\": _cache[30] || (_cache[30] = ($event) => ((_unref(settings).maxChatContext) = $event)),\n                                                min: \"1\",\n                                                max: \"50\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [\n                                                    _vModelText,\n                                                    _unref(settings).maxChatContext,\n                                                    void 0,\n                                                    { number: true }\n                                                ]\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_73, [\n                                            _cache[117] || (_cache[117] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"number\",\n                                                \"onUpdate:modelValue\": _cache[31] || (_cache[31] = ($event) => ((_unref(settings).bubbleDuration) = $event)),\n                                                min: \"-1\",\n                                                max: \"600\",\n                                                step: \"1\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [\n                                                    _vModelText,\n                                                    _unref(settings).bubbleDuration,\n                                                    void 0,\n                                                    { number: true }\n                                                ]\n                                            ]),\n                                            _cache[118] || (_cache[118] = _createElementVNode(\"div\", { class: \"hint\" }, \" -1  0 \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_74, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[32] || (_cache[32] = ($event) => ((_unref(settings).phoneMessageAutoRead) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).phoneMessageAutoRead]\n                                                ]),\n                                                _cache[119] || (_cache[119] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[120] || (_cache[120] = _createElementVNode(\"div\", { class: \"hint\" }, \" NPC  TTS \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_75, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[33] || (_cache[33] = ($event) => ((_unref(settings).baibaiPhoneMessageAutoRead) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).baibaiPhoneMessageAutoRead]\n                                                ]),\n                                                _cache[121] || (_cache[121] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[122] || (_cache[122] = _createElementVNode(\"div\", { class: \"hint\" }, \" NPC  TTS \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_76, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[34] || (_cache[34] = ($event) => ((_unref(settings).useTamakoTodaySpecial) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).useTamakoTodaySpecial]\n                                                ]),\n                                                _cache[123] || (_cache[123] = _createTextVNode(\"  Tamako  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[124] || (_cache[124] = _createElementVNode(\"div\", { class: \"hint\" }, \" Tamako Market \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_77, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[35] || (_cache[35] = ($event) => ((_unref(settings).useDiceDatabaseReference) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).useDiceDatabaseReference]\n                                                ]),\n                                                _cache[125] || (_cache[125] = _createTextVNode(\"  +  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[126] || (_cache[126] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        (_unref(settings).useDiceDatabaseReference)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_78, [\n                                                _cache[127] || (_cache[127] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                _createElementVNode(\"div\", _hoisted_79, [\n                                                    _createElementVNode(\"div\", _hoisted_80, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-test\",\n                                                            type: \"button\",\n                                                            onClick: refreshDiceReferenceSheetOptions,\n                                                            disabled: refreshingDiceSheetOptions.value\n                                                        }, _toDisplayString(refreshingDiceSheetOptions.value ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_81)\n                                                    ]),\n                                                    _createElementVNode(\"div\", { class: \"form-group half\" }, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: selectAllDiceReferenceSheets\n                                                        }, \"\")\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_82, [\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-secondary\",\n                                                        type: \"button\",\n                                                        onClick: clearDiceReferenceSheets\n                                                    }, \"\"),\n                                                    _createElementVNode(\"div\", _hoisted_83, _toDisplayString(diceReferenceSheetSummary.value), 1 /* TEXT */)\n                                                ]),\n                                                (diceReferenceSheetOptions.value.length > 0)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_84, [\n                                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(diceReferenceSheetOptions.value, (sheetName) => {\n                                                            return (_openBlock(), _createElementBlock(\"label\", {\n                                                                class: \"dice-sheet-item\",\n                                                                key: sheetName\n                                                            }, [\n                                                                _createElementVNode(\"input\", {\n                                                                    type: \"checkbox\",\n                                                                    checked: isDiceSheetVisible(sheetName),\n                                                                    onChange: ($event) => (onToggleDiceSheetVisibility(sheetName, $event))\n                                                                }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_85),\n                                                                _createElementVNode(\"span\", null, _toDisplayString(sheetName), 1 /* TEXT */)\n                                                            ]));\n                                                        }), 128 /* KEYED_FRAGMENT */))\n                                                    ]))\n                                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_86, \"\"))\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true)\n                                    ], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'comment']\n                                    ]),\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_87, [\n                                        _cache[147] || (_cache[147] = _createElementVNode(\"h4\", null, [\n                                            _createElementVNode(\"span\", { class: \"section-index\" }, \"04\"),\n                                            _createElementVNode(\"span\", { class: \"section-label\" }, \"\"),\n                                            _createElementVNode(\"span\", { class: \"section-sub\" }, \"EMOTION COT\")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_88, [\n                                            _createElementVNode(\"div\", _hoisted_89, [\n                                                _createElementVNode(\"div\", _hoisted_90, [\n                                                    _createElementVNode(\"label\", null, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"checkbox\",\n                                                            \"onUpdate:modelValue\": _cache[36] || (_cache[36] = ($event) => ((_unref(settings).emotionCotEnabled) = $event))\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).emotionCotEnabled]\n                                                        ]),\n                                                        _cache[129] || (_cache[129] = _createTextVNode(\"  COT \", -1 /* CACHED */))\n                                                    ]),\n                                                    _cache[130] || (_cache[130] = _createElementVNode(\"div\", { class: \"hint\" }, [\n                                                        _createTextVNode(\" LLM  \"),\n                                                        _createElementVNode(\"code\", null, \"[|]: \"),\n                                                        _createTextVNode(\" /TTS  Live2D \")\n                                                    ], -1 /* CACHED */)),\n                                                    _createElementVNode(\"div\", _hoisted_91, \"\" + _toDisplayString(_unref(emotionTags).join('')), 1 /* TEXT */)\n                                                ]),\n                                                (_unref(settings).emotionCotEnabled)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_92, [\n                                                        _createElementVNode(\"label\", null, [\n                                                            _withDirectives(_createElementVNode(\"input\", {\n                                                                type: \"checkbox\",\n                                                                \"onUpdate:modelValue\": _cache[37] || (_cache[37] = ($event) => ((_unref(settings).emotionCotStripFromText) = $event))\n                                                            }, null, 512 /* NEED_PATCH */), [\n                                                                [_vModelCheckbox, _unref(settings).emotionCotStripFromText]\n                                                            ]),\n                                                            _cache[131] || (_cache[131] = _createTextVNode(\" /TTS  \", -1 /* CACHED */))\n                                                        ]),\n                                                        _cache[132] || (_cache[132] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                                    ]))\n                                                    : _createCommentVNode(\"v-if\", true),\n                                                _createElementVNode(\"div\", _hoisted_93, [\n                                                    _createElementVNode(\"div\", { class: \"form-group half\" }, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: resetEmotionConfigs\n                                                        }, \"\")\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_94, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-test\",\n                                                            type: \"button\",\n                                                            onClick: refreshLive2DLists,\n                                                            disabled: refreshingLive2dLists.value\n                                                        }, _toDisplayString(refreshingLive2dLists.value ? '...' : '/'), 9 /* TEXT, PROPS */, _hoisted_95)\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_96, [\n                                                    _createElementVNode(\"div\", _hoisted_97, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-test\",\n                                                            type: \"button\",\n                                                            onClick: _cache[38] || (_cache[38] = ($event) => (autoMatchLive2DOverrides(false)))\n                                                        }, \"  \")\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_98, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: _cache[39] || (_cache[39] = ($event) => (autoMatchLive2DOverrides(true)))\n                                                        }, \"  \")\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_99, [\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-secondary\",\n                                                        type: \"button\",\n                                                        onClick: clearLive2DOverrides\n                                                    }, \" Live2D \"),\n                                                    _createElementVNode(\"div\", _hoisted_100, _toDisplayString(live2dListSummary.value), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_101, [\n                                                    _createElementVNode(\"div\", {\n                                                        class: \"advanced-toggle\",\n                                                        onClick: _cache[40] || (_cache[40] = ($event) => (showEmotionAdvanced.value = !showEmotionAdvanced.value))\n                                                    }, [\n                                                        _createElementVNode(\"span\", _hoisted_102, _toDisplayString(showEmotionAdvanced.value ? '' : ''), 1 /* TEXT */),\n                                                        _createElementVNode(\"span\", null, _toDisplayString(showEmotionAdvanced.value ? '' : ''), 1 /* TEXT */)\n                                                    ]),\n                                                    _cache[133] || (_cache[133] = _createElementVNode(\"div\", { class: \"hint\" }, \"TTS \", -1 /* CACHED */))\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_103, [\n                                                    _cache[137] || (_cache[137] = _createElementVNode(\"div\", { class: \"emotion-map-head\" }, [\n                                                        _createElementVNode(\"div\", null, \"\"),\n                                                        _createElementVNode(\"div\", null, \"\"),\n                                                        _createElementVNode(\"div\", null, \"Live2D Expression\"),\n                                                        _createElementVNode(\"div\", null, \"Live2D Motion\"),\n                                                        _createElementVNode(\"div\", null, \"\")\n                                                    ], -1 /* CACHED */)),\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(settings).emotionConfigs, (cfg) => {\n                                                        return (_openBlock(), _createElementBlock(\"div\", {\n                                                            key: cfg.tag,\n                                                            class: \"emotion-map-row\"\n                                                        }, [\n                                                            _createElementVNode(\"div\", _hoisted_104, _toDisplayString(cfg.tag), 1 /* TEXT */),\n                                                            _cache[136] || (_cache[136] = _createElementVNode(\"div\", { class: \"emotion-map-arrow\" }, \"\", -1 /* CACHED */)),\n                                                            _withDirectives(_createElementVNode(\"select\", {\n                                                                \"onUpdate:modelValue\": ($event) => ((cfg.live2dExpression) = $event)\n                                                            }, [\n                                                                _cache[134] || (_cache[134] = _createElementVNode(\"option\", { value: \"\" }, \"\", -1 /* CACHED */)),\n                                                                (cfg.live2dExpression && !live2dExpressionOptionSet.value.has(cfg.live2dExpression))\n                                                                    ? (_openBlock(), _createElementBlock(\"option\", {\n                                                                        key: 0,\n                                                                        value: cfg.live2dExpression\n                                                                    }, _toDisplayString(cfg.live2dExpression) + \" \", 9 /* TEXT, PROPS */, _hoisted_106))\n                                                                    : _createCommentVNode(\"v-if\", true),\n                                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(live2dExpressionSelectOptions.value, (opt) => {\n                                                                    return (_openBlock(), _createElementBlock(\"option\", {\n                                                                        key: opt.key,\n                                                                        value: opt.value\n                                                                    }, _toDisplayString(opt.label), 9 /* TEXT, PROPS */, _hoisted_107));\n                                                                }), 128 /* KEYED_FRAGMENT */))\n                                                            ], 8 /* PROPS */, _hoisted_105), [\n                                                                [_vModelSelect, cfg.live2dExpression]\n                                                            ]),\n                                                            _createElementVNode(\"select\", {\n                                                                value: getMotionOverrideValue(cfg),\n                                                                disabled: !cfg.live2dMotion.enabled,\n                                                                onChange: ($event) => (onMotionOverrideChange(cfg, $event))\n                                                            }, [\n                                                                _cache[135] || (_cache[135] = _createElementVNode(\"option\", { value: \"\" }, \"\", -1 /* CACHED */)),\n                                                                (getMotionOverrideValue(cfg) && !live2dMotionOptionSet.value.has(getMotionOverrideValue(cfg)))\n                                                                    ? (_openBlock(), _createElementBlock(\"option\", {\n                                                                        key: 0,\n                                                                        value: getMotionOverrideValue(cfg)\n                                                                    }, _toDisplayString(getMotionOverrideLabel(cfg)) + \" \", 9 /* TEXT, PROPS */, _hoisted_109))\n                                                                    : _createCommentVNode(\"v-if\", true),\n                                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(live2dMotionSelectOptions.value, (opt) => {\n                                                                    return (_openBlock(), _createElementBlock(\"option\", {\n                                                                        key: opt.key,\n                                                                        value: opt.value\n                                                                    }, _toDisplayString(opt.label), 9 /* TEXT, PROPS */, _hoisted_110));\n                                                                }), 128 /* KEYED_FRAGMENT */))\n                                                            ], 40 /* PROPS, NEED_HYDRATION */, _hoisted_108),\n                                                            _createElementVNode(\"button\", {\n                                                                class: \"btn btn-secondary emotion-map-preview-btn\",\n                                                                type: \"button\",\n                                                                title: \"\",\n                                                                onClick: ($event) => (previewEmotion(cfg.tag))\n                                                            }, \"  \", 8 /* PROPS */, _hoisted_111)\n                                                        ]));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]),\n                                                _cache[143] || (_cache[143] = _createElementVNode(\"div\", { class: \"hint\" }, \" Expressions Motions\", -1 /* CACHED */)),\n                                                (showEmotionAdvanced.value)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_112, [\n                                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(settings).emotionConfigs, (cfg) => {\n                                                            return (_openBlock(), _createElementBlock(\"div\", {\n                                                                key: `advanced_${cfg.tag}`,\n                                                                class: \"emotion-advanced-item\"\n                                                            }, [\n                                                                _createElementVNode(\"div\", _hoisted_113, _toDisplayString(cfg.tag) + \"  \", 1 /* TEXT */),\n                                                                _createElementVNode(\"div\", _hoisted_114, [\n                                                                    _createElementVNode(\"div\", _hoisted_115, [\n                                                                        _cache[138] || (_cache[138] = _createElementVNode(\"label\", null, \"raw tag  \", -1 /* CACHED */)),\n                                                                        _createElementVNode(\"input\", {\n                                                                            type: \"text\",\n                                                                            value: (cfg.aliases || []).join(', '),\n                                                                            onBlur: ($event) => (onAliasesBlur(cfg, $event)),\n                                                                            placeholder: \", smile\"\n                                                                        }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_116),\n                                                                        _cache[139] || (_cache[139] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                                                    ]),\n                                                                    _createElementVNode(\"div\", _hoisted_117, [\n                                                                        _cache[140] || (_cache[140] = _createElementVNode(\"label\", null, \"TTS \", -1 /* CACHED */)),\n                                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                                            type: \"text\",\n                                                                            \"onUpdate:modelValue\": ($event) => ((cfg.ttsContext) = $event),\n                                                                            placeholder: \"\"\n                                                                        }, null, 8 /* PROPS */, _hoisted_118), [\n                                                                            [_vModelText, cfg.ttsContext]\n                                                                        ]),\n                                                                        _cache[141] || (_cache[141] = _createElementVNode(\"div\", { class: \"hint\" }, \" |  contextTexts  TTS\", -1 /* CACHED */))\n                                                                    ])\n                                                                ]),\n                                                                _createElementVNode(\"div\", _hoisted_119, [\n                                                                    _createElementVNode(\"label\", null, [\n                                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                                            type: \"checkbox\",\n                                                                            \"onUpdate:modelValue\": ($event) => ((cfg.live2dMotion.enabled) = $event)\n                                                                        }, null, 8 /* PROPS */, _hoisted_120), [\n                                                                            [_vModelCheckbox, cfg.live2dMotion.enabled]\n                                                                        ]),\n                                                                        _cache[142] || (_cache[142] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                                                    ])\n                                                                ])\n                                                            ]));\n                                                        }), 128 /* KEYED_FRAGMENT */))\n                                                    ]))\n                                                    : _createCommentVNode(\"v-if\", true)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_121, [\n                                                _createElementVNode(\"div\", _hoisted_122, [\n                                                    _cache[144] || (_cache[144] = _createElementVNode(\"span\", { class: \"emotion-preview-title\" }, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"span\", _hoisted_123, \": \" + _toDisplayString(previewTag.value), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"div\", {\n                                                    class: \"emotion-preview-canvas\",\n                                                    ref_key: \"live2dPreviewMountEl\",\n                                                    ref: live2dPreviewMountEl\n                                                }, [\n                                                    _createElementVNode(\"div\", {\n                                                        class: \"emotion-preview-interact\",\n                                                        ref_key: \"live2dPreviewInteractEl\",\n                                                        ref: live2dPreviewInteractEl\n                                                    }, null, 512 /* NEED_PATCH */),\n                                                    (!_unref(Live2DManager).model)\n                                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_124, \"\"))\n                                                        : _createCommentVNode(\"v-if\", true)\n                                                ], 512 /* NEED_PATCH */),\n                                                _createElementVNode(\"div\", _hoisted_125, [\n                                                    _createElementVNode(\"div\", _hoisted_126, [\n                                                        _cache[145] || (_cache[145] = _createElementVNode(\"span\", { class: \"zoom-label\" }, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            class: \"zoom-slider\",\n                                                            type: \"range\",\n                                                            min: \"0.5\",\n                                                            max: \"4\",\n                                                            step: \"0.05\",\n                                                            \"onUpdate:modelValue\": _cache[41] || (_cache[41] = ($event) => ((previewZoomFactor).value = $event)),\n                                                            onInput: applyPreviewViewport\n                                                        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                previewZoomFactor.value,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ]),\n                                                        _createElementVNode(\"span\", _hoisted_127, _toDisplayString(Math.round(previewZoomFactor.value * 100)) + \"%\", 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"div\", { class: \"emotion-preview-actions\" }, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: resetPreviewViewport\n                                                        }, \"\"),\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: replayPreview\n                                                        }, \"\")\n                                                    ]),\n                                                    _cache[146] || (_cache[146] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"div\", {\n                                                        class: \"hint\",\n                                                        title: previewStatus.value\n                                                    }, _toDisplayString(previewStatus.value), 9 /* TEXT, PROPS */, _hoisted_128)\n                                                ])\n                                            ])\n                                        ])\n                                    ], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'expression']\n                                    ]),\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_129, [\n                                        _cache[175] || (_cache[175] = _createElementVNode(\"h4\", null, [\n                                            _createElementVNode(\"span\", { class: \"section-index\" }, \"05\"),\n                                            _createElementVNode(\"span\", { class: \"section-label\" }, \"TTS \"),\n                                            _createElementVNode(\"span\", { class: \"section-sub\" }, \"VOICE CONTROL\")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_130, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[42] || (_cache[42] = ($event) => ((ttsEnabled).value = $event)),\n                                                    onChange: onToggleTtsEnabled\n                                                }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                                    [_vModelCheckbox, ttsEnabled.value]\n                                                ]),\n                                                _cache[148] || (_cache[148] = _createTextVNode(\"  TTS  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[149] || (_cache[149] = _createElementVNode(\"div\", { class: \"hint\" }, \"/\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_131, [\n                                            _cache[150] || (_cache[150] = _createElementVNode(\"label\", null, \"TTS \", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"select\", {\n                                                \"onUpdate:modelValue\": _cache[43] || (_cache[43] = ($event) => ((_unref(settings).ttsProvider) = $event))\n                                            }, [\n                                                _createElementVNode(\"option\", {\n                                                    value: _unref(TTS_PROVIDER).LITTLEWHITEBOX\n                                                }, \"X\", 8 /* PROPS */, _hoisted_132),\n                                                _createElementVNode(\"option\", {\n                                                    value: _unref(TTS_PROVIDER).GPT_SOVITS_V2\n                                                }, \"GPT-SoVITS v2ProPlus\", 8 /* PROPS */, _hoisted_133),\n                                                _createElementVNode(\"option\", {\n                                                    value: _unref(TTS_PROVIDER).EDGE_TTS_DIRECT\n                                                }, \"EdgeTTSEdge\", 8 /* PROPS */, _hoisted_134)\n                                            ], 512 /* NEED_PATCH */), [\n                                                [_vModelSelect, _unref(settings).ttsProvider]\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_135, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[44] || (_cache[44] = ($event) => ((_unref(settings).ttsAutoPlay) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).ttsAutoPlay]\n                                                ]),\n                                                _cache[151] || (_cache[151] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_136, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[45] || (_cache[45] = ($event) => ((_unref(settings).ttsBilingualZhJaEnabled) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).ttsBilingualZhJaEnabled]\n                                                ]),\n                                                _cache[152] || (_cache[152] = _createTextVNode(\" TTS  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[153] || (_cache[153] = _createElementVNode(\"div\", { class: \"hint\" }, \"JP\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_137, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[46] || (_cache[46] = ($event) => ((_unref(settings).phoneMessageAutoRead) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).phoneMessageAutoRead]\n                                                ]),\n                                                _cache[154] || (_cache[154] = _createTextVNode(\"  NPC  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[155] || (_cache[155] = _createElementVNode(\"div\", { class: \"hint\" }, \" sender=contact  type=text \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_138, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[47] || (_cache[47] = ($event) => ((_unref(settings).baibaiPhoneMessageAutoRead) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).baibaiPhoneMessageAutoRead]\n                                                ]),\n                                                _cache[156] || (_cache[156] = _createTextVNode(\"  NPC  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[157] || (_cache[157] = _createElementVNode(\"div\", { class: \"hint\" }, \" qq.private / qq.group  NPC \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_139, [\n                                            _cache[159] || (_cache[159] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_140, [\n                                                _withDirectives(_createElementVNode(\"select\", {\n                                                    \"onUpdate:modelValue\": _cache[48] || (_cache[48] = ($event) => ((_unref(settings).ttsDefaultSpeaker) = $event))\n                                                }, [\n                                                    _cache[158] || (_cache[158] = _createElementVNode(\"option\", { value: \"\" }, \"\", -1 /* CACHED */)),\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(ttsVoiceList.value, (v) => {\n                                                        return (_openBlock(), _createElementBlock(\"option\", {\n                                                            key: v.name,\n                                                            value: v.name\n                                                        }, _toDisplayString(v.name) + _toDisplayString(v.desc ? ' (' + v.desc + ')' : ''), 9 /* TEXT, PROPS */, _hoisted_141));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ], 512 /* NEED_PATCH */), [\n                                                    [_vModelSelect, _unref(settings).ttsDefaultSpeaker]\n                                                ]),\n                                                _createElementVNode(\"button\", {\n                                                    class: \"input-btn\",\n                                                    type: \"button\",\n                                                    onClick: refreshTtsVoices,\n                                                    disabled: refreshingTtsVoices.value\n                                                }, _toDisplayString(refreshingTtsVoices.value ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_142)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_143, _toDisplayString(ttsVoiceHint.value), 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", {\n                                            class: \"advanced-toggle\",\n                                            onClick: _cache[49] || (_cache[49] = ($event) => (showLipSyncAdvanced.value = !showLipSyncAdvanced.value))\n                                        }, [\n                                            _createElementVNode(\"span\", _hoisted_144, _toDisplayString(showLipSyncAdvanced.value ? '' : ''), 1 /* TEXT */),\n                                            _cache[160] || (_cache[160] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                        ]),\n                                        (showLipSyncAdvanced.value)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_145, [\n                                                _createElementVNode(\"div\", _hoisted_146, [\n                                                    _createElementVNode(\"label\", null, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"checkbox\",\n                                                            \"onUpdate:modelValue\": _cache[50] || (_cache[50] = ($event) => ((_unref(settings).lipSyncManualParamsEnabled) = $event))\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).lipSyncManualParamsEnabled]\n                                                        ]),\n                                                        _cache[161] || (_cache[161] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                                    ]),\n                                                    _cache[162] || (_cache[162] = _createElementVNode(\"div\", { class: \"hint\" }, \" Param58 / Param61\", -1 /* CACHED */))\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_147, [\n                                                    _cache[163] || (_cache[163] = _createElementVNode(\"label\", null, \" ID\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"textarea\", {\n                                                        \"onUpdate:modelValue\": _cache[51] || (_cache[51] = ($event) => ((lipSyncManualParamsText).value = $event)),\n                                                        rows: \"3\",\n                                                        placeholder: \"ParamMouthOpenY\\nParam58\",\n                                                        onBlur: applyLipSyncManualParams\n                                                    }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                                        [_vModelText, lipSyncManualParamsText.value]\n                                                    ]),\n                                                    _cache[164] || (_cache[164] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                                ])\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        (_unref(settings).ttsProvider === _unref(TTS_PROVIDER).GPT_SOVITS_V2)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_148, [\n                                                _createElementVNode(\"div\", _hoisted_149, [\n                                                    _cache[165] || (_cache[165] = _createElementVNode(\"label\", null, \"API \", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"input\", {\n                                                        type: \"text\",\n                                                        \"onUpdate:modelValue\": _cache[52] || (_cache[52] = ($event) => ((_unref(settings).gptSoVits.apiUrl) = $event)),\n                                                        placeholder: \"http://127.0.0.1:9880\"\n                                                    }, null, 512 /* NEED_PATCH */), [\n                                                        [_vModelText, _unref(settings).gptSoVits.apiUrl]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_150, [\n                                                    _cache[166] || (_cache[166] = _createElementVNode(\"label\", null, \" / \", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"input\", {\n                                                        type: \"text\",\n                                                        \"onUpdate:modelValue\": _cache[53] || (_cache[53] = ($event) => ((_unref(settings).gptSoVits.importPathPrefix) = $event)),\n                                                        placeholder: \"D:/\",\n                                                        onChange: onGptImportPrefixChange\n                                                    }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                                        [_vModelText, _unref(settings).gptSoVits.importPathPrefix]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_151, [\n                                                    _createElementVNode(\"label\", null, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"checkbox\",\n                                                            \"onUpdate:modelValue\": _cache[54] || (_cache[54] = ($event) => ((_unref(settings).gptSoVits.useCorsProxy) = $event))\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).gptSoVits.useCorsProxy]\n                                                        ]),\n                                                        _cache[167] || (_cache[167] = _createTextVNode(\" /proxy \", -1 /* CACHED */))\n                                                    ]),\n                                                    _cache[168] || (_cache[168] = _createElementVNode(\"div\", { class: \"hint\" }, \" config \", -1 /* CACHED */))\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_152, [\n                                                    _cache[170] || (_cache[170] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"select\", {\n                                                        \"onUpdate:modelValue\": _cache[55] || (_cache[55] = ($event) => ((_unref(settings).gptSoVits.modelSwitchMode) = $event)),\n                                                        onChange: onGptSwitchModeChange\n                                                    }, [...(_cache[169] || (_cache[169] = [\n                                                            _createElementVNode(\"option\", { value: \"set_weights\" }, \"set_weightsapi_v2.py\", -1 /* CACHED */),\n                                                            _createElementVNode(\"option\", { value: \"set_model\" }, \"set_modelapi.py\", -1 /* CACHED */),\n                                                            _createElementVNode(\"option\", { value: \"none\" }, \"\", -1 /* CACHED */)\n                                                        ]))], 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                                        [_vModelSelect, _unref(settings).gptSoVits.modelSwitchMode]\n                                                    ])\n                                                ]),\n                                                (isGptSetModelMode.value)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_153, [\n                                                        _cache[171] || (_cache[171] = _createElementVNode(\"label\", null, \"set_model endpoint\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": _cache[56] || (_cache[56] = ($event) => ((_unref(settings).gptSoVits.setModelEndpoint) = $event)),\n                                                            placeholder: \"/set_model\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelText, _unref(settings).gptSoVits.setModelEndpoint]\n                                                        ])\n                                                    ]))\n                                                    : _createCommentVNode(\"v-if\", true),\n                                                _createElementVNode(\"div\", _hoisted_154, [\n                                                    _createElementVNode(\"label\", null, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"checkbox\",\n                                                            \"onUpdate:modelValue\": _cache[57] || (_cache[57] = ($event) => ((_unref(settings).gptSoVits.strictWeightSwitch) = $event))\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).gptSoVits.strictWeightSwitch]\n                                                        ]),\n                                                        _cache[172] || (_cache[172] = _createTextVNode(\" strictWeightSwitch \", -1 /* CACHED */))\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_155, [\n                                                    _cache[173] || (_cache[173] = _createElementVNode(\"label\", null, \"v0.9\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"div\", _hoisted_156, _toDisplayString(gptModelSummaryHint.value), 1 /* TEXT */),\n                                                    _createElementVNode(\"div\", _hoisted_157, [\n                                                        _createElementVNode(\"div\", { class: \"form-group half\" }, [\n                                                            _createElementVNode(\"button\", {\n                                                                class: \"btn btn-secondary\",\n                                                                type: \"button\",\n                                                                onClick: openGptModelManager\n                                                            }, \"\")\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_158, [\n                                                            _createElementVNode(\"button\", {\n                                                                class: \"btn btn-secondary\",\n                                                                type: \"button\",\n                                                                onClick: refreshTtsVoices,\n                                                                disabled: refreshingTtsVoices.value\n                                                            }, _toDisplayString(refreshingTtsVoices.value ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_159)\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_160, [\n                                                        _createElementVNode(\"div\", _hoisted_161, [\n                                                            _createElementVNode(\"button\", {\n                                                                class: \"btn btn-test\",\n                                                                type: \"button\",\n                                                                onClick: testTts,\n                                                                disabled: !ttsEnabled.value\n                                                            }, \"\", 8 /* PROPS */, _hoisted_162)\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_163, [\n                                                            _withDirectives(_createElementVNode(\"input\", {\n                                                                type: \"text\",\n                                                                \"onUpdate:modelValue\": _cache[58] || (_cache[58] = ($event) => ((ttsTestText).value = $event)),\n                                                                placeholder: \"\"\n                                                            }, null, 512 /* NEED_PATCH */), [\n                                                                [_vModelText, ttsTestText.value]\n                                                            ])\n                                                        ])\n                                                    ]),\n                                                    _cache[174] || (_cache[174] = _createElementVNode(\"div\", { class: \"hint\" }, \" JSON //\", -1 /* CACHED */))\n                                                ])\n                                            ]))\n                                            : (_openBlock(), _createElementBlock(\"div\", _hoisted_164, [\n                                                _createElementVNode(\"button\", {\n                                                    class: \"btn btn-test\",\n                                                    type: \"button\",\n                                                    onClick: testTts,\n                                                    disabled: !ttsEnabled.value\n                                                }, \"\", 8 /* PROPS */, _hoisted_165),\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"text\",\n                                                    \"onUpdate:modelValue\": _cache[59] || (_cache[59] = ($event) => ((ttsTestText).value = $event)),\n                                                    placeholder: \"\"\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelText, ttsTestText.value]\n                                                ])\n                                            ])),\n                                        _createElementVNode(\"div\", { class: \"form-group\" }, [\n                                            _createElementVNode(\"button\", {\n                                                class: \"btn btn-secondary\",\n                                                type: \"button\",\n                                                onClick: stopTts\n                                            }, \"\")\n                                        ])\n                                    ], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'tts']\n                                    ]),\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_166, [...(_cache[176] || (_cache[176] = [\n                                            _createStaticVNode(\"<h4 data-v-64a4f085><span class=\\\"section-index\\\" data-v-64a4f085>06</span><span class=\\\"section-label\\\" data-v-64a4f085></span><span class=\\\"section-sub\\\" data-v-64a4f085>ABOUT &amp; LICENSE</span></h4><div class=\\\"about-card\\\" data-v-64a4f085><div class=\\\"about-title\\\" data-v-64a4f085></div><a class=\\\"about-link\\\" href=\\\"https://discord.com/channels/1134557553011998840/1472242483806077061\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\" data-v-64a4f085> https://discord.com/channels/1134557553011998840/1472242483806077061 </a></div><div class=\\\"about-card\\\" data-v-64a4f085><div class=\\\"about-title\\\" data-v-64a4f085></div><ul class=\\\"about-list\\\" data-v-64a4f085><li data-v-64a4f085>  Live2D  </li><li data-v-64a4f085></li><li data-v-64a4f085>  <a class=\\\"about-link\\\" href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\" data-v-64a4f085> CC BY-NC-SA 4.0 </a> -- </li><li data-v-64a4f085></li></ul></div>\", 3)\n                                        ]))], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'about']\n                                    ])\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", { class: \"panel-footer\" }, [\n                                _createElementVNode(\"button\", {\n                                    class: \"btn btn-secondary\",\n                                    type: \"button\",\n                                    onClick: resetSettings\n                                }, \"\"),\n                                _createElementVNode(\"button\", {\n                                    class: \"btn btn-primary\",\n                                    type: \"button\",\n                                    onClick: close\n                                }, \"\")\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (showGptModelManager.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 1,\n                        class: \"browser-overlay dp-browser-overlay gpt-model-overlay\",\n                        style: overlayFallbackStyle,\n                        onClick: _withModifiers(closeGptModelManager, [\"self\"])\n                    }, [\n                        _createElementVNode(\"div\", {\n                            class: \"browser-dialog dp-browser-dialog gpt-model-dialog\",\n                            style: panelFallbackStyle\n                        }, [\n                            _createElementVNode(\"div\", { class: \"browser-dialog-header gpt-model-header\" }, [\n                                _cache[177] || (_cache[177] = _createElementVNode(\"h3\", null, \"GPT-SoVITS v0.9\", -1 /* CACHED */)),\n                                _createElementVNode(\"div\", { class: \"gpt-model-header-actions\" }, [\n                                    _createElementVNode(\"button\", {\n                                        class: \"btn btn-secondary\",\n                                        type: \"button\",\n                                        onClick: openGptModelManagerImportJson\n                                    }, \"JSON\"),\n                                    _createElementVNode(\"button\", {\n                                        class: \"btn btn-secondary\",\n                                        type: \"button\",\n                                        onClick: openGptModelManagerImportFolder\n                                    }, \"\"),\n                                    _createElementVNode(\"button\", {\n                                        class: \"btn btn-secondary\",\n                                        type: \"button\",\n                                        onClick: exportGptModelManagerModels\n                                    }, \"JSON\"),\n                                    _createElementVNode(\"button\", {\n                                        class: \"btn btn-secondary\",\n                                        type: \"button\",\n                                        onClick: addGptModelManagerModel\n                                    }, \"\"),\n                                    _createElementVNode(\"button\", {\n                                        class: \"close-btn\",\n                                        type: \"button\",\n                                        onClick: closeGptModelManager\n                                    }, \"X\")\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_167, [\n                                _createElementVNode(\"div\", _hoisted_168, [\n                                    _withDirectives(_createElementVNode(\"input\", {\n                                        type: \"text\",\n                                        \"onUpdate:modelValue\": _cache[60] || (_cache[60] = ($event) => ((gptModelManagerSearch).value = $event)),\n                                        placeholder: \" /  / ID \"\n                                    }, null, 512 /* NEED_PATCH */), [\n                                        [_vModelText, gptModelManagerSearch.value]\n                                    ]),\n                                    _createElementVNode(\"button\", {\n                                        class: \"btn btn-secondary\",\n                                        type: \"button\",\n                                        onClick: saveGptModelManager\n                                    }, \"\"),\n                                    _createElementVNode(\"button\", {\n                                        class: \"btn btn-primary\",\n                                        type: \"button\",\n                                        onClick: saveGptModelManagerAndClose\n                                    }, \"\")\n                                ]),\n                                _createElementVNode(\"input\", {\n                                    ref_key: \"gptModelManagerImportJsonInputRef\",\n                                    ref: gptModelManagerImportJsonInputRef,\n                                    type: \"file\",\n                                    accept: \".json,application/json\",\n                                    style: { \"display\": \"none\" },\n                                    onChange: onGptModelManagerImportJsonChange\n                                }, null, 544 /* NEED_HYDRATION, NEED_PATCH */),\n                                _createElementVNode(\"input\", {\n                                    ref_key: \"gptModelManagerImportFolderInputRef\",\n                                    ref: gptModelManagerImportFolderInputRef,\n                                    type: \"file\",\n                                    webkitdirectory: \"\",\n                                    directory: \"\",\n                                    multiple: \"\",\n                                    style: { \"display\": \"none\" },\n                                    onChange: onGptModelManagerImportFolderChange\n                                }, null, 544 /* NEED_HYDRATION, NEED_PATCH */),\n                                (filteredGptModelManagerModels.value.length === 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_169, \" JSON/ \"))\n                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_170, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredGptModelManagerModels.value, (model) => {\n                                            return (_openBlock(), _createElementBlock(\"div\", {\n                                                key: model.id,\n                                                class: \"gpt-model-card\"\n                                            }, [\n                                                _createElementVNode(\"div\", _hoisted_171, [\n                                                    _createElementVNode(\"label\", null, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"checkbox\",\n                                                            \"onUpdate:modelValue\": ($event) => ((model.enabled) = $event)\n                                                        }, null, 8 /* PROPS */, _hoisted_172), [\n                                                            [_vModelCheckbox, model.enabled]\n                                                        ]),\n                                                        _cache[178] || (_cache[178] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                                    ]),\n                                                    _createElementVNode(\"span\", _hoisted_173, _toDisplayString(model.id), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_174, [\n                                                    _createElementVNode(\"div\", _hoisted_175, [\n                                                        _cache[179] || (_cache[179] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((model.name) = $event),\n                                                            placeholder: \"\"\n                                                        }, null, 8 /* PROPS */, _hoisted_176), [\n                                                            [_vModelText, model.name]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_177, [\n                                                        _cache[180] || (_cache[180] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((model.desc) = $event),\n                                                            placeholder: \"\"\n                                                        }, null, 8 /* PROPS */, _hoisted_178), [\n                                                            [_vModelText, model.desc]\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_179, [\n                                                    _createElementVNode(\"div\", _hoisted_180, [\n                                                        _cache[181] || (_cache[181] = _createElementVNode(\"label\", null, \"GPT \", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((model.paths.gptWeightsPath) = $event),\n                                                            placeholder: \"GPT_weights/xxx.ckpt\"\n                                                        }, null, 8 /* PROPS */, _hoisted_181), [\n                                                            [_vModelText, model.paths.gptWeightsPath]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_182, [\n                                                        _cache[182] || (_cache[182] = _createElementVNode(\"label\", null, \"SoVITS \", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((model.paths.sovitsWeightsPath) = $event),\n                                                            placeholder: \"SoVITS_weights/xxx.pth\"\n                                                        }, null, 8 /* PROPS */, _hoisted_183), [\n                                                            [_vModelText, model.paths.sovitsWeightsPath]\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_184, [\n                                                    _createElementVNode(\"div\", _hoisted_185, [\n                                                        _cache[184] || (_cache[184] = _createElementVNode(\"label\", null, \" ID\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"select\", {\n                                                            \"onUpdate:modelValue\": ($event) => ((model.defaultRefId) = $event)\n                                                        }, [\n                                                            _cache[183] || (_cache[183] = _createElementVNode(\"option\", { value: \"\" }, \"\", -1 /* CACHED */)),\n                                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(model.refAudios, (refAudio) => {\n                                                                return (_openBlock(), _createElementBlock(\"option\", {\n                                                                    key: refAudio.id,\n                                                                    value: refAudio.id\n                                                                }, _toDisplayString(refAudio.id) + \"\" + _toDisplayString(refAudio.name || '') + \" \", 9 /* TEXT, PROPS */, _hoisted_187));\n                                                            }), 128 /* KEYED_FRAGMENT */))\n                                                        ], 8 /* PROPS */, _hoisted_186), [\n                                                            [_vModelSelect, model.defaultRefId]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_188, [\n                                                        _cache[185] || (_cache[185] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((model.paths.defaultRefAudioPath) = $event),\n                                                            placeholder: \"wavs/xxx.wav\"\n                                                        }, null, 8 /* PROPS */, _hoisted_189), [\n                                                            [_vModelText, model.paths.defaultRefAudioPath]\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_190, \"  \" + _toDisplayString(model.refAudios.length) + \"  \" + _toDisplayString(Object.keys(model.expressionRefMap || {}).length) + \"  \", 1 /* TEXT */),\n                                                _createElementVNode(\"div\", _hoisted_191, [\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-secondary\",\n                                                        type: \"button\",\n                                                        onClick: ($event) => (openGptModelEditor(model.id))\n                                                    }, \" / \", 8 /* PROPS */, _hoisted_192),\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-secondary\",\n                                                        type: \"button\",\n                                                        onClick: ($event) => (setGptModelManagerDefaultSpeaker(model))\n                                                    }, \"  \", 8 /* PROPS */, _hoisted_193),\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-test\",\n                                                        type: \"button\",\n                                                        onClick: ($event) => (testGptModelManagerModel(model.id))\n                                                    }, \"  \", 8 /* PROPS */, _hoisted_194),\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-secondary\",\n                                                        type: \"button\",\n                                                        onClick: ($event) => (duplicateGptModelManagerModel(model.id))\n                                                    }, \"\", 8 /* PROPS */, _hoisted_195),\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-secondary\",\n                                                        type: \"button\",\n                                                        onClick: ($event) => (removeGptModelManagerModel(model.id))\n                                                    }, \"\", 8 /* PROPS */, _hoisted_196)\n                                                ])\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ]))\n                            ]),\n                            _createElementVNode(\"div\", { class: \"panel-footer\" }, [\n                                _createElementVNode(\"button\", {\n                                    class: \"btn btn-secondary\",\n                                    type: \"button\",\n                                    onClick: closeGptModelManager\n                                }, \"\"),\n                                _createElementVNode(\"button\", {\n                                    class: \"btn btn-secondary\",\n                                    type: \"button\",\n                                    onClick: saveGptModelManager\n                                }, \"\"),\n                                _createElementVNode(\"button\", {\n                                    class: \"btn btn-primary\",\n                                    type: \"button\",\n                                    onClick: saveGptModelManagerAndClose\n                                }, \"\")\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (showGptModelEditor.value && gptModelEditor.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 2,\n                        class: \"browser-overlay dp-browser-overlay gpt-model-overlay\",\n                        style: overlayFallbackStyle,\n                        onClick: _withModifiers(closeGptModelEditor, [\"self\"])\n                    }, [\n                        _createElementVNode(\"div\", {\n                            class: \"browser-dialog dp-browser-dialog gpt-model-editor-dialog\",\n                            style: panelFallbackStyle\n                        }, [\n                            _createElementVNode(\"div\", _hoisted_197, [\n                                _createElementVNode(\"h3\", null, \"\" + _toDisplayString(gptModelEditor.value.name || gptModelEditor.value.id), 1 /* TEXT */),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-btn\",\n                                    type: \"button\",\n                                    onClick: closeGptModelEditor\n                                }, \"X\")\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_198, [\n                                _createElementVNode(\"div\", _hoisted_199, [\n                                    _createElementVNode(\"div\", _hoisted_200, [\n                                        _cache[186] || (_cache[186] = _createElementVNode(\"label\", null, \"ID\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[61] || (_cache[61] = ($event) => ((gptModelEditor.value.id) = $event)),\n                                            placeholder: \"model_xxx\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.id]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_201, [\n                                        _createElementVNode(\"label\", null, [\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"checkbox\",\n                                                \"onUpdate:modelValue\": _cache[62] || (_cache[62] = ($event) => ((gptModelEditor.value.enabled) = $event))\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [_vModelCheckbox, gptModelEditor.value.enabled]\n                                            ]),\n                                            _cache[187] || (_cache[187] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                        ])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_202, [\n                                    _createElementVNode(\"div\", _hoisted_203, [\n                                        _cache[188] || (_cache[188] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[63] || (_cache[63] = ($event) => ((gptModelEditor.value.name) = $event)),\n                                            placeholder: \"\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.name]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_204, [\n                                        _cache[189] || (_cache[189] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[64] || (_cache[64] = ($event) => ((gptModelEditor.value.desc) = $event)),\n                                            placeholder: \"\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.desc]\n                                        ])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_205, [\n                                    _createElementVNode(\"div\", _hoisted_206, [\n                                        _cache[190] || (_cache[190] = _createElementVNode(\"label\", null, \"GPT \", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[65] || (_cache[65] = ($event) => ((gptModelEditor.value.paths.gptWeightsPath) = $event)),\n                                            placeholder: \"GPT_weights/xxx.ckpt\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.paths.gptWeightsPath]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_207, [\n                                        _cache[191] || (_cache[191] = _createElementVNode(\"label\", null, \"SoVITS \", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[66] || (_cache[66] = ($event) => ((gptModelEditor.value.paths.sovitsWeightsPath) = $event)),\n                                            placeholder: \"SoVITS_weights/xxx.pth\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.paths.sovitsWeightsPath]\n                                        ])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_208, [\n                                    _createElementVNode(\"div\", _hoisted_209, [\n                                        _cache[192] || (_cache[192] = _createElementVNode(\"label\", null, \"prompt_text\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[67] || (_cache[67] = ($event) => ((gptModelEditor.value.params.promptText) = $event)),\n                                            placeholder: \"\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.params.promptText]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_210, [\n                                        _cache[193] || (_cache[193] = _createElementVNode(\"label\", null, \"prompt_lang\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[68] || (_cache[68] = ($event) => ((gptModelEditor.value.params.promptLang) = $event)),\n                                            placeholder: \"zh\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.params.promptLang]\n                                        ])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_211, [\n                                    _createElementVNode(\"div\", _hoisted_212, [\n                                        _cache[194] || (_cache[194] = _createElementVNode(\"label\", null, \"text_lang\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[69] || (_cache[69] = ($event) => ((gptModelEditor.value.params.textLang) = $event)),\n                                            placeholder: \"auto/zh/en/ja...\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.params.textLang]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_213, [\n                                        _cache[195] || (_cache[195] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[70] || (_cache[70] = ($event) => ((gptModelEditor.value.params.textSplitMethod) = $event)),\n                                            placeholder: \"cut5\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.params.textSplitMethod]\n                                        ])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_214, [\n                                    _createElementVNode(\"div\", _hoisted_215, [\n                                        _cache[196] || (_cache[196] = _createElementVNode(\"label\", null, \"speed_factor\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"number\",\n                                            \"onUpdate:modelValue\": _cache[71] || (_cache[71] = ($event) => ((gptModelEditor.value.params.speedFactor) = $event)),\n                                            min: \"0.5\",\n                                            max: \"2\",\n                                            step: \"0.05\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [\n                                                _vModelText,\n                                                gptModelEditor.value.params.speedFactor,\n                                                void 0,\n                                                { number: true }\n                                            ]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_216, [\n                                        _cache[198] || (_cache[198] = _createElementVNode(\"label\", null, \"media_type\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"select\", {\n                                            \"onUpdate:modelValue\": _cache[72] || (_cache[72] = ($event) => ((gptModelEditor.value.params.mediaType) = $event))\n                                        }, [...(_cache[197] || (_cache[197] = [\n                                                _createElementVNode(\"option\", { value: \"wav\" }, \"wav\", -1 /* CACHED */),\n                                                _createElementVNode(\"option\", { value: \"ogg\" }, \"ogg\", -1 /* CACHED */),\n                                                _createElementVNode(\"option\", { value: \"raw\" }, \"raw\", -1 /* CACHED */)\n                                            ]))], 512 /* NEED_PATCH */), [\n                                            [_vModelSelect, gptModelEditor.value.params.mediaType]\n                                        ])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_217, [\n                                    _createElementVNode(\"div\", _hoisted_218, [\n                                        _createElementVNode(\"label\", null, [\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"checkbox\",\n                                                \"onUpdate:modelValue\": _cache[73] || (_cache[73] = ($event) => ((gptModelEditor.value.params.streamingMode) = $event))\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [_vModelCheckbox, gptModelEditor.value.params.streamingMode]\n                                            ]),\n                                            _cache[199] || (_cache[199] = _createTextVNode(\" streaming_mode \", -1 /* CACHED */))\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_219, [\n                                        _createElementVNode(\"label\", null, [\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"checkbox\",\n                                                \"onUpdate:modelValue\": _cache[74] || (_cache[74] = ($event) => ((gptModelEditor.value.params.strictWeightSwitch) = $event))\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [_vModelCheckbox, gptModelEditor.value.params.strictWeightSwitch]\n                                            ]),\n                                            _cache[200] || (_cache[200] = _createTextVNode(\" strictWeightSwitch \", -1 /* CACHED */))\n                                        ])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_220, [\n                                    _createElementVNode(\"div\", _hoisted_221, [\n                                        _cache[202] || (_cache[202] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"select\", {\n                                            \"onUpdate:modelValue\": _cache[75] || (_cache[75] = ($event) => ((gptModelEditor.value.params.modelSwitchMode) = $event))\n                                        }, [...(_cache[201] || (_cache[201] = [\n                                                _createElementVNode(\"option\", { value: \"set_weights\" }, \"set_weights\", -1 /* CACHED */),\n                                                _createElementVNode(\"option\", { value: \"set_model\" }, \"set_model\", -1 /* CACHED */),\n                                                _createElementVNode(\"option\", { value: \"none\" }, \"none\", -1 /* CACHED */)\n                                            ]))], 512 /* NEED_PATCH */), [\n                                            [_vModelSelect, gptModelEditor.value.params.modelSwitchMode]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_222, [\n                                        _cache[203] || (_cache[203] = _createElementVNode(\"label\", null, \"set_model endpoint\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[76] || (_cache[76] = ($event) => ((gptModelEditor.value.params.setModelEndpoint) = $event)),\n                                            placeholder: \"/set_model\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.params.setModelEndpoint]\n                                        ])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_223, [\n                                    _cache[210] || (_cache[210] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_224, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(gptModelEditor.value.refAudios, (refAudio, refIndex) => {\n                                            return (_openBlock(), _createElementBlock(\"div\", {\n                                                key: `${refAudio.id || 'ref'}_${refIndex}`,\n                                                class: \"gpt-ref-item\"\n                                            }, [\n                                                _createElementVNode(\"div\", _hoisted_225, [\n                                                    _createElementVNode(\"div\", _hoisted_226, [\n                                                        _cache[204] || (_cache[204] = _createElementVNode(\"label\", null, \"ID\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((refAudio.id) = $event),\n                                                            placeholder: \"ref_1\"\n                                                        }, null, 8 /* PROPS */, _hoisted_227), [\n                                                            [_vModelText, refAudio.id]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_228, [\n                                                        _cache[205] || (_cache[205] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((refAudio.name) = $event),\n                                                            placeholder: \"\"\n                                                        }, null, 8 /* PROPS */, _hoisted_229), [\n                                                            [_vModelText, refAudio.name]\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_230, [\n                                                    _cache[206] || (_cache[206] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"input\", {\n                                                        type: \"text\",\n                                                        \"onUpdate:modelValue\": ($event) => ((refAudio.path) = $event),\n                                                        placeholder: \"wavs/xxx.wav\"\n                                                    }, null, 8 /* PROPS */, _hoisted_231), [\n                                                        [_vModelText, refAudio.path]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_232, [\n                                                    _createElementVNode(\"div\", _hoisted_233, [\n                                                        _cache[207] || (_cache[207] = _createElementVNode(\"label\", null, \"prompt_text\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((refAudio.promptText) = $event),\n                                                            placeholder: \"\"\n                                                        }, null, 8 /* PROPS */, _hoisted_234), [\n                                                            [_vModelText, refAudio.promptText]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_235, [\n                                                        _cache[208] || (_cache[208] = _createElementVNode(\"label\", null, \"prompt_lang\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((refAudio.promptLang) = $event),\n                                                            placeholder: \"zh\"\n                                                        }, null, 8 /* PROPS */, _hoisted_236), [\n                                                            [_vModelText, refAudio.promptLang]\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_237, [\n                                                    _createElementVNode(\"div\", _hoisted_238, [\n                                                        _cache[209] || (_cache[209] = _createElementVNode(\"label\", null, \"text_lang\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((refAudio.textLang) = $event),\n                                                            placeholder: \"zh\"\n                                                        }, null, 8 /* PROPS */, _hoisted_239), [\n                                                            [_vModelText, refAudio.textLang]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_240, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: ($event) => (setGptModelEditorDefaultRef(refAudio.id))\n                                                        }, \"  \", 8 /* PROPS */, _hoisted_241),\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: ($event) => (removeGptModelEditorRefAudio(refIndex))\n                                                        }, \"  \", 8 /* PROPS */, _hoisted_242)\n                                                    ])\n                                                ])\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ]),\n                                    _createElementVNode(\"button\", {\n                                        class: \"btn btn-secondary\",\n                                        type: \"button\",\n                                        onClick: addGptModelEditorRefAudio\n                                    }, \"\")\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_243, [\n                                    _cache[212] || (_cache[212] = _createElementVNode(\"label\", null, \" -> ID\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_244, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(gptModelEditorExpressionRows.value, (row, rowIndex) => {\n                                            return (_openBlock(), _createElementBlock(\"div\", {\n                                                key: `expr_map_${rowIndex}`,\n                                                class: \"gpt-expression-map-row\"\n                                            }, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"text\",\n                                                    \"onUpdate:modelValue\": ($event) => ((row.expression) = $event),\n                                                    placeholder: \"\"\n                                                }, null, 8 /* PROPS */, _hoisted_245), [\n                                                    [_vModelText, row.expression]\n                                                ]),\n                                                _withDirectives(_createElementVNode(\"select\", {\n                                                    \"onUpdate:modelValue\": ($event) => ((row.refId) = $event)\n                                                }, [\n                                                    _cache[211] || (_cache[211] = _createElementVNode(\"option\", { value: \"\" }, \"\", -1 /* CACHED */)),\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(gptModelEditor.value.refAudios, (refAudio) => {\n                                                        return (_openBlock(), _createElementBlock(\"option\", {\n                                                            key: refAudio.id,\n                                                            value: refAudio.id\n                                                        }, _toDisplayString(refAudio.id) + \"\" + _toDisplayString(refAudio.name || '') + \" \", 9 /* TEXT, PROPS */, _hoisted_247));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ], 8 /* PROPS */, _hoisted_246), [\n                                                    [_vModelSelect, row.refId]\n                                                ]),\n                                                _createElementVNode(\"button\", {\n                                                    class: \"btn btn-secondary\",\n                                                    type: \"button\",\n                                                    onClick: ($event) => (removeGptModelEditorExpressionRow(rowIndex))\n                                                }, \"  \", 8 /* PROPS */, _hoisted_248)\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ]),\n                                    _createElementVNode(\"button\", {\n                                        class: \"btn btn-secondary\",\n                                        type: \"button\",\n                                        onClick: addGptModelEditorExpressionRow\n                                    }, \"\")\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", { class: \"panel-footer\" }, [\n                                _createElementVNode(\"button\", {\n                                    class: \"btn btn-secondary\",\n                                    type: \"button\",\n                                    onClick: closeGptModelEditor\n                                }, \"\"),\n                                _createElementVNode(\"button\", {\n                                    class: \"btn btn-primary\",\n                                    type: \"button\",\n                                    onClick: saveGptModelEditor\n                                }, \"\")\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (showBrowser.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 3,\n                        class: \"browser-overlay dp-browser-overlay\",\n                        style: overlayFallbackStyle,\n                        onClick: _cache[79] || (_cache[79] = _withModifiers(($event) => (showBrowser.value = false), [\"self\"]))\n                    }, [\n                        _createElementVNode(\"div\", {\n                            class: \"browser-dialog dp-browser-dialog\",\n                            style: panelFallbackStyle\n                        }, [\n                            _createElementVNode(\"div\", _hoisted_249, [\n                                _cache[213] || (_cache[213] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-btn\",\n                                    type: \"button\",\n                                    onClick: _cache[77] || (_cache[77] = ($event) => (showBrowser.value = false))\n                                }, \"X\")\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_250, [\n                                _createVNode(ModelBrowser, {\n                                    \"use-cdn\": _unref(settings).useCdn,\n                                    onCancel: _cache[78] || (_cache[78] = ($event) => (showBrowser.value = false)),\n                                    onLoadModel: onBrowserLoad\n                                }, null, 8 /* PROPS */, [\"use-cdn\"])\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SettingsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SettingsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SettingsPanel.vue?vue&type=style&index=0&id=64a4f085&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-64a4f085\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createVNode as _createVNode, createElementVNode as _createElementVNode, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"browser-dialog\" };\nconst _hoisted_2 = { class: \"browser-dialog-header\" };\nconst _hoisted_3 = { class: \"browser-dialog-body\" };\nimport { storeToRefs } from 'pinia';\nimport { onMounted, onUnmounted, ref, watch } from 'vue';\nimport { getTTSEnabled } from '../audio/tts-config';\nimport { TTSManager } from '../audio/tts-manager';\nimport { splitZhJaForDisplayAndTts } from '../chat/bilingual-text';\nimport { Commentator } from '../chat/commentator';\nimport { parseEmotionCotText } from '../chat/emotion-cot';\nimport { ChatMonitor } from '../chat/monitor';\nimport { DEFAULTS, LOCAL_LIVE2D_MODEL_PATH_PREFIX } from '../core/constants';\nimport { getEmotionConfigByTag } from '../core/emotion';\nimport { useSettingsStore } from '../core/settings';\nimport { useUiStore } from '../core/ui';\nimport { hasLive2DModel } from '../db/live2d-models';\nimport { Live2DManager } from '../live2d/manager';\nimport { resolveLive2DExpression, resolveLive2DMotion } from '../live2d/expression-motion';\nimport { LipSyncManager, setLipSyncRefs } from '../live2d/lip-sync';\nimport { Live2DStage } from '../live2d/stage';\nimport { error as logError, log } from '../utils/dom';\nimport ChatBubble from './ChatBubble.vue';\nimport FunctionMenu from './FunctionMenu.vue';\nimport ModelBrowser from './ModelBrowser.vue';\nimport SettingsPanel from './SettingsPanel.vue';\nconst BASE_STAGE_WIDTH = 280;\nconst BASE_STAGE_HEIGHT = 360;\nconst OPEN_SETTINGS_FN_KEY = '__desktopPetOpenSettings_v2';\nconst PHONE_TTS_SEEN_MAX = 4000;\nconst BAIBAI_ASSISTANT_SEEN_MAX = 2000;\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'PetContainer',\n    setup(__props) {\n        const store = useSettingsStore();\n        const { settings } = storeToRefs(store);\n        const uiStore = useUiStore();\n        const { showSettings } = storeToRefs(uiStore);\n        const bubbleText = ref('');\n        const bubbleDone = ref(true);\n        let globalOpenSettingsFn = null;\n        let modelLoadTaskId = 0;\n        let initTaskId = 0;\n        let modelLoadingHideTimer = null;\n        let statusCheckTimer = null;\n        let viewportResizeSyncTimer = null;\n        let boundWindowResizeHandler = null;\n        let boundVisualViewportResizeHandler = null;\n        let gazeFollowBound = false;\n        let gazePointerMoveHandler = null;\n        let gazePointerDownHandler = null;\n        let gazeFollowRafId = null;\n        let gazePendingPoint = null;\n        let petClosed = false;\n        const showMenu = ref(false);\n        const menuAnchor = ref({ x: 0, y: 0 });\n        const menuPlacement = ref('left');\n        const showModelBrowser = ref(false);\n        let phoneTtsBridgeBound = false;\n        let phoneMessageReceivedHandler = null;\n        let phoneAIGenCompleteHandler = null;\n        let phoneTtsListenSinceSec = 0;\n        const phoneSeenMessageKeys = new Set();\n        const phoneSeenMessageOrder = [];\n        const phoneTtsQueue = [];\n        let phoneTtsQueueRunning = false;\n        let baibaiPhoneTtsBridgeBound = false;\n        let baibaiPhonePollTimer = null;\n        const baibaiEventStops = [];\n        const baibaiSeenAssistantIds = new Set();\n        const baibaiSeenAssistantOrder = [];\n        function getTopWindow() {\n            try {\n                return window.parent ?? window;\n            }\n            catch {\n                return window;\n            }\n        }\n        function getCurrentCharacterId() {\n            try {\n                const ctx = SillyTavern?.getContext?.();\n                if (ctx?.characterId !== undefined && ctx?.characterId !== null) {\n                    return String(ctx.characterId);\n                }\n            }\n            catch {\n                // ignore\n            }\n            return 'default';\n        }\n        function getPhoneStore() {\n            try {\n                const topAny = getTopWindow();\n                const store = topAny?.extension_settings?.acsusPawsPuffs?.phone;\n                if (store && typeof store === 'object')\n                    return store;\n            }\n            catch {\n                // ignore\n            }\n            try {\n                const localAny = window;\n                const store = localAny?.extension_settings?.acsusPawsPuffs?.phone;\n                if (store && typeof store === 'object')\n                    return store;\n            }\n            catch {\n                // ignore\n            }\n            return null;\n        }\n        function getPhoneContactName(source, contactId) {\n            const safeId = String(contactId || '').trim();\n            const fallback = safeId.replace(/^chat_/, '').replace(/^tavern_/, '').trim() || '';\n            if (source === 'baibai')\n                return fallback;\n            const store = getPhoneStore();\n            const contacts = Array.isArray(store?.contacts) ? store.contacts : [];\n            const matched = contacts.find((item) => String(item?.id || '').trim() === safeId);\n            const name = String(matched?.name || '').trim();\n            return name || fallback;\n        }\n        function getPhoneChatHistory(contactId) {\n            const store = getPhoneStore();\n            const key = `chat_${String(contactId || '').trim()}`;\n            const history = store?.chats?.[key];\n            return Array.isArray(history) ? history : [];\n        }\n        function isNonUserPhoneMessage(message) {\n            const sender = String(message?.sender || '')\n                .trim()\n                .toLowerCase();\n            const type = String(message?.type || 'text')\n                .trim()\n                .toLowerCase();\n            return sender === 'contact' && type === 'text';\n        }\n        function sanitizePhoneSpeakText(value) {\n            return String(value ?? '')\n                .replace(/\\s+/g, ' ')\n                .trim();\n        }\n        function isPhoneAutoReadEnabled(source) {\n            if (source === 'baibai') {\n                return settings.value.baibaiPhoneMessageAutoRead === true;\n            }\n            return settings.value.phoneMessageAutoRead !== false;\n        }\n        function getNormalizedUserNames() {\n            const names = new Set();\n            const append = (value) => {\n                const normalized = sanitizePhoneSpeakText(value).toLowerCase();\n                if (normalized)\n                    names.add(normalized);\n            };\n            try {\n                append(SillyTavern?.name1);\n            }\n            catch {\n                // ignore\n            }\n            try {\n                const ctx = SillyTavern?.getContext?.();\n                append(ctx?.name1);\n                append(ctx?.userName);\n            }\n            catch {\n                // ignore\n            }\n            append('user');\n            return names;\n        }\n        function isBaibaiUserSender(senderName) {\n            const sender = sanitizePhoneSpeakText(senderName).toLowerCase();\n            if (!sender)\n                return false;\n            return getNormalizedUserNames().has(sender);\n        }\n        function sanitizeAssistantPhoneCommandText(value) {\n            return String(value ?? '')\n                .replace(/<think[ing]*?>[\\s\\S]*?<\\/think[ing]*?>/gi, '')\n                .replace(/<!--[\\s\\S]*?-->/g, '')\n                .trim();\n        }\n        function hasBaibaiPhoneCommand(value) {\n            return /\\bqq\\.(?:private|group)\\s*\\(/i.test(String(value ?? ''));\n        }\n        function parseBaibaiCommandArgs(rawArgs) {\n            const source = String(rawArgs || '').trim();\n            if (!source)\n                return [];\n            const quotedArgs = [];\n            const quotedMatcher = /'([^']*)'|\"([^\"]*)\"/g;\n            for (const match of source.matchAll(quotedMatcher)) {\n                const value = sanitizePhoneSpeakText(match[1] ?? match[2] ?? '');\n                quotedArgs.push(value);\n            }\n            if (quotedArgs.length > 0)\n                return quotedArgs;\n            return source\n                .split(',')\n                .map((item) => sanitizePhoneSpeakText(item))\n                .filter((item) => !!item);\n        }\n        function extractBaibaiTextPayloads(rawPayload) {\n            const payload = String(rawPayload ?? '');\n            if (!payload)\n                return [];\n            const marker = payload.match(/\\[(.+?)-(.+?)\\]/);\n            if (!marker) {\n                const text = sanitizePhoneSpeakText(payload);\n                return text ? [text] : [];\n            }\n            const markerType = sanitizePhoneSpeakText(marker[1]).toLowerCase();\n            if (markerType === 'bqb' || markerType === 'img') {\n                const text = sanitizePhoneSpeakText(payload.replace(marker[0], ''));\n                return text ? [text] : [];\n            }\n            return [];\n        }\n        function extractPhoneSpeakText(message) {\n            const type = String(message?.type || 'text')\n                .trim()\n                .toLowerCase();\n            switch (type) {\n                case 'text': {\n                    let text = sanitizePhoneSpeakText(message.content);\n                    text = text.replace(/^\\[(?:|||)?\\]/, '').trim();\n                    return text;\n                }\n                case 'quote':\n                    return sanitizePhoneSpeakText(message.replyContent || message.content || '');\n                case 'emoji':\n                    return sanitizePhoneSpeakText(` ${message.content || ''}`);\n                case 'image':\n                case 'image-real':\n                case 'image-fake': {\n                    const desc = sanitizePhoneSpeakText(message.description || message.content || '');\n                    return desc ? `${desc}` : '';\n                }\n                case 'redpacket':\n                    return ` ${sanitizePhoneSpeakText(message.amount || 0)} `;\n                case 'transfer': {\n                    const amount = sanitizePhoneSpeakText(message.amount || 0);\n                    const note = sanitizePhoneSpeakText(message.message || message.content || '');\n                    return note ? ` ${amount}  ${note}` : ` ${amount} `;\n                }\n                case 'video':\n                    return sanitizePhoneSpeakText(` ${message.description || ''}`) || '';\n                case 'file':\n                    return sanitizePhoneSpeakText(` ${message.filename || ''}`) || '';\n                case 'poke':\n                    return '';\n                case 'recalled':\n                case 'recalled-pending':\n                    return '';\n                case 'friend_request':\n                case 'friend_added':\n                case 'friend_deleted':\n                    return sanitizePhoneSpeakText(message.content || '');\n                case 'gift-membership':\n                case 'buy-membership': {\n                    const months = sanitizePhoneSpeakText(message.months || '');\n                    const memberType = String(message.membershipType || '').toUpperCase() || '';\n                    return sanitizePhoneSpeakText(`${months ? `${months}` : ''}${memberType}`);\n                }\n                default:\n                    return sanitizePhoneSpeakText(message.content || message.description || '');\n            }\n        }\n        function getPhoneMessageKey(source, contactId, message) {\n            const safeContact = String(contactId || '').trim();\n            const messageId = sanitizePhoneSpeakText(message?.id);\n            if (messageId)\n                return `${source}:${safeContact}:${messageId}`;\n            const sender = sanitizePhoneSpeakText(message?.sender).toLowerCase() || 'unknown';\n            const type = sanitizePhoneSpeakText(message?.type).toLowerCase() || 'text';\n            const time = Number(message?.time || 0);\n            const content = sanitizePhoneSpeakText(message?.content || message?.replyContent || message?.description || message?.filename || '').slice(0, 72);\n            return `${source}:${safeContact}:${sender}:${type}:${time}:${content}`;\n        }\n        function rememberPhoneMessageKey(key) {\n            if (!key || phoneSeenMessageKeys.has(key))\n                return;\n            phoneSeenMessageKeys.add(key);\n            phoneSeenMessageOrder.push(key);\n            if (phoneSeenMessageOrder.length <= PHONE_TTS_SEEN_MAX)\n                return;\n            const stale = phoneSeenMessageOrder.shift();\n            if (stale) {\n                phoneSeenMessageKeys.delete(stale);\n            }\n        }\n        function markExistingPhoneMessagesAsSeen() {\n            const store = getPhoneStore();\n            const chats = store?.chats;\n            if (!chats || typeof chats !== 'object')\n                return;\n            for (const [chatKey, list] of Object.entries(chats)) {\n                if (!Array.isArray(list))\n                    continue;\n                const contactId = String(chatKey || '')\n                    .replace(/^chat_/, '')\n                    .trim();\n                if (!contactId)\n                    continue;\n                for (const raw of list) {\n                    const message = raw;\n                    if (!isNonUserPhoneMessage(message))\n                        continue;\n                    rememberPhoneMessageKey(getPhoneMessageKey('acsus', contactId, message));\n                }\n            }\n        }\n        function resolveTavernEventName(eventKey) {\n            try {\n                const top = getTopWindow();\n                const fromTop = top?.SillyTavern?.eventTypes?.[eventKey];\n                if (fromTop)\n                    return String(fromTop);\n            }\n            catch {\n                // ignore\n            }\n            try {\n                const fromLegacy = tavern_events?.[eventKey];\n                if (fromLegacy)\n                    return String(fromLegacy);\n            }\n            catch {\n                // ignore\n            }\n            return null;\n        }\n        function bindTavernEvent(eventKey, handler) {\n            const eventName = resolveTavernEventName(eventKey);\n            if (!eventName)\n                return null;\n            try {\n                const top = getTopWindow();\n                const eventSource = top?.SillyTavern?.eventSource;\n                if (eventSource && typeof eventSource.on === 'function') {\n                    eventSource.on(eventName, handler);\n                    return {\n                        stop: () => {\n                            try {\n                                if (typeof eventSource.off === 'function') {\n                                    eventSource.off(eventName, handler);\n                                }\n                                else if (typeof eventSource.removeListener === 'function') {\n                                    eventSource.removeListener(eventName, handler);\n                                }\n                            }\n                            catch {\n                                // ignore\n                            }\n                        },\n                    };\n                }\n            }\n            catch {\n                // ignore\n            }\n            if (typeof eventOn === 'function') {\n                return eventOn(eventName, handler);\n            }\n            return null;\n        }\n        function resetBaibaiAssistantSeenState() {\n            baibaiSeenAssistantIds.clear();\n            baibaiSeenAssistantOrder.length = 0;\n        }\n        function rememberBaibaiAssistantMessageId(messageId) {\n            if (!Number.isFinite(messageId))\n                return;\n            if (baibaiSeenAssistantIds.has(messageId))\n                return;\n            baibaiSeenAssistantIds.add(messageId);\n            baibaiSeenAssistantOrder.push(messageId);\n            if (baibaiSeenAssistantOrder.length <= BAIBAI_ASSISTANT_SEEN_MAX)\n                return;\n            const stale = baibaiSeenAssistantOrder.shift();\n            if (typeof stale === 'number') {\n                baibaiSeenAssistantIds.delete(stale);\n            }\n        }\n        function getAssistantChatMessages() {\n            try {\n                const messages = getChatMessages(`0-{{lastMessageId}}`, {\n                    role: 'assistant',\n                    hide_state: 'unhidden',\n                });\n                return Array.isArray(messages) ? messages : [];\n            }\n            catch {\n                return [];\n            }\n        }\n        function parseBaibaiPhoneMessagesFromAssistant(message) {\n            const normalizedText = sanitizeAssistantPhoneCommandText(message?.message);\n            if (!normalizedText || !hasBaibaiPhoneCommand(normalizedText))\n                return [];\n            const assistantMessageId = Number(message?.message_id);\n            const parsed = [];\n            const commandMatches = normalizedText.matchAll(/([a-zA-Z]+\\.[a-zA-Z]+)\\(([\\s\\S]*?)\\);/g);\n            let commandIndex = 0;\n            for (const match of commandMatches) {\n                commandIndex++;\n                const commandName = String(match[1] || '')\n                    .trim()\n                    .toLowerCase();\n                if (commandName !== 'qq.private' && commandName !== 'qq.group')\n                    continue;\n                const args = parseBaibaiCommandArgs(String(match[2] || ''));\n                if (args.length < 4)\n                    continue;\n                const contactId = sanitizePhoneSpeakText(args[0]) || '';\n                const senderName = sanitizePhoneSpeakText(args[1]);\n                if (!senderName || isBaibaiUserSender(senderName))\n                    continue;\n                const textPayloads = extractBaibaiTextPayloads(args[2]);\n                if (textPayloads.length === 0)\n                    continue;\n                const rawTime = sanitizePhoneSpeakText(args[3]);\n                const messageIdPart = Number.isFinite(assistantMessageId) ? String(assistantMessageId) : 'unknown';\n                textPayloads.forEach((text, index) => {\n                    const speakText = sanitizePhoneSpeakText(text);\n                    if (!speakText)\n                        return;\n                    parsed.push({\n                        contactId,\n                        message: {\n                            id: `baibai_${messageIdPart}_${commandIndex}_${index}`,\n                            sender: 'contact',\n                            type: 'text',\n                            content: speakText,\n                            time: rawTime || messageIdPart,\n                        },\n                    });\n                });\n            }\n            return parsed;\n        }\n        function markExistingBaibaiMessagesAsSeen() {\n            const messages = getAssistantChatMessages();\n            for (const item of messages) {\n                const messageId = Number(item?.message_id);\n                if (!Number.isFinite(messageId) || messageId < 0)\n                    continue;\n                rememberBaibaiAssistantMessageId(messageId);\n            }\n        }\n        function collectUnsyncedBaibaiMessages() {\n            const messages = getAssistantChatMessages();\n            if (messages.length === 0)\n                return;\n            for (const item of messages) {\n                const messageId = Number(item?.message_id);\n                if (!Number.isFinite(messageId) || messageId < 0)\n                    continue;\n                if (baibaiSeenAssistantIds.has(messageId))\n                    continue;\n                rememberBaibaiAssistantMessageId(messageId);\n                const parsedMessages = parseBaibaiPhoneMessagesFromAssistant(item);\n                for (const parsed of parsedMessages) {\n                    enqueuePhoneMessageForTTS(parsed.contactId, parsed.message, 'baibai');\n                }\n            }\n        }\n        async function waitForTTSIdle(timeoutMs = 45000) {\n            const startAt = Date.now();\n            while (TTSManager.isLoading || TTSManager.isPlaying) {\n                if (Date.now() - startAt > timeoutMs) {\n                    TTSManager.stop();\n                    return;\n                }\n                await new Promise((resolve) => {\n                    window.setTimeout(resolve, 120);\n                });\n            }\n        }\n        async function drainPhoneTTSQueue() {\n            if (phoneTtsQueueRunning)\n                return;\n            phoneTtsQueueRunning = true;\n            try {\n                while (phoneTtsQueue.length > 0) {\n                    const next = phoneTtsQueue.shift();\n                    if (!next)\n                        continue;\n                    const ttsEnabled = getTTSEnabled();\n                    const autoPlay = !!settings.value.ttsAutoPlay;\n                    const phoneAutoRead = isPhoneAutoReadEnabled(next.source);\n                    if (!ttsEnabled || !autoPlay || !phoneAutoRead)\n                        continue;\n                    const speakText = extractPhoneSpeakText(next.message);\n                    if (!speakText)\n                        continue;\n                    const contactName = getPhoneContactName(next.source, next.contactId);\n                    const speaker = getCurrentCharacterId();\n                    const voiceName = String(settings.value.ttsDefaultSpeaker || '').trim();\n                    const ttsOverrides = {};\n                    if (voiceName)\n                        ttsOverrides.speaker = voiceName;\n                    const contextPrefix = next.source === 'baibai' ? '' : '';\n                    ttsOverrides.context = `${contextPrefix}${contactName}`;\n                    await waitForTTSIdle(45000);\n                    await TTSManager.speak({\n                        type: 'dialogue',\n                        speaker,\n                        text: speakText,\n                        tts: ttsOverrides,\n                    }, `desktop_pet_phone_${next.source}_${next.contactId}_${Date.now()}`);\n                }\n            }\n            catch (e) {\n                logError('', e);\n            }\n            finally {\n                phoneTtsQueueRunning = false;\n            }\n        }\n        function enqueuePhoneMessageForTTS(contactId, message, source = 'acsus') {\n            if (!message)\n                return;\n            if (!isNonUserPhoneMessage(message))\n                return;\n            const key = getPhoneMessageKey(source, contactId, message);\n            if (phoneSeenMessageKeys.has(key))\n                return;\n            rememberPhoneMessageKey(key);\n            const messageSec = Number(message.time || 0);\n            if (source === 'acsus' &&\n                Number.isFinite(messageSec) &&\n                messageSec > 0 &&\n                phoneTtsListenSinceSec > 0 &&\n                messageSec + 2 < phoneTtsListenSinceSec) {\n                return;\n            }\n            if (!isPhoneAutoReadEnabled(source)) {\n                return;\n            }\n            phoneTtsQueue.push({ source, contactId, message });\n            void drainPhoneTTSQueue();\n        }\n        function collectUnsyncedPhoneMessages(contactId) {\n            const history = getPhoneChatHistory(contactId);\n            if (history.length === 0)\n                return;\n            const pending = [];\n            for (let i = history.length - 1; i >= 0; i--) {\n                const message = history[i];\n                if (!isNonUserPhoneMessage(message))\n                    continue;\n                const key = getPhoneMessageKey('acsus', contactId, message);\n                if (phoneSeenMessageKeys.has(key)) {\n                    break;\n                }\n                pending.push(message);\n            }\n            pending.reverse().forEach((message) => {\n                enqueuePhoneMessageForTTS(contactId, message);\n            });\n        }\n        function bindPhoneTTSBridge() {\n            if (phoneTtsBridgeBound)\n                return;\n            phoneTtsListenSinceSec = Math.floor(Date.now() / 1000);\n            markExistingPhoneMessagesAsSeen();\n            const top = getTopWindow();\n            const topDoc = top.document ?? document;\n            phoneMessageReceivedHandler = (event) => {\n                const detail = event.detail || {};\n                const contactId = String(detail.contactId || '').trim();\n                if (!contactId)\n                    return;\n                enqueuePhoneMessageForTTS(contactId, detail.message);\n            };\n            phoneAIGenCompleteHandler = (event) => {\n                const detail = event.detail || {};\n                const contactId = String(detail.contactId || '').trim();\n                if (!contactId)\n                    return;\n                collectUnsyncedPhoneMessages(contactId);\n            };\n            topDoc.addEventListener('phone-message-received', phoneMessageReceivedHandler);\n            topDoc.addEventListener('phone-ai-generation-complete', phoneAIGenCompleteHandler);\n            phoneTtsBridgeBound = true;\n            log(' TTS ');\n        }\n        function unbindPhoneTTSBridge() {\n            if (!phoneTtsBridgeBound)\n                return;\n            const top = getTopWindow();\n            const topDoc = top.document ?? document;\n            if (phoneMessageReceivedHandler) {\n                topDoc.removeEventListener('phone-message-received', phoneMessageReceivedHandler);\n            }\n            if (phoneAIGenCompleteHandler) {\n                topDoc.removeEventListener('phone-ai-generation-complete', phoneAIGenCompleteHandler);\n            }\n            phoneMessageReceivedHandler = null;\n            phoneAIGenCompleteHandler = null;\n            phoneTtsQueue.length = 0;\n            phoneTtsQueueRunning = false;\n            phoneTtsBridgeBound = false;\n        }\n        function bindBaibaiPhoneTTSBridge() {\n            if (baibaiPhoneTtsBridgeBound)\n                return;\n            resetBaibaiAssistantSeenState();\n            markExistingBaibaiMessagesAsSeen();\n            const sync = () => {\n                collectUnsyncedBaibaiMessages();\n            };\n            const onChatChanged = () => {\n                resetBaibaiAssistantSeenState();\n                markExistingBaibaiMessagesAsSeen();\n            };\n            const eventKeys = ['GENERATION_ENDED', 'MESSAGE_UPDATED', 'MESSAGE_SWIPED'];\n            eventKeys.forEach((eventKey) => {\n                const stop = bindTavernEvent(eventKey, sync);\n                if (stop)\n                    baibaiEventStops.push(stop);\n            });\n            const chatChangedStop = bindTavernEvent('CHAT_CHANGED', onChatChanged);\n            if (chatChangedStop) {\n                baibaiEventStops.push(chatChangedStop);\n            }\n            if (baibaiEventStops.length === 0) {\n                baibaiPhonePollTimer = window.setInterval(() => {\n                    collectUnsyncedBaibaiMessages();\n                }, 1200);\n            }\n            baibaiPhoneTtsBridgeBound = true;\n            log(' TTS ');\n        }\n        function unbindBaibaiPhoneTTSBridge() {\n            if (!baibaiPhoneTtsBridgeBound)\n                return;\n            baibaiEventStops.forEach((stop) => {\n                stop.stop();\n            });\n            baibaiEventStops.length = 0;\n            if (baibaiPhonePollTimer !== null) {\n                window.clearInterval(baibaiPhonePollTimer);\n                baibaiPhonePollTimer = null;\n            }\n            resetBaibaiAssistantSeenState();\n            baibaiPhoneTtsBridgeBound = false;\n        }\n        function applyEmotionToLive2D(tag) {\n            try {\n                const model = Live2DManager.model;\n                if (!model)\n                    return false;\n                let applied = false;\n                const cfg = getEmotionConfigByTag(tag, settings.value.emotionConfigs);\n                const expressionResolved = resolveLive2DExpression(model, tag, cfg?.live2dExpression);\n                if (expressionResolved?.type === 'native') {\n                    Live2DManager.playExpression(expressionResolved.name);\n                    applied = true;\n                }\n                else if (expressionResolved?.type === 'builtin') {\n                    if (Live2DManager.applyBuiltinExpression(expressionResolved.key)) {\n                        applied = true;\n                    }\n                }\n                const motionResolved = resolveLive2DMotion(model, tag, cfg?.live2dMotion);\n                if (motionResolved?.type === 'native') {\n                    Live2DManager.playMotion(motionResolved.group, motionResolved.index);\n                    applied = true;\n                }\n                else if (motionResolved?.type === 'builtin') {\n                    if (Live2DManager.playBuiltinMotion(motionResolved.key)) {\n                        applied = true;\n                    }\n                }\n                else if (motionResolved?.type === 'disabled') {\n                    Live2DManager.stopBuiltinMotion();\n                }\n                return applied;\n            }\n            catch (e) {\n                logError('', e);\n                return false;\n            }\n        }\n        watch(showSettings, (visible) => {\n            log(visible ? '' : '');\n            if (!visible || !petClosed)\n                return;\n            log('');\n            syncGazeFollowBinding();\n            void initPet();\n        });\n        function registerGlobalOpenSettings() {\n            try {\n                const top = window.parent ?? window;\n                const fn = () => {\n                    uiStore.openSettings();\n                    log('');\n                };\n                top[OPEN_SETTINGS_FN_KEY] = fn;\n                globalOpenSettingsFn = fn;\n            }\n            catch (e) {\n                notifyInitError('', e);\n            }\n        }\n        function unregisterGlobalOpenSettings() {\n            try {\n                const top = window.parent ?? window;\n                if (globalOpenSettingsFn && top[OPEN_SETTINGS_FN_KEY] === globalOpenSettingsFn) {\n                    delete top[OPEN_SETTINGS_FN_KEY];\n                }\n            }\n            catch {\n                // ignore\n            }\n            finally {\n                globalOpenSettingsFn = null;\n            }\n        }\n        registerGlobalOpenSettings();\n        function openFunctionMenu(e) {\n            try {\n                if (navigator.vibrate) {\n                    navigator.vibrate(50);\n                }\n            }\n            catch {\n                // ignore\n            }\n            const top = getTopWindow();\n            let placement = 'right';\n            let x = e.clientX;\n            let y = e.clientY;\n            try {\n                const stageEl = top.document.getElementById('desktop-pet-stage');\n                const rect = stageEl?.getBoundingClientRect?.();\n                const vw = top.innerWidth || top.document.documentElement.clientWidth || 0;\n                if (rect && vw > 0) {\n                    placement = rect.left > vw / 2 ? 'left' : 'right';\n                    x = placement === 'left' ? rect.left - 10 : rect.right + 10;\n                    y = rect.top + rect.height * 0.5;\n                }\n                else if (vw > 0) {\n                    placement = e.clientX > vw / 2 ? 'left' : 'right';\n                }\n            }\n            catch {\n                // ignore\n            }\n            menuPlacement.value = placement;\n            menuAnchor.value = { x, y };\n            showMenu.value = true;\n        }\n        function toggleMotionLoop() {\n            const next = !settings.value.autoMotionLoop;\n            settings.value.autoMotionLoop = next;\n            Live2DManager.setAutoMotionLoopEnabled(next);\n        }\n        function cyclePersona() {\n            const personas = ['', '', '', ''];\n            const current = settings.value.commentStyle;\n            const idx = personas.indexOf(current);\n            const next = personas[(idx >= 0 ? idx + 1 : 0) % personas.length];\n            settings.value.commentStyle = next;\n            try {\n                toastr.info(`${next}`);\n            }\n            catch {\n                // ignore\n            }\n        }\n        function openModelBrowser() {\n            showMenu.value = false;\n            showModelBrowser.value = true;\n        }\n        function onModelBrowserLoad(url) {\n            settings.value.modelPath = url;\n            showModelBrowser.value = false;\n            void onModelChange(url);\n        }\n        function onManualChat(message) {\n            void Commentator.chat(message);\n        }\n        function closePet() {\n            if (petClosed)\n                return;\n            petClosed = true;\n            initTaskId++;\n            modelLoadTaskId++;\n            clearModelLoadingHideTimer();\n            clearStatusCheckTimer();\n            clearViewportResizeSyncTimer();\n            showMenu.value = false;\n            showModelBrowser.value = false;\n            uiStore.closeSettings();\n            onBubbleHidden();\n            unbindGlobalGazeFollow(true);\n            unbindPhoneTTSBridge();\n            unbindBaibaiPhoneTTSBridge();\n            ChatMonitor.destroy();\n            Commentator.destroy();\n            try {\n                TTSManager.stop();\n                LipSyncManager.cleanup();\n            }\n            catch {\n                // ignore\n            }\n            Live2DStage.hideLoadingProgress();\n            Live2DManager.destroyModel();\n            Live2DStage.destroy();\n            try {\n                toastr.info('');\n            }\n            catch {\n                // ignore\n            }\n        }\n        function getStageSize(scale) {\n            const safeScale = normalizePetScale(scale);\n            return {\n                width: Math.max(1, Math.round(BASE_STAGE_WIDTH * safeScale)),\n                height: Math.max(1, Math.round(BASE_STAGE_HEIGHT * safeScale)),\n            };\n        }\n        function normalizePetScale(value) {\n            const parsed = typeof value === 'number' ? value : Number(value);\n            if (!Number.isFinite(parsed))\n                return DEFAULTS.PET_SCALE;\n            return Math.max(0.1, Math.min(3, parsed));\n        }\n        function clearModelLoadingHideTimer() {\n            if (modelLoadingHideTimer === null)\n                return;\n            window.clearTimeout(modelLoadingHideTimer);\n            modelLoadingHideTimer = null;\n        }\n        function clearStatusCheckTimer() {\n            if (statusCheckTimer === null)\n                return;\n            window.clearTimeout(statusCheckTimer);\n            statusCheckTimer = null;\n        }\n        function clearViewportResizeSyncTimer() {\n            if (viewportResizeSyncTimer === null)\n                return;\n            window.clearTimeout(viewportResizeSyncTimer);\n            viewportResizeSyncTimer = null;\n        }\n        function clearGazeFollowRaf() {\n            if (gazeFollowRafId === null)\n                return;\n            const top = getTopWindow();\n            try {\n                top.cancelAnimationFrame(gazeFollowRafId);\n            }\n            catch {\n                // ignore\n            }\n            gazeFollowRafId = null;\n        }\n        function isGazePointerTypeSupported(pointerType) {\n            return pointerType === 'mouse' || pointerType === 'pen';\n        }\n        function scheduleGazeFollow(clientX, clientY) {\n            if (!Number.isFinite(clientX) || !Number.isFinite(clientY))\n                return;\n            gazePendingPoint = { x: clientX, y: clientY };\n            if (gazeFollowRafId !== null)\n                return;\n            const top = getTopWindow();\n            gazeFollowRafId = top.requestAnimationFrame(() => {\n                gazeFollowRafId = null;\n                const point = gazePendingPoint;\n                gazePendingPoint = null;\n                if (!point)\n                    return;\n                if (settings.value.gazeFollowMouseEnabled === false)\n                    return;\n                if (Live2DStage.isPreviewMounted())\n                    return;\n                Live2DManager.focusByClientPoint(point.x, point.y, false);\n            });\n        }\n        function bindGlobalGazeFollow() {\n            if (gazeFollowBound)\n                return;\n            const top = getTopWindow();\n            const topDoc = top.document ?? document;\n            const handlePointerEvent = (event) => {\n                if (!isGazePointerTypeSupported(event.pointerType))\n                    return;\n                scheduleGazeFollow(event.clientX, event.clientY);\n            };\n            gazePointerMoveHandler = handlePointerEvent;\n            gazePointerDownHandler = handlePointerEvent;\n            topDoc.addEventListener('pointermove', gazePointerMoveHandler, { passive: true });\n            topDoc.addEventListener('pointerdown', gazePointerDownHandler, { passive: true });\n            gazeFollowBound = true;\n        }\n        function unbindGlobalGazeFollow(resetFocus = true) {\n            clearGazeFollowRaf();\n            gazePendingPoint = null;\n            const top = getTopWindow();\n            const topDoc = top.document ?? document;\n            if (gazePointerMoveHandler) {\n                topDoc.removeEventListener('pointermove', gazePointerMoveHandler);\n            }\n            if (gazePointerDownHandler) {\n                topDoc.removeEventListener('pointerdown', gazePointerDownHandler);\n            }\n            gazePointerMoveHandler = null;\n            gazePointerDownHandler = null;\n            gazeFollowBound = false;\n            if (resetFocus) {\n                Live2DManager.focusCenter(true);\n            }\n        }\n        function syncGazeFollowBinding() {\n            if (settings.value.gazeFollowMouseEnabled === false) {\n                unbindGlobalGazeFollow(true);\n                return;\n            }\n            bindGlobalGazeFollow();\n        }\n        function syncStageAfterViewportResize(reason) {\n            if (Live2DStage.isPreviewMounted())\n                return;\n            const stageSize = getStageSize(settings.value.petScale);\n            const recoverOnce = (label) => {\n                Live2DStage.resizeFloating(stageSize.width, stageSize.height);\n                const top = getTopWindow();\n                const stageEl = top.document.getElementById('desktop-pet-stage');\n                if (stageEl) {\n                    stageEl.style.display = 'block';\n                    stageEl.style.visibility = 'visible';\n                    stageEl.style.opacity = '1';\n                    stageEl.style.zIndex = '10000';\n                }\n                const stage = Live2DStage.getStage();\n                const hasModelOnStage = !!stage && stage.children.length > 0;\n                if (hasModelOnStage) {\n                    Live2DManager.updateScale(stageSize.width, stageSize.height, 1);\n                    log(`Viewport resize recovery synced model (${label})`);\n                    return;\n                }\n                Live2DManager.mountToStage(stageSize.width, stageSize.height, 1);\n                log(`Viewport resize recovery remounted model (${label})`);\n            };\n            recoverOnce(`${reason}-pass1`);\n            window.setTimeout(() => {\n                if (Live2DStage.isPreviewMounted())\n                    return;\n                recoverOnce(`${reason}-pass2`);\n            }, 220);\n            scheduleStatusCheck(`${reason}-recover`);\n        }\n        function scheduleViewportResizeSync(reason) {\n            clearViewportResizeSyncTimer();\n            viewportResizeSyncTimer = window.setTimeout(() => {\n                viewportResizeSyncTimer = null;\n                syncStageAfterViewportResize(reason);\n            }, 160);\n        }\n        function bindViewportResizeRecovery() {\n            const top = getTopWindow();\n            boundWindowResizeHandler = () => {\n                scheduleViewportResizeSync('window-resize');\n            };\n            try {\n                top.addEventListener('resize', boundWindowResizeHandler, { passive: true });\n            }\n            catch (e) {\n                logError('Failed to bind window.resize listener', e);\n                boundWindowResizeHandler = null;\n            }\n            const viewport = top.visualViewport;\n            if (!viewport)\n                return;\n            boundVisualViewportResizeHandler = () => {\n                scheduleViewportResizeSync('visual-viewport-resize');\n            };\n            try {\n                viewport.addEventListener('resize', boundVisualViewportResizeHandler, { passive: true });\n            }\n            catch (e) {\n                logError('Failed to bind visualViewport.resize listener', e);\n                boundVisualViewportResizeHandler = null;\n            }\n        }\n        function unbindViewportResizeRecovery() {\n            const top = getTopWindow();\n            if (boundWindowResizeHandler) {\n                try {\n                    top.removeEventListener('resize', boundWindowResizeHandler);\n                }\n                catch {\n                    // ignore\n                }\n                boundWindowResizeHandler = null;\n            }\n            const viewport = top.visualViewport;\n            if (viewport && boundVisualViewportResizeHandler) {\n                try {\n                    viewport.removeEventListener('resize', boundVisualViewportResizeHandler);\n                }\n                catch {\n                    // ignore\n                }\n                boundVisualViewportResizeHandler = null;\n            }\n        }\n        function renderModelLoadProgress(progress) {\n            const percent = Math.max(0, Math.min(100, Math.round(progress.percent)));\n            Live2DStage.showLoadingProgress(percent, progress.message);\n        }\n        function notifyInitError(message, err) {\n            logError(message, err);\n            try {\n                toastr.error(message);\n            }\n            catch {\n                // ignore\n            }\n        }\n        async function loadModelWithProgress(path) {\n            const taskId = ++modelLoadTaskId;\n            clearModelLoadingHideTimer();\n            renderModelLoadProgress({ percent: 0, message: '' });\n            const loaded = await Live2DManager.loadModel(path, (progress) => {\n                if (taskId !== modelLoadTaskId)\n                    return;\n                renderModelLoadProgress(progress);\n            });\n            if (taskId !== modelLoadTaskId) {\n                return loaded;\n            }\n            renderModelLoadProgress({\n                percent: 100,\n                message: loaded ? '' : '',\n            });\n            modelLoadingHideTimer = window.setTimeout(() => {\n                if (taskId !== modelLoadTaskId)\n                    return;\n                Live2DStage.hideLoadingProgress();\n                modelLoadingHideTimer = null;\n            }, loaded ? 400 : 15000);\n            return loaded;\n        }\n        function scheduleStatusCheck(reason) {\n            clearStatusCheckTimer();\n            if (petClosed)\n                return;\n            statusCheckTimer = window.setTimeout(() => {\n                try {\n                    if (petClosed)\n                        return;\n                    const top = window.parent ?? window;\n                    const stageEl = top.document.getElementById('desktop-pet-stage');\n                    const rect = stageEl?.getBoundingClientRect?.();\n                    const rectSummary = rect\n                        ? `${Math.round(rect.left)},${Math.round(rect.top)} ${Math.round(rect.width)}x${Math.round(rect.height)}`\n                        : 'none';\n                    const pixiVersion = String(top.PIXI?.VERSION || '').trim() || 'none';\n                    const hasLive2d = !!top.PIXI?.live2d?.Live2DModel;\n                    const hasModel = !!Live2DManager.model;\n                    const stageChildren = (Live2DStage.getStage()?.children?.length ?? 0);\n                    const stageVisible = !!rect &&\n                        rect.width > 10 &&\n                        rect.height > 10 &&\n                        rect.bottom > 0 &&\n                        rect.right > 0 &&\n                        rect.top < (top.innerHeight || 0) &&\n                        rect.left < (top.innerWidth || 0);\n                    if (stageVisible && hasLive2d && hasModel && stageChildren > 0) {\n                        statusCheckTimer = null;\n                        return;\n                    }\n                    if (stageEl) {\n                        const prevOutline = stageEl.style.outline;\n                        const prevBackground = stageEl.style.background;\n                        const prevZIndex = stageEl.style.zIndex;\n                        stageEl.style.outline = '2px dashed rgba(245, 158, 11, 0.95)';\n                        stageEl.style.background = 'rgba(245, 158, 11, 0.08)';\n                        stageEl.style.zIndex = '2147483647';\n                        window.setTimeout(() => {\n                            if (!stageEl?.ownerDocument?.documentElement?.contains(stageEl))\n                                return;\n                            stageEl.style.outline = prevOutline;\n                            stageEl.style.background = prevBackground;\n                            stageEl.style.zIndex = prevZIndex;\n                        }, 10000);\n                    }\n                    const message = `(${reason}) ` +\n                        `stage=${!!stageEl} rect=${rectSummary} visible=${stageVisible} ` +\n                        `pixi=${pixiVersion} live2d=${hasLive2d} model=${hasModel} children=${stageChildren}`;\n                    try {\n                        toastr.warning(message);\n                    }\n                    catch {\n                        // ignore\n                    }\n                }\n                catch (e) {\n                    notifyInitError('', e);\n                }\n                finally {\n                    statusCheckTimer = null;\n                }\n            }, 2500);\n        }\n        async function initPet() {\n            const taskId = ++initTaskId;\n            petClosed = false;\n            try {\n                log('');\n                if (taskId !== initTaskId || petClosed)\n                    return;\n                const s = settings.value;\n                try {\n                    setLipSyncRefs({\n                        getProxiedAudioUrl: (url) => TTSManager._getProxiedAudioUrl(url),\n                    });\n                    TTSManager.init();\n                }\n                catch (e) {\n                    logError('TTS ', e);\n                }\n                bindPhoneTTSBridge();\n                bindBaibaiPhoneTTSBridge();\n                Commentator.setCallback((text, isDone) => {\n                    const parsed = parseEmotionCotText(text, {\n                        enabled: !!settings.value.emotionCotEnabled,\n                        stripFromText: settings.value.emotionCotStripFromText !== false,\n                        configs: settings.value.emotionConfigs,\n                    });\n                    const splitResult = splitZhJaForDisplayAndTts(parsed.cleanText, !!settings.value.ttsBilingualZhJaEnabled);\n                    bubbleText.value = splitResult.displayText;\n                    bubbleDone.value = isDone;\n                    if (!isDone)\n                        return;\n                    const finalText = String(splitResult.displayText || '').trim();\n                    if (!finalText)\n                        return;\n                    const ttsText = String(splitResult.ttsText || '').trim();\n                    if (!ttsText)\n                        return;\n                    if (parsed.normalizedTag) {\n                        const applied = applyEmotionToLive2D(parsed.normalizedTag);\n                        if (!applied) {\n                            Live2DManager.playRandomAnimation();\n                        }\n                    }\n                    else {\n                        Live2DManager.playRandomAnimation();\n                    }\n                    const ttsEnabled = getTTSEnabled();\n                    const autoPlay = !!settings.value.ttsAutoPlay;\n                    const tagLabel = parsed.normalizedTag || '(none)';\n                    log(`TTS: enabled=${ttsEnabled}, autoPlay=${autoPlay}, tag=${tagLabel}, textLen=${finalText.length}, ttsLen=${ttsText.length}, zhJa=${settings.value.ttsBilingualZhJaEnabled}, hasJa=${splitResult.hasJa}`);\n                    if (!ttsEnabled)\n                        return;\n                    if (!autoPlay)\n                        return;\n                    const speaker = getCurrentCharacterId();\n                    const voiceName = String(settings.value.ttsDefaultSpeaker || '').trim();\n                    let context = String(parsed.context || '').trim();\n                    if (!context && parsed.normalizedTag) {\n                        const cfg = getEmotionConfigByTag(parsed.normalizedTag, settings.value.emotionConfigs);\n                        context = String(cfg?.ttsContext || '').trim();\n                    }\n                    log(`: speaker=${speaker}, voice=${voiceName || ''}, context=${context || ''}`);\n                    void (async () => {\n                        try {\n                            TTSManager.stop();\n                            const ttsOverrides = {};\n                            if (voiceName)\n                                ttsOverrides.speaker = voiceName;\n                            if (context)\n                                ttsOverrides.context = context;\n                            await TTSManager.speak({\n                                type: 'dialogue',\n                                speaker,\n                                text: ttsText,\n                                tts: Object.keys(ttsOverrides).length > 0 ? ttsOverrides : undefined,\n                            }, `desktop_pet_comment_${Date.now()}`);\n                        }\n                        catch (e) {\n                            logError('', e);\n                        }\n                    })();\n                });\n                const ready = await Live2DManager.init();\n                if (!ready) {\n                    notifyInitError('Live2D SDK  CDN ');\n                    return;\n                }\n                log('Live2D SDK ');\n                Live2DManager.setAutoMotionLoopEnabled(s.autoMotionLoop);\n                const initialScale = normalizePetScale(s.petScale);\n                if (initialScale !== s.petScale) {\n                    settings.value.petScale = initialScale;\n                }\n                const stageSize = getStageSize(initialScale);\n                const created = Live2DStage.create({\n                    width: stageSize.width,\n                    height: stageSize.height,\n                    position: { x: s.petPosition.x, y: s.petPosition.y },\n                    scale: initialScale,\n                    onPositionChange: (x, y) => {\n                        settings.value.petPosition = { x, y };\n                    },\n                    onScaleChange: (scale) => {\n                        const safeScale = normalizePetScale(scale);\n                        if (safeScale !== settings.value.petScale) {\n                            settings.value.petScale = safeScale;\n                        }\n                    },\n                    onTap: (_e) => {\n                        log(' ->  LLM');\n                        Live2DManager.playRandomAnimation();\n                    },\n                    onDoubleTap: (_e) => {\n                        const motionEnabled = settings.value.doubleTapRandomMotionEnabled !== false;\n                        log(motionEnabled ? ' ->  + ' : ' -> ');\n                        ChatMonitor.manualTrigger();\n                        if (motionEnabled) {\n                            Live2DManager.playRandomAnimation();\n                        }\n                    },\n                    onLongPress: (_e) => {\n                        log(' -> ');\n                        openFunctionMenu(_e);\n                    },\n                });\n                if (!created) {\n                    notifyInitError('Live2D  WebGL ');\n                    return;\n                }\n                log('Live2D ');\n                const loaded = await loadModelWithProgress(s.modelPath);\n                if (taskId !== initTaskId || petClosed)\n                    return;\n                if (loaded) {\n                    Live2DManager.mountToStage(stageSize.width, stageSize.height, 1);\n                    log('Live2D ');\n                }\n                else {\n                    notifyInitError('Live2D  CDN');\n                }\n                ChatMonitor.init({\n                    autoTrigger: s.autoTrigger,\n                    triggerInterval: s.triggerInterval,\n                    triggerProbability: s.triggerProbability,\n                    commentTriggerMode: s.commentTriggerMode,\n                }, () => {\n                    void Commentator.generate();\n                });\n                log('');\n                if (taskId !== initTaskId || petClosed)\n                    return;\n                scheduleStatusCheck('init');\n            }\n            catch (e) {\n                if (taskId !== initTaskId || petClosed)\n                    return;\n                notifyInitError('', e);\n            }\n        }\n        async function onModelChange(path) {\n            if (petClosed)\n                return;\n            const nextPath = String(path || '').trim();\n            const isLocalModel = nextPath.length > 0 &&\n                nextPath.toLowerCase().startsWith(LOCAL_LIVE2D_MODEL_PATH_PREFIX.toLowerCase());\n            if (isLocalModel) {\n                try {\n                    const exists = await hasLive2DModel();\n                    if (!exists) {\n                        const message = ' ZIP ';\n                        log(`: local model missing, path=${nextPath}`);\n                        toastr.error(message);\n                        scheduleStatusCheck('model-change-local-missing');\n                        return;\n                    }\n                }\n                catch (e) {\n                    const message = `: ${e instanceof Error ? e.message : String(e)}`;\n                    log(`: path=${nextPath}`, e);\n                    toastr.error(message);\n                    scheduleStatusCheck('model-change-local-check-error');\n                    return;\n                }\n            }\n            const loaded = await loadModelWithProgress(path);\n            if (petClosed)\n                return;\n            if (loaded) {\n                const stageSize = getStageSize(settings.value.petScale);\n                Live2DManager.mountToStage(stageSize.width, stageSize.height, 1);\n            }\n            else if (isLocalModel) {\n                const message = ' ZIP ';\n                log(`: path=${nextPath}`);\n                toastr.error(message);\n            }\n            scheduleStatusCheck(isLocalModel ? 'model-change-local' : 'model-change');\n        }\n        function onBubbleHidden() {\n            bubbleText.value = '';\n            bubbleDone.value = true;\n        }\n        watch(() => ({\n            autoTrigger: settings.value.autoTrigger,\n            triggerInterval: settings.value.triggerInterval,\n            triggerProbability: settings.value.triggerProbability,\n            commentTriggerMode: settings.value.commentTriggerMode,\n        }), (config) => {\n            ChatMonitor.updateConfig(config);\n        });\n        watch(() => settings.value.autoMotionLoop, (enabled) => {\n            Live2DManager.setAutoMotionLoopEnabled(enabled);\n        });\n        watch(() => settings.value.gazeFollowMouseEnabled, () => {\n            syncGazeFollowBinding();\n        });\n        watch(() => settings.value.petScale, (scale) => {\n            const safeScale = normalizePetScale(scale);\n            if (safeScale !== scale) {\n                settings.value.petScale = safeScale;\n                return;\n            }\n            const stageSize = getStageSize(safeScale);\n            Live2DStage.resizeFloating(stageSize.width, stageSize.height);\n            if (!Live2DStage.isPreviewMounted()) {\n                Live2DManager.updateScale(stageSize.width, stageSize.height, 1);\n            }\n        });\n        onMounted(() => {\n            petClosed = false;\n            bindViewportResizeRecovery();\n            syncGazeFollowBinding();\n            initPet();\n        });\n        onUnmounted(() => {\n            petClosed = true;\n            initTaskId++;\n            unbindViewportResizeRecovery();\n            unbindGlobalGazeFollow(true);\n            unregisterGlobalOpenSettings();\n            unbindPhoneTTSBridge();\n            unbindBaibaiPhoneTTSBridge();\n            modelLoadTaskId++;\n            clearModelLoadingHideTimer();\n            clearStatusCheckTimer();\n            clearViewportResizeSyncTimer();\n            Live2DStage.hideLoadingProgress();\n            ChatMonitor.destroy();\n            Commentator.destroy();\n            try {\n                TTSManager.stop();\n                LipSyncManager.cleanup();\n            }\n            catch {\n                // ignore\n            }\n            Live2DManager.destroyModel();\n            Live2DStage.destroy();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", null, [\n                _createVNode(ChatBubble, {\n                    text: bubbleText.value,\n                    \"is-done\": bubbleDone.value,\n                    \"auto-close-delay-seconds\": _unref(settings).bubbleDuration,\n                    onHidden: onBubbleHidden\n                }, null, 8 /* PROPS */, [\"text\", \"is-done\", \"auto-close-delay-seconds\"]),\n                _createVNode(SettingsPanel, {\n                    visible: _unref(showSettings),\n                    onClose: _cache[0] || (_cache[0] = ($event) => (_unref(uiStore).closeSettings())),\n                    onModelChange: onModelChange\n                }, null, 8 /* PROPS */, [\"visible\"]),\n                _createVNode(FunctionMenu, {\n                    visible: showMenu.value,\n                    x: menuAnchor.value.x,\n                    y: menuAnchor.value.y,\n                    placement: menuPlacement.value,\n                    \"motion-loop-enabled\": _unref(settings).autoMotionLoop,\n                    \"comment-style\": _unref(settings).commentStyle,\n                    onClose: _cache[1] || (_cache[1] = ($event) => (showMenu.value = false)),\n                    onSendChat: onManualChat,\n                    onToggleMotionLoop: toggleMotionLoop,\n                    onSwitchModel: openModelBrowser,\n                    onSwitchPersona: cyclePersona,\n                    onCloseModel: closePet\n                }, null, 8 /* PROPS */, [\"visible\", \"x\", \"y\", \"placement\", \"motion-loop-enabled\", \"comment-style\"]),\n                (showModelBrowser.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"browser-overlay\",\n                        onClick: _cache[4] || (_cache[4] = _withModifiers(($event) => (showModelBrowser.value = false), [\"self\"]))\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_1, [\n                            _createElementVNode(\"div\", _hoisted_2, [\n                                _cache[5] || (_cache[5] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-btn\",\n                                    onClick: _cache[2] || (_cache[2] = ($event) => (showModelBrowser.value = false))\n                                }, \"\")\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_3, [\n                                _createVNode(ModelBrowser, {\n                                    \"use-cdn\": _unref(settings).useCdn,\n                                    onCancel: _cache[3] || (_cache[3] = ($event) => (showModelBrowser.value = false)),\n                                    onLoadModel: onModelBrowserLoad\n                                }, null, 8 /* PROPS */, [\"use-cdn\"])\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./PetContainer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./PetContainer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./PetContainer.vue?vue&type=style&index=0&id=9229b8c6&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-9229b8c6\"]])\n\nexport default __exports__","/**\n *  iframe  <head> \n *  jQuery  Vue  DOM \n */\nexport function teleport_style(): void {\n  // /\n  deteleport_style();\n  $(`<div>`)\n    .attr('script_id', getScriptId())\n    .append($(`head > style`, document).clone())\n    .appendTo('head');\n}\n\n/**\n * \n */\nexport function deteleport_style(): void {\n  $(`head > div[script_id=\"${getScriptId()}\"]`).remove();\n}\n","import { createApp } from 'vue';\nimport { createPinia } from 'pinia';\nimport PetContainer from './ui/PetContainer.vue';\nimport { ChatMonitor } from './chat/monitor';\nimport { teleport_style, deteleport_style } from './utils/style-teleport';\nimport { error as logError, log, warn } from './utils/dom';\nimport { SCRIPT_NAME } from './core/constants';\nimport { useUiStore } from './core/ui';\n\nconst BUILD_TAG = '20260222.01';\nconst LEGACY_MENU_BUTTON_LABELS = new Set(['', '']);\nconst SETTINGS_LABEL = '';\nconst OPEN_SETTINGS_FN_KEY = '__desktopPetOpenSettings_v2';\n\n// Pinia  $(() => {}) \nconst pinia = createPinia();\nconst uiStore = useUiStore(pinia);\nconst EXTENSIONS_MENU_CONTAINER_ID = 'desktop-pet-settings-menu-container';\nconst EXTENSIONS_MENU_ITEM_ID = 'desktop-pet-settings-menu-item';\nconst EXTENSIONS_MENU_CLICK_NAMESPACE = '.desktopPetSettingsMenu';\n\nlet extensionsMenuRetryTimer: number | null = null;\n\nfunction getParentDocument(): Document {\n  try {\n    return window.parent?.document ?? document;\n  } catch {\n    return document;\n  }\n}\n\nfunction getTopWindow(): Window {\n  return window.parent ?? window;\n}\n\nfunction bindExtensionsMenuDelegation(parentDoc: Document): void {\n  const clickEvent = `click${EXTENSIONS_MENU_CLICK_NAMESPACE}`;\n  $(parentDoc).off(clickEvent, `#${EXTENSIONS_MENU_ITEM_ID}`);\n  $(parentDoc).on(clickEvent, `#${EXTENSIONS_MENU_ITEM_ID}`, (event) => {\n    void onExtensionsMenuItemClick(event as unknown as JQuery.ClickEvent);\n  });\n}\n\nfunction clearExtensionsMenuRetryTimer(): void {\n  if (extensionsMenuRetryTimer !== null) {\n    window.clearTimeout(extensionsMenuRetryTimer);\n    extensionsMenuRetryTimer = null;\n  }\n}\n\nfunction scheduleExtensionsMenuInjection(): void {\n  if (extensionsMenuRetryTimer !== null) {\n    return;\n  }\n\n  extensionsMenuRetryTimer = window.setTimeout(() => {\n    extensionsMenuRetryTimer = null;\n    injectExtensionsMenuItem();\n  }, 1000);\n}\n\nasync function onExtensionsMenuItemClick(event: JQuery.ClickEvent): Promise<void> {\n  event.stopPropagation();\n  log('');\n\n  const parentDoc = getParentDocument();\n  const $extensionsMenu = $('#extensionsMenu', parentDoc);\n  const $extensionsMenuButton = $('#extensionsMenuButton', parentDoc);\n\n  if ($extensionsMenuButton.length > 0 && $extensionsMenu.is(':visible')) {\n    $extensionsMenuButton.trigger('click');\n    await new Promise<void>((resolve) => {\n      window.setTimeout(resolve, 120);\n    });\n  }\n\n  const top = getTopWindow() as any;\n  const openSettings = top?.[OPEN_SETTINGS_FN_KEY];\n  if (typeof openSettings === 'function') {\n    openSettings();\n    log('');\n  } else {\n    uiStore.openSettings();\n    log(` Pinia  (showSettings=${String(uiStore.showSettings)})`);\n  }\n\n  window.setTimeout(() => {\n    try {\n      const overlay = parentDoc.querySelector('#desktop-pet-app .settings-overlay') as HTMLElement | null;\n      const rect = overlay?.getBoundingClientRect?.();\n      const summary = rect\n        ? `${Math.round(rect.left)},${Math.round(rect.top)} ${Math.round(rect.width)}x${Math.round(rect.height)}`\n        : 'none';\n      const style = overlay ? (window.getComputedStyle(overlay) as CSSStyleDeclaration) : null;\n      const styleSummary = style\n        ? `position=${style.position} display=${style.display} width=${style.width} height=${style.height}`\n        : 'style=none';\n      log(` DOM : overlay=${!!overlay} rect=${summary} ${styleSummary}`);\n    } catch (e) {\n      warn(' DOM ', e);\n    }\n  }, 0);\n}\n\nfunction injectExtensionsMenuItem(): void {\n  const parentDoc = getParentDocument();\n  const $extensionsMenu = $('#extensionsMenu', parentDoc);\n\n  if ($extensionsMenu.length === 0) {\n    scheduleExtensionsMenuInjection();\n    return;\n  }\n\n  bindExtensionsMenuDelegation(parentDoc);\n  const $existingItem = $(`#${EXTENSIONS_MENU_ITEM_ID}`, parentDoc);\n  if ($existingItem.length > 0) {\n    return;\n  }\n\n  const $container = $(\n    `<div class=\"extension_container interactable\" id=\"${EXTENSIONS_MENU_CONTAINER_ID}\" tabindex=\"0\"></div>`,\n  );\n\n  const $item = $(\n    `<div class=\"list-group-item flex-container flexGap5 interactable\" id=\"${EXTENSIONS_MENU_ITEM_ID}\" title=\"${SETTINGS_LABEL}\"><div class=\"fa-fw fa-solid fa-paw extensionsMenuExtensionButton\"></div><span>${SETTINGS_LABEL}</span></div>`,\n  );\n\n  $container.append($item);\n  $extensionsMenu.append($container);\n}\n\nfunction removeExtensionsMenuItem(): void {\n  clearExtensionsMenuRetryTimer();\n\n  const parentDoc = getParentDocument();\n  const clickEvent = `click${EXTENSIONS_MENU_CLICK_NAMESPACE}`;\n  $(parentDoc).off(clickEvent, `#${EXTENSIONS_MENU_ITEM_ID}`);\n  $(`#${EXTENSIONS_MENU_CONTAINER_ID}`, parentDoc).remove();\n}\n\nfunction removeLegacyMenuButtons(): void {\n  try {\n    const parentDoc = getParentDocument();\n    $('.qr--button.menu_button.interactable', parentDoc)\n      .filter((_idx, el) => LEGACY_MENU_BUTTON_LABELS.has(String($(el).text() || '').trim()))\n      .remove();\n  } catch (e) {\n    warn('', e);\n  }\n}\n\n$(() => {\n  // \n  teleport_style();\n\n  try {\n    log(`(${BUILD_TAG})`);\n    removeLegacyMenuButtons();\n    window.setTimeout(() => {\n      removeLegacyMenuButtons();\n    }, 1200);\n\n    //  Vue \n    try {\n      const parentDoc = getParentDocument();\n      $('#desktop-pet-app', parentDoc).remove();\n    } catch {\n      // ignore\n    }\n    const $app = $('<div id=\"desktop-pet-app\">').appendTo('body');\n    const app = createApp(PetContainer);\n    app.use(pinia);\n    app.config.errorHandler = (err, _instance, info) => {\n      logError(`Vue error: ${info}`, err);\n    };\n    app.config.warnHandler = (msg, _instance, trace) => {\n      warn(`Vue warn: ${msg}${trace ? `\\n${trace}` : ''}`);\n    };\n    app.mount($app[0]);\n    injectExtensionsMenuItem();\n\n    toastr.success(`${SCRIPT_NAME}(${BUILD_TAG})`);\n    log(`(${BUILD_TAG})`);\n\n    // \n    let chatId = SillyTavern.getCurrentChatId();\n    eventOn(tavern_events.CHAT_CHANGED, (newChatId: string) => {\n      if (chatId !== newChatId) {\n        chatId = newChatId;\n        ChatMonitor.resetState();\n      }\n    });\n  } catch (e) {\n    logError('', e);\n    toastr.error(`${SCRIPT_NAME}(${BUILD_TAG})`);\n    $('#desktop-pet-app').remove();\n  }\n});\n\n$(window).on('pagehide', () => {\n  removeLegacyMenuButtons();\n  removeExtensionsMenuItem();\n  deteleport_style();\n  $('#desktop-pet-app').remove();\n  $('#desktop-pet-stage').remove();\n});\n"],"names":["content","__esModule","default","module","id","locals","exports","add","cssWithMappingToString","list","toString","this","map","item","needLayer","concat","length","join","i","modules","media","dedupe","supports","layer","undefined","alreadyImportedModules","k","_k","push","___CSS_LOADER_EXPORT___","sfc","props","target","__vccOpts","key","val","listToStyles","parentId","styles","newStyles","part","css","sourceMap","parts","hasDocument","document","DEBUG","Error","stylesInDom","head","getElementsByTagName","singletonElement","singletonCounter","isProduction","noop","options","ssrIdKey","isOldIE","navigator","test","userAgent","toLowerCase","addStylesClient","_isProduction","_options","addStylesToDom","newList","mayRemove","domStyle","refs","j","addStyle","createStyleElement","styleElement","createElement","type","appendChild","obj","update","remove","querySelector","parentNode","removeChild","styleIndex","applyToSingletonTag","bind","applyToTag","newObj","textStore","replaceText","index","replacement","filter","Boolean","styleSheet","cssText","cssNode","createTextNode","childNodes","insertBefore","setAttribute","ssrId","sources","btoa","unescape","encodeURIComponent","JSON","stringify","firstChild","cssMapping","base64","data","sourceMapping","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","d","a","definition","o","Object","defineProperty","enumerable","get","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","Vue","DB_NAME","STORE_LIVE2D_MODELS","STORE_SDK_CACHE","LOCAL_LIVE2D_MODEL_PATH_PREFIX","LOCAL_LIVE2D_MODEL_SLOT_ID","LOCAL_LIVE2D_MODEL_PATH","EMPTY_MOTION_GROUP_VALUE","RECOMMENDED_MODELS","freeze","name","path","COMMENT_STYLES","COMMENT_TRIGGER_MODE_OPTIONS","label","EMOTION_TAGS","API_SOURCES","EIKANYA_CDN_BASE","EIKANYA_RAW_BASE","DEFAULTS","x","y","z","isRecord","Array","isArray","EMOTION_TAG_SET","Set","asEmotionTag","s","String","trim","has","DEFAULT_ALIASES","dedupAliases","aliases","out","seen","raw","trimmed","createDefaultEmotionConfigs","tag","ttsContext","live2dExpression","live2dMotion","enabled","group","normalizeEmotionConfigs","byTag","Map","live2dMotionRaw","indexRaw","Number","isFinite","Math","max","floor","cfg","v","set","defaults","def","getEmotionConfigByTag","configs","resolveEmotionTag","rawTag","direct","needle","alias","getTargetConsole","top","window","parent","console","log","args","warn","error","deleteAtPath","current","last","parseSettings","rawObject","first","SettingsSchema","safeParse","success","cleaned","issue","issues","second","parse","object","apiMode","enum","apiConfig","url","string","apiKey","model","source","max_tokens","number","min","temperature","frequency_penalty","presence_penalty","top_p","top_k","usePresetSampling","boolean","sendWorldInfo","modelPath","useCdn","petPosition","petScale","autoMotionLoop","doubleTapRandomMotionEnabled","gazeFollowMouseEnabled","commentStyle","commentTriggerMode","customPrompt","roleplayName","roleplayIgnoreCommentStyle","sendCharacterCardContent","autoTrigger","triggerInterval","triggerProbability","maxChatContext","bubbleDuration","useTamakoTodaySpecial","useDiceDatabaseReference","diceReferenceVisibleSheets","array","emotionCotEnabled","emotionCotStripFromText","emotionConfigs","ttsProvider","ttsAutoPlay","ttsBilingualZhJaEnabled","phoneMessageAutoRead","baibaiPhoneMessageAutoRead","ttsDefaultSpeaker","lipSyncManualParamsEnabled","lipSyncManualParamIds","gptSoVits","apiUrl","endpoint","useCorsProxy","mediaType","streamingMode","textLang","textSplitMethod","speedFactor","strictWeightSwitch","probeOnAudioError","modelSwitchMode","setModelEndpoint","rootDir","importPathPrefix","models","desc","paths","gptWeightsPath","sovitsWeightsPath","defaultRefAudioPath","params","promptText","promptLang","refAudios","defaultRefId","expressionRefMap","record","voices","refAudioPath","useSettingsStore","parsed","getVariables","script_id","getScriptId","includes","rawBubbleDuration","bubbleDurationSeconds","round","settings","ref","watchEffect","replaceVariables","updateSettings","partial","resetSettings","next","EDGE_BASE_URL","TRUSTED_CLIENT_TOKEN","WSS_URL","VOICE_LIST_URL","clockSkewSeconds","EDGE_FALLBACK_SHORT_VOICES","shortName","locale","gender","toAbortError","message","DOMException","err","buildConnectionId","bytes","Uint8Array","globalThis","crypto","getRandomValues","random","from","b","padStart","removeIncompatibleCharacters","text","code","charCodeAt","getVoiceName","voice","async","toSha256HexUpper","TextEncoder","encode","subtle","digest","toUpperCase","K","Uint32Array","H","withOneByte","paddedLength","ceil","padded","bitLength","high","low","w","offset","s0","rotateRight","s1","c","e","f","g","h","temp1","maj","word","sha256HexUpperFallback","bits","buildSecurityParamsWithReason","ticks","Date","now","SECONDS_TO_NANOSECONDS","security","secMsGec","toFixed","secMsGecVersion","mapEdgeVoice","ShortName","Locale","Gender","resourceId","FriendlyName","fetchVoicesOnce","response","fetch","headers","Accept","serverDate","date","ts","getTime","parseServerDateHeader","clientDate","ok","status","payload","json","result","sort","localeCompare","dedupeVoices","getEdgeFallbackVoices","synthesizeWithSocketUrl","socketUrl","voiceName","timestampMode","attemptLabel","timeoutMs","Promise","resolve","reject","done","ws","timeoutId","chunks","sawSocketError","sawOpen","closeCode","closeReason","closeWasClean","finish","fn","clearTimeout","onopen","onmessage","onerror","onclose","onSocket","signal","removeEventListener","onAbort","fail","close","aborted","addEventListener","once","WebSocket","binaryType","setTimeout","timestamp","mode","toISOString","replace","slice","toUTCString","dateToString","send","buildSpeechConfigMessage","requestId","ssml","buildSsmlMessage","escapedText","escapeXml","buildSsml","event","textMessage","headerEndIndex","indexOf","headerText","line","split","idx","parseHeadersFromTextMessage","Path","ArrayBuffer","isView","buffer","byteOffset","byteLength","Blob","arrayBuffer","binary","headerLength","headerBytes","TextDecoder","decode","parseHeadersAndDataFromBinaryMessage","contentType","startsWith","handleBinary","catch","reason","wasClean","merged","totalLength","reduce","sum","chunk","concatChunks","blob","TTS_PROVIDER","LITTLEWHITEBOX","GPT_SOVITS_V2","EDGE_TTS_DIRECT","normalizePathSep","getTopWindow","getStoragePrefix","getTtsEnabledKey","getCharTtsVoiceKey","normalizeGptSoVitsSwitchMode","normalizeSetModelEndpoint","toFiniteNumber","fallback","safeObject","safeArray","buildGptSoVitsModelId","seed","normalizeGptSoVitsRefAudio","ref_audio_path","refId","prompt_text","prompt_lang","text_lang","normalizeGptSoVitsModel","globalDefaults","modelName","speaker","modelParams","text_split_method","speed_factor","media_type","streaming_mode","gpt_weights_path","sovits_weights_path","refAudioCandidates","references","refAudioList","unshift","refIds","refPaths","refIndex","entries","normalized","nextId","some","find","resolvedDefaultRefPath","rawMap","expressionMap","forEach","expr","exprText","resolvedRefId","description","normalizeGptSoVitsModelsForStoreInternal","modelList","idSet","nameSet","baseName","nextName","buildRuntimeVoiceFromModel","globalCfg","defaultRef","gptSoVitsModel","getTTSProvider","getGptSoVitsConfig","normalizedRootDir","normalizedImportPrefix","assign","normalizedModels","voiceList","toGptSoVitsVoiceConfig","legacyVoicesToModels","normalizeGptSoVitsVoice","rawCfg","ref_audio","gptPath","gpt","sovitsPath","sovits","model_switch_mode","set_model_endpoint","strict_weight_switch","normalizeGptSoVitsModelsForStore","isGptSoVitsVoiceUsable","pickFirstUsableGptSoVitsVoice","getFileExtLower","lastIndexOf","stripFileExt","isAbsoluteFileSystemPath","pathStr","p","joinPathPrefix","prefix","relPath","rel","useBackslash","sep","cleanPrefix","cleanRel","normalizedPrefix","normalizedRel","lowerPrefix","lowerRel","prefixSegs","relSegs","tail","inferLangFromText","t","cleanPromptTextFromFilenameBase","cleanVoiceNameFromWeightsBase","suffixes","before","re","pickLargestFile","files","size","pickBestAudioFile","audioFiles","candidates","file","ext","score","weightsStemKey","fileName","stem","collectWeightCandidates","ckpts","pths","ckptList","pthList","ckptByBase","ckptByStem","base","used","addCandidate","gptFile","sovitsFile","pth","matched","usedGpt","usedSovits","inferExpressionTagFromAudioName","rules","patterns","rule","pattern","inferGptSoVitsModelsFromFolderFiles","fileList","importOptions","normalizedRootHint","relativeRootName","normalizeRelativePath","webkitRelativePath","lowerRoot","groups","dirKey","groupFiles","audios","toServerPath","abs","audioCandidates","inferredTag","bestAudio","weightCandidatesRaw","weightCandidates","dirName","pop","groupNameUsed","pair","defaultRefBase","audioIndex","lang","defaultPromptText","defaultLang","getGptSoVitsVoiceList","_lwbTtsCache","_lwbTtsCacheTime","_edgeTtsCache","_edgeTtsCacheTime","getEdgeDirectVoiceListAsync","securityResult","urls","lastError","fetchEdgeVoices","getTTSVoiceListAsync","provider","getGptSoVitsVoiceListAsync","mySpeakers","cache","volc","fetchLittleWhiteBoxTTSConfig","isFreeVoice","inferResourceId","getVoiceDesc","topAny","xbTts","xiaobaixTts","getConfig","config","xbVoiceData","XB_TTS_VOICE_DATA","inferSource","scene","lower","female_1","female_2","female_3","female_4","female_5","female_6","female_7","male_1","male_2","male_3","male_4","configurable","getTTSEnabled","saved","localStorage","getItem","_db","getDb","setDb","initDB","existing","request","indexedDB","open","onsuccess","db","onversionchange","onupgradeneeded","database","transaction","objectStoreNames","contains","store","createObjectStore","keyPath","createIndex","unique","objectStore","indexNames","ensureLive2DStore","ensureSdkCacheStore","LIVE2D_RUNTIME_TYPES","LEGACY","CUBISM5","RUNTIME_TYPE_SET","values","normalizeCubismVersion","major","match","parseInt","parseMajorVersion","inferCubismVersionFromModelJson","modelJson","jsonRecord","directCandidates","Version","version","Meta","meta","candidate","FileReferences","Model","normalizeLive2DRuntimeType","resolveRuntimeTypeFromCubismVersion","cubismVersion","resolveLive2DRuntime","modelData","input","inferredVersion","runtimeType","withResolvedLive2DRuntime","resolved","resolveSlotId","_modelId","ensureDb","saveLive2DModel","cubismVersionRaw","uploadTimeRaw","uploadTime","fileSizeRaw","fileSize","modelId","moc3","moc","physics","pose","textures","motions","expressions","normalizeStoredModel","put","oncomplete","getLive2DModel","slotId","hasLive2DModel","Live2DLoader","PIXI_URL","CUBISM4_CORE_URL","CUBISM4_CORE_FALLBACK_URLS","CUBISM5_CORE_URL","CUBISM5_CORE_FALLBACK_URLS","CUBISM2_CORE_URL","SDK_URL","CUBISM5_RUNTIME_URL","CUBISM5_RUNTIME_FALLBACK_URLS","SDK_CACHE_KEY","_READY_MARK","_RUNTIME_KEY","isLoaded","loadPromise","legacyCoreLoaded","legacyCorePromise","legacyCoreSource","cubism5CoreLoaded","cubism5CorePromise","cubism5CoreSource","cubism5RuntimeLoaded","cubism5RuntimePromise","cubism5RuntimeSource","legacyLive2DNamespace","cubism5Live2DNamespace","patchedResolveUrlPrototypes","WeakSet","patchedXhrLoaderNamespaces","pixiUrlResolvePatched","pixiUrlResolveOriginal","legacyCoreObject","cubism5CoreObject","activeCoreType","loadedScriptUrls","_getUrlBase","URL","location","href","hash","search","slashIndex","_normalizeRuntimeUrl","_ensureCubismCoreLocateFile","_topWindow","coreUrl","baseUrl","Live2DCubismCore","locateFile","_loadScriptSrc","doc","script","timer","src","crossOrigin","onload","load","_getRuntime","getRuntime","_doLoad","targetWindow","runtime","_setRuntime","_detectActiveRuntimeType","getPixi","pixi","activeNamespace","PIXI","live2d","Live2DModel","live2dModel","live2dNamespace","getRuntimeNamespace","pixiVersion","VERSION","loadedAt","_getLatestMocVersion","csmGetLatestMocVersion","_waitForLatestMocVersion","expectedMajor","intervalMs","startedAt","latestVersion","_isLegacyMocVersion","latestMocVersion","_isCubism5MocVersion","requiredVersion","_setGlobalCubismCore","coreObject","ensureLegacyCore","previousCore","coreUrls","_getCubism4CoreUrls","coreText","then","_executeScript","loadedVersion","candidateError","ensureCubism5Core","requiredLatestVersion","existingIsCubism5","hasPinnedCubism5Source","_getCubism5CoreUrls","_isDirectResourceUrl","_patchPixiUrlResolve","utils","urlApi","originalResolve","loaderRef","resourcePath","_patchModelSettingsResolveURL","runtimeNamespace","runtimeLabel","patchedCount","ctorName","proto","resolveURL","__galgameResolveUrlPatched","originalResolveURL","_patchXhrLoader","XHRLoader","originalLoader","loader","hasNamespace","hasXHRLoader","loaderType","context","rawUrl","requestUrl","requestType","header","signature","fromCharCode","_getCubism5RuntimeUrls","pushUrl","fallbackUrl","ensureCubism5Runtime","runtimeUrls","runtimeUrl","runtimeText","activateRuntime","pixiText","Live2D","core2Text","cached","_getFromCache","sdk","sdkText","_saveToCache","textContent","tx","clearCache","delete","DEFAULT_CONFIG","longPressDelay","doubleClickWindow","moveThreshold","GestureRecognizer","element","onGesture","isDraggingCheck","state","startPos","longPressTimer","doubleClickTimer","longPressFired","moved","activePointerId","destroyed","boundPointerDown","boundPointerMove","boundPointerUp","boundContextMenu","constructor","maxTouchPoints","handlePointerDown","handlePointerMove","handlePointerUp","preventDefault","destroy","clearAllTimers","_e","pointerType","isPrimary","pointerId","clientX","clientY","clearLongPressTimer","resetState","dx","dy","sqrt","clearDoubleClickTimer","Live2DStage","app","canvas","glContext","container","mountStack","mountMode","_pendingFloatingResize","loadingOverlay","loadingText","loadingBarFill","interactionLayer","gestureRecognizer","_dragClass","_minVisiblePx","_interactionPaddingPx","_alphaHitThreshold","_maxPixelScanSamples","_onPositionChange","_boundWindowResize","_interactionSyncTimer","_pixelReadBuffer","_lastClampLogAt","_clampPosition","width","height","minVisible","_top","viewportWidth","innerWidth","documentElement","clientWidth","viewportHeight","innerHeight","clientHeight","safeWidth","safeHeight","safeMinVisibleX","safeMinVisibleY","minX","minY","maxX","maxY","safeX","safeY","clampedX","clampedY","clamped","_shouldClampCurrentPosition","hasCustom","style","right","bottom","hasExplicitLeftTop","left","_getContainerRectSize","rect","getBoundingClientRect","_isRectFullyOutsideViewport","_getVisibleAreaRatio","rectWidth","rectHeight","visibleLeft","visibleTop","visibleRight","visibleBottom","visibleArea","totalArea","_clampPositionByAxis","viewportSize","safeSize","safeViewport","safeMinVisible","safeValue","_clampContainerToViewport","shouldClamp","fullyOutside","visibleRatio","isResizeClamp","forceFullVisible","minVisibleX","minVisibleY","nextX","nextY","to","_bindWindowResize","_unbindWindowResize","passive","_getPIXI","_measureOpaqueBoundsFromCanvas","containerWidth","containerHeight","gl","bufferWidth","drawingBufferWidth","bufferHeight","drawingBufferHeight","pixels","readPixels","RGBA","UNSIGNED_BYTE","scanStep","alphaThreshold","rowOffset","scaleX","scaleY","_syncInteractionLayerBounds","disableLayer","pointerEvents","cursor","parseFloat","applyBounds","padding","x1","y1","stage","children","alphaBounds","getBounds","bounds","fallbackWidth","fallbackHeight","_startInteractionSyncTimer","_stopInteractionSyncTimer","setInterval","clearInterval","_enablePointerDrag","$container","dragTarget","onPositionChange","startClientX","startClientY","startLeft","startTop","dragging","touchPointerIds","getRectSize","cleanup","removeClass","button","getRectLeftTop","setPointerCapture","dist","addClass","onPointerUp","topPx","releasePointerCapture","getSelection","removeAllRanges","_ensureLoadingOverlay","overlay","ownerDocument","hideLoadingProgress","panel","track","fill","showLoadingProgress","percent","safePercent","create","stale","getElementById","position","body","className","dpr","devicePixelRatio","getContext","alpha","antialias","stencil","depth","preserveDrawingBuffer","premultipliedAlpha","attrs","getContextAttributes","Application","view","backgroundAlpha","autoStart","resolution","autoDensity","$","draggable","handle","start","ui","drag","stop","interactionTarget","currentScale","scale","isPinching","pinchStartDistance","pinchStartScale","activeTouchPointers","emitScaleChange","nextScale","safeScale","onScaleChange","getPinchDistance","points","setDraggableState","onTouchPointerEnd","distance","delta","deltaY","onTap","onDoubleTap","onLongPress","hasClass","getStage","isPreviewMounted","pushMount","mountEl","isConnected","nextSibling","styleText","getComputedStyle","popMount","entry","restore","resize","resizeFloating","renderer","resizePreview","BUILTIN_EXPR_TOKEN_PREFIX","BUILTIN_MOTION_TOKEN_PREFIX","BUILTIN_EXPRESSION_DEFS","fadeIn","fadeOut","parameters","ParamAngleX","ParamAngleY","ParamAngleZ","ParamEyeLOpen","ParamEyeROpen","ParamEyeLSmile","ParamEyeRSmile","ParamEyeBallX","ParamEyeBallY","ParamBrowLY","ParamBrowRY","ParamBrowLX","ParamBrowRX","ParamBrowLAngle","ParamBrowRAngle","ParamBrowLForm","ParamBrowRForm","ParamMouthForm","ParamMouthOpenY","ParamCheek","ParamBodyAngleX","ParamBodyAngleY","ParamBodyAngleZ","BUILTIN_MOTION_DEFS","durationMs","loop","easing","keyframes","BUILTIN_EXPRESSION_TAG_MAP","BUILTIN_MOTION_TAG_MAP","BUILTIN_EXPRESSIONS_BY_KEY","BUILTIN_MOTIONS_BY_KEY","normalizeTokenValue","makeBuiltinExpressionToken","makeBuiltinMotionToken","parseBuiltinExpressionToken","parseBuiltinMotionToken","getBuiltinExpressionByKey","getBuiltinMotionByKey","EXPRESSION_LIVE2D_MAP","uniquePush","uniquePushAllowEmpty","finalValue","uniqueMotionPush","normalizeFileStem","noQuery","filePart","decoded","decodeURIComponent","normalizeDefinitionName","directName","Name","Id","File","collectSettingsCandidates","motionManager","internalModel","rawSettings","isExpressionFileLike","isMotionFileLike","isMotionDefinition","node","soundLike","Sound","sound","countMotionDefinitions","count","mergeGroupCount","keyRaw","groupName","parsedCount","safeCount","prev","pushFromContainer","names","fallbackPrefix","fallbackPrefixInner","pushFromList","fallbackName","collectExpressionNamesFromUnknown","visited","visit","itemAny","fileLike","anyObj","directFile","rawKey","keyLower","keyIsExpression","nextContext","collectMotionGroupCountsFromUnknown","parentKey","keyIsMotionContainer","nested","nestedRawKey","nestedValue","nestedRaw","nestedKey","nestedCount","pushMotionEntriesFromGroupContainer","isKnownMotionDef","groupRaw","groupTrimmed","collectMotionEntries","definitions","settingsCandidates","Motions","collectExpressionNames","expressionManager","Expressions","getExpressionCount","getExpressionName","getExpressionFile","collectMotionGroupNames","groupNames","pushFromObject","keys","motionGroups","anySettings","getMotionGroupCount","getMotionGroupName","getMotionGroupNames","normalizeMotionOverrideGroup","rawGroup","matchLive2DMotion","targetExpression","override","overrideGroupRaw","hasEmptyGroupMarker","overrideGroup","overrideIndexRaw","overrideIndex","exactByGroupIndex","exactGroup","exactInGroup","firstInGroup","exactByName","fuzzyByName","nameLower","fuzzyGroup","mapping","candidateRaw","exact","fuzzy","resolveLive2DExpression","overrideName","builtinKey","nativeName","matchLive2DExpression","builtinDef","resolveLive2DMotion","explicitBuiltin","nativeMotion","TICKER_REGISTERED_FLAG","TICKER_RUNTIME_REGISTRY_KEY","Live2DManager","_JSDELIVR_HOSTS","_runtime","_runtimeType","_runtimeInfo","_localBlobUrls","_xhrBlobUrlSupport","_xhrBlobUrlSupportPromise","_hasLoggedBlobUrlDisabled","isReady","modelBaseWidth","modelBaseHeight","modelBaseBounds","_lastModelJson","_lastModelJsonSourceUrl","_autoMotionTimer","autoMotionLoopEnabled","_mouthParamCore","_mouthParamIds","_mouthParamIndexes","_mouthParamRangeMins","_mouthParamRangeMaxs","_mouthParamWarned","_mouthCurrentValue","_lipSyncActive","_inModelUpdate","_writeMaskCore","_writeMaskRestore","_updateHookModel","_updateHookRestore","_manualMouthParamEnabled","_manualMouthParamIds","_manualMouthParamIdSet","_builtinMotionPlayer","_builtinMotionFrameState","runtimePixi","_setRuntimeInfo","runtimeInfo","_registerLocalBlobUrl","_revokeLocalBlobUrls","topURL","revokeObjectURL","_disableXhrBlobUrls","_supportsXhrBlobUrls","XHR","XMLHttpRequest","createObjectURL","blobUrl","xhr","responseType","timeout","buf","onabort","ontimeout","finally","supported","_isLocalModelPath","_normalizeLocalModelId","_path","_toArrayBuffer","_normalizeMocVersion","rawMocVersion","_readMoc3HeaderVersion","moc3Data","moc3Buffer","DataView","getUint32","_detectCubismVersionFromMoc3Buffer","core","Moc","fromArrayBuffer","csmGetMocVersion","mocRef","_release","release","_detectRuntimeFromMoc3","resolvedRuntime","headerVersionRaw","headerVersion","runtimeWithHeader","moc3Version","resolvedVersion","_isCoreParseError","stack","_ensureRuntimeDependencies","contextLabel","requiredMocVersion","patched","fallbackRuntime","_getLive2DModelClass","namespace","_getTickerRuntimeRegistry","registry","_registerTickerForRuntime","registerTicker","Ticker","_blobToDataUrl","reader","FileReader","readAsDataURL","_normalizeStoredPath","_getPathBaseName","lastSlash","_guessMimeTypeByPath","endsWith","_findStoredTextureBlob","targetPath","normalizedTarget","targetBaseName","byBase","indexed","_findStoredMotionData","targetNormalized","targetGroup","groupList","crossExact","crossByBase","_findStoredExpressionData","_toLocalBlobUrl","mimeType","_toLocalDataUrl","_buildLocalModelBlobUrl","modifiedModelJson","_normalizeLegacyCubism2Settings","mapFile","pathHint","fallbackMime","mocUrl","Textures","texPath","textureBlob","physicsUrl","Physics","poseUrl","Pose","motionListRaw","motionList","targetList","storedMotion","existingDef","motionPath","motionData","motionUrl","storedExpr","exprPath","exprData","exprUrl","mocPath","textureList","texturePath","textureUrl","physicsPath","posePath","motionDef","exprDef","modelBlob","_buildLocalModelDataUrl","_encodePathSegment","segment","safeChar","encoded","ch","_normalizeRemoteUrl","inputUrl","urlObj","pathname","_normalizeResourceRef","inputRef","qIndex","pathPart","queryPart","_getMirrorEikanyaModelUrl","modelUrl","_expandJsDelivrHosts","hostname","results","host","u","_convertJsDelivrGhToRawCandidates","owner","repoWithRef","filePath","repo","suffix","_buildModelUrlCandidates","bases","addBase","mirrorUrl","variant","_createModelWithTimeout","dataUrl","timeoutPromise","_resolve","race","autoUpdate","autoInteract","_fetchWithTimeout","init","AbortController","controller","abort","_toPositiveNumber","_toScale","_readModelBaseBounds","getLocalBounds","_resolveModelBaseBounds","measured","_applyStageTransform","stageWidth","stageHeight","safeStageWidth","safeStageHeight","safeModelWidth","safeModelHeight","fitScale","finalScale","visible","anchor","pivot","modelWidth","modelHeight","hintKeys","texture","textureId","skin","defaultTexture","defaultSkin","selected","hint","normalizedTextures","textureCount","_clearAutoMotionLoop","_stopCurrentMotion","stopped","tryCall","method","mm","animator","internal","stopCurrentMotion","_refreshManualMouthParams","ids","_setLipSyncActive","active","coreModel","_ensureLipSyncHooks","_installCoreWriteMask","setAutoMotionLoopEnabled","_startAutoMotionLoop","_pickDefaultMotionGroup","preferred","token","initialGroups","getMotionGroups","motionGroup","allGroupNames","playOne","playMotion","randGroup","randIndex","groupCount","_stripJsonComments","output","inString","quoteChar","escaping","inLineComment","inBlockComment","_tryParseModelJson","_buildModelJsonCandidates","_fetchModelJsonCandidate","useProxy","_getProxiedUrl","resp","sourceUrl","originalUrl","getCorsProxyUrl","proxied","enableCorsProxy","corsProxy","getProxyUrl","origin","retries","loadModel","onProgress","progress","reportProgress","loadWithRuntime","progressStart","progressSuffix","texturesReady","_waitForTextures","loadedCount","totalCount","ratio","destroyModel","loadedFrom","localModelData","buildLocalUrl","preferBlob","usedBlobUrl","localUrl","loaded","localError","localDataUrl","dataFallbackError","forcedRuntime","retryLocalUrl","forcedRetryError","modelUrlCandidates","candidateUrl","attemptProgressStart","attemptModel","attemptTexturesReady","attemptError","tryCreate","runtimeHint","_buildRemoteModelDataUrl","firstError","proxyDataUrl","proxyError","proxyForcedRetryError","measuredBounds","getExpressions","forceProxyResources","candidateUrls","sourceModelUrl","directError","resolveUrl","UserData","remoteMocUrl","mocResponse","mocBuffer","mocProbeError","modelJsonStr","mountToStage","removeChildAt","transform","addChild","updateScale","_getModelBaseSize","fallbackNames","mergeGroupMap","keyTrimmed","defs","getMotions","pushAll","items","cachedAny","motionsContainer","_getCoreModel","_getBuiltinParameterAliases","paramId","pid","mapped","deduped","_getBuiltinParamFallbackRange","_getCoreParameterIndex","getParameterIndex","getParamIndex","getParameterCount","getParameterId","_getCoreParameterRange","paramIndex","NaN","asNumber","getParameterMinimumValue","getParameterMaximumValue","getParamMin","getParamMax","_mapBuiltinNormalizedValue","normalizedValue","_writeCoreParameterById","weight","safeWeight","targetValue","tryInvoke","apply","_applyBuiltinNormalizedParam","range","_applyBuiltinParamWithAliases","_setBuiltinMotionFrameState","_applyBuiltinPostUpdate","motionState","applied","applyBuiltinExpression","builtinExpressionKey","expressionDef","appliedCount","stopBuiltinMotion","topWindow","rafId","cancelAnimationFrame","resetParams","resetWeight","playBuiltinMotion","builtinMotionKey","frame","requestFrame","requestAnimationFrame","perfNow","performance","step","currentState","elapsed","easedProgress","pow","applyEasing","prevFrame","nextFrame","frameSpan","localAlpha","paramNames","currentParams","prevValue","nextValue","blended","playExpression","expression","runMotionWithRuntimeFallback","motionIndex","motion","startMotion","startRandomMotion","tryRecoverByKnownEntries","playRandomAnimation","focusByClientPoint","immediate","focus","focusController","normalizedX","normalizedY","focusCenter","setMouthOpen","_characterId","clampedValue","logPrefix","getParamRange","readNumber","mapToParamValue","getIndexById","applyById","mappedValue","setParameterValueById","addParameterValueById","setParamFloat","addParamFloat","applyByIndex","setParameterValueByIndex","addParameterValueByIndex","setParameterValue","addParameterValue","appliedAny","manualId","paramName","numericFallback","picked","pidx","msg","presetCandidates","scannedIds","_isMouthParam","paramIdOrIndex","restoreEntries","methods","getParamRef","paramRef","updater","rawUpdate","self","ret","_applyMouthValueToModel","oldValue","_getMouthParamSource","getLipSyncDebugInfo","lipSyncOverride","mouthParamsSource","mouthParamsCount","clear","retryCount","check","_textures","tex","baseTexture","valid","every","_ttsGetProxiedAudioUrlRef","LipSyncManager","audioContext","analyser","dataArray","animationFrameId","currentCharacterId","lastVolume","connectedAudioElements","_proxyAudio","_proxyAudioCleanup","fftSize","smoothingFactor","sensitivity","minThreshold","resume","AudioContextClass","AudioContext","webkitAudioContext","createAnalyser","smoothingTimeConstant","frequencyBinCount","_getProxiedAudioUrl","connectAudio","audioElement","disconnect","targetAudio","isLocalhost","isDataUrl","isBlobUrl","isSameOrigin","proxiedUrl","Audio","substring","currentTime","volume","paused","play","syncPlay","syncPause","pause","syncSeek","createMediaElementSource","connect","destination","getVolume","getByteFrequencyData","average","startSync","characterId","stopSync","frameCount","getSettingsSnapshot","_showToastRef","showToast","toastr","info","clipText","isProxyNotFound","bodyText","normalizePathSepForGpt","looksLikeAbsoluteFsPath","hasLive2D","TTSManager","autoPlay","isPlaying","isLoading","currentAudio","currentSegmentId","littleWhiteBox","_gptSoVitsResolvedProxyRoute","_gptSoVitsActiveWeights","_gptSoVitsWeightSwitchUnavailable","_gptSoVitsWeightSwitchWarned","_gptSoVitsProxyWarned","_gptSoVitsFetchController","_edgeDirectFetchController","_edgeDirectSocket","_edgeDirectObjectUrl","_refreshProviderState","LittleWhiteBox","_onPlaybackEnded","_cleanupEdgeDirectResources","hideLoadingIndicator","jq","jQuery","on","showLoadingIndicator","classList","_abortGptSoVitsFetch","player","_stopCurrent","_getCurrentAudioElement","audio","audioElements","allAudio","querySelectorAll","anyAudio","_getPreferredAudioElement","_resolveGptSoVitsServerPath","resolvedCfg","root","_buildGptSoVitsRefAudioPathCandidates","opts","modelCfg","voiceCfg","rawSeed","rawFromVoice","rawRefPath","addOne","addPath","normalize","dirname","extractDrive","seedSources","pushSeed","mainSeed","basename","segments","tail2","tail3","weightPaths","weightDirs","weightPath","dir","seedDrive","altDrives","drive","snapshot","RegExp","wavePairs","_isProxyUrl","safeUrl","_getGptSoVitsProxyUrlFromHelpers","directUrl","helperFns","_buildGptSoVitsProxyUrl","route","rawTarget","noHash","qIdx","buildProxyPathRawTarget","_rememberProxyRoute","helperUrl","remembered","rememberedUrl","_buildGptSoVitsTtsUrl","resolvedVoice","endpointRaw","defaultRefPath","vcfg","refAudioPathRaw","searchParams","_requestGptSoVitsApi","queryParams","jsonBody","pathRaw","directUrlObj","attemptTargets","addTarget","errors","credentials","_fetchGptSoVitsApi","_postGptSoVitsApi","_setGptSoVitsWeights","kind","weightsPath","normalizedKind","weights_path","_setGptSoVitsModelPair","endpointOverride","gpt_model_path","sovits_model_path","_ensureGptSoVitsWeights","modelPaths","switchMode","desiredGpt","desiredSovits","failures","trySetModelFallback","triggerMsg","fallbackErr","setModelError","setModelFetchBlocked","fetchBlocked","detail","clipped","_speakWithGptSoVits","segmentId","refAudioRaw","requestText","refAudioPathCandidatesSeed","refAudioPathCandidates","seenRefAudioPath","addRefAudioPathCandidate","directUrlCandidates","seenDirectUrl","candidateRefPath","voiceForRequest","audioUrlCandidates","seenAudioUrl","addAudioUrl","onEnded","playError","started","nextUrl","candidateIndex","totalCandidates","blockedByAutoplay","lipId","_startLipSyncOnPlay","_speakWithEdgeDirect","cleanText","attempts","plainBase","attemptErrors","attempt","ua","isEdgeUA","allUnopened","likelyUaRejected","securityHint","synthesizeToBlob","socket","blockedHint","objectUrl","_startLipSyncWhenModelReady","maxWait","startTime","tryWait","_waitForModelReadyBeforeTTS","hasStarted","tryBind","preferredAudio","_bindLipSyncToAudio","onPlaying","onTimeUpdate","onEnd","speak","ttsConfig","tts","boundVoice","getCharacterTTSVoice","defaultVoice","resolveVoiceByName","speakerValue","contextTexts","callGenerate","JP_SPLIT_MARKER_RE","ChatMonitor","messageCount","ignoreNextCount","_onTrigger","_stops","_lastUserSignalAt","_config","onTrigger","messageSentStop","_bindEvent","_messageId","_recordUserSignal","userRenderedStop","afterCommandsStop","_type","option","dryRun","quiet_prompt","generationStartedStop","generationEndedStop","_handleTriggerCount","_resolveEventName","eventKey","fromSillyTavern","SillyTavern","eventTypes","fromLegacy","tavern_events","handler","eventName","eventSource","off","eventOn","updateConfig","_shouldCountBySource","_checkAutoTrigger","roll","manualTrigger","markSelfGeneration","PROMPT_TEMPLATES","systemPrompt","responseFormat","resolvePromptTemplate","template","appendEmotionCotFormat","appendZhJaBilingualFormat","buildRoleplayInstruction","roleplay","roleName","lines","characterCardContent","shouldIgnoreStyleByRoleplay","ignoreCommentStyle","buildContextLines","chatContext","role","getDiceReferenceText","diceReference","referenceText","buildDiceReferenceInstruction","appendDiceAdviceRequirement","Commentator","isGenerating","_onComment","_streamStop","_latestStreamText","setCallback","cb","generate","emittedDone","chatMessages","_getChatContext","todaySpecial","_getTamakoTodaySpecialContent","roleplayOptions","_resolveRoleplayOptions","diceReferenceOptions","_resolveDiceReferenceOptions","system","user","bilingualZhJaEnabled","ignoreStyleByRoleplay","responseFormatWithAdvice","responseFormatWithEmotion","finalFormat","roleplayInstruction","diceReferenceInstruction","contextLines","systemParts","buildPrompt","_generateCustom","_generateTavern","finalText","chat","userMessage","getChatResponseFormat","safeUserMessage","buildChatPrompt","maxTokens","_setupStreamListener","orderedPrompts","generateRaw","should_silence","should_stream","ordered_prompts","custom_api","_cleanupStreamListener","usePreset","buildAttemptBody","messages","stream","chat_completion_source","custom_prompt_post_processing","reverse_proxy","custom_url","custom_include_headers","requestWithAttempt","getRequestHeaders","errTxt","statusText","choices","details","iframe_events","STREAM_TOKEN_RECEIVED_FULLY","fullText","maxCount","getChatMessages","hide_state","safeMaxCount","_getCurrentCharacterCardContent","visibleSheets","visibleSheetNames","_normalizeDiceVisibleSheetNames","_getDiceDatabaseReferenceContent","apiData","_getDiceDatabaseDataFromApi","apiSummary","_summarizeDiceDatabasePayload","chatData","_getDiceDatabaseDataFromChatContext","api","AutoCardUpdaterAPI","exportTableAsJson","_normalizeDiceDatabasePayload","_pickDiceDatabasePayloadFromMessage","TavernDB_ACU_IndependentData","TavernDB_ACU_Data","TavernDB_ACU_SummaryData","isolatedCandidates","TavernDB_ACU_IsolatedData","_pickDiceDatabasePayloadFromIsolatedData","isolated","_parseMaybeJsonRecord","slot","independentData","_isDiceDatabasePayload","sourceLabel","visibleNameSet","_normalizeReferenceText","sheets","sheet","priority","_getDiceSheetPriority","_buildDiceSheetSummary","nextLine","sheetName","rows","row","cell","dataRows","rowText","_formatDiceSheetRow","pairs","_truncateReferenceText","maxLength","characters","charIdRaw","idText","idNum","currentName","name2","fields","personality","scenario","first_mes","mes_example","system_prompt","post_history_instructions","_normalizeCharacterCardField","topDocument","currentSelector","plotContent","directText","_sanitizeTamakoText","innerText","beautifierFrame","_readTamakoPayloadFromIframe","payloadText","_extractTamakoTextFromPayload","currentContent","iframe","captureTags","_getTamakoCaptureTags","tags","valuesFromTags","_extractTamakoTagText","extensionSettings","TamakoMarket","safeTag","escapedTag","regex","exec","RE_THINK_CLOSED","RE_THINK_UNCLOSED","parseBracketContent","bracketContent","pipeParts","exprVoicePart","parseEmotionCotText","rawText","stripThinkBlocks","normalizedTag","trimStart","after","isPendingPrefix","speakerMatch","stripFromText","prefixMatch","useUiStore","showSettings","openSettings","closeSettings","_hoisted_1","class","_hoisted_2","_hoisted_3","__name","isDone","autoCloseDelaySeconds","emits","setup","__props","emit","__emit","displayText","bubbleStyle","LOADING_FRAMES","positionTimer","loadingTimer","autoCloseTimer","loadingFrameIndex","getFiniteNumber","updateBubblePosition","vw","vh","getModelHeadAnchor","fallbackX","fallbackY","rawLeft","rawTop","safeLeft","safeTop","startPositionSync","stopPositionSync","stopLoadingAnimation","stopAutoCloseTimer","scheduleAutoClose","delayMs","delaySeconds","normalizedSeconds","getAutoCloseDelayMs","closeBubble","watch","onUnmounted","_ctx","_cache","onClick","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","placement","motionLoopEnabled","menuEl","inputEl","chatOpen","posX","posY","panelTransform","computed","panelStyle","clampIntoViewport","el","openChat","nextTick","select","onInputKeydown","shiftKey","onGlobalKeydown","ref_key","$event","$emit","placeholder","onKeydown","disabled","_","isModelFile","FILTERED_EXTENSIONS","shouldShow","fetchDirectory","remaining","resetTime","resetDate","RateLimitError","isModel","super","toLocaleTimeString","searchQuery","expanded","loading","loadedOnce","childError","isSelected","filteredChildren","q","loadChildren","handleClick","_component_TreeNode","paddingLeft","title","child","onSelectModel","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","rootEntries","rootLoading","errorMsg","selectedPath","selectedName","filteredRootEntries","confirmLoad","cdnUrl","encodedPath","buildCdnUrl","loadRoot","TreeNode","Live2DUploader","JSZip","_loadJSZip","uploadZip","zip","loadAsync","modelJsonEntry","_findModelJson","modelDir","modelJsonText","isModel3","isModel2","_extractFile","moc3HeaderVersion","detectedCubismVersion","_resolveModel3CubismVersion","_extractTextures","_extractMotions","_extractExpressions","_extractFileOptional","_extractTexturesV2","_extractMotionsV2","_extractExpressionsV2","jsonFallbackVersion","jsonEntries","best","bestScore","baseDir","relativePath","fullPath","normalizedPath","texPathRaw","collectScannedMotions","scanAllZip","scanned","scannedMotions","exprList","scannedExprs","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","_hoisted_58","_hoisted_59","_hoisted_60","_hoisted_61","_hoisted_62","_hoisted_63","_hoisted_64","_hoisted_65","_hoisted_66","_hoisted_67","_hoisted_68","_hoisted_69","_hoisted_70","_hoisted_71","_hoisted_72","_hoisted_73","_hoisted_74","_hoisted_75","_hoisted_76","_hoisted_77","_hoisted_78","_hoisted_79","_hoisted_80","_hoisted_81","_hoisted_82","_hoisted_83","_hoisted_84","_hoisted_85","_hoisted_86","_hoisted_87","_hoisted_88","_hoisted_89","_hoisted_90","_hoisted_91","_hoisted_92","_hoisted_93","_hoisted_94","_hoisted_95","_hoisted_96","_hoisted_97","_hoisted_98","_hoisted_99","_hoisted_100","_hoisted_101","_hoisted_102","_hoisted_103","_hoisted_104","_hoisted_105","_hoisted_106","_hoisted_107","_hoisted_108","_hoisted_109","_hoisted_110","_hoisted_111","_hoisted_112","_hoisted_113","_hoisted_114","_hoisted_115","_hoisted_116","_hoisted_117","_hoisted_118","_hoisted_119","_hoisted_120","_hoisted_121","_hoisted_122","_hoisted_123","_hoisted_124","_hoisted_125","_hoisted_126","_hoisted_127","_hoisted_128","_hoisted_129","_hoisted_130","_hoisted_131","_hoisted_132","_hoisted_133","_hoisted_134","_hoisted_135","_hoisted_136","_hoisted_137","_hoisted_138","_hoisted_139","_hoisted_140","_hoisted_141","_hoisted_142","_hoisted_143","_hoisted_144","_hoisted_145","_hoisted_146","_hoisted_147","_hoisted_148","_hoisted_149","_hoisted_150","_hoisted_151","_hoisted_152","_hoisted_153","_hoisted_154","_hoisted_155","_hoisted_156","_hoisted_157","_hoisted_158","_hoisted_159","_hoisted_160","_hoisted_161","_hoisted_162","_hoisted_163","_hoisted_164","_hoisted_165","_hoisted_166","_hoisted_167","_hoisted_168","_hoisted_169","_hoisted_170","_hoisted_171","_hoisted_172","_hoisted_173","_hoisted_174","_hoisted_175","_hoisted_176","_hoisted_177","_hoisted_178","_hoisted_179","_hoisted_180","_hoisted_181","_hoisted_182","_hoisted_183","_hoisted_184","_hoisted_185","_hoisted_186","_hoisted_187","_hoisted_188","_hoisted_189","_hoisted_190","_hoisted_191","_hoisted_192","_hoisted_193","_hoisted_194","_hoisted_195","_hoisted_196","_hoisted_197","_hoisted_198","_hoisted_199","_hoisted_200","_hoisted_201","_hoisted_202","_hoisted_203","_hoisted_204","_hoisted_205","_hoisted_206","_hoisted_207","_hoisted_208","_hoisted_209","_hoisted_210","_hoisted_211","_hoisted_212","_hoisted_213","_hoisted_214","_hoisted_215","_hoisted_216","_hoisted_217","_hoisted_218","_hoisted_219","_hoisted_220","_hoisted_221","_hoisted_222","_hoisted_223","_hoisted_224","_hoisted_225","_hoisted_226","_hoisted_227","_hoisted_228","_hoisted_229","_hoisted_230","_hoisted_231","_hoisted_232","_hoisted_233","_hoisted_234","_hoisted_235","_hoisted_236","_hoisted_237","_hoisted_238","_hoisted_239","_hoisted_240","_hoisted_241","_hoisted_242","_hoisted_243","_hoisted_244","_hoisted_245","_hoisted_246","_hoisted_247","_hoisted_248","_hoisted_249","_hoisted_250","sectionTabs","en","activeSection","toBoundedNumber","clamp","ensureNumericSettingsIntegrity","temperatureLabel","frequencyPenaltyLabel","presencePenaltyLabel","topPLabel","petScaleLabel","recommendedModels","commentStyles","commentTriggerModeOptions","apiSources","showBrowser","customModelUrl","localModelFileInput","uploadingLocalModel","localModelActionBusy","localModelStatus","localModelError","localModelInfo","localModelBusy","localModelExists","diceReferenceSheetOptions","refreshingDiceSheetOptions","normalizeDiceReferenceSheetName","dedupeDiceReferenceSheetNames","parseDiceReferenceRecord","isDiceReferencePayload","extractDiceReferenceSheetNamesFromPayload","tableRecord","pickDiceReferencePayloadFromIsolatedData","pickDiceReferencePayloadFromMessage","getDiceReferenceSelectedSheets","setDiceReferenceSelectedSheets","isDiceSheetVisible","diceReferenceSheetSummary","optionsCount","refreshDiceReferenceSheetOptions","fromApi","readDiceReferenceSheetNamesFromApi","fromChat","readDiceReferenceSheetNamesFromChat","selectAllDiceReferenceSheets","clearDiceReferenceSheets","ttsEnabled","ttsVoiceList","refreshingTtsVoices","gptSoVitsModelsJson","gptSoVitsVoicesJson","ttsTestText","showGptModelManager","showGptModelEditor","gptModelManagerSearch","gptModelManagerModels","gptModelManagerImportJsonInputRef","gptModelManagerImportFolderInputRef","gptModelEditor","gptModelEditorModelId","gptModelEditorExpressionRows","isGptSetModelMode","ttsVoiceHint","gptModelSummaryHint","enabledCount","refCount","defaultSpeaker","filteredGptModelManagerModels","keyword","emotionTags","live2dExpressions","live2dMotionGroups","live2dMotions","refreshingLive2dLists","live2dExpressionOptions","dedup","live2dExpressionSelectOptions","builtin","live2dExpressionOptionSet","normalizeMotionIndex","normalizeMotionGroupValue","isEmptyMotionGroupMarker","normalizeMotionOverridePayload","explicitEmptyGroup","encodeMotionOption","hasExplicitEmpty","resolveMotionOverridePayload","byName","getMotionOverrideValue","getMotionOverrideLabel","groupLabel","setMotionOverrideValue","rawValue","decodeMotionOption","live2dMotionSelectOptions","safeName","live2dMotionOptionSet","live2dListSummary","exprCount","motionCount","live2dPreviewMountEl","live2dPreviewInteractEl","previewMounted","previewTag","previewStatus","previewZoomFactor","previewPanOffsetX","previewPanOffsetY","previewBasePose","previewIsDragging","previewDragStart","previewDragOrigin","previewMountPromise","previewResizeObserver","previewAutoMotionLoopEnabled","getPreviewCanvasSize","applyPreviewViewport","maxOffsetX","maxOffsetY","resetPreviewViewport","getPreviewDragPoint","ev","originalEvent","touches","changedTouches","disconnectPreviewResizeObserver","ensurePreviewMounted","interactEl","__dpPreviewHandlers","onDown","point","onMove","onUp","onWheel","bindPreviewViewportEvents","ResizeObserver","observe","bindPreviewResizeObserver","baseScale","capturePreviewBasePose","refreshLive2DLists","cleanupPreviewMount","reloadModel","handlers","unbindPreviewViewportEvents","restored","currentPath","replayPreview","previewEmotion","section","onBeforeUnmount","fetchingModels","modelFetchError","testingConnection","connectionStatus","connectionError","showAdvanced","showEmotionAdvanced","showLipSyncAdvanced","lipSyncManualParamsText","overlayFallbackStyle","inset","minHeight","zIndex","display","alignItems","justifyContent","panelFallbackStyle","flexDirection","maxHeight","normalizeModelList","maybeId","maybeModel","maybeName","getModelListSafe","customApi","helperGetModelList","TavernHelper","getModelList","apiurl","Authorization","getModelListByHttp","fetchModels","testConnection","formatFileSize","formatLocalUploadTime","toLocaleString","refreshLocalModelInfo","triggerLocalModelUpload","click","onLocalModelFileChange","storedModel","useUploadedModel","warning","clearUploadedModel","deleteLive2DModel","onBrowserLoad","loadCustomUrl","blobMatch","resetEmotionConfigs","onAliasesBlur","parseAliasesText","m","autoMatchLive2DOverrides","overwrite","filled","exprOverride","resolvedExpr","motionEnabled","motionGroupOverride","resolvedMotion","clearLive2DOverrides","cleared","hadExpr","hadGroup","exprResolved","motionResolved","motionText","onToggleTtsEnabled","setItem","setTTSEnabled","refreshTtsVoices","normalizePathSepLocal","normalizeImportRootPathLocal","getRelativeRootNameFromFiles","syncGptImportPrefix","prefixInput","promptGptImportPrefix","defaultPrefix","initial","prompt","onGptSwitchModeChange","onGptImportPrefixChange","modelToLegacyVoice","defRef","syncLegacyVoicesFromModels","setGptSoVitsModelsTextarea","setGptSoVitsVoicesTextarea","normalizeGptModelMatchKey","mergeGptSoVitsModelsByName","incoming","modelRaw","incomingNameKey","incomingIdKey","hitIndex","findIndex","itemNameKey","itemIdKey","nextNameKey","deepCloneGptModels","createGptSoVitsModelTemplateConfig","syncGptModelManagerFromSettings","openGptModelManager","closeGptModelEditor","closeGptModelManager","applyGptModelManagerModelsToSettings","showSuccessMessage","legacyVoices","firstUsable","saveGptModelManager","saveGptModelManagerAndClose","addGptModelManagerModel","getGptModelManagerIndexById","targetId","openGptModelManagerImportJson","openGptModelManagerImportFolder","onGptModelManagerImportJsonChange","normalizedIncoming","onGptModelManagerImportFolderChange","inferred","hasRelativePath","exportGptModelManagerModels","download","ensureGptModelEditorStructure","normalizeGptModelEditorRefAudio","openGptModelEditor","targetRefId","syncGptModelEditorExpressionRowsFromModel","addGptModelEditorRefAudio","addGptModelEditorExpressionRow","fallbackRefId","saveGptModelEditor","validRefIds","nextMap","applyGptModelEditorExpressionRowsToModel","targetIndex","testTts","ctx","getCurrentCharacterId","selectedUsable","targetName","stopTts","applyLipSyncManualParams","syncedPrefix","accept","onChange","checked","opt","onBlur","onInput","webkitdirectory","directory","multiple","refAudio","cloned","splice","removedId","rowIndex","ModelBrowser","onCancel","onLoadModel","OPEN_SETTINGS_FN_KEY","uiStore","bubbleText","bubbleDone","globalOpenSettingsFn","modelLoadTaskId","initTaskId","modelLoadingHideTimer","statusCheckTimer","viewportResizeSyncTimer","boundWindowResizeHandler","boundVisualViewportResizeHandler","gazeFollowBound","gazePointerMoveHandler","gazePointerDownHandler","gazeFollowRafId","gazePendingPoint","petClosed","showMenu","menuAnchor","menuPlacement","showModelBrowser","phoneTtsBridgeBound","phoneMessageReceivedHandler","phoneAIGenCompleteHandler","phoneTtsListenSinceSec","phoneSeenMessageKeys","phoneSeenMessageOrder","phoneTtsQueue","phoneTtsQueueRunning","baibaiPhoneTtsBridgeBound","baibaiPhonePollTimer","baibaiEventStops","baibaiSeenAssistantIds","baibaiSeenAssistantOrder","getPhoneStore","extension_settings","acsusPawsPuffs","phone","localAny","getPhoneContactName","contactId","safeId","contacts","isNonUserPhoneMessage","sender","sanitizePhoneSpeakText","isPhoneAutoReadEnabled","isBaibaiUserSender","senderName","append","name1","userName","getNormalizedUserNames","parseBaibaiCommandArgs","rawArgs","quotedArgs","quotedMatcher","matchAll","extractBaibaiTextPayloads","rawPayload","marker","markerType","extractPhoneSpeakText","replyContent","amount","note","filename","months","membershipType","getPhoneMessageKey","safeContact","messageId","time","rememberPhoneMessageKey","shift","bindTavernEvent","fromTop","resolveTavernEventName","removeListener","resetBaibaiAssistantSeenState","rememberBaibaiAssistantMessageId","getAssistantChatMessages","parseBaibaiPhoneMessagesFromAssistant","normalizedText","hasBaibaiPhoneCommand","assistantMessageId","message_id","commandMatches","commandIndex","commandName","textPayloads","rawTime","messageIdPart","speakText","markExistingBaibaiMessagesAsSeen","collectUnsyncedBaibaiMessages","parsedMessages","enqueuePhoneMessageForTTS","waitForTTSIdle","startAt","messageSec","phoneAutoRead","contactName","ttsOverrides","contextPrefix","drainPhoneTTSQueue","collectUnsyncedPhoneMessages","history","chats","getPhoneChatHistory","pending","reverse","bindPhoneTTSBridge","chatKey","markExistingPhoneMessagesAsSeen","topDoc","unbindPhoneTTSBridge","unbindBaibaiPhoneTTSBridge","toggleMotionLoop","cyclePersona","personas","openModelBrowser","onModelBrowserLoad","onModelChange","onManualChat","closePet","clearModelLoadingHideTimer","clearStatusCheckTimer","clearViewportResizeSyncTimer","onBubbleHidden","unbindGlobalGazeFollow","getStageSize","normalizePetScale","bindGlobalGazeFollow","handlePointerEvent","scheduleGazeFollow","resetFocus","clearGazeFollowRaf","syncGazeFollowBinding","scheduleViewportResizeSync","stageSize","recoverOnce","stageEl","visibility","opacity","scheduleStatusCheck","syncStageAfterViewportResize","renderModelLoadProgress","notifyInitError","loadModelWithProgress","taskId","rectSummary","hasLive2d","hasModel","stageChildren","stageVisible","prevOutline","outline","prevBackground","background","prevZIndex","initPet","getProxiedAudioUrl","setLipSyncRefs","sync","chatChangedStop","bindBaibaiPhoneTTSBridge","splitResult","ttsText","hasJa","markerStart","markerEnd","zhPart","jaPart","splitZhJaForDisplayAndTts","expressionResolved","applyEmotionToLive2D","initialScale","vibrate","openFunctionMenu","nextPath","isLocalModel","registerGlobalOpenSettings","onMounted","viewport","visualViewport","bindViewportResizeRecovery","unbindViewportResizeRecovery","unregisterGlobalOpenSettings","ChatBubble","onHidden","SettingsPanel","onClose","FunctionMenu","onSendChat","onToggleMotionLoop","onSwitchModel","onSwitchPersona","onCloseModel","deteleport_style","BUILD_TAG","LEGACY_MENU_BUTTON_LABELS","SETTINGS_LABEL","pinia","EXTENSIONS_MENU_CONTAINER_ID","EXTENSIONS_MENU_ITEM_ID","EXTENSIONS_MENU_CLICK_NAMESPACE","extensionsMenuRetryTimer","getParentDocument","bindExtensionsMenuDelegation","parentDoc","clickEvent","stopPropagation","$extensionsMenu","$extensionsMenuButton","is","trigger","summary","onExtensionsMenuItemClick","injectExtensionsMenuItem","$item","removeExtensionsMenuItem","removeLegacyMenuButtons","_idx","attr","clone","appendTo","$app","createApp","PetContainer","use","errorHandler","_instance","warnHandler","trace","mount","chatId","getCurrentChatId","CHAT_CHANGED","newChatId"],"sourceRoot":""}