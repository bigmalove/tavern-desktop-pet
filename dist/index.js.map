{"version":3,"file":"index.js","mappings":"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","sources":["webpack://tavern_helper_template////ui/FunctionMenu.vue?bf5d","src://tavern_helper_template/node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js","webpack://tavern_helper_template////ui/TreeNode.vue?5d18","src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js","webpack://tavern_helper_template////ui/SettingsPanel.vue?86b9","webpack://tavern_helper_template////ui/ModelBrowser.vue?6a09","webpack://tavern_helper_template////ui/ModelBrowser.vue?1256","webpack://tavern_helper_template////ui/FunctionMenu.vue?0566","src://tavern_helper_template/node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/listToStyles.js","src://tavern_helper_template/node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js","webpack://tavern_helper_template////ui/PetContainer.vue?ba82","webpack://tavern_helper_template////ui/PetContainer.vue?0b11","webpack://tavern_helper_template////ui/TreeNode.vue?7472","webpack://tavern_helper_template////ui/ChatBubble.vue?2609","src://tavern_helper_template/node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js","webpack://tavern_helper_template////ui/SettingsPanel.vue?420e","webpack://tavern_helper_template////ui/ChatBubble.vue?d14c","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/webpack/runtime/compat get default export","src://tavern_helper_template/webpack/runtime/define property getters","src://tavern_helper_template/webpack/runtime/hasOwnProperty shorthand","src://tavern_helper_template/webpack/runtime/make namespace object","src://tavern_helper_template/external var \"Vue\"","src://tavern_helper_template////core/constants.ts","src://tavern_helper_template/external var \"z\"","src://tavern_helper_template////core/emotion.ts","src://tavern_helper_template////utils/dom.ts","src://tavern_helper_template////core/settings.ts","src://tavern_helper_template////audio/edge-tts-direct.ts","src://tavern_helper_template////audio/tts-config.ts","src://tavern_helper_template////live2d/loader.ts","src://tavern_helper_template////utils/gesture-recognizer.ts","src://tavern_helper_template////live2d/stage.ts","src://tavern_helper_template////live2d/expression-motion.ts","src://tavern_helper_template////live2d/manager.ts","src://tavern_helper_template////live2d/lip-sync.ts","src://tavern_helper_template////audio/tts-manager.ts","src://tavern_helper_template////chat/monitor.ts","src://tavern_helper_template////chat/prompt-templates.ts","src://tavern_helper_template////chat/commentator.ts","src://tavern_helper_template////chat/emotion-cot.ts","src://tavern_helper_template////core/ui.ts","src://tavern_helper_template////ui/ChatBubble.vue","webpack://tavern_helper_template////ui/ChatBubble.vue?4a23","src://tavern_helper_template////ui/FunctionMenu.vue","webpack://tavern_helper_template////ui/FunctionMenu.vue?e028","src://tavern_helper_template////live2d/model-browser.ts","src://tavern_helper_template////ui/TreeNode.vue","webpack://tavern_helper_template////ui/TreeNode.vue?c5ea","src://tavern_helper_template////ui/ModelBrowser.vue","webpack://tavern_helper_template////ui/ModelBrowser.vue?8203","src://tavern_helper_template////ui/SettingsPanel.vue","webpack://tavern_helper_template////ui/SettingsPanel.vue?6f86","src://tavern_helper_template////ui/PetContainer.vue","webpack://tavern_helper_template////ui/PetContainer.vue?aed4","src://tavern_helper_template////utils/style-teleport.ts","src://tavern_helper_template////index.ts"],"sourcesContent":["/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./FunctionMenu.vue?vue&type=style&index=0&id=ff4f8948&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"078f2c0f\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./FunctionMenu.vue?vue&type=style&index=0&id=ff4f8948&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./FunctionMenu.vue?vue&type=style&index=0&id=ff4f8948&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = [];\n\n  // return the list of modules as css string\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n      content += cssWithMappingToString(item);\n      if (needLayer) {\n        content += \"}\";\n      }\n      if (item[2]) {\n        content += \"}\";\n      }\n      if (item[4]) {\n        content += \"}\";\n      }\n      return content;\n    }).join(\"\");\n  };\n\n  // import a list of modules into the list\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n    var alreadyImportedModules = {};\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n      list.push(item);\n    }\n  };\n  return list;\n};","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.node-row[data-v-3a6a95ba]{display:flex;align-items:center;padding:5px 8px;cursor:pointer;border-bottom:1px solid hsla(0,0%,100%,.08);font-size:12px;gap:4px;-webkit-user-select:none;user-select:none;transition:background .14s}.node-row[data-v-3a6a95ba]:hover{background:rgba(255,225,0,.12)}.node-row.is-model .node-name[data-v-3a6a95ba]{color:#00dac2;font-weight:600}.node-row.is-selected[data-v-3a6a95ba]{background:rgba(255,225,0,.2)}.expand-icon[data-v-3a6a95ba]{width:14px;font-size:8px;color:#8d8d8d;transition:transform .2s;flex-shrink:0;text-align:center}.expand-icon.expanded[data-v-3a6a95ba]{transform:rotate(90deg)}.expand-icon.placeholder[data-v-3a6a95ba]{visibility:hidden}.node-icon[data-v-3a6a95ba]{font-size:13px;flex-shrink:0;line-height:1}.node-name[data-v-3a6a95ba]{color:#f1f1f1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1}.node-spinner[data-v-3a6a95ba]{display:inline-block;width:10px;height:10px;border:1.5px solid #4d4d4d;border-top-color:#00dac2;border-radius:50%;animation:spin-3a6a95ba .8s linear infinite;flex-shrink:0;margin-left:4px}@keyframes spin-3a6a95ba{to{transform:rotate(360deg)}}.empty-hint[data-v-3a6a95ba]{font-size:11px;color:#8d8d8d;padding:4px 8px}.child-error[data-v-3a6a95ba]{font-size:11px;color:#ffb5af;padding:4px 8px}.child-error .retry-link[data-v-3a6a95ba]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.child-error .retry-link[data-v-3a6a95ba]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.child-error .retry-link[data-v-3a6a95ba]:disabled{opacity:.45;cursor:not-allowed}.child-error .retry-link[data-v-3a6a95ba]{height:22px;min-width:56px;padding:0 8px;margin-left:6px;font-size:10px;border-color:rgba(0,218,194,.55);color:#c5fff9;cursor:pointer}.child-error .retry-link[data-v-3a6a95ba]:hover{background:#00dac2;border-color:#00dac2;color:#000}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/TreeNode.vue\"],\"names\":[],\"mappings\":\"AAAA,iEAAA,CCAwH,2BAAU,YAAa,CAAA,kBAAmB,CAAA,eAAgB,CAAA,cAAe,CAAA,2CAA4C,CAAA,cAAe,CAAA,OAAQ,CAAA,wBAAiB,CAAjB,gBAAiB,CAAA,0BAA2B,CAAA,iCAAgB,8BAA+B,CAAA,+CAA8B,aAAc,CAAA,eAAgB,CAAA,uCAAsB,6BAA8B,CAAA,8BAAa,UAAW,CAAA,aAAc,CAAA,aAAc,CAAA,wBAAyB,CAAA,aAAc,CAAA,iBAAkB,CAAA,uCAAsB,uBAAwB,CAAA,0CAAyB,iBAAkB,CAAA,4BAAW,cAAe,CAAA,aAAc,CAAA,aAAc,CAAA,4BAAW,aAAc,CAAA,eAAgB,CAAA,sBAAuB,CAAA,kBAAmB,CAAA,MAAO,CAAA,+BAAc,oBAAqB,CAAA,UAAW,CAAA,WAAY,CAAA,0BAA2B,CAAA,wBAAyB,CAAA,iBAAkB,CAAA,2CAAmC,CAAA,aAAc,CAAA,eAAgB,CAAA,yBAAgB,GAAG,wBAAyB,CAAC,CAAA,6BAAY,cAAe,CAAA,aAAc,CAAA,eAAgB,CAAA,8BAAa,cAAe,CAAA,aAAc,CAAA,eAAgB,CAAA,0CAAyB,uBAAgB,CAAhB,eAAgB,CAAA,oCAAqC,CAAA,wBAAyB,CAAA,UAAW,CAAA,iDAAkD,CAAA,eAAgB,CAAA,oBAAqB,CAAA,wBAAyB,CAAA,cAAe,CAAA,kFAAuF,CAAA,sEAAuE,CAAA,+DAA8C,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,mDAAkC,WAAY,CAAA,kBAAmB,CAAA,0CAAyB,WAAY,CAAA,cAAe,CAAA,aAAc,CAAA,eAAgB,CAAA,cAAe,CAAA,gCAAiC,CAAA,aAAc,CAAA,cAAe,CAAA,gDAA+B,kBAAmB,CAAA,oBAAqB,CAAA,UAAW\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.node-row{display:flex;align-items:center;padding:5px 8px;cursor:pointer;border-bottom:1px solid hsla(0,0%,100%,.08);font-size:12px;gap:4px;user-select:none;transition:background .14s}.node-row:hover{background:rgba(255,225,0,.12)}.node-row.is-model .node-name{color:#00dac2;font-weight:600}.node-row.is-selected{background:rgba(255,225,0,.2)}.expand-icon{width:14px;font-size:8px;color:#8d8d8d;transition:transform .2s;flex-shrink:0;text-align:center}.expand-icon.expanded{transform:rotate(90deg)}.expand-icon.placeholder{visibility:hidden}.node-icon{font-size:13px;flex-shrink:0;line-height:1}.node-name{color:#f1f1f1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1}.node-spinner{display:inline-block;width:10px;height:10px;border:1.5px solid #4d4d4d;border-top-color:#00dac2;border-radius:50%;animation:spin .8s linear infinite;flex-shrink:0;margin-left:4px}@keyframes spin{to{transform:rotate(360deg)}}.empty-hint{font-size:11px;color:#8d8d8d;padding:4px 8px}.child-error{font-size:11px;color:#ffb5af;padding:4px 8px}.child-error .retry-link{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.child-error .retry-link:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.child-error .retry-link:disabled{opacity:.45;cursor:not-allowed}.child-error .retry-link{height:22px;min-width:56px;padding:0 8px;margin-left:6px;font-size:10px;border-color:rgba(0,218,194,.55);color:#c5fff9;cursor:pointer}.child-error .retry-link:hover{background:#00dac2;border-color:#00dac2;color:#000}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./SettingsPanel.vue?vue&type=style&index=0&id=7941402e&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"1a91b8e4\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./SettingsPanel.vue?vue&type=style&index=0&id=7941402e&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./SettingsPanel.vue?vue&type=style&index=0&id=7941402e&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.model-browser[data-v-7ee23a0a]{display:flex;flex-direction:column;height:100%;max-height:60vh;color:#fff;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif}.browser-header[data-v-7ee23a0a]{display:flex;align-items:center;justify-content:space-between;padding:8px 0 10px;margin-bottom:10px;border-bottom:1px solid rgba(255,225,0,.35)}.browser-header .browser-title[data-v-7ee23a0a]{font-size:14px;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;letter-spacing:.08em;color:#ffe100}.browser-header .browser-hint[data-v-7ee23a0a]{font-size:10px;color:#8d8d8d;letter-spacing:.08em}.search-box[data-v-7ee23a0a]{margin-bottom:10px}.search-box input[data-v-7ee23a0a]{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.search-box input[data-v-7ee23a0a]:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.search-box input[data-v-7ee23a0a]::placeholder{color:#8d8d8d}.search-box input[data-v-7ee23a0a]{color:#fff}.error-bar[data-v-7ee23a0a]{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:8px 10px;background:rgba(255,59,48,.12);border:1px solid rgba(255,59,48,.4);margin-bottom:10px;font-size:12px;color:#ffc9c5}.error-bar .retry-btn[data-v-7ee23a0a]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.error-bar .retry-btn[data-v-7ee23a0a]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.error-bar .retry-btn[data-v-7ee23a0a]:disabled{opacity:.45;cursor:not-allowed}.error-bar .retry-btn[data-v-7ee23a0a]{min-width:72px;height:26px;padding:0 8px;font-size:11px;border-color:rgba(255,59,48,.6);color:#ffc9c5}.error-bar .retry-btn[data-v-7ee23a0a]:hover{background:#ff3b30;border-color:#ff3b30;color:#fff}.tree-container[data-v-7ee23a0a]{flex:1;overflow-y:auto;min-height:150px;padding:4px 0 6px;border:1px solid hsla(0,0%,100%,.12);background:rgba(0,0,0,.3)}.tree-container[data-v-7ee23a0a]::-webkit-scrollbar{width:7px;height:7px}.tree-container[data-v-7ee23a0a]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.tree-container[data-v-7ee23a0a]::-webkit-scrollbar-thumb{background:#555}.tree-container[data-v-7ee23a0a]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.tree-container[data-v-7ee23a0a]:empty{border-style:dashed}.loading-state[data-v-7ee23a0a]{display:flex;align-items:center;justify-content:center;padding:24px;color:#8d8d8d;font-size:13px;gap:8px}.spinner[data-v-7ee23a0a]{display:inline-block;width:14px;height:14px;border:2px solid #4d4d4d;border-top-color:#00dac2;border-radius:50%;animation:spin-7ee23a0a .8s linear infinite}@keyframes spin-7ee23a0a{to{transform:rotate(360deg)}}.empty-state[data-v-7ee23a0a]{text-align:center;padding:24px;color:#8d8d8d;font-size:13px}.browser-footer[data-v-7ee23a0a]{border-top:1px solid hsla(0,0%,100%,.16);padding-top:12px;margin-top:10px}.browser-footer .selected-info[data-v-7ee23a0a]{font-size:12px;color:#d5d5d5;margin-bottom:8px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.browser-footer .selected-info .selected-path[data-v-7ee23a0a]{color:#ffe100;font-weight:600}.browser-footer .selected-info .no-selection[data-v-7ee23a0a]{color:#8d8d8d}.browser-footer .footer-actions[data-v-7ee23a0a]{display:flex;justify-content:flex-end;gap:8px}.btn[data-v-7ee23a0a]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.btn[data-v-7ee23a0a]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.btn[data-v-7ee23a0a]:disabled{opacity:.45;cursor:not-allowed}.btn[data-v-7ee23a0a]{min-width:90px;height:32px;padding:0 14px;font-size:12px}.btn[data-v-7ee23a0a]:disabled{opacity:.4;cursor:not-allowed}.btn.btn-primary[data-v-7ee23a0a]{background:#ffe100;color:#000;border-color:#ffe100}.btn.btn-primary[data-v-7ee23a0a]:hover:not(:disabled){background:#fff26e;border-color:#fff26e}.btn.btn-secondary[data-v-7ee23a0a]{background:rgba(0,218,194,.08);border-color:rgba(0,218,194,.55);color:#c5fff9}.btn.btn-secondary[data-v-7ee23a0a]:hover{background:#00dac2;border-color:#00dac2;color:#000}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/ModelBrowser.vue\"],\"names\":[],\"mappings\":\"AAAA,iEAAA,CCAwH,gCAAe,YAAa,CAAA,qBAAsB,CAAA,WAAY,CAAA,eAAgB,CAAA,UAAW,CAAA,gFAAiF,CAAA,iCAAgB,YAAa,CAAA,kBAAmB,CAAA,6BAA8B,CAAA,kBAAmB,CAAA,kBAAmB,CAAA,2CAA4C,CAAA,gDAA+B,cAAe,CAAA,iDAAkD,CAAA,oBAAqB,CAAA,aAAc,CAAA,+CAA8B,cAAe,CAAA,aAAc,CAAA,oBAAqB,CAAA,6BAAY,kBAAmB,CAAA,mCAAkB,UAAW,CAAA,qBAAsB,CAAA,gBAAiB,CAAA,wBAAyB,CAAA,+BAAgC,CAAA,eAAgB,CAAA,0BAA2B,CAAA,aAAc,CAAA,+DAAgE,CAAA,cAAe,CAAA,YAAa,CAAA,sDAAuD,CAAA,yCAAwB,oBAAqB,CAAA,8BAA+B,CAAA,gDAA+B,aAAc,CAAA,mCAAkB,UAAW,CAAA,4BAAW,YAAa,CAAA,kBAAmB,CAAA,6BAA8B,CAAA,OAAQ,CAAA,gBAAiB,CAAA,8BAA+B,CAAA,mCAAoC,CAAA,kBAAmB,CAAA,cAAe,CAAA,aAAc,CAAA,uCAAsB,uBAAgB,CAAhB,eAAgB,CAAA,oCAAqC,CAAA,wBAAyB,CAAA,UAAW,CAAA,iDAAkD,CAAA,eAAgB,CAAA,oBAAqB,CAAA,wBAAyB,CAAA,cAAe,CAAA,kFAAuF,CAAA,sEAAuE,CAAA,4DAA2C,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,gDAA+B,WAAY,CAAA,kBAAmB,CAAA,uCAAsB,cAAe,CAAA,WAAY,CAAA,aAAc,CAAA,cAAe,CAAA,+BAAgC,CAAA,aAAc,CAAA,6CAA4B,kBAAmB,CAAA,oBAAqB,CAAA,UAAW,CAAA,iCAAgB,MAAO,CAAA,eAAgB,CAAA,gBAAiB,CAAA,iBAAkB,CAAA,oCAAqC,CAAA,yBAA0B,CAAA,oDAAmC,SAAU,CAAA,UAAW,CAAA,0DAAyC,8BAA+B,CAAA,0DAAyC,eAAgB,CAAA,gEAA+C,kBAAmB,CAAA,uCAAsB,mBAAoB,CAAA,gCAAe,YAAa,CAAA,kBAAmB,CAAA,sBAAuB,CAAA,YAAa,CAAA,aAAc,CAAA,cAAe,CAAA,OAAQ,CAAA,0BAAS,oBAAqB,CAAA,UAAW,CAAA,WAAY,CAAA,wBAAyB,CAAA,wBAAyB,CAAA,iBAAkB,CAAA,2CAAmC,CAAA,yBAAgB,GAAG,wBAAyB,CAAC,CAAA,8BAAa,iBAAkB,CAAA,YAAa,CAAA,aAAc,CAAA,cAAe,CAAA,iCAAgB,wCAAyC,CAAA,gBAAiB,CAAA,eAAgB,CAAA,gDAA+B,cAAe,CAAA,aAAc,CAAA,iBAAkB,CAAA,eAAgB,CAAA,sBAAuB,CAAA,kBAAmB,CAAA,+DAA8C,aAAc,CAAA,eAAgB,CAAA,8DAA6C,aAAc,CAAA,iDAAgC,YAAa,CAAA,wBAAyB,CAAA,OAAQ,CAAA,sBAAK,uBAAgB,CAAhB,eAAgB,CAAA,oCAAqC,CAAA,wBAAyB,CAAA,UAAW,CAAA,iDAAkD,CAAA,eAAgB,CAAA,oBAAqB,CAAA,wBAAyB,CAAA,cAAe,CAAA,kFAAuF,CAAA,sEAAuE,CAAA,2CAA0B,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,+BAAc,WAAY,CAAA,kBAAmB,CAAA,sBAAK,cAAe,CAAA,WAAY,CAAA,cAAe,CAAA,cAAe,CAAA,+BAAc,UAAW,CAAA,kBAAmB,CAAA,kCAAiB,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,uDAAsC,kBAAmB,CAAA,oBAAqB,CAAA,oCAAmB,8BAA+B,CAAA,gCAAiC,CAAA,aAAc,CAAA,0CAAyB,kBAAmB,CAAA,oBAAqB,CAAA,UAAW\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.model-browser{display:flex;flex-direction:column;height:100%;max-height:60vh;color:#fff;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif}.browser-header{display:flex;align-items:center;justify-content:space-between;padding:8px 0 10px;margin-bottom:10px;border-bottom:1px solid rgba(255,225,0,.35)}.browser-header .browser-title{font-size:14px;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;letter-spacing:.08em;color:#ffe100}.browser-header .browser-hint{font-size:10px;color:#8d8d8d;letter-spacing:.08em}.search-box{margin-bottom:10px}.search-box input{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.search-box input:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.search-box input::placeholder{color:#8d8d8d}.search-box input{color:#fff}.error-bar{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:8px 10px;background:rgba(255,59,48,.12);border:1px solid rgba(255,59,48,.4);margin-bottom:10px;font-size:12px;color:#ffc9c5}.error-bar .retry-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.error-bar .retry-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.error-bar .retry-btn:disabled{opacity:.45;cursor:not-allowed}.error-bar .retry-btn{min-width:72px;height:26px;padding:0 8px;font-size:11px;border-color:rgba(255,59,48,.6);color:#ffc9c5}.error-bar .retry-btn:hover{background:#ff3b30;border-color:#ff3b30;color:#fff}.tree-container{flex:1;overflow-y:auto;min-height:150px;padding:4px 0 6px;border:1px solid hsla(0,0%,100%,.12);background:rgba(0,0,0,.3)}.tree-container::-webkit-scrollbar{width:7px;height:7px}.tree-container::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.tree-container::-webkit-scrollbar-thumb{background:#555}.tree-container::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.tree-container:empty{border-style:dashed}.loading-state{display:flex;align-items:center;justify-content:center;padding:24px;color:#8d8d8d;font-size:13px;gap:8px}.spinner{display:inline-block;width:14px;height:14px;border:2px solid #4d4d4d;border-top-color:#00dac2;border-radius:50%;animation:spin .8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.empty-state{text-align:center;padding:24px;color:#8d8d8d;font-size:13px}.browser-footer{border-top:1px solid hsla(0,0%,100%,.16);padding-top:12px;margin-top:10px}.browser-footer .selected-info{font-size:12px;color:#d5d5d5;margin-bottom:8px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.browser-footer .selected-info .selected-path{color:#ffe100;font-weight:600}.browser-footer .selected-info .no-selection{color:#8d8d8d}.browser-footer .footer-actions{display:flex;justify-content:flex-end;gap:8px}.btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.btn:disabled{opacity:.45;cursor:not-allowed}.btn{min-width:90px;height:32px;padding:0 14px;font-size:12px}.btn:disabled{opacity:.4;cursor:not-allowed}.btn.btn-primary{background:#ffe100;color:#000;border-color:#ffe100}.btn.btn-primary:hover:not(:disabled){background:#fff26e;border-color:#fff26e}.btn.btn-secondary{background:rgba(0,218,194,.08);border-color:rgba(0,218,194,.55);color:#c5fff9}.btn.btn-secondary:hover{background:#00dac2;border-color:#00dac2;color:#000}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ModelBrowser.vue?vue&type=style&index=0&id=7ee23a0a&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"db518fdc\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ModelBrowser.vue?vue&type=style&index=0&id=7ee23a0a&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ModelBrowser.vue?vue&type=style&index=0&id=7ee23a0a&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.menu-overlay[data-v-ff4f8948]{position:fixed;inset:0;z-index:10002;background:rgba(0,0,0,.12);display:flex;align-items:center;justify-content:center}.menu-cluster[data-v-ff4f8948]{position:fixed;display:flex;align-items:center;gap:10px;max-width:calc(100vw - 16px);pointer-events:auto}.menu-cluster.is-left[data-v-ff4f8948]{flex-direction:row-reverse}.menu-panel[data-v-ff4f8948]{width:164px;padding:8px;background:#181818;color:#fff;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0,100% 0,100% calc(100% - 12px),calc(100% - 12px) 100%,0 100%)}.menu-panel[data-v-ff4f8948]::before{content:\"\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.menu-panel[data-v-ff4f8948]{background-image:linear-gradient(rgba(255,255,255,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.03) 1px,transparent 1px);background-size:20px 20px}.panel-top[data-v-ff4f8948]{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;padding:4px 4px 8px;border-bottom:1px solid rgba(255,225,0,.35)}.panel-title[data-v-ff4f8948]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;color:#ffe100;font-size:12px;letter-spacing:.12em}.icon-btn[data-v-ff4f8948]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.icon-btn[data-v-ff4f8948]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.icon-btn[data-v-ff4f8948]:disabled{opacity:.45;cursor:not-allowed}.icon-btn[data-v-ff4f8948]{width:28px;height:24px;padding:0;font-size:16px;line-height:1}.command-btn[data-v-ff4f8948]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.command-btn[data-v-ff4f8948]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.command-btn[data-v-ff4f8948]:disabled{opacity:.45;cursor:not-allowed}.command-btn[data-v-ff4f8948]{width:100%;min-height:52px;padding:8px 10px;margin-bottom:8px;text-align:left;display:grid;grid-template-columns:auto 1fr;grid-template-areas:\"idx main\" \"idx sub\";-moz-column-gap:8px;column-gap:8px;row-gap:2px}.command-btn[data-v-ff4f8948]:last-child{margin-bottom:0}.command-btn.active[data-v-ff4f8948]{background:#ffe100;color:#000;border-color:#ffe100}.command-btn.danger[data-v-ff4f8948]{border-color:rgba(255,59,48,.45);color:#ffc9c5}.command-btn.danger[data-v-ff4f8948]:hover{background:#ff3b30;border-color:#ff3b30;color:#fff}.command-index[data-v-ff4f8948]{grid-area:idx;align-self:center;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:16px;color:#00dac2}.command-main[data-v-ff4f8948]{grid-area:main;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:12px;line-height:1}.command-sub[data-v-ff4f8948]{grid-area:sub;font-size:10px;color:#8d8d8d;text-transform:none}.chat-drawer[data-v-ff4f8948]{width:min(320px,100vw - 36px);max-height:min(68vh,420px);padding:12px;background:#262626;color:#fff;overflow:auto;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0,100% 0,100% calc(100% - 12px),calc(100% - 12px) 100%,0 100%)}.chat-drawer[data-v-ff4f8948]::before{content:\"\";position:absolute;top:0;left:0;width:56px;height:2px;background:#00dac2;z-index:2}.chat-drawer[data-v-ff4f8948]{background-image:linear-gradient(rgba(255,255,255,0.024) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.024) 1px,transparent 1px);background-size:20px 20px}.chat-drawer[data-v-ff4f8948]::-webkit-scrollbar{width:7px;height:7px}.chat-drawer[data-v-ff4f8948]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.chat-drawer[data-v-ff4f8948]::-webkit-scrollbar-thumb{background:#555}.chat-drawer[data-v-ff4f8948]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.drawer-head[data-v-ff4f8948]{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;padding-bottom:8px;border-bottom:1px solid rgba(0,218,194,.38)}.drawer-title[data-v-ff4f8948]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:12px;letter-spacing:.12em;color:#00dac2}.drawer-close[data-v-ff4f8948]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.drawer-close[data-v-ff4f8948]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.drawer-close[data-v-ff4f8948]:disabled{opacity:.45;cursor:not-allowed}.drawer-close[data-v-ff4f8948]{width:26px;height:24px;padding:0;font-size:16px;line-height:1}.chat-input[data-v-ff4f8948]{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.chat-input[data-v-ff4f8948]:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.chat-input[data-v-ff4f8948]::placeholder{color:#8d8d8d}.chat-input[data-v-ff4f8948]{min-height:96px;resize:vertical;color:#fff}.drawer-actions[data-v-ff4f8948]{display:flex;justify-content:flex-end;margin-top:10px}.send-btn[data-v-ff4f8948]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.send-btn[data-v-ff4f8948]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.send-btn[data-v-ff4f8948]:disabled{opacity:.45;cursor:not-allowed}.send-btn[data-v-ff4f8948]{min-width:96px;height:34px}.drawer-hint[data-v-ff4f8948]{margin-top:8px;font-size:11px;color:#8d8d8d}.drawer-enter-active[data-v-ff4f8948],.drawer-leave-active[data-v-ff4f8948]{transition:opacity .16s ease,transform .16s ease}.drawer-enter-from[data-v-ff4f8948],.drawer-leave-to[data-v-ff4f8948]{opacity:0;transform:translateX(-8px)}.menu-cluster.is-left .drawer-enter-from[data-v-ff4f8948],.menu-cluster.is-left .drawer-leave-to[data-v-ff4f8948]{transform:translateX(8px)}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/FunctionMenu.vue\"],\"names\":[],\"mappings\":\"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\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.menu-overlay{position:fixed;inset:0;z-index:10002;background:rgba(0,0,0,.12);display:flex;align-items:center;justify-content:center}.menu-cluster{position:fixed;display:flex;align-items:center;gap:10px;max-width:calc(100vw - 16px);pointer-events:auto}.menu-cluster.is-left{flex-direction:row-reverse}.menu-panel{width:164px;padding:8px;background:#181818;color:#fff;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%)}.menu-panel::before{content:\\\"\\\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.menu-panel{background-image:linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);background-size:20px 20px}.panel-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;padding:4px 4px 8px;border-bottom:1px solid rgba(255,225,0,.35)}.panel-title{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;color:#ffe100;font-size:12px;letter-spacing:.12em}.icon-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.icon-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.icon-btn:disabled{opacity:.45;cursor:not-allowed}.icon-btn{width:28px;height:24px;padding:0;font-size:16px;line-height:1}.command-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.command-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.command-btn:disabled{opacity:.45;cursor:not-allowed}.command-btn{width:100%;min-height:52px;padding:8px 10px;margin-bottom:8px;text-align:left;display:grid;grid-template-columns:auto 1fr;grid-template-areas:\\\"idx main\\\" \\\"idx sub\\\";column-gap:8px;row-gap:2px}.command-btn:last-child{margin-bottom:0}.command-btn.active{background:#ffe100;color:#000;border-color:#ffe100}.command-btn.danger{border-color:rgba(255,59,48,.45);color:#ffc9c5}.command-btn.danger:hover{background:#ff3b30;border-color:#ff3b30;color:#fff}.command-index{grid-area:idx;align-self:center;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:16px;color:#00dac2}.command-main{grid-area:main;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:12px;line-height:1}.command-sub{grid-area:sub;font-size:10px;color:#8d8d8d;text-transform:none}.chat-drawer{width:min(320px,100vw - 36px);max-height:min(68vh,420px);padding:12px;background:#262626;color:#fff;overflow:auto;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%)}.chat-drawer::before{content:\\\"\\\";position:absolute;top:0;left:0;width:56px;height:2px;background:#00dac2;z-index:2}.chat-drawer{background-image:linear-gradient(rgba(255, 255, 255, 0.024) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.024) 1px, transparent 1px);background-size:20px 20px}.chat-drawer::-webkit-scrollbar{width:7px;height:7px}.chat-drawer::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.chat-drawer::-webkit-scrollbar-thumb{background:#555}.chat-drawer::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.drawer-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;padding-bottom:8px;border-bottom:1px solid rgba(0,218,194,.38)}.drawer-title{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:12px;letter-spacing:.12em;color:#00dac2}.drawer-close{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.drawer-close:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.drawer-close:disabled{opacity:.45;cursor:not-allowed}.drawer-close{width:26px;height:24px;padding:0;font-size:16px;line-height:1}.chat-input{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.chat-input:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.chat-input::placeholder{color:#8d8d8d}.chat-input{min-height:96px;resize:vertical;color:#fff}.drawer-actions{display:flex;justify-content:flex-end;margin-top:10px}.send-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.send-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.send-btn:disabled{opacity:.45;cursor:not-allowed}.send-btn{min-width:96px;height:34px}.drawer-hint{margin-top:8px;font-size:11px;color:#8d8d8d}.drawer-enter-active,.drawer-leave-active{transition:opacity .16s ease,transform .16s ease}.drawer-enter-from,.drawer-leave-to{opacity:0;transform:translateX(-8px)}.menu-cluster.is-left .drawer-enter-from,.menu-cluster.is-left .drawer-leave-to{transform:translateX(8px)}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","/**\n * Translates the list format produced by css-loader into something\n * easier to manipulate.\n */\nexport default function listToStyles (parentId, list) {\n  var styles = []\n  var newStyles = {}\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i]\n    var id = item[0]\n    var css = item[1]\n    var media = item[2]\n    var sourceMap = item[3]\n    var part = {\n      id: parentId + ':' + i,\n      css: css,\n      media: media,\n      sourceMap: sourceMap\n    }\n    if (!newStyles[id]) {\n      styles.push(newStyles[id] = { id: id, parts: [part] })\n    } else {\n      newStyles[id].parts.push(part)\n    }\n  }\n  return styles\n}\n","/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n  Modified by Evan You @yyx990803\n*/\n\nimport listToStyles from './listToStyles'\n\nvar hasDocument = typeof document !== 'undefined'\n\nif (typeof DEBUG !== 'undefined' && DEBUG) {\n  if (!hasDocument) {\n    throw new Error(\n    'vue-style-loader cannot be used in a non-browser environment. ' +\n    \"Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.\"\n  ) }\n}\n\n/*\ntype StyleObject = {\n  id: number;\n  parts: Array<StyleObjectPart>\n}\n\ntype StyleObjectPart = {\n  css: string;\n  media: string;\n  sourceMap: ?string\n}\n*/\n\nvar stylesInDom = {/*\n  [id: number]: {\n    id: number,\n    refs: number,\n    parts: Array<(obj?: StyleObjectPart) => void>\n  }\n*/}\n\nvar head = hasDocument && (document.head || document.getElementsByTagName('head')[0])\nvar singletonElement = null\nvar singletonCounter = 0\nvar isProduction = false\nvar noop = function () {}\nvar options = null\nvar ssrIdKey = 'data-vue-ssr-id'\n\n// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n// tags it will allow on a page\nvar isOldIE = typeof navigator !== 'undefined' && /msie [6-9]\\b/.test(navigator.userAgent.toLowerCase())\n\nexport default function addStylesClient (parentId, list, _isProduction, _options) {\n  isProduction = _isProduction\n\n  options = _options || {}\n\n  var styles = listToStyles(parentId, list)\n  addStylesToDom(styles)\n\n  return function update (newList) {\n    var mayRemove = []\n    for (var i = 0; i < styles.length; i++) {\n      var item = styles[i]\n      var domStyle = stylesInDom[item.id]\n      domStyle.refs--\n      mayRemove.push(domStyle)\n    }\n    if (newList) {\n      styles = listToStyles(parentId, newList)\n      addStylesToDom(styles)\n    } else {\n      styles = []\n    }\n    for (var i = 0; i < mayRemove.length; i++) {\n      var domStyle = mayRemove[i]\n      if (domStyle.refs === 0) {\n        for (var j = 0; j < domStyle.parts.length; j++) {\n          domStyle.parts[j]()\n        }\n        delete stylesInDom[domStyle.id]\n      }\n    }\n  }\n}\n\nfunction addStylesToDom (styles /* Array<StyleObject> */) {\n  for (var i = 0; i < styles.length; i++) {\n    var item = styles[i]\n    var domStyle = stylesInDom[item.id]\n    if (domStyle) {\n      domStyle.refs++\n      for (var j = 0; j < domStyle.parts.length; j++) {\n        domStyle.parts[j](item.parts[j])\n      }\n      for (; j < item.parts.length; j++) {\n        domStyle.parts.push(addStyle(item.parts[j]))\n      }\n      if (domStyle.parts.length > item.parts.length) {\n        domStyle.parts.length = item.parts.length\n      }\n    } else {\n      var parts = []\n      for (var j = 0; j < item.parts.length; j++) {\n        parts.push(addStyle(item.parts[j]))\n      }\n      stylesInDom[item.id] = { id: item.id, refs: 1, parts: parts }\n    }\n  }\n}\n\nfunction createStyleElement () {\n  var styleElement = document.createElement('style')\n  styleElement.type = 'text/css'\n  head.appendChild(styleElement)\n  return styleElement\n}\n\nfunction addStyle (obj /* StyleObjectPart */) {\n  var update, remove\n  var styleElement = document.querySelector('style[' + ssrIdKey + '~=\"' + obj.id + '\"]')\n\n  if (styleElement) {\n    if (isProduction) {\n      // has SSR styles and in production mode.\n      // simply do nothing.\n      return noop\n    } else {\n      // has SSR styles but in dev mode.\n      // for some reason Chrome can't handle source map in server-rendered\n      // style tags - source maps in <style> only works if the style tag is\n      // created and inserted dynamically. So we remove the server rendered\n      // styles and inject new ones.\n      styleElement.parentNode.removeChild(styleElement)\n    }\n  }\n\n  if (isOldIE) {\n    // use singleton mode for IE9.\n    var styleIndex = singletonCounter++\n    styleElement = singletonElement || (singletonElement = createStyleElement())\n    update = applyToSingletonTag.bind(null, styleElement, styleIndex, false)\n    remove = applyToSingletonTag.bind(null, styleElement, styleIndex, true)\n  } else {\n    // use multi-style-tag mode in all other cases\n    styleElement = createStyleElement()\n    update = applyToTag.bind(null, styleElement)\n    remove = function () {\n      styleElement.parentNode.removeChild(styleElement)\n    }\n  }\n\n  update(obj)\n\n  return function updateStyle (newObj /* StyleObjectPart */) {\n    if (newObj) {\n      if (newObj.css === obj.css &&\n          newObj.media === obj.media &&\n          newObj.sourceMap === obj.sourceMap) {\n        return\n      }\n      update(obj = newObj)\n    } else {\n      remove()\n    }\n  }\n}\n\nvar replaceText = (function () {\n  var textStore = []\n\n  return function (index, replacement) {\n    textStore[index] = replacement\n    return textStore.filter(Boolean).join('\\n')\n  }\n})()\n\nfunction applyToSingletonTag (styleElement, index, remove, obj) {\n  var css = remove ? '' : obj.css\n\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = replaceText(index, css)\n  } else {\n    var cssNode = document.createTextNode(css)\n    var childNodes = styleElement.childNodes\n    if (childNodes[index]) styleElement.removeChild(childNodes[index])\n    if (childNodes.length) {\n      styleElement.insertBefore(cssNode, childNodes[index])\n    } else {\n      styleElement.appendChild(cssNode)\n    }\n  }\n}\n\nfunction applyToTag (styleElement, obj) {\n  var css = obj.css\n  var media = obj.media\n  var sourceMap = obj.sourceMap\n\n  if (media) {\n    styleElement.setAttribute('media', media)\n  }\n  if (options.ssrId) {\n    styleElement.setAttribute(ssrIdKey, obj.id)\n  }\n\n  if (sourceMap) {\n    // https://developer.chrome.com/devtools/docs/javascript-debugging\n    // this makes source maps inside style tags work properly in Chrome\n    css += '\\n/*# sourceURL=' + sourceMap.sources[0] + ' */'\n    // http://stackoverflow.com/a/26603875\n    css += '\\n/*# sourceMappingURL=data:application/json;base64,' + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + ' */'\n  }\n\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = css\n  } else {\n    while (styleElement.firstChild) {\n      styleElement.removeChild(styleElement.firstChild)\n    }\n    styleElement.appendChild(document.createTextNode(css))\n  }\n}\n","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./PetContainer.vue?vue&type=style&index=0&id=104a329c&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"17765326\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./PetContainer.vue?vue&type=style&index=0&id=104a329c&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./PetContainer.vue?vue&type=style&index=0&id=104a329c&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.browser-overlay[data-v-104a329c]{position:fixed;inset:0;z-index:10003;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.browser-dialog[data-v-104a329c]{width:min(980px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0,100% 0,100% calc(100% - 12px),calc(100% - 12px) 100%,0 100%)}.browser-dialog[data-v-104a329c]::before{content:\"\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.browser-dialog[data-v-104a329c]{background-image:linear-gradient(rgba(255,255,255,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.03) 1px,transparent 1px);background-size:22px 22px}.browser-dialog-header[data-v-104a329c]{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 18px;border-bottom:1px solid rgba(255,225,0,.36);background:rgba(0,0,0,.28)}.browser-dialog-header h3[data-v-104a329c]{margin:0;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:15px;letter-spacing:.08em}.browser-dialog-header .close-btn[data-v-104a329c]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.browser-dialog-header .close-btn[data-v-104a329c]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.browser-dialog-header .close-btn[data-v-104a329c]:disabled{opacity:.45;cursor:not-allowed}.browser-dialog-header .close-btn[data-v-104a329c]{width:34px;height:28px;padding:0;line-height:1;font-size:16px}.browser-dialog-body[data-v-104a329c]{padding:14px 18px 16px;overflow:auto;flex:1}.browser-dialog-body[data-v-104a329c]::-webkit-scrollbar{width:7px;height:7px}.browser-dialog-body[data-v-104a329c]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.browser-dialog-body[data-v-104a329c]::-webkit-scrollbar-thumb{background:#555}.browser-dialog-body[data-v-104a329c]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}@media (max-width:860px){.browser-overlay[data-v-104a329c]{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.browser-dialog[data-v-104a329c]{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}}@media (max-width:620px){.browser-overlay[data-v-104a329c]{align-items:stretch;padding:0}.browser-dialog[data-v-104a329c]{width:100vw;max-height:100dvh;box-shadow:none;clip-path:none;border-left:none;border-right:none}.browser-dialog-header[data-v-104a329c]{padding:12px}.browser-dialog-body[data-v-104a329c]{padding:10px 12px 12px}}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/PetContainer.vue\"],\"names\":[],\"mappings\":\"AAAA,iEAAA,CCAwH,kCAAiB,cAAe,CAAA,OAAQ,CAAA,aAAc,CAAA,yBAA0B,CAAA,YAAa,CAAA,kBAAmB,CAAA,sBAAuB,CAAA,YAAa,CAAA,qBAAsB,CAAA,aAAc,CAAA,iCAAgB,6BAA8B,CAAA,8BAA+B,CAAA,YAAa,CAAA,qBAAsB,CAAA,eAAgB,CAAA,UAAW,CAAA,kBAAmB,CAAA,gFAAiF,CAAA,iBAAkB,CAAA,wBAAyB,CAAA,sCAAuC,CAAA,kFAAuF,CAAA,yCAAwB,UAAW,CAAA,iBAAkB,CAAA,KAAM,CAAA,MAAO,CAAA,UAAW,CAAA,UAAW,CAAA,kBAAmB,CAAA,SAAU,CAAA,iCAAgB,8IAAwJ,CAAA,yBAA0B,CAAA,wCAAuB,YAAa,CAAA,kBAAmB,CAAA,6BAA8B,CAAA,QAAS,CAAA,iBAAkB,CAAA,2CAA4C,CAAA,0BAA2B,CAAA,2CAA0B,QAAS,CAAA,iDAAkD,CAAA,cAAe,CAAA,oBAAqB,CAAA,mDAAkC,uBAAgB,CAAhB,eAAgB,CAAA,oCAAqC,CAAA,wBAAyB,CAAA,UAAW,CAAA,iDAAkD,CAAA,eAAgB,CAAA,oBAAqB,CAAA,wBAAyB,CAAA,cAAe,CAAA,kFAAuF,CAAA,sEAAuE,CAAA,wEAAuD,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,4DAA2C,WAAY,CAAA,kBAAmB,CAAA,mDAAkC,UAAW,CAAA,WAAY,CAAA,SAAU,CAAA,aAAc,CAAA,cAAe,CAAA,sCAAqB,sBAAuB,CAAA,aAAc,CAAA,MAAO,CAAA,yDAAwC,SAAU,CAAA,UAAW,CAAA,+DAA8C,8BAA+B,CAAA,+DAA8C,eAAgB,CAAA,qEAAoD,kBAAmB,CAAA,yBAAyB,kCAAiB,sBAAuB,CAAA,wFAAyF,CAAA,iCAAgB,UAAW,CAAA,uFAAwF,CAAA,cAAe,CAAA,wCAAyC,CAAC,CAAA,yBAAyB,kCAAiB,mBAAoB,CAAA,SAAU,CAAA,iCAAgB,WAAY,CAAA,iBAAkB,CAAA,eAAgB,CAAA,cAAe,CAAA,gBAAiB,CAAA,iBAAkB,CAAA,wCAAuB,YAAa,CAAA,sCAAqB,sBAAuB,CAAC\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.browser-overlay{position:fixed;inset:0;z-index:10003;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.browser-dialog{width:min(980px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%)}.browser-dialog::before{content:\\\"\\\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.browser-dialog{background-image:linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);background-size:22px 22px}.browser-dialog-header{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 18px;border-bottom:1px solid rgba(255,225,0,.36);background:rgba(0,0,0,.28)}.browser-dialog-header h3{margin:0;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:15px;letter-spacing:.08em}.browser-dialog-header .close-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.browser-dialog-header .close-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.browser-dialog-header .close-btn:disabled{opacity:.45;cursor:not-allowed}.browser-dialog-header .close-btn{width:34px;height:28px;padding:0;line-height:1;font-size:16px}.browser-dialog-body{padding:14px 18px 16px;overflow:auto;flex:1}.browser-dialog-body::-webkit-scrollbar{width:7px;height:7px}.browser-dialog-body::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.browser-dialog-body::-webkit-scrollbar-thumb{background:#555}.browser-dialog-body::-webkit-scrollbar-thumb:hover{background:#6f6f6f}@media(max-width: 860px){.browser-overlay{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.browser-dialog{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}}@media(max-width: 620px){.browser-overlay{align-items:stretch;padding:0}.browser-dialog{width:100vw;max-height:100dvh;box-shadow:none;clip-path:none;border-left:none;border-right:none}.browser-dialog-header{padding:12px}.browser-dialog-body{padding:10px 12px 12px}}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./TreeNode.vue?vue&type=style&index=0&id=3a6a95ba&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"bd0944e8\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./TreeNode.vue?vue&type=style&index=0&id=3a6a95ba&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./TreeNode.vue?vue&type=style&index=0&id=3a6a95ba&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.chat-bubble[data-v-98097aea]{position:fixed;transform:translate(-50%,-100%);max-width:320px;min-width:80px;animation:bubble-in-98097aea .22s ease-out;z-index:10004;pointer-events:none}.bubble-content[data-v-98097aea]{position:relative;background:rgba(14,14,14,.96);color:#fff;border:1px solid #ffe100;padding:9px 26px 10px 13px;clip-path:polygon(10px 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%,0 10px);font-size:12px;line-height:1.5;word-break:break-word;box-shadow:8px 8px 0 rgba(0,0,0,.56);font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif;pointer-events:auto}.bubble-content[data-v-98097aea]::after{content:\"\";position:absolute;right:22px;bottom:-2px;width:30px;height:3px;background:#ffe100}.bubble-text[data-v-98097aea]{white-space:pre-wrap}.cursor[data-v-98097aea]{animation:blink-98097aea .64s infinite;margin-left:1px;color:#00dac2}.bubble-close[data-v-98097aea]{position:absolute;right:6px;top:5px;width:15px;height:15px;border:1px solid hsla(0,0%,100%,.3);background:hsla(0,0%,100%,.08);color:#fff;line-height:13px;text-align:center;cursor:pointer;font-size:10px;padding:0;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif}.bubble-close[data-v-98097aea]:hover{background:#ff3b30;border-color:#ff3b30}.bubble-arrow[data-v-98097aea]{width:11px;height:11px;background:rgba(14,14,14,.96);border-left:1px solid #ffe100;border-bottom:1px solid #ffe100;transform:rotate(-45deg);margin:0 auto;margin-top:-6px}@keyframes bubble-in-98097aea{from{opacity:0;transform:translateX(-50%) translateY(8px) scale(0.9)}to{opacity:1;transform:translateX(-50%) translateY(0) scale(1)}}@keyframes blink-98097aea{0%,50%{opacity:1}51%,100%{opacity:0}}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/ChatBubble.vue\"],\"names\":[],\"mappings\":\"AAAA,iEAAA,CCAwH,8BAAa,cAAe,CAAA,+BAAiC,CAAA,eAAgB,CAAA,cAAe,CAAA,0CAAkC,CAAA,aAAc,CAAA,mBAAoB,CAAA,iCAAgB,iBAAkB,CAAA,6BAA8B,CAAA,UAAW,CAAA,wBAAyB,CAAA,0BAA2B,CAAA,4FAAkG,CAAA,cAAe,CAAA,eAAgB,CAAA,qBAAsB,CAAA,oCAAqC,CAAA,gFAAiF,CAAA,mBAAoB,CAAA,wCAAuB,UAAW,CAAA,iBAAkB,CAAA,UAAW,CAAA,WAAY,CAAA,UAAW,CAAA,UAAW,CAAA,kBAAmB,CAAA,8BAAa,oBAAqB,CAAA,yBAAQ,sCAA8B,CAAA,eAAgB,CAAA,aAAc,CAAA,+BAAc,iBAAkB,CAAA,SAAU,CAAA,OAAQ,CAAA,UAAW,CAAA,WAAY,CAAA,mCAAoC,CAAA,8BAA+B,CAAA,UAAW,CAAA,gBAAiB,CAAA,iBAAkB,CAAA,cAAe,CAAA,cAAe,CAAA,SAAU,CAAA,iDAAkD,CAAA,qCAAoB,kBAAmB,CAAA,oBAAqB,CAAA,+BAAc,UAAW,CAAA,WAAY,CAAA,6BAA8B,CAAA,6BAA8B,CAAA,+BAAgC,CAAA,wBAAyB,CAAA,aAAc,CAAA,eAAgB,CAAA,8BAAqB,KAAK,SAAU,CAAA,qDAAsD,CAAA,GAAG,SAAU,CAAA,iDAAkD,CAAC,CAAA,0BAAiB,OAAO,SAAU,CAAA,SAAS,SAAU,CAAC\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.chat-bubble{position:fixed;transform:translate(-50%, -100%);max-width:320px;min-width:80px;animation:bubble-in .22s ease-out;z-index:10004;pointer-events:none}.bubble-content{position:relative;background:rgba(14,14,14,.96);color:#fff;border:1px solid #ffe100;padding:9px 26px 10px 13px;clip-path:polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);font-size:12px;line-height:1.5;word-break:break-word;box-shadow:8px 8px 0 rgba(0,0,0,.56);font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif;pointer-events:auto}.bubble-content::after{content:\\\"\\\";position:absolute;right:22px;bottom:-2px;width:30px;height:3px;background:#ffe100}.bubble-text{white-space:pre-wrap}.cursor{animation:blink .64s infinite;margin-left:1px;color:#00dac2}.bubble-close{position:absolute;right:6px;top:5px;width:15px;height:15px;border:1px solid hsla(0,0%,100%,.3);background:hsla(0,0%,100%,.08);color:#fff;line-height:13px;text-align:center;cursor:pointer;font-size:10px;padding:0;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif}.bubble-close:hover{background:#ff3b30;border-color:#ff3b30}.bubble-arrow{width:11px;height:11px;background:rgba(14,14,14,.96);border-left:1px solid #ffe100;border-bottom:1px solid #ffe100;transform:rotate(-45deg);margin:0 auto;margin-top:-6px}@keyframes bubble-in{from{opacity:0;transform:translateX(-50%) translateY(8px) scale(0.9)}to{opacity:1;transform:translateX(-50%) translateY(0) scale(1)}}@keyframes blink{0%,50%{opacity:1}51%,100%{opacity:0}}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n  if (!cssMapping) {\n    return content;\n  }\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    return [content].concat([sourceMapping]).join(\"\\n\");\n  }\n  return [content].join(\"\\n\");\n};","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.settings-overlay[data-v-7941402e]{position:fixed;inset:0;z-index:10001;background:rgba(0,0,0,.82);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.settings-panel[data-v-7941402e]{width:min(1080px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0,100% 0,100% calc(100% - 12px),calc(100% - 12px) 100%,0 100%)}.settings-panel[data-v-7941402e]::before{content:\"\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.settings-panel[data-v-7941402e]{background-image:linear-gradient(rgba(255,255,255,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.03) 1px,transparent 1px);background-size:22px 22px}.panel-header[data-v-7941402e]{display:flex;align-items:center;justify-content:space-between;gap:14px;padding:14px 18px;border-bottom:2px solid #ffe100;background:rgba(0,0,0,.32)}.header-title[data-v-7941402e]{min-width:0}.header-title h3[data-v-7941402e]{margin:0;font-size:20px;line-height:1;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase}.header-title p[data-v-7941402e]{margin:4px 0 0;font-size:10px;color:#8d8d8d;letter-spacing:.14em;text-transform:uppercase}.close-btn[data-v-7941402e]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.close-btn[data-v-7941402e]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.close-btn[data-v-7941402e]:disabled{opacity:.45;cursor:not-allowed}.close-btn[data-v-7941402e]{min-width:88px;height:32px;padding:0 10px;font-size:12px}.panel-main[data-v-7941402e]{flex:1;min-height:0;display:grid;grid-template-columns:220px 1fr}.panel-nav[data-v-7941402e]{border-right:1px solid hsla(0,0%,100%,.16);padding:12px;overflow:auto}.panel-nav[data-v-7941402e]::-webkit-scrollbar{width:7px;height:7px}.panel-nav[data-v-7941402e]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-nav[data-v-7941402e]::-webkit-scrollbar-thumb{background:#555}.panel-nav[data-v-7941402e]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.nav-btn[data-v-7941402e]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.nav-btn[data-v-7941402e]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.nav-btn[data-v-7941402e]:disabled{opacity:.45;cursor:not-allowed}.nav-btn[data-v-7941402e]{width:100%;min-height:62px;padding:10px 12px;margin-bottom:10px;text-align:left;display:grid;grid-template-columns:auto 1fr;grid-template-areas:\"idx label\" \"idx sub\";-moz-column-gap:8px;column-gap:8px;row-gap:2px}.nav-btn[data-v-7941402e]:last-child{margin-bottom:0}.nav-btn.active[data-v-7941402e]{background:#ffe100;color:#000;border-color:#ffe100}.nav-index[data-v-7941402e]{grid-area:idx;align-self:center;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;color:#00dac2;font-size:18px}.nav-label[data-v-7941402e]{grid-area:label;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:13px;letter-spacing:.05em}.nav-sub[data-v-7941402e]{grid-area:sub;font-size:10px;color:#8d8d8d;letter-spacing:.06em}.panel-body[data-v-7941402e]{padding:14px 18px 16px;overflow:auto}.panel-body[data-v-7941402e]::-webkit-scrollbar{width:7px;height:7px}.panel-body[data-v-7941402e]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-body[data-v-7941402e]::-webkit-scrollbar-thumb{background:#555}.panel-body[data-v-7941402e]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.setting-section[data-v-7941402e]{max-width:740px}.setting-section h4[data-v-7941402e]{margin:0 0 12px;display:inline-flex;align-items:center;gap:8px;padding:4px 12px;background:#0f0f0f;border-left:4px solid #ffe100;transform:skewX(-14deg)}.setting-section h4[data-v-7941402e]>*{transform:skewX(14deg)}.section-index[data-v-7941402e]{color:#00dac2;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:13px}.section-label[data-v-7941402e]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:14px;letter-spacing:.04em}.section-sub[data-v-7941402e]{font-size:10px;color:#8d8d8d;letter-spacing:.06em}.form-group[data-v-7941402e]{margin-bottom:12px}.form-group>label[data-v-7941402e]{display:block;margin-bottom:5px;font-size:12px;color:#d5d5d5;line-height:1.35}.form-group>label>input[type=checkbox][data-v-7941402e]{margin-right:8px;accent-color:#00dac2}.form-group input[type=text][data-v-7941402e],.form-group input[type=password][data-v-7941402e],.form-group input[type=number][data-v-7941402e],.form-group select[data-v-7941402e],.form-group textarea[data-v-7941402e]{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.form-group input[type=text][data-v-7941402e]:focus,.form-group input[type=password][data-v-7941402e]:focus,.form-group input[type=number][data-v-7941402e]:focus,.form-group select[data-v-7941402e]:focus,.form-group textarea[data-v-7941402e]:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.form-group input[type=text][data-v-7941402e]::placeholder,.form-group input[type=password][data-v-7941402e]::placeholder,.form-group input[type=number][data-v-7941402e]::placeholder,.form-group select[data-v-7941402e]::placeholder,.form-group textarea[data-v-7941402e]::placeholder{color:#8d8d8d}.form-group textarea[data-v-7941402e]{resize:vertical;min-height:86px;font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;color:#fff}.form-group select[data-v-7941402e]{color:#fff;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif}.form-group select option[data-v-7941402e]{background:#101010;color:#fff}.form-group input[type=range][data-v-7941402e]{width:100%;-webkit-appearance:none;appearance:none;height:4px;border:none;background:#4a4a4a;border-radius:0;padding:0;margin:7px 0 4px}.form-group input[type=range][data-v-7941402e]::-webkit-slider-thumb{-webkit-appearance:none;width:12px;height:12px;background:#ffe100;border:2px solid #000;transform:rotate(45deg)}.form-group input[type=range][data-v-7941402e]::-moz-range-thumb{width:12px;height:12px;border:2px solid #000;border-radius:0;background:#ffe100;transform:rotate(45deg)}.form-group input[type=range][data-v-7941402e]::-moz-range-track{height:4px;background:#4a4a4a;border:none}.form-group input[type=checkbox][data-v-7941402e]{accent-color:#00dac2}.form-group .hint[data-v-7941402e]{margin-top:4px;font-size:11px;color:#8d8d8d}.hint-error[data-v-7941402e]{color:#ff3b30 !important}.form-row[data-v-7941402e]{display:flex;gap:12px;align-items:flex-start}.form-row .half[data-v-7941402e]{flex:1;min-width:0}.dice-sheet-list[data-v-7941402e]{margin-top:6px;display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:8px}.dice-sheet-item[data-v-7941402e]{display:flex;align-items:center;gap:8px;padding:6px 8px;border:1px solid hsla(0,0%,100%,.18);background:hsla(0,0%,100%,.04);font-size:12px;color:#e8e8e8;line-height:1.35}.dice-sheet-item input[type=checkbox][data-v-7941402e]{margin:0}.input-with-btn[data-v-7941402e]{display:grid;grid-template-columns:1fr auto;gap:8px;align-items:stretch}.input-with-btn .input-btn[data-v-7941402e]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.input-with-btn .input-btn[data-v-7941402e]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.input-with-btn .input-btn[data-v-7941402e]:disabled{opacity:.45;cursor:not-allowed}.input-with-btn .input-btn[data-v-7941402e]{min-width:84px;padding:0 12px;font-size:11px;white-space:nowrap}.model-list[data-v-7941402e]{display:flex;flex-wrap:wrap;gap:8px}.model-btn[data-v-7941402e]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.model-btn[data-v-7941402e]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.model-btn[data-v-7941402e]:disabled{opacity:.45;cursor:not-allowed}.model-btn[data-v-7941402e]{min-height:30px;padding:0 12px;font-size:12px;text-transform:none;letter-spacing:.03em}.model-btn.active[data-v-7941402e]{background:#ffe100;border-color:#ffe100;color:#000}.model-btn.browse-btn[data-v-7941402e]{border-color:rgba(0,218,194,.55);color:#b2fff6}.model-btn.browse-btn[data-v-7941402e]:hover{background:#00dac2;border-color:#00dac2;color:#000}.emotion-layout[data-v-7941402e]{display:grid;grid-template-columns:minmax(0,1fr) 340px;gap:14px;align-items:start}.emotion-configs[data-v-7941402e]{min-width:0}.emotion-preview-panel[data-v-7941402e]{position:sticky;top:10px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.28);padding:10px 12px 12px;background-image:linear-gradient(rgba(255,255,255,0.02) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.02) 1px,transparent 1px);background-size:18px 18px}.emotion-preview-header[data-v-7941402e]{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:10px}.emotion-preview-title[data-v-7941402e]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:700;letter-spacing:.08em;color:#00dac2}.emotion-preview-tag[data-v-7941402e]{font-size:12px;color:hsla(0,0%,100%,.78)}.emotion-preview-canvas[data-v-7941402e]{position:relative;width:100%;aspect-ratio:3/4;border-radius:10px;overflow:hidden;background:rgba(15,23,42,.95);border:1px solid hsla(0,0%,100%,.18)}.emotion-preview-interact[data-v-7941402e]{position:absolute;inset:0;z-index:3}.emotion-preview-empty[data-v-7941402e]{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;padding:10px;text-align:center;z-index:4;pointer-events:none;color:hsla(0,0%,100%,.78);font-size:12px}.emotion-preview-controls[data-v-7941402e]{margin-top:10px;display:flex;flex-direction:column;gap:8px}.emotion-zoom-row[data-v-7941402e]{display:grid;grid-template-columns:auto 1fr auto;gap:10px;align-items:center}.zoom-label[data-v-7941402e]{font-size:12px;color:hsla(0,0%,100%,.78)}.zoom-value[data-v-7941402e]{font-size:12px;color:#ffe100;font-variant-numeric:tabular-nums}.emotion-preview-actions[data-v-7941402e]{display:flex;gap:8px}.emotion-tag[data-v-7941402e]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:700;letter-spacing:.08em;color:#ffe100;text-transform:uppercase}.emotion-map-table[data-v-7941402e]{margin-top:4px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.22);max-height:none;overflow:visible;background-image:linear-gradient(rgba(255,255,255,0.02) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.02) 1px,transparent 1px);background-size:20px 20px}.emotion-map-head[data-v-7941402e],.emotion-map-row[data-v-7941402e]{display:grid;grid-template-columns:72px 22px minmax(0,1fr) minmax(0,1fr) 52px;gap:10px;align-items:center}.emotion-map-head[data-v-7941402e]{position:sticky;top:0;z-index:2;padding:8px 10px;font-size:10px;color:hsla(0,0%,100%,.68);letter-spacing:.03em;background:rgba(2,8,20,.92);border-bottom:1px solid hsla(0,0%,100%,.2)}.emotion-map-row[data-v-7941402e]{padding:10px;border-bottom:1px solid hsla(0,0%,100%,.12)}.emotion-map-row[data-v-7941402e]:nth-child(odd){background:hsla(0,0%,100%,.02)}.emotion-map-tag[data-v-7941402e]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:700;letter-spacing:.08em;color:#ffe100}.emotion-map-arrow[data-v-7941402e]{text-align:center;color:hsla(0,0%,100%,.78);font-size:18px;line-height:1}.emotion-map-preview-btn[data-v-7941402e]{min-width:0;width:44px;height:32px;padding:0;font-size:14px;line-height:1}.emotion-map-row select[data-v-7941402e]{width:100%;min-width:0;text-overflow:ellipsis;white-space:nowrap}.emotion-advanced-list[data-v-7941402e]{margin-top:10px;display:flex;flex-direction:column;gap:10px}.emotion-advanced-item[data-v-7941402e]{border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.28);padding:10px 12px 2px;background-image:linear-gradient(rgba(255,255,255,0.025) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.025) 1px,transparent 1px);background-size:18px 18px}.emotion-advanced-title[data-v-7941402e]{margin-bottom:8px;font-size:12px;letter-spacing:.06em;color:hsla(0,0%,100%,.85)}.advanced-toggle[data-v-7941402e]{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border:1px solid hsla(0,0%,100%,.2);background:hsla(0,0%,100%,.04);font-size:11px;color:#d5d5d5;cursor:pointer;-webkit-user-select:none;user-select:none;clip-path:polygon(0 0,100% 0,100% calc(100% - 8px),calc(100% - 8px) 100%,0 100%)}.advanced-toggle[data-v-7941402e]:hover{border-color:rgba(255,225,0,.65);color:#ffe100}.advanced-toggle .toggle-icon[data-v-7941402e]{width:12px;text-align:center;color:#00dac2}.advanced-params[data-v-7941402e]{margin-top:8px;padding-top:10px;border-top:1px dashed hsla(0,0%,100%,.2)}.about-card[data-v-7941402e]{margin-bottom:12px;padding:10px 12px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.26);background-image:linear-gradient(rgba(255,255,255,0.02) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.02) 1px,transparent 1px);background-size:18px 18px}.about-title[data-v-7941402e]{margin-bottom:8px;font-size:12px;letter-spacing:.06em;color:#ffe100}.about-link[data-v-7941402e]{color:#00dac2;word-break:break-all;text-decoration:underline}.about-list[data-v-7941402e]{margin:0;padding-left:18px;display:flex;flex-direction:column;gap:8px;font-size:12px;line-height:1.5;color:#d5d5d5}.status-badge[data-v-7941402e]{margin-left:8px;font-size:12px}.status-success[data-v-7941402e]{color:#00dac2}.status-fail[data-v-7941402e]{color:#ff9c94}.panel-footer[data-v-7941402e]{display:flex;justify-content:flex-end;gap:10px;padding:12px 18px 14px;border-top:1px solid hsla(0,0%,100%,.18);background:rgba(0,0,0,.36)}.btn[data-v-7941402e]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.btn[data-v-7941402e]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.btn[data-v-7941402e]:disabled{opacity:.45;cursor:not-allowed}.btn[data-v-7941402e]{min-width:100px;height:34px;padding:0 14px;font-size:12px}.btn-primary[data-v-7941402e]{background:#ffe100;color:#000;border-color:#ffe100}.btn-secondary[data-v-7941402e]{background:hsla(0,0%,100%,.06);border-color:hsla(0,0%,100%,.3)}.btn-test[data-v-7941402e]{min-width:96px;background:rgba(0,218,194,.1);border-color:rgba(0,218,194,.6);color:#bcfff7}.btn-test[data-v-7941402e]:hover:not(:disabled){background:#00dac2;border-color:#00dac2;color:#000}.browser-overlay[data-v-7941402e]{position:fixed;inset:0;z-index:10002;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.browser-dialog[data-v-7941402e]{width:min(980px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0,100% 0,100% calc(100% - 12px),calc(100% - 12px) 100%,0 100%)}.browser-dialog[data-v-7941402e]::before{content:\"\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.browser-dialog[data-v-7941402e]{background-image:linear-gradient(rgba(255,255,255,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.03) 1px,transparent 1px);background-size:22px 22px}.browser-dialog-header[data-v-7941402e]{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 18px;border-bottom:1px solid rgba(255,225,0,.36);background:rgba(0,0,0,.28)}.browser-dialog-header h3[data-v-7941402e]{margin:0;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:15px;letter-spacing:.08em}.browser-dialog-header .close-btn[data-v-7941402e]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.browser-dialog-header .close-btn[data-v-7941402e]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.browser-dialog-header .close-btn[data-v-7941402e]:disabled{opacity:.45;cursor:not-allowed}.browser-dialog-header .close-btn[data-v-7941402e]{width:34px;height:28px;padding:0;line-height:1;font-size:16px}.browser-dialog-body[data-v-7941402e]{padding:14px 18px 16px;overflow:auto;flex:1}.browser-dialog-body[data-v-7941402e]::-webkit-scrollbar{width:7px;height:7px}.browser-dialog-body[data-v-7941402e]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.browser-dialog-body[data-v-7941402e]::-webkit-scrollbar-thumb{background:#555}.browser-dialog-body[data-v-7941402e]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}@media (max-width:860px){.settings-overlay[data-v-7941402e]{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.settings-panel[data-v-7941402e]{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}.settings-panel[data-v-7941402e]::before{width:40px}.panel-main[data-v-7941402e]{grid-template-columns:1fr;grid-template-rows:auto 1fr;min-height:0}.panel-nav[data-v-7941402e]{border-right:none;border-bottom:1px solid hsla(0,0%,100%,.16);display:flex;gap:6px;padding:8px 10px;overflow-x:auto;overflow-y:hidden}.panel-nav[data-v-7941402e]::-webkit-scrollbar{width:7px;height:7px}.panel-nav[data-v-7941402e]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-nav[data-v-7941402e]::-webkit-scrollbar-thumb{background:#555}.panel-nav[data-v-7941402e]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.nav-btn[data-v-7941402e]{flex:0 0 auto;width:150px;min-height:42px;padding:6px 10px;margin-bottom:0;grid-template-areas:\"idx label\";grid-template-columns:auto 1fr;row-gap:0;align-items:center}.panel-body[data-v-7941402e]{min-height:0}.nav-index[data-v-7941402e]{font-size:16px}.nav-label[data-v-7941402e]{font-size:12px}.nav-sub[data-v-7941402e]{display:none}.browser-overlay[data-v-7941402e]{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.browser-dialog[data-v-7941402e]{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}.emotion-layout[data-v-7941402e]{grid-template-columns:1fr}.emotion-preview-panel[data-v-7941402e]{order:-1;position:sticky;top:8px;z-index:8;margin-bottom:8px;padding:8px 10px 10px;background:rgba(0,0,0,.9)}.emotion-preview-header[data-v-7941402e]{margin-bottom:6px}.emotion-preview-canvas[data-v-7941402e]{aspect-ratio:16/9;max-height:210px}.emotion-preview-controls[data-v-7941402e]{margin-top:8px;gap:6px}.emotion-map-head[data-v-7941402e]{position:static}.emotion-preview-controls .hint[data-v-7941402e]{display:none}}@media (max-width:620px){.settings-overlay[data-v-7941402e]{align-items:stretch;padding:0}.settings-panel[data-v-7941402e]{width:100vw;max-height:100dvh;border-left:none;border-right:none;box-shadow:none}.panel-header[data-v-7941402e]{padding:10px 12px}.header-title h3[data-v-7941402e]{font-size:15px;letter-spacing:.06em}.header-title p[data-v-7941402e]{display:none}.panel-nav[data-v-7941402e]{padding:6px 8px}.nav-btn[data-v-7941402e]{width:126px;min-height:38px;padding:5px 8px}.nav-index[data-v-7941402e]{font-size:14px}.nav-label[data-v-7941402e]{font-size:11px;letter-spacing:.04em}.close-btn[data-v-7941402e]{min-width:66px;height:28px;padding:0 8px;font-size:11px}.panel-footer[data-v-7941402e]{padding:10px 12px calc(10px + env(safe-area-inset-bottom))}.panel-body[data-v-7941402e]{padding:8px 10px}.form-row[data-v-7941402e]{flex-direction:column;gap:0}.input-with-btn[data-v-7941402e]{grid-template-columns:1fr}.btn[data-v-7941402e]{min-width:86px}.emotion-preview-panel[data-v-7941402e]{top:6px;padding:8px}.emotion-preview-canvas[data-v-7941402e]{max-height:180px}.emotion-map-head[data-v-7941402e],.emotion-map-row[data-v-7941402e]{grid-template-columns:56px 16px minmax(0,1fr) minmax(0,1fr) 42px;gap:6px}.emotion-map-row[data-v-7941402e]{padding:8px}.emotion-map-arrow[data-v-7941402e]{font-size:14px}.emotion-map-preview-btn[data-v-7941402e]{width:38px;height:30px;font-size:12px}.browser-overlay[data-v-7941402e]{align-items:stretch;padding:0}.browser-dialog[data-v-7941402e]{width:100vw;max-height:100dvh;box-shadow:none;clip-path:none}.browser-dialog-header[data-v-7941402e]{padding:12px}.browser-dialog-body[data-v-7941402e]{padding:10px 12px 12px}}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/SettingsPanel.vue\"],\"names\":[],\"mappings\":\"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\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.settings-overlay{position:fixed;inset:0;z-index:10001;background:rgba(0,0,0,.82);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.settings-panel{width:min(1080px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%)}.settings-panel::before{content:\\\"\\\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.settings-panel{background-image:linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);background-size:22px 22px}.panel-header{display:flex;align-items:center;justify-content:space-between;gap:14px;padding:14px 18px;border-bottom:2px solid #ffe100;background:rgba(0,0,0,.32)}.header-title{min-width:0}.header-title h3{margin:0;font-size:20px;line-height:1;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase}.header-title p{margin:4px 0 0;font-size:10px;color:#8d8d8d;letter-spacing:.14em;text-transform:uppercase}.close-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.close-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.close-btn:disabled{opacity:.45;cursor:not-allowed}.close-btn{min-width:88px;height:32px;padding:0 10px;font-size:12px}.panel-main{flex:1;min-height:0;display:grid;grid-template-columns:220px 1fr}.panel-nav{border-right:1px solid hsla(0,0%,100%,.16);padding:12px;overflow:auto}.panel-nav::-webkit-scrollbar{width:7px;height:7px}.panel-nav::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-nav::-webkit-scrollbar-thumb{background:#555}.panel-nav::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.nav-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.nav-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.nav-btn:disabled{opacity:.45;cursor:not-allowed}.nav-btn{width:100%;min-height:62px;padding:10px 12px;margin-bottom:10px;text-align:left;display:grid;grid-template-columns:auto 1fr;grid-template-areas:\\\"idx label\\\" \\\"idx sub\\\";column-gap:8px;row-gap:2px}.nav-btn:last-child{margin-bottom:0}.nav-btn.active{background:#ffe100;color:#000;border-color:#ffe100}.nav-index{grid-area:idx;align-self:center;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;color:#00dac2;font-size:18px}.nav-label{grid-area:label;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:13px;letter-spacing:.05em}.nav-sub{grid-area:sub;font-size:10px;color:#8d8d8d;letter-spacing:.06em}.panel-body{padding:14px 18px 16px;overflow:auto}.panel-body::-webkit-scrollbar{width:7px;height:7px}.panel-body::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-body::-webkit-scrollbar-thumb{background:#555}.panel-body::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.setting-section{max-width:740px}.setting-section h4{margin:0 0 12px;display:inline-flex;align-items:center;gap:8px;padding:4px 12px;background:#0f0f0f;border-left:4px solid #ffe100;transform:skewX(-14deg)}.setting-section h4>*{transform:skewX(14deg)}.section-index{color:#00dac2;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:13px}.section-label{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:14px;letter-spacing:.04em}.section-sub{font-size:10px;color:#8d8d8d;letter-spacing:.06em}.form-group{margin-bottom:12px}.form-group>label{display:block;margin-bottom:5px;font-size:12px;color:#d5d5d5;line-height:1.35}.form-group>label>input[type=checkbox]{margin-right:8px;accent-color:#00dac2}.form-group input[type=text],.form-group input[type=password],.form-group input[type=number],.form-group select,.form-group textarea{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.form-group input[type=text]:focus,.form-group input[type=password]:focus,.form-group input[type=number]:focus,.form-group select:focus,.form-group textarea:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.form-group input[type=text]::placeholder,.form-group input[type=password]::placeholder,.form-group input[type=number]::placeholder,.form-group select::placeholder,.form-group textarea::placeholder{color:#8d8d8d}.form-group textarea{resize:vertical;min-height:86px;font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;color:#fff}.form-group select{color:#fff;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif}.form-group select option{background:#101010;color:#fff}.form-group input[type=range]{width:100%;appearance:none;height:4px;border:none;background:#4a4a4a;border-radius:0;padding:0;margin:7px 0 4px}.form-group input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:12px;height:12px;background:#ffe100;border:2px solid #000;transform:rotate(45deg)}.form-group input[type=range]::-moz-range-thumb{width:12px;height:12px;border:2px solid #000;border-radius:0;background:#ffe100;transform:rotate(45deg)}.form-group input[type=range]::-moz-range-track{height:4px;background:#4a4a4a;border:none}.form-group input[type=checkbox]{accent-color:#00dac2}.form-group .hint{margin-top:4px;font-size:11px;color:#8d8d8d}.hint-error{color:#ff3b30 !important}.form-row{display:flex;gap:12px;align-items:flex-start}.form-row .half{flex:1;min-width:0}.dice-sheet-list{margin-top:6px;display:grid;grid-template-columns:repeat(auto-fit, minmax(180px, 1fr));gap:8px}.dice-sheet-item{display:flex;align-items:center;gap:8px;padding:6px 8px;border:1px solid hsla(0,0%,100%,.18);background:hsla(0,0%,100%,.04);font-size:12px;color:#e8e8e8;line-height:1.35}.dice-sheet-item input[type=checkbox]{margin:0}.input-with-btn{display:grid;grid-template-columns:1fr auto;gap:8px;align-items:stretch}.input-with-btn .input-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.input-with-btn .input-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.input-with-btn .input-btn:disabled{opacity:.45;cursor:not-allowed}.input-with-btn .input-btn{min-width:84px;padding:0 12px;font-size:11px;white-space:nowrap}.model-list{display:flex;flex-wrap:wrap;gap:8px}.model-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.model-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.model-btn:disabled{opacity:.45;cursor:not-allowed}.model-btn{min-height:30px;padding:0 12px;font-size:12px;text-transform:none;letter-spacing:.03em}.model-btn.active{background:#ffe100;border-color:#ffe100;color:#000}.model-btn.browse-btn{border-color:rgba(0,218,194,.55);color:#b2fff6}.model-btn.browse-btn:hover{background:#00dac2;border-color:#00dac2;color:#000}.emotion-layout{display:grid;grid-template-columns:minmax(0, 1fr) 340px;gap:14px;align-items:start}.emotion-configs{min-width:0}.emotion-preview-panel{position:sticky;top:10px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.28);padding:10px 12px 12px;background-image:linear-gradient(rgba(255, 255, 255, 0.02) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.02) 1px, transparent 1px);background-size:18px 18px}.emotion-preview-header{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:10px}.emotion-preview-title{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:700;letter-spacing:.08em;color:#00dac2}.emotion-preview-tag{font-size:12px;color:hsla(0,0%,100%,.78)}.emotion-preview-canvas{position:relative;width:100%;aspect-ratio:3/4;border-radius:10px;overflow:hidden;background:rgba(15,23,42,.95);border:1px solid hsla(0,0%,100%,.18)}.emotion-preview-interact{position:absolute;inset:0;z-index:3}.emotion-preview-empty{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;padding:10px;text-align:center;z-index:4;pointer-events:none;color:hsla(0,0%,100%,.78);font-size:12px}.emotion-preview-controls{margin-top:10px;display:flex;flex-direction:column;gap:8px}.emotion-zoom-row{display:grid;grid-template-columns:auto 1fr auto;gap:10px;align-items:center}.zoom-label{font-size:12px;color:hsla(0,0%,100%,.78)}.zoom-value{font-size:12px;color:#ffe100;font-variant-numeric:tabular-nums}.emotion-preview-actions{display:flex;gap:8px}.emotion-tag{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:700;letter-spacing:.08em;color:#ffe100;text-transform:uppercase}.emotion-map-table{margin-top:4px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.22);max-height:none;overflow:visible;background-image:linear-gradient(rgba(255, 255, 255, 0.02) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.02) 1px, transparent 1px);background-size:20px 20px}.emotion-map-head,.emotion-map-row{display:grid;grid-template-columns:72px 22px minmax(0, 1fr) minmax(0, 1fr) 52px;gap:10px;align-items:center}.emotion-map-head{position:sticky;top:0;z-index:2;padding:8px 10px;font-size:10px;color:hsla(0,0%,100%,.68);letter-spacing:.03em;background:rgba(2,8,20,.92);border-bottom:1px solid hsla(0,0%,100%,.2)}.emotion-map-row{padding:10px;border-bottom:1px solid hsla(0,0%,100%,.12)}.emotion-map-row:nth-child(odd){background:hsla(0,0%,100%,.02)}.emotion-map-tag{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:700;letter-spacing:.08em;color:#ffe100}.emotion-map-arrow{text-align:center;color:hsla(0,0%,100%,.78);font-size:18px;line-height:1}.emotion-map-preview-btn{min-width:0;width:44px;height:32px;padding:0;font-size:14px;line-height:1}.emotion-map-row select{width:100%;min-width:0;text-overflow:ellipsis;white-space:nowrap}.emotion-advanced-list{margin-top:10px;display:flex;flex-direction:column;gap:10px}.emotion-advanced-item{border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.28);padding:10px 12px 2px;background-image:linear-gradient(rgba(255, 255, 255, 0.025) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.025) 1px, transparent 1px);background-size:18px 18px}.emotion-advanced-title{margin-bottom:8px;font-size:12px;letter-spacing:.06em;color:hsla(0,0%,100%,.85)}.advanced-toggle{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border:1px solid hsla(0,0%,100%,.2);background:hsla(0,0%,100%,.04);font-size:11px;color:#d5d5d5;cursor:pointer;user-select:none;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 8px), calc(100% - 8px) 100%, 0 100%)}.advanced-toggle:hover{border-color:rgba(255,225,0,.65);color:#ffe100}.advanced-toggle .toggle-icon{width:12px;text-align:center;color:#00dac2}.advanced-params{margin-top:8px;padding-top:10px;border-top:1px dashed hsla(0,0%,100%,.2)}.about-card{margin-bottom:12px;padding:10px 12px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.26);background-image:linear-gradient(rgba(255, 255, 255, 0.02) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.02) 1px, transparent 1px);background-size:18px 18px}.about-title{margin-bottom:8px;font-size:12px;letter-spacing:.06em;color:#ffe100}.about-link{color:#00dac2;word-break:break-all;text-decoration:underline}.about-list{margin:0;padding-left:18px;display:flex;flex-direction:column;gap:8px;font-size:12px;line-height:1.5;color:#d5d5d5}.status-badge{margin-left:8px;font-size:12px}.status-success{color:#00dac2}.status-fail{color:#ff9c94}.panel-footer{display:flex;justify-content:flex-end;gap:10px;padding:12px 18px 14px;border-top:1px solid hsla(0,0%,100%,.18);background:rgba(0,0,0,.36)}.btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.btn:disabled{opacity:.45;cursor:not-allowed}.btn{min-width:100px;height:34px;padding:0 14px;font-size:12px}.btn-primary{background:#ffe100;color:#000;border-color:#ffe100}.btn-secondary{background:hsla(0,0%,100%,.06);border-color:hsla(0,0%,100%,.3)}.btn-test{min-width:96px;background:rgba(0,218,194,.1);border-color:rgba(0,218,194,.6);color:#bcfff7}.btn-test:hover:not(:disabled){background:#00dac2;border-color:#00dac2;color:#000}.browser-overlay{position:fixed;inset:0;z-index:10002;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.browser-dialog{width:min(980px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%)}.browser-dialog::before{content:\\\"\\\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.browser-dialog{background-image:linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);background-size:22px 22px}.browser-dialog-header{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 18px;border-bottom:1px solid rgba(255,225,0,.36);background:rgba(0,0,0,.28)}.browser-dialog-header h3{margin:0;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:15px;letter-spacing:.08em}.browser-dialog-header .close-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.browser-dialog-header .close-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.browser-dialog-header .close-btn:disabled{opacity:.45;cursor:not-allowed}.browser-dialog-header .close-btn{width:34px;height:28px;padding:0;line-height:1;font-size:16px}.browser-dialog-body{padding:14px 18px 16px;overflow:auto;flex:1}.browser-dialog-body::-webkit-scrollbar{width:7px;height:7px}.browser-dialog-body::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.browser-dialog-body::-webkit-scrollbar-thumb{background:#555}.browser-dialog-body::-webkit-scrollbar-thumb:hover{background:#6f6f6f}@media(max-width: 860px){.settings-overlay{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.settings-panel{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}.settings-panel::before{width:40px}.panel-main{grid-template-columns:1fr;grid-template-rows:auto 1fr;min-height:0}.panel-nav{border-right:none;border-bottom:1px solid hsla(0,0%,100%,.16);display:flex;gap:6px;padding:8px 10px;overflow-x:auto;overflow-y:hidden}.panel-nav::-webkit-scrollbar{width:7px;height:7px}.panel-nav::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-nav::-webkit-scrollbar-thumb{background:#555}.panel-nav::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.nav-btn{flex:0 0 auto;width:150px;min-height:42px;padding:6px 10px;margin-bottom:0;grid-template-areas:\\\"idx label\\\";grid-template-columns:auto 1fr;row-gap:0;align-items:center}.panel-body{min-height:0}.nav-index{font-size:16px}.nav-label{font-size:12px}.nav-sub{display:none}.browser-overlay{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.browser-dialog{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}.emotion-layout{grid-template-columns:1fr}.emotion-preview-panel{order:-1;position:sticky;top:8px;z-index:8;margin-bottom:8px;padding:8px 10px 10px;background:rgba(0,0,0,.9)}.emotion-preview-header{margin-bottom:6px}.emotion-preview-canvas{aspect-ratio:16/9;max-height:210px}.emotion-preview-controls{margin-top:8px;gap:6px}.emotion-map-head{position:static}.emotion-preview-controls .hint{display:none}}@media(max-width: 620px){.settings-overlay{align-items:stretch;padding:0}.settings-panel{width:100vw;max-height:100dvh;border-left:none;border-right:none;box-shadow:none}.panel-header{padding:10px 12px}.header-title h3{font-size:15px;letter-spacing:.06em}.header-title p{display:none}.panel-nav{padding:6px 8px}.nav-btn{width:126px;min-height:38px;padding:5px 8px}.nav-index{font-size:14px}.nav-label{font-size:11px;letter-spacing:.04em}.close-btn{min-width:66px;height:28px;padding:0 8px;font-size:11px}.panel-footer{padding:10px 12px calc(10px + env(safe-area-inset-bottom))}.panel-body{padding:8px 10px}.form-row{flex-direction:column;gap:0}.input-with-btn{grid-template-columns:1fr}.btn{min-width:86px}.emotion-preview-panel{top:6px;padding:8px}.emotion-preview-canvas{max-height:180px}.emotion-map-head,.emotion-map-row{grid-template-columns:56px 16px minmax(0, 1fr) minmax(0, 1fr) 42px;gap:6px}.emotion-map-row{padding:8px}.emotion-map-arrow{font-size:14px}.emotion-map-preview-btn{width:38px;height:30px;font-size:12px}.browser-overlay{align-items:stretch;padding:0}.browser-dialog{width:100vw;max-height:100dvh;box-shadow:none;clip-path:none}.browser-dialog-header{padding:12px}.browser-dialog-body{padding:10px 12px 12px}}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ChatBubble.vue?vue&type=style&index=0&id=98097aea&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"266a4174\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ChatBubble.vue?vue&type=style&index=0&id=98097aea&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ChatBubble.vue?vue&type=style&index=0&id=98097aea&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","/**  */\nexport const SCRIPT_NAME = '';\n\n/** Live2D CDN  pixi-live2d-display  */\nexport const LIVE2D_CDN_BASE = 'https://cdn.jsdelivr.net/gh/guansss/pixi-live2d-display/test/assets/';\n\n/** SDK CDN  */\nexport const SDK_URLS = {\n  PIXI: 'https://cdn.jsdelivr.net/npm/pixi.js@6.5.10/dist/browser/pixi.min.js',\n  CUBISM4_CORE: 'https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js',\n  CUBISM2_CORE: 'https://cdn.jsdelivr.net/gh/dylanNew/live2d/webgl/Live2D/lib/live2d.min.js',\n  PIXI_LIVE2D_DISPLAY: 'https://cdn.jsdelivr.net/npm/pixi-live2d-display@0.4.0/dist/index.min.js',\n} as const;\n\n/**  */\nexport const RECOMMENDED_MODELS = [\n  {\n    name: 'Haru (Cubism 4)',\n    path: 'haru/haru_greeter_t03.model3.json',\n  },\n  {\n    name: 'Shizuku (Cubism 2)',\n    path: 'shizuku/shizuku.model.json',\n  },\n] as const;\n\n/**  */\nexport const COMMENT_STYLES = ['', '', '', '', ''] as const;\nexport type CommentStyle = (typeof COMMENT_STYLES)[number];\n\n/**  */\nexport const COMMENT_TRIGGER_MODES = ['user', 'ai', 'both'] as const;\nexport type CommentTriggerMode = (typeof COMMENT_TRIGGER_MODES)[number];\nexport const COMMENT_TRIGGER_MODE_OPTIONS: ReadonlyArray<{\n  value: CommentTriggerMode;\n  label: string;\n}> = [\n  { value: 'user', label: '' },\n  { value: 'ai', label: 'AI' },\n  { value: 'both', label: '' },\n];\n\n/**  COT  */\nexport const EMOTION_TAGS = [\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n] as const;\nexport type EmotionTag = (typeof EMOTION_TAGS)[number];\n\n/** API source  */\nexport const API_SOURCES = [\n  { value: 'openai', label: 'OpenAI ()' },\n  { value: 'claude', label: 'Claude' },\n  { value: 'makersuite', label: 'Google Gemini' },\n  { value: 'openrouter', label: 'OpenRouter' },\n] as const;\n\n/** Eikanya Live2D  */\nexport const EIKANYA_REPO = 'Eikanya/Live2d-model';\nexport const EIKANYA_API_BASE = 'https://api.github.com/repos/Eikanya/Live2d-model/contents/';\nexport const EIKANYA_CDN_BASE = 'https://cdn.jsdelivr.net/gh/Eikanya/Live2d-model@master/';\nexport const EIKANYA_RAW_BASE = 'https://raw.githubusercontent.com/Eikanya/Live2d-model/master/';\n\n/**  */\nexport const DEFAULTS = {\n  MODEL_PATH: 'shizuku/shizuku.model.json',\n  PET_SCALE: 0.3,\n  PET_POSITION: { x: -1, y: -1 }, // -1 \n  AUTO_MOTION_LOOP: true,\n  DOUBLE_TAP_RANDOM_MOTION_ENABLED: true,\n  GAZE_FOLLOW_MOUSE_ENABLED: true,\n  COMMENT_TRIGGER_MODE: 'ai' as CommentTriggerMode,\n  COMMENT_STYLE: '' as CommentStyle,\n  ROLEPLAY_NAME: '',\n  ROLEPLAY_IGNORE_COMMENT_STYLE: false,\n  SEND_CHARACTER_CARD_CONTENT: false,\n  AUTO_TRIGGER: true,\n  TRIGGER_INTERVAL: 3,\n  TRIGGER_PROBABILITY: 60,\n  MAX_CHAT_CONTEXT: 10,\n  USE_TAMAKO_TODAY_SPECIAL: false,\n  USE_DICE_DATABASE_REFERENCE: false,\n  PHONE_MESSAGE_AUTO_READ: true,\n  BAIBAI_PHONE_MESSAGE_AUTO_READ: false,\n  MAX_TOKENS: 150,\n  TEMPERATURE: 0.9,\n  FREQUENCY_PENALTY: 0,\n  PRESENCE_PENALTY: 0,\n  TOP_P: 1,\n  TOP_K: 0,\n  BUBBLE_DURATION: -1,\n} as const;\n","const __WEBPACK_NAMESPACE_OBJECT__ = z;","import { EMOTION_TAGS, type EmotionTag } from './constants';\n\nexport type EmotionMotionOverride = {\n  enabled: boolean;\n  group: string;\n  index: number;\n};\n\nexport type EmotionConfig = {\n  tag: EmotionTag;\n  aliases: string[];\n  ttsContext: string;\n  live2dExpression: string;\n  live2dMotion: EmotionMotionOverride;\n};\n\nfunction isRecord(value: unknown): value is Record<string, unknown> {\n  return !!value && typeof value === 'object' && !Array.isArray(value);\n}\n\nconst EMOTION_TAG_SET = new Set<string>(EMOTION_TAGS as unknown as string[]);\n\nfunction asEmotionTag(value: unknown): EmotionTag | null {\n  const s = String(value || '').trim();\n  if (!s) return null;\n  return EMOTION_TAG_SET.has(s) ? (s as EmotionTag) : null;\n}\n\nconst DEFAULT_ALIASES: Record<EmotionTag, string[]> = {\n  : ['', 'normal', 'default', 'neutral', 'idle', 'base'],\n  : ['', '', 'smile', 'happy', 'joy', 'glad'],\n  : ['', 'angry', 'mad', 'rage'],\n  : ['', 'sad', 'cry', 'sorrow', 'upset'],\n  : ['', 'surprised', 'shock', 'amazed', 'wow'],\n  : ['', 'smirk', 'mock', 'sneer', 'tease', 'sarcastic'],\n  : ['', 'shy', 'blush', 'embarrassed', 'bashful'],\n  : ['', 'think', 'ponder', 'confused', 'wonder', 'curious'],\n  : ['', 'laugh', 'lol', 'haha', 'giggle', 'rofl'],\n  : ['', 'wink', 'playful', 'silly', 'mischievous', 'fun'],\n};\n\nfunction dedupAliases(aliases: string[]): string[] {\n  const out: string[] = [];\n  const seen = new Set<string>();\n  for (const raw of Array.isArray(aliases) ? aliases : []) {\n    const trimmed = String(raw || '').trim();\n    if (!trimmed) continue;\n    const key = trimmed.toLowerCase();\n    if (seen.has(key)) continue;\n    seen.add(key);\n    out.push(trimmed);\n  }\n  return out;\n}\n\nexport function parseAliasesText(input: unknown): string[] {\n  const text = String(input || '');\n  const parts = text\n    .split(/[,\\n\\r]+/g)\n    .map((s) => s.trim())\n    .filter(Boolean);\n  return dedupAliases(parts);\n}\n\nexport function createDefaultEmotionConfigs(): EmotionConfig[] {\n  return EMOTION_TAGS.map((tag) => ({\n    tag,\n    aliases: [...(DEFAULT_ALIASES[tag] ?? [])],\n    ttsContext: '',\n    live2dExpression: '',\n    live2dMotion: { enabled: true, group: '', index: 0 },\n  }));\n}\n\nexport function normalizeEmotionConfigs(raw: unknown): EmotionConfig[] {\n  const byTag = new Map<EmotionTag, EmotionConfig>();\n\n  for (const item of Array.isArray(raw) ? raw : []) {\n    if (!isRecord(item)) continue;\n    const tag = asEmotionTag(item.tag);\n    if (!tag) continue;\n    if (byTag.has(tag)) continue;\n\n    const live2dMotionRaw = isRecord(item.live2dMotion) ? item.live2dMotion : {};\n    const enabled = (live2dMotionRaw.enabled as unknown) !== false;\n    const group = String(live2dMotionRaw.group || '').trim();\n    const indexRaw = Number(live2dMotionRaw.index);\n    const index = Number.isFinite(indexRaw) ? Math.max(0, Math.floor(indexRaw)) : 0;\n\n    const cfg: EmotionConfig = {\n      tag,\n      aliases: dedupAliases(\n        Array.isArray(item.aliases)\n          ? item.aliases.map((v) => String(v || '').trim()).filter(Boolean)\n          : [],\n      ),\n      ttsContext: String(item.ttsContext || '').trim(),\n      live2dExpression: String(item.live2dExpression || '').trim(),\n      live2dMotion: { enabled, group, index },\n    };\n\n    byTag.set(tag, cfg);\n  }\n\n  const defaults = createDefaultEmotionConfigs();\n  for (const def of defaults) {\n    if (!byTag.has(def.tag)) byTag.set(def.tag, def);\n  }\n\n  return EMOTION_TAGS.map((tag) => byTag.get(tag)!).map((cfg) => ({\n    tag: cfg.tag,\n    aliases: dedupAliases(cfg.aliases),\n    ttsContext: String(cfg.ttsContext || '').trim(),\n    live2dExpression: String(cfg.live2dExpression || '').trim(),\n    live2dMotion: {\n      enabled: cfg.live2dMotion?.enabled !== false,\n      group: String(cfg.live2dMotion?.group || '').trim(),\n      index: Number.isFinite(cfg.live2dMotion?.index) ? Math.max(0, Math.floor(cfg.live2dMotion.index)) : 0,\n    },\n  }));\n}\n\nexport function getEmotionConfigByTag(tag: EmotionTag, configs: unknown): EmotionConfig | null {\n  for (const cfg of Array.isArray(configs) ? (configs as EmotionConfig[]) : []) {\n    if (cfg?.tag === tag) return cfg;\n  }\n  return null;\n}\n\nexport function resolveEmotionTag(rawTag: unknown, configs: unknown): EmotionTag | null {\n  const s = String(rawTag || '').trim();\n  if (!s) return null;\n  const direct = asEmotionTag(s);\n  if (direct) return direct;\n\n  const needle = s.toLowerCase();\n  for (const cfg of Array.isArray(configs) ? (configs as EmotionConfig[]) : []) {\n    const aliases = Array.isArray(cfg?.aliases) ? cfg.aliases : [];\n    for (const alias of aliases) {\n      if (String(alias || '').trim().toLowerCase() === needle) {\n        const tag = asEmotionTag(cfg.tag);\n        if (tag) return tag;\n      }\n    }\n  }\n  return null;\n}\n\n","import { SCRIPT_NAME } from '../core/constants';\n\n/**\n *  DOM  body\n */\nexport function createContainer(id: string): JQuery<HTMLElement> {\n  // \n  $(`#${id}`).remove();\n  return $(`<div id=\"${id}\">`).appendTo('body');\n}\n\n/**\n *  ID \n */\nexport function removeContainer(id: string): void {\n  $(`#${id}`).remove();\n}\n\nfunction getTargetConsole(): Console {\n  try {\n    const top = window.parent ?? window;\n    if (top.console) return top.console;\n  } catch {\n    // ignore\n  }\n  return console;\n}\n\n/**\n * \n */\nexport function log(...args: unknown[]): void {\n  getTargetConsole().log(`[${SCRIPT_NAME}]`, ...args);\n}\n\nexport function warn(...args: unknown[]): void {\n  getTargetConsole().warn(`[${SCRIPT_NAME}]`, ...args);\n}\n\nexport function error(...args: unknown[]): void {\n  getTargetConsole().error(`[${SCRIPT_NAME}]`, ...args);\n}\n","import { klona } from 'klona';\r\nimport { defineStore } from 'pinia';\r\nimport { ref, watchEffect } from 'vue';\r\nimport { z } from 'zod';\r\nimport { COMMENT_STYLES, COMMENT_TRIGGER_MODES, DEFAULTS, EMOTION_TAGS } from './constants';\r\nimport { normalizeEmotionConfigs } from './emotion';\r\nimport { error as logError, warn } from '../utils/dom';\r\n\r\nfunction isRecord(value: unknown): value is Record<string, any> {\r\n  return !!value && typeof value === 'object' && !Array.isArray(value);\r\n}\r\n\r\nfunction deleteAtPath(target: any, path: (string | number)[]): void {\r\n  if (!target || typeof target !== 'object') return;\r\n  if (path.length === 0) return;\r\n\r\n  let current: any = target;\r\n  for (let i = 0; i < path.length - 1; i++) {\r\n    const key = path[i];\r\n    if (!current || typeof current !== 'object') return;\r\n    current = current[key as any];\r\n  }\r\n\r\n  const last = path[path.length - 1];\r\n  if (!current || typeof current !== 'object') return;\r\n  if (Array.isArray(current) && typeof last === 'number') {\r\n    current[last] = undefined;\r\n    return;\r\n  }\r\n  delete current[last as any];\r\n}\r\n\r\nfunction parseSettings(raw: unknown): Settings {\r\n  const rawObject = isRecord(raw) ? raw : {};\r\n  const first = SettingsSchema.safeParse(rawObject);\r\n  if (first.success) return first.data;\r\n\r\n  const cleaned = klona(rawObject);\r\n  for (const issue of first.error.issues) {\r\n    deleteAtPath(cleaned, issue.path);\r\n  }\r\n\r\n  const second = SettingsSchema.safeParse(cleaned);\r\n  if (second.success) {\r\n    warn('', first.error.issues);\r\n    return second.data;\r\n  }\r\n\r\n  logError('', first.error);\r\n  return SettingsSchema.parse({});\r\n}\r\n\r\n/**  Schema */\r\nconst SettingsSchema = z\r\n  .object({\r\n    // API \r\n    apiMode: z.enum(['custom', 'tavern']).default('tavern'),\r\n    apiConfig: z\r\n      .object({\r\n        url: z.string().default(''),\r\n        apiKey: z.string().default(''),\r\n        model: z.string().default('gpt-4o-mini'),\r\n        source: z.string().default('openai'),\r\n        max_tokens: z.number().min(1).max(4096).default(DEFAULTS.MAX_TOKENS),\r\n        temperature: z.number().min(0).max(2).default(DEFAULTS.TEMPERATURE),\r\n        frequency_penalty: z.number().min(-2).max(2).default(DEFAULTS.FREQUENCY_PENALTY),\r\n        presence_penalty: z.number().min(-2).max(2).default(DEFAULTS.PRESENCE_PENALTY),\r\n        top_p: z.number().min(0).max(1).default(DEFAULTS.TOP_P),\r\n        top_k: z.number().min(0).max(500).default(DEFAULTS.TOP_K),\r\n        usePresetSampling: z.boolean().default(false),\r\n        sendWorldInfo: z.boolean().default(false),\r\n      })\r\n      .default({}),\r\n\r\n    // Live2D \r\n    modelPath: z.string().default(DEFAULTS.MODEL_PATH),\r\n    useCdn: z.boolean().default(true),\r\n    petPosition: z\r\n      .object({\r\n        x: z.number().default(DEFAULTS.PET_POSITION.x),\r\n        y: z.number().default(DEFAULTS.PET_POSITION.y),\r\n      })\r\n      .default({}),\r\n    petScale: z.number().min(0.1).max(3).default(DEFAULTS.PET_SCALE),\r\n    autoMotionLoop: z.boolean().default(DEFAULTS.AUTO_MOTION_LOOP),\r\n    doubleTapRandomMotionEnabled: z.boolean().default(DEFAULTS.DOUBLE_TAP_RANDOM_MOTION_ENABLED),\r\n    gazeFollowMouseEnabled: z.boolean().default(DEFAULTS.GAZE_FOLLOW_MOUSE_ENABLED),\r\n\r\n    // \r\n    commentStyle: z.enum(COMMENT_STYLES).default(DEFAULTS.COMMENT_STYLE),\r\n    commentTriggerMode: z.enum(COMMENT_TRIGGER_MODES).default(DEFAULTS.COMMENT_TRIGGER_MODE),\r\n    customPrompt: z.string().default(''),\r\n    roleplayName: z.string().default(DEFAULTS.ROLEPLAY_NAME),\r\n    roleplayIgnoreCommentStyle: z.boolean().default(DEFAULTS.ROLEPLAY_IGNORE_COMMENT_STYLE),\r\n    sendCharacterCardContent: z.boolean().default(DEFAULTS.SEND_CHARACTER_CARD_CONTENT),\r\n    autoTrigger: z.boolean().default(DEFAULTS.AUTO_TRIGGER),\r\n    triggerInterval: z.number().min(1).max(100).default(DEFAULTS.TRIGGER_INTERVAL),\r\n    triggerProbability: z.number().min(0).max(100).default(DEFAULTS.TRIGGER_PROBABILITY),\r\n    maxChatContext: z.number().min(1).max(50).default(DEFAULTS.MAX_CHAT_CONTEXT),\r\n    bubbleDuration: z.number().min(-1).max(600000).default(DEFAULTS.BUBBLE_DURATION),\r\n    useTamakoTodaySpecial: z.boolean().default(DEFAULTS.USE_TAMAKO_TODAY_SPECIAL),\r\n    useDiceDatabaseReference: z.boolean().default(DEFAULTS.USE_DICE_DATABASE_REFERENCE),\r\n    diceReferenceVisibleSheets: z.array(z.string()).default([]),\r\n\r\n    //  COT \r\n    emotionCotEnabled: z.boolean().default(true),\r\n    emotionCotStripFromText: z.boolean().default(true),\r\n    emotionConfigs: z\r\n      .array(\r\n        z\r\n          .object({\r\n            tag: z.enum(EMOTION_TAGS).default(''),\r\n            aliases: z.array(z.string()).default([]),\r\n            ttsContext: z.string().default(''),\r\n            live2dExpression: z.string().default(''),\r\n            live2dMotion: z\r\n              .object({\r\n                enabled: z.boolean().default(true),\r\n                group: z.string().default(''),\r\n                index: z.number().min(0).max(999).default(0),\r\n              })\r\n              .default({}),\r\n          })\r\n          .default({}),\r\n      )\r\n      .default([]),\r\n    // TTS provider\r\n    ttsProvider: z.enum(['littlewhitebox', 'gpt_sovits_v2', 'edge_tts_direct']).default('littlewhitebox'),\r\n    ttsAutoPlay: z.boolean().default(true),\r\n    phoneMessageAutoRead: z.boolean().default(DEFAULTS.PHONE_MESSAGE_AUTO_READ),\r\n    baibaiPhoneMessageAutoRead: z.boolean().default(DEFAULTS.BAIBAI_PHONE_MESSAGE_AUTO_READ),\r\n    ttsDefaultSpeaker: z.string().default(''),\r\n    lipSyncManualParamsEnabled: z.boolean().default(false),\r\n    lipSyncManualParamIds: z.array(z.string()).default([]),\r\n    gptSoVits: z\r\n      .object({\r\n        apiUrl: z.string().default('http://127.0.0.1:9880'),\r\n        endpoint: z.string().default('/tts'),\r\n        useCorsProxy: z.boolean().default(true),\r\n        mediaType: z.enum(['wav', 'ogg', 'raw']).default('wav'),\r\n        streamingMode: z.boolean().default(true),\r\n        textLang: z.string().default('auto'),\r\n        textSplitMethod: z.string().default('cut5'),\r\n        speedFactor: z.number().min(0.1).max(3).default(1),\r\n        strictWeightSwitch: z.boolean().default(false),\r\n        probeOnAudioError: z.boolean().default(false),\r\n        modelSwitchMode: z.enum(['none', 'set_model', 'set_weights']).default('set_weights'),\r\n        setModelEndpoint: z.string().default('/set_model'),\r\n        importPathPrefix: z.string().default(''),\r\n        voices: z\r\n          .array(\r\n            z\r\n              .object({\r\n                name: z.string().default(''),\r\n                desc: z.string().default(''),\r\n                refAudioPath: z.string().default(''),\r\n                promptText: z.string().default(''),\r\n                promptLang: z.string().default(''),\r\n                textLang: z.string().default(''),\r\n                gptWeightsPath: z.string().default(''),\r\n                sovitsWeightsPath: z.string().default(''),\r\n                modelSwitchMode: z.enum(['none', 'set_model', 'set_weights']).default('set_weights'),\r\n                setModelEndpoint: z.string().default('/set_model'),\r\n              })\r\n              .default({}),\r\n          )\r\n          .default([]),\r\n      })\r\n      .default({}),\r\n  })\r\n  .default({});\r\n\r\nexport type Settings = z.infer<typeof SettingsSchema>;\r\n\r\n/** Pinia  Store */\r\nexport const useSettingsStore = defineStore('desktop-pet-settings', () => {\r\n  const raw = getVariables({ type: 'script', script_id: getScriptId() });\r\n  const parsed = parseSettings(raw);\r\n\r\n  //  Eikanya CDN  CDN\r\n  if (\r\n    parsed.modelPath.includes('live2d-widget-model/') ||\r\n    parsed.modelPath.includes('Live2D/Samples/')\r\n  ) {\r\n    parsed.modelPath = DEFAULTS.MODEL_PATH;\r\n  }\r\n\r\n  // jsDelivr / raw  Live2DManager \r\n  // \r\n  parsed.emotionConfigs = normalizeEmotionConfigs(parsed.emotionConfigs);\r\n\r\n  // > 600 \r\n  const rawBubbleDuration = Number((parsed as any).bubbleDuration);\r\n  if (Number.isFinite(rawBubbleDuration)) {\r\n    const bubbleDurationSeconds = rawBubbleDuration > 600 ? rawBubbleDuration / 1000 : rawBubbleDuration;\r\n    (parsed as any).bubbleDuration = Math.round(Math.max(-1, Math.min(600, bubbleDurationSeconds)));\r\n  } else {\r\n    (parsed as any).bubbleDuration = DEFAULTS.BUBBLE_DURATION;\r\n  }\r\n\r\n  const settings = ref<Settings>(parsed);\r\n\r\n  // \r\n  watchEffect(() => {\r\n    replaceVariables(klona(settings.value), { type: 'script', script_id: getScriptId() });\r\n  });\r\n\r\n  /**  */\r\n  function updateSettings(partial: Partial<Settings>) {\r\n    settings.value = SettingsSchema.parse({ ...klona(settings.value), ...partial });\r\n    settings.value.emotionConfigs = normalizeEmotionConfigs(settings.value.emotionConfigs);\r\n  }\r\n\r\n  /**  */\r\n  function resetSettings() {\r\n    const next = SettingsSchema.parse({});\r\n    next.emotionConfigs = normalizeEmotionConfigs(next.emotionConfigs);\r\n    settings.value = next;\r\n  }\r\n\r\n  return { settings, updateSettings, resetSettings };\r\n});\r\n\r\n\r\n","import type { TTSSpeakerVoice } from './tts-config';\n\nconst EDGE_BASE_URL = 'speech.platform.bing.com/consumer/speech/synthesize/readaloud';\nconst TRUSTED_CLIENT_TOKEN = '6A5AA1D4EAFF4E9FB37E23D68491D6F4';\nconst CHROMIUM_FULL_VERSION = '143.0.3537.57';\n\nconst WSS_URL = `wss://${EDGE_BASE_URL}/edge/v1?TrustedClientToken=${TRUSTED_CLIENT_TOKEN}`;\nconst VOICE_LIST_URL = `https://${EDGE_BASE_URL}/voices/list?trustedclienttoken=${TRUSTED_CLIENT_TOKEN}`;\nconst SEC_MS_GEC_VERSION = `1-${CHROMIUM_FULL_VERSION}`;\n\nconst WIN_EPOCH_SECONDS = 11644473600;\nconst SECONDS_TO_NANOSECONDS = 1e9;\n\nconst DEFAULT_RATE = '+0%';\nconst DEFAULT_VOLUME = '+0%';\nconst DEFAULT_PITCH = '+0Hz';\n\nlet clockSkewSeconds = 0;\n\ntype EdgeVoiceApiItem = {\n  ShortName?: string;\n  FriendlyName?: string;\n  Locale?: string;\n  Gender?: string;\n};\n\nexport type EdgeDirectSynthesisOptions = {\n  signal?: AbortSignal;\n  onSocket?: (socket: WebSocket | null) => void;\n  timeoutMs?: number;\n};\n\ntype EdgeTimestampMode = 'utc_string' | 'iso_compact';\n\ntype EdgeSecurityParams = {\n  secMsGec: string;\n  secMsGecVersion: string;\n};\n\ntype SecurityBuildResult = {\n  security: EdgeSecurityParams | null;\n  error: string;\n};\n\nconst EDGE_FALLBACK_SHORT_VOICES: ReadonlyArray<{ shortName: string; locale: string; gender: string }> = [\n  { shortName: 'zh-CN-XiaoxiaoNeural', locale: 'zh-CN', gender: 'Female' },\n  { shortName: 'zh-CN-YunxiNeural', locale: 'zh-CN', gender: 'Male' },\n  { shortName: 'zh-CN-YunyangNeural', locale: 'zh-CN', gender: 'Male' },\n  { shortName: 'zh-CN-XiaoyiNeural', locale: 'zh-CN', gender: 'Female' },\n  { shortName: 'en-US-JennyNeural', locale: 'en-US', gender: 'Female' },\n  { shortName: 'en-US-AriaNeural', locale: 'en-US', gender: 'Female' },\n  { shortName: 'en-US-GuyNeural', locale: 'en-US', gender: 'Male' },\n  { shortName: 'ja-JP-NanamiNeural', locale: 'ja-JP', gender: 'Female' },\n  { shortName: 'ja-JP-KeitaNeural', locale: 'ja-JP', gender: 'Male' },\n];\n\nfunction toAbortError(message = 'Aborted'): Error {\n  try {\n    return new DOMException(message, 'AbortError');\n  } catch {\n    const err = new Error(message);\n    (err as any).name = 'AbortError';\n    return err;\n  }\n}\n\nfunction buildConnectionId(): string {\n  const bytes = new Uint8Array(16);\n  if (globalThis.crypto?.getRandomValues) {\n    globalThis.crypto.getRandomValues(bytes);\n  } else {\n    for (let i = 0; i < bytes.length; i++) {\n      bytes[i] = Math.floor(Math.random() * 256);\n    }\n  }\n  bytes[6] = (bytes[6] & 0x0f) | 0x40;\n  bytes[8] = (bytes[8] & 0x3f) | 0x80;\n  return Array.from(bytes, b => b.toString(16).padStart(2, '0')).join('');\n}\n\nfunction dateToString(mode: EdgeTimestampMode = 'utc_string'): string {\n  const now = new Date();\n  if (mode === 'iso_compact') {\n    return now.toISOString().replace(/[-:.]/g, '').slice(0, -1);\n  }\n  return now.toUTCString().replace('GMT', 'GMT+0000 (Coordinated Universal Time)');\n}\n\nfunction removeIncompatibleCharacters(text: string): string {\n  let out = '';\n  for (let i = 0; i < text.length; i++) {\n    const code = text.charCodeAt(i);\n    const isControl =\n      (code >= 0x00 && code <= 0x08) || code === 0x0b || code === 0x0c || (code >= 0x0e && code <= 0x1f);\n    out += isControl ? ' ' : text[i];\n  }\n  return out;\n}\n\nexport function escapeXml(text: string): string {\n  return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&apos;');\n}\n\nfunction getVoiceName(voice: TTSSpeakerVoice | string): string {\n  if (typeof voice === 'string') return voice.trim();\n  return String(voice.value || voice.name || '').trim();\n}\n\nexport function buildSsml(text: string, voice: TTSSpeakerVoice | string): string {\n  const voiceName = getVoiceName(voice);\n  const escapedText = escapeXml(removeIncompatibleCharacters(String(text || '')));\n  return (\n    `<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xml:lang='en-US'>` +\n    `<voice name='${voiceName}'>` +\n    `<prosody pitch='${DEFAULT_PITCH}' rate='${DEFAULT_RATE}' volume='${DEFAULT_VOLUME}'>${escapedText}</prosody>` +\n    `</voice>` +\n    `</speak>`\n  );\n}\n\nfunction buildSpeechConfigMessage(timestamp: string): string {\n  return (\n    `X-Timestamp:${timestamp}\\r\\n` +\n    `Content-Type:application/json; charset=utf-8\\r\\n` +\n    `Path:speech.config\\r\\n\\r\\n` +\n    `{\"context\":{\"synthesis\":{\"audio\":{\"metadataoptions\":{\"sentenceBoundaryEnabled\":\"false\",\"wordBoundaryEnabled\":\"true\"},\"outputFormat\":\"audio-24khz-48kbitrate-mono-mp3\"}}}}\\r\\n`\n  );\n}\n\nfunction buildSsmlMessage(requestId: string, timestamp: string, ssml: string): string {\n  return (\n    `X-RequestId:${requestId}\\r\\n` +\n    `Content-Type:application/ssml+xml\\r\\n` +\n    `X-Timestamp:${timestamp}Z\\r\\n` +\n    `Path:ssml\\r\\n\\r\\n` +\n    `${ssml}`\n  );\n}\n\nfunction parseHeadersFromTextMessage(textMessage: string): Record<string, string> {\n  const headerEndIndex = textMessage.indexOf('\\r\\n\\r\\n');\n  const headerText = headerEndIndex >= 0 ? textMessage.slice(0, headerEndIndex) : textMessage;\n  const headers: Record<string, string> = {};\n  for (const line of headerText.split('\\r\\n')) {\n    const idx = line.indexOf(':');\n    if (idx <= 0) continue;\n    headers[line.slice(0, idx)] = line.slice(idx + 1).trim();\n  }\n  return headers;\n}\n\nfunction parseHeadersAndDataFromBinaryMessage(binary: Uint8Array): { headers: Record<string, string>; payload: Uint8Array } {\n  if (binary.length < 2) return { headers: {}, payload: new Uint8Array(0) };\n  const headerLength = (binary[0] << 8) | binary[1];\n  if (headerLength <= 0 || headerLength + 2 > binary.length) {\n    return { headers: {}, payload: binary.slice(2) };\n  }\n\n  const headers: Record<string, string> = {};\n  const headerBytes = binary.slice(2, headerLength + 2);\n  const headerText = new TextDecoder().decode(headerBytes);\n  for (const line of headerText.split('\\r\\n')) {\n    const idx = line.indexOf(':');\n    if (idx <= 0) continue;\n    headers[line.slice(0, idx)] = line.slice(idx + 1).trim();\n  }\n\n  return { headers, payload: binary.slice(headerLength + 2) };\n}\n\nfunction concatChunks(chunks: Uint8Array[]): Uint8Array {\n  if (chunks.length === 0) return new Uint8Array(0);\n  if (chunks.length === 1) return chunks[0];\n  const totalLength = chunks.reduce((sum, chunk) => sum + chunk.length, 0);\n  const merged = new Uint8Array(totalLength);\n  let offset = 0;\n  for (const chunk of chunks) {\n    merged.set(chunk, offset);\n    offset += chunk.length;\n  }\n  return merged;\n}\n\nasync function toSha256HexUpper(text: string): Promise<string> {\n  const bytes = new TextEncoder().encode(text);\n  const subtle = globalThis.crypto?.subtle;\n  if (subtle?.digest) {\n    try {\n      const digest = await subtle.digest('SHA-256', bytes);\n      return Array.from(new Uint8Array(digest))\n        .map(b => b.toString(16).padStart(2, '0'))\n        .join('')\n        .toUpperCase();\n    } catch {\n      // fallback to pure-js implementation\n    }\n  }\n  return sha256HexUpperFallback(bytes);\n}\n\nfunction rotateRight(value: number, bits: number): number {\n  return ((value >>> bits) | (value << (32 - bits))) >>> 0;\n}\n\nfunction sha256HexUpperFallback(message: Uint8Array): string {\n  const K = new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2,\n  ]);\n\n  const H = new Uint32Array([\n    0x6a09e667,\n    0xbb67ae85,\n    0x3c6ef372,\n    0xa54ff53a,\n    0x510e527f,\n    0x9b05688c,\n    0x1f83d9ab,\n    0x5be0cd19,\n  ]);\n\n  const withOneByte = message.length + 1;\n  const paddedLength = Math.ceil((withOneByte + 8) / 64) * 64;\n  const padded = new Uint8Array(paddedLength);\n  padded.set(message);\n  padded[message.length] = 0x80;\n\n  const bitLength = message.length * 8;\n  const high = Math.floor(bitLength / 0x100000000);\n  const low = bitLength >>> 0;\n  padded[paddedLength - 8] = (high >>> 24) & 0xff;\n  padded[paddedLength - 7] = (high >>> 16) & 0xff;\n  padded[paddedLength - 6] = (high >>> 8) & 0xff;\n  padded[paddedLength - 5] = high & 0xff;\n  padded[paddedLength - 4] = (low >>> 24) & 0xff;\n  padded[paddedLength - 3] = (low >>> 16) & 0xff;\n  padded[paddedLength - 2] = (low >>> 8) & 0xff;\n  padded[paddedLength - 1] = low & 0xff;\n\n  const w = new Uint32Array(64);\n  for (let offset = 0; offset < padded.length; offset += 64) {\n    for (let i = 0; i < 16; i++) {\n      const j = offset + i * 4;\n      w[i] = ((padded[j] << 24) | (padded[j + 1] << 16) | (padded[j + 2] << 8) | padded[j + 3]) >>> 0;\n    }\n\n    for (let i = 16; i < 64; i++) {\n      const s0 = rotateRight(w[i - 15], 7) ^ rotateRight(w[i - 15], 18) ^ (w[i - 15] >>> 3);\n      const s1 = rotateRight(w[i - 2], 17) ^ rotateRight(w[i - 2], 19) ^ (w[i - 2] >>> 10);\n      w[i] = (w[i - 16] + s0 + w[i - 7] + s1) >>> 0;\n    }\n\n    let a = H[0];\n    let b = H[1];\n    let c = H[2];\n    let d = H[3];\n    let e = H[4];\n    let f = H[5];\n    let g = H[6];\n    let h = H[7];\n\n    for (let i = 0; i < 64; i++) {\n      const S1 = rotateRight(e, 6) ^ rotateRight(e, 11) ^ rotateRight(e, 25);\n      const ch = (e & f) ^ (~e & g);\n      const temp1 = (h + S1 + ch + K[i] + w[i]) >>> 0;\n      const S0 = rotateRight(a, 2) ^ rotateRight(a, 13) ^ rotateRight(a, 22);\n      const maj = (a & b) ^ (a & c) ^ (b & c);\n      const temp2 = (S0 + maj) >>> 0;\n\n      h = g;\n      g = f;\n      f = e;\n      e = (d + temp1) >>> 0;\n      d = c;\n      c = b;\n      b = a;\n      a = (temp1 + temp2) >>> 0;\n    }\n\n    H[0] = (H[0] + a) >>> 0;\n    H[1] = (H[1] + b) >>> 0;\n    H[2] = (H[2] + c) >>> 0;\n    H[3] = (H[3] + d) >>> 0;\n    H[4] = (H[4] + e) >>> 0;\n    H[5] = (H[5] + f) >>> 0;\n    H[6] = (H[6] + g) >>> 0;\n    H[7] = (H[7] + h) >>> 0;\n  }\n\n  return Array.from(H)\n    .map(word => word.toString(16).padStart(8, '0'))\n    .join('')\n    .toUpperCase();\n}\n\nasync function buildSecurityParamsWithReason(): Promise<SecurityBuildResult> {\n  try {\n    let ticks = Date.now() / 1000 + clockSkewSeconds;\n    ticks += WIN_EPOCH_SECONDS;\n    ticks -= ticks % 300;\n    ticks *= SECONDS_TO_NANOSECONDS / 100;\n    const secMsGec = await toSha256HexUpper(`${ticks.toFixed(0)}${TRUSTED_CLIENT_TOKEN}`);\n    return {\n      security: { secMsGec, secMsGecVersion: SEC_MS_GEC_VERSION },\n      error: '',\n    };\n  } catch (e) {\n    return {\n      security: null,\n      error: e instanceof Error ? e.message : String(e),\n    };\n  }\n}\n\nexport async function buildSecurityParams(): Promise<EdgeSecurityParams | null> {\n  const { security } = await buildSecurityParamsWithReason();\n  return security;\n}\n\nfunction mapEdgeVoice(item: EdgeVoiceApiItem): TTSSpeakerVoice | null {\n  const shortName = String(item.ShortName || '').trim();\n  if (!shortName) return null;\n\n  const locale = String(item.Locale || '').trim();\n  const gender = String(item.Gender || '').trim();\n  const friendlyName = String(item.FriendlyName || '').trim();\n  const desc = [friendlyName, locale, gender].filter(Boolean).join(' | ');\n\n  return {\n    name: shortName,\n    value: shortName,\n    source: 'edge_tts_direct',\n    resourceId: null,\n    desc: desc || 'EdgeTTS Direct',\n  };\n}\n\nfunction dedupeVoices(list: TTSSpeakerVoice[]): TTSSpeakerVoice[] {\n  const seen = new Set<string>();\n  const result: TTSSpeakerVoice[] = [];\n  for (const voice of list) {\n    const key = String(voice.value || voice.name || '').trim().toLowerCase();\n    if (!key || seen.has(key)) continue;\n    seen.add(key);\n    result.push(voice);\n  }\n  return result.sort((a, b) => a.name.localeCompare(b.name));\n}\n\nfunction parseServerDateHeader(response: Response): number | null {\n  const date = response.headers.get('date') || response.headers.get('Date');\n  if (!date) return null;\n  const ts = new Date(date).getTime();\n  if (!Number.isFinite(ts)) return null;\n  return ts / 1000;\n}\n\nasync function fetchVoicesOnce(url: string): Promise<TTSSpeakerVoice[]> {\n  const response = await fetch(url, {\n    headers: {\n      Accept: '*/*',\n      'Accept-Language': 'en-US,en;q=0.9',\n    },\n  });\n\n  const serverDate = parseServerDateHeader(response);\n  if (serverDate !== null) {\n    const clientDate = Date.now() / 1000 + clockSkewSeconds;\n    clockSkewSeconds += serverDate - clientDate;\n  }\n\n  if (!response.ok) {\n    throw new Error(`EdgeTTS voices request failed (HTTP ${response.status})`);\n  }\n\n  const payload = (await response.json()) as EdgeVoiceApiItem[];\n  if (!Array.isArray(payload)) {\n    throw new Error('EdgeTTS voices response is not an array');\n  }\n\n  const mapped = payload.map(mapEdgeVoice).filter(Boolean) as TTSSpeakerVoice[];\n  return dedupeVoices(mapped);\n}\n\nexport async function fetchEdgeVoices(): Promise<TTSSpeakerVoice[]> {\n  const securityResult = await buildSecurityParamsWithReason();\n  const security = securityResult.security;\n  const urls: string[] = [];\n\n  if (security) {\n    urls.push(\n      `${VOICE_LIST_URL}&Sec-MS-GEC=${encodeURIComponent(security.secMsGec)}&Sec-MS-GEC-Version=${encodeURIComponent(security.secMsGecVersion)}`,\n    );\n  }\n  urls.push(VOICE_LIST_URL);\n\n  let lastError: unknown = null;\n  for (const url of urls) {\n    try {\n      const voices = await fetchVoicesOnce(url);\n      if (voices.length > 0) return voices;\n      lastError = new Error('EdgeTTS voices response is empty');\n    } catch (e) {\n      lastError = e;\n    }\n  }\n\n  if (!security && securityResult.error) {\n    const base = lastError instanceof Error ? lastError.message : String(lastError || 'unknown');\n    throw new Error(`EdgeTTS voices request failed. security-unavailable: ${securityResult.error}; last: ${base}`);\n  }\n  throw lastError instanceof Error ? lastError : new Error('EdgeTTS voices request failed');\n}\n\nexport function getEdgeFallbackVoices(): TTSSpeakerVoice[] {\n  return EDGE_FALLBACK_SHORT_VOICES.map(item => ({\n    name: item.shortName,\n    value: item.shortName,\n    source: 'edge_tts_direct',\n    resourceId: null,\n    desc: `${item.locale} | ${item.gender}`,\n  }));\n}\n\nasync function synthesizeWithSocketUrl(\n  socketUrl: string,\n  text: string,\n  voiceName: string,\n  options: EdgeDirectSynthesisOptions,\n  timestampMode: EdgeTimestampMode,\n  attemptLabel: string,\n): Promise<Blob> {\n  const timeoutMs = Number.isFinite(options.timeoutMs) ? Math.max(3000, Number(options.timeoutMs)) : 25000;\n\n  return new Promise<Blob>((resolve, reject) => {\n    let done = false;\n    let ws: WebSocket | null = null;\n    let timeoutId: number | null = null;\n    const chunks: Uint8Array[] = [];\n    let sawSocketError = false;\n    let sawOpen = false;\n    let closeCode = 0;\n    let closeReason = '';\n    let closeWasClean = false;\n\n    const finish = (fn: () => void) => {\n      if (done) return;\n      done = true;\n      if (timeoutId !== null) window.clearTimeout(timeoutId);\n      if (ws) {\n        ws.onopen = null;\n        ws.onmessage = null;\n        ws.onerror = null;\n        ws.onclose = null;\n      }\n      options.onSocket?.(null);\n      if (options.signal) {\n        options.signal.removeEventListener('abort', onAbort);\n      }\n      fn();\n    };\n\n    const fail = (error: unknown) => {\n      finish(() => reject(error instanceof Error ? error : new Error(String(error))));\n    };\n\n    const onAbort = () => {\n      try {\n        ws?.close(1000, 'abort');\n      } catch {\n        // ignore\n      }\n      fail(toAbortError('EdgeTTS direct synthesis aborted'));\n    };\n\n    if (options.signal?.aborted) {\n      fail(toAbortError('EdgeTTS direct synthesis aborted'));\n      return;\n    }\n\n    if (options.signal) {\n      options.signal.addEventListener('abort', onAbort, { once: true });\n    }\n\n    ws = new WebSocket(socketUrl);\n    ws.binaryType = 'arraybuffer';\n    options.onSocket?.(ws);\n\n    timeoutId = window.setTimeout(() => {\n      try {\n        ws?.close(1013, 'timeout');\n      } catch {\n        // ignore\n      }\n      fail(new Error(`EdgeTTS direct websocket timeout (${attemptLabel})`));\n    }, timeoutMs);\n\n    ws.onopen = () => {\n      sawOpen = true;\n      const timestamp = dateToString(timestampMode);\n      ws?.send(buildSpeechConfigMessage(timestamp));\n      ws?.send(buildSsmlMessage(buildConnectionId(), timestamp, buildSsml(text, voiceName)));\n    };\n\n    ws.onmessage = event => {\n      if (done) return;\n\n      if (typeof event.data === 'string') {\n        const headers = parseHeadersFromTextMessage(event.data);\n        const path = String(headers.Path || headers.path || '').toLowerCase();\n        if (path === 'turn.end') {\n          try {\n            ws?.close(1000, 'turn.end');\n          } catch {\n            // ignore\n          }\n        }\n        return;\n      }\n\n      const handleBinary = async () => {\n        const data = event.data;\n        let bytes: Uint8Array | null = null;\n\n        if (data instanceof ArrayBuffer) {\n          bytes = new Uint8Array(data);\n        } else if (ArrayBuffer.isView(data)) {\n          bytes = new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n        } else if (data instanceof Blob) {\n          bytes = new Uint8Array(await data.arrayBuffer());\n        }\n        if (!bytes || bytes.length < 2) return;\n\n        const { headers, payload } = parseHeadersAndDataFromBinaryMessage(bytes);\n        const path = String(headers.Path || headers.path || '').toLowerCase();\n        if (path !== 'audio') return;\n\n        const contentType = String(headers['Content-Type'] || headers['content-type'] || '').toLowerCase();\n        if (contentType && !contentType.startsWith('audio/')) return;\n        if (payload.length > 0) {\n          chunks.push(payload);\n        }\n      };\n\n      void handleBinary().catch(fail);\n    };\n\n    ws.onerror = () => {\n      // Browser WebSocket error events don't expose useful details.\n      // Keep the event and wait for onclose to obtain close code/reason.\n      sawSocketError = true;\n    };\n\n    ws.onclose = event => {\n      closeCode = event.code;\n      closeReason = String(event.reason || '').trim();\n      closeWasClean = !!event.wasClean;\n\n      if (done) return;\n      if (options.signal?.aborted) {\n        fail(toAbortError('EdgeTTS direct synthesis aborted'));\n        return;\n      }\n      if (chunks.length <= 0) {\n        fail(\n          new Error(\n            `No audio frame received from EdgeTTS direct websocket (${attemptLabel}; code=${closeCode}, clean=${closeWasClean}, opened=${sawOpen}, errorEvent=${sawSocketError}, reason=${closeReason || 'n/a'})`,\n          ),\n        );\n        return;\n      }\n\n      const merged = concatChunks(chunks);\n      const blob = new Blob([merged as unknown as ArrayBufferView], { type: 'audio/mpeg' });\n      finish(() => resolve(blob));\n    };\n  });\n}\n\nexport async function synthesizeToBlob(\n  text: string,\n  voice: TTSSpeakerVoice | string,\n  options: EdgeDirectSynthesisOptions = {},\n): Promise<Blob> {\n  const cleanText = removeIncompatibleCharacters(String(text || '')).trim();\n  if (!cleanText) {\n    throw new Error('EdgeTTS text is empty');\n  }\n\n  const voiceName = getVoiceName(voice);\n  if (!voiceName) {\n    throw new Error('EdgeTTS voice is empty');\n  }\n\n  const securityResult = await buildSecurityParamsWithReason();\n  const security = securityResult.security;\n  const attempts: Array<{ socketUrl: string; timestampMode: EdgeTimestampMode; label: string }> = [];\n  if (security) {\n    attempts.push({\n      socketUrl: `${WSS_URL}&Sec-MS-GEC=${encodeURIComponent(security.secMsGec)}&Sec-MS-GEC-Version=${encodeURIComponent(security.secMsGecVersion)}&ConnectionId=${buildConnectionId()}`,\n      timestampMode: 'utc_string',\n      label: 'with-sec/utc',\n    });\n    attempts.push({\n      socketUrl: `${WSS_URL}&Sec-MS-GEC=${encodeURIComponent(security.secMsGec)}&Sec-MS-GEC-Version=${encodeURIComponent(security.secMsGecVersion)}&ConnectionId=${buildConnectionId()}`,\n      timestampMode: 'iso_compact',\n      label: 'with-sec/iso',\n    });\n  }\n  const plainBase = `${WSS_URL}&ConnectionId=${buildConnectionId()}`;\n  attempts.push({\n    socketUrl: plainBase,\n    timestampMode: 'utc_string',\n    label: 'plain/utc',\n  });\n  attempts.push({\n    socketUrl: plainBase,\n    timestampMode: 'iso_compact',\n    label: 'plain/iso',\n  });\n\n  let lastError: unknown = null;\n  const attemptErrors: string[] = [];\n  for (const attempt of attempts) {\n    try {\n      return await synthesizeWithSocketUrl(\n        attempt.socketUrl,\n        cleanText,\n        voiceName,\n        options,\n        attempt.timestampMode,\n        attempt.label,\n      );\n    } catch (e) {\n      lastError = e;\n      const message = e instanceof Error ? e.message : String(e);\n      attemptErrors.push(`${attempt.label}: ${message}`);\n      if (options.signal?.aborted) {\n        throw toAbortError('EdgeTTS direct synthesis aborted');\n      }\n    }\n  }\n\n  if (attemptErrors.length > 0) {\n    const ua = String(globalThis.navigator?.userAgent || '');\n    const isEdgeUA = /Edg\\//i.test(ua);\n    const allUnopened = attemptErrors.every(msg => /opened=false/.test(msg));\n    const likelyUaRejected = !isEdgeUA && allUnopened;\n    const securityHint =\n      !security && securityResult.error ? ` security-unavailable=${securityResult.error};` : '';\n    const uaHint = likelyUaRejected ? ' likely-cause=ua-not-edg;' : '';\n    throw new Error(`EdgeTTS direct synthesis failed.${securityHint}${uaHint} ${attemptErrors.join(' | ')}`);\n  }\n  throw lastError instanceof Error ? lastError : new Error('EdgeTTS direct synthesis failed');\n}\n","import { SCRIPT_NAME } from '../core/constants';\nimport { useSettingsStore } from '../core/settings';\nimport { fetchEdgeVoices, getEdgeFallbackVoices } from './edge-tts-direct';\n\n// ============================================\n// TTS  (Providers)\n// : galgame/src/audio/tts-config.js\n// ============================================\n\nexport const TTS_PROVIDER = {\n  LITTLEWHITEBOX: 'littlewhitebox',\n  GPT_SOVITS_V2: 'gpt_sovits_v2',\n  EDGE_TTS_DIRECT: 'edge_tts_direct',\n} as const;\n\nexport type TTSProvider = (typeof TTS_PROVIDER)[keyof typeof TTS_PROVIDER];\n\nexport type GptSoVitsSwitchMode = 'none' | 'set_model' | 'set_weights';\n\nexport type GptSoVitsVoiceStoreConfig = {\n  name: string;\n  desc: string;\n  refAudioPath: string;\n  promptText: string;\n  promptLang: string;\n  textLang: string;\n  gptWeightsPath: string;\n  sovitsWeightsPath: string;\n  modelSwitchMode: GptSoVitsSwitchMode;\n  setModelEndpoint: string;\n};\n\nexport type TTSSpeakerVoice = {\n  name: string;\n  value: string;\n  source: string;\n  resourceId: string | null;\n  desc: string;\n  gptSoVits?: {\n    refAudioPath: string;\n    promptText: string;\n    promptLang: string;\n    textLang: string;\n    gptWeightsPath: string;\n    sovitsWeightsPath: string;\n    modelSwitchMode: GptSoVitsSwitchMode;\n    setModelEndpoint: string;\n  };\n};\n\nfunction getTopWindow(): Window {\n  try {\n    return window.parent ?? window;\n  } catch {\n    return window;\n  }\n}\n\nfunction getStoragePrefix(): string {\n  try {\n    if (typeof getScriptId === 'function') {\n      const id = String(getScriptId() ?? '').trim();\n      if (id) return id;\n    }\n  } catch {\n    // ignore\n  }\n  return SCRIPT_NAME;\n}\n\nfunction getTtsEnabledKey(): string {\n  return `${getStoragePrefix()}_tts_enabled`;\n}\n\nfunction getCharTtsVoiceKey(): string {\n  return `${getStoragePrefix()}_char_tts_voice`;\n}\n\nexport function normalizeGptSoVitsSwitchMode(mode: unknown): GptSoVitsSwitchMode {\n  const s = String(mode || '').trim().toLowerCase();\n  if (s === 'none' || s === 'off' || s === 'disabled') return 'none';\n  if (s === 'set_model' || s === 'model') return 'set_model';\n  return 'set_weights';\n}\n\nfunction normalizeSetModelEndpoint(endpoint: unknown): string {\n  const raw = String(endpoint || '').trim();\n  if (!raw) return '/set_model';\n  return raw.startsWith('/') ? raw : `/${raw}`;\n}\n\nexport function getTTSProvider(): TTSProvider {\n  try {\n    const store = useSettingsStore();\n    return (store.settings.ttsProvider as TTSProvider) || TTS_PROVIDER.LITTLEWHITEBOX;\n  } catch {\n    return TTS_PROVIDER.LITTLEWHITEBOX;\n  }\n}\n\nexport function getGptSoVitsConfig() {\n  const defaults = {\n    apiUrl: 'http://127.0.0.1:9880',\n    endpoint: '/tts',\n    useCorsProxy: true,\n    mediaType: 'wav',\n    streamingMode: false,\n    textLang: 'auto',\n    textSplitMethod: 'cut5',\n    speedFactor: 1,\n    strictWeightSwitch: false,\n    probeOnAudioError: false,\n    modelSwitchMode: 'set_weights' as GptSoVitsSwitchMode,\n    setModelEndpoint: '/set_model',\n    importPathPrefix: '',\n    voices: [] as unknown[],\n  };\n\n  try {\n    const store = useSettingsStore();\n    const cfg = store.settings.gptSoVits || ({} as any);\n    return Object.assign(Object.assign({}, defaults), cfg, {\n      modelSwitchMode: normalizeGptSoVitsSwitchMode(cfg.modelSwitchMode || defaults.modelSwitchMode),\n      setModelEndpoint: normalizeSetModelEndpoint(cfg.setModelEndpoint || defaults.setModelEndpoint),\n      voices: Array.isArray(cfg.voices) ? cfg.voices : defaults.voices,\n    });\n  } catch {\n    return defaults;\n  }\n}\n\nexport function normalizeGptSoVitsVoice(voice: any): TTSSpeakerVoice | null {\n  if (!voice) return null;\n  const rawCfg = voice?.gptSoVits || {};\n  const name = String(voice.name || voice.voice || voice.speaker || rawCfg.name || '').trim();\n  if (!name) return null;\n\n  const refAudioPath = String(\n    voice.refAudioPath ||\n      voice.ref_audio_path ||\n      voice.ref_audio ||\n      voice.ref ||\n      rawCfg.refAudioPath ||\n      '',\n  ).trim();\n  const promptText = String(voice.promptText || voice.prompt_text || rawCfg.promptText || '').trim();\n  const promptLang = String(voice.promptLang || voice.prompt_lang || rawCfg.promptLang || '').trim();\n  const textLang = String(voice.textLang || voice.text_lang || rawCfg.textLang || '').trim();\n  const gptWeightsPath = String(\n    voice.gptWeightsPath || voice.gpt_weights_path || voice.gptPath || voice.gpt || rawCfg.gptWeightsPath || '',\n  ).trim();\n  const sovitsWeightsPath = String(\n    voice.sovitsWeightsPath ||\n      voice.sovits_weights_path ||\n      voice.sovitsPath ||\n      voice.sovits ||\n      rawCfg.sovitsWeightsPath ||\n      '',\n  ).trim();\n  const modelSwitchMode = normalizeGptSoVitsSwitchMode(\n    voice.modelSwitchMode || voice.model_switch_mode || rawCfg.modelSwitchMode || '',\n  );\n  const setModelEndpoint = normalizeSetModelEndpoint(\n    voice.setModelEndpoint || voice.set_model_endpoint || rawCfg.setModelEndpoint || '/set_model',\n  );\n  const desc = String(voice.desc || voice.description || '').trim();\n\n  return {\n    name,\n    value: name,\n    source: TTS_PROVIDER.GPT_SOVITS_V2,\n    resourceId: null,\n    desc: desc || 'GPT-SoVITS',\n    gptSoVits: {\n      refAudioPath,\n      promptText,\n      promptLang,\n      textLang,\n      gptWeightsPath,\n      sovitsWeightsPath,\n      modelSwitchMode,\n      setModelEndpoint,\n    },\n  };\n}\n\nfunction toGptSoVitsVoiceConfig(\n  voice: any,\n  globalDefaults: ReturnType<typeof getGptSoVitsConfig> | null = null,\n): GptSoVitsVoiceStoreConfig | null {\n  const normalized = normalizeGptSoVitsVoice(voice);\n  if (!normalized) return null;\n  const cfg = normalized.gptSoVits || ({} as any);\n  const globalCfg = globalDefaults || getGptSoVitsConfig();\n  const desc = String(voice?.desc || voice?.description || '').trim();\n\n  return {\n    name: normalized.name,\n    desc,\n    refAudioPath: String(cfg.refAudioPath || '').trim(),\n    promptText: String(cfg.promptText || '').trim(),\n    promptLang: String(cfg.promptLang || '').trim(),\n    textLang: String(cfg.textLang || '').trim(),\n    gptWeightsPath: String(cfg.gptWeightsPath || '').trim(),\n    sovitsWeightsPath: String(cfg.sovitsWeightsPath || '').trim(),\n    modelSwitchMode: normalizeGptSoVitsSwitchMode(cfg.modelSwitchMode || globalCfg.modelSwitchMode),\n    setModelEndpoint: normalizeSetModelEndpoint(cfg.setModelEndpoint || globalCfg.setModelEndpoint),\n  };\n}\n\nexport function isGptSoVitsVoiceUsable(voice: any): boolean {\n  const cfg = toGptSoVitsVoiceConfig(voice);\n  return !!String(cfg?.refAudioPath || '').trim();\n}\n\nexport function normalizeGptSoVitsVoicesForStore(\n  voiceList: any,\n  globalDefaults: ReturnType<typeof getGptSoVitsConfig> | null = null,\n) {\n  const out: GptSoVitsVoiceStoreConfig[] = [];\n  let ignoredCount = 0;\n  let missingRefCount = 0;\n\n  for (const voice of Array.isArray(voiceList) ? voiceList : []) {\n    const cfg = toGptSoVitsVoiceConfig(voice, globalDefaults);\n    if (!cfg) {\n      ignoredCount += 1;\n      continue;\n    }\n    if (!cfg.refAudioPath) missingRefCount += 1;\n    out.push(cfg);\n  }\n\n  return { voices: out, ignoredCount, missingRefCount };\n}\n\nexport function pickFirstUsableGptSoVitsVoice(voiceList: any): TTSSpeakerVoice | null {\n  for (const voice of Array.isArray(voiceList) ? voiceList : []) {\n    if (isGptSoVitsVoiceUsable(voice)) return voice;\n  }\n  return null;\n}\n\nexport async function getGptSoVitsVoiceListAsync(): Promise<TTSSpeakerVoice[]> {\n  const cfg = getGptSoVitsConfig();\n  const list = Array.isArray(cfg.voices) ? cfg.voices : [];\n  return list.map(normalizeGptSoVitsVoice).filter(Boolean) as TTSSpeakerVoice[];\n}\n\nexport function getGptSoVitsVoiceList(): TTSSpeakerVoice[] {\n  try {\n    const cfg = getGptSoVitsConfig();\n    const list = Array.isArray(cfg.voices) ? cfg.voices : [];\n    return list.map(normalizeGptSoVitsVoice).filter(Boolean) as TTSSpeakerVoice[];\n  } catch {\n    return [];\n  }\n}\n\n// LittleWhiteBox TTS \nlet _lwbTtsCache: TTSSpeakerVoice[] | null = null;\nlet _lwbTtsCacheTime = 0;\nconst LWB_TTS_CACHE_MS = 5000;\n\nlet _edgeTtsCache: TTSSpeakerVoice[] | null = null;\nlet _edgeTtsCacheTime = 0;\nconst EDGE_TTS_CACHE_MS = 2 * 60 * 1000;\n\nexport async function getEdgeDirectVoiceListAsync(): Promise<TTSSpeakerVoice[]> {\n  const now = Date.now();\n  if (_edgeTtsCache && now - _edgeTtsCacheTime <= EDGE_TTS_CACHE_MS) {\n    return _edgeTtsCache;\n  }\n\n  try {\n    const voices = await fetchEdgeVoices();\n    if (voices.length > 0) {\n      _edgeTtsCache = voices;\n      _edgeTtsCacheTime = now;\n      return voices;\n    }\n  } catch (e) {\n    console.warn(`[${SCRIPT_NAME}] EdgeTTS :`, e);\n  }\n\n  const fallback = getEdgeFallbackVoices();\n  _edgeTtsCache = fallback;\n  _edgeTtsCacheTime = now;\n  return fallback;\n}\n\nexport function getEdgeDirectVoiceList(): TTSSpeakerVoice[] {\n  if (_edgeTtsCache && _edgeTtsCache.length > 0) {\n    return _edgeTtsCache;\n  }\n  return getEdgeFallbackVoices();\n}\n\nasync function fetchLittleWhiteBoxTTSConfig(): Promise<any[] | null> {\n  try {\n    const response = await fetch('/user/files/LittleWhiteBox_TTS.json', { cache: 'no-cache' });\n    if (!response.ok) return null;\n    const data = await response.json();\n    return data?.volc?.mySpeakers || null;\n  } catch (e) {\n    console.log(`[${SCRIPT_NAME}]  LittleWhiteBox TTS :`, e);\n    return null;\n  }\n}\n\nexport async function getTTSVoiceListAsync(): Promise<TTSSpeakerVoice[]> {\n  const provider = getTTSProvider();\n  if (provider === TTS_PROVIDER.GPT_SOVITS_V2) {\n    return getGptSoVitsVoiceListAsync();\n  }\n  if (provider === TTS_PROVIDER.EDGE_TTS_DIRECT) {\n    return getEdgeDirectVoiceListAsync();\n  }\n\n  const now = Date.now();\n  if (!_lwbTtsCache || now - _lwbTtsCacheTime > LWB_TTS_CACHE_MS) {\n    const mySpeakers = await fetchLittleWhiteBoxTTSConfig();\n    if (mySpeakers && mySpeakers.length > 0) {\n      _lwbTtsCache = mySpeakers.map((s: any) => ({\n        name: s.name,\n        value: s.value,\n        source: s.source || (isFreeVoice(s.value) ? 'free' : 'auth'),\n        resourceId: s.resourceId || inferResourceId(s.value),\n        desc: getVoiceDesc(s.value),\n      }));\n      _lwbTtsCacheTime = now;\n      return _lwbTtsCache;\n    }\n  } else if (_lwbTtsCache) {\n    return _lwbTtsCache;\n  }\n\n  const topAny: any = getTopWindow() as any;\n  const xbTts = topAny?.xiaobaixTts || (window as any)?.xiaobaixTts;\n  if (xbTts?.getConfig) {\n    const config = xbTts.getConfig();\n    const mySpeakers = config?.volc?.mySpeakers || [];\n    if (mySpeakers.length > 0) {\n      return mySpeakers.map((s: any) => ({\n        name: s.name,\n        value: s.value,\n        source: s.source || (isFreeVoice(s.value) ? 'free' : 'auth'),\n        resourceId: s.resourceId || inferResourceId(s.value),\n        desc: getVoiceDesc(s.value),\n      }));\n    }\n  }\n\n  const xbVoiceData = topAny?.XB_TTS_VOICE_DATA || (window as any)?.XB_TTS_VOICE_DATA;\n  if (Array.isArray(xbVoiceData) && xbVoiceData.length > 0) {\n    return xbVoiceData.slice(0, 20).map((v: any) => ({\n      name: v.name,\n      value: v.value,\n      source: inferSource(v.value),\n      resourceId: inferResourceId(v.value),\n      desc: v.scene || '',\n    }));\n  }\n\n  return getDefaultFreeVoices();\n}\n\nexport function getTTSVoiceList(): TTSSpeakerVoice[] {\n  const provider = getTTSProvider();\n  if (provider === TTS_PROVIDER.GPT_SOVITS_V2) {\n    return getGptSoVitsVoiceList();\n  }\n  if (provider === TTS_PROVIDER.EDGE_TTS_DIRECT) {\n    return getEdgeDirectVoiceList();\n  }\n\n  if (_lwbTtsCache) {\n    return _lwbTtsCache;\n  }\n\n  const topAny: any = getTopWindow() as any;\n  const xbTts = topAny?.xiaobaixTts || (window as any)?.xiaobaixTts;\n  if (xbTts?.getConfig) {\n    const config = xbTts.getConfig();\n    const mySpeakers = config?.volc?.mySpeakers || [];\n    if (mySpeakers.length > 0) {\n      return mySpeakers.map((s: any) => ({\n        name: s.name,\n        value: s.value,\n        source: s.source || (isFreeVoice(s.value) ? 'free' : 'auth'),\n        resourceId: s.resourceId || inferResourceId(s.value),\n        desc: getVoiceDesc(s.value),\n      }));\n    }\n  }\n\n  const xbVoiceData = topAny?.XB_TTS_VOICE_DATA || (window as any)?.XB_TTS_VOICE_DATA;\n  if (Array.isArray(xbVoiceData) && xbVoiceData.length > 0) {\n    return xbVoiceData.slice(0, 20).map((v: any) => ({\n      name: v.name,\n      value: v.value,\n      source: inferSource(v.value),\n      resourceId: inferResourceId(v.value),\n      desc: v.scene || '',\n    }));\n  }\n\n  return getDefaultFreeVoices();\n}\n\nfunction isFreeVoice(value: string): boolean {\n  const freeVoices = [\n    'female_1',\n    'female_2',\n    'female_3',\n    'female_4',\n    'female_5',\n    'female_6',\n    'female_7',\n    'male_1',\n    'male_2',\n    'male_3',\n    'male_4',\n  ];\n  return freeVoices.includes(value);\n}\n\nfunction inferSource(value: string): string {\n  return isFreeVoice(value) ? 'free' : 'auth';\n}\n\nexport function inferResourceId(value: string): string {\n  const lower = (value || '').toLowerCase();\n  if (lower.startsWith('icl_') || lower.startsWith('s_')) return 'seed-icl-2.0';\n  if (\n    lower.startsWith('saturn_') ||\n    lower.startsWith('uranus_') ||\n    lower.includes('_saturn_') ||\n    lower.includes('_uranus_')\n  ) {\n    return 'seed-tts-2.0';\n  }\n  return 'seed-tts-1.0';\n}\n\nfunction getVoiceDesc(value: string): string {\n  const descMap: Record<string, string> = {\n    female_1: '()',\n    female_2: '()',\n    female_3: '()',\n    female_4: '()',\n    female_5: '()',\n    female_6: '()',\n    female_7: '()',\n    male_1: '()',\n    male_2: '()',\n    male_3: '()',\n    male_4: '()',\n  };\n  return descMap[value] || '';\n}\n\nfunction getDefaultFreeVoices(): TTSSpeakerVoice[] {\n  return [\n    { name: '', value: 'female_1', source: 'free', resourceId: null, desc: '()' },\n    { name: '', value: 'male_1', source: 'free', resourceId: null, desc: '()' },\n    { name: '', value: 'female_2', source: 'free', resourceId: null, desc: '()' },\n    { name: '', value: 'female_3', source: 'free', resourceId: null, desc: '()' },\n    { name: '', value: 'female_4', source: 'free', resourceId: null, desc: '()' },\n    { name: '', value: 'female_5', source: 'free', resourceId: null, desc: '()' },\n    { name: '', value: 'female_6', source: 'free', resourceId: null, desc: '()' },\n    { name: '', value: 'female_7', source: 'free', resourceId: null, desc: '()' },\n    { name: '', value: 'male_2', source: 'free', resourceId: null, desc: '()' },\n    { name: '', value: 'male_3', source: 'free', resourceId: null, desc: '()' },\n    { name: '', value: 'male_4', source: 'free', resourceId: null, desc: '()' },\n  ];\n}\n\nexport async function resolveVoiceByName(voiceName: string): Promise<TTSSpeakerVoice | null> {\n  if (!voiceName) return null;\n  const voiceList = await getTTSVoiceListAsync();\n  let voice = voiceList.find(v => v.name === voiceName);\n  if (voice) return voice;\n  voice = voiceList.find(v => v.value === voiceName);\n  if (voice) return voice;\n  const provider = getTTSProvider();\n  const defaultVoice =\n    provider === TTS_PROVIDER.GPT_SOVITS_V2\n      ? (pickFirstUsableGptSoVitsVoice(voiceList) || voiceList[0])\n      : provider === TTS_PROVIDER.EDGE_TTS_DIRECT\n        ? voiceList[0]\n        : voiceList[0];\n  if (defaultVoice) {\n    console.warn(`[${SCRIPT_NAME}]  \"${voiceName}\": ${defaultVoice.name}`);\n    return defaultVoice;\n  }\n  return null;\n}\n\n// TTS_VOICE_LIST getter \ntry {\n  Object.defineProperty(getTopWindow() as any, 'TTS_VOICE_LIST', {\n    get: getTTSVoiceList,\n    configurable: true,\n  });\n} catch {\n  // ignore\n}\n\nexport function getTTSEnabled(): boolean {\n  try {\n    const saved = localStorage.getItem(getTtsEnabledKey());\n    if (saved === null) return true;\n    return saved === 'true';\n  } catch {\n    return true;\n  }\n}\n\nexport function setTTSEnabled(enabled: boolean): void {\n  try {\n    localStorage.setItem(getTtsEnabledKey(), String(enabled));\n  } catch (e) {\n    console.error(`[${SCRIPT_NAME}] TTS:`, e);\n  }\n}\n\nexport function getCharacterTTSVoice(characterId: string): string | null {\n  try {\n    const map = JSON.parse(localStorage.getItem(getCharTtsVoiceKey()) || '{}');\n    return map[characterId] || null;\n  } catch {\n    return null;\n  }\n}\n\nexport function setCharacterTTSVoice(characterId: string, voiceName: string | null): void {\n  try {\n    const map = JSON.parse(localStorage.getItem(getCharTtsVoiceKey()) || '{}');\n    if (voiceName) {\n      map[characterId] = voiceName;\n    } else {\n      delete map[characterId];\n    }\n    localStorage.setItem(getCharTtsVoiceKey(), JSON.stringify(map));\n  } catch (e) {\n    console.error(`[${SCRIPT_NAME}] TTS:`, e);\n  }\n}\n\nexport function getAllCharacterTTSVoices(): Record<string, string> {\n  try {\n    return JSON.parse(localStorage.getItem(getCharTtsVoiceKey()) || '{}');\n  } catch {\n    return {};\n  }\n}\n","import { SDK_URLS } from '../core/constants';\nimport { log, warn, error } from '../utils/dom';\n/**\n * Live2D SDK \n *  PIXI.jsCubism Corepixi-live2d-display \n */\nexport const Live2DLoader = {\n    _READY_MARK: '__desktopPetLive2dLoaderReady_v2',\n    _RUNTIME_KEY: '__desktopPetLive2dRuntime_v2',\n    _JSDELIVR_HOSTS: [\n        'cdn.jsdelivr.net',\n        'fastly.jsdelivr.net',\n        'testingcf.jsdelivr.net',\n        'gcore.jsdelivr.net',\n    ],\n    isLoaded: false,\n    loadPromise: null,\n    async load() {\n        const top = window.parent ?? window;\n        if (this.isLoaded) {\n            const runtime = this._getRuntime(top);\n            if (runtime)\n                return true;\n            warn(' Live2D runtime  SDK PIXI');\n            this.isLoaded = false;\n            this.loadPromise = null;\n        }\n        const runtime = this._getRuntime(top);\n        if (runtime) {\n            this.isLoaded = true;\n            top[this._READY_MARK] = true;\n            this.loadPromise = null;\n            return true;\n        }\n        if (this.loadPromise)\n            return this.loadPromise;\n        this.loadPromise = this._doLoad();\n        return this.loadPromise;\n    },\n    getRuntime(targetWindow) {\n        const top = targetWindow ?? window.parent ?? window;\n        return this._getRuntime(top);\n    },\n    getPixi(targetWindow) {\n        return this.getRuntime(targetWindow)?.pixi ?? null;\n    },\n    _getRuntime(top) {\n        const runtime = top[this._RUNTIME_KEY];\n        if (!runtime || typeof runtime !== 'object')\n            return null;\n        const pixi = runtime.pixi;\n        const live2dModel = runtime.live2dModel;\n        if (!pixi || !live2dModel)\n            return null;\n        const pixiMajor = this._getPixiMajorVersion(pixi);\n        if (pixiMajor !== 6)\n            return null;\n        // runtime  PIXI \n        if (top.PIXI !== pixi)\n            return null;\n        if (pixi?.live2d?.Live2DModel !== live2dModel)\n            return null;\n        return runtime;\n    },\n    _setRuntime(top) {\n        const pixi = top.PIXI;\n        const live2dModel = pixi?.live2d?.Live2DModel;\n        const pixiMajor = this._getPixiMajorVersion(pixi);\n        if (pixiMajor !== 6 || !live2dModel) {\n            return null;\n        }\n        const runtime = {\n            pixi,\n            live2dModel,\n            pixiVersion: String(pixi?.VERSION || 'unknown'),\n            loadedAt: Date.now(),\n        };\n        top[this._RUNTIME_KEY] = runtime;\n        return runtime;\n    },\n    async _doLoad() {\n        const top = window.parent ?? window;\n        try {\n            const existingRuntime = this._getRuntime(top);\n            if (existingRuntime) {\n                this.isLoaded = true;\n                top[this._READY_MARK] = true;\n                this.loadPromise = null;\n                return true;\n            }\n            //  PIXI.js\n            const pixi = top.PIXI;\n            const pixiMajor = this._getPixiMajorVersion(pixi);\n            if (!pixi || pixiMajor !== 6) {\n                if (pixi && pixiMajor !== null && pixiMajor !== 6) {\n                    warn(' PIXI  PIXI v6', {\n                        detected: pixi.VERSION ?? 'unknown',\n                    });\n                }\n                log(' PIXI.js...');\n                await this._loadScriptWithFallback(SDK_URLS.PIXI, top, 'PIXI.js');\n                log('PIXI.js ');\n            }\n            if (!top.window.PIXI) {\n                top.window.PIXI = top.PIXI;\n            }\n            //  Cubism 4 Core\n            if (!this._hasValidCubism4Core(top)) {\n                if (top.Live2DCubismCore) {\n                    warn(' Cubism 4 Core ');\n                }\n                log(' Cubism 4 Core...');\n                try {\n                    await this._loadScriptWithFallback(SDK_URLS.CUBISM4_CORE, top, 'Cubism 4 Core', 20000);\n                    log('Cubism 4 Core ');\n                }\n                catch (e) {\n                    warn('Cubism 4 Core ', e);\n                }\n            }\n            //  Cubism 2 Core\n            if (!top.Live2D) {\n                log(' Cubism 2 Core...');\n                try {\n                    await this._loadScriptWithFallback(SDK_URLS.CUBISM2_CORE, top, 'Cubism 2 Core', 20000);\n                    log('Cubism 2 Core ');\n                }\n                catch (e) {\n                    warn('Cubism 2 Core ', e);\n                }\n            }\n            //  pixi-live2d-display\n            log(' pixi-live2d-display...');\n            await this._loadScriptWithFallback(SDK_URLS.PIXI_LIVE2D_DISPLAY, top, 'pixi-live2d-display', 25000);\n            await new Promise(r => setTimeout(r, 120));\n            const runtime = this._setRuntime(top);\n            if (!runtime) {\n                throw new Error('pixi-live2d-display ');\n            }\n            this.isLoaded = true;\n            top[this._READY_MARK] = true;\n            this.loadPromise = null;\n            log('Live2D SDK ', {\n                pixi: runtime.pixiVersion,\n            });\n            return true;\n        }\n        catch (e) {\n            error('Live2D SDK :', e);\n            top[this._READY_MARK] = false;\n            top[this._RUNTIME_KEY] = null;\n            this.isLoaded = false;\n            this.loadPromise = null;\n            return false;\n        }\n    },\n    _getPixiMajorVersion(pixi) {\n        if (!pixi || typeof pixi !== 'object')\n            return null;\n        const version = String(pixi.VERSION || '').trim();\n        if (!version)\n            return null;\n        const majorStr = version.split('.')[0];\n        const major = Number.parseInt(majorStr, 10);\n        return Number.isFinite(major) ? major : null;\n    },\n    _buildUrlCandidates(originalUrl) {\n        const url = String(originalUrl || '').trim();\n        if (!url)\n            return [];\n        const candidates = [];\n        const add = (candidate) => {\n            const value = String(candidate || '').trim();\n            if (!value)\n                return;\n            if (!candidates.includes(value))\n                candidates.push(value);\n        };\n        add(url);\n        let urlObj;\n        try {\n            urlObj = new URL(url);\n        }\n        catch {\n            return candidates;\n        }\n        const host = urlObj.hostname.toLowerCase();\n        if (host.endsWith('jsdelivr.net')) {\n            for (const h of this._JSDELIVR_HOSTS) {\n                try {\n                    const u = new URL(url);\n                    u.hostname = h;\n                    add(u.toString());\n                }\n                catch {\n                    // ignore\n                }\n            }\n            if (urlObj.pathname.startsWith('/npm/')) {\n                try {\n                    const u = new URL(url);\n                    u.hostname = 'unpkg.com';\n                    u.pathname = urlObj.pathname.replace(/^\\/npm\\//, '/');\n                    add(u.toString());\n                }\n                catch {\n                    // ignore\n                }\n            }\n            if (urlObj.pathname.startsWith('/gh/')) {\n                const rest = urlObj.pathname.slice('/gh/'.length);\n                const parts = rest.split('/').filter(Boolean);\n                if (parts.length >= 3) {\n                    const owner = parts[0];\n                    const repoWithRef = parts[1];\n                    const filePath = parts.slice(2).join('/');\n                    if (owner && repoWithRef && filePath) {\n                        const [repo, ref] = repoWithRef.split('@');\n                        const suffix = `${urlObj.search || ''}${urlObj.hash || ''}`;\n                        if (ref) {\n                            add(`https://raw.githubusercontent.com/${owner}/${repo}/${ref}/${filePath}${suffix}`);\n                        }\n                        else {\n                            add(`https://raw.githubusercontent.com/${owner}/${repo}/master/${filePath}${suffix}`);\n                            add(`https://raw.githubusercontent.com/${owner}/${repo}/main/${filePath}${suffix}`);\n                        }\n                    }\n                }\n            }\n        }\n        return candidates;\n    },\n    _hasValidCubism4Core(targetWindow) {\n        const core = targetWindow.Live2DCubismCore;\n        if (!core || typeof core !== 'object')\n            return false;\n        const hasVersion = typeof core.Version === 'function';\n        const hasMoc = typeof core.Moc === 'function' || typeof core.Moc === 'object';\n        const hasUtils = typeof core.Utils === 'object';\n        return hasVersion || hasMoc || hasUtils;\n    },\n    _loadScriptBySrc(url, targetWindow, timeoutMs = 15000) {\n        return new Promise((resolve, reject) => {\n            let timer = null;\n            try {\n                const doc = targetWindow.document;\n                const script = doc.createElement('script');\n                script.src = url;\n                script.async = true;\n                script.dataset.desktopPetSdk = 'true';\n                const cleanup = () => {\n                    script.onload = null;\n                    script.onerror = null;\n                    if (timer !== null) {\n                        targetWindow.clearTimeout(timer);\n                        timer = null;\n                    }\n                };\n                script.onload = () => {\n                    cleanup();\n                    resolve();\n                };\n                script.onerror = () => {\n                    cleanup();\n                    reject(new Error(`: ${url}`));\n                };\n                timer = targetWindow.setTimeout(() => {\n                    cleanup();\n                    reject(new Error(` (${timeoutMs}ms): ${url}`));\n                }, timeoutMs);\n                doc.head.appendChild(script);\n            }\n            catch (e) {\n                if (timer !== null) {\n                    targetWindow.clearTimeout(timer);\n                }\n                reject(e);\n            }\n        });\n    },\n    async _loadScriptWithFallback(url, targetWindow, label, timeoutMs = 15000) {\n        const candidates = this._buildUrlCandidates(url);\n        let lastError = null;\n        for (let i = 0; i < candidates.length; i++) {\n            const candidate = candidates[i];\n            try {\n                if (i > 0) {\n                    warn(`${label} :`, candidate);\n                }\n                await this._loadScriptBySrc(candidate, targetWindow, timeoutMs);\n                return candidate;\n            }\n            catch (e) {\n                lastError = e;\n            }\n        }\n        throw (lastError instanceof Error ? lastError : new Error(`${label} `));\n    },\n};\n","/**\n * \n *  jQueryUI draggable  //  LLM\n *  jQueryUI draggable \n *\n * \n * IDLE  pointerdown  PENDING\n * PENDING   >   IDLE jQueryUI\n * PENDING  longPressDelay   LONG_PRESS  IDLE\n * PENDING  pointerup  WAIT_DOUBLE\n * WAIT_DOUBLE  doubleClickWindow  pointerdown+up  DOUBLE_TAP  IDLE\n * WAIT_DOUBLE    TAP  IDLE\n */\n\nexport type GestureType = 'tap' | 'double-tap' | 'long-press';\n\nexport interface GestureEvent {\n  type: GestureType;\n  clientX: number;\n  clientY: number;\n}\n\nexport interface GestureConfig {\n  /** (ms) */\n  longPressDelay: number;\n  /** (ms) */\n  doubleClickWindow: number;\n  /** (px) */\n  moveThreshold: number;\n}\n\nconst DEFAULT_CONFIG: GestureConfig = {\n  longPressDelay: 500,\n  doubleClickWindow: 300,\n  moveThreshold: 8,\n};\n\nfunction isTouchDevice(): boolean {\n  return 'ontouchstart' in window || navigator.maxTouchPoints > 0;\n}\n\nexport class GestureRecognizer {\n  private element: HTMLElement;\n  private config: GestureConfig;\n  private onGesture: (event: GestureEvent) => void;\n  private isDraggingCheck: () => boolean;\n\n  private state: 'idle' | 'pending' | 'wait-double' = 'idle';\n  private startPos = { x: 0, y: 0 };\n  private longPressTimer: number | null = null;\n  private doubleClickTimer: number | null = null;\n  private longPressFired = false;\n  private moved = false;\n  private activePointerId: number | null = null;\n  private destroyed = false;\n\n  private boundPointerDown: (e: PointerEvent) => void;\n  private boundPointerMove: (e: PointerEvent) => void;\n  private boundPointerUp: (e: PointerEvent) => void;\n  private boundContextMenu: (e: Event) => void;\n\n  /**\n   * @param element \n   * @param config \n   * @param onGesture \n   * @param isDraggingCheck  jQueryUI draggable \n   */\n  constructor(\n    element: HTMLElement,\n    config: Partial<GestureConfig>,\n    onGesture: (event: GestureEvent) => void,\n    isDraggingCheck: () => boolean = () => false,\n  ) {\n    this.element = element;\n    this.config = {\n      ...DEFAULT_CONFIG,\n      moveThreshold: isTouchDevice() ? 12 : 8,\n      ...config,\n    };\n    this.onGesture = onGesture;\n    this.isDraggingCheck = isDraggingCheck;\n\n    this.boundPointerDown = this.handlePointerDown.bind(this);\n    this.boundPointerMove = this.handlePointerMove.bind(this);\n    this.boundPointerUp = this.handlePointerUp.bind(this);\n    this.boundContextMenu = (e: Event) => e.preventDefault();\n\n    element.addEventListener('pointerdown', this.boundPointerDown);\n    element.addEventListener('pointermove', this.boundPointerMove);\n    element.addEventListener('pointerup', this.boundPointerUp);\n    element.addEventListener('pointercancel', this.boundPointerUp);\n    element.addEventListener('contextmenu', this.boundContextMenu);\n  }\n\n  destroy(): void {\n    this.destroyed = true;\n    this.clearAllTimers();\n    this.element.removeEventListener('pointerdown', this.boundPointerDown);\n    this.element.removeEventListener('pointermove', this.boundPointerMove);\n    this.element.removeEventListener('pointerup', this.boundPointerUp);\n    this.element.removeEventListener('pointercancel', this.boundPointerUp);\n    this.element.removeEventListener('contextmenu', this.boundContextMenu);\n  }\n\n  private handlePointerDown(_e: PointerEvent): void {\n    if (this.destroyed) return;\n    if (_e.pointerType === 'touch' && _e.isPrimary === false) {\n      this.resetState();\n      return;\n    }\n\n    if (this.activePointerId !== null && _e.pointerId !== this.activePointerId) {\n      return;\n    }\n    this.activePointerId = _e.pointerId;\n\n    this.startPos = { x: _e.clientX, y: _e.clientY };\n    this.longPressFired = false;\n    this.moved = false;\n\n    if (this.state === 'wait-double') {\n      //  pointerup \n      return;\n    }\n\n    this.state = 'pending';\n    this.clearLongPressTimer();\n\n    this.longPressTimer = window.setTimeout(() => {\n      if (this.state === 'pending' && !this.moved && !this.isDraggingCheck()) {\n        this.longPressFired = true;\n        this.state = 'idle';\n        this.onGesture({\n          type: 'long-press',\n          clientX: this.startPos.x,\n          clientY: this.startPos.y,\n        });\n      }\n    }, this.config.longPressDelay);\n  }\n\n  private handlePointerMove(_e: PointerEvent): void {\n    if (this.destroyed || this.state !== 'pending') return;\n    if (this.activePointerId !== _e.pointerId) return;\n\n    const dx = _e.clientX - this.startPos.x;\n    const dy = _e.clientY - this.startPos.y;\n\n    if (Math.sqrt(dx * dx + dy * dy) > this.config.moveThreshold) {\n      //    idle jQueryUI \n      this.moved = true;\n      this.clearLongPressTimer();\n      this.state = 'idle';\n    }\n  }\n\n  private handlePointerUp(_e: PointerEvent): void {\n    if (this.destroyed) return;\n    if (this.activePointerId !== _e.pointerId) return;\n    this.activePointerId = null;\n    this.clearLongPressTimer();\n\n    // jQueryUI  \n    if (this.moved || this.isDraggingCheck()) {\n      this.state = 'idle';\n      return;\n    }\n\n    //    idle\n    if (this.longPressFired) {\n      this.state = 'idle';\n      return;\n    }\n\n    if (this.state === 'wait-double') {\n      // \n      this.clearDoubleClickTimer();\n      this.state = 'idle';\n      this.onGesture({\n        type: 'double-tap',\n        clientX: _e.clientX,\n        clientY: _e.clientY,\n      });\n      return;\n    }\n\n    if (this.state === 'pending' && !this.moved) {\n      //   \n      this.state = 'wait-double';\n      const x = _e.clientX;\n      const y = _e.clientY;\n      this.doubleClickTimer = window.setTimeout(() => {\n        //   \n        this.state = 'idle';\n        this.onGesture({ type: 'tap', clientX: x, clientY: y });\n      }, this.config.doubleClickWindow);\n    }\n  }\n\n  private resetState(): void {\n    this.activePointerId = null;\n    this.longPressFired = false;\n    this.moved = false;\n    this.state = 'idle';\n    this.clearAllTimers();\n  }\n\n  private clearLongPressTimer(): void {\n    if (this.longPressTimer !== null) {\n      window.clearTimeout(this.longPressTimer);\n      this.longPressTimer = null;\n    }\n  }\n\n  private clearDoubleClickTimer(): void {\n    if (this.doubleClickTimer !== null) {\n      window.clearTimeout(this.doubleClickTimer);\n      this.doubleClickTimer = null;\n    }\n  }\n\n  private clearAllTimers(): void {\n    this.clearLongPressTimer();\n    this.clearDoubleClickTimer();\n  }\n}\n","import { log, warn } from '../utils/dom';\r\nimport { GestureRecognizer, type GestureEvent } from '../utils/gesture-recognizer';\r\nimport { Live2DLoader } from './loader';\r\n\r\n/**\r\n * Live2D PIXI \r\n *  fixed  canvas\r\n */\r\nexport const Live2DStage = {\r\n  app: null as any,\r\n  canvas: null as HTMLCanvasElement | null,\r\n  glContext: null as WebGLRenderingContext | WebGL2RenderingContext | null,\r\n  container: null as HTMLDivElement | null,\r\n  mountStack: [] as Array<{\r\n    parent: ParentNode | null;\r\n    nextSibling: ChildNode | null;\r\n    styleText: string;\r\n    width: number;\r\n    height: number;\r\n    onPositionChange: ((x: number, y: number) => void) | null;\r\n  }>,\r\n  mountMode: 'floating' as 'floating' | 'preview',\r\n  _pendingFloatingResize: null as { width: number; height: number } | null,\r\n  loadingOverlay: null as HTMLDivElement | null,\r\n  loadingText: null as HTMLDivElement | null,\r\n  loadingBarFill: null as HTMLDivElement | null,\r\n  interactionLayer: null as HTMLDivElement | null,\r\n  gestureRecognizer: null as GestureRecognizer | null,\r\n  _dragClass: 'desktop-pet-dragging',\r\n  _minVisiblePx: 48,\r\n  _interactionPaddingPx: 14,\r\n  _alphaHitThreshold: 10,\r\n  _maxPixelScanSamples: 360000,\r\n  _onPositionChange: null as ((x: number, y: number) => void) | null,\r\n  _boundWindowResize: null as (() => void) | null,\r\n  _interactionSyncTimer: null as number | null,\r\n  _pixelReadBuffer: null as Uint8Array | null,\r\n  _lastClampLogAt: 0,\r\n\r\n  _clampPosition(\r\n    x: number,\r\n    y: number,\r\n    width: number,\r\n    height: number,\r\n    minVisible: number = 0,\r\n  ): { x: number; y: number; clamped: boolean } {\r\n    const top = this._top();\r\n    const viewportWidth = top.innerWidth || top.document.documentElement.clientWidth || width;\r\n    const viewportHeight = top.innerHeight || top.document.documentElement.clientHeight || height;\r\n\r\n    const safeWidth = Number.isFinite(width) && width > 0 ? width : viewportWidth;\r\n    const safeHeight = Number.isFinite(height) && height > 0 ? height : viewportHeight;\r\n    const safeMinVisibleX = Math.max(0, Math.min(minVisible, safeWidth, viewportWidth));\r\n    const safeMinVisibleY = Math.max(0, Math.min(minVisible, safeHeight, viewportHeight));\r\n\r\n    const minX = Math.min(0, -safeWidth + safeMinVisibleX);\r\n    const minY = Math.min(0, -safeHeight + safeMinVisibleY);\r\n    const maxX = Math.max(0, viewportWidth - safeMinVisibleX);\r\n    const maxY = Math.max(0, viewportHeight - safeMinVisibleY);\r\n    const safeX = Number.isFinite(x) ? x : 0;\r\n    const safeY = Number.isFinite(y) ? y : 0;\r\n    const clampedX = Math.min(Math.max(safeX, minX), maxX);\r\n    const clampedY = Math.min(Math.max(safeY, minY), maxY);\r\n    return { x: clampedX, y: clampedY, clamped: clampedX !== safeX || clampedY !== safeY };\r\n  },\r\n\r\n  _shouldClampCurrentPosition(): boolean {\r\n    if (!this.container) return false;\r\n    if (this.mountMode === 'preview') return false;\r\n\r\n    //  right/bottom  resize  left/top\r\n    const hasCustom = this.container.style.right === 'auto' || this.container.style.bottom === 'auto';\r\n    const hasExplicitLeftTop = !!this.container.style.left || !!this.container.style.top;\r\n    return hasCustom || hasExplicitLeftTop;\r\n  },\r\n\r\n  _getContainerRectSize(options: { width: number; height: number }): { width: number; height: number } {\r\n    const rect = this.container?.getBoundingClientRect?.();\r\n    return {\r\n      width: rect?.width && rect.width > 0 ? rect.width : options.width,\r\n      height: rect?.height && rect.height > 0 ? rect.height : options.height,\r\n    };\r\n  },\r\n\r\n  _isRectFullyOutsideViewport(rect: DOMRect): boolean {\r\n    const top = this._top();\r\n    const viewportWidth = top.innerWidth || top.document.documentElement.clientWidth || 0;\r\n    const viewportHeight = top.innerHeight || top.document.documentElement.clientHeight || 0;\r\n    if (viewportWidth <= 0 || viewportHeight <= 0) return false;\r\n    return rect.right <= 0 || rect.bottom <= 0 || rect.left >= viewportWidth || rect.top >= viewportHeight;\r\n  },\r\n\r\n  _getVisibleAreaRatio(rect: DOMRect, viewportWidth: number, viewportHeight: number): number {\r\n    const rectWidth = Number.isFinite(rect.width) ? rect.width : 0;\r\n    const rectHeight = Number.isFinite(rect.height) ? rect.height : 0;\r\n    if (rectWidth <= 0 || rectHeight <= 0) return 1;\r\n    if (viewportWidth <= 0 || viewportHeight <= 0) return 1;\r\n\r\n    const visibleLeft = Math.max(0, rect.left);\r\n    const visibleTop = Math.max(0, rect.top);\r\n    const visibleRight = Math.min(viewportWidth, rect.right);\r\n    const visibleBottom = Math.min(viewportHeight, rect.bottom);\r\n    const visibleWidth = Math.max(0, visibleRight - visibleLeft);\r\n    const visibleHeight = Math.max(0, visibleBottom - visibleTop);\r\n    const visibleArea = visibleWidth * visibleHeight;\r\n    const totalArea = rectWidth * rectHeight;\r\n    if (totalArea <= 0) return 1;\r\n\r\n    return Math.max(0, Math.min(1, visibleArea / totalArea));\r\n  },\r\n\r\n  _clampPositionByAxis(value: number, size: number, viewportSize: number, minVisible: number): number {\r\n    const safeSize = Number.isFinite(size) && size > 0 ? size : viewportSize;\r\n    const safeViewport = Number.isFinite(viewportSize) && viewportSize > 0 ? viewportSize : safeSize;\r\n    const safeMinVisible = Math.max(0, Math.min(minVisible, safeSize, safeViewport));\r\n    const min = Math.min(0, -safeSize + safeMinVisible);\r\n    const max = Math.max(0, safeViewport - safeMinVisible);\r\n    const safeValue = Number.isFinite(value) ? value : 0;\r\n    return Math.min(Math.max(safeValue, min), max);\r\n  },\r\n\r\n  _clampContainerToViewport(options: { width: number; height: number }, reason: string): void {\r\n    if (!this.container) return;\r\n    const rect = this.container.getBoundingClientRect();\r\n    const size = this._getContainerRectSize(options);\r\n    const top = this._top();\r\n    const viewportWidth = top.innerWidth || top.document.documentElement.clientWidth || size.width;\r\n    const viewportHeight = top.innerHeight || top.document.documentElement.clientHeight || size.height;\r\n    const shouldClamp = this._shouldClampCurrentPosition();\r\n    const fullyOutside = this._isRectFullyOutsideViewport(rect);\r\n    const visibleRatio = this._getVisibleAreaRatio(rect, viewportWidth, viewportHeight);\r\n    const isResizeClamp = reason.includes('resize');\r\n    const forceFullVisible = (fullyOutside || isResizeClamp) && visibleRatio < 0.72;\r\n    if (!shouldClamp && !fullyOutside && !forceFullVisible) return;\r\n\r\n    const minVisibleX = forceFullVisible\r\n      ? Math.min(size.width, viewportWidth)\r\n      : Math.max(0, Math.min(this._minVisiblePx, size.width, viewportWidth));\r\n    const minVisibleY = forceFullVisible\r\n      ? Math.min(size.height, viewportHeight)\r\n      : Math.max(0, Math.min(this._minVisiblePx, size.height, viewportHeight));\r\n\r\n    const nextX = this._clampPositionByAxis(rect.left, size.width, viewportWidth, minVisibleX);\r\n    const nextY = this._clampPositionByAxis(rect.top, size.height, viewportHeight, minVisibleY);\r\n    const hasPositionChange = Math.abs(nextX - rect.left) > 0.5 || Math.abs(nextY - rect.top) > 0.5;\r\n    if (!hasPositionChange) return;\r\n\r\n    this.container.style.left = `${nextX}px`;\r\n    this.container.style.top = `${nextY}px`;\r\n    this.container.style.right = 'auto';\r\n    this.container.style.bottom = 'auto';\r\n\r\n    const now = Date.now();\r\n    if (now - this._lastClampLogAt > 600) {\r\n      this._lastClampLogAt = now;\r\n      log(`(${reason})`, {\r\n        from: { x: rect.left, y: rect.top },\r\n        to: { x: nextX, y: nextY },\r\n        fullyOutside,\r\n        visibleRatio,\r\n        forceFullVisible,\r\n      });\r\n    }\r\n\r\n    this._onPositionChange?.(nextX, nextY);\r\n  },\r\n\r\n  _bindWindowResize(options: { width: number; height: number }): void {\r\n    const top = this._top();\r\n    this._unbindWindowResize();\r\n\r\n    this._boundWindowResize = () => {\r\n      this._clampContainerToViewport(options, 'window-resize');\r\n    };\r\n\r\n    try {\r\n      top.addEventListener('resize', this._boundWindowResize, { passive: true });\r\n    } catch (e) {\r\n      warn(' window.resize ', e);\r\n      this._boundWindowResize = null;\r\n    }\r\n  },\r\n\r\n  _unbindWindowResize(): void {\r\n    const top = this._top();\r\n    if (!this._boundWindowResize) return;\r\n    try {\r\n      top.removeEventListener('resize', this._boundWindowResize);\r\n    } catch {\r\n      // ignore\r\n    } finally {\r\n      this._boundWindowResize = null;\r\n    }\r\n  },\r\n\r\n  /**  */\r\n  _top(): Window {\r\n    return window.parent ?? window;\r\n  },\r\n\r\n  /**  PIXI */\r\n  _getPIXI(): any {\r\n    const top = this._top();\r\n    return Live2DLoader.getPixi(top);\r\n  },\r\n\r\n  _measureOpaqueBoundsFromCanvas(\r\n    containerWidth: number,\r\n    containerHeight: number,\r\n  ): { left: number; top: number; width: number; height: number } | null {\r\n    const gl = this.glContext;\r\n    if (!gl) return null;\r\n\r\n    const bufferWidth = gl.drawingBufferWidth;\r\n    const bufferHeight = gl.drawingBufferHeight;\r\n    if (bufferWidth <= 0 || bufferHeight <= 0) return null;\r\n\r\n    const byteLength = bufferWidth * bufferHeight * 4;\r\n    if (!this._pixelReadBuffer || this._pixelReadBuffer.length !== byteLength) {\r\n      this._pixelReadBuffer = new Uint8Array(byteLength);\r\n    }\r\n    const pixels = this._pixelReadBuffer;\r\n\r\n    try {\r\n      gl.readPixels(0, 0, bufferWidth, bufferHeight, gl.RGBA, gl.UNSIGNED_BYTE, pixels);\r\n    } catch {\r\n      return null;\r\n    }\r\n\r\n    const scanStep = Math.max(1, Math.floor(Math.sqrt((bufferWidth * bufferHeight) / this._maxPixelScanSamples)));\r\n    const alphaThreshold = Math.max(0, Math.min(255, this._alphaHitThreshold));\r\n\r\n    let minX = bufferWidth;\r\n    let minY = bufferHeight;\r\n    let maxX = -1;\r\n    let maxY = -1;\r\n\r\n    for (let y = 0; y < bufferHeight; y += scanStep) {\r\n      const rowOffset = y * bufferWidth * 4;\r\n      for (let x = 0; x < bufferWidth; x += scanStep) {\r\n        const alpha = pixels[rowOffset + x * 4 + 3];\r\n        if (alpha <= alphaThreshold) continue;\r\n\r\n        if (x < minX) minX = x;\r\n        if (y < minY) minY = y;\r\n        if (x > maxX) maxX = x;\r\n        if (y > maxY) maxY = y;\r\n      }\r\n    }\r\n\r\n    if (maxX < 0 || maxY < 0) return null;\r\n\r\n    if (scanStep > 1) {\r\n      maxX = Math.min(bufferWidth - 1, maxX + scanStep);\r\n      maxY = Math.min(bufferHeight - 1, maxY + scanStep);\r\n    }\r\n\r\n    const scaleX = containerWidth / bufferWidth;\r\n    const scaleY = containerHeight / bufferHeight;\r\n    const left = Math.max(0, Math.floor(minX * scaleX));\r\n    const right = Math.min(Math.ceil(containerWidth), Math.ceil((maxX + 1) * scaleX));\r\n    const top = Math.max(0, Math.floor(containerHeight - (maxY + 1) * scaleY));\r\n    const bottom = Math.min(Math.ceil(containerHeight), Math.ceil(containerHeight - minY * scaleY));\r\n    const width = right - left;\r\n    const height = bottom - top;\r\n    if (width < 8 || height < 8) return null;\r\n\r\n    return { left, top, width, height };\r\n  },\r\n\r\n  _syncInteractionLayerBounds(): void {\r\n    if (!this.container || !this.interactionLayer) return;\r\n\r\n    const layer = this.interactionLayer;\r\n    const container = this.container;\r\n    const disableLayer = () => {\r\n      layer.style.left = '0px';\r\n      layer.style.top = '0px';\r\n      layer.style.width = '100%';\r\n      layer.style.height = '100%';\r\n      layer.style.pointerEvents = 'none';\r\n      layer.style.cursor = 'default';\r\n    };\r\n\r\n    if (this.mountMode === 'preview') {\r\n      disableLayer();\r\n      return;\r\n    }\r\n\r\n    const rect = container.getBoundingClientRect();\r\n    const containerWidth =\r\n      rect.width > 0 ? rect.width : Number.parseFloat(String(container.style.width || '').replace('px', ''));\r\n    const containerHeight =\r\n      rect.height > 0 ? rect.height : Number.parseFloat(String(container.style.height || '').replace('px', ''));\r\n\r\n    if (!Number.isFinite(containerWidth) || !Number.isFinite(containerHeight) || containerWidth <= 0 || containerHeight <= 0) {\r\n      return;\r\n    }\r\n\r\n    const applyBounds = (left: number, top: number, width: number, height: number): boolean => {\r\n      const padding = Math.max(0, this._interactionPaddingPx);\r\n      const x1 = Math.max(0, Math.floor(left - padding));\r\n      const y1 = Math.max(0, Math.floor(top - padding));\r\n      const x2 = Math.min(Math.ceil(containerWidth), Math.ceil(left + width + padding));\r\n      const y2 = Math.min(Math.ceil(containerHeight), Math.ceil(top + height + padding));\r\n      const w = x2 - x1;\r\n      const h = y2 - y1;\r\n      if (w < 16 || h < 16) return false;\r\n\r\n      layer.style.left = `${x1}px`;\r\n      layer.style.top = `${y1}px`;\r\n      layer.style.width = `${w}px`;\r\n      layer.style.height = `${h}px`;\r\n      layer.style.pointerEvents = 'auto';\r\n      layer.style.cursor = 'pointer';\r\n      return true;\r\n    };\r\n\r\n    const model = this.app?.stage?.children?.[0] as any;\r\n    if (!model) {\r\n      disableLayer();\r\n      return;\r\n    }\r\n\r\n    const alphaBounds = this._measureOpaqueBoundsFromCanvas(containerWidth, containerHeight);\r\n    if (alphaBounds) {\r\n      const suspiciouslyHuge =\r\n        alphaBounds.width >= containerWidth * 0.95 && alphaBounds.height >= containerHeight * 0.95;\r\n      if (!suspiciouslyHuge && applyBounds(alphaBounds.left, alphaBounds.top, alphaBounds.width, alphaBounds.height)) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    if (typeof model.getBounds === 'function') {\r\n      try {\r\n        const bounds = model.getBounds();\r\n        const x = Number(bounds?.x);\r\n        const y = Number(bounds?.y);\r\n        const width = Number(bounds?.width);\r\n        const height = Number(bounds?.height);\r\n        const isValid =\r\n          Number.isFinite(x) &&\r\n          Number.isFinite(y) &&\r\n          Number.isFinite(width) &&\r\n          Number.isFinite(height) &&\r\n          width > 0 &&\r\n          height > 0;\r\n        if (isValid) {\r\n          const suspiciouslyHuge = width >= containerWidth * 0.95 && height >= containerHeight * 0.95;\r\n          if (!suspiciouslyHuge && applyBounds(x, y, width, height)) {\r\n            return;\r\n          }\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    const fallbackWidth = Math.max(80, Math.round(containerWidth * 0.62));\r\n    const fallbackHeight = Math.max(120, Math.round(containerHeight * 0.88));\r\n    const fallbackLeft = Math.max(0, Math.round((containerWidth - fallbackWidth) / 2));\r\n    const fallbackTop = Math.max(0, Math.round(containerHeight - fallbackHeight));\r\n    if (!applyBounds(fallbackLeft, fallbackTop, fallbackWidth, fallbackHeight)) {\r\n      disableLayer();\r\n      return;\r\n    }\r\n  },\r\n\r\n  _startInteractionSyncTimer(): void {\r\n    this._stopInteractionSyncTimer();\r\n    this._syncInteractionLayerBounds();\r\n    this._interactionSyncTimer = window.setInterval(() => {\r\n      this._syncInteractionLayerBounds();\r\n    }, 250);\r\n  },\r\n\r\n  _stopInteractionSyncTimer(): void {\r\n    if (this._interactionSyncTimer === null) return;\r\n    window.clearInterval(this._interactionSyncTimer);\r\n    this._interactionSyncTimer = null;\r\n  },\r\n\r\n  _enablePointerDrag(\r\n    $container: JQuery<HTMLElement>,\r\n    options: {\r\n      width: number;\r\n      height: number;\r\n      onPositionChange?: (x: number, y: number) => void;\r\n    },\r\n  ): void {\r\n    if (!this.container) return;\r\n\r\n    const top = this._top();\r\n    const container = this.container;\r\n    const dragTarget = this.interactionLayer ?? container;\r\n    const onPositionChange = options.onPositionChange;\r\n\r\n    const state = {\r\n      pointerId: null as number | null,\r\n      startClientX: 0,\r\n      startClientY: 0,\r\n      startLeft: 0,\r\n      startTop: 0,\r\n      dragging: false,\r\n      touchPointerIds: new Set<number>(),\r\n    };\r\n\r\n    const getRectLeftTop = () => {\r\n      const rect = container.getBoundingClientRect();\r\n      return { left: rect.left, top: rect.top };\r\n    };\r\n\r\n    const getRectSize = () => {\r\n      const rect = container.getBoundingClientRect();\r\n      return {\r\n        width: rect.width > 0 ? rect.width : options.width,\r\n        height: rect.height > 0 ? rect.height : options.height,\r\n      };\r\n    };\r\n\r\n    const cleanup = () => {\r\n      state.pointerId = null;\r\n      state.dragging = false;\r\n      $container.removeClass(this._dragClass);\r\n    };\r\n\r\n    dragTarget.addEventListener('pointerdown', (e: PointerEvent) => {\r\n      if (e.button !== 0) return;\r\n      if (e.pointerType === 'touch') {\r\n        state.touchPointerIds.add(e.pointerId);\r\n        if (state.touchPointerIds.size > 1) {\r\n          cleanup();\r\n          return;\r\n        }\r\n      }\r\n      if (state.pointerId !== null) return;\r\n\r\n      state.pointerId = e.pointerId;\r\n      state.startClientX = e.clientX;\r\n      state.startClientY = e.clientY;\r\n\r\n      const { left, top } = getRectLeftTop();\r\n      state.startLeft = left;\r\n      state.startTop = top;\r\n\r\n      try {\r\n        dragTarget.setPointerCapture(e.pointerId);\r\n      } catch {\r\n        // ignore\r\n      }\r\n    });\r\n\r\n    dragTarget.addEventListener('pointermove', (e: PointerEvent) => {\r\n      if (state.pointerId === null || e.pointerId !== state.pointerId) return;\r\n      if (e.pointerType === 'touch' && state.touchPointerIds.size > 1) {\r\n        cleanup();\r\n        return;\r\n      }\r\n\r\n      const dx = e.clientX - state.startClientX;\r\n      const dy = e.clientY - state.startClientY;\r\n      const dist = Math.sqrt(dx * dx + dy * dy);\r\n\r\n      if (!state.dragging) {\r\n        if (dist < 8) return;\r\n        state.dragging = true;\r\n        $container.addClass(this._dragClass);\r\n\r\n        container.style.left = `${state.startLeft}px`;\r\n        container.style.top = `${state.startTop}px`;\r\n        container.style.right = 'auto';\r\n        container.style.bottom = 'auto';\r\n      }\r\n\r\n      const clamped = this._clampPosition(\r\n        state.startLeft + dx,\r\n        state.startTop + dy,\r\n        getRectSize().width,\r\n        getRectSize().height,\r\n        this._minVisiblePx,\r\n      );\r\n\r\n      container.style.left = `${clamped.x}px`;\r\n      container.style.top = `${clamped.y}px`;\r\n      container.style.right = 'auto';\r\n      container.style.bottom = 'auto';\r\n      e.preventDefault();\r\n    }, { passive: false });\r\n\r\n    const onPointerUp = (e: PointerEvent) => {\r\n      if (e.pointerType === 'touch') {\r\n        state.touchPointerIds.delete(e.pointerId);\r\n      }\r\n      if (state.pointerId === null || e.pointerId !== state.pointerId) return;\r\n\r\n      const dragging = state.dragging;\r\n      cleanup();\r\n\r\n      if (!dragging) return;\r\n\r\n      const left = parseFloat(container.style.left || '0');\r\n      const topPx = parseFloat(container.style.top || '0');\r\n      const size = getRectSize();\r\n      const clamped = this._clampPosition(left, topPx, size.width, size.height, this._minVisiblePx);\r\n\r\n      container.style.left = `${clamped.x}px`;\r\n      container.style.top = `${clamped.y}px`;\r\n      container.style.right = 'auto';\r\n      container.style.bottom = 'auto';\r\n\r\n      this._onPositionChange = onPositionChange ?? this._onPositionChange;\r\n      this._onPositionChange?.(clamped.x, clamped.y);\r\n\r\n      try {\r\n        dragTarget.releasePointerCapture(e.pointerId);\r\n      } catch {\r\n        // ignore\r\n      }\r\n\r\n      // iOS  pointerup  selection\r\n      try {\r\n        top.getSelection?.()?.removeAllRanges?.();\r\n      } catch {\r\n        // ignore\r\n      }\r\n    };\r\n\r\n    dragTarget.addEventListener('pointerup', onPointerUp);\r\n    dragTarget.addEventListener('pointercancel', onPointerUp);\r\n  },\r\n\r\n  _ensureLoadingOverlay(): boolean {\r\n    if (!this.container) return false;\r\n\r\n    const overlay = this.loadingOverlay;\r\n    const overlayAlive = !!overlay && !!overlay.ownerDocument?.documentElement?.contains(overlay);\r\n    if (overlayAlive) return true;\r\n\r\n    this.hideLoadingProgress();\r\n\r\n    const doc = this.container.ownerDocument;\r\n    const panel = doc.createElement('div');\r\n    panel.style.cssText = `\r\n      position: absolute;\r\n      left: 8px;\r\n      right: 8px;\r\n      bottom: 8px;\r\n      padding: 8px 10px;\r\n      border-radius: 8px;\r\n      background: rgba(15, 23, 42, 0.72);\r\n      backdrop-filter: blur(3px);\r\n      pointer-events: none;\r\n      z-index: 5;\r\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);\r\n      color: #e2e8f0;\r\n      font-size: 12px;\r\n      line-height: 1.4;\r\n    `;\r\n\r\n    const text = doc.createElement('div');\r\n    text.style.cssText = 'margin-bottom: 6px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;';\r\n    text.textContent = ' (0%)';\r\n\r\n    const track = doc.createElement('div');\r\n    track.style.cssText = 'width: 100%; height: 6px; border-radius: 999px; background: rgba(148, 163, 184, 0.35); overflow: hidden;';\r\n\r\n    const fill = doc.createElement('div');\r\n    fill.style.cssText = 'height: 100%; width: 0%; border-radius: 999px; background: linear-gradient(90deg, #60a5fa, #22d3ee); transition: width 0.2s ease;';\r\n\r\n    track.appendChild(fill);\r\n    panel.appendChild(text);\r\n    panel.appendChild(track);\r\n    this.container.appendChild(panel);\r\n\r\n    this.loadingOverlay = panel;\r\n    this.loadingText = text;\r\n    this.loadingBarFill = fill;\r\n    return true;\r\n  },\r\n\r\n  showLoadingProgress(percent: number, message: string): void {\r\n    if (!this._ensureLoadingOverlay()) return;\r\n\r\n    const safePercent = Math.max(0, Math.min(100, Math.round(percent)));\r\n    if (this.loadingText) {\r\n      this.loadingText.textContent = `${message} (${safePercent}%)`;\r\n    }\r\n    if (this.loadingBarFill) {\r\n      this.loadingBarFill.style.width = `${safePercent}%`;\r\n    }\r\n  },\r\n\r\n  hideLoadingProgress(): void {\r\n    if (this.loadingOverlay) {\r\n      try {\r\n        this.loadingOverlay.remove();\r\n      } catch (e) {\r\n        warn('Failed to remove loading progress overlay', e);\r\n      }\r\n    }\r\n    this.loadingOverlay = null;\r\n    this.loadingText = null;\r\n    this.loadingBarFill = null;\r\n  },\r\n\r\n  /**\r\n   *  PIXI Application\r\n   */\r\n  create(options: {\r\n    width: number;\r\n    height: number;\r\n    position: { x: number; y: number };\r\n    scale: number;\r\n    onPositionChange?: (x: number, y: number) => void;\r\n    onScaleChange?: (scale: number) => void;\r\n    onTap?: (e: GestureEvent) => void;\r\n    onDoubleTap?: (e: GestureEvent) => void;\r\n    onLongPress?: (e: GestureEvent) => void;\r\n  }): boolean {\r\n    const top = this._top();\r\n    const PIXI = this._getPIXI();\r\n    if (!PIXI) {\r\n      warn('PIXI ');\r\n      return false;\r\n    }\r\n\r\n    // \r\n    this.destroy();\r\n    this._onPositionChange = options.onPositionChange ?? null;\r\n    this._bindWindowResize({ width: options.width, height: options.height });\r\n    const stale = top.document.getElementById('desktop-pet-stage');\r\n    if (stale) stale.remove();\r\n\r\n    //  div\r\n    this.container = top.document.createElement('div');\r\n    this.container.id = 'desktop-pet-stage';\r\n    this.container.style.cssText = `\r\n      position: fixed;\r\n      right: 20px;\r\n      bottom: 20px;\r\n      width: ${options.width}px;\r\n      height: ${options.height}px;\r\n      overflow: hidden;\r\n      z-index: 10000;\r\n      pointer-events: none;\r\n      cursor: default;\r\n      touch-action: none;\r\n    `;\r\n\r\n    // Apply persisted position.\r\n    const hasSavedPosition =\r\n      Number.isFinite(options.position.x) &&\r\n      Number.isFinite(options.position.y) &&\r\n      !(options.position.x === -1 && options.position.y === -1);\r\n\r\n    if (hasSavedPosition) {\r\n      const clamped = this._clampPosition(\r\n        options.position.x,\r\n        options.position.y,\r\n        options.width,\r\n        options.height,\r\n        this._minVisiblePx,\r\n      );\r\n\r\n      this.container.style.left = `${clamped.x}px`;\r\n      this.container.style.top = `${clamped.y}px`;\r\n      this.container.style.right = 'auto';\r\n      this.container.style.bottom = 'auto';\r\n\r\n      if (clamped.clamped) {\r\n        log('', {\r\n          from: options.position,\r\n          to: { x: clamped.x, y: clamped.y },\r\n        });\r\n        options.onPositionChange?.(clamped.x, clamped.y);\r\n      }\r\n    }\r\n\r\n    top.document.body.appendChild(this.container);\r\n\r\n    //  canvas\r\n    this.canvas = top.document.createElement('canvas');\r\n    this.canvas.style.cssText = 'width: 100%; height: 100%; pointer-events: none;';\r\n    this.container.appendChild(this.canvas);\r\n\r\n    this.interactionLayer = top.document.createElement('div');\r\n    this.interactionLayer.className = 'desktop-pet-interaction-layer';\r\n    this.interactionLayer.style.cssText = `\r\n      position: absolute;\r\n      left: 0;\r\n      top: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n      pointer-events: auto;\r\n      cursor: pointer;\r\n      touch-action: none;\r\n      z-index: 4;\r\n    `;\r\n    this.container.appendChild(this.interactionLayer);\r\n\r\n    //  PIXI Application\r\n    const dpr = top.devicePixelRatio || 1;\r\n    this.canvas.width = Math.floor(options.width * dpr);\r\n    this.canvas.height = Math.floor(options.height * dpr);\r\n\r\n    const glContext =\r\n      this.canvas.getContext('webgl2', {\r\n        alpha: true,\r\n        antialias: true,\r\n        stencil: true,\r\n        depth: true,\r\n        preserveDrawingBuffer: true,\r\n        premultipliedAlpha: true,\r\n      }) ||\r\n      this.canvas.getContext('webgl', {\r\n        alpha: true,\r\n        antialias: true,\r\n        stencil: true,\r\n        depth: true,\r\n        preserveDrawingBuffer: true,\r\n        premultipliedAlpha: true,\r\n      });\r\n\r\n    if (!glContext) {\r\n      warn('WebGL is unavailable');\r\n      return false;\r\n    }\r\n    this.glContext = glContext as WebGLRenderingContext | WebGL2RenderingContext;\r\n    this._pixelReadBuffer = null;\r\n\r\n    try {\r\n      const attrs = (glContext as WebGLRenderingContext | WebGL2RenderingContext).getContextAttributes?.();\r\n      if (attrs && attrs.stencil === false) {\r\n        warn('Current WebGL context has no stencil buffer; mask rendering may be abnormal');\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    this.app = new PIXI.Application({\r\n      view: this.canvas,\r\n      context: glContext,\r\n      backgroundAlpha: 0,\r\n      autoStart: true,\r\n      width: options.width,\r\n      height: options.height,\r\n      resolution: dpr,\r\n      autoDensity: true,\r\n      antialias: true,\r\n    });\r\n\r\n    //  jQueryUI \r\n    const $container = $(this.container);\r\n    const draggable = ($container as any).draggable;\r\n    if (typeof draggable === 'function') {\r\n      try {\r\n        $container.draggable({\r\n          handle: '.desktop-pet-interaction-layer',\r\n          start: (_e: any, ui: any) => {\r\n            $container.addClass(this._dragClass);\r\n\r\n            const rect = this.container?.getBoundingClientRect?.();\r\n            if (!rect) return;\r\n\r\n            this.container!.style.left = `${rect.left}px`;\r\n            this.container!.style.top = `${rect.top}px`;\r\n            this.container!.style.right = 'auto';\r\n            this.container!.style.bottom = 'auto';\r\n\r\n            if (ui?.position) {\r\n              ui.position.left = rect.left;\r\n              ui.position.top = rect.top;\r\n            }\r\n          },\r\n          drag: (_e: any, ui: any) => {\r\n            const rect = this.container?.getBoundingClientRect?.();\r\n            const width = rect?.width && rect.width > 0 ? rect.width : options.width;\r\n            const height = rect?.height && rect.height > 0 ? rect.height : options.height;\r\n\r\n            const clamped = this._clampPosition(ui.position.left, ui.position.top, width, height, this._minVisiblePx);\r\n            ui.position.left = clamped.x;\r\n            ui.position.top = clamped.y;\r\n          },\r\n          stop: (_e: any, ui: any) => {\r\n            $container.removeClass(this._dragClass);\r\n\r\n            const rect = this.container?.getBoundingClientRect?.();\r\n            const width = rect?.width && rect.width > 0 ? rect.width : options.width;\r\n            const height = rect?.height && rect.height > 0 ? rect.height : options.height;\r\n\r\n            const clamped = this._clampPosition(\r\n              ui.position.left,\r\n              ui.position.top,\r\n              width,\r\n              height,\r\n              this._minVisiblePx,\r\n            );\r\n\r\n            this.container!.style.left = `${clamped.x}px`;\r\n            this.container!.style.top = `${clamped.y}px`;\r\n            this.container!.style.right = 'auto';\r\n            this.container!.style.bottom = 'auto';\r\n\r\n            this._onPositionChange?.(clamped.x, clamped.y);\r\n          },\r\n        });\r\n      } catch (e) {\r\n        warn('Failed to initialize jQueryUI draggable, fallback to native pointer drag', e);\r\n        this._enablePointerDrag($container, {\r\n          width: options.width,\r\n          height: options.height,\r\n          onPositionChange: options.onPositionChange,\r\n        });\r\n      }\r\n    } else {\r\n      warn('jQueryUI draggable not found, fallback to native pointer drag');\r\n      this._enablePointerDrag($container, {\r\n        width: options.width,\r\n        height: options.height,\r\n        onPositionChange: options.onPositionChange,\r\n      });\r\n    }\r\n\r\n    // Mouse wheel + touch pinch zoom.\r\n    const interactionTarget = this.interactionLayer ?? this.container;\r\n    const SCALE_MIN = 0.1;\r\n    const SCALE_MAX = 3;\r\n    const SCALE_EPSILON = 0.002;\r\n    let currentScale = Number.isFinite(options.scale) ? options.scale : 1;\r\n    let isPinching = false;\r\n    let pinchStartDistance = 0;\r\n    let pinchStartScale = currentScale;\r\n    const activeTouchPointers = new Map<number, { x: number; y: number }>();\r\n\r\n    const emitScaleChange = (nextScale: number) => {\r\n      const safeScale = Math.max(SCALE_MIN, Math.min(SCALE_MAX, nextScale));\r\n      if (Math.abs(safeScale - currentScale) < SCALE_EPSILON) return;\r\n      currentScale = safeScale;\r\n      options.scale = safeScale;\r\n      options.onScaleChange?.(safeScale);\r\n    };\r\n\r\n    const getPinchDistance = () => {\r\n      if (activeTouchPointers.size < 2) return 0;\r\n      const points = Array.from(activeTouchPointers.values());\r\n      const a = points[0];\r\n      const b = points[1];\r\n      const dx = a.x - b.x;\r\n      const dy = a.y - b.y;\r\n      return Math.sqrt(dx * dx + dy * dy);\r\n    };\r\n\r\n    const setDraggableState = (enabled: boolean) => {\r\n      if (typeof draggable !== 'function') return;\r\n      try {\r\n        $container.draggable(enabled ? 'enable' : 'disable');\r\n      } catch {\r\n        // ignore\r\n      }\r\n    };\r\n\r\n    const onTouchPointerDown = (e: PointerEvent) => {\r\n      if (e.pointerType !== 'touch') return;\r\n      activeTouchPointers.set(e.pointerId, { x: e.clientX, y: e.clientY });\r\n      if (activeTouchPointers.size < 2) return;\r\n\r\n      const distance = getPinchDistance();\r\n      if (distance <= 0) return;\r\n\r\n      if (!isPinching) {\r\n        isPinching = true;\r\n        setDraggableState(false);\r\n      }\r\n      pinchStartDistance = distance;\r\n      pinchStartScale = currentScale;\r\n      e.preventDefault();\r\n    };\r\n\r\n    const onTouchPointerMove = (e: PointerEvent) => {\r\n      if (e.pointerType !== 'touch') return;\r\n      if (!activeTouchPointers.has(e.pointerId)) return;\r\n\r\n      activeTouchPointers.set(e.pointerId, { x: e.clientX, y: e.clientY });\r\n      if (!isPinching || activeTouchPointers.size < 2) return;\r\n\r\n      const distance = getPinchDistance();\r\n      if (distance <= 0 || pinchStartDistance <= 0) return;\r\n\r\n      const ratio = distance / pinchStartDistance;\r\n      emitScaleChange(pinchStartScale * ratio);\r\n      e.preventDefault();\r\n    };\r\n\r\n    const onTouchPointerEnd = (e: PointerEvent) => {\r\n      if (e.pointerType !== 'touch') return;\r\n      activeTouchPointers.delete(e.pointerId);\r\n\r\n      if (activeTouchPointers.size >= 2) {\r\n        const distance = getPinchDistance();\r\n        if (distance > 0) {\r\n          pinchStartDistance = distance;\r\n          pinchStartScale = currentScale;\r\n        }\r\n        return;\r\n      }\r\n\r\n      pinchStartDistance = 0;\r\n      pinchStartScale = currentScale;\r\n      if (isPinching) {\r\n        isPinching = false;\r\n        setDraggableState(true);\r\n      }\r\n    };\r\n\r\n    interactionTarget.addEventListener('pointerdown', onTouchPointerDown, { passive: false });\r\n    interactionTarget.addEventListener('pointermove', onTouchPointerMove, { passive: false });\r\n    interactionTarget.addEventListener('pointerup', onTouchPointerEnd);\r\n    interactionTarget.addEventListener('pointercancel', onTouchPointerEnd);\r\n\r\n    interactionTarget.addEventListener('wheel', (e: WheelEvent) => {\r\n      e.preventDefault();\r\n      const delta = e.deltaY > 0 ? -0.05 : 0.05;\r\n      emitScaleChange(currentScale + delta);\r\n    }, { passive: false });\r\n\r\n    // Gesture recognizer (replaces raw click handler).\r\n    this.gestureRecognizer = new GestureRecognizer(\r\n      interactionTarget,\r\n      {},\r\n      (event: GestureEvent) => {\r\n        switch (event.type) {\r\n          case 'tap':\r\n            options.onTap?.(event);\r\n            break;\r\n          case 'double-tap':\r\n            options.onDoubleTap?.(event);\r\n            break;\r\n          case 'long-press':\r\n            options.onLongPress?.(event);\r\n            break;\r\n        }\r\n      },\r\n      () =>\r\n        isPinching ||\r\n        $container.hasClass('ui-draggable-dragging') ||\r\n        $container.hasClass(this._dragClass),\r\n    );\r\n    this._startInteractionSyncTimer();\r\n\r\n    log('Live2D ');\r\n    return true;\r\n  },\r\n\r\n  /**\r\n   *  PIXI Application  stage\r\n   */\r\n  getStage(): any {\r\n    return this.app?.stage;\r\n  },\r\n\r\n  /**\r\n   * \r\n   */\r\n  isPreviewMounted(): boolean {\r\n    return this.mountMode === 'preview';\r\n  },\r\n\r\n  pushMount(mountEl: HTMLElement | null): boolean {\r\n    if (!this.container || !this.app || !this.canvas) return false;\r\n    if (!mountEl || !mountEl.isConnected) return false;\r\n\r\n    const top = this._top();\r\n\r\n    const rect = this.container.getBoundingClientRect?.();\r\n    const width =\r\n      rect?.width && rect.width > 0\r\n        ? Math.round(rect.width)\r\n        : Number(String(this.container.style.width || '').replace('px', '')) || 1;\r\n    const height =\r\n      rect?.height && rect.height > 0\r\n        ? Math.round(rect.height)\r\n        : Number(String(this.container.style.height || '').replace('px', '')) || 1;\r\n\r\n    this.mountStack.push({\r\n      parent: this.container.parentNode,\r\n      nextSibling: this.container.nextSibling,\r\n      styleText: this.container.style.cssText,\r\n      width,\r\n      height,\r\n      onPositionChange: this._onPositionChange,\r\n    });\r\n\r\n    try {\r\n      const pos = top.getComputedStyle(mountEl).position;\r\n      if (pos === 'static') {\r\n        mountEl.style.position = 'relative';\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    // \r\n    this._onPositionChange = null;\r\n    this._unbindWindowResize();\r\n\r\n    try {\r\n      mountEl.appendChild(this.container);\r\n    } catch {\r\n      return false;\r\n    }\r\n\r\n    this.mountMode = 'preview';\r\n    this.container.style.cssText = `\r\n      position: absolute;\r\n      inset: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n      overflow: hidden;\r\n      z-index: 1;\r\n      pointer-events: none;\r\n      cursor: default;\r\n      touch-action: none;\r\n    `;\r\n    if (this.interactionLayer) {\r\n      this.interactionLayer.style.left = '0px';\r\n      this.interactionLayer.style.top = '0px';\r\n      this.interactionLayer.style.width = '100%';\r\n      this.interactionLayer.style.height = '100%';\r\n      this.interactionLayer.style.pointerEvents = 'none';\r\n      this.interactionLayer.style.cursor = 'default';\r\n    }\r\n\r\n    try {\r\n      const $container = $(this.container);\r\n      const draggable = ($container as any).draggable;\r\n      if (typeof draggable === 'function') {\r\n        $container.draggable('disable');\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    return true;\r\n  },\r\n\r\n  popMount(): { width: number; height: number } | null {\r\n    if (!this.container || !this.app || !this.canvas) return null;\r\n    const entry = this.mountStack.pop();\r\n    if (!entry) return null;\r\n\r\n    try {\r\n      const parent = entry.parent;\r\n      if (parent) {\r\n        if (entry.nextSibling && entry.nextSibling.parentNode === parent) {\r\n          parent.insertBefore(this.container, entry.nextSibling);\r\n        } else {\r\n          parent.appendChild(this.container);\r\n        }\r\n      } else {\r\n        this._top().document.body.appendChild(this.container);\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    this.container.style.cssText = entry.styleText;\r\n    this._onPositionChange = entry.onPositionChange;\r\n    this.mountMode = this.mountStack.length > 0 ? 'preview' : 'floating';\r\n    this._syncInteractionLayerBounds();\r\n\r\n    try {\r\n      const $container = $(this.container);\r\n      const draggable = ($container as any).draggable;\r\n      if (typeof draggable === 'function') {\r\n        $container.draggable('enable');\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    //  resize clamp\r\n    this._bindWindowResize({ width: entry.width, height: entry.height });\r\n\r\n    const restore = this._pendingFloatingResize ?? { width: entry.width, height: entry.height };\r\n    this._pendingFloatingResize = null;\r\n    this.resize(restore.width, restore.height);\r\n\r\n    return restore;\r\n  },\r\n\r\n  /**\r\n   *  popMount \r\n   */\r\n  resizeFloating(width: number, height: number): void {\r\n    if (this.mountMode === 'preview') {\r\n      this._pendingFloatingResize = { width, height };\r\n      return;\r\n    }\r\n\r\n    if (this.container) {\r\n      this.container.style.width = `${width}px`;\r\n      this.container.style.height = `${height}px`;\r\n      this._clampContainerToViewport({ width, height }, 'stage-resize');\r\n      this._syncInteractionLayerBounds();\r\n    }\r\n    if (this.app) {\r\n      try {\r\n        this.app.renderer.resize(width, height);\r\n      } catch (e) {\r\n        warn('renderer.resize ', e);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  width/height \r\n   */\r\n  resizePreview(width: number, height: number): void {\r\n    if (this.mountMode !== 'preview') return;\r\n    if (!this.app) return;\r\n    try {\r\n      this.app.renderer.resize(width, height);\r\n      this._syncInteractionLayerBounds();\r\n    } catch (e) {\r\n      warn('renderer.resize ', e);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  resizeFloating\r\n   */\r\n  resize(width: number, height: number): void {\r\n    this.resizeFloating(width, height);\r\n  },\r\n\r\n  /**\n   * \n   */\n  destroy(): void {\n    this.hideLoadingProgress();\r\n    this._unbindWindowResize();\r\n    this._stopInteractionSyncTimer();\r\n    this.mountStack = [];\r\n    this.mountMode = 'floating';\r\n    this._pendingFloatingResize = null;\r\n\r\n    if (this.gestureRecognizer) {\r\n      this.gestureRecognizer.destroy();\r\n      this.gestureRecognizer = null;\r\n    }\r\n\r\n    if (this.app) {\r\n      try {\r\n        this.app.destroy(true);\r\n      } catch (e) {\r\n        warn('Failed to destroy PIXI Application', e);\r\n      }\r\n      this.app = null;\r\n    }\r\n    if (this.container) {\r\n      try {\r\n        this.container.remove();\r\n      } catch (e) {\r\n        warn('', e);\r\n      }\r\n      this.container = null;\r\n    }\r\n    this.interactionLayer = null;\r\n    this.canvas = null;\r\n    this.glContext = null;\r\n    this._pixelReadBuffer = null;\r\n  },\r\n};\r\n\r\n","import type { EmotionTag } from '../core/constants';\nimport type { EmotionMotionOverride } from '../core/emotion';\n\nexport const EXPRESSION_LIVE2D_MAP: Record<\n  EmotionTag,\n  {\n    expressions: string[];\n    motions: string[];\n  }\n> = {\n  : {\n    expressions: ['normal', 'default', 'neutral', 'idle', 'base'],\n    motions: ['idle', 'normal', 'wait', 'default', 'stand'],\n  },\n  : {\n    expressions: ['smile', 'happy', 'joy', 'glad', 'pleased'],\n    motions: ['happy', 'smile', 'joy', 'weixiao', 'xiao', ''],\n  },\n  : {\n    expressions: ['angry', 'anger', 'mad', 'rage', 'annoyed'],\n    motions: ['angry', 'rage', 'mad', 'shengqi', 'duqi', ''],\n  },\n  : {\n    expressions: ['sad', 'sorrow', 'cry', 'upset', 'depressed'],\n    motions: ['sad', 'cry', 'sorrow', 'nanguo', 'leiw', ''],\n  },\n  : {\n    expressions: ['surprised', 'shock', 'amazed', 'wow', 'astonished'],\n    motions: ['surprised', 'shock', 'amazed', 'jingya', 'jingxi', ''],\n  },\n  : {\n    expressions: ['smirk', 'mock', 'sneer', 'tease', 'sarcastic'],\n    motions: ['mock', 'tease', 'tiaoxi', ''],\n  },\n  : {\n    expressions: ['shy', 'blush', 'embarrassed', 'bashful', 'timid'],\n    motions: ['shy', 'embarrassed', 'blush', 'haixiu', 'shame', ''],\n  },\n  : {\n    expressions: ['think', 'ponder', 'confused', 'wonder', 'curious'],\n    motions: ['think', 'ponder', 'wonder', 'sikao', ''],\n  },\n  : {\n    expressions: ['laugh', 'lol', 'haha', 'giggle', 'rofl'],\n    motions: ['laugh', 'giggle', 'haha', 'daxiao', 'oowarai', ''],\n  },\n  : {\n    expressions: ['playful', 'wink', 'silly', 'fun', 'mischievous'],\n    motions: ['playful', 'wink', 'fun', 'gaoguai', 'silly', ''],\n  },\n};\n\nfunction uniquePush(list: string[], seen: Set<string>, value: unknown): void {\n  const normalized = String(value ?? '').trim();\n  if (!normalized || seen.has(normalized)) return;\n  seen.add(normalized);\n  list.push(normalized);\n}\n\nfunction uniquePushAllowEmpty(list: string[], seen: Set<string>, value: unknown): void {\n  const raw = String(value ?? '');\n  const normalized = raw.trim();\n  if (!normalized && raw !== '') return;\n  const finalValue = normalized || '';\n  if (seen.has(finalValue)) return;\n  seen.add(finalValue);\n  list.push(finalValue);\n}\n\nexport type Live2DMotionEntry = {\n  group: string;\n  index: number;\n  name: string;\n};\n\nfunction uniqueMotionPush(list: Live2DMotionEntry[], seen: Set<string>, entry: Live2DMotionEntry): void {\n  const group = String(entry.group ?? '');\n  const index = Number.isFinite(entry.index) ? Math.max(0, Math.floor(entry.index)) : 0;\n  const name = String(entry.name ?? '').trim();\n  if (!name) return;\n  const key = `${group}#${index}#${name.toLowerCase()}`;\n  if (seen.has(key)) return;\n  seen.add(key);\n  list.push({ group, index, name });\n}\n\nfunction normalizeFileStem(input: unknown): string {\n  const raw = String(input ?? '').trim();\n  if (!raw) return '';\n\n  const noHash = raw.split('#')[0];\n  const noQuery = noHash.split('?')[0];\n  const filePart = noQuery.split('/').pop() || noQuery;\n  let decoded = filePart;\n  try {\n    decoded = decodeURIComponent(filePart);\n  } catch {\n    // ignore\n  }\n\n  return decoded\n    .replace(/\\.exp3\\.json$/i, '')\n    .replace(/\\.motion3\\.json$/i, '')\n    .replace(/\\.mtn$/i, '')\n    .replace(/\\.json$/i, '')\n    .trim();\n}\n\nfunction normalizeDefinitionName(def: unknown, fallback = ''): string {\n  if (typeof def === 'string') {\n    return normalizeFileStem(def) || def.trim();\n  }\n  if (!def || typeof def !== 'object') {\n    return fallback;\n  }\n\n  const obj = def as any;\n  const directName = obj.Name || obj.name || obj.Id || obj.id || '';\n  if (String(directName ?? '').trim()) {\n    return String(directName).trim();\n  }\n\n  const fileLike = obj.File || obj.file || obj.Path || obj.path || '';\n  const stem = normalizeFileStem(fileLike);\n  if (stem) return stem;\n\n  return fallback;\n}\n\nfunction collectSettingsCandidates(model: any): any[] {\n  const candidates: any[] = [];\n  const seen = new Set<any>();\n\n  const add = (obj: any) => {\n    if (!obj || typeof obj !== 'object') return;\n    if (seen.has(obj)) return;\n    seen.add(obj);\n    candidates.push(obj);\n  };\n\n  const motionManager = model?.internalModel?.motionManager;\n  const settings = model?.internalModel?.settings;\n\n  add(settings);\n  add(settings?.json);\n  add(settings?.rawSettings);\n  add(settings?.modelJson);\n  add(motionManager?.settings);\n  add(motionManager?.settings?.json);\n  add(motionManager?.settings?.rawSettings);\n  add(motionManager?.settings?.modelJson);\n\n  return candidates;\n}\n\nfunction isExpressionFileLike(input: unknown): boolean {\n  const raw = String(input ?? '').trim().toLowerCase();\n  if (!raw) return false;\n  return /\\.exp3\\.json($|[?#])/.test(raw) || /\\.exp\\.json($|[?#])/.test(raw) || /\\.exp($|[?#])/.test(raw);\n}\n\nfunction isMotionFileLike(input: unknown): boolean {\n  const raw = String(input ?? '').trim().toLowerCase();\n  if (!raw) return false;\n  return /\\.motion3\\.json($|[?#])/.test(raw) || /\\.mtn($|[?#])/.test(raw);\n}\n\nfunction isMotionDefinition(node: unknown): boolean {\n  if (typeof node === 'string') {\n    return isMotionFileLike(node);\n  }\n  if (!node || typeof node !== 'object') return false;\n\n  const obj = node as any;\n  const fileLike = obj.File || obj.file || obj.Path || obj.path || '';\n  if (isMotionFileLike(fileLike)) return true;\n\n  const soundLike = obj.Sound || obj.sound || '';\n  if (typeof soundLike === 'string' && soundLike.trim()) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction countMotionDefinitions(list: unknown[]): number {\n  let count = 0;\n  for (const item of list) {\n    if (isMotionDefinition(item)) count++;\n  }\n  return count > 0 ? count : list.length;\n}\n\nfunction mergeGroupCount(target: Record<string, number>, key: unknown, count: unknown): void {\n  const keyRaw = String(key ?? '');\n  const normalized = keyRaw.trim();\n  if (!normalized && keyRaw !== '') return;\n\n  const groupName = normalized || '';\n  const parsedCount = Number(count);\n  const safeCount = Number.isFinite(parsedCount) && parsedCount > 0 ? Math.max(1, Math.floor(parsedCount)) : 1;\n  const prev = target[groupName];\n  target[groupName] = Number.isFinite(prev) && prev > 0 ? Math.max(prev, safeCount) : safeCount;\n}\n\nfunction pushFromContainer(names: string[], seen: Set<string>, container: unknown, fallbackPrefix: string): void {\n  const pushFromList = (list: unknown[], fallbackPrefixInner: string) => {\n    for (let i = 0; i < list.length; i++) {\n      const normalized = normalizeDefinitionName(list[i], `${fallbackPrefixInner}_${i + 1}`);\n      uniquePush(names, seen, normalized);\n    }\n  };\n\n  if (Array.isArray(container)) {\n    pushFromList(container, fallbackPrefix);\n    return;\n  }\n  if (!container || typeof container !== 'object') return;\n\n  let i = 0;\n  for (const [key, value] of Object.entries(container as Record<string, unknown>)) {\n    const fallbackName = normalizeFileStem(key) || String(key || '').trim() || `${fallbackPrefix}_${i + 1}`;\n    const normalized = normalizeDefinitionName(value, fallbackName);\n    uniquePush(names, seen, normalized || fallbackName);\n    i++;\n  }\n}\n\nexport function collectExpressionNamesFromUnknown(raw: unknown): string[] {\n  const names: string[] = [];\n  const seen = new Set<string>();\n  const visited = new Set<any>();\n\n  const visit = (node: unknown, context = ''): void => {\n    if (node == null) return;\n\n    if (typeof node === 'string') {\n      const text = node.trim();\n      if (!text) return;\n      if (isExpressionFileLike(text) || /exp|expression/.test(context)) {\n        uniquePush(names, seen, normalizeFileStem(text) || text);\n      }\n      return;\n    }\n\n    if (Array.isArray(node)) {\n      for (let i = 0; i < node.length; i++) {\n        const item = node[i];\n        const fallback = `${context || 'expression'}_${i + 1}`;\n        if (typeof item === 'string') {\n          if (isExpressionFileLike(item) || /exp|expression/.test(context)) {\n            uniquePush(names, seen, normalizeFileStem(item) || item);\n          }\n          continue;\n        }\n\n        if (item && typeof item === 'object') {\n          const normalized = normalizeDefinitionName(item, fallback);\n          const itemAny = item as any;\n          const fileLike = itemAny.File || itemAny.file || itemAny.Path || itemAny.path || '';\n          if (/exp|expression/.test(context) || isExpressionFileLike(fileLike)) {\n            uniquePush(names, seen, normalized || fallback);\n          }\n        }\n\n        visit(item, context);\n      }\n      return;\n    }\n\n    if (typeof node !== 'object') return;\n    if (visited.has(node)) return;\n    visited.add(node);\n\n    const obj = node as Record<string, unknown>;\n    const anyObj = obj as any;\n    const directFile = anyObj.File || anyObj.file || anyObj.Path || anyObj.path || '';\n    if (isExpressionFileLike(directFile)) {\n      uniquePush(names, seen, normalizeDefinitionName(obj, normalizeFileStem(directFile)));\n    }\n\n    for (const [rawKey, value] of Object.entries(obj)) {\n      const key = String(rawKey || '').trim();\n      if (!key) continue;\n      const keyLower = key.toLowerCase();\n      const keyIsExpression = keyLower.includes('expression') || keyLower.includes('expr') || keyLower === 'exp';\n      const nextContext = keyIsExpression ? 'expression' : context;\n\n      if (typeof value === 'string') {\n        const text = value.trim();\n        if (!text) continue;\n        if (isExpressionFileLike(text) || keyIsExpression || /exp|expression/.test(context)) {\n          const fallback = normalizeFileStem(key) || key;\n          const normalized = normalizeDefinitionName({ Name: fallback, File: text }, fallback);\n          uniquePush(names, seen, normalized || fallback);\n        }\n        continue;\n      }\n\n      if (Array.isArray(value)) {\n        if (keyIsExpression || /exp|expression/.test(context)) {\n          pushFromContainer(names, seen, value, normalizeFileStem(key) || 'expression');\n        }\n        visit(value, nextContext);\n        continue;\n      }\n\n      if (value && typeof value === 'object') {\n        if (keyIsExpression) {\n          const fallback = normalizeFileStem(key) || key;\n          uniquePush(names, seen, normalizeDefinitionName(value, fallback));\n        }\n        visit(value, nextContext);\n      }\n    }\n  };\n\n  visit(raw, '');\n  return names;\n}\n\nexport function collectMotionGroupCountsFromUnknown(raw: unknown): Record<string, number> {\n  const groups: Record<string, number> = {};\n  const visited = new Set<any>();\n\n  const visit = (node: unknown, parentKey = '', context = ''): void => {\n    if (node == null) return;\n\n    if (Array.isArray(node)) {\n      const count = countMotionDefinitions(node);\n      if ((parentKey === '' || !!parentKey) && count > 0 && (context === 'motion' || node.some(item => isMotionDefinition(item)))) {\n        mergeGroupCount(groups, parentKey, count);\n      }\n\n      for (const item of node) {\n        if (item && typeof item === 'object') {\n          visit(item, parentKey, context);\n        }\n      }\n      return;\n    }\n\n    if (typeof node !== 'object') return;\n    if (visited.has(node)) return;\n    visited.add(node);\n\n    const obj = node as Record<string, unknown>;\n    for (const [rawKey, value] of Object.entries(obj)) {\n      const keyRaw = String(rawKey ?? '');\n      const keyTrimmed = keyRaw.trim();\n      const key = keyTrimmed || (keyRaw === '' ? '' : '');\n      if (!key && keyRaw !== '') continue;\n\n      const keyLower = key.toLowerCase();\n      const keyIsMotionContainer =\n        keyLower.includes('motions') ||\n        keyLower.includes('motion') ||\n        keyLower.includes('anim') ||\n        keyLower.includes('mtn');\n      const nextContext = keyIsMotionContainer ? 'motion' : context;\n\n      if (Array.isArray(value)) {\n        const count = countMotionDefinitions(value);\n        if (count > 0 && (nextContext === 'motion' || value.some(item => isMotionDefinition(item)))) {\n          mergeGroupCount(groups, key, count);\n        }\n        visit(value, key, nextContext);\n        continue;\n      }\n\n      if (typeof value === 'string') {\n        if (isMotionFileLike(value) && parentKey) {\n          mergeGroupCount(groups, parentKey, 1);\n        }\n        continue;\n      }\n\n      if (value && typeof value === 'object') {\n        if (keyIsMotionContainer) {\n          const nested = value as Record<string, unknown>;\n          for (const [nestedRawKey, nestedValue] of Object.entries(nested)) {\n            const nestedRaw = String(nestedRawKey ?? '');\n            const nestedTrimmed = nestedRaw.trim();\n            const nestedKey = nestedTrimmed || (nestedRaw === '' ? '' : '');\n            if (!nestedKey && nestedRaw !== '') continue;\n            if (!Array.isArray(nestedValue)) continue;\n            const nestedCount = countMotionDefinitions(nestedValue);\n            if (nestedCount > 0) {\n              mergeGroupCount(groups, nestedKey, nestedCount);\n            }\n          }\n        }\n        visit(value, key, nextContext);\n      }\n    }\n  };\n\n  visit(raw, '', '');\n  return groups;\n}\n\nfunction pushMotionEntriesFromGroupContainer(entries: Live2DMotionEntry[], seen: Set<string>, container: unknown): void {\n  if (!container) return;\n\n  const pushFromList = (group: string, list: unknown[]) => {\n    for (let i = 0; i < list.length; i++) {\n      const def = list[i];\n      if (!isMotionDefinition(def)) continue;\n      const name = normalizeDefinitionName(def, `motion_${i + 1}`);\n      uniqueMotionPush(entries, seen, { group, index: i, name });\n    }\n  };\n\n  if (Array.isArray(container)) {\n    pushFromList('', container);\n    return;\n  }\n\n  if (typeof container !== 'object') return;\n\n  for (const [rawKey, value] of Object.entries(container as Record<string, unknown>)) {\n    const groupRaw = String(rawKey ?? '');\n    const groupTrimmed = groupRaw.trim();\n    if (!groupTrimmed && groupRaw !== '') continue;\n    const group = groupTrimmed || '';\n    if (!Array.isArray(value)) continue;\n    pushFromList(group, value);\n  }\n}\n\nexport function collectMotionEntries(model: any): Live2DMotionEntry[] {\n  const entries: Live2DMotionEntry[] = [];\n  const seen = new Set<string>();\n\n  const motionManager = model?.internalModel?.motionManager;\n  pushMotionEntriesFromGroupContainer(entries, seen, motionManager?.definitions);\n\n  const settingsCandidates = collectSettingsCandidates(model);\n  for (const settings of settingsCandidates) {\n    pushMotionEntriesFromGroupContainer(entries, seen, settings?.motions);\n    pushMotionEntriesFromGroupContainer(entries, seen, settings?.Motions);\n    pushMotionEntriesFromGroupContainer(entries, seen, settings?.FileReferences?.Motions);\n  }\n\n  return entries;\n}\n\nexport function collectExpressionNames(model: any): string[] {\n  const names: string[] = [];\n  const seen = new Set<string>();\n  const expressionManager = model?.internalModel?.motionManager?.expressionManager;\n\n  pushFromContainer(names, seen, expressionManager?.definitions, 'definition');\n  pushFromContainer(names, seen, expressionManager?.expressions, 'expression');\n  for (const name of collectExpressionNamesFromUnknown(expressionManager?.definitions)) {\n    uniquePush(names, seen, name);\n  }\n  for (const name of collectExpressionNamesFromUnknown(expressionManager?.expressions)) {\n    uniquePush(names, seen, name);\n  }\n\n  const settingsCandidates = collectSettingsCandidates(model);\n  for (const settings of settingsCandidates) {\n    pushFromContainer(names, seen, settings?.expressions, 'settings_expr');\n    pushFromContainer(names, seen, settings?.Expressions, 'settings_expr');\n    pushFromContainer(names, seen, settings?.FileReferences?.Expressions, 'file_ref_expr');\n    for (const name of collectExpressionNamesFromUnknown(settings)) {\n      uniquePush(names, seen, name);\n    }\n  }\n\n  const settings = model?.internalModel?.settings;\n  if (settings && typeof settings === 'object') {\n    if (typeof (settings as any).getExpressionCount === 'function') {\n      let count = 0;\n      try {\n        count = Number((settings as any).getExpressionCount()) || 0;\n      } catch {\n        // ignore\n      }\n      count = Math.max(0, Math.min(count, 1000));\n\n      for (let i = 0; i < count; i++) {\n        let name = '';\n        if (typeof (settings as any).getExpressionName === 'function') {\n          try {\n            name = String((settings as any).getExpressionName(i) ?? '').trim();\n          } catch {\n            // ignore\n          }\n        }\n        if (!name && typeof (settings as any).getExpressionFile === 'function') {\n          try {\n            name = normalizeFileStem((settings as any).getExpressionFile(i));\n          } catch {\n            // ignore\n          }\n        }\n        uniquePush(names, seen, name || `expression_${i + 1}`);\n      }\n    }\n  }\n\n  return names;\n}\n\nexport function collectMotionGroupNames(model: any): string[] {\n  const groupNames: string[] = [];\n  const seen = new Set<string>();\n  const motionManager = model?.internalModel?.motionManager;\n\n  const pushFromObject = (obj: unknown) => {\n    if (!obj || typeof obj !== 'object') return;\n    for (const key of Object.keys(obj as Record<string, unknown>)) {\n      uniquePushAllowEmpty(groupNames, seen, key);\n    }\n  };\n\n  pushFromObject(motionManager?.motionGroups);\n  pushFromObject(motionManager?.groups);\n  pushFromObject(motionManager?.definitions);\n  for (const [groupName] of Object.entries(collectMotionGroupCountsFromUnknown(motionManager?.definitions))) {\n    uniquePushAllowEmpty(groupNames, seen, groupName);\n  }\n\n  const settingsCandidates = collectSettingsCandidates(model);\n  for (const settings of settingsCandidates) {\n    pushFromObject(settings?.motions);\n    pushFromObject(settings?.Motions);\n    pushFromObject(settings?.FileReferences?.Motions);\n    for (const [groupName] of Object.entries(collectMotionGroupCountsFromUnknown(settings))) {\n      uniquePushAllowEmpty(groupNames, seen, groupName);\n    }\n  }\n\n  const settings = model?.internalModel?.settings;\n  if (settings && typeof settings === 'object') {\n    const anySettings = settings as any;\n    if (typeof anySettings.getMotionGroupCount === 'function' && typeof anySettings.getMotionGroupName === 'function') {\n      let count = 0;\n      try {\n        count = Number(anySettings.getMotionGroupCount()) || 0;\n      } catch {\n        // ignore\n      }\n      count = Math.max(0, Math.min(count, 1000));\n\n      for (let i = 0; i < count; i++) {\n        try {\n          uniquePushAllowEmpty(groupNames, seen, String(anySettings.getMotionGroupName(i) ?? ''));\n        } catch {\n          // ignore\n        }\n      }\n    } else if (typeof anySettings.getMotionGroupNames === 'function') {\n      try {\n        const names = anySettings.getMotionGroupNames();\n        if (Array.isArray(names)) {\n          for (const name of names) uniquePushAllowEmpty(groupNames, seen, name);\n        }\n      } catch {\n        // ignore\n      }\n    }\n  }\n\n  return groupNames;\n}\n\nexport function matchLive2DExpression(model: any, targetExpression: EmotionTag, override?: string): string | null {\n  const overrideName = String(override || '').trim();\n  if (overrideName) return overrideName;\n\n  const mapping = EXPRESSION_LIVE2D_MAP[targetExpression];\n  const candidates = mapping?.expressions || [String(targetExpression || '').toLowerCase()];\n\n  const definitions = collectExpressionNames(model);\n  if (!definitions.length) return null;\n\n  for (const candidateRaw of candidates) {\n    const candidate = String(candidateRaw || '').toLowerCase();\n    const exact = definitions.find((def) => String(def || '').toLowerCase() === candidate);\n    if (exact) return exact;\n  }\n\n  for (const candidateRaw of candidates) {\n    const candidate = String(candidateRaw || '').toLowerCase();\n    for (const def of definitions) {\n      const name = String(def || '').toLowerCase();\n      if (name.includes(candidate) || candidate.includes(name)) {\n        return def;\n      }\n    }\n  }\n\n  return null;\n}\n\nexport type Live2DMotionMatch = { group: string; index: number; name?: string };\n\nexport function matchLive2DMotion(\n  model: any,\n  targetExpression: EmotionTag,\n  override?: EmotionMotionOverride,\n): Live2DMotionMatch | null {\n  if (override && override.enabled === false) return null;\n\n  const overrideGroup = String(override?.group || '').trim();\n  const overrideIndexRaw = Number(override?.index);\n  const overrideIndex = Number.isFinite(overrideIndexRaw) ? Math.max(0, Math.floor(overrideIndexRaw)) : 0;\n  if (overrideGroup) {\n    const entries = collectMotionEntries(model);\n    const groupNames = collectMotionGroupNames(model);\n    const lower = overrideGroup.toLowerCase();\n\n    const exactByGroupIndex = entries.find((e) => {\n      const groupLower = String(e.group || '').trim().toLowerCase();\n      return groupLower === lower && e.index === overrideIndex;\n    });\n    if (exactByGroupIndex) {\n      return { group: exactByGroupIndex.group, index: exactByGroupIndex.index, name: exactByGroupIndex.name };\n    }\n\n    const exactGroup = groupNames.find((name) => String(name || '').trim().toLowerCase() === lower);\n    if (exactGroup !== undefined) {\n      const exactInGroup = entries.find((e) => String(e.group || '').trim() === exactGroup && e.index === overrideIndex);\n      if (exactInGroup) {\n        return { group: exactInGroup.group, index: exactInGroup.index, name: exactInGroup.name };\n      }\n      const firstInGroup = entries.find((e) => String(e.group || '').trim() === exactGroup);\n      if (firstInGroup) {\n        return { group: firstInGroup.group, index: firstInGroup.index, name: firstInGroup.name };\n      }\n      return { group: exactGroup, index: overrideIndex };\n    }\n\n    // group  motion name\n    const exactByName =\n      entries.find((e) => e.name.toLowerCase() === lower && e.index === overrideIndex) ||\n      entries.find((e) => e.name.toLowerCase() === lower);\n    if (exactByName) {\n      return { group: exactByName.group, index: exactByName.index, name: exactByName.name };\n    }\n\n    const fuzzyByName = entries.find((e) => {\n      const nameLower = e.name.toLowerCase();\n      return nameLower.includes(lower) || lower.includes(nameLower);\n    });\n    if (fuzzyByName) {\n      return { group: fuzzyByName.group, index: fuzzyByName.index, name: fuzzyByName.name };\n    }\n\n    const fuzzyGroup = groupNames.find((name) => {\n      const nameLower = String(name || '').trim().toLowerCase();\n      return !!nameLower && (nameLower.includes(lower) || lower.includes(nameLower));\n    });\n    if (fuzzyGroup !== undefined) {\n      const exactInGroup = entries.find(\n        (e) => String(e.group || '').trim() === fuzzyGroup && e.index === overrideIndex,\n      );\n      if (exactInGroup) {\n        return { group: exactInGroup.group, index: exactInGroup.index, name: exactInGroup.name };\n      }\n      const firstInGroup = entries.find((e) => String(e.group || '').trim() === fuzzyGroup);\n      if (firstInGroup) {\n        return { group: firstInGroup.group, index: firstInGroup.index, name: firstInGroup.name };\n      }\n      return { group: fuzzyGroup, index: overrideIndex };\n    }\n\n    return null;\n  }\n\n  const mapping = EXPRESSION_LIVE2D_MAP[targetExpression];\n  if (!mapping?.motions?.length) return null;\n\n  const groupNames = collectMotionGroupNames(model);\n  if (!groupNames.length) return null;\n\n  for (const candidateRaw of mapping.motions) {\n    const candidate = String(candidateRaw || '').trim().toLowerCase();\n    if (!candidate) continue;\n    const exact = groupNames.find((name) => String(name || '').trim().toLowerCase() === candidate);\n    if (exact) {\n      return { group: exact, index: 0 };\n    }\n  }\n\n  for (const candidateRaw of mapping.motions) {\n    const candidate = String(candidateRaw || '').toLowerCase();\n    if (!candidate) continue;\n    for (const groupName of groupNames) {\n      const nameLower = String(groupName || '').toLowerCase();\n      if (!nameLower) continue;\n      if (nameLower.includes(candidate) || candidate.includes(nameLower)) {\n        return { group: groupName, index: 0 };\n      }\n    }\n  }\n\n  const entries = collectMotionEntries(model);\n  if (!entries.length) return null;\n\n  for (const candidateRaw of mapping.motions) {\n    const candidate = String(candidateRaw || '').trim().toLowerCase();\n    if (!candidate) continue;\n    const exact = entries.find((e) => e.name.toLowerCase() === candidate);\n    if (exact) return { group: exact.group, index: exact.index, name: exact.name };\n  }\n\n  for (const candidateRaw of mapping.motions) {\n    const candidate = String(candidateRaw || '').trim().toLowerCase();\n    if (!candidate) continue;\n    const fuzzy = entries.find((e) => {\n      const nameLower = e.name.toLowerCase();\n      return nameLower.includes(candidate) || candidate.includes(nameLower);\n    });\n    if (fuzzy) return { group: fuzzy.group, index: fuzzy.index, name: fuzzy.name };\n  }\n\n  return null;\n}\n","import { EIKANYA_CDN_BASE, EIKANYA_RAW_BASE, LIVE2D_CDN_BASE } from '../core/constants';\r\nimport { useSettingsStore } from '../core/settings';\nimport { error, log, warn } from '../utils/dom';\nimport { Live2DLoader } from './loader';\nimport { Live2DStage } from './stage';\nimport {\n  collectExpressionNames,\n  collectExpressionNamesFromUnknown,\n  collectMotionEntries,\n  collectMotionGroupCountsFromUnknown,\n  collectMotionGroupNames,\n  type Live2DMotionEntry,\n} from './expression-motion';\n\nconst TICKER_REGISTERED_FLAG = '__desktopPetLive2dTickerV1';\n\nexport type ModelLoadProgress = {\n  percent: number;\n  message: string;\n};\n\r\n/**\n * Live2D \n * /\n */\nexport const Live2DManager = {\n  _JSDELIVR_HOSTS: [\n    'cdn.jsdelivr.net',\n    'fastly.jsdelivr.net',\n    'testingcf.jsdelivr.net',\n    'gcore.jsdelivr.net',\n  ],\n  _runtime: null as any,\n  model: null as any,\n  isReady: false,\n  modelBaseWidth: null as number | null,\n  modelBaseHeight: null as number | null,\n  modelBaseBounds: null as { x: number; y: number; width: number; height: number } | null,\n  _lastModelJson: null as any,\n  _lastModelJsonSourceUrl: '' as string,\n  _autoMotionTimer: null as number | null,\n  autoMotionLoopEnabled: true,\n  _mouthParamCore: null as any,\n  _mouthParamIds: [] as string[],\n  _mouthParamIndexes: [] as number[],\n  _mouthParamRangeMins: [] as number[],\r\n  _mouthParamRangeMaxs: [] as number[],\r\n  _mouthParamWarned: false,\r\n  _mouthCurrentValue: 0,\r\n  _lipSyncActive: false,\r\n  _inModelUpdate: false,\r\n  _writeMaskCore: null as any,\r\n  _writeMaskRestore: null as (() => void) | null,\r\n  _updateHookModel: null as any,\r\n  _updateHookRestore: null as (() => void) | null,\r\n  _manualMouthParamEnabled: false,\r\n  _manualMouthParamIds: [] as string[],\r\n  _manualMouthParamIdSet: new Set<string>(),\r\n\r\n  /**  */\n  _top(): Window {\n    return window.parent ?? window;\n  },\n\n  /**  PIXI  */\n  _getPIXI(): any {\n    const runtimePixi = Live2DLoader.getPixi(this._top());\n    if (runtimePixi) return runtimePixi;\n    return this._runtime?.pixi ?? null;\n  },\n\r\n  _encodePathSegment(segment: string): string {\r\n    if (typeof segment !== 'string' || !segment) return segment;\r\n\r\n    let decoded = segment;\r\n    try {\r\n      decoded = decodeURIComponent(segment);\r\n    } catch {\r\n      return segment;\r\n    }\r\n\r\n    const safeChar = /[A-Za-z0-9\\-._~!$&'()*+,;=:@]/;\r\n    let encoded = '';\r\n    for (const ch of decoded) {\r\n      encoded += safeChar.test(ch) ? ch : encodeURIComponent(ch);\r\n    }\r\n    return encoded;\r\n  },\r\n\r\n  _normalizeRemoteUrl(inputUrl: string): string {\r\n    const url = String(inputUrl || '').trim();\r\n    if (!url) return url;\r\n\r\n    try {\r\n      const urlObj = new URL(url);\r\n      urlObj.pathname = urlObj.pathname\r\n        .split('/')\r\n        .map(segment => this._encodePathSegment(segment))\r\n        .join('/');\r\n      return urlObj.toString();\r\n    } catch {\r\n      return url;\r\n    }\r\n  },\r\n\r\n  _normalizeResourceRef(inputRef: string): string {\r\n    const raw = String(inputRef || '').trim();\r\n    if (!raw) return raw;\r\n\r\n    //  #  %23 URL \r\n    const hashSafe = raw.replace(/#/g, '%23');\r\n    const normalized = hashSafe.replace(/\\\\/g, '/');\r\n\r\n    const qIndex = normalized.indexOf('?');\r\n    const pathPart = qIndex >= 0 ? normalized.slice(0, qIndex) : normalized;\r\n    const queryPart = qIndex >= 0 ? normalized.slice(qIndex) : '';\r\n\r\n    const encodedPath = pathPart\r\n      .split('/')\r\n      .map(segment => this._encodePathSegment(segment))\r\n      .join('/');\r\n\r\n    return `${encodedPath}${queryPart.replace(/#/g, '%23')}`;\r\n  },\r\n\r\n  _getMirrorEikanyaModelUrl(modelUrl: string): string | null {\r\n    const url = String(modelUrl || '').trim();\r\n    if (!url) return null;\r\n\r\n    if (url.startsWith(EIKANYA_CDN_BASE)) {\r\n      return `${EIKANYA_RAW_BASE}${url.slice(EIKANYA_CDN_BASE.length)}`;\r\n    }\r\n    if (url.startsWith(EIKANYA_RAW_BASE)) {\r\n      return `${EIKANYA_CDN_BASE}${url.slice(EIKANYA_RAW_BASE.length)}`;\r\n    }\r\n    return null;\r\n  },\r\n\r\n  _expandJsDelivrHosts(inputUrl: string): string[] {\r\n    const url = String(inputUrl || '').trim();\r\n    if (!url) return [];\r\n\r\n    let urlObj: URL;\r\n    try {\r\n      urlObj = new URL(url);\r\n    } catch {\r\n      return [];\r\n    }\r\n\r\n    if (!urlObj.hostname.toLowerCase().endsWith('jsdelivr.net')) return [];\r\n\r\n    const results: string[] = [];\r\n    for (const host of this._JSDELIVR_HOSTS) {\r\n      try {\r\n        const u = new URL(url);\r\n        u.hostname = host;\r\n        results.push(u.toString());\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n    return results;\r\n  },\r\n\r\n  _convertJsDelivrGhToRawCandidates(inputUrl: string): string[] {\r\n    const url = String(inputUrl || '').trim();\r\n    if (!url) return [];\r\n\r\n    let urlObj: URL;\r\n    try {\r\n      urlObj = new URL(url);\r\n    } catch {\r\n      return [];\r\n    }\r\n\r\n    const host = urlObj.hostname.toLowerCase();\r\n    if (!host.endsWith('jsdelivr.net')) return [];\r\n    if (!urlObj.pathname.startsWith('/gh/')) return [];\r\n\r\n    const rest = urlObj.pathname.slice('/gh/'.length);\r\n    const parts = rest.split('/').filter(Boolean);\r\n    if (parts.length < 2) return [];\r\n\r\n    const owner = parts[0];\r\n    const repoWithRef = parts[1];\r\n    const filePath = parts.slice(2).join('/');\r\n    if (!owner || !repoWithRef || !filePath) return [];\r\n\r\n    const [repo, ref] = repoWithRef.split('@');\r\n    const suffix = `${urlObj.search || ''}${urlObj.hash || ''}`;\r\n\r\n    if (ref) {\r\n      return [`https://raw.githubusercontent.com/${owner}/${repo}/${ref}/${filePath}${suffix}`];\r\n    }\r\n\r\n    return [\r\n      `https://raw.githubusercontent.com/${owner}/${repo}/master/${filePath}${suffix}`,\r\n      `https://raw.githubusercontent.com/${owner}/${repo}/main/${filePath}${suffix}`,\r\n    ];\r\n  },\r\n\r\n  _buildModelUrlCandidates(modelUrl: string): string[] {\r\n    const bases: string[] = [];\r\n    const addBase = (url: string) => {\r\n      const normalized = this._normalizeRemoteUrl(url);\r\n      if (!normalized) return;\r\n      if (!bases.includes(normalized)) bases.push(normalized);\r\n    };\r\n\r\n    addBase(modelUrl);\r\n    const mirrorUrl = this._getMirrorEikanyaModelUrl(modelUrl);\r\n    if (mirrorUrl) addBase(mirrorUrl);\r\n\r\n    const candidates: string[] = [];\r\n    const add = (url: string) => {\r\n      const normalized = this._normalizeRemoteUrl(url);\r\n      if (!normalized) return;\r\n      if (!candidates.includes(normalized)) candidates.push(normalized);\r\n    };\r\n\r\n    for (const base of bases) {\r\n      add(base);\r\n      for (const variant of this._expandJsDelivrHosts(base)) add(variant);\r\n      for (const raw of this._convertJsDelivrGhToRawCandidates(base)) add(raw);\r\n    }\r\n\r\n    return candidates;\r\n  },\r\n\r\n  async _createModelWithTimeout(Live2DModel: any, dataUrl: string, timeoutMs = 30000): Promise<any> {\n    let timer: number | null = null;\n    try {\n      const timeoutPromise = new Promise<never>((_resolve, reject) => {\n        timer = window.setTimeout(() => {\n          reject(new Error(` (${timeoutMs}ms)`));\n        }, timeoutMs);\n      });\n\n      return await Promise.race([\n        Live2DModel.from(dataUrl, {\n          //  galgame  WebGL renderer  autoUpdate\n          //  Cubism2/ WebGL program \n          autoUpdate: false,\n          autoInteract: false,\n        }),\n        timeoutPromise,\n      ]);\n    } finally {\n      if (timer !== null) {\n        window.clearTimeout(timer);\n      }\n    }\n  },\n\r\n  async _fetchWithTimeout(url: string, init: RequestInit, timeoutMs = 12000): Promise<Response> {\r\n    if (typeof AbortController === 'undefined') {\r\n      return fetch(url, init);\r\n    }\r\n\r\n    const controller = new AbortController();\r\n    const timer = window.setTimeout(() => controller.abort(), timeoutMs);\r\n\r\n    try {\r\n      return await fetch(url, { ...init, signal: controller.signal });\r\n    } catch (e: any) {\r\n      if (e?.name === 'AbortError') {\r\n        throw new Error(` (${timeoutMs}ms): ${url}`);\r\n      }\r\n      throw e;\r\n    } finally {\r\n      window.clearTimeout(timer);\r\n    }\r\n  },\r\n\r\n  _toPositiveNumber(value: unknown, fallback: number): number {\r\n    const n = typeof value === 'number' ? value : Number(value);\r\n    return Number.isFinite(n) && n > 0 ? n : fallback;\r\n  },\r\n\r\n  _toScale(value: unknown, fallback = 1): number {\n    const n = typeof value === 'number' ? value : Number(value);\n    if (!Number.isFinite(n) || n <= 0) return fallback;\n    return Math.min(20, Math.max(0.01, n));\n  },\n\n  _readModelBaseBounds(model: any): { x: number; y: number; width: number; height: number } | null {\n    if (!model || typeof model.getLocalBounds !== 'function') return null;\n    try {\n      const bounds = model.getLocalBounds();\n      if (!bounds) return null;\n      const width = Number(bounds.width);\n      const height = Number(bounds.height);\n      if (!Number.isFinite(width) || !Number.isFinite(height) || width <= 0 || height <= 0) {\n        return null;\n      }\n      const x = Number.isFinite(Number(bounds.x)) ? Number(bounds.x) : 0;\n      const y = Number.isFinite(Number(bounds.y)) ? Number(bounds.y) : 0;\n      return { x, y, width, height };\n    } catch {\n      return null;\n    }\n  },\n\n  _resolveModelBaseBounds(): { x: number; y: number; width: number; height: number } {\n    if (this.modelBaseBounds) return this.modelBaseBounds;\n\n    const measured = this._readModelBaseBounds(this.model);\n    if (measured) {\n      this.modelBaseBounds = measured;\n      this.modelBaseWidth = measured.width;\n      this.modelBaseHeight = measured.height;\n      return measured;\n    }\n\n    return {\n      x: 0,\n      y: 0,\n      width: this._toPositiveNumber(this.modelBaseWidth, 500),\n      height: this._toPositiveNumber(this.modelBaseHeight, 800),\n    };\n  },\n\n  _applyStageTransform(stageWidth: number, stageHeight: number, scale: number): {\n    finalScale: number;\n    stageWidth: number;\n    stageHeight: number;\n    modelWidth: number;\n    modelHeight: number;\n  } | null {\n    if (!this.model) return null;\n\n    const safeStageWidth = this._toPositiveNumber(stageWidth, 280);\n    const safeStageHeight = this._toPositiveNumber(stageHeight, 360);\n    const bounds = this._resolveModelBaseBounds();\n    const safeModelWidth = this._toPositiveNumber(bounds.width, 500);\n    const safeModelHeight = this._toPositiveNumber(bounds.height, 800);\n    const fitScale = Math.min(safeStageWidth / safeModelWidth, safeStageHeight / safeModelHeight) * 0.9;\n    const finalScale = this._toScale(fitScale * this._toScale(scale, 1), 0.3);\n\n    this.model.visible = true;\n    this.model.alpha = 1;\n    this.model.scale.set(finalScale);\n\n    if (this.model.anchor?.set) {\n      this.model.anchor.set(0.5, 1);\n      this.model.x = safeStageWidth / 2;\n      this.model.y = safeStageHeight;\n    } else if (this.model.pivot?.set) {\n      this.model.pivot.set(bounds.x + safeModelWidth / 2, bounds.y + safeModelHeight);\n      this.model.x = safeStageWidth / 2;\n      this.model.y = safeStageHeight;\n    } else {\n      this.model.x = safeStageWidth / 2;\n      this.model.y = safeStageHeight / 2;\n    }\n\n    return {\n      finalScale,\n      stageWidth: safeStageWidth,\n      stageHeight: safeStageHeight,\n      modelWidth: safeModelWidth,\n      modelHeight: safeModelHeight,\n    };\n  },\n\r\n  _normalizeLegacyCubism2Settings(modelJson: any): void {\r\n    if (!modelJson || modelJson.FileReferences) return;\r\n\r\n    const textures = modelJson.textures || modelJson.Textures;\r\n    if (Array.isArray(textures)) return;\r\n    if (!textures || typeof textures !== 'object') return;\r\n\r\n    const entries = Object.entries(textures)\r\n      .filter((entry): entry is [string, string[]] => Array.isArray(entry[1]) && entry[1].length > 0);\r\n    if (entries.length === 0) return;\r\n\r\n    const hintKeys = [\r\n      modelJson.config?.texture,\r\n      modelJson.config?.textureId,\r\n      modelJson.config?.skin,\r\n      modelJson.config?.modelId,\r\n      modelJson.config?.defaultTexture,\r\n      modelJson.config?.defaultSkin,\r\n    ]\r\n      .map(v => (v === undefined || v === null ? '' : String(v).trim()))\r\n      .filter(Boolean);\r\n\r\n    let selected = entries[0];\r\n    for (const hint of hintKeys) {\r\n      const matched = entries.find(([key]) => key === hint);\r\n      if (matched) {\r\n        selected = matched;\r\n        break;\r\n      }\r\n    }\r\n\r\n    const normalizedTextures = selected[1].map((item: string) => {\r\n      const raw = String(item || '').trim();\r\n      if (!raw) return raw;\r\n      if (/^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(raw)) return raw;\r\n      if (raw.startsWith('/')) return raw;\r\n      if (raw.includes('/')) return raw;\r\n      //  textures/  JSON \r\n      return `textures/${raw}`;\r\n    });\r\n    modelJson.textures = normalizedTextures;\r\n    modelJson.Textures = normalizedTextures;\r\n    log(' Cubism2 ', {\r\n      key: selected[0],\r\n      textureCount: normalizedTextures.length,\r\n    });\r\n  },\r\n\r\n  _clearAutoMotionLoop(): void {\r\n    if (this._autoMotionTimer !== null) {\r\n      window.clearInterval(this._autoMotionTimer);\r\n      this._autoMotionTimer = null;\r\n    }\r\n  },\r\n\r\n  _stopCurrentMotion(reason = 'manual'): void {\r\n    const model = this.model;\r\n    if (!model) return;\r\n\r\n    let stopped = false;\r\n    const tryCall = (obj: any, method: string) => {\r\n      if (!obj || typeof obj[method] !== 'function') return;\r\n      try {\r\n        obj[method]();\r\n        stopped = true;\r\n      } catch {\r\n        // ignore\r\n      }\r\n    };\r\n\r\n    const mm = model?.internalModel?.motionManager as any;\r\n    const animator = model?.internalModel?.animator as any;\r\n    const internal = model?.internalModel as any;\r\n\r\n    tryCall(model, 'stopMotions');\r\n    tryCall(mm, 'stopAllMotions');\r\n    tryCall(mm, 'stopAllMotion');\r\n    tryCall(mm, 'stopMotion');\r\n    tryCall(mm, 'stop');\r\n    tryCall(animator, 'stopAllMotions');\r\n    tryCall(animator, 'stopAllMotion');\r\n    tryCall(animator, 'stop');\r\n    tryCall(internal, 'stopAllMotions');\r\n\r\n    if (stopped) {\r\n      log('', { reason });\r\n    }\r\n  },\r\n\r\n  _refreshManualMouthParams(): void {\r\n    let enabled = false;\r\n    const ids: string[] = [];\r\n    try {\n      const store = useSettingsStore();\n      const s = store.settings as any;\n      enabled = !!s?.lipSyncManualParamsEnabled;\n      const raw = Array.isArray(s?.lipSyncManualParamIds) ? s.lipSyncManualParamIds : [];\n      const set = new Set<string>();\n      for (const item of raw) {\n        const id = String(item || '').trim();\n        if (!id) continue;\r\n        const low = id.toLowerCase();\r\n        if (set.has(low)) continue;\r\n        set.add(low);\r\n        ids.push(id);\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    this._manualMouthParamEnabled = enabled;\r\n    this._manualMouthParamIds = ids;\r\n    this._manualMouthParamIdSet = new Set(ids.map(id => id.toLowerCase()));\r\n  },\r\n\r\n  _setLipSyncActive(active: boolean): void {\r\n    const next = !!active;\r\n    if (this._lipSyncActive === next) return;\r\n\r\n    this._lipSyncActive = next;\r\n    if (next) {\r\n      this._refreshManualMouthParams();\r\n      const model = this.model;\r\n      const coreModel = model?.internalModel?.coreModel;\r\n      if (model) this._ensureLipSyncHooks(model);\r\n      if (coreModel) this._installCoreWriteMask(coreModel);\r\n    }\r\n    log(`LipSync active=${next}`);\r\n  },\r\n\r\n  setAutoMotionLoopEnabled(enabled: boolean): void {\r\n    this.autoMotionLoopEnabled = Boolean(enabled);\r\n\r\n    if (!this.model) {\r\n      this._clearAutoMotionLoop();\r\n      return;\r\n    }\r\n\r\n    if (this.autoMotionLoopEnabled) {\r\n      this._startAutoMotionLoop();\r\n    } else {\r\n      this._clearAutoMotionLoop();\r\n      this._stopCurrentMotion('auto-motion-disabled');\r\n    }\r\n  },\r\n\r\n  _pickDefaultMotionGroup(groups: Record<string, number>): string | null {\r\n    const keys = Object.keys(groups).filter(key => groups[key] > 0);\r\n    if (keys.length === 0) return null;\r\n\r\n    const preferred = ['idle', 'home', 'stand', 'normal', 'default', 'main', 'loop', 'wait'];\r\n    for (const key of keys) {\r\n      const lower = key.toLowerCase();\r\n      if (preferred.some(token => lower.includes(token))) {\r\n        return key;\r\n      }\r\n    }\r\n\r\n    if (keys.includes('')) {\r\n      return '';\r\n    }\r\n\r\n    return null;\r\n  },\r\n\r\n  _startAutoMotionLoop(): void {\r\n    this._clearAutoMotionLoop();\r\n    if (!this.model) return;\r\n\r\n    const initialGroups = this.getMotionGroups();\r\n    const motionGroup = this._pickDefaultMotionGroup(initialGroups);\r\n    const allGroupNames = Object.keys(initialGroups).filter(key => initialGroups[key] > 0);\r\n    if (allGroupNames.length === 0) {\r\n      log('');\r\n      return;\r\n    }\r\n\r\n    const playOne = () => {\r\n      if (!this.model) return;\r\n      const groups = this.getMotionGroups();\r\n\r\n      if (motionGroup !== null) {\r\n        const count = groups[motionGroup] ?? 0;\r\n        if (count <= 0) return;\r\n        const idx = Math.floor(Math.random() * count);\r\n        this.playMotion(motionGroup, idx);\r\n        return;\r\n      }\r\n\r\n      const groupNames = Object.keys(groups).filter(key => groups[key] > 0);\r\n      if (groupNames.length === 0) return;\r\n      const randGroup = groupNames[Math.floor(Math.random() * groupNames.length)];\r\n      const count = groups[randGroup];\r\n      if (count <= 0) return;\r\n      const randIndex = Math.floor(Math.random() * count);\r\n      this.playMotion(randGroup, randIndex);\r\n    };\r\n\r\n    playOne();\r\n    this._autoMotionTimer = window.setInterval(playOne, 10000);\r\n    if (motionGroup !== null) {\r\n      log('', {\r\n        mode: 'preferred-group',\r\n        group: motionGroup || '(empty)',\r\n        intervalMs: 10000,\r\n      });\r\n    } else {\r\n      log('', {\r\n        mode: 'random-all-groups',\r\n        groupCount: allGroupNames.length,\r\n        intervalMs: 10000,\r\n      });\r\n    }\r\n  },\r\n\r\n  _stripJsonComments(text: string): string {\r\n    let output = '';\r\n    let inString = false;\r\n    let quoteChar = '\"';\r\n    let escaping = false;\r\n    let inLineComment = false;\r\n    let inBlockComment = false;\r\n\r\n    for (let i = 0; i < text.length; i++) {\r\n      const ch = text[i];\r\n      const next = i + 1 < text.length ? text[i + 1] : '';\r\n\r\n      if (inLineComment) {\r\n        if (ch === '\\n') {\r\n          inLineComment = false;\r\n          output += ch;\r\n        }\r\n        continue;\r\n      }\r\n\r\n      if (inBlockComment) {\r\n        if (ch === '*' && next === '/') {\r\n          inBlockComment = false;\r\n          i++;\r\n        }\r\n        continue;\r\n      }\r\n\r\n      if (inString) {\r\n        output += ch;\r\n        if (escaping) {\r\n          escaping = false;\r\n        } else if (ch === '\\\\') {\r\n          escaping = true;\r\n        } else if (ch === quoteChar) {\r\n          inString = false;\r\n        }\r\n        continue;\r\n      }\r\n\r\n      if (ch === '/' && next === '/') {\r\n        inLineComment = true;\r\n        i++;\r\n        continue;\r\n      }\r\n\r\n      if (ch === '/' && next === '*') {\r\n        inBlockComment = true;\r\n        i++;\r\n        continue;\r\n      }\r\n\r\n      if (ch === '\"' || ch === '\\'') {\r\n        inString = true;\r\n        quoteChar = ch;\r\n      }\r\n\r\n      output += ch;\r\n    }\r\n\r\n    return output;\r\n  },\r\n\r\n  _tryParseModelJson(text: string): any | null {\r\n    const raw = String(text ?? '').replace(/^\\uFEFF/, '').trim();\r\n    if (!raw) return null;\r\n\r\n    try {\r\n      return JSON.parse(raw);\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    let cleaned = this._stripJsonComments(raw);\r\n    cleaned = cleaned.replace(/,\\s*([}\\]])/g, '$1');\r\n    cleaned = cleaned.replace(/}(\\s*){/g, '},$1{');\r\n    cleaned = cleaned.replace(/](\\s*){/g, '],$1{');\r\n    cleaned = cleaned.replace(/([}\\]0-9\"'])(\\s*)(?=\"[^\"]+\"\\s*:)/g, '$1,$2');\r\n\r\n    try {\r\n      return JSON.parse(cleaned);\r\n    } catch {\r\n      return null;\r\n    }\r\n  },\r\n\r\n  _buildModelJsonCandidates(modelUrl: string): string[] {\r\n    const candidates = [modelUrl];\r\n\r\n    const addCandidate = (url: string) => {\r\n      if (!url) return;\r\n      if (!candidates.includes(url)) candidates.push(url);\r\n    };\r\n\r\n    addCandidate(modelUrl.replace(/\\/model\\.json(?=([?#].*)?$)/i, '/model.model.json'));\r\n    addCandidate(modelUrl.replace(/\\/model3\\.json(?=([?#].*)?$)/i, '/model.model3.json'));\r\n\r\n    return candidates;\r\n  },\r\n\r\n  async _fetchModelJsonCandidate(modelUrl: string, useProxy: boolean): Promise<any | null> {\r\n    const requestUrl = useProxy ? this._getProxiedUrl(modelUrl) : modelUrl;\r\n    const resp = await this._fetchWithTimeout(requestUrl, { method: 'GET', cache: 'no-store' }, 12000);\r\n    if (!resp.ok) return null;\r\n\r\n    const text = await resp.text();\r\n    const modelJson = this._tryParseModelJson(text);\r\n    if (!modelJson) return null;\r\n\r\n    return { modelJson, sourceUrl: modelUrl, useProxy };\r\n  },\r\n\r\n  /**\n   *  CORS  URL\n   * : getCorsProxyUrl -> enableCorsProxy -> corsProxy.getProxyUrl -> /proxy?url=\n   */\n  _getProxiedUrl(originalUrl: string): string {\n    const top = this._top() as any;\n    const url = String(originalUrl || '').trim();\n    if (!url) return url;\n    //  URL\n    if (url.toLowerCase().includes('/proxy?url=')) return url;\n\r\n    // SillyTavern  CORS \n    if (typeof top.getCorsProxyUrl === 'function') {\r\n      try {\r\n        const proxied = top.getCorsProxyUrl(url);\r\n        if (typeof proxied === 'string' && proxied) return proxied;\r\n      } catch (_e) { /* ignore */ }\r\n    }\r\n\r\n    if (typeof top.enableCorsProxy === 'function') {\r\n      try {\r\n        const proxied = top.enableCorsProxy(url);\r\n        if (typeof proxied === 'string' && proxied) return proxied;\r\n      } catch (_e) { /* ignore */ }\r\n    }\r\n\r\n    if (top.corsProxy?.getProxyUrl) {\r\n      try {\r\n        const proxied = top.corsProxy.getProxyUrl(url);\r\n        if (typeof proxied === 'string' && proxied) return proxied;\r\n      } catch (_e) { /* ignore */ }\r\n    }\r\n\r\n    // \n    const origin = top.location?.origin;\n    if (origin) {\n      return `${origin}/proxy?url=${encodeURIComponent(url)}`;\n    }\n\r\n    return url;\r\n  },\r\n\r\n  /**\n   *  SDK  Ticker\n   */\n  async init(): Promise<boolean> {\n    if (this.isReady) {\r\n      const runtime = Live2DLoader.getRuntime(this._top());\r\n      if (runtime) {\r\n        this._runtime = runtime;\r\n        return true;\r\n      }\r\n      this.isReady = false;\r\n    }\r\n\r\n    const sdkLoaded = await Live2DLoader.load();\r\n    if (!sdkLoaded) {\r\n      error('SDK  Live2DManager');\r\n      return false;\r\n    }\r\n\r\n    //  runtime \r\n    let runtime = Live2DLoader.getRuntime(this._top());\r\n    let retries = 30;\r\n    while (!runtime && retries > 0) {\r\n      await new Promise(r => setTimeout(r, 100));\r\n      runtime = Live2DLoader.getRuntime(this._top());\r\n      retries--;\r\n    }\r\n\r\n    if (!runtime?.pixi || !runtime?.live2dModel) {\r\n      error(' Live2D runtime ');\r\n      return false;\r\n    }\r\n\r\n    try {\n      const PIXI = runtime.pixi;\n      const Live2DModel = runtime.live2dModel;\n      if (typeof Live2DModel?.registerTicker !== 'function') {\n        throw new Error('Live2DModel.registerTicker ');\n      }\n\n      //  ticker\n      const lastRegisteredTicker = (Live2DModel as any)[TICKER_REGISTERED_FLAG] as unknown;\n      if (lastRegisteredTicker !== PIXI.Ticker) {\n        Live2DModel.registerTicker(PIXI.Ticker);\n        (Live2DModel as any)[TICKER_REGISTERED_FLAG] = PIXI.Ticker;\n        log('Live2D ticker ');\n      } else {\n        log('Live2D ticker ');\n      }\n\n      this._runtime = runtime;\n      this.isReady = true;\n      log('Live2DManager ');\n      return true;\n    } catch (e) {\r\n      error('Live2DManager ', e);\r\n      return false;\r\n    }\r\n  },\r\n\r\n  /**\n   *  URL \n   *  model JSON ->  ->  data URL ->  Live2DModel.from\n   */\n  async loadModel(\n    modelPath: string,\r\n    onProgress?: (progress: ModelLoadProgress) => void,\r\n  ): Promise<boolean> {\r\n    let progress = 0;\r\n    const reportProgress = (percent: number, message: string): void => {\r\n      if (!onProgress) return;\r\n      progress = Math.max(progress, Math.round(percent));\r\n      onProgress({\r\n        percent: Math.max(0, Math.min(100, progress)),\r\n        message,\r\n      });\r\n    };\r\n\r\n    reportProgress(2, '');\r\n    if (!this.isReady) {\r\n      reportProgress(8, ' Live2D ');\r\n      const ready = await this.init();\r\n      if (!ready) {\r\n        reportProgress(100, 'Live2D ');\r\n        return false;\r\n      }\r\n    }\r\n\r\n    const runtime = Live2DLoader.getRuntime(this._top()) ?? this._runtime;\r\n    const PIXI = runtime?.pixi ?? this._getPIXI();\r\n    const Live2DModel = runtime?.live2dModel ?? PIXI?.live2d?.Live2DModel;\r\n    if (!PIXI || !Live2DModel) {\r\n      reportProgress(100, 'Live2D ');\r\n      error('Live2D ');\r\n      return false;\r\n    }\r\n\r\n    reportProgress(12, '');\r\n    //  URL\n    let modelUrl: string;\r\n    if (modelPath.startsWith('http://') || modelPath.startsWith('https://')) {\r\n      modelUrl = modelPath;\r\n    } else {\r\n      modelUrl = `${LIVE2D_CDN_BASE}${modelPath}`;\r\n    }\r\n\r\n    modelUrl = this._normalizeRemoteUrl(modelUrl);\r\n\r\n    try {\r\n      log(':', modelPath);\r\n      reportProgress(18, '');\r\n\r\n      // \n      this.destroyModel();\n\r\n      const modelUrlCandidates = this._buildModelUrlCandidates(modelUrl);\r\n      let model: any = null;\r\n      let texturesReady = false;\r\n      let loadedFromUrl = modelUrl;\r\n      let lastError: unknown = null;\r\n\r\n      for (let i = 0; i < modelUrlCandidates.length; i++) {\r\n        const candidateUrl = modelUrlCandidates[i];\r\n        let attemptModel: any = null;\r\n        let attemptTexturesReady = false;\r\n        const attemptLabel = modelUrlCandidates.length > 1\r\n          ? ` (${i + 1}/${modelUrlCandidates.length})`\r\n          : '';\r\n        const attemptProgressStart = 24 + Math.floor((i / modelUrlCandidates.length) * 38);\r\n\r\n        try {\r\n          if (i > 0) {\r\n            log(':', candidateUrl);\r\n          }\r\n\r\n          reportProgress(attemptProgressStart, `${attemptLabel}`);\r\n          const dataUrl = await this._buildRemoteModelDataUrl(candidateUrl);\r\n          reportProgress(attemptProgressStart + 12, `${attemptLabel}`);\r\n          try {\r\n            attemptModel = await this._createModelWithTimeout(Live2DModel, dataUrl);\r\n          } catch (fromError) {\r\n            warn('', fromError);\r\n            reportProgress(attemptProgressStart + 16, `${attemptLabel}`);\r\n            const proxyDataUrl = await this._buildRemoteModelDataUrl(candidateUrl, true);\r\n            attemptModel = await this._createModelWithTimeout(Live2DModel, proxyDataUrl);\r\n            log('');\r\n          }\r\n\r\n          reportProgress(attemptProgressStart + 22, `${attemptLabel}`);\r\n          attemptTexturesReady = await this._waitForTextures(attemptModel, (loadedCount, totalCount) => {\r\n            if (totalCount <= 0) {\r\n              return;\r\n            }\r\n            const textureRatio = Math.max(0, Math.min(1, loadedCount / totalCount));\r\n            const textureProgress = attemptProgressStart + 22 + textureRatio * 14;\r\n            reportProgress(textureProgress, ` ${loadedCount}/${totalCount}${attemptLabel}`);\r\n          });\r\n          if (!attemptTexturesReady) {\r\n            warn('');\r\n            reportProgress(attemptProgressStart + 36, `${attemptLabel}`);\r\n            try {\r\n              const proxyDataUrl = await this._buildRemoteModelDataUrl(candidateUrl, true);\r\n              const proxyModel = await this._createModelWithTimeout(Live2DModel, proxyDataUrl);\r\n              const proxyTexturesReady = await this._waitForTextures(proxyModel, (loadedCount, totalCount) => {\r\n                if (totalCount <= 0) {\r\n                  return;\r\n                }\r\n                const textureRatio = Math.max(0, Math.min(1, loadedCount / totalCount));\r\n                const textureProgress = attemptProgressStart + 36 + textureRatio * 8;\r\n                reportProgress(textureProgress, ` ${loadedCount}/${totalCount}${attemptLabel}`);\r\n              });\r\n              if (proxyTexturesReady) {\r\n                try {\r\n                  attemptModel.destroy();\r\n                } catch {\r\n                  // ignore\r\n                }\r\n                attemptModel = proxyModel;\r\n                attemptTexturesReady = true;\r\n                log('');\r\n              } else {\r\n                warn('');\r\n                try {\r\n                  proxyModel.destroy();\r\n                } catch {\r\n                  // ignore\r\n                }\r\n              }\r\n            } catch (retryError) {\r\n              warn('', retryError);\r\n            }\r\n          }\r\n\r\n          if (!attemptTexturesReady) {\r\n            const hasNextCandidate = i < modelUrlCandidates.length - 1;\r\n            if (hasNextCandidate) {\r\n              warn(':', candidateUrl);\r\n              reportProgress(attemptProgressStart + 44, `${attemptLabel}`);\r\n              throw new Error('');\r\n            }\r\n            warn('');\r\n          }\r\n\r\n          model = attemptModel;\r\n          texturesReady = attemptTexturesReady;\r\n          loadedFromUrl = candidateUrl;\r\n          lastError = null;\r\n          break;\r\n        } catch (attemptError) {\r\n          lastError = attemptError;\r\n          warn(` (${i + 1}/${modelUrlCandidates.length})`, candidateUrl, attemptError);\r\n          try {\r\n            attemptModel?.destroy?.();\r\n          } catch {\r\n            // ignore\r\n          }\r\n        }\r\n      }\r\n\r\n      if (!model) {\r\n        throw (lastError instanceof Error ? lastError : new Error(''));\r\n      }\r\n\r\n      this.model = model;\n      const measuredBounds = this._readModelBaseBounds(model);\n      if (measuredBounds) {\n        this.modelBaseBounds = measuredBounds;\n        this.modelBaseWidth = measuredBounds.width;\n        this.modelBaseHeight = measuredBounds.height;\n      } else {\n        this.modelBaseBounds = null;\n        this.modelBaseWidth = model.width > 0 ? model.width : 500;\n        this.modelBaseHeight = model.height > 0 ? model.height : 800;\n      }\n      reportProgress(95, '');\n      log('', this.getExpressions());\n      log('', this.getMotionGroups());\n      if (!texturesReady) {\n        warn('');\n      }\n      if (loadedFromUrl !== modelUrl) {\r\n        log(':', loadedFromUrl);\r\n      }\r\n      reportProgress(100, '');\r\n      log('');\r\n      return true;\r\n    } catch (e) {\r\n      reportProgress(100, '');\r\n      error(':', e);\r\n      return false;\r\n    }\r\n  },\r\n\r\n  /**\n   *  model JSON URL\n   *  JSON  data URL \n   */\n  async _buildRemoteModelDataUrl(modelUrl: string, forceProxyResources = false): Promise<string> {\n    const candidateUrls = this._buildModelJsonCandidates(modelUrl);\r\n\r\n    let modelJson: any = null;\r\n    let sourceModelUrl = modelUrl;\r\n    let useProxy = false;\r\n\r\n    for (const candidateUrl of candidateUrls) {\r\n      try {\r\n        const direct = await this._fetchModelJsonCandidate(candidateUrl, false);\r\n        if (direct) {\r\n          modelJson = direct.modelJson;\r\n          sourceModelUrl = direct.sourceUrl;\r\n          useProxy = false;\r\n          break;\r\n        }\r\n      } catch (directError) {\r\n        warn(' JSON ', candidateUrl, directError);\r\n      }\r\n\r\n      try {\r\n        const proxied = await this._fetchModelJsonCandidate(candidateUrl, true);\r\n        if (proxied) {\r\n          modelJson = proxied.modelJson;\r\n          sourceModelUrl = proxied.sourceUrl;\r\n          useProxy = true;\r\n          break;\r\n        }\r\n      } catch (proxyError) {\r\n        warn(' JSON ', candidateUrl, proxyError);\r\n      }\r\n    }\r\n\r\n    if (!modelJson) {\r\n      throw new Error(' JSON ');\r\n    }\r\n\r\n    if (sourceModelUrl !== modelUrl) {\r\n      log(' JSON :', sourceModelUrl);\r\n    }\r\n\r\n    const modifiedModelJson = JSON.parse(JSON.stringify(modelJson));\r\n    this._normalizeLegacyCubism2Settings(modifiedModelJson);\r\n\r\n    //  URL\n    const resolveUrl = (p: string): string => {\n      if (typeof p !== 'string') return p;\r\n      const raw = p.trim();\r\n      if (!raw) return p;\r\n\r\n      const normalized = this._normalizeResourceRef(raw);\r\n      const hasScheme = /^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(normalized);\r\n      const abs = hasScheme\r\n        ? this._normalizeRemoteUrl(normalized)\r\n        : this._normalizeRemoteUrl(new URL(normalized, sourceModelUrl).toString());\r\n\r\n      if ((useProxy || forceProxyResources) && (abs.startsWith('http://') || abs.startsWith('https://'))) {\r\n        return this._getProxiedUrl(abs);\r\n      }\r\n      return abs;\r\n    };\r\n\r\n    //  Cubism 3/4 model3.json\n    if (modifiedModelJson?.FileReferences) {\r\n      const refs = modifiedModelJson.FileReferences;\r\n      for (const key of Object.keys(refs)) {\r\n        if (typeof refs[key] === 'string') {\r\n          refs[key] = resolveUrl(refs[key]);\r\n        }\r\n      }\r\n\r\n      if (typeof refs.Moc === 'string') refs.Moc = resolveUrl(refs.Moc);\r\n      if (Array.isArray(refs.Textures)) refs.Textures = refs.Textures.map(resolveUrl);\r\n      if (typeof refs.Physics === 'string') refs.Physics = resolveUrl(refs.Physics);\r\n      if (typeof refs.Pose === 'string') refs.Pose = resolveUrl(refs.Pose);\r\n      if (typeof refs.UserData === 'string') refs.UserData = resolveUrl(refs.UserData);\r\n\r\n      if (refs.Motions && typeof refs.Motions === 'object') {\r\n        for (const groupName of Object.keys(refs.Motions)) {\r\n          const motionList = refs.Motions[groupName];\r\n          if (!Array.isArray(motionList)) continue;\r\n          for (const motionDef of motionList) {\r\n            if (!motionDef || typeof motionDef !== 'object') continue;\r\n            if (typeof motionDef.File === 'string') motionDef.File = resolveUrl(motionDef.File);\r\n            if (typeof motionDef.Sound === 'string') motionDef.Sound = resolveUrl(motionDef.Sound);\r\n          }\r\n        }\r\n      }\r\n\r\n      if (Array.isArray(refs.Expressions)) {\r\n        for (const exprDef of refs.Expressions) {\r\n          if (!exprDef || typeof exprDef !== 'object') continue;\r\n          if (typeof exprDef.File === 'string') exprDef.File = resolveUrl(exprDef.File);\r\n        }\r\n      }\r\n    } else {\n      //  Cubism 2.1 model.json\n      if (typeof modifiedModelJson.model === 'string') {\n        modifiedModelJson.model = resolveUrl(modifiedModelJson.model);\n      } else if (typeof modifiedModelJson.Model === 'string') {\n        modifiedModelJson.Model = resolveUrl(modifiedModelJson.Model);\r\n      }\r\n\r\n      const textures = modifiedModelJson.textures || modifiedModelJson.Textures;\r\n      if (Array.isArray(textures)) {\r\n        for (let i = 0; i < textures.length; i++) {\r\n          if (typeof textures[i] === 'string') textures[i] = resolveUrl(textures[i]);\r\n        }\r\n      }\r\n\r\n      if (typeof modifiedModelJson.physics === 'string') modifiedModelJson.physics = resolveUrl(modifiedModelJson.physics);\r\n      if (typeof modifiedModelJson.Physics === 'string') modifiedModelJson.Physics = resolveUrl(modifiedModelJson.Physics);\r\n      if (typeof modifiedModelJson.pose === 'string') modifiedModelJson.pose = resolveUrl(modifiedModelJson.pose);\r\n      if (typeof modifiedModelJson.Pose === 'string') modifiedModelJson.Pose = resolveUrl(modifiedModelJson.Pose);\r\n\r\n      const motions = modifiedModelJson.motions || modifiedModelJson.Motions;\r\n      if (motions && typeof motions === 'object') {\r\n        for (const groupName of Object.keys(motions)) {\r\n          const motionList = motions[groupName];\r\n          if (!Array.isArray(motionList)) continue;\r\n          for (const motionDef of motionList) {\r\n            if (!motionDef || typeof motionDef !== 'object') continue;\r\n            if (typeof motionDef.file === 'string') motionDef.file = resolveUrl(motionDef.file);\r\n            if (typeof motionDef.File === 'string') motionDef.File = resolveUrl(motionDef.File);\r\n            if (typeof motionDef.sound === 'string') motionDef.sound = resolveUrl(motionDef.sound);\r\n            if (typeof motionDef.Sound === 'string') motionDef.Sound = resolveUrl(motionDef.Sound);\r\n          }\r\n        }\r\n      }\r\n\r\n      const expressions = modifiedModelJson.expressions || modifiedModelJson.Expressions;\r\n      if (Array.isArray(expressions)) {\n        for (const exprDef of expressions) {\n          if (!exprDef || typeof exprDef !== 'object') continue;\n          if (typeof exprDef.file === 'string') exprDef.file = resolveUrl(exprDef.file);\n          if (typeof exprDef.File === 'string') exprDef.File = resolveUrl(exprDef.File);\n        }\n      }\n    }\n\n    //  model json/\n    this._lastModelJson = modifiedModelJson;\n    this._lastModelJsonSourceUrl = sourceModelUrl;\n\n    //  data URL\n    const modelJsonStr = JSON.stringify(modifiedModelJson);\n    const modelJsonBase64 = btoa(unescape(encodeURIComponent(modelJsonStr)));\n    return `data:application/json;base64,${modelJsonBase64}`;\n  },\n\r\n  /**\n   *  PIXI \n   */\n  mountToStage(stageWidth: number, stageHeight: number, scale: number): void {\n    if (!this.model) return;\n\r\n    const stage = Live2DStage.getStage();\r\n    if (!stage) return;\r\n\r\n    // \n    while (stage.children.length > 0) {\n      stage.removeChildAt(0);\n    }\r\n\r\n    const transform = this._applyStageTransform(stageWidth, stageHeight, scale);\n    if (!transform) return;\n\n    stage.addChild(this.model);\n\n    try {\n      if ('autoUpdate' in this.model) {\n        (this.model as any).autoUpdate = true;\n      }\n    } catch {\n      // ignore\n    }\n\n    log('', {\n      stageWidth: transform.stageWidth,\n      stageHeight: transform.stageHeight,\n      scale: transform.finalScale,\n      modelWidth: transform.modelWidth,\n      modelHeight: transform.modelHeight,\n    });\n\r\n    //  idle\r\n    if (this.autoMotionLoopEnabled) {\r\n      this._startAutoMotionLoop();\r\n    } else {\r\n      this._clearAutoMotionLoop();\r\n    }\r\n  },\r\n\r\n  /**\n   * \n   */\n  updateScale(stageWidth: number, stageHeight: number, scale: number): void {\n    if (!this.model) return;\n    this._applyStageTransform(stageWidth, stageHeight, scale);\n  },\n\r\n  /**\n   * \n   */\n  _getModelBaseSize(): { width: number; height: number } {\n    if (this.modelBaseBounds) {\n      return {\n        width: this.modelBaseBounds.width,\n        height: this.modelBaseBounds.height,\n      };\n    }\n\n    if (this.modelBaseWidth && this.modelBaseHeight) {\n      return {\n        width: this.modelBaseWidth,\n        height: this.modelBaseHeight,\r\n      };\r\n    }\r\n\r\n    if (!this.model) {\r\n      return { width: 500, height: 800 };\r\n    }\r\n\r\n    const scaleX = this.model.scale?.x || 1;\r\n    const scaleY = this.model.scale?.y || 1;\r\n    const width = this.model.width > 0 && scaleX !== 0 ? this.model.width / scaleX : 500;\r\n    const height = this.model.height > 0 && scaleY !== 0 ? this.model.height / scaleY : 800;\r\n\r\n    return { width, height };\r\n  },\r\n\r\n  /**\n   * \n   */\n  getExpressions(): string[] {\n    if (!this.model) return [];\n    try {\n      const names = collectExpressionNames(this.model);\n      if (names.length > 0) return names;\n\n      const cached = this._lastModelJson;\n      if (cached) {\n        const fallbackNames = collectExpressionNamesFromUnknown(cached);\n        if (fallbackNames.length > 0) return fallbackNames;\n      }\n\n      return [];\n    } catch (e) {\n      warn('', e);\n      return [];\n    }\n  },\n\r\n  /**\n   * \n   */\n  getMotionGroups(): Record<string, number> {\n    const groups: Record<string, number> = {};\n    if (!this.model) return groups;\n\n    const mergeGroupMap = (source: Record<string, number> | null | undefined): void => {\n      if (!source || typeof source !== 'object') return;\n      for (const [name, count] of Object.entries(source)) {\n        const keyRaw = String(name ?? '');\n        const keyTrimmed = keyRaw.trim();\n        if (!keyTrimmed && keyRaw !== '') continue;\n        const groupName = keyTrimmed || '';\n        const parsedCount = Number(count);\n        const safeCount = Number.isFinite(parsedCount) && parsedCount > 0 ? Math.max(1, Math.floor(parsedCount)) : 1;\n        const prev = groups[groupName];\n        groups[groupName] = Number.isFinite(prev) && prev > 0 ? Math.max(prev, safeCount) : safeCount;\n      }\n    };\n\n    const motionManager = this.model?.internalModel?.motionManager as any;\n    const defs = motionManager?.definitions;\n    if (defs && typeof defs === 'object') {\n      for (const [group, motions] of Object.entries(defs)) {\n        if (Array.isArray(motions)) {\n          groups[group] = motions.length;\n        }\n      }\n    }\n\n    try {\n      const groupNames = collectMotionGroupNames(this.model);\n      for (const groupName of groupNames) {\n        if (!Object.prototype.hasOwnProperty.call(groups, groupName)) {\n          groups[groupName] = 1;\n        } else if (!Number.isFinite(groups[groupName]) || groups[groupName] <= 0) {\n          groups[groupName] = 1;\n        }\n      }\n    } catch (e) {\n      warn('', e);\n    }\n\n    try {\n      mergeGroupMap(collectMotionGroupCountsFromUnknown(this.model?.internalModel?.settings));\n      mergeGroupMap(collectMotionGroupCountsFromUnknown(this.model?.internalModel?.motionManager?.settings));\n    } catch (e) {\n      warn('', e);\n    }\n\n    try {\n      const cached = this._lastModelJson;\n      if (cached) {\n        mergeGroupMap(collectMotionGroupCountsFromUnknown(cached));\n      }\n    } catch (e) {\n      warn('', e);\n    }\n    return groups;\n  },\n\n  /**\n   *  +  group/index\n   */\n  getMotions(): Live2DMotionEntry[] {\n    if (!this.model) return [];\n\n    try {\n      const merged: Live2DMotionEntry[] = [];\n      const seen = new Set<string>();\n\n      const pushAll = (items: Live2DMotionEntry[]) => {\n        for (const item of Array.isArray(items) ? items : []) {\n          const group = String(item?.group ?? '');\n          const indexRaw = Number(item?.index);\n          const index = Number.isFinite(indexRaw) ? Math.max(0, Math.floor(indexRaw)) : 0;\n          const name = String(item?.name ?? '').trim();\n          if (!name) continue;\n          const key = `${group}#${index}#${name.toLowerCase()}`;\n          if (seen.has(key)) continue;\n          seen.add(key);\n          merged.push({ group, index, name });\n        }\n      };\n\n      pushAll(collectMotionEntries(this.model));\n\n      const cached = this._lastModelJson;\n      if (cached) {\n        const cachedAny = cached as any;\n        const motionsContainer =\n          cachedAny?.FileReferences?.Motions ?? cachedAny?.Motions ?? cachedAny?.motions ?? null;\n        if (motionsContainer) {\n          pushAll(\n            collectMotionEntries({\n              internalModel: { motionManager: { definitions: motionsContainer }, settings: cached },\n            } as any),\n          );\n        }\n      }\n\n      return merged;\n    } catch (e) {\n      warn('', e);\n      return [];\n    }\n  },\n\n  /**\n   * \n   */\n  playExpression(name?: string): void {\n    if (!this.model) return;\r\n    try {\r\n      if (name) {\r\n        this.model.expression(name);\r\n      } else {\r\n        const expressions = this.getExpressions();\r\n        if (expressions.length > 0) {\r\n          const idx = Math.floor(Math.random() * expressions.length);\r\n          this.model.expression(expressions[idx]);\r\n        }\r\n      }\r\n    } catch (e) {\r\n      warn(':', e);\r\n    }\r\n  },\r\n\r\n  /**\n   * \n   */\n  playMotion(group?: string, index?: number): void {\n    if (!this.model) return;\r\n    try {\r\n      const runMotion = (groupName: string, motionIndex: number) => {\r\n        try {\r\n          this.model.motion(groupName, motionIndex);\r\n          return;\r\n        } catch (firstError) {\r\n          const mm = this.model?.internalModel?.motionManager as any;\r\n          if (typeof mm?.startMotion === 'function') {\r\n            mm.startMotion(groupName, motionIndex, 3);\r\n            return;\r\n          }\r\n          if (typeof mm?.startRandomMotion === 'function') {\r\n            mm.startRandomMotion(groupName, 3);\r\n            return;\r\n          }\r\n          throw firstError;\r\n        }\r\n      };\r\n\r\n      //  motions key  \"\"\r\n      if (typeof group === 'string') {\r\n        runMotion(group, index ?? 0);\r\n      } else {\r\n        const groups = this.getMotionGroups();\r\n        const groupNames = Object.keys(groups);\r\n        if (groupNames.length > 0) {\r\n          const randGroup = groupNames[Math.floor(Math.random() * groupNames.length)];\r\n          const count = groups[randGroup];\r\n          const randIndex = Math.floor(Math.random() * count);\r\n          runMotion(randGroup, randIndex);\r\n        }\r\n      }\r\n    } catch (e) {\r\n      warn(':', e);\r\n    }\r\n  },\r\n\r\n  /**\n   * \n   */\n  playRandomAnimation(): void {\n    this.playExpression();\n    this.playMotion();\n  },\n\n  /**\n   *  client \n   *  focus  no-op\n   */\n  focusByClientPoint(clientX: number, clientY: number, immediate = false): void {\n    const model = this.model;\n    if (!model) return;\n    if (!Number.isFinite(clientX) || !Number.isFinite(clientY)) return;\n\n    try {\n      if (typeof model.focus === 'function') {\n        model.focus(clientX, clientY, immediate);\n        return;\n      }\n    } catch {\n      return;\n    }\n\n    try {\n      const controller = model?.internalModel?.focusController;\n      if (!controller || typeof controller.focus !== 'function') return;\n\n      const rect = Live2DStage.container?.getBoundingClientRect?.();\n      if (!rect || rect.width <= 0 || rect.height <= 0) return;\n\n      const normalizedX = ((clientX - rect.left) / rect.width) * 2 - 1;\n      const normalizedY = ((clientY - rect.top) / rect.height) * 2 - 1;\n      controller.focus(\n        Math.max(-1, Math.min(1, normalizedX)),\n        Math.max(-1, Math.min(1, -normalizedY)),\n        immediate,\n      );\n    } catch {\n      // ignore\n    }\n  },\n\n  /**\n   * \n   */\n  focusCenter(immediate = true): void {\n    const model = this.model;\n    if (!model) return;\n\n    const rect = Live2DStage.container?.getBoundingClientRect?.();\n    if (rect && rect.width > 0 && rect.height > 0) {\n      this.focusByClientPoint(rect.left + rect.width / 2, rect.top + rect.height / 2, immediate);\n      return;\n    }\n\n    try {\n      const controller = model?.internalModel?.focusController;\n      if (!controller || typeof controller.focus !== 'function') return;\n      controller.focus(0, 0, immediate);\n    } catch {\n      // ignore\n    }\n  },\n\n  /**\n   *  TTS \n   * -  galgame  Live2DManager.setMouthOpen\n   * -  model characterId \r\n   */\r\n  setMouthOpen(_characterId: string, value: number): boolean {\r\n    const model = this.model;\r\n    if (!model?.internalModel?.coreModel) return false;\r\n\r\n    const coreModel = model.internalModel.coreModel;\r\n    const clampedValue = Math.max(0, Math.min(1, value));\r\n    this._mouthCurrentValue = clampedValue;\r\n    const topAny = this._top() as any;\n    const logPrefix = '[] LipSync';\n    this._ensureLipSyncHooks(model);\n    this._installCoreWriteMask(coreModel);\n\r\n    const getParamRange = (paramId: string, paramIndex: number): { min: number; max: number } => {\r\n      let min = Number.NaN;\r\n      let max = Number.NaN;\r\n\r\n      const readNumber = (v: any): number => {\r\n        const n = Number(v);\r\n        return Number.isFinite(n) ? n : Number.NaN;\r\n      };\r\n\r\n      if (Number.isFinite(paramIndex) && paramIndex >= 0) {\r\n        try {\r\n          if (typeof coreModel.getParameterMinimumValue === 'function') {\r\n            min = readNumber(coreModel.getParameterMinimumValue(paramIndex));\r\n          }\r\n        } catch {\r\n          // ignore\r\n        }\r\n        try {\r\n          if (typeof coreModel.getParameterMaximumValue === 'function') {\r\n            max = readNumber(coreModel.getParameterMaximumValue(paramIndex));\r\n          }\r\n        } catch {\r\n          // ignore\r\n        }\r\n      }\r\n\r\n      if (!Number.isFinite(min)) {\r\n        try {\r\n          if (typeof coreModel.getParamMin === 'function') {\r\n            min = readNumber(coreModel.getParamMin(paramId));\r\n          }\r\n        } catch {\r\n          // ignore\r\n        }\r\n      }\r\n      if (!Number.isFinite(max)) {\r\n        try {\r\n          if (typeof coreModel.getParamMax === 'function') {\r\n            max = readNumber(coreModel.getParamMax(paramId));\r\n          }\r\n        } catch {\r\n          // ignore\r\n        }\r\n      }\r\n\r\n      if (!Number.isFinite(min)) min = 0;\r\n      if (!Number.isFinite(max) || max <= min) max = 1;\r\n      return { min, max };\r\n    };\r\n\r\n    const mapToParamValue = (paramId: string, paramIndex: number): number => {\r\n      const { min, max } = getParamRange(paramId, paramIndex);\r\n      //  [-x, +x]  0 \r\n      if (min < 0 && max > 0) {\r\n        return clampedValue * max;\r\n      }\r\n      return min + (max - min) * clampedValue;\r\n    };\r\n\r\n    const getIndexById = (paramId: string): number => {\r\n      try {\r\n        if (typeof coreModel.getParameterIndex === 'function') {\r\n          return coreModel.getParameterIndex(paramId);\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.getParamIndex === 'function') {\r\n          return coreModel.getParamIndex(paramId);\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      return -1;\r\n    };\r\n\r\n    const applyById = (paramId: string): boolean => {\r\n      const paramIndex = getIndexById(paramId);\r\n      const mappedValue = mapToParamValue(paramId, paramIndex);\r\n      try {\r\n        if (typeof coreModel.setParameterValueById === 'function') {\r\n          coreModel.setParameterValueById(paramId, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.addParameterValueById === 'function') {\r\n          coreModel.addParameterValueById(paramId, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.setParamFloat === 'function') {\r\n          coreModel.setParamFloat(paramId, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.addParamFloat === 'function') {\r\n          coreModel.addParamFloat(paramId, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      return false;\r\n    };\r\n\r\n    const applyByIndex = (paramIndex: number): boolean => {\r\n      if (!Number.isFinite(paramIndex) || paramIndex < 0) return false;\r\n      const paramId = (() => {\r\n        try {\r\n          if (typeof coreModel.getParameterId === 'function') {\r\n            return String(coreModel.getParameterId(paramIndex) || '');\r\n          }\r\n        } catch {\r\n          // ignore\r\n        }\r\n        return '';\r\n      })();\r\n      const mappedValue = mapToParamValue(paramId || `__idx_${paramIndex}`, paramIndex);\r\n      try {\r\n        if (typeof coreModel.setParameterValueByIndex === 'function') {\r\n          coreModel.setParameterValueByIndex(paramIndex, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.addParameterValueByIndex === 'function') {\r\n          coreModel.addParameterValueByIndex(paramIndex, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.setParameterValue === 'function') {\r\n          coreModel.setParameterValue(paramIndex, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.addParameterValue === 'function') {\r\n          coreModel.addParameterValue(paramIndex, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      return false;\r\n    };\r\n\r\n    const paramNames = [\r\n      'ParamMouthOpenY',\r\n      'PARAM_MOUTH_OPEN_Y',\r\n      'ParamMouthOpen',\r\n      'ParamA',\r\n      'Param58',\r\n      'Param61',\r\n      'Param_Mouth_Open',\r\n      'mouth_open',\r\n    ];\r\n\r\n    let appliedAny = false;\r\n    if (this._manualMouthParamEnabled && this._manualMouthParamIds.length > 0) {\r\n      for (const manualId of this._manualMouthParamIds) {\r\n        const idx = getIndexById(manualId);\r\n        if (applyById(manualId)) appliedAny = true;\r\n        if (applyByIndex(idx)) appliedAny = true;\r\n      }\r\n    }\r\n\r\n    const visited = new Set<string>();\r\n    for (const paramName of paramNames) {\r\n      if (visited.has(paramName)) continue;\r\n      visited.add(paramName);\r\n      const paramIndex = getIndexById(paramName);\r\n      if (paramIndex >= 0) {\r\n        if (applyById(paramName)) appliedAny = true;\r\n        if (applyByIndex(paramIndex)) appliedAny = true;\r\n      }\r\n    }\r\n    if (appliedAny) return true;\r\n\r\n    //  mouth/lip/ParamA\r\n    if (this._mouthParamCore !== coreModel) {\r\n      this._mouthParamCore = coreModel;\r\n      this._mouthParamIds = [];\r\n      this._mouthParamIndexes = [];\r\n      this._mouthParamRangeMins = [];\r\n      this._mouthParamRangeMaxs = [];\r\n      this._mouthParamWarned = false;\r\n      try {\r\n        if (typeof coreModel.getParameterCount === 'function' && typeof coreModel.getParameterId === 'function') {\r\n          const count = Number(coreModel.getParameterCount()) || 0;\r\n          const numericFallback: Array<{ id: string; idx: number; min: number; max: number }> = [];\r\n          for (let i = 0; i < count; i++) {\r\n            const pid = String(coreModel.getParameterId(i) || '');\r\n            const low = pid.toLowerCase();\r\n            const range = getParamRange(pid, i);\r\n            if (low.includes('mouth') || low.includes('lip') || pid === 'ParamA') {\r\n              this._mouthParamIds.push(pid);\r\n              this._mouthParamIndexes.push(i);\r\n              this._mouthParamRangeMins.push(range.min);\r\n              this._mouthParamRangeMaxs.push(range.max);\r\n              continue;\r\n            }\r\n\r\n            // Cubism2  Param58/Param61\r\n            if (/^param\\d+$/i.test(pid) && range.max >= 8 && range.min >= -1) {\r\n              numericFallback.push({ id: pid, idx: i, min: range.min, max: range.max });\r\n            }\r\n          }\r\n\r\n          if (this._mouthParamIds.length === 0 && numericFallback.length > 0) {\r\n            numericFallback.sort((a, b) => b.max - a.max);\r\n            const picked = numericFallback.slice(0, 3);\r\n            for (const item of picked) {\r\n              this._mouthParamIds.push(item.id);\r\n              this._mouthParamIndexes.push(item.idx);\r\n              this._mouthParamRangeMins.push(item.min);\r\n              this._mouthParamRangeMaxs.push(item.max);\r\n            }\r\n            try {\r\n              topAny?.console?.log?.(`${logPrefix}: `, picked);\r\n            } catch {\r\n              // ignore\r\n            }\r\n          }\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    for (let i = 0; i < this._mouthParamIds.length; i++) {\r\n      const pid = this._mouthParamIds[i];\r\n      const pidx = this._mouthParamIndexes[i] ?? -1;\r\n      if (applyById(pid)) appliedAny = true;\r\n      if (applyByIndex(pidx)) appliedAny = true;\r\n    }\r\n    if (appliedAny) return true;\r\n\r\n    if (!this._mouthParamWarned) {\r\n      this._mouthParamWarned = true;\r\n      const msg = `${logPrefix}: `;\r\n      try {\r\n        topAny?.console?.warn?.(msg, {\r\n          presetCandidates: paramNames,\r\n          scannedIds: this._mouthParamIds,\r\n        });\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    return false;\r\n  },\r\n\r\n  _isMouthParam(paramIdOrIndex: string | number, coreModel: any): boolean {\r\n    const preset = [\r\n      'parammouthopeny',\r\n      'param_mouth_open_y',\r\n      'parammouthopen',\r\n      'parama',\r\n      'param58',\r\n      'param61',\r\n      'param_mouth_open',\r\n      'mouth_open',\r\n    ];\r\n\r\n    if (typeof paramIdOrIndex === 'number') {\r\n      if (this._mouthParamIndexes.includes(paramIdOrIndex)) return true;\r\n      try {\r\n        if (typeof coreModel?.getParameterId === 'function') {\r\n          const pid = String(coreModel.getParameterId(paramIdOrIndex) || '').trim();\r\n          if (pid) return this._isMouthParam(pid, coreModel);\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      return false;\r\n    }\r\n\r\n    const id = String(paramIdOrIndex || '').trim().toLowerCase();\r\n    if (!id) return false;\r\n\r\n    if (this._manualMouthParamEnabled && this._manualMouthParamIdSet.size > 0) {\r\n      if (this._manualMouthParamIdSet.has(id)) return true;\r\n    }\r\n\r\n    if (preset.includes(id)) return true;\r\n\r\n    return this._mouthParamIds.some(pid => String(pid || '').trim().toLowerCase() === id);\r\n  },\r\n\r\n  _installCoreWriteMask(coreModel: any): void {\r\n    if (!coreModel) return;\r\n    if (this._writeMaskCore === coreModel) return;\r\n\r\n    if (this._writeMaskRestore) {\r\n      try {\r\n        this._writeMaskRestore();\r\n      } catch {\r\n        // ignore\r\n      }\r\n      this._writeMaskCore = null;\r\n      this._writeMaskRestore = null;\r\n    }\r\n\r\n    const restoreEntries: Array<{ method: string; raw: any }> = [];\r\n    const methods = [\r\n      'setParameterValueById',\r\n      'addParameterValueById',\r\n      'setParamFloat',\r\n      'addParamFloat',\r\n      'setParameterValueByIndex',\r\n      'addParameterValueByIndex',\r\n      'setParameterValue',\r\n      'addParameterValue',\r\n    ];\r\n\r\n    const getParamRef = (method: string, args: any[]): string | number | null => {\r\n      if (!Array.isArray(args) || args.length === 0) return null;\r\n      const first = args[0];\r\n      if (method.includes('ById') || method === 'setParamFloat' || method === 'addParamFloat') {\r\n        return typeof first === 'string' ? first : null;\r\n      }\r\n      if (method.includes('ByIndex')) {\r\n        return typeof first === 'number' ? first : null;\r\n      }\r\n      if (method === 'setParameterValue' || method === 'addParameterValue') {\r\n        if (typeof first === 'number' || typeof first === 'string') return first;\r\n      }\r\n      return null;\r\n    };\r\n\r\n    for (const method of methods) {\r\n      const raw = coreModel?.[method];\r\n      if (typeof raw !== 'function') continue;\r\n      restoreEntries.push({ method, raw });\r\n      coreModel[method] = (...args: any[]) => {\r\n        const paramRef = getParamRef(method, args);\r\n        if (\r\n          paramRef !== null &&\r\n          this._lipSyncActive &&\r\n          this._inModelUpdate &&\r\n          this._isMouthParam(paramRef, coreModel)\r\n        ) {\r\n          return undefined;\r\n        }\r\n        return raw.apply(coreModel, args);\r\n      };\r\n    }\r\n\r\n    this._writeMaskCore = coreModel;\r\n    this._writeMaskRestore = () => {\r\n      for (const entry of restoreEntries) {\r\n        try {\r\n          coreModel[entry.method] = entry.raw;\r\n        } catch {\r\n          // ignore\r\n        }\r\n      }\r\n    };\r\n  },\r\n\r\n  _ensureLipSyncHooks(model: any): void {\r\n    if (!model) return;\r\n    if (this._updateHookModel === model) return;\r\n\r\n    if (this._updateHookRestore) {\r\n      try {\r\n        this._updateHookRestore();\r\n      } catch {\r\n        // ignore\r\n      }\r\n      this._updateHookRestore = null;\r\n      this._updateHookModel = null;\r\n    }\r\n\r\n    const internal = model?.internalModel;\r\n    const updater = internal?.update;\r\n    if (typeof updater !== 'function') return;\r\n\r\n    const rawUpdate = updater.bind(internal);\r\n    const self = this;\r\n    internal.update = function (...args: any[]) {\r\n      self._inModelUpdate = true;\r\n      let ret: any;\r\n      try {\r\n        ret = rawUpdate(...args);\r\n      } finally {\r\n        self._inModelUpdate = false;\r\n        if (self._lipSyncActive) {\r\n          try {\r\n            self._applyMouthValueToModel(model);\r\n          } catch {\r\n            // ignore\r\n          }\r\n        }\r\n      }\r\n      return ret;\r\n    };\r\n\r\n    this._updateHookModel = model;\r\n    this._updateHookRestore = () => {\r\n      try {\r\n        internal.update = updater;\r\n      } catch {\r\n        // ignore\r\n      }\r\n    };\r\n  },\r\n\r\n  _applyMouthValueToModel(model: any): boolean {\r\n    if (!model?.internalModel?.coreModel) return false;\r\n    const targetValue = Math.max(0, Math.min(1, this._mouthCurrentValue || 0));\r\n    const oldValue = this._mouthCurrentValue;\r\n    this._mouthCurrentValue = targetValue;\r\n    const applied = this.setMouthOpen('__mouth_hook__', targetValue);\r\n    this._mouthCurrentValue = oldValue;\r\n    return applied;\r\n  },\r\n\r\n  _getMouthParamSource(): 'manual' | 'auto' {\r\n    if (this._manualMouthParamEnabled && this._manualMouthParamIdSet.size > 0) {\r\n      return 'manual';\r\n    }\r\n    return 'auto';\r\n  },\r\n\r\n  getLipSyncDebugInfo(): {\n    lipSyncOverride: 'active' | 'inactive';\n    mouthParamsSource: 'manual' | 'auto';\n    mouthParamsCount: number;\n  } {\n    this._refreshManualMouthParams();\n    const source = this._getMouthParamSource();\n    const count = source === 'manual' ? this._manualMouthParamIdSet.size : this._mouthParamIds.length;\n    return {\n      lipSyncOverride: this._lipSyncActive ? 'active' : 'inactive',\n      mouthParamsSource: source,\r\n      mouthParamsCount: count,\r\n    };\r\n  },\r\n\r\n  /**\n   * \n   */\n  destroyModel(): void {\n    this._clearAutoMotionLoop();\n    this._lipSyncActive = false;\n    this._inModelUpdate = false;\n\n    if (this.model) {\r\n      try {\r\n        if (this.model.parent) {\r\n          this.model.parent.removeChild(this.model);\r\n        }\r\n        this.model.destroy();\r\n      } catch (e) {\r\n        warn('', e);\r\n      }\r\n      this.model = null;\r\n    }\r\n    this._mouthParamCore = null;\r\n    this._mouthParamIds = [];\r\n    this._mouthParamIndexes = [];\r\n    this._mouthParamRangeMins = [];\r\n    this._mouthParamRangeMaxs = [];\r\n    this._mouthParamWarned = false;\r\n    this._mouthCurrentValue = 0;\r\n    if (this._writeMaskRestore) {\r\n      try {\r\n        this._writeMaskRestore();\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n    this._writeMaskCore = null;\r\n    this._writeMaskRestore = null;\r\n    if (this._updateHookRestore) {\r\n      try {\r\n        this._updateHookRestore();\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n    this._updateHookModel = null;\r\n    this._updateHookRestore = null;\r\n    this._manualMouthParamEnabled = false;\n    this._manualMouthParamIds = [];\n    this._manualMouthParamIdSet.clear();\n    this.modelBaseWidth = null;\n    this.modelBaseHeight = null;\n    this.modelBaseBounds = null;\n    this._lastModelJson = null;\n    this._lastModelJsonSourceUrl = '';\n  },\n\r\n  /**\n   * \n   */\n  async _waitForTextures(\n    model: any,\r\n    onProgress?: (loadedCount: number, totalCount: number) => void,\r\n  ): Promise<boolean> {\r\n    return new Promise((resolve) => {\r\n      let retryCount = 0;\r\n      const maxRetries = 80;\r\n\r\n      const check = () => {\r\n        retryCount++;\r\n        if (retryCount > maxRetries) {\r\n          const internal = model.internalModel;\r\n          const textures = internal?.textures || internal?._textures || [];\r\n          const textureList = Array.isArray(textures) ? textures : [];\r\n          const loadedCount = textureList.filter((tex: any) => !!tex?.baseTexture?.valid).length;\r\n          onProgress?.(loadedCount, textureList.length);\r\n          warn(` (${loadedCount}/${textureList.length})`);\r\n          resolve(false);\r\n          return;\r\n        }\r\n\r\n        const internal = model.internalModel;\r\n        if (!internal) {\r\n          setTimeout(check, 100);\r\n          return;\r\n        }\r\n\r\n        const textures = internal.textures || internal._textures || [];\r\n        if (textures.length === 0) {\r\n          onProgress?.(1, 1);\r\n          resolve(true);\r\n          return;\r\n        }\r\n\r\n        const loadedCount = textures.filter((tex: any) => {\r\n          if (!tex) return false;\r\n          if (tex.baseTexture) return tex.baseTexture.valid;\r\n          return true;\r\n        }).length;\r\n        onProgress?.(loadedCount, textures.length);\r\n\r\n        const allLoaded = textures.every((tex: any) => {\r\n          if (!tex) return false;\r\n          if (tex.baseTexture) return tex.baseTexture.valid;\r\n          return true;\r\n        });\r\n\r\n        if (allLoaded) {\r\n          resolve(true);\r\n        } else {\r\n          setTimeout(check, 100);\r\n        }\r\n      };\r\n\r\n      check();\r\n    });\r\n  },\r\n};\r\n\r\n\r\n\r\n","import { SCRIPT_NAME } from '../core/constants';\nimport { Live2DManager } from './manager';\n\n// : TTSManager._getProxiedAudioUrl ( audio/tts-manager.ts)\nlet _ttsGetProxiedAudioUrlRef: ((url: string) => string) | null = null;\nexport function setLipSyncRefs({ getProxiedAudioUrl }: { getProxiedAudioUrl?: (url: string) => string }): void {\n  if (getProxiedAudioUrl) _ttsGetProxiedAudioUrlRef = getProxiedAudioUrl;\n}\n\nfunction getTopWindow(): Window {\n  try {\n    return window.parent ?? window;\n  } catch {\n    return window;\n  }\n}\n\n// ============================================\n// LipSync  ()\n// : galgame/src/live2d/lip-sync.js\n// ============================================\nexport const LipSyncManager = {\n  audioContext: null as AudioContext | null,\n  analyser: null as AnalyserNode | null,\n  dataArray: null as Uint8Array | null,\n  source: null as MediaElementAudioSourceNode | null,\n  animationFrameId: null as number | null,\n  currentCharacterId: null as string | null,\n  lastVolume: 0,\n  connectedAudioElements: new WeakSet<HTMLAudioElement>(),\n  _proxyAudio: null as HTMLAudioElement | null,\n  _proxyAudioCleanup: null as (() => void) | null,\n\n  config: {\n    fftSize: 256,\n    smoothingFactor: 0.5,\n    sensitivity: 2.5,\n    minThreshold: 0.01,\n  },\n\n  init(): void {\n    if (this.audioContext) {\n      if (this.audioContext.state === 'suspended') {\n        this.audioContext.resume().then(() => {\n          console.log(`[${SCRIPT_NAME}] LipSync: AudioContext `);\n        });\n      }\n      return;\n    }\n\n    const topAny: any = getTopWindow() as any;\n    const AudioContextClass = topAny.AudioContext || topAny.webkitAudioContext;\n    if (!AudioContextClass) {\n      console.warn(`[${SCRIPT_NAME}] LipSync:  Web Audio API`);\n      return;\n    }\n\n    this.audioContext = new AudioContextClass();\n    this.analyser = this.audioContext.createAnalyser();\n    this.analyser.fftSize = this.config.fftSize;\n    this.analyser.smoothingTimeConstant = this.config.smoothingFactor;\n    this.dataArray = new Uint8Array(this.analyser.frequencyBinCount);\n    console.log(`[${SCRIPT_NAME}] LipSyncManager `);\n  },\n\n  _getProxiedAudioUrl(originalUrl: string): string {\n    if (_ttsGetProxiedAudioUrlRef) {\n      return _ttsGetProxiedAudioUrlRef(originalUrl);\n    }\n\n    const topAny: any = getTopWindow() as any;\n\n    if (typeof topAny.getCorsProxyUrl === 'function') {\n      try {\n        const proxied = topAny.getCorsProxyUrl(originalUrl);\n        console.log(`[${SCRIPT_NAME}] LipSync:  getCorsProxyUrl `);\n        return proxied;\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] LipSync: getCorsProxyUrl `, e);\n      }\n    }\n\n    if (typeof topAny.enableCorsProxy === 'function') {\n      try {\n        const proxied = topAny.enableCorsProxy(originalUrl);\n        if (typeof proxied === 'string' && proxied) {\n          console.log(`[${SCRIPT_NAME}] LipSync:  enableCorsProxy `);\n          return proxied;\n        }\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] LipSync: enableCorsProxy `, e);\n      }\n    }\n\n    if (topAny.corsProxy?.getProxyUrl) {\n      try {\n        const proxied = topAny.corsProxy.getProxyUrl(originalUrl);\n        console.log(`[${SCRIPT_NAME}] LipSync:  corsProxy.getProxyUrl `);\n        return proxied;\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] LipSync: corsProxy.getProxyUrl `, e);\n      }\n    }\n\n    if (topAny.location) {\n      const origin = topAny.location.origin;\n      console.log(`[${SCRIPT_NAME}] LipSync:  /proxy`);\n      return `${origin}/proxy?url=${encodeURIComponent(originalUrl)}`;\n    }\n\n    return originalUrl;\n  },\n\n  connectAudio(audioElement: HTMLAudioElement): boolean {\n    if (!audioElement) return false;\n\n    if (this.connectedAudioElements.has(audioElement)) {\n      this.init();\n      if (this.audioContext?.state === 'suspended') {\n        this.audioContext.resume();\n      }\n      return true;\n    }\n\n    this.init();\n    if (!this.audioContext || !this.analyser) return false;\n\n    if (this.audioContext.state === 'suspended') {\n      this.audioContext.resume().catch(e => console.warn('AudioContext resume failed:', e));\n    }\n\n    try {\n      if (this.source) {\n        try {\n          this.source.disconnect();\n        } catch {\n          // ignore\n        }\n      }\n\n      const topAny: any = getTopWindow() as any;\n      let targetAudio: HTMLAudioElement = audioElement;\n      const src = audioElement.src || '';\n      const isLocalhost = src.includes('127.0.0.1') || src.includes('localhost');\n      const isDataUrl = src.startsWith('data:');\n      const isBlobUrl = src.startsWith('blob:');\n      let isSameOrigin = false;\n      try {\n        const base = topAny.location?.origin || window.location.origin;\n        const url = new URL(src, base);\n        isSameOrigin = url.origin === base;\n      } catch {\n        // ignore\n      }\n\n      if (!isLocalhost && !isDataUrl && !isBlobUrl && !isSameOrigin) {\n        console.log(`[${SCRIPT_NAME}] LipSync: `);\n        const proxiedUrl = this._getProxiedAudioUrl(src);\n        if (proxiedUrl && proxiedUrl !== src) {\n          targetAudio = new Audio(proxiedUrl);\n          targetAudio.crossOrigin = 'anonymous';\n          console.log(`[${SCRIPT_NAME}] LipSync: `, proxiedUrl.substring(0, 50) + '...');\n\n          targetAudio.currentTime = audioElement.currentTime;\n          targetAudio.volume = 0.001;\n\n          if (!audioElement.paused) {\n            targetAudio.play().catch(e => {\n              console.warn(`[${SCRIPT_NAME}] LipSync: `, e);\n            });\n          }\n\n          const syncPlay = () => {\n            if (this._proxyAudio && this._proxyAudio.paused) {\n              this._proxyAudio.currentTime = audioElement.currentTime;\n              this._proxyAudio.play().catch(() => {});\n            }\n          };\n          const syncPause = () => {\n            if (this._proxyAudio) {\n              this._proxyAudio.pause();\n            }\n          };\n          const syncSeek = () => {\n            if (this._proxyAudio) {\n              this._proxyAudio.currentTime = audioElement.currentTime;\n            }\n          };\n\n          audioElement.addEventListener('play', syncPlay);\n          audioElement.addEventListener('playing', syncPlay);\n          audioElement.addEventListener('pause', syncPause);\n          audioElement.addEventListener('ended', syncPause);\n          audioElement.addEventListener('seeked', syncSeek);\n\n          this._proxyAudio = targetAudio;\n          this._proxyAudioCleanup = () => {\n            audioElement.removeEventListener('play', syncPlay);\n            audioElement.removeEventListener('playing', syncPlay);\n            audioElement.removeEventListener('pause', syncPause);\n            audioElement.removeEventListener('ended', syncPause);\n            audioElement.removeEventListener('seeked', syncSeek);\n          };\n        }\n      }\n\n      console.log(`[${SCRIPT_NAME}] LipSync: `, targetAudio.src?.substring(0, 50) + '...');\n      this.source = this.audioContext.createMediaElementSource(targetAudio);\n      this.source.connect(this.analyser);\n      this.analyser.connect(this.audioContext.destination);\n      this.connectedAudioElements.add(audioElement);\n      return true;\n    } catch (e) {\n      console.warn(`[${SCRIPT_NAME}] LipSync:  ( Source )`, e);\n      return false;\n    }\n  },\n\n  getVolume(): number {\n    if (!this.analyser || !this.dataArray) return 0;\n    this.analyser.getByteFrequencyData(this.dataArray);\n\n    let sum = 0;\n    const length = Math.floor(this.dataArray.length * 0.75);\n    for (let i = 0; i < length; i++) {\n      sum += this.dataArray[i];\n    }\n    const average = sum / length / 255;\n    return Math.min(1, average * this.config.sensitivity);\n  },\n\n  async startSync(characterId: string): Promise<void> {\n    this.stopSync();\n    this.currentCharacterId = characterId;\n    Live2DManager._setLipSyncActive(true);\n\n    if (this.audioContext?.state === 'suspended') {\n      try {\n        await this.audioContext.resume();\n        console.log(`[${SCRIPT_NAME}] LipSync: AudioContext `);\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] LipSync: AudioContext `, e);\n      }\n    }\n\n    console.log(\n      `[${SCRIPT_NAME}] LipSync:  - characterId=${characterId}, AudioContext.state=${this.audioContext?.state}`,\n    );\n\n    let frameCount = 0;\n    const update = () => {\n      if (!this.currentCharacterId) return;\n\n      let volume = this.getVolume();\n      if (volume < this.config.minThreshold) volume = 0;\n\n      volume = this.lastVolume * 0.4 + volume * 0.6;\n      this.lastVolume = volume;\n\n      frameCount++;\n      if (frameCount % 30 === 0) {\n        console.log(`[${SCRIPT_NAME}] LipSync: =${volume.toFixed(3)}, rawData[0]=${this.dataArray?.[0]}`);\n      }\n\n      Live2DManager.setMouthOpen(this.currentCharacterId, volume);\n      this.animationFrameId = requestAnimationFrame(update);\n    };\n    update();\n  },\n\n  stopSync(): void {\n    if (this.animationFrameId) {\n      cancelAnimationFrame(this.animationFrameId);\n      this.animationFrameId = null;\n    }\n\n    if (this.currentCharacterId) {\n      Live2DManager.setMouthOpen(this.currentCharacterId, 0);\n    }\n    this.currentCharacterId = null;\n    this.lastVolume = 0;\n    Live2DManager._setLipSyncActive(false);\n\n    if (this._proxyAudioCleanup) {\n      try {\n        this._proxyAudioCleanup();\n      } catch {\n        // ignore\n      }\n      this._proxyAudioCleanup = null;\n    }\n\n    if (this._proxyAudio) {\n      try {\n        this._proxyAudio.pause();\n        this._proxyAudio.src = '';\n      } catch {\n        // ignore\n      }\n      this._proxyAudio = null;\n    }\n  },\n\n  cleanup(): void {\n    this.stopSync();\n    if (this.source) {\n      try {\n        this.source.disconnect();\n      } catch {\n        // ignore\n      }\n      this.source = null;\n    }\n  },\n};\n","import { SCRIPT_NAME } from '../core/constants';\r\nimport { useSettingsStore } from '../core/settings';\r\nimport { Live2DManager } from '../live2d/manager';\r\nimport { LipSyncManager } from '../live2d/lip-sync';\r\nimport {\r\n  TTS_PROVIDER,\r\n  getTTSProvider,\r\n  getGptSoVitsConfig,\r\n  getCharacterTTSVoice,\r\n  resolveVoiceByName,\r\n  inferResourceId,\r\n  normalizeGptSoVitsSwitchMode,\r\n  type TTSSpeakerVoice,\r\n} from './tts-config';\r\nimport { synthesizeToBlob } from './edge-tts-direct';\r\n\r\n// ============================================\r\n// TTS  (LittleWhiteBox / GPT-SoVITS / EdgeTTS Direct)\n// : galgame src/audio/tts-manager.js\n// ============================================\r\n\r\nexport type TTSSegment = {\r\n  type: 'dialogue' | 'narration';\r\n  speaker: string;\r\n  text: string;\r\n  tts?: {\r\n    speaker?: string;\r\n    context?: string;\r\n  };\r\n};\r\n\r\ntype ToastFn = (msg: string) => void;\r\n\r\nfunction getTopWindow(): Window {\r\n  try {\r\n    return window.parent ?? window;\r\n  } catch {\r\n    return window;\r\n  }\r\n}\r\n\r\nfunction getSettingsSnapshot(): any {\r\n  try {\r\n    const store = useSettingsStore();\r\n    return store.settings;\r\n  } catch {\r\n    return {};\r\n  }\r\n}\r\n\r\n// : showToast ( UI )\nlet _showToastRef: ToastFn | null = null;\r\nexport function setTTSManagerRefs({ showToast }: { showToast?: ToastFn }): void {\r\n  if (showToast) _showToastRef = showToast;\r\n}\r\n\r\nfunction showToast(msg: string): void {\r\n  if (_showToastRef) {\r\n    _showToastRef(msg);\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const topAny: any = getTopWindow() as any;\r\n    const t = topAny?.toastr || (window as any)?.toastr;\r\n    if (t?.info) {\r\n      t.info(msg);\r\n      return;\r\n    }\r\n  } catch {\r\n    // ignore\r\n  }\r\n\r\n  console.log(`[${SCRIPT_NAME}]`, msg);\r\n}\r\n\r\nfunction clipText(text: unknown, max = 160): string {\r\n  const value = String(text || '');\r\n  if (value.length <= max) return value;\r\n  return `${value.slice(0, max)}...`;\r\n}\r\n\r\nfunction isProxyNotFound(status: number, bodyText = ''): boolean {\r\n  if (status !== 404) return false;\r\n  const body = String(bodyText || '').toLowerCase();\r\n  return body.includes('not found') || body.includes('/proxy') || body.includes('cannot get');\r\n}\r\n\r\nfunction safeUrl(input: unknown): URL | null {\r\n  try {\r\n    return new URL(String(input || ''));\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nfunction hasLive2D(): boolean {\r\n  return !!Live2DManager.model;\r\n}\r\n\r\nexport const TTSManager = {\r\n  enabled: true,\r\n  provider: TTS_PROVIDER.LITTLEWHITEBOX,\r\n  autoPlay: true,\r\n  isPlaying: false,\r\n  isLoading: false,\r\n  currentAudio: null as HTMLAudioElement | null,\r\n  currentSegmentId: null as string | null,\r\n  littleWhiteBox: null as any,\r\n  xiaobaixTts: null as any,\r\n\r\n  _gptSoVitsResolvedProxyRoute: '',\r\n  _gptSoVitsActiveWeights: { gpt: '', sovits: '' },\r\n  _gptSoVitsWeightSwitchUnavailable: false,\r\n  _gptSoVitsWeightSwitchWarned: false,\r\n  _gptSoVitsProxyWarned: false,\r\n  _gptSoVitsFetchController: null as AbortController | null,\r\n  _edgeDirectFetchController: null as AbortController | null,\r\n  _edgeDirectSocket: null as WebSocket | null,\r\n  _edgeDirectObjectUrl: '' as string,\r\n\r\n  _refreshProviderState(): boolean {\r\n    const provider = getTTSProvider();\r\n    this.provider = provider;\r\n    this.autoPlay = getSettingsSnapshot()?.ttsAutoPlay !== false;\r\n\r\n    const topAny: any = getTopWindow() as any;\r\n\r\n    if (provider === TTS_PROVIDER.LITTLEWHITEBOX) {\r\n      this.xiaobaixTts = null;\r\n      this.littleWhiteBox = null;\r\n\r\n      if (topAny?.xiaobaixTts) {\r\n        this.xiaobaixTts = topAny.xiaobaixTts;\r\n        console.log(`[${SCRIPT_NAME}] TTSManager:  xiaobaixTts`);\n      } else if (topAny?.LittleWhiteBox) {\r\n        this.littleWhiteBox = topAny.LittleWhiteBox;\r\n        console.log(`[${SCRIPT_NAME}] TTSManager:  LittleWhiteBox`);\n      }\r\n\r\n      if (!this.xiaobaixTts && !this.littleWhiteBox) {\n        console.warn(`[${SCRIPT_NAME}] TTSManager:  xiaobaixTts/LittleWhiteBoxTTS`);\n        this.enabled = false;\r\n        return false;\r\n      }\r\n\r\n      this.enabled = true;\r\n      return true;\r\n    }\r\n\r\n    if (provider === TTS_PROVIDER.GPT_SOVITS_V2) {\r\n      this.enabled = true;\r\n      return true;\r\n    }\r\n\r\n    if (provider === TTS_PROVIDER.EDGE_TTS_DIRECT) {\r\n      this.enabled = true;\r\n      return true;\r\n    }\r\n\r\n    this.enabled = true;\r\n    return true;\r\n  },\r\n\r\n  _onPlaybackEnded(reason = 'unknown'): void {\r\n    this._cleanupEdgeDirectResources();\r\n    console.log(`[${SCRIPT_NAME}] TTS:  - reason=${reason}`);\n    this.isPlaying = false;\r\n    this.isLoading = false;\r\n    this.currentAudio = null;\r\n    this.currentSegmentId = null;\r\n    this.hideLoadingIndicator();\r\n    LipSyncManager.stopSync();\r\n  },\r\n\r\n  init(): void {\r\n    this._refreshProviderState();\r\n\r\n    try {\r\n      const topAny: any = getTopWindow() as any;\r\n      const jq = topAny?.jQuery || topAny?.$;\r\n      if (jq) {\r\n        jq(topAny).on('tts_complete tts_end', () => {\r\n          this._onPlaybackEnded('littlewhitebox_event');\r\n        });\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n  },\r\n\r\n  showLoadingIndicator(): void {\r\n    try {\r\n      const top = getTopWindow();\r\n      top.document.getElementById('desktop-pet-stage')?.classList.add('desktop-pet-tts-active');\r\n    } catch {\r\n      // ignore\r\n    }\r\n  },\r\n\r\n  hideLoadingIndicator(): void {\r\n    try {\r\n      const top = getTopWindow();\r\n      top.document.getElementById('desktop-pet-stage')?.classList.remove('desktop-pet-tts-active');\r\n    } catch {\r\n      // ignore\r\n    }\r\n  },\r\n\r\n  _abortGptSoVitsFetch(reason = 'manual'): void {\r\n    if (this._gptSoVitsFetchController) {\r\n      try {\r\n        this._gptSoVitsFetchController.abort(reason);\r\n      } catch {\r\n        // ignore\r\n      }\r\n      this._gptSoVitsFetchController = null;\r\n    }\r\n  },\r\n\r\n  _cleanupEdgeDirectResources(): void {\r\n    if (this._edgeDirectFetchController) {\r\n      try {\r\n        this._edgeDirectFetchController.abort('cleanup');\r\n      } catch {\r\n        // ignore\r\n      }\r\n      this._edgeDirectFetchController = null;\r\n    }\r\n\r\n    if (this._edgeDirectSocket) {\r\n      try {\r\n        this._edgeDirectSocket.close(1000, 'cleanup');\r\n      } catch {\r\n        // ignore\r\n      }\r\n      this._edgeDirectSocket = null;\r\n    }\r\n\r\n    if (this._edgeDirectObjectUrl) {\r\n      try {\r\n        URL.revokeObjectURL(this._edgeDirectObjectUrl);\r\n      } catch {\r\n        // ignore\r\n      }\r\n      this._edgeDirectObjectUrl = '';\r\n    }\r\n  },\r\n\r\n  stop(): void {\r\n    if (\r\n      !this.isPlaying &&\r\n      !this.isLoading &&\r\n      !this._edgeDirectSocket &&\r\n      !this._edgeDirectFetchController &&\r\n      !this._edgeDirectObjectUrl\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    this._abortGptSoVitsFetch('stop');\r\n    this._cleanupEdgeDirectResources();\r\n    console.log(`[${SCRIPT_NAME}] TTS: `);\n\r\n    try {\r\n      if (this.currentAudio && typeof this.currentAudio.pause === 'function') {\r\n        try {\r\n          this.currentAudio.pause();\r\n        } catch {\r\n          // ignore\r\n        }\r\n        try {\r\n          this.currentAudio.src = '';\r\n          if (typeof this.currentAudio.load === 'function') this.currentAudio.load();\r\n        } catch {\r\n          // ignore\r\n        }\r\n      }\r\n\r\n      if (this.xiaobaixTts && this.xiaobaixTts.player) {\r\n        const player = this.xiaobaixTts.player;\r\n        if (typeof player._stopCurrent === 'function') {\r\n          player._stopCurrent();\r\n        }\r\n        if (typeof player.clear === 'function') {\r\n          player.clear();\r\n          console.log(`[${SCRIPT_NAME}] TTS: `);\r\n        }\r\n      } else if (this.xiaobaixTts && typeof this.xiaobaixTts.stop === 'function') {\r\n        this.xiaobaixTts.stop();\r\n      } else if (this.littleWhiteBox && typeof this.littleWhiteBox.stop === 'function') {\r\n        this.littleWhiteBox.stop();\r\n      }\r\n    } catch (e) {\r\n      console.warn(`[${SCRIPT_NAME}] TTS: `, e);\r\n    }\r\n\r\n    this.isPlaying = false;\r\n    this.isLoading = false;\r\n    this.currentAudio = null;\r\n    this.currentSegmentId = null;\r\n    this.hideLoadingIndicator();\r\n    LipSyncManager.stopSync();\r\n  },\r\n\r\n  _getCurrentAudioElement(): HTMLAudioElement | null {\r\n    if (this.currentAudio) return this.currentAudio;\r\n\r\n    if (this.xiaobaixTts?.player?.currentAudio) {\r\n      return this.xiaobaixTts.player.currentAudio;\r\n    }\r\n    if (this.xiaobaixTts?.player?.audio) {\r\n      return this.xiaobaixTts.player.audio;\r\n    }\r\n    if (this.xiaobaixTts?.player?.audioElements?.length > 0) {\r\n      return this.xiaobaixTts.player.audioElements[0];\r\n    }\r\n    if (this.xiaobaixTts?.audio) {\r\n      return this.xiaobaixTts.audio;\r\n    }\r\n\r\n    const top = getTopWindow();\r\n    const allAudio = top.document.querySelectorAll('audio');\r\n    for (const audio of allAudio) {\r\n      if ((audio as HTMLAudioElement).src && !(audio as HTMLAudioElement).paused) {\r\n        return audio as HTMLAudioElement;\r\n      }\r\n    }\r\n    const anyAudio = top.document.querySelector('audio[src]') as HTMLAudioElement | null;\r\n    if (anyAudio) return anyAudio;\r\n    return null;\r\n  },\r\n\r\n  _getPreferredAudioElement(): HTMLAudioElement | null {\r\n    if (this.currentAudio) return this.currentAudio;\r\n    if (this.xiaobaixTts?.player?.currentAudio) {\r\n      return this.xiaobaixTts.player.currentAudio;\r\n    }\r\n    if (this.xiaobaixTts?.player?.audio) {\r\n      return this.xiaobaixTts.player.audio;\r\n    }\r\n    if (this.xiaobaixTts?.player?.audioElements?.length > 0) {\r\n      return this.xiaobaixTts.player.audioElements[0];\r\n    }\r\n    if (this.xiaobaixTts?.audio) {\r\n      return this.xiaobaixTts.audio;\r\n    }\r\n    return null;\r\n  },\r\n\r\n  _isProxyUrl(url: unknown): boolean {\r\n    const parsed = safeUrl(url);\r\n    if (!parsed) return false;\r\n    return /^\\/proxy(\\/|\\?|$)/i.test(parsed.pathname);\r\n  },\r\n\r\n  _buildGptSoVitsProxyUrl(route: string, originalUrl: string): string {\r\n    const direct = String(originalUrl || '').trim();\r\n    if (!direct) return '';\r\n    const encoded = encodeURIComponent(direct);\r\n    const origin = window.location?.origin || '';\r\n\r\n    switch (route) {\r\n      case 'proxy_path_relative':\r\n        return `/proxy/${encoded}`;\r\n      case 'proxy_path_origin':\r\n        return origin ? `${origin}/proxy/${encoded}` : '';\r\n      case 'proxy_query_relative':\r\n        return `/proxy?url=${encoded}`;\r\n      case 'proxy_query_origin':\r\n        return origin ? `${origin}/proxy?url=${encoded}` : '';\r\n      default:\r\n        return '';\r\n    }\r\n  },\r\n\r\n  _rememberProxyRoute(route: string, url: string): void {\r\n    if (!route) return;\r\n    if (this._gptSoVitsResolvedProxyRoute !== route) {\r\n      this._gptSoVitsResolvedProxyRoute = route;\r\n      console.log(`[${SCRIPT_NAME}] GPT-SoVITS ? ${route} -> ${clipText(url, 96)}`);\r\n    }\r\n  },\r\n\r\n  _getProxiedAudioUrl(originalUrl: string): string {\r\n    const directUrl = String(originalUrl || '').trim();\r\n    if (!directUrl) return directUrl;\r\n    if (this._isProxyUrl(directUrl)) return directUrl;\r\n\r\n    const topAny: any = getTopWindow() as any;\r\n\r\n    if (typeof topAny.getCorsProxyUrl === 'function') {\r\n      try {\r\n        const proxied = topAny.getCorsProxyUrl(directUrl);\r\n        if (typeof proxied === 'string' && proxied) return proxied;\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    if (typeof topAny.enableCorsProxy === 'function') {\r\n      try {\r\n        const proxied = topAny.enableCorsProxy(directUrl);\r\n        if (typeof proxied === 'string' && proxied) return proxied;\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    if (topAny.corsProxy?.getProxyUrl) {\r\n      try {\r\n        const proxied = topAny.corsProxy.getProxyUrl(directUrl);\r\n        if (typeof proxied === 'string' && proxied) return proxied;\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    const remembered = String(this._gptSoVitsResolvedProxyRoute || '').trim();\r\n    if (remembered) {\r\n      const rememberedUrl = this._buildGptSoVitsProxyUrl(remembered, directUrl);\r\n      if (rememberedUrl) return rememberedUrl;\r\n    }\r\n\r\n    return (\r\n      this._buildGptSoVitsProxyUrl('proxy_path_relative', directUrl) ||\r\n      this._buildGptSoVitsProxyUrl('proxy_query_relative', directUrl) ||\r\n      directUrl\r\n    );\r\n  },\r\n\r\n  _buildGptSoVitsTtsUrl(text: string, resolvedVoice: TTSSpeakerVoice): string {\r\n    const cfg = getGptSoVitsConfig();\r\n    const base = String(cfg.apiUrl || '').replace(/\\/$/, '');\r\n    const endpointRaw = String(cfg.endpoint || '/tts').trim();\r\n    const endpoint = endpointRaw.startsWith('/') ? endpointRaw : `/${endpointRaw}`;\r\n    if (!base) return '';\r\n\r\n    try {\r\n      const url = new URL(base + endpoint);\r\n      const vcfg: any = resolvedVoice?.gptSoVits || {};\r\n\r\n      const textLang = String(vcfg.textLang || cfg.textLang || 'auto').trim() || 'auto';\r\n      const promptLang = String(vcfg.promptLang || 'zh').trim() || 'zh';\r\n      const refAudioPath = String(vcfg.refAudioPath || '').trim();\r\n      const promptText = String(vcfg.promptText || '').trim();\r\n\r\n      url.searchParams.set('text', text);\r\n      url.searchParams.set('text_lang', textLang);\r\n      url.searchParams.set('ref_audio_path', refAudioPath);\r\n      url.searchParams.set('prompt_lang', promptLang);\r\n      url.searchParams.set('prompt_text', promptText);\r\n\r\n      if (cfg.textSplitMethod) url.searchParams.set('text_split_method', String(cfg.textSplitMethod));\r\n      if (cfg.mediaType) url.searchParams.set('media_type', String(cfg.mediaType));\r\n      url.searchParams.set('streaming_mode', cfg.streamingMode ? 'true' : 'false');\r\n      if (cfg.speedFactor) url.searchParams.set('speed_factor', String(cfg.speedFactor));\r\n\r\n      return url.toString();\r\n    } catch (e) {\r\n      console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: URL`, e);\n      return '';\r\n    }\r\n  },\r\n\r\n  async _requestGptSoVitsApi(\r\n    method: 'GET' | 'POST',\r\n    pathname: string,\r\n    queryParams: Record<string, any> = {},\r\n    jsonBody: any = undefined,\r\n  ): Promise<{ text: string; status: number; url: string; route: string }> {\r\n    const cfg = getGptSoVitsConfig();\r\n    const base = String(cfg.apiUrl || '').replace(/\\/$/, '');\r\n    const pathRaw = String(pathname || '').trim() || '/';\r\n    const path = pathRaw.startsWith('/') ? pathRaw : `/${pathRaw}`;\r\n    if (!base) throw new Error('GPT-SoVITS API ');\n\r\n    const directUrlObj = new URL(base + path);\r\n    Object.entries(queryParams || {}).forEach(([key, value]) => {\r\n      if (value !== undefined && value !== null && value !== '') {\r\n        directUrlObj.searchParams.set(String(key), String(value));\r\n      }\r\n    });\r\n    const directUrl = directUrlObj.toString();\r\n\r\n    const attemptTargets: Array<{ route: string; url: string }> = [];\r\n    if (!cfg.useCorsProxy) {\r\n      attemptTargets.push({ route: 'direct', url: directUrl });\r\n    } else {\r\n      const preferred = String(this._gptSoVitsResolvedProxyRoute || '').trim();\r\n      const seen = new Set<string>();\r\n      const addTarget = (route: string, url: string) => {\r\n        if (!url || seen.has(url)) return;\r\n        seen.add(url);\r\n        attemptTargets.push({ route, url });\r\n      };\r\n\r\n      if (preferred) addTarget(preferred, this._buildGptSoVitsProxyUrl(preferred, directUrl));\r\n      addTarget('proxy_path_relative', this._buildGptSoVitsProxyUrl('proxy_path_relative', directUrl));\r\n      addTarget('proxy_path_origin', this._buildGptSoVitsProxyUrl('proxy_path_origin', directUrl));\r\n      addTarget('proxy_query_relative', this._buildGptSoVitsProxyUrl('proxy_query_relative', directUrl));\r\n      addTarget('proxy_query_origin', this._buildGptSoVitsProxyUrl('proxy_query_origin', directUrl));\r\n      addTarget('direct', directUrl);\r\n    }\r\n\r\n    const errors: string[] = [];\r\n    for (const target of attemptTargets) {\r\n      const controller = new AbortController();\r\n      this._gptSoVitsFetchController = controller;\r\n\r\n      try {\r\n        const options: RequestInit & { headers: Record<string, string> } = {\r\n          method,\r\n          mode: 'cors',\r\n          credentials: 'omit',\r\n          signal: controller.signal,\r\n          headers: {},\r\n        };\r\n\r\n        if (jsonBody !== undefined) {\r\n          options.headers['Content-Type'] = 'application/json';\r\n          options.body = JSON.stringify(jsonBody);\r\n        }\r\n\r\n        const response = await fetch(target.url, options);\r\n        const text = await response.text();\r\n\r\n        if (response.ok) {\r\n          if (target.route !== 'direct') {\r\n            this._rememberProxyRoute(target.route, target.url);\r\n          }\r\n          return { text, status: response.status, url: target.url, route: target.route };\r\n        }\r\n\r\n        if (target.route !== 'direct' && isProxyNotFound(response.status, text)) {\r\n          errors.push(`${target.route}:HTTP${response.status}(proxy-not-found)`);\r\n          continue;\r\n        }\r\n\r\n        errors.push(`${target.route}:HTTP${response.status}:${clipText(text, 120)}`);\r\n      } catch (e: any) {\r\n        const msg = e?.message || String(e);\r\n        errors.push(`${target.route}:${msg}`);\r\n      } finally {\r\n        if (this._gptSoVitsFetchController === controller) {\r\n          this._gptSoVitsFetchController = null;\r\n        }\r\n      }\r\n    }\r\n\r\n    throw new Error(`${method} ${path}  -> ${errors.join(' | ')}`);\n  },\r\n\r\n  async _fetchGptSoVitsApi(pathname: string, queryParams: Record<string, any> = {}): Promise<string> {\r\n    const { text } = await this._requestGptSoVitsApi('GET', pathname, queryParams);\r\n    return text;\r\n  },\r\n\r\n  async _postGptSoVitsApi(pathname: string, jsonBody: Record<string, any> = {}): Promise<string> {\r\n    const { text } = await this._requestGptSoVitsApi('POST', pathname, {}, jsonBody);\r\n    return text;\r\n  },\r\n\r\n  async _setGptSoVitsWeights(kind: 'gpt' | 'sovits', weightsPath: string): Promise<void> {\r\n    const normalizedKind = kind === 'gpt' ? 'gpt' : 'sovits';\r\n    const path = String(weightsPath || '').trim();\r\n    if (!path) return;\r\n    const endpoint = `/set_${normalizedKind}_weights`;\r\n    await this._fetchGptSoVitsApi(endpoint, { weights_path: path });\r\n  },\r\n\r\n  async _setGptSoVitsModelPair(\r\n    gptWeightsPath: string,\r\n    sovitsWeightsPath: string,\r\n    endpointOverride = '',\r\n  ): Promise<void> {\r\n    const cfg = getGptSoVitsConfig();\r\n    const endpoint = String(endpointOverride || cfg.setModelEndpoint || '/set_model').trim() || '/set_model';\r\n\r\n    try {\r\n      await this._postGptSoVitsApi(endpoint, {\r\n        gpt_model_path: String(gptWeightsPath || '').trim(),\r\n        sovits_model_path: String(sovitsWeightsPath || '').trim(),\r\n      });\r\n      return;\r\n    } catch {\r\n      await this._fetchGptSoVitsApi(endpoint, {\r\n        gpt_model_path: String(gptWeightsPath || '').trim(),\r\n        sovits_model_path: String(sovitsWeightsPath || '').trim(),\r\n      });\r\n    }\r\n  },\r\n\r\n  async _ensureGptSoVitsWeights(resolvedVoice: TTSSpeakerVoice): Promise<boolean> {\r\n    const cfg = getGptSoVitsConfig();\r\n    const vcfg: any = resolvedVoice?.gptSoVits || {};\r\n\r\n    const desiredGpt = String(vcfg.gptWeightsPath || '').trim();\r\n    const desiredSovits = String(vcfg.sovitsWeightsPath || '').trim();\r\n\r\n    let switchMode = normalizeGptSoVitsSwitchMode(vcfg.modelSwitchMode || cfg.modelSwitchMode);\r\n    const setModelEndpoint = String(vcfg.setModelEndpoint || cfg.setModelEndpoint || '/set_model').trim() || '/set_model';\r\n\r\n    if (switchMode === 'none') return true;\r\n    if (!desiredGpt && !desiredSovits) return true;\r\n    if (this._gptSoVitsWeightSwitchUnavailable) return false;\r\n\r\n    if (switchMode === 'set_model') {\r\n      if (desiredGpt && desiredSovits) {\r\n        try {\r\n          await this._setGptSoVitsModelPair(desiredGpt, desiredSovits, setModelEndpoint);\r\n          this._gptSoVitsActiveWeights.gpt = desiredGpt;\r\n          this._gptSoVitsActiveWeights.sovits = desiredSovits;\r\n          return true;\r\n        } catch (e) {\r\n          console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: set_model  set_weights`, e);\n          switchMode = 'set_weights';\r\n        }\r\n      } else {\r\n        switchMode = 'set_weights';\r\n      }\r\n    }\r\n\r\n    if (switchMode === 'set_weights') {\r\n      try {\r\n        if (desiredGpt && desiredGpt !== this._gptSoVitsActiveWeights.gpt) {\r\n          await this._setGptSoVitsWeights('gpt', desiredGpt);\r\n          this._gptSoVitsActiveWeights.gpt = desiredGpt;\r\n        }\r\n        if (desiredSovits && desiredSovits !== this._gptSoVitsActiveWeights.sovits) {\r\n          await this._setGptSoVitsWeights('sovits', desiredSovits);\r\n          this._gptSoVitsActiveWeights.sovits = desiredSovits;\r\n        }\r\n        return true;\r\n      } catch (e) {\r\n        if (!this._gptSoVitsWeightSwitchWarned) {\r\n          this._gptSoVitsWeightSwitchWarned = true;\r\n          showToast('GPT-SoVITS  /proxy  set_* ');\n        }\r\n        console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: set_weights `, e);\n        return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  },\r\n\r\n  async _speakWithGptSoVits(segment: TTSSegment, segmentId: string, resolvedVoice: TTSSpeakerVoice): Promise<boolean> {\r\n    const cfg = getGptSoVitsConfig();\r\n    const vcfg: any = resolvedVoice?.gptSoVits || {};\r\n\r\n    if (!cfg.apiUrl) {\r\n      showToast('GPT-SoVITS:  API ');\n      return false;\r\n    }\r\n    if (!String(vcfg.refAudioPath || '').trim()) {\r\n      showToast('GPT-SoVITS:  refAudioPath');\n      return false;\r\n    }\r\n\r\n    await this._ensureGptSoVitsWeights(resolvedVoice);\r\n\r\n    const directUrl = this._buildGptSoVitsTtsUrl(segment.text, resolvedVoice);\r\n    if (!directUrl) {\r\n      showToast('GPT-SoVITS: URL');\n      return false;\r\n    }\r\n\r\n    const audioUrl = cfg.useCorsProxy ? this._getProxiedAudioUrl(directUrl) : directUrl;\r\n\r\n    const audio = new Audio();\r\n    audio.crossOrigin = 'anonymous';\r\n    audio.src = audioUrl;\r\n\r\n    this.currentAudio = audio;\r\n    this.currentSegmentId = segmentId;\r\n\r\n    const onEnded = () => {\r\n      if (this.currentAudio === audio) {\r\n        this._onPlaybackEnded('gpt_sovits_audio_ended');\r\n      }\r\n    };\r\n    const onError = (e: any) => {\r\n      console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: audio error`, e);\r\n      if (!this._gptSoVitsProxyWarned && cfg.useCorsProxy) {\r\n        this._gptSoVitsProxyWarned = true;\r\n        showToast('GPT-SoVITS  /proxy  CORS ');\r\n      } else {\r\n        showToast('GPT-SoVITS //CORS');\r\n      }\r\n      onEnded();\r\n    };\r\n\r\n    audio.addEventListener('ended', onEnded, { once: true });\r\n    audio.addEventListener('error', onError, { once: true });\r\n\r\n    try {\r\n      await audio.play();\r\n    } catch (e) {\r\n      console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: play() `, e);\n      showToast('GPT-SoVITS ');\n      onEnded();\r\n      return false;\r\n    }\r\n\r\n    this.isPlaying = true;\r\n\r\n    if (hasLive2D()) {\r\n      const lipId = segment.speaker || 'pet';\r\n      console.log(`[${SCRIPT_NAME}] TTS: : hasLive2D=true, speaker=${lipId}`);\n      this._startLipSyncOnPlay(lipId);\r\n    } else {\r\n      console.log(`[${SCRIPT_NAME}] TTS: Live2D `);\n    }\r\n\r\n    return true;\r\n  },\r\n\r\n  async _speakWithEdgeDirect(segment: TTSSegment, segmentId: string, resolvedVoice: TTSSpeakerVoice): Promise<boolean> {\r\n    const voiceName = String(resolvedVoice.value || resolvedVoice.name || '').trim();\r\n    if (!voiceName) {\r\n      showToast('EdgeTTS ');\r\n      return false;\r\n    }\r\n\r\n    this._cleanupEdgeDirectResources();\r\n\r\n    const controller = new AbortController();\r\n    this._edgeDirectFetchController = controller;\r\n\r\n    let blob: Blob;\r\n    try {\r\n      blob = await synthesizeToBlob(segment.text, resolvedVoice, {\r\n        signal: controller.signal,\r\n        onSocket: socket => {\r\n          this._edgeDirectSocket = socket;\r\n        },\r\n      });\r\n    } catch (e: any) {\r\n      const isAbort = e?.name === 'AbortError';\r\n      if (!isAbort) {\n        const reason = clipText(e?.message || String(e), 180);\n        const blockedHint = /likely-cause=ua-not-edg/i.test(reason)\n          ? ' Edge Edge '\n          : /1006|403|websocket/i.test(reason)\n            ? ' CSP/ wss  Edge '\n            : '';\n        console.warn(`[${SCRIPT_NAME}] EdgeTTS :`, e);\n        showToast(`EdgeTTS ${reason}${blockedHint}`);\n      }\n      return false;\r\n    } finally {\r\n      if (this._edgeDirectFetchController === controller) {\r\n        this._edgeDirectFetchController = null;\r\n      }\r\n      this._edgeDirectSocket = null;\r\n    }\r\n\r\n    if (!blob || blob.size <= 0) {\r\n      showToast('EdgeTTS ');\r\n      return false;\r\n    }\r\n\r\n    const objectUrl = URL.createObjectURL(blob);\r\n    this._edgeDirectObjectUrl = objectUrl;\r\n\r\n    const audio = new Audio();\r\n    audio.crossOrigin = 'anonymous';\r\n    audio.src = objectUrl;\r\n\r\n    this.currentAudio = audio;\r\n    this.currentSegmentId = segmentId;\r\n\r\n    const onEnded = () => {\r\n      if (this.currentAudio === audio) {\r\n        this._onPlaybackEnded('edge_direct_audio_ended');\r\n      }\r\n    };\r\n    const onError = (err: any) => {\r\n      console.warn(`[${SCRIPT_NAME}] EdgeTTS :`, err);\r\n      showToast('EdgeTTS  Edge ');\r\n      onEnded();\r\n    };\r\n\r\n    audio.addEventListener('ended', onEnded, { once: true });\r\n    audio.addEventListener('error', onError, { once: true });\r\n\r\n    try {\r\n      await audio.play();\r\n    } catch (e) {\r\n      console.warn(`[${SCRIPT_NAME}] EdgeTTS  play() :`, e);\r\n      showToast('EdgeTTS ');\r\n      onEnded();\r\n      return false;\r\n    }\r\n\r\n    this.isPlaying = true;\r\n\r\n    if (hasLive2D()) {\r\n      const lipId = segment.speaker || 'pet';\r\n      this._startLipSyncOnPlay(lipId);\r\n    }\r\n\r\n    return true;\r\n  },\r\n\r\n  _startLipSyncWhenModelReady(characterId: string, maxWait = 5000): void {\r\n    const startTime = Date.now();\r\n    const tryWait = () => {\r\n      if (hasLive2D()) {\r\n        this._startLipSyncOnPlay(characterId, maxWait);\r\n        return;\r\n      }\r\n      if (Date.now() - startTime < maxWait) {\r\n        setTimeout(tryWait, 120);\r\n      } else {\r\n        console.warn(`[${SCRIPT_NAME}] LipSync:  - characterId=${characterId}`);\n      }\r\n    };\r\n    tryWait();\r\n  },\r\n\r\n  async _waitForModelReadyBeforeTTS(_characterId: string, maxWait = 5000): Promise<boolean> {\r\n    const startTime = Date.now();\r\n    while (Date.now() - startTime < maxWait) {\r\n      if (hasLive2D()) return true;\r\n      await new Promise(r => setTimeout(r, 120));\r\n    }\r\n    console.warn(`[${SCRIPT_NAME}] TTS: TTS`);\n    return false;\r\n  },\r\n\r\n  _startLipSyncOnPlay(characterId: string, maxWait = 5000): void {\r\n    console.log(`[${SCRIPT_NAME}] LipSync: _startLipSyncOnPlay  - characterId=${characterId}`);\n    const startTime = Date.now();\r\n    let hasStarted = false;\r\n\r\n    const tryBind = () => {\r\n      const preferredAudio = this._getPreferredAudioElement();\r\n      const audioElement = preferredAudio || this._getCurrentAudioElement();\r\n      console.log(\r\n        `[${SCRIPT_NAME}] LipSync:  -`,\n        audioElement\r\n          ? `src=${audioElement.src?.substring(0, 50)}... paused=${audioElement.paused} currentTime=${audioElement.currentTime}`\r\n          : 'null',\r\n      );\r\n\r\n      if (!audioElement) {\r\n        if (Date.now() - startTime < maxWait && !hasStarted) {\r\n          setTimeout(tryBind, 100);\r\n        } else if (!hasStarted) {\r\n          console.warn(`[${SCRIPT_NAME}] LipSync: `);\n        }\r\n        return;\r\n      }\r\n\r\n      if (!audioElement.paused) {\r\n        console.log(`[${SCRIPT_NAME}] LipSync: `);\n        hasStarted = true;\r\n        this._bindLipSyncToAudio(audioElement, characterId);\r\n        return;\r\n      }\r\n\r\n      if (!preferredAudio) {\r\n        if (Date.now() - startTime < maxWait && !hasStarted) {\r\n          setTimeout(tryBind, 100);\r\n        } else if (!hasStarted) {\r\n          console.warn(`[${SCRIPT_NAME}] LipSync: `);\n          if (audioElement.src) {\r\n            this._bindLipSyncToAudio(audioElement, characterId);\r\n          }\r\n        }\r\n        return;\r\n      }\r\n\r\n      console.log(`[${SCRIPT_NAME}] LipSync: ...`);\n\r\n      const onPlaying = () => {\r\n        if (hasStarted) return;\r\n        hasStarted = true;\r\n        console.log(`[${SCRIPT_NAME}] LipSync: `);\n        this._bindLipSyncToAudio(audioElement, characterId);\r\n      };\r\n\r\n      audioElement.addEventListener('playing', onPlaying, { once: true });\r\n      audioElement.addEventListener('play', onPlaying, { once: true });\r\n\r\n      const onTimeUpdate = () => {\r\n        if (hasStarted) return;\r\n        if (audioElement.currentTime > 0 && !audioElement.paused) {\r\n          console.log(`[${SCRIPT_NAME}] LipSync: timeupdate `);\n          onPlaying();\r\n        }\r\n      };\r\n      audioElement.addEventListener('timeupdate', onTimeUpdate);\r\n\r\n      setTimeout(() => {\r\n        audioElement.removeEventListener('playing', onPlaying);\r\n        audioElement.removeEventListener('play', onPlaying);\r\n        audioElement.removeEventListener('timeupdate', onTimeUpdate);\r\n        if (!hasStarted) {\r\n          console.warn(`[${SCRIPT_NAME}] LipSync: `);\n          if (audioElement.src) {\r\n            this._bindLipSyncToAudio(audioElement, characterId);\r\n          }\r\n        }\r\n      }, maxWait);\r\n    };\r\n\r\n    tryBind();\r\n  },\r\n\r\n  _bindLipSyncToAudio(audioElement: HTMLAudioElement, characterId: string): void {\r\n    if (LipSyncManager.connectAudio(audioElement)) {\r\n      void LipSyncManager.startSync(characterId);\r\n    }\r\n\r\n    const onEnd = () => {\r\n      console.log(`[${SCRIPT_NAME}] LipSync: /`);\n      LipSyncManager.stopSync();\r\n      audioElement.removeEventListener('ended', onEnd);\r\n      audioElement.removeEventListener('pause', onEnd);\r\n    };\r\n\r\n    audioElement.addEventListener('ended', onEnd, { once: true });\r\n    audioElement.addEventListener('pause', onEnd, { once: true });\r\n  },\r\n\r\n  async speak(segment: TTSSegment, segmentId: string): Promise<void> {\r\n    if (!segment || segment.type !== 'dialogue') {\r\n      if (segment && segment.type === 'narration') {\r\n        console.log(`[${SCRIPT_NAME}] TTS:  - ${segment.text.substring(0, 30)}...`);\n      }\r\n      return;\r\n    }\r\n    if (!segment.text) return;\r\n\r\n    const provider = getTTSProvider();\r\n    if (provider !== this.provider || !this.enabled) {\r\n      this._refreshProviderState();\r\n    }\r\n    if (!this.enabled) return;\r\n\r\n    const settings = getSettingsSnapshot();\r\n    const ttsConfig = segment.tts || {};\r\n    const boundVoice = getCharacterTTSVoice(segment.speaker);\r\n    let voiceName = ttsConfig.speaker || boundVoice || settings.ttsDefaultSpeaker;\r\n    if (!voiceName) {\r\n      voiceName = provider === TTS_PROVIDER.GPT_SOVITS_V2 ? segment.speaker || '' : '';\n    }\r\n    if (!voiceName) voiceName = '';\n    const context = ttsConfig.context || '';\r\n\r\n    const resolvedVoice = await resolveVoiceByName(String(voiceName || ''));\r\n    if (!resolvedVoice) {\r\n      console.error(`[${SCRIPT_NAME}] TTS:  \"${voiceName}\" (provider=${provider})`);\n      if (provider === TTS_PROVIDER.GPT_SOVITS_V2) {\r\n        showToast('GPT-SoVITS: ');\n      }\r\n      return;\r\n    }\r\n\r\n    console.log(\n      `[${SCRIPT_NAME}] TTS: provider=${provider}, voiceName=${voiceName}, context=${context || ''}, text=${segment.text.substring(0, 30)}...`,\n    );\n    if (hasLive2D()) {\r\n      try {\r\n        const info = Live2DManager.getLipSyncDebugInfo();\r\n        console.log(\r\n          `[${SCRIPT_NAME}] TTS: lipSyncOverride=active, mouthParamsSource=${info.mouthParamsSource}, count=${info.mouthParamsCount}`,\n        );\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    this.isLoading = true;\r\n    this.showLoadingIndicator();\r\n\r\n    try {\r\n      await this._waitForModelReadyBeforeTTS(segment.speaker);\r\n\r\n      if (provider === TTS_PROVIDER.GPT_SOVITS_V2) {\r\n        await this._speakWithGptSoVits(segment, segmentId, resolvedVoice);\r\n        return;\r\n      }\r\n\r\n      if (provider === TTS_PROVIDER.EDGE_TTS_DIRECT) {\r\n        await this._speakWithEdgeDirect(segment, segmentId, resolvedVoice);\r\n        return;\r\n      }\r\n\r\n      const speakerValue = resolvedVoice.value;\r\n      const resourceId = inferResourceId(speakerValue);\r\n\r\n      if (this.xiaobaixTts && typeof this.xiaobaixTts.speak === 'function') {\r\n        await this.xiaobaixTts.speak(segment.text, {\r\n          speaker: speakerValue,\r\n          resourceId,\r\n          contextTexts: context ? [context] : [],\r\n        });\r\n        this.isPlaying = true;\r\n        this.currentSegmentId = segmentId;\r\n        if (hasLive2D()) {\r\n          this._startLipSyncOnPlay(segment.speaker || 'pet');\r\n        }\r\n        return;\r\n      }\r\n\r\n      if (this.littleWhiteBox && typeof this.littleWhiteBox.callGenerate === 'function') {\r\n        await this.littleWhiteBox.callGenerate({\r\n          message: segment.text,\r\n          speaker: speakerValue,\r\n          resourceId,\r\n          contextTexts: context ? [context] : [],\r\n        });\r\n        this.isPlaying = true;\r\n        this.currentSegmentId = segmentId;\r\n        if (hasLive2D()) {\r\n          this._startLipSyncOnPlay(segment.speaker || 'pet');\r\n        }\r\n        return;\r\n      }\r\n\r\n      console.warn(`[${SCRIPT_NAME}] TTS:  TTS  LittleWhiteBox `);\n    } catch (err) {\r\n      console.error(`[${SCRIPT_NAME}] TTS:`, err);\n    } finally {\r\n      this.isLoading = false;\r\n      this.hideLoadingIndicator();\r\n    }\r\n  },\r\n};\r\n","import { log, warn } from '../utils/dom';\nimport type { CommentTriggerMode } from '../core/constants';\n\ntype MonitorCallback = () => void;\ntype StopHandle = { stop: () => void };\ntype UserSignalSource = 'message_sent' | 'generation_after_commands' | 'user_message_rendered';\ntype TriggerSource = 'user' | 'ai';\n\n/**\n * Chat message monitor.\n * Uses event-gating to separate real user/AI turns from the plugin's own generateRaw flow.\n */\nexport const ChatMonitor = {\n  /** Count since last trigger. */\n  messageCount: 0,\n\n  /** Ignore next N GENERATION_ENDED events (our own generateRaw). */\n  ignoreNextCount: 0,\n\n  /** Trigger callback. */\n  _onTrigger: null as MonitorCallback | null,\n\n  /** Event stop handles. */\n  _stops: [] as StopHandle[],\n\n  /** Latest user-side signal time (for dedupe). */\n  _lastUserSignalAt: 0,\n\n  /** Runtime config. */\n  _config: {\n    autoTrigger: true,\n    triggerInterval: 3,\n    triggerProbability: 60,\n    commentTriggerMode: 'ai' as CommentTriggerMode,\n  },\n\n  init(\n    config: {\n      autoTrigger: boolean;\n      triggerInterval: number;\n      triggerProbability: number;\n      commentTriggerMode: CommentTriggerMode;\n    },\n    onTrigger: MonitorCallback,\n  ): void {\n    this._config = { ...config };\n    this._onTrigger = onTrigger;\n    this._lastUserSignalAt = 0;\n\n    const messageSentStop = this._bindEvent('MESSAGE_SENT', (_messageId: number) => {\n      log('(MESSAGE_SENT)');\n      this._recordUserSignal('message_sent');\n    });\n    if (messageSentStop) {\n      this._stops.push(messageSentStop);\n    }\n\n    // Fallback for environments where MESSAGE_SENT exists but does not fire.\n    const userRenderedStop = this._bindEvent('USER_MESSAGE_RENDERED', (_messageId: number) => {\n      log('(USER_MESSAGE_RENDERED)');\n      this._recordUserSignal('user_message_rendered');\n    });\n    if (userRenderedStop) {\n      this._stops.push(userRenderedStop);\n    }\n\n    // Fallback for some /send command paths.\n    const afterCommandsStop = this._bindEvent(\n      'GENERATION_AFTER_COMMANDS',\n      (_type: string, option: { quiet_prompt?: string }, dryRun: boolean) => {\n        if (dryRun) return;\n        if (option?.quiet_prompt) return;\n        log('(GENERATION_AFTER_COMMANDS)');\n        this._recordUserSignal('generation_after_commands');\n      },\n    );\n    if (afterCommandsStop) {\n      this._stops.push(afterCommandsStop);\n    }\n\n    const generationStartedStop = this._bindEvent(\n      'GENERATION_STARTED',\n      (_type: string, option: { quiet_prompt?: string }, dryRun: boolean) => {\n        if (dryRun) return;\n        if (option?.quiet_prompt) return;\n      },\n    );\n    if (generationStartedStop) {\n      this._stops.push(generationStartedStop);\n    }\n\n    const generationEndedStop = this._bindEvent('GENERATION_ENDED', (_messageId: number) => {\n      if (this.ignoreNextCount > 0) {\n        this.ignoreNextCount--;\n        return;\n      }\n      this._handleTriggerCount('ai');\n    });\n    if (generationEndedStop) {\n      this._stops.push(generationEndedStop);\n    }\n\n    log(\n      `(mode=${this._config.commentTriggerMode}, interval=${this._config.triggerInterval}, prob=${this._config.triggerProbability})`,\n    );\n  },\n\n  _resolveEventName(eventKey: string): string | null {\n    try {\n      const top = window.parent ?? window;\n      const fromSillyTavern = (top as any)?.SillyTavern?.eventTypes?.[eventKey];\n      if (fromSillyTavern) return String(fromSillyTavern);\n    } catch {\n      // ignore\n    }\n\n    try {\n      const fromLegacy = (tavern_events as any)?.[eventKey];\n      if (fromLegacy) return String(fromLegacy);\n    } catch {\n      // ignore\n    }\n\n    return null;\n  },\n\n  _bindEvent(eventKey: string, handler: (...args: any[]) => void): StopHandle | null {\n    const eventName = this._resolveEventName(eventKey);\n    if (!eventName) {\n      warn(`: ${eventKey}`);\n      return null;\n    }\n\n    try {\n      const top = window.parent ?? window;\n      const eventSource = (top as any)?.SillyTavern?.eventSource;\n      if (eventSource && typeof eventSource.on === 'function') {\n        eventSource.on(eventName, handler);\n        log(`(${eventKey} -> ${eventName}, via eventSource)`);\n        return {\n          stop: () => {\n            try {\n              if (typeof eventSource.off === 'function') {\n                eventSource.off(eventName, handler);\n              }\n            } catch {\n              // ignore\n            }\n          },\n        };\n      }\n    } catch {\n      // ignore\n    }\n\n    if (typeof eventOn === 'function') {\n      const stop = eventOn(eventName as any, handler);\n      log(`(${eventKey} -> ${eventName}, via eventOn)`);\n      return stop;\n    }\n\n    warn(`: ${eventKey}`);\n    return null;\n  },\n\n  updateConfig(config: {\n    autoTrigger: boolean;\n    triggerInterval: number;\n    triggerProbability: number;\n    commentTriggerMode: CommentTriggerMode;\n  }): void {\n    this._config = { ...config };\n  },\n\n  _shouldCountBySource(source: TriggerSource): boolean {\n    const mode = this._config.commentTriggerMode;\n    return mode === 'both' || mode === source;\n  },\n\n  _recordUserSignal(source: UserSignalSource): void {\n    const now = Date.now();\n\n    // MESSAGE_SENT / USER_MESSAGE_RENDERED / GENERATION_AFTER_COMMANDS may fire in one send flow.\n    if (now - this._lastUserSignalAt < 800) {\n      log(`(${source})`);\n      return;\n    }\n\n    this._lastUserSignalAt = now;\n    this._handleTriggerCount('user');\n  },\n\n  _handleTriggerCount(source: TriggerSource): void {\n    if (!this._shouldCountBySource(source)) return;\n    this.messageCount++;\n    log(`(${source}): ${this.messageCount}`);\n    this._checkAutoTrigger();\n  },\n\n  _checkAutoTrigger(): void {\n    if (!this._config.autoTrigger || !this._onTrigger) return;\n    if (this.messageCount < this._config.triggerInterval) return;\n\n    const roll = Math.random() * 100;\n    if (roll > this._config.triggerProbability) {\n      log(`(${roll.toFixed(1)} > ${this._config.triggerProbability})`);\n      return;\n    }\n\n    this.messageCount = 0;\n    log('');\n    this._onTrigger();\n  },\n\n  manualTrigger(): void {\n    if (!this._onTrigger) return;\n    log('');\n    this._onTrigger();\n  },\n\n  resetState(): void {\n    this.messageCount = 0;\n    this.ignoreNextCount = 0;\n    this._lastUserSignalAt = 0;\n    log('');\n  },\n\n  markSelfGeneration(): void {\n    this.ignoreNextCount++;\n  },\n\n  destroy(): void {\n    for (const s of this._stops) {\n      s.stop();\n    }\n    this._stops = [];\n    this._onTrigger = null;\n    this.messageCount = 0;\n    this.ignoreNextCount = 0;\n    this._lastUserSignalAt = 0;\n  },\n};\n","import { EMOTION_TAGS, type CommentStyle } from '../core/constants';\n\n/**  */\ninterface StyleTemplate {\n  systemPrompt: string;\n  responseFormat: string;\n}\n\nexport interface RoleplayPromptOptions {\n  roleName?: string;\n  characterCardContent?: string;\n  ignoreCommentStyle?: boolean;\n}\n\nexport interface DiceReferencePromptOptions {\n  referenceText?: string;\n}\n\n/**  */\nexport const PROMPT_TEMPLATES: Record<Exclude<CommentStyle, ''>, StyleTemplate> = {\n  : {\n    systemPrompt: `\n\n`,\n    responseFormat: '1-250',\n  },\n\n  : {\n    systemPrompt: `\n`,\n    responseFormat: '1-250()(><)(  )',\n  },\n\n  : {\n    systemPrompt: `\n`,\n    responseFormat: '1-250',\n  },\n\n  : {\n    systemPrompt: `\n\"\"\"\"`,\n    responseFormat: '1-250',\n  },\n};\n\nfunction resolvePromptTemplate(\n  style: CommentStyle,\n  customPrompt: string,\n): { systemPrompt: string; responseFormat: string } {\n  if (style === '' && customPrompt) {\n    return {\n      systemPrompt: customPrompt,\n      responseFormat: '1-250',\n    };\n  }\n\n  const template = PROMPT_TEMPLATES[style as Exclude<CommentStyle, ''>] ?? PROMPT_TEMPLATES[''];\n\n  return {\n    systemPrompt: template.systemPrompt,\n    responseFormat: template.responseFormat,\n  };\n}\n\nfunction getChatResponseFormat(style: CommentStyle): string {\n  switch (style) {\n    case '':\n      return '1-380()(><)(  )';\n    case '':\n      return '1-380';\n    case '':\n      return '1-380';\n    case '':\n      return '1-380';\n    case '':\n    default:\n      return '1-380';\n  }\n}\n\nfunction appendEmotionCotFormat(responseFormat: string): string {\n  const tags = EMOTION_TAGS.join('');\n  return (\n    `${responseFormat}\\n\\n` +\n    `COT\\n` +\n    `- [|]: \\n` +\n    `-  1 ${tags}\\n` +\n    `- \\n` +\n    `-  Markdown//`\n  );\n}\n\nfunction buildRoleplayInstruction(roleplay?: RoleplayPromptOptions): string {\n  const roleName = String(roleplay?.roleName || '').trim();\n  if (!roleName) {\n    return '';\n  }\n\n  const lines = [\n    '',\n    `- ${roleName}`,\n    '- ',\n    '-  AI',\n  ];\n\n  const characterCardContent = String(roleplay?.characterCardContent || '').trim();\n  if (characterCardContent) {\n    lines.push('');\n    lines.push(characterCardContent);\n  }\n\n  return lines.join('\\n');\n}\n\nfunction shouldIgnoreStyleByRoleplay(roleplay?: RoleplayPromptOptions): boolean {\n  const roleName = String(roleplay?.roleName || '').trim();\n  return !!roleName && roleplay?.ignoreCommentStyle === true;\n}\n\nfunction buildContextLines(chatContext: Array<{ role: string; name: string; message: string }>): string {\n  return chatContext.map(msg => `${msg.name}(${msg.role}): ${String(msg.message ?? '')}`).join('\\n');\n}\n\nfunction getDiceReferenceText(diceReference?: DiceReferencePromptOptions): string {\n  return String(diceReference?.referenceText || '').trim();\n}\n\nfunction buildDiceReferenceInstruction(diceReference?: DiceReferencePromptOptions): string {\n  const referenceText = getDiceReferenceText(diceReference);\n  if (!referenceText) {\n    return '';\n  }\n\n  return (\n    `\\n` +\n    `\\n` +\n    `${referenceText}`\n  );\n}\n\nfunction appendDiceAdviceRequirement(responseFormat: string, diceReference?: DiceReferencePromptOptions): string {\n  const referenceText = getDiceReferenceText(diceReference);\n  if (!referenceText) {\n    return responseFormat;\n  }\n  return `${responseFormat}\\n 1 `;\n}\n\n/**\n *  LLM \n */\nexport function buildPrompt(\n  style: CommentStyle,\n  customPrompt: string,\n  chatContext: Array<{ role: string; name: string; message: string }>,\n  emotionCotEnabled = false,\n  roleplay?: RoleplayPromptOptions,\n  diceReference?: DiceReferencePromptOptions,\n): { system: string; user: string } {\n  const ignoreStyleByRoleplay = shouldIgnoreStyleByRoleplay(roleplay);\n  const { systemPrompt, responseFormat } = ignoreStyleByRoleplay\n    ? {\n        systemPrompt: '',\n        responseFormat: '1-250',\n      }\n    : resolvePromptTemplate(style, customPrompt);\n  const responseFormatWithAdvice = appendDiceAdviceRequirement(responseFormat, diceReference);\n  const finalFormat = emotionCotEnabled ? appendEmotionCotFormat(responseFormatWithAdvice) : responseFormatWithAdvice;\n  const roleplayInstruction = buildRoleplayInstruction(roleplay);\n  const diceReferenceInstruction = buildDiceReferenceInstruction(diceReference);\n\n  // \n  const contextLines = buildContextLines(chatContext);\n\n  const systemParts = [systemPrompt];\n  if (roleplayInstruction) {\n    systemParts.push(roleplayInstruction);\n  }\n  if (diceReferenceInstruction) {\n    systemParts.push(diceReferenceInstruction);\n  }\n  systemParts.push(`${finalFormat}`);\n\n  const system = systemParts.join('\\n\\n');\n  const user = `\\n\\n${contextLines}`;\n\n  return { system, user };\n}\n\n/**\n * \n */\nexport function buildChatPrompt(\n  style: CommentStyle,\n  customPrompt: string,\n  chatContext: Array<{ role: string; name: string; message: string }>,\n  userMessage: string,\n  emotionCotEnabled = false,\n  roleplay?: RoleplayPromptOptions,\n  diceReference?: DiceReferencePromptOptions,\n): { system: string; user: string } {\n  const ignoreStyleByRoleplay = shouldIgnoreStyleByRoleplay(roleplay);\n  const { systemPrompt } = ignoreStyleByRoleplay\n    ? {\n        systemPrompt: '',\n      }\n    : resolvePromptTemplate(style, customPrompt);\n  const responseFormat = ignoreStyleByRoleplay ? '1-380' : getChatResponseFormat(style);\n  const responseFormatWithAdvice = appendDiceAdviceRequirement(responseFormat, diceReference);\n  const finalFormat = emotionCotEnabled ? appendEmotionCotFormat(responseFormatWithAdvice) : responseFormatWithAdvice;\n  const roleplayInstruction = buildRoleplayInstruction(roleplay);\n  const diceReferenceInstruction = buildDiceReferenceInstruction(diceReference);\n  const roleName = String(roleplay?.roleName || '').trim();\n\n  const contextLines = buildContextLines(chatContext);\n  const safeUserMessage = String(userMessage || '').trim();\n\n  const systemParts = [systemPrompt];\n  if (roleplayInstruction) {\n    systemParts.push(roleplayInstruction);\n  }\n  if (diceReferenceInstruction) {\n    systemParts.push(diceReferenceInstruction);\n  }\n  systemParts.push(`${finalFormat}`);\n  systemParts.push(roleName ? '' : '');\n\n  const system = systemParts.join('\\n\\n');\n\n  const user =\n    `\\n\\n` +\n    `${contextLines || '()'}\\n\\n` +\n    `\\n${safeUserMessage}\\n\\n` +\n    ``;\n\n  return { system, user };\n}\n","import { useSettingsStore } from '../core/settings';\nimport { error, log, warn } from '../utils/dom';\nimport { ChatMonitor } from './monitor';\nimport {\n  buildChatPrompt,\n  buildPrompt,\n  type DiceReferencePromptOptions,\n  type RoleplayPromptOptions,\n} from './prompt-templates';\n\ntype CommentCallback = (text: string, isDone: boolean) => void;\n\n/**\n * \n *  LLM / UI\n */\nexport const Commentator = {\n  isGenerating: false,\n\n  _onComment: null as CommentCallback | null,\n  _streamStop: null as { stop: () => void } | null,\n  _latestStreamText: '',\n\n  setCallback(cb: CommentCallback): void {\n    this._onComment = cb;\n  },\n\n  async generate(): Promise<void> {\n    if (this.isGenerating) {\n      log('');\n      return;\n    }\n\n    this.isGenerating = true;\n    log('');\n    let emittedDone = false;\n\n    try {\n      this._onComment?.('', false);\n\n      const store = useSettingsStore();\n      const s = store.settings;\n\n      let chatMessages = this._getChatContext(s.maxChatContext);\n      if (s.useTamakoTodaySpecial) {\n        const todaySpecial = this._getTamakoTodaySpecialContent();\n        if (todaySpecial) {\n          chatMessages = [\n            ...chatMessages,\n            {\n              role: 'system',\n              name: '',\n              message: todaySpecial,\n            },\n          ];\n          log(`${todaySpecial.length} `);\n        } else {\n          log('');\n        }\n      }\n\n      if (chatMessages.length === 0) {\n        log('');\n        return;\n      }\n\n      const roleplayOptions = this._resolveRoleplayOptions({\n        roleName: s.roleplayName,\n        ignoreCommentStyle: !!s.roleplayIgnoreCommentStyle,\n        sendCharacterCardContent: !!s.sendCharacterCardContent,\n      });\n      const diceReferenceOptions = this._resolveDiceReferenceOptions(\n        !!s.useDiceDatabaseReference,\n        (s as any).diceReferenceVisibleSheets,\n      );\n      const { system, user } = buildPrompt(\n        s.commentStyle,\n        s.customPrompt,\n        chatMessages,\n        !!s.emotionCotEnabled,\n        roleplayOptions,\n        diceReferenceOptions,\n      );\n\n      this._latestStreamText = '';\n      let result: string;\n\n      if (s.apiMode === 'custom' && s.apiConfig.url) {\n        result = await this._generateCustom(system, user, s.apiConfig);\n      } else {\n        ChatMonitor.markSelfGeneration();\n        result = await this._generateTavern(\n          system,\n          user,\n          s.apiConfig.max_tokens,\n          s.apiConfig.temperature,\n          !!s.apiConfig.sendWorldInfo,\n        );\n      }\n\n      const finalText = String(result || '').trim() || String(this._latestStreamText || '').trim();\n      if (finalText) {\n        this._onComment?.(finalText, true);\n        emittedDone = true;\n      } else {\n        warn('');\n      }\n    } catch (e) {\n      error(':', e);\n    } finally {\n      if (!emittedDone) {\n        this._onComment?.('', true);\n      }\n      this.isGenerating = false;\n    }\n  },\n\n  /**\n   * \n   * - \n   * -  API  API /  API\n   */\n  async chat(userMessage: string): Promise<void> {\n    const input = String(userMessage || '').trim();\n    if (!input) return;\n\n    if (this.isGenerating) {\n      log('');\n      return;\n    }\n\n    this.isGenerating = true;\n    log('');\n    let emittedDone = false;\n\n    try {\n      this._onComment?.('', false);\n\n      const store = useSettingsStore();\n      const s = store.settings;\n\n      const chatMessages = this._getChatContext(s.maxChatContext);\n      const roleplayOptions = this._resolveRoleplayOptions({\n        roleName: s.roleplayName,\n        ignoreCommentStyle: !!s.roleplayIgnoreCommentStyle,\n        sendCharacterCardContent: !!s.sendCharacterCardContent,\n      });\n      const diceReferenceOptions = this._resolveDiceReferenceOptions(\n        !!s.useDiceDatabaseReference,\n        (s as any).diceReferenceVisibleSheets,\n      );\n      const { system, user } = buildChatPrompt(\n        s.commentStyle,\n        s.customPrompt,\n        chatMessages,\n        input,\n        !!s.emotionCotEnabled,\n        roleplayOptions,\n        diceReferenceOptions,\n      );\n\n      this._latestStreamText = '';\n      let result: string;\n\n      if (s.apiMode === 'custom' && s.apiConfig.url) {\n        result = await this._generateCustom(system, user, s.apiConfig);\n      } else {\n        ChatMonitor.markSelfGeneration();\n        result = await this._generateTavern(\n          system,\n          user,\n          s.apiConfig.max_tokens,\n          s.apiConfig.temperature,\n          !!s.apiConfig.sendWorldInfo,\n        );\n      }\n\n      const finalText = String(result || '').trim() || String(this._latestStreamText || '').trim();\n      if (finalText) {\n        this._onComment?.(finalText, true);\n        emittedDone = true;\n      } else {\n        warn('');\n      }\n    } catch (e) {\n      error(':', e);\n    } finally {\n      if (!emittedDone) {\n        this._onComment?.('', true);\n      }\n      this.isGenerating = false;\n    }\n  },\n\n  async _generateTavern(\n    system: string,\n    user: string,\n    maxTokens: number,\n    temperature: number,\n    sendWorldInfo: boolean,\n  ): Promise<string> {\n    this._setupStreamListener();\n    const orderedPrompts: Array<\n      'world_info_before' | 'world_info_after' | { role: 'system' | 'assistant' | 'user'; content: string }\n    > = sendWorldInfo\n      ? ['world_info_before', { role: 'system', content: system }, 'world_info_after', { role: 'user', content: user }]\n      : [\n          { role: 'system', content: system },\n          { role: 'user', content: user },\n        ];\n\n    try {\n      return await generateRaw({\n        should_silence: true,\n        should_stream: true,\n        ordered_prompts: orderedPrompts,\n        custom_api: undefined,\n      });\n    } finally {\n      this._cleanupStreamListener();\n    }\n  },\n\n  async _generateCustom(\n    system: string,\n    user: string,\n    apiConfig: {\n      url: string;\n      apiKey: string;\n      model: string;\n      source: string;\n      max_tokens: number;\n      temperature: number;\n      frequency_penalty: number;\n      presence_penalty: number;\n      top_p: number;\n      top_k: number;\n      usePresetSampling: boolean;\n      sendWorldInfo?: boolean;\n    },\n  ): Promise<string> {\n    const apiUrl = String(apiConfig.url || '').trim();\n    const apiKey = String(apiConfig.apiKey || '').trim();\n    const model = String(apiConfig.model || '')\n      .trim()\n      .replace(/^models\\//, '');\n\n    if (!apiUrl) {\n      throw new Error(' API URL ');\n    }\n    if (!model) {\n      throw new Error(' API ');\n    }\n\n    const usePreset = !!apiConfig.usePresetSampling;\n    const sendWorldInfo = !!apiConfig.sendWorldInfo;\n    const requestUrl = '/api/backends/chat-completions/generate';\n    const orderedPrompts = [\n      { role: 'system', content: system },\n      { role: 'user', content: user },\n    ];\n\n    const buildAttemptBody = (attempt: 'full' | 'safe' | 'minimal') => {\n      const body: Record<string, unknown> = {\n        messages: orderedPrompts,\n        model,\n        stream: false,\n        chat_completion_source: 'custom',\n        custom_prompt_post_processing: sendWorldInfo ? 'strict' : 'none',\n        reverse_proxy: apiUrl,\n        custom_url: apiUrl,\n        custom_include_headers: apiKey ? `Authorization: Bearer ${apiKey}` : '',\n      };\n\n      //  OpenAI \n      if (!usePreset && attempt !== 'minimal') {\n        body.max_tokens = apiConfig.max_tokens;\n        body.temperature = apiConfig.temperature;\n        body.top_p = apiConfig.top_p;\n      }\n\n      if (!usePreset && attempt === 'full') {\n        body.frequency_penalty = apiConfig.frequency_penalty;\n        body.presence_penalty = apiConfig.presence_penalty;\n        body.top_k = apiConfig.top_k;\n      }\n\n      return body;\n    };\n\n    const requestWithAttempt = async (attempt: 'full' | 'safe' | 'minimal'): Promise<string> => {\n      const response = await fetch(requestUrl, {\n        method: 'POST',\n        headers: {\n          ...SillyTavern.getRequestHeaders(),\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(buildAttemptBody(attempt)),\n      });\n\n      if (!response.ok) {\n        const errTxt = await response.text();\n        const err = new Error(`API: ${response.status} ${errTxt || response.statusText}`);\n        (err as Error & { status?: number }).status = response.status;\n        throw err;\n      }\n\n      const data = (await response.json()) as any;\n      if (data?.choices?.[0]?.message?.content) {\n        return String(data.choices[0].message.content).trim();\n      }\n      if (typeof data?.content === 'string') {\n        return data.content.trim();\n      }\n      if (typeof data?.text === 'string') {\n        return data.text.trim();\n      }\n\n      const details = typeof data === 'object' ? JSON.stringify(data) : String(data);\n      throw new Error(`API: ${details}`);\n    };\n\n    const attempts: Array<'full' | 'safe' | 'minimal'> = ['full', 'safe', 'minimal'];\n    let lastError: unknown = null;\n\n    for (let i = 0; i < attempts.length; i++) {\n      const attempt = attempts[i];\n      try {\n        if (i > 0) {\n          warn(` API ${attempt}`);\n        }\n        return await requestWithAttempt(attempt);\n      } catch (e) {\n        lastError = e;\n        const status = (e as { status?: number } | null)?.status;\n        const msg = e instanceof Error ? e.message : String(e);\n        const is422 = status === 422 || /\\b422\\b/.test(msg);\n        const canRetry = is422 && i < attempts.length - 1;\n        if (!canRetry) throw e;\n        warn(` API  422${attempt} -> ${attempts[i + 1]}`);\n      }\n    }\n\n    throw lastError instanceof Error ? lastError : new Error(String(lastError));\n  },\n\n  _setupStreamListener(): void {\n    this._cleanupStreamListener();\n    this._streamStop = eventOn(iframe_events.STREAM_TOKEN_RECEIVED_FULLY, (fullText: string) => {\n      this._latestStreamText = String(fullText || '');\n      this._onComment?.(fullText, false);\n    });\n  },\n\n  _cleanupStreamListener(): void {\n    if (this._streamStop) {\n      this._streamStop.stop();\n      this._streamStop = null;\n    }\n  },\n\n  _getChatContext(maxCount: number): Array<{ role: string; name: string; message: string }> {\n    try {\n      const messages = getChatMessages(`0-{{lastMessageId}}`, {\n        role: 'all',\n        hide_state: 'unhidden',\n      });\n\n      const list = Array.isArray(messages) ? messages : [];\n      const safeMaxCount = Number.isFinite(maxCount) && maxCount > 0 ? Math.floor(maxCount) : 20;\n      const recent = list.slice(-safeMaxCount);\n\n      return recent.map(msg => ({\n        role: msg.role,\n        name: msg.name,\n        message: msg.message,\n      }));\n    } catch (e) {\n      warn(':', e);\n      return [];\n    }\n  },\n\n  _resolveRoleplayOptions(config: {\n    roleName?: string;\n    ignoreCommentStyle?: boolean;\n    sendCharacterCardContent?: boolean;\n  }): RoleplayPromptOptions | undefined {\n    const roleName = String(config.roleName || '').trim();\n    if (!roleName) {\n      return undefined;\n    }\n\n    const roleplay: RoleplayPromptOptions = {\n      roleName,\n      ignoreCommentStyle: config.ignoreCommentStyle === true,\n    };\n    if (config.sendCharacterCardContent) {\n      const characterCardContent = this._getCurrentCharacterCardContent();\n      if (characterCardContent) {\n        roleplay.characterCardContent = characterCardContent;\n      } else {\n        log('');\n      }\n    }\n\n    return roleplay;\n  },\n\n  _resolveDiceReferenceOptions(enabled: boolean, visibleSheets?: unknown): DiceReferencePromptOptions | undefined {\n    if (!enabled) {\n      return undefined;\n    }\n\n    const visibleSheetNames = this._normalizeDiceVisibleSheetNames(visibleSheets);\n    const referenceText = this._getDiceDatabaseReferenceContent(visibleSheetNames);\n    if (!referenceText) {\n      log('');\n      return undefined;\n    }\n\n    log(`${referenceText.length} `);\n    return { referenceText };\n  },\n\n  _getDiceDatabaseReferenceContent(visibleSheetNames: string[]): string {\n    const apiData = this._getDiceDatabaseDataFromApi();\n    if (apiData) {\n      const apiSummary = this._summarizeDiceDatabasePayload(\n        apiData,\n        'AutoCardUpdaterAPI.exportTableAsJson',\n        visibleSheetNames,\n      );\n      if (apiSummary) {\n        return apiSummary;\n      }\n    }\n\n    const chatData = this._getDiceDatabaseDataFromChatContext();\n    if (!chatData) {\n      return '';\n    }\n\n    return this._summarizeDiceDatabasePayload(chatData, ' TavernDB_ACU_* ', visibleSheetNames);\n  },\n\n  _getDiceDatabaseDataFromApi(): Record<string, unknown> | null {\n    try {\n      const topWindow = window.parent ?? window;\n      const api = (topWindow as any)?.AutoCardUpdaterAPI;\n      if (!api || typeof api.exportTableAsJson !== 'function') {\n        return null;\n      }\n\n      return this._normalizeDiceDatabasePayload(api.exportTableAsJson());\n    } catch (e) {\n      warn(' API :', e);\n      return null;\n    }\n  },\n\n  _getDiceDatabaseDataFromChatContext(): Record<string, unknown> | null {\n    try {\n      const messages = getChatMessages(`0-{{lastMessageId}}`, {\n        role: 'all',\n        hide_state: 'all',\n      });\n      const list = Array.isArray(messages) ? messages : [];\n\n      for (let i = list.length - 1; i >= 0; i--) {\n        const payload = this._pickDiceDatabasePayloadFromMessage(list[i] as any);\n        if (payload) {\n          return payload;\n        }\n      }\n    } catch (e) {\n      warn(':', e);\n    }\n\n    return null;\n  },\n\n  _pickDiceDatabasePayloadFromMessage(message: any): Record<string, unknown> | null {\n    if (!message || typeof message !== 'object') {\n      return null;\n    }\n\n    const directCandidates: unknown[] = [\n      message.TavernDB_ACU_IndependentData,\n      message.TavernDB_ACU_Data,\n      message.TavernDB_ACU_SummaryData,\n      message.data?.TavernDB_ACU_IndependentData,\n      message.data?.TavernDB_ACU_Data,\n      message.data?.TavernDB_ACU_SummaryData,\n    ];\n    for (const candidate of directCandidates) {\n      const payload = this._normalizeDiceDatabasePayload(candidate);\n      if (payload) {\n        return payload;\n      }\n    }\n\n    const isolatedCandidates: unknown[] = [message.TavernDB_ACU_IsolatedData, message.data?.TavernDB_ACU_IsolatedData];\n    for (const candidate of isolatedCandidates) {\n      const payload = this._pickDiceDatabasePayloadFromIsolatedData(candidate);\n      if (payload) {\n        return payload;\n      }\n    }\n\n    return null;\n  },\n\n  _pickDiceDatabasePayloadFromIsolatedData(value: unknown): Record<string, unknown> | null {\n    const isolated = this._parseMaybeJsonRecord(value);\n    if (!isolated) {\n      return null;\n    }\n\n    const keys = Object.keys(isolated);\n    for (let i = keys.length - 1; i >= 0; i--) {\n      const slot = this._parseMaybeJsonRecord(isolated[keys[i]]);\n      if (!slot) {\n        continue;\n      }\n      const payload = this._normalizeDiceDatabasePayload(slot.independentData);\n      if (payload) {\n        return payload;\n      }\n    }\n\n    return null;\n  },\n\n  _normalizeDiceDatabasePayload(value: unknown): Record<string, unknown> | null {\n    const record = this._parseMaybeJsonRecord(value);\n    if (!record) {\n      return null;\n    }\n    if (this._isDiceDatabasePayload(record)) {\n      return record;\n    }\n\n    const independentData = this._parseMaybeJsonRecord(record.independentData);\n    if (independentData && this._isDiceDatabasePayload(independentData)) {\n      return independentData;\n    }\n\n    return null;\n  },\n\n  _parseMaybeJsonRecord(value: unknown): Record<string, unknown> | null {\n    if (typeof value === 'string') {\n      const text = value.trim();\n      if (!text) {\n        return null;\n      }\n      try {\n        return this._parseMaybeJsonRecord(JSON.parse(text));\n      } catch {\n        return null;\n      }\n    }\n\n    if (!value || typeof value !== 'object' || Array.isArray(value)) {\n      return null;\n    }\n    return value as Record<string, unknown>;\n  },\n\n  _isDiceDatabasePayload(value: Record<string, unknown>): boolean {\n    return Object.keys(value).some(key => key.startsWith('sheet_'));\n  },\n\n  _summarizeDiceDatabasePayload(\n    data: Record<string, unknown>,\n    sourceLabel: string,\n    visibleSheetNames: string[],\n  ): string {\n    const visibleNameSet = new Set(\n      visibleSheetNames.map(name => this._normalizeReferenceText(name)).filter(name => !!name),\n    );\n    const sheets = Object.keys(data)\n      .filter(key => key.startsWith('sheet_'))\n      .map(key => this._parseMaybeJsonRecord(data[key]))\n      .filter((sheet): sheet is Record<string, unknown> => !!sheet)\n      .map(sheet => {\n        const name = this._normalizeReferenceText(sheet.name || '');\n        return {\n          name,\n          priority: this._getDiceSheetPriority(name),\n          text: this._buildDiceSheetSummary(sheet),\n        };\n      })\n      .filter(item => !!item.text)\n      .filter(item => visibleNameSet.size === 0 || visibleNameSet.has(item.name))\n      .sort((a, b) => a.priority - b.priority || a.name.localeCompare(b.name, 'zh-CN'))\n      .slice(0, 8);\n\n    if (sheets.length === 0) {\n      return '';\n    }\n\n    const maxLength = 1800;\n    const lines = [`${sourceLabel}`, ''];\n\n    for (const item of sheets) {\n      const nextLine = `- ${item.text}`;\n      const nextText = `${lines.join('\\n')}\\n${nextLine}`;\n      if (nextText.length > maxLength) {\n        break;\n      }\n      lines.push(nextLine);\n    }\n\n    return lines.join('\\n');\n  },\n\n  _normalizeDiceVisibleSheetNames(value: unknown): string[] {\n    if (!Array.isArray(value)) {\n      return [];\n    }\n    const list: string[] = [];\n    const seen = new Set<string>();\n    for (const item of value) {\n      const name = this._normalizeReferenceText(item);\n      if (!name) {\n        continue;\n      }\n      if (seen.has(name)) {\n        continue;\n      }\n      seen.add(name);\n      list.push(name);\n    }\n    return list;\n  },\n\n  _getDiceSheetPriority(sheetName: string): number {\n    const map: Record<string, number> = {\n      : 0,\n      : 1,\n      : 2,\n      : 3,\n      : 4,\n      : 5,\n    };\n    return map[sheetName] ?? 99;\n  },\n\n  _buildDiceSheetSummary(sheet: Record<string, unknown>): string {\n    const sheetName = this._normalizeReferenceText(sheet.name || '') || '';\n    const content = Array.isArray(sheet.content) ? (sheet.content as unknown[]) : [];\n    const rows = content.filter((row): row is unknown[] => Array.isArray(row));\n\n    if (rows.length === 0) {\n      return '';\n    }\n\n    const headerRow = Array.isArray(rows[0]) ? rows[0] : [];\n    const headers = headerRow.map((cell, index) => this._normalizeReferenceText(cell) || `${index}`);\n    const dataRows = rows\n      .slice(1)\n      .filter(row => row.some((cell, index) => index > 0 && !!this._normalizeReferenceText(cell)));\n\n    if (dataRows.length === 0) {\n      return `${sheetName}: `;\n    }\n\n    const rowText = dataRows\n      .slice(-2)\n      .map(row => this._formatDiceSheetRow(headers, row))\n      .filter(text => !!text);\n    if (rowText.length === 0) {\n      return `${sheetName}: `;\n    }\n\n    return `${sheetName}: ${rowText.join(' | ')}`;\n  },\n\n  _formatDiceSheetRow(headers: string[], row: unknown[]): string {\n    const pairs: string[] = [];\n    for (let index = 1; index < row.length; index++) {\n      const value = this._normalizeReferenceText(row[index]);\n      if (!value) {\n        continue;\n      }\n      const label = headers[index] || `${index}`;\n      pairs.push(`${label}: ${this._truncateReferenceText(value, 56)}`);\n      if (pairs.length >= 3) {\n        break;\n      }\n    }\n\n    if (pairs.length > 0) {\n      return pairs.join('');\n    }\n\n    const fallback = row.map(cell => this._normalizeReferenceText(cell)).find(text => !!text) || '';\n    return this._truncateReferenceText(fallback, 90);\n  },\n\n  _normalizeReferenceText(value: unknown): string {\n    return String(value ?? '')\n      .replace(/\\u00a0/g, ' ')\n      .replace(/\\r\\n/g, '\\n')\n      .replace(/\\n+/g, ' ')\n      .replace(/\\s{2,}/g, ' ')\n      .trim();\n  },\n\n  _truncateReferenceText(text: string, maxLength: number): string {\n    if (text.length <= maxLength) {\n      return text;\n    }\n    return `${text.slice(0, Math.max(0, maxLength - 1))}`;\n  },\n\n  _getCurrentCharacterCardContent(): string {\n    try {\n      const context = SillyTavern?.getContext?.() as any;\n      if (!context) {\n        return '';\n      }\n\n      const characters = Array.isArray(context.characters) ? context.characters : [];\n      if (characters.length === 0) {\n        return '';\n      }\n\n      const charIdRaw = context.characterId;\n      let current: any = null;\n\n      if (charIdRaw !== undefined && charIdRaw !== null) {\n        const idText = String(charIdRaw).trim();\n        const idNum = Number(idText);\n        if (Number.isFinite(idNum) && idNum >= 0 && idNum < characters.length) {\n          current = characters[idNum];\n        }\n      }\n\n      if (!current) {\n        const currentName = String(context.name2 || '').trim();\n        if (currentName) {\n          current = characters.find((item: any) => String(item?.name || '').trim() === currentName) || null;\n        }\n      }\n\n      if (!current && characters.length === 1) {\n        current = characters[0];\n      }\n\n      if (!current) {\n        return '';\n      }\n\n      const fields: Array<[string, unknown]> = [\n        ['', current.name],\n        ['', current.description ?? current.data?.description],\n        ['', current.personality ?? current.data?.personality],\n        ['', current.scenario ?? current.data?.scenario],\n        ['', current.first_mes ?? current.data?.first_mes],\n        ['', current.mes_example ?? current.data?.mes_example],\n        ['', current.data?.system_prompt],\n        ['', current.data?.post_history_instructions],\n      ];\n\n      const lines = fields\n        .map(([label, value]) => {\n          const text = this._normalizeCharacterCardField(value);\n          return text ? `${label}: ${text}` : '';\n        })\n        .filter(line => !!line);\n\n      return lines.join('\\n');\n    } catch (e) {\n      warn(':', e);\n      return '';\n    }\n  },\n\n  _normalizeCharacterCardField(value: unknown): string {\n    return String(value ?? '')\n      .replace(/\\u00a0/g, ' ')\n      .replace(/\\r\\n/g, '\\n')\n      .replace(/\\n{3,}/g, '\\n\\n')\n      .trim();\n  },\n\n  _getTamakoTodaySpecialContent(): string {\n    try {\n      const topWindow = window.parent ?? window;\n      const topDocument = topWindow.document ?? document;\n      const currentSelector = '#tamako-market-window .tamako-content[data-content=\"current\"]';\n\n      const emptyMessage = topDocument.querySelector(`${currentSelector} .tamako-empty .message`);\n      if (emptyMessage) {\n        return '';\n      }\n\n      const plotContent = topDocument.querySelector(`${currentSelector} .tamako-plot-content`) as HTMLElement | null;\n      const directText = this._sanitizeTamakoText(plotContent?.innerText || plotContent?.textContent || '');\n      if (directText) {\n        return directText;\n      }\n\n      const beautifierFrame = topDocument.querySelector(\n        `${currentSelector} iframe.tamako-beautifier-frame`,\n      ) as HTMLIFrameElement | null;\n      const payload = this._readTamakoPayloadFromIframe(beautifierFrame);\n      const payloadText = this._extractTamakoTextFromPayload(payload);\n      if (payloadText) {\n        return payloadText;\n      }\n\n      const currentContent = topDocument.querySelector(currentSelector) as HTMLElement | null;\n      return this._sanitizeTamakoText(currentContent?.innerText || currentContent?.textContent || '');\n    } catch (e) {\n      warn(':', e);\n      return '';\n    }\n  },\n\n  _readTamakoPayloadFromIframe(iframe: HTMLIFrameElement | null): any | null {\n    if (!iframe) {\n      return null;\n    }\n    const name = String(iframe.name || '').trim();\n    if (!name.startsWith('TAMAKO_DATA:')) {\n      return null;\n    }\n    try {\n      return JSON.parse(name.slice('TAMAKO_DATA:'.length));\n    } catch (e) {\n      warn(' payload :', e);\n      return null;\n    }\n  },\n\n  _extractTamakoTextFromPayload(payload: any): string {\n    if (!payload || typeof payload !== 'object') {\n      return '';\n    }\n\n    const captureTags = this._getTamakoCaptureTags();\n    const tags = payload.tags && typeof payload.tags === 'object' ? payload.tags : {};\n    const valuesFromTags: string[] = [];\n    for (const tag of captureTags) {\n      const value = this._sanitizeTamakoText(tags[tag]);\n      if (value) {\n        valuesFromTags.push(value);\n      }\n    }\n    if (valuesFromTags.length > 0) {\n      return valuesFromTags.join('\\n\\n');\n    }\n\n    const raw = String(payload.raw || '');\n    if (!raw) {\n      return '';\n    }\n    return this._extractTamakoTagText(raw, captureTags);\n  },\n\n  _getTamakoCaptureTags(): string[] {\n    try {\n      const context = SillyTavern?.getContext?.() as any;\n      const tags = context?.extensionSettings?.TamakoMarket?.captureTags;\n      if (Array.isArray(tags)) {\n        const normalized = tags.map(tag => String(tag || '').trim()).filter(tag => !!tag);\n        if (normalized.length > 0) {\n          return normalized;\n        }\n      }\n    } catch {\n      // ignore\n    }\n    return ['recall', 'scene_direction'];\n  },\n\n  _extractTamakoTagText(raw: string, tags: string[]): string {\n    const values: string[] = [];\n    for (const tag of tags) {\n      const safeTag = String(tag || '').trim();\n      if (!safeTag) {\n        continue;\n      }\n      const escapedTag = safeTag.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n      const regex = new RegExp(`<${escapedTag}(?:\\\\s[^>]*)?>([\\\\s\\\\S]*?)<\\\\/${escapedTag}>`, 'gi');\n      let match: RegExpExecArray | null;\n      while ((match = regex.exec(raw)) !== null) {\n        const value = this._sanitizeTamakoText(match[1] || '');\n        if (value) {\n          values.push(value);\n        }\n      }\n    }\n    return values.join('\\n\\n');\n  },\n\n  _sanitizeTamakoText(value: unknown): string {\n    const text = String(value ?? '')\n      .replace(/\\u00a0/g, ' ')\n      .replace(/\\r\\n/g, '\\n')\n      .replace(/\\n{3,}/g, '\\n\\n')\n      .trim();\n    if (!text) {\n      return '';\n    }\n    if (/^(~|\\.\\.\\.||\\.\\.\\.|\\.\\.\\.|\\.\\.\\.)$/.test(text)) {\n      return '';\n    }\n    return text;\n  },\n\n  destroy(): void {\n    this._cleanupStreamListener();\n    this._onComment = null;\n    this._latestStreamText = '';\n    this.isGenerating = false;\n  },\n};\n","import type { EmotionTag } from '../core/constants';\nimport { resolveEmotionTag, type EmotionConfig } from '../core/emotion';\n\nconst RE_THINK_CLOSED = /<(think|thinking)>[\\s\\S]*?<\\/\\1>/gi;\nconst RE_THINK_UNCLOSED = /<(think|thinking)>[\\s\\S]*$/gi;\n\nexport type EmotionCotParseResult = {\n  cleanText: string;\n  rawTag: string | null;\n  normalizedTag: EmotionTag | null;\n  context: string | null;\n};\n\nexport function stripThinkBlocks(input: unknown): string {\n  const text = String(input || '');\n  return text.replace(RE_THINK_CLOSED, '').replace(RE_THINK_UNCLOSED, '');\n}\n\nfunction parseBracketContent(bracketContent: string): { rawTag: string; context: string | null } {\n  const content = String(bracketContent || '').trim();\n  if (!content) return { rawTag: '', context: null };\n\n  const pipeParts = content.split('|');\n  const exprVoicePart = (pipeParts[0] || '').trim();\n  const context = (pipeParts[1] || '').trim();\n\n  const expression = (exprVoicePart.split(',')[0] || '').trim();\n  return { rawTag: expression, context: context || null };\n}\n\nfunction isPendingPrefix(text: string): boolean {\n  const t = String(text || '').trimStart();\n  if (!t) return false;\n\n  if (t.startsWith('[')) {\n    const close = t.indexOf(']');\n    if (close === -1) return true;\n    const body = t.slice(close + 1);\n    return !body.trim();\n  }\n\n  const open = t.indexOf('[');\n  if (open > 0 && open < 30) {\n    const close = t.indexOf(']', open + 1);\n    if (close === -1) return true;\n    const after = t.slice(close + 1);\n    if (!/^\\s*[:]/.test(after)) return true;\n    const body = after.replace(/^\\s*[:]\\s*/, '');\n    return !body.trim();\n  }\n\n  return false;\n}\n\nexport function parseEmotionCotText(\n  input: unknown,\n  options: {\n    enabled: boolean;\n    stripFromText: boolean;\n    configs: EmotionConfig[];\n  },\n): EmotionCotParseResult {\n  const rawText = stripThinkBlocks(input);\n\n  if (!options.enabled) {\n    return {\n      cleanText: rawText,\n      rawTag: null,\n      normalizedTag: null,\n      context: null,\n    };\n  }\n\n  if (isPendingPrefix(rawText)) {\n    return {\n      cleanText: '',\n      rawTag: null,\n      normalizedTag: null,\n      context: null,\n    };\n  }\n\n  // Speaker : [|]: \n  const speakerMatch = rawText.match(/^\\s*([^\\[\\]\\n\\r]{1,40})\\s*\\[([^\\]]+)\\]\\s*[:]\\s*([\\s\\S]*)$/);\n  if (speakerMatch) {\n    const bracketContent = speakerMatch[2] || '';\n    const body = speakerMatch[3] || '';\n    const { rawTag, context } = parseBracketContent(bracketContent);\n    const normalizedTag = resolveEmotionTag(rawTag, options.configs);\n\n    return {\n      cleanText: normalizedTag && options.stripFromText ? body.trimStart() : rawText,\n      rawTag: rawTag || null,\n      normalizedTag,\n      context,\n    };\n  }\n\n  // : [|] \n  const prefixMatch = rawText.match(/^\\s*\\[([^\\]]+)\\]\\s*([\\s\\S]*)$/);\n  if (prefixMatch) {\n    const bracketContent = prefixMatch[1] || '';\n    const body = prefixMatch[2] || '';\n    const { rawTag, context } = parseBracketContent(bracketContent);\n    const normalizedTag = resolveEmotionTag(rawTag, options.configs);\n\n    return {\n      cleanText: normalizedTag && options.stripFromText ? body.trimStart() : rawText,\n      rawTag: rawTag || null,\n      normalizedTag,\n      context,\n    };\n  }\n\n  return {\n    cleanText: rawText,\n    rawTag: null,\n    normalizedTag: null,\n    context: null,\n  };\n}\n","import { defineStore } from 'pinia';\nimport { ref } from 'vue';\n\n/**\n *  UI \n */\nexport const useUiStore = defineStore('desktop-pet-ui', () => {\n  const showSettings = ref(false);\n\n  function openSettings(): void {\n    showSettings.value = true;\n  }\n\n  function closeSettings(): void {\n    showSettings.value = false;\n  }\n\n  return { showSettings, openSettings, closeSettings };\n});\n\n","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"bubble-content\" };\nconst _hoisted_2 = { class: \"bubble-text\" };\nconst _hoisted_3 = {\n    key: 1,\n    class: \"cursor\"\n};\nimport { onUnmounted, ref, watch } from 'vue';\nimport { Live2DManager } from '../live2d/manager';\nconst HEAD_ANCHOR_RATIO = 0.2;\nconst BUBBLE_GAP = 12;\nconst MIN_BUBBLE_TOP = 8;\nconst EDGE_PADDING = 8;\nconst LOADING_INTERVAL_MS = 340;\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ChatBubble',\n    props: {\n        text: {},\n        isDone: { type: Boolean },\n        autoCloseDelaySeconds: {}\n    },\n    emits: [\"hidden\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const visible = ref(false);\n        const displayText = ref('');\n        const bubbleStyle = ref({});\n        const LOADING_FRAMES = ['', '', '', ''];\n        let positionTimer = null;\n        let loadingTimer = null;\n        let autoCloseTimer = null;\n        let loadingFrameIndex = 0;\n        function getTopWindow() {\n            try {\n                return window.parent ?? window;\n            }\n            catch {\n                return window;\n            }\n        }\n        function getFiniteNumber(value) {\n            const n = typeof value === 'number' ? value : Number(value);\n            return Number.isFinite(n) ? n : null;\n        }\n        function getModelHeadAnchor(rect) {\n            const model = Live2DManager.model;\n            if (!model || typeof model.getBounds !== 'function')\n                return null;\n            try {\n                const bounds = model.getBounds?.();\n                const x = getFiniteNumber(bounds?.x);\n                const y = getFiniteNumber(bounds?.y);\n                const width = getFiniteNumber(bounds?.width);\n                const height = getFiniteNumber(bounds?.height);\n                if (x === null || y === null || width === null || height === null || width <= 0 || height <= 0) {\n                    return null;\n                }\n                return {\n                    x: rect.left + x + width / 2,\n                    y: rect.top + y + height * HEAD_ANCHOR_RATIO,\n                };\n            }\n            catch {\n                return null;\n            }\n        }\n        function updateBubblePosition() {\n            try {\n                const top = getTopWindow();\n                const stage = top.document.getElementById('desktop-pet-stage');\n                const rect = stage?.getBoundingClientRect?.();\n                const vw = top.innerWidth || top.document.documentElement.clientWidth || 0;\n                const vh = top.innerHeight || top.document.documentElement.clientHeight || 0;\n                if (rect && rect.width > 0 && rect.height > 0) {\n                    const anchor = getModelHeadAnchor(rect);\n                    const fallbackX = rect.left + rect.width / 2;\n                    const fallbackY = rect.top + rect.height * 0.22;\n                    const rawLeft = anchor?.x ?? fallbackX;\n                    const rawTop = (anchor?.y ?? fallbackY) - BUBBLE_GAP;\n                    const safeLeft = Math.max(EDGE_PADDING, Math.min(rawLeft, Math.max(EDGE_PADDING, vw - EDGE_PADDING)));\n                    const safeTop = Math.max(MIN_BUBBLE_TOP, Math.min(rawTop, Math.max(MIN_BUBBLE_TOP, vh - EDGE_PADDING)));\n                    bubbleStyle.value = {\n                        left: `${Math.round(safeLeft)}px`,\n                        top: `${Math.round(safeTop)}px`,\n                    };\n                    return;\n                }\n                bubbleStyle.value = {\n                    left: `${Math.round(vw * 0.5)}px`,\n                    top: `${Math.round(Math.max(8, vh * 0.2))}px`,\n                };\n            }\n            catch {\n                bubbleStyle.value = {\n                    left: '50vw',\n                    top: '20vh',\n                };\n            }\n        }\n        function startPositionSync() {\n            stopPositionSync();\n            updateBubblePosition();\n            positionTimer = setInterval(updateBubblePosition, 100);\n        }\n        function stopPositionSync() {\n            if (!positionTimer)\n                return;\n            clearInterval(positionTimer);\n            positionTimer = null;\n        }\n        function startLoadingAnimation() {\n            if (loadingTimer)\n                return;\n            loadingFrameIndex = 0;\n            displayText.value = LOADING_FRAMES[loadingFrameIndex];\n            loadingTimer = setInterval(() => {\n                loadingFrameIndex = (loadingFrameIndex + 1) % LOADING_FRAMES.length;\n                displayText.value = LOADING_FRAMES[loadingFrameIndex];\n            }, LOADING_INTERVAL_MS);\n        }\n        function stopLoadingAnimation() {\n            if (!loadingTimer)\n                return;\n            clearInterval(loadingTimer);\n            loadingTimer = null;\n        }\n        function stopAutoCloseTimer() {\n            if (!autoCloseTimer)\n                return;\n            clearTimeout(autoCloseTimer);\n            autoCloseTimer = null;\n        }\n        function getAutoCloseDelayMs() {\n            const delaySeconds = typeof props.autoCloseDelaySeconds === 'number'\n                ? props.autoCloseDelaySeconds\n                : Number(props.autoCloseDelaySeconds ?? Number.NaN);\n            if (!Number.isFinite(delaySeconds))\n                return -1;\n            const normalizedSeconds = Math.round(delaySeconds);\n            if (normalizedSeconds < 0)\n                return normalizedSeconds;\n            return normalizedSeconds * 1000;\n        }\n        function scheduleAutoClose() {\n            stopAutoCloseTimer();\n            if (!props.isDone)\n                return;\n            if (!String(props.text || '').trim())\n                return;\n            const delayMs = getAutoCloseDelayMs();\n            if (delayMs < 0)\n                return;\n            autoCloseTimer = setTimeout(() => {\n                autoCloseTimer = null;\n                closeBubble();\n            }, delayMs);\n        }\n        function syncBubbleState() {\n            const text = String(props.text || '');\n            if (text) {\n                visible.value = true;\n                displayText.value = text;\n                stopLoadingAnimation();\n                startPositionSync();\n                scheduleAutoClose();\n                return;\n            }\n            if (!props.isDone) {\n                visible.value = true;\n                startLoadingAnimation();\n                startPositionSync();\n                stopAutoCloseTimer();\n                return;\n            }\n            visible.value = false;\n            displayText.value = '';\n            stopLoadingAnimation();\n            stopPositionSync();\n            stopAutoCloseTimer();\n        }\n        watch([() => props.text, () => props.isDone, () => props.autoCloseDelaySeconds], syncBubbleState, {\n            immediate: true,\n        });\n        function closeBubble() {\n            visible.value = false;\n            displayText.value = '';\n            stopLoadingAnimation();\n            stopPositionSync();\n            stopAutoCloseTimer();\n            emit('hidden');\n        }\n        onUnmounted(() => {\n            stopLoadingAnimation();\n            stopPositionSync();\n            stopAutoCloseTimer();\n        });\n        return (_ctx, _cache) => {\n            return (visible.value)\n                ? (_openBlock(), _createElementBlock(\"div\", {\n                    key: 0,\n                    class: \"chat-bubble\",\n                    style: _normalizeStyle(bubbleStyle.value)\n                }, [\n                    _createElementVNode(\"div\", _hoisted_1, [\n                        (__props.isDone)\n                            ? (_openBlock(), _createElementBlock(\"button\", {\n                                key: 0,\n                                type: \"button\",\n                                class: \"bubble-close\",\n                                \"aria-label\": \"\",\n                                onClick: closeBubble\n                            }, \"  \"))\n                            : _createCommentVNode(\"v-if\", true),\n                        _createElementVNode(\"span\", _hoisted_2, _toDisplayString(displayText.value), 1 /* TEXT */),\n                        (!__props.isDone)\n                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_3, \"|\"))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]),\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"bubble-arrow\" }, null, -1 /* CACHED */))\n                ], 4 /* STYLE */))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ChatBubble.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ChatBubble.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ChatBubble.vue?vue&type=style&index=0&id=98097aea&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-98097aea\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, toDisplayString as _toDisplayString, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, Transition as _Transition, withCtx as _withCtx, createVNode as _createVNode, withModifiers as _withModifiers, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"menu-panel\" };\nconst _hoisted_2 = { class: \"command-sub\" };\nconst _hoisted_3 = { class: \"command-sub\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"chat-drawer\"\n};\nconst _hoisted_5 = { class: \"drawer-head\" };\nconst _hoisted_6 = { class: \"drawer-actions\" };\nconst _hoisted_7 = [\"disabled\"];\nimport { computed, nextTick, onUnmounted, ref, watch } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'FunctionMenu',\n    props: {\n        visible: { type: Boolean },\n        x: {},\n        y: {},\n        placement: {},\n        motionLoopEnabled: { type: Boolean },\n        commentStyle: {}\n    },\n    emits: [\"close\", \"send-chat\", \"toggle-motion-loop\", \"switch-model\", \"switch-persona\", \"close-model\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const menuEl = ref(null);\n        const inputEl = ref(null);\n        const input = ref('');\n        const chatOpen = ref(false);\n        const posX = ref(0);\n        const posY = ref(0);\n        function getTopWindow() {\n            try {\n                return window.parent ?? window;\n            }\n            catch {\n                return window;\n            }\n        }\n        const panelTransform = computed(() => (props.placement === 'left'\n            ? 'translate(-100%, -50%)'\n            : 'translate(0, -50%)'));\n        const panelStyle = computed(() => ({\n            left: `${posX.value}px`,\n            top: `${posY.value}px`,\n            transform: panelTransform.value,\n        }));\n        function clampIntoViewport() {\n            const el = menuEl.value;\n            if (!el)\n                return;\n            const top = getTopWindow();\n            const vw = top.innerWidth || top.document.documentElement.clientWidth || 0;\n            const vh = top.innerHeight || top.document.documentElement.clientHeight || 0;\n            const margin = 8;\n            const rect = el.getBoundingClientRect();\n            if (vw > 0) {\n                if (rect.left < margin) {\n                    posX.value += margin - rect.left;\n                }\n                else if (rect.right > vw - margin) {\n                    posX.value -= rect.right - (vw - margin);\n                }\n            }\n            if (vh > 0) {\n                if (rect.top < margin) {\n                    posY.value += margin - rect.top;\n                }\n                else if (rect.bottom > vh - margin) {\n                    posY.value -= rect.bottom - (vh - margin);\n                }\n            }\n        }\n        function close() {\n            chatOpen.value = false;\n            emit('close');\n        }\n        function send() {\n            const message = input.value.trim();\n            if (!message)\n                return;\n            emit('send-chat', message);\n            input.value = '';\n        }\n        function openChat() {\n            chatOpen.value = true;\n            void nextTick(() => {\n                clampIntoViewport();\n                inputEl.value?.focus();\n                inputEl.value?.select();\n            });\n        }\n        function onInputKeydown(e) {\n            if (e.key === 'Escape') {\n                e.preventDefault();\n                close();\n                return;\n            }\n            if (e.key === 'Enter' && !e.shiftKey) {\n                e.preventDefault();\n                send();\n            }\n        }\n        const onGlobalKeydown = (e) => {\n            if (!props.visible)\n                return;\n            if (e.key === 'Escape') {\n                e.preventDefault();\n                close();\n            }\n        };\n        watch(() => props.visible, async (visible) => {\n            if (!visible) {\n                chatOpen.value = false;\n                return;\n            }\n            posX.value = Number.isFinite(props.x) ? props.x : 0;\n            posY.value = Number.isFinite(props.y) ? props.y : 0;\n            chatOpen.value = false;\n            await nextTick();\n            clampIntoViewport();\n        }, { immediate: true });\n        watch(() => [props.x, props.y, props.placement, chatOpen.value], async () => {\n            if (!props.visible)\n                return;\n            posX.value = Number.isFinite(props.x) ? props.x : 0;\n            posY.value = Number.isFinite(props.y) ? props.y : 0;\n            await nextTick();\n            clampIntoViewport();\n        });\n        try {\n            getTopWindow().addEventListener('keydown', onGlobalKeydown);\n        }\n        catch {\n            // ignore\n        }\n        onUnmounted(() => {\n            try {\n                getTopWindow().removeEventListener('keydown', onGlobalKeydown);\n            }\n            catch {\n                // ignore\n            }\n        });\n        return (_ctx, _cache) => {\n            return (__props.visible)\n                ? (_openBlock(), _createElementBlock(\"div\", {\n                    key: 0,\n                    class: \"menu-overlay\",\n                    onClick: _withModifiers(close, [\"self\"])\n                }, [\n                    _createElementVNode(\"div\", {\n                        ref_key: \"menuEl\",\n                        ref: menuEl,\n                        class: _normalizeClass([\"menu-cluster\", [`is-${__props.placement}`, { 'chat-open': chatOpen.value }]]),\n                        style: _normalizeStyle(panelStyle.value),\n                        onClick: _cache[6] || (_cache[6] = _withModifiers(() => { }, [\"stop\"]))\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_1, [\n                            _createElementVNode(\"div\", { class: \"panel-top\" }, [\n                                _cache[7] || (_cache[7] = _createElementVNode(\"span\", { class: \"panel-title\" }, \"TACTICAL\", -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"icon-btn\",\n                                    type: \"button\",\n                                    onClick: close\n                                }, \"\")\n                            ]),\n                            _createElementVNode(\"button\", {\n                                class: _normalizeClass([\"command-btn\", { active: chatOpen.value }]),\n                                type: \"button\",\n                                onClick: openChat\n                            }, [...(_cache[8] || (_cache[8] = [\n                                    _createElementVNode(\"span\", { class: \"command-index\" }, \"01\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-main\" }, \"CHAT\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-sub\" }, \"MESSAGE LINK\", -1 /* CACHED */)\n                                ]))], 2 /* CLASS */),\n                            _createElementVNode(\"button\", {\n                                class: \"command-btn\",\n                                type: \"button\",\n                                onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('toggle-motion-loop')))\n                            }, [\n                                _cache[9] || (_cache[9] = _createElementVNode(\"span\", { class: \"command-index\" }, \"02\", -1 /* CACHED */)),\n                                _cache[10] || (_cache[10] = _createElementVNode(\"span\", { class: \"command-main\" }, \"MOTION\", -1 /* CACHED */)),\n                                _createElementVNode(\"span\", _hoisted_2, _toDisplayString(__props.motionLoopEnabled ? 'ON' : 'OFF'), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"button\", {\n                                class: \"command-btn\",\n                                type: \"button\",\n                                onClick: _cache[1] || (_cache[1] = ($event) => (_ctx.$emit('switch-model')))\n                            }, [...(_cache[11] || (_cache[11] = [\n                                    _createElementVNode(\"span\", { class: \"command-index\" }, \"03\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-main\" }, \"MODEL\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-sub\" }, \"SWITCH\", -1 /* CACHED */)\n                                ]))]),\n                            _createElementVNode(\"button\", {\n                                class: \"command-btn\",\n                                type: \"button\",\n                                onClick: _cache[2] || (_cache[2] = ($event) => (_ctx.$emit('switch-persona')))\n                            }, [\n                                _cache[12] || (_cache[12] = _createElementVNode(\"span\", { class: \"command-index\" }, \"04\", -1 /* CACHED */)),\n                                _cache[13] || (_cache[13] = _createElementVNode(\"span\", { class: \"command-main\" }, \"PERSONA\", -1 /* CACHED */)),\n                                _createElementVNode(\"span\", _hoisted_3, _toDisplayString(__props.commentStyle), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"button\", {\n                                class: \"command-btn danger\",\n                                type: \"button\",\n                                onClick: _cache[3] || (_cache[3] = ($event) => (_ctx.$emit('close-model')))\n                            }, [...(_cache[14] || (_cache[14] = [\n                                    _createElementVNode(\"span\", { class: \"command-index\" }, \"05\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-main\" }, \"CLOSE\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-sub\" }, \"MODEL OFF\", -1 /* CACHED */)\n                                ]))])\n                        ]),\n                        _createVNode(_Transition, { name: \"drawer\" }, {\n                            default: _withCtx(() => [\n                                (chatOpen.value)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                                        _createElementVNode(\"div\", _hoisted_5, [\n                                            _cache[15] || (_cache[15] = _createElementVNode(\"span\", { class: \"drawer-title\" }, \"MESSAGE LINK\", -1 /* CACHED */)),\n                                            _createElementVNode(\"button\", {\n                                                class: \"drawer-close\",\n                                                type: \"button\",\n                                                onClick: _cache[4] || (_cache[4] = ($event) => (chatOpen.value = false))\n                                            }, \"\")\n                                        ]),\n                                        _withDirectives(_createElementVNode(\"textarea\", {\n                                            ref_key: \"inputEl\",\n                                            ref: inputEl,\n                                            \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event) => ((input).value = $event)),\n                                            class: \"chat-input\",\n                                            rows: \"4\",\n                                            placeholder: \"... (Enter  / Shift+Enter )\",\n                                            onKeydown: onInputKeydown\n                                        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                            [_vModelText, input.value]\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_6, [\n                                            _createElementVNode(\"button\", {\n                                                class: \"send-btn\",\n                                                type: \"button\",\n                                                disabled: !input.value.trim(),\n                                                onClick: send\n                                            }, \" SEND \", 8 /* PROPS */, _hoisted_7)\n                                        ]),\n                                        _cache[16] || (_cache[16] = _createElementVNode(\"div\", { class: \"drawer-hint\" }, \"\", -1 /* CACHED */))\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]),\n                            _: 1 /* STABLE */\n                        })\n                    ], 6 /* CLASS, STYLE */)\n                ]))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./FunctionMenu.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FunctionMenu.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./FunctionMenu.vue?vue&type=style&index=0&id=ff4f8948&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-ff4f8948\"]])\n\nexport default __exports__","import { EIKANYA_API_BASE, EIKANYA_CDN_BASE, EIKANYA_RAW_BASE } from '../core/constants';\nimport { Live2DManager } from './manager';\n\n/**  */\nexport interface RepoEntry {\n  name: string;\n  path: string;\n  type: 'file' | 'dir';\n  isModel: boolean;\n}\n\n/**  */\nconst cache = new Map<string, RepoEntry[]>();\n\n/**  Live2D  JSON */\nexport function isModelFile(name: string): boolean {\n  const lower = name.toLowerCase();\n  return (\n    lower === 'model.json' ||\n    lower === 'model3.json' ||\n    lower.endsWith('.model.json') ||\n    lower.endsWith('.model3.json')\n  );\n}\n\n/**  */\nconst FILTERED_EXTENSIONS = ['.zip', '.rar', '.7z', '.md', '.txt', '.png', '.jpg', '.jpeg', '.gif', '.bmp', '.psd', '.webp', '.mp3', '.wav', '.ogg', '.mp4', '.mtn'];\n\nfunction shouldShow(entry: { name: string; type: string }): boolean {\n  if (entry.type === 'dir') return true;\n  if (isModelFile(entry.name)) return true;\n  // \n  const lower = entry.name.toLowerCase();\n  for (const ext of FILTERED_EXTENSIONS) {\n    if (lower.endsWith(ext)) return false;\n  }\n  //  JSON \n  return isModelFile(entry.name);\n}\n\n/**  GitHub API  */\nexport async function fetchDirectory(path: string): Promise<RepoEntry[]> {\n  // \n  const cached = cache.get(path);\n  if (cached) return cached;\n\n  const apiUrl = `${EIKANYA_API_BASE}${path}`;\n\n  let data: any[];\n  try {\n    //  GitHub API CORS\n    const resp = await fetch(apiUrl, {\n      headers: { Accept: 'application/vnd.github.v3+json' },\n    });\n\n    if (resp.status === 403) {\n      const remaining = resp.headers.get('X-RateLimit-Remaining');\n      const resetTime = resp.headers.get('X-RateLimit-Reset');\n      const resetDate = resetTime ? new Date(parseInt(resetTime) * 1000) : null;\n      throw new RateLimitError(remaining, resetDate);\n    }\n\n    if (!resp.ok) throw new Error(`HTTP ${resp.status}`);\n    data = await resp.json();\n  } catch (e) {\n    if (e instanceof RateLimitError) throw e;\n    //  CORS \n    const proxiedUrl = Live2DManager._getProxiedUrl(apiUrl);\n    const resp = await fetch(proxiedUrl, {\n      headers: { Accept: 'application/vnd.github.v3+json' },\n    });\n\n    if (resp.status === 403) {\n      throw new RateLimitError(null, null);\n    }\n    if (!resp.ok) throw new Error(`: HTTP ${resp.status}`);\n    data = await resp.json();\n  }\n\n  if (!Array.isArray(data)) {\n    throw new Error('GitHub API ');\n  }\n\n  const entries: RepoEntry[] = data\n    .map((item: any) => ({\n      name: item.name as string,\n      path: item.path as string,\n      type: (item.type === 'dir' ? 'dir' : 'file') as 'file' | 'dir',\n      isModel: item.type === 'file' && isModelFile(item.name),\n    }))\n    .filter(shouldShow)\n    .sort((a, b) => {\n      // \n      if (a.type !== b.type) return a.type === 'dir' ? -1 : 1;\n      return a.name.localeCompare(b.name);\n    });\n\n  cache.set(path, entries);\n  return entries;\n}\n\n/**  GitHub  CDN  raw URL ASCII  */\nexport function buildCdnUrl(path: string, useCdn: boolean = true): string {\n  const encodedPath = path.split('/').map(s => encodeURIComponent(s)).join('/');\n  const base = useCdn ? EIKANYA_CDN_BASE : EIKANYA_RAW_BASE;\n  return `${base}${encodedPath}`;\n}\n\n/**  */\nexport function clearCache(): void {\n  cache.clear();\n}\n\n/** API  */\nexport class RateLimitError extends Error {\n  remaining: string | null;\n  resetDate: Date | null;\n\n  constructor(remaining: string | null, resetDate: Date | null) {\n    const resetStr = resetDate ? resetDate.toLocaleTimeString() : '';\n    super(`GitHub API  ${resetStr} `);\n    this.name = 'RateLimitError';\n    this.remaining = remaining;\n    this.resetDate = resetDate;\n  }\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode, Fragment as _Fragment, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, renderList as _renderList, resolveComponent as _resolveComponent, createBlock as _createBlock, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = { class: \"tree-node\" };\nconst _hoisted_2 = {\n    key: 1,\n    class: \"expand-icon placeholder\"\n};\nconst _hoisted_3 = { class: \"node-icon\" };\nconst _hoisted_4 = [\"title\"];\nconst _hoisted_5 = {\n    key: 2,\n    class: \"node-spinner\"\n};\nimport { ref, computed } from 'vue';\nimport { fetchDirectory, RateLimitError } from '../live2d/model-browser';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'TreeNode',\n    props: {\n        entry: {},\n        depth: {},\n        searchQuery: {}\n    },\n    emits: [\"select-model\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const expanded = ref(false);\n        const children = ref([]);\n        const loading = ref(false);\n        const loadedOnce = ref(false);\n        const childError = ref('');\n        const isSelected = ref(false);\n        const filteredChildren = computed(() => {\n            if (!props.searchQuery.trim())\n                return children.value;\n            const q = props.searchQuery.toLowerCase();\n            return children.value.filter(c => c.name.toLowerCase().includes(q) || c.type === 'dir');\n        });\n        async function loadChildren() {\n            loading.value = true;\n            childError.value = '';\n            try {\n                children.value = await fetchDirectory(props.entry.path);\n                loadedOnce.value = true;\n            }\n            catch (e) {\n                if (e instanceof RateLimitError) {\n                    childError.value = e.message;\n                }\n                else {\n                    childError.value = `: ${e.message || ''}`;\n                }\n            }\n            finally {\n                loading.value = false;\n            }\n        }\n        function handleClick() {\n            if (props.entry.type === 'dir') {\n                expanded.value = !expanded.value;\n                if (expanded.value && !loadedOnce.value) {\n                    loadChildren();\n                }\n            }\n            else if (props.entry.isModel) {\n                isSelected.value = true;\n                emit('select-model', props.entry.path);\n            }\n        }\n        return (_ctx, _cache) => {\n            const _component_TreeNode = _resolveComponent(\"TreeNode\", true);\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", {\n                    class: _normalizeClass([\"node-row\", { 'is-model': __props.entry.isModel, 'is-selected': isSelected.value }]),\n                    style: _normalizeStyle({ paddingLeft: __props.depth * 16 + 'px' }),\n                    onClick: handleClick\n                }, [\n                    _createCommentVNode(\" / \"),\n                    (__props.entry.type === 'dir')\n                        ? (_openBlock(), _createElementBlock(\"span\", {\n                            key: 0,\n                            class: _normalizeClass([\"expand-icon\", { expanded: expanded.value }])\n                        }, \"  \", 2 /* CLASS */))\n                        : (_openBlock(), _createElementBlock(\"span\", _hoisted_2)),\n                    _createCommentVNode(\"  \"),\n                    _createElementVNode(\"span\", _hoisted_3, [\n                        (__props.entry.type === 'dir')\n                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                                _createTextVNode(\"\")\n                            ], 64 /* STABLE_FRAGMENT */))\n                            : (__props.entry.isModel)\n                                ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                    _createTextVNode(\"\")\n                                ], 64 /* STABLE_FRAGMENT */))\n                                : (_openBlock(), _createElementBlock(_Fragment, { key: 2 }, [\n                                    _createTextVNode(\"\")\n                                ], 64 /* STABLE_FRAGMENT */))\n                    ]),\n                    _createCommentVNode(\"  \"),\n                    _createElementVNode(\"span\", {\n                        class: \"node-name\",\n                        title: __props.entry.path\n                    }, _toDisplayString(__props.entry.name), 9 /* TEXT, PROPS */, _hoisted_4),\n                    _createCommentVNode(\"  \"),\n                    (loading.value)\n                        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5))\n                        : _createCommentVNode(\"v-if\", true)\n                ], 6 /* CLASS, STYLE */),\n                _createCommentVNode(\"  \"),\n                (expanded.value && children.value.length > 0)\n                    ? (_openBlock(true), _createElementBlock(_Fragment, { key: 0 }, _renderList(filteredChildren.value, (child) => {\n                        return (_openBlock(), _createBlock(_component_TreeNode, {\n                            key: child.path,\n                            entry: child,\n                            depth: __props.depth + 1,\n                            \"search-query\": __props.searchQuery,\n                            onSelectModel: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('select-model', $event)))\n                        }, null, 8 /* PROPS */, [\"entry\", \"depth\", \"search-query\"]));\n                    }), 128 /* KEYED_FRAGMENT */))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\"  \"),\n                (expanded.value && !loading.value && children.value.length === 0 && loadedOnce.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 1,\n                        class: \"empty-hint\",\n                        style: _normalizeStyle({ paddingLeft: (__props.depth + 1) * 16 + 8 + 'px' })\n                    }, \"  \", 4 /* STYLE */))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\"  \"),\n                (expanded.value && childError.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 2,\n                        class: \"child-error\",\n                        style: _normalizeStyle({ paddingLeft: (__props.depth + 1) * 16 + 8 + 'px' })\n                    }, [\n                        _createTextVNode(_toDisplayString(childError.value) + \" \", 1 /* TEXT */),\n                        _createElementVNode(\"button\", {\n                            class: \"retry-link\",\n                            onClick: _withModifiers(loadChildren, [\"stop\"])\n                        }, \"\")\n                    ], 4 /* STYLE */))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./TreeNode.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TreeNode.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TreeNode.vue?vue&type=style&index=0&id=3a6a95ba&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3a6a95ba\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"model-browser\" };\nconst _hoisted_2 = { class: \"search-box\" };\nconst _hoisted_3 = {\n    key: 0,\n    class: \"error-bar\"\n};\nconst _hoisted_4 = { class: \"tree-container\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"loading-state\"\n};\nconst _hoisted_6 = {\n    key: 0,\n    class: \"empty-state\"\n};\nconst _hoisted_7 = { class: \"browser-footer\" };\nconst _hoisted_8 = {\n    key: 0,\n    class: \"selected-info\"\n};\nconst _hoisted_9 = { class: \"selected-path\" };\nconst _hoisted_10 = {\n    key: 1,\n    class: \"selected-info\"\n};\nconst _hoisted_11 = { class: \"footer-actions\" };\nconst _hoisted_12 = [\"disabled\"];\nimport { ref, computed } from 'vue';\nimport { fetchDirectory, buildCdnUrl, RateLimitError } from '../live2d/model-browser';\nimport TreeNode from './TreeNode.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ModelBrowser',\n    props: {\n        useCdn: { type: Boolean }\n    },\n    emits: [\"cancel\", \"load-model\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const rootEntries = ref([]);\n        const rootLoading = ref(false);\n        const errorMsg = ref('');\n        const searchQuery = ref('');\n        const selectedPath = ref('');\n        const selectedName = computed(() => {\n            if (!selectedPath.value)\n                return '';\n            const parts = selectedPath.value.split('/');\n            return parts[parts.length - 1];\n        });\n        const filteredRootEntries = computed(() => {\n            if (!searchQuery.value.trim())\n                return rootEntries.value;\n            const q = searchQuery.value.toLowerCase();\n            return rootEntries.value.filter(e => e.name.toLowerCase().includes(q));\n        });\n        function onSelectModel(path) {\n            selectedPath.value = path;\n        }\n        function confirmLoad() {\n            if (!selectedPath.value)\n                return;\n            const cdnUrl = buildCdnUrl(selectedPath.value, props.useCdn);\n            emit('load-model', cdnUrl);\n        }\n        async function loadRoot() {\n            rootLoading.value = true;\n            errorMsg.value = '';\n            try {\n                rootEntries.value = await fetchDirectory('');\n            }\n            catch (e) {\n                if (e instanceof RateLimitError) {\n                    errorMsg.value = e.message;\n                }\n                else {\n                    errorMsg.value = `: ${e.message || ''}`;\n                }\n            }\n            finally {\n                rootLoading.value = false;\n            }\n        }\n        // \n        loadRoot();\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _cache[5] || (_cache[5] = _createElementVNode(\"div\", { class: \"browser-header\" }, [\n                    _createElementVNode(\"span\", { class: \"browser-title\" }, \"\"),\n                    _createElementVNode(\"span\", { class: \"browser-hint\" }, \"Eikanya/Live2d-model\")\n                ], -1 /* CACHED */)),\n                _createCommentVNode(\"  \"),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _withDirectives(_createElementVNode(\"input\", {\n                        type: \"text\",\n                        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((searchQuery).value = $event)),\n                        placeholder: \"...\"\n                    }, null, 512 /* NEED_PATCH */), [\n                        [_vModelText, searchQuery.value]\n                    ])\n                ]),\n                _createCommentVNode(\"  \"),\n                (errorMsg.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                        _createElementVNode(\"span\", null, _toDisplayString(errorMsg.value), 1 /* TEXT */),\n                        _createElementVNode(\"button\", {\n                            class: \"retry-btn\",\n                            onClick: loadRoot\n                        }, \"\")\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\"  \"),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    (rootLoading.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [...(_cache[2] || (_cache[2] = [\n                                _createElementVNode(\"span\", { class: \"spinner\" }, null, -1 /* CACHED */),\n                                _createTextVNode(\" ... \", -1 /* CACHED */)\n                            ]))]))\n                        : (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredRootEntries.value, (entry) => {\n                                return (_openBlock(), _createBlock(TreeNode, {\n                                    key: entry.path,\n                                    entry: entry,\n                                    depth: 0,\n                                    \"search-query\": searchQuery.value,\n                                    onSelectModel: onSelectModel\n                                }, null, 8 /* PROPS */, [\"entry\", \"search-query\"]));\n                            }), 128 /* KEYED_FRAGMENT */)),\n                            (rootEntries.value.length === 0 && !rootLoading.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, \"  \"))\n                                : _createCommentVNode(\"v-if\", true)\n                        ], 64 /* STABLE_FRAGMENT */))\n                ]),\n                _createCommentVNode(\"  &  \"),\n                _createElementVNode(\"div\", _hoisted_7, [\n                    (selectedPath.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n                            _cache[3] || (_cache[3] = _createTextVNode(\" : \", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", _hoisted_9, _toDisplayString(selectedName.value), 1 /* TEXT */)\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [...(_cache[4] || (_cache[4] = [\n                                _createElementVNode(\"span\", { class: \"no-selection\" }, \"\", -1 /* CACHED */)\n                            ]))])),\n                    _createElementVNode(\"div\", _hoisted_11, [\n                        _createElementVNode(\"button\", {\n                            class: \"btn btn-secondary\",\n                            onClick: _cache[1] || (_cache[1] = ($event) => (_ctx.$emit('cancel')))\n                        }, \"\"),\n                        _createElementVNode(\"button\", {\n                            class: \"btn btn-primary\",\n                            disabled: !selectedPath.value,\n                            onClick: confirmLoad\n                        }, \"  \", 8 /* PROPS */, _hoisted_12)\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ModelBrowser.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ModelBrowser.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ModelBrowser.vue?vue&type=style&index=0&id=7ee23a0a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7ee23a0a\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, unref as _unref, vModelSelect as _vModelSelect, withDirectives as _withDirectives, vModelText as _vModelText, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, createTextVNode as _createTextVNode, vShow as _vShow, withKeys as _withKeys, withModifiers as _withModifiers, createVNode as _createVNode, createStaticVNode as _createStaticVNode } from \"vue\";\nconst _hoisted_1 = { class: \"panel-main\" };\nconst _hoisted_2 = { class: \"panel-nav\" };\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"nav-index\" };\nconst _hoisted_5 = { class: \"nav-label\" };\nconst _hoisted_6 = { class: \"nav-sub\" };\nconst _hoisted_7 = { class: \"panel-body\" };\nconst _hoisted_8 = { class: \"setting-section\" };\nconst _hoisted_9 = { class: \"form-group\" };\nconst _hoisted_10 = { class: \"form-group\" };\nconst _hoisted_11 = [\"value\"];\nconst _hoisted_12 = { class: \"form-group\" };\nconst _hoisted_13 = { class: \"form-group\" };\nconst _hoisted_14 = { class: \"form-group\" };\nconst _hoisted_15 = { class: \"input-with-btn\" };\nconst _hoisted_16 = [\"value\"];\nconst _hoisted_17 = [\"disabled\"];\nconst _hoisted_18 = {\n    key: 0,\n    class: \"hint hint-error\"\n};\nconst _hoisted_19 = { class: \"form-group\" };\nconst _hoisted_20 = [\"disabled\"];\nconst _hoisted_21 = {\n    key: 0,\n    class: \"status-badge status-success\"\n};\nconst _hoisted_22 = {\n    key: 1,\n    class: \"status-badge status-fail\"\n};\nconst _hoisted_23 = { class: \"form-group\" };\nconst _hoisted_24 = { class: \"form-group\" };\nconst _hoisted_25 = { class: \"form-row\" };\nconst _hoisted_26 = { class: \"form-group half\" };\nconst _hoisted_27 = { class: \"form-group half\" };\nconst _hoisted_28 = { class: \"toggle-icon\" };\nconst _hoisted_29 = {\n    key: 0,\n    class: \"advanced-params\"\n};\nconst _hoisted_30 = { class: \"form-row\" };\nconst _hoisted_31 = { class: \"form-group half\" };\nconst _hoisted_32 = { class: \"form-group half\" };\nconst _hoisted_33 = { class: \"form-row\" };\nconst _hoisted_34 = { class: \"form-group half\" };\nconst _hoisted_35 = { class: \"form-group half\" };\nconst _hoisted_36 = { class: \"setting-section\" };\nconst _hoisted_37 = { class: \"form-group\" };\nconst _hoisted_38 = { class: \"input-with-btn\" };\nconst _hoisted_39 = [\"disabled\"];\nconst _hoisted_40 = { class: \"form-group\" };\nconst _hoisted_41 = { class: \"model-list\" };\nconst _hoisted_42 = [\"onClick\"];\nconst _hoisted_43 = { class: \"form-group\" };\nconst _hoisted_44 = { class: \"form-group\" };\nconst _hoisted_45 = { class: \"form-group\" };\nconst _hoisted_46 = { class: \"form-group\" };\nconst _hoisted_47 = { class: \"setting-section\" };\nconst _hoisted_48 = { class: \"form-group\" };\nconst _hoisted_49 = [\"value\"];\nconst _hoisted_50 = {\n    key: 0,\n    class: \"form-group\"\n};\nconst _hoisted_51 = { class: \"form-group\" };\nconst _hoisted_52 = { class: \"form-group\" };\nconst _hoisted_53 = [\"disabled\"];\nconst _hoisted_54 = { class: \"form-group\" };\nconst _hoisted_55 = [\"disabled\"];\nconst _hoisted_56 = { class: \"form-group\" };\nconst _hoisted_57 = { class: \"form-group\" };\nconst _hoisted_58 = [\"value\"];\nconst _hoisted_59 = { class: \"form-row\" };\nconst _hoisted_60 = { class: \"form-group half\" };\nconst _hoisted_61 = { class: \"form-group half\" };\nconst _hoisted_62 = { class: \"form-group\" };\nconst _hoisted_63 = { class: \"form-group\" };\nconst _hoisted_64 = { class: \"form-group\" };\nconst _hoisted_65 = { class: \"form-group\" };\nconst _hoisted_66 = { class: \"form-group\" };\nconst _hoisted_67 = { class: \"form-group\" };\nconst _hoisted_68 = {\n    key: 2,\n    class: \"form-group\"\n};\nconst _hoisted_69 = { class: \"form-row\" };\nconst _hoisted_70 = { class: \"form-group half\" };\nconst _hoisted_71 = [\"disabled\"];\nconst _hoisted_72 = { class: \"form-group\" };\nconst _hoisted_73 = { class: \"hint\" };\nconst _hoisted_74 = {\n    key: 0,\n    class: \"dice-sheet-list\"\n};\nconst _hoisted_75 = [\"checked\", \"onChange\"];\nconst _hoisted_76 = {\n    key: 1,\n    class: \"hint\"\n};\nconst _hoisted_77 = { class: \"setting-section\" };\nconst _hoisted_78 = { class: \"emotion-layout\" };\nconst _hoisted_79 = { class: \"emotion-configs\" };\nconst _hoisted_80 = { class: \"form-group\" };\nconst _hoisted_81 = { class: \"hint\" };\nconst _hoisted_82 = {\n    key: 0,\n    class: \"form-group\"\n};\nconst _hoisted_83 = { class: \"form-row\" };\nconst _hoisted_84 = { class: \"form-group half\" };\nconst _hoisted_85 = [\"disabled\"];\nconst _hoisted_86 = { class: \"form-row\" };\nconst _hoisted_87 = { class: \"form-group half\" };\nconst _hoisted_88 = { class: \"form-group half\" };\nconst _hoisted_89 = { class: \"form-group\" };\nconst _hoisted_90 = { class: \"hint\" };\nconst _hoisted_91 = { class: \"form-group\" };\nconst _hoisted_92 = { class: \"toggle-icon\" };\nconst _hoisted_93 = { class: \"emotion-map-table\" };\nconst _hoisted_94 = { class: \"emotion-map-tag\" };\nconst _hoisted_95 = [\"onUpdate:modelValue\"];\nconst _hoisted_96 = [\"value\"];\nconst _hoisted_97 = [\"value\"];\nconst _hoisted_98 = [\"value\", \"disabled\", \"onChange\"];\nconst _hoisted_99 = [\"value\"];\nconst _hoisted_100 = [\"value\"];\nconst _hoisted_101 = [\"onClick\"];\nconst _hoisted_102 = {\n    key: 1,\n    class: \"emotion-advanced-list\"\n};\nconst _hoisted_103 = { class: \"emotion-advanced-title\" };\nconst _hoisted_104 = { class: \"form-row\" };\nconst _hoisted_105 = { class: \"form-group half\" };\nconst _hoisted_106 = [\"value\", \"onBlur\"];\nconst _hoisted_107 = { class: \"form-group half\" };\nconst _hoisted_108 = [\"onUpdate:modelValue\"];\nconst _hoisted_109 = { class: \"form-group\" };\nconst _hoisted_110 = [\"onUpdate:modelValue\"];\nconst _hoisted_111 = { class: \"emotion-preview-panel\" };\nconst _hoisted_112 = { class: \"emotion-preview-header\" };\nconst _hoisted_113 = { class: \"emotion-preview-tag\" };\nconst _hoisted_114 = {\n    key: 0,\n    class: \"emotion-preview-empty\"\n};\nconst _hoisted_115 = { class: \"emotion-preview-controls\" };\nconst _hoisted_116 = { class: \"emotion-zoom-row\" };\nconst _hoisted_117 = { class: \"zoom-value\" };\nconst _hoisted_118 = [\"title\"];\nconst _hoisted_119 = { class: \"setting-section\" };\nconst _hoisted_120 = { class: \"form-group\" };\nconst _hoisted_121 = { class: \"form-group\" };\nconst _hoisted_122 = [\"value\"];\nconst _hoisted_123 = [\"value\"];\nconst _hoisted_124 = [\"value\"];\nconst _hoisted_125 = { class: \"form-group\" };\nconst _hoisted_126 = { class: \"form-group\" };\nconst _hoisted_127 = { class: \"form-group\" };\nconst _hoisted_128 = { class: \"form-group\" };\nconst _hoisted_129 = { class: \"input-with-btn\" };\nconst _hoisted_130 = [\"value\"];\nconst _hoisted_131 = [\"disabled\"];\nconst _hoisted_132 = { class: \"hint\" };\nconst _hoisted_133 = { class: \"toggle-icon\" };\nconst _hoisted_134 = {\n    key: 0,\n    class: \"advanced-params\"\n};\nconst _hoisted_135 = { class: \"form-group\" };\nconst _hoisted_136 = { class: \"form-group\" };\nconst _hoisted_137 = {\n    key: 1,\n    class: \"advanced-params\"\n};\nconst _hoisted_138 = { class: \"form-group\" };\nconst _hoisted_139 = { class: \"form-group\" };\nconst _hoisted_140 = { class: \"form-row\" };\nconst _hoisted_141 = { class: \"form-group half\" };\nconst _hoisted_142 = { class: \"form-group half\" };\nconst _hoisted_143 = { class: \"form-row\" };\nconst _hoisted_144 = { class: \"form-group half\" };\nconst _hoisted_145 = { class: \"form-group half\" };\nconst _hoisted_146 = { class: \"form-group\" };\nconst _hoisted_147 = { class: \"form-group\" };\nconst _hoisted_148 = { class: \"form-row\" };\nconst _hoisted_149 = { class: \"form-group half\" };\nconst _hoisted_150 = [\"disabled\"];\nconst _hoisted_151 = {\n    key: 2,\n    class: \"form-group\"\n};\nconst _hoisted_152 = [\"disabled\"];\nconst _hoisted_153 = { class: \"setting-section\" };\nconst _hoisted_154 = { class: \"browser-dialog-header\" };\nconst _hoisted_155 = { class: \"browser-dialog-body\" };\nimport { storeToRefs } from 'pinia';\nimport { computed, nextTick, onBeforeUnmount, ref, watch } from 'vue';\nimport { TTSManager } from '../audio/tts-manager';\nimport { TTS_PROVIDER, getGptSoVitsVoiceList, getTTSEnabled, getTTSVoiceListAsync, normalizeGptSoVitsVoicesForStore, pickFirstUsableGptSoVitsVoice, setTTSEnabled, } from '../audio/tts-config';\nimport { API_SOURCES, COMMENT_STYLES, COMMENT_TRIGGER_MODE_OPTIONS, DEFAULTS, EMOTION_TAGS, RECOMMENDED_MODELS, SCRIPT_NAME, } from '../core/constants';\nimport { createDefaultEmotionConfigs, parseAliasesText } from '../core/emotion';\nimport { useSettingsStore } from '../core/settings';\nimport { matchLive2DExpression, matchLive2DMotion } from '../live2d/expression-motion';\nimport { Live2DManager } from '../live2d/manager';\nimport { Live2DStage } from '../live2d/stage';\nimport ModelBrowser from './ModelBrowser.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SettingsPanel',\n    props: {\n        visible: { type: Boolean }\n    },\n    emits: [\"close\", \"model-change\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const sectionTabs = [\n            { key: 'api', index: '01', label: 'API ', en: 'API CONTROL' },\n            { key: 'live2d', index: '02', label: 'Live2D', en: 'MODEL CONTROL' },\n            { key: 'comment', index: '03', label: '', en: 'COMMENT SYSTEM' },\n            { key: 'expression', index: '04', label: '', en: 'EMOTION COT' },\n            { key: 'tts', index: '05', label: 'TTS', en: 'VOICE CONTROL' },\n            { key: 'about', index: '06', label: '', en: 'ABOUT & LICENSE' },\n        ];\n        const activeSection = ref('api');\n        const store = useSettingsStore();\n        const { settings } = storeToRefs(store);\n        function toBoundedNumber(value, fallback, min, max) {\n            const parsed = typeof value === 'number' ? value : Number(value);\n            if (!Number.isFinite(parsed))\n                return fallback;\n            return clamp(parsed, min, max);\n        }\n        function ensureNumericSettingsIntegrity() {\n            if (!settings.value.apiConfig || typeof settings.value.apiConfig !== 'object') {\n                settings.value.apiConfig = {\n                    url: '',\n                    apiKey: '',\n                    model: 'gpt-4o-mini',\n                    source: 'openai',\n                    max_tokens: DEFAULTS.MAX_TOKENS,\n                    temperature: DEFAULTS.TEMPERATURE,\n                    frequency_penalty: DEFAULTS.FREQUENCY_PENALTY,\n                    presence_penalty: DEFAULTS.PRESENCE_PENALTY,\n                    top_p: DEFAULTS.TOP_P,\n                    top_k: DEFAULTS.TOP_K,\n                    usePresetSampling: false,\n                    sendWorldInfo: false,\n                };\n            }\n            const api = settings.value.apiConfig;\n            api.max_tokens = Math.round(toBoundedNumber(api.max_tokens, DEFAULTS.MAX_TOKENS, 1, 4096));\n            api.temperature = toBoundedNumber(api.temperature, DEFAULTS.TEMPERATURE, 0, 2);\n            api.frequency_penalty = toBoundedNumber(api.frequency_penalty, DEFAULTS.FREQUENCY_PENALTY, -2, 2);\n            api.presence_penalty = toBoundedNumber(api.presence_penalty, DEFAULTS.PRESENCE_PENALTY, -2, 2);\n            api.top_p = toBoundedNumber(api.top_p, DEFAULTS.TOP_P, 0, 1);\n            api.top_k = Math.round(toBoundedNumber(api.top_k, DEFAULTS.TOP_K, 0, 500));\n            if (typeof api.url !== 'string')\n                api.url = String(api.url ?? '');\n            if (typeof api.apiKey !== 'string')\n                api.apiKey = String(api.apiKey ?? '');\n            if (typeof api.model !== 'string')\n                api.model = String(api.model ?? 'gpt-4o-mini');\n            if (typeof api.source !== 'string')\n                api.source = String(api.source ?? 'openai');\n            api.usePresetSampling = api.usePresetSampling === true;\n            api.sendWorldInfo = api.sendWorldInfo === true;\n            settings.value.petScale = toBoundedNumber(settings.value.petScale, DEFAULTS.PET_SCALE, 0.1, 3);\n            const rawBubbleDuration = typeof settings.value.bubbleDuration === 'number'\n                ? settings.value.bubbleDuration\n                : Number(settings.value.bubbleDuration ?? Number.NaN);\n            const bubbleDurationSeconds = Number.isFinite(rawBubbleDuration) && rawBubbleDuration > 600 ? rawBubbleDuration / 1000 : rawBubbleDuration;\n            settings.value.bubbleDuration = Math.round(toBoundedNumber(bubbleDurationSeconds, DEFAULTS.BUBBLE_DURATION, -1, 600));\n        }\n        const temperatureLabel = computed(() => toBoundedNumber(settings.value.apiConfig?.temperature, DEFAULTS.TEMPERATURE, 0, 2).toFixed(1));\n        const frequencyPenaltyLabel = computed(() => toBoundedNumber(settings.value.apiConfig?.frequency_penalty, DEFAULTS.FREQUENCY_PENALTY, -2, 2).toFixed(1));\n        const presencePenaltyLabel = computed(() => toBoundedNumber(settings.value.apiConfig?.presence_penalty, DEFAULTS.PRESENCE_PENALTY, -2, 2).toFixed(1));\n        const topPLabel = computed(() => toBoundedNumber(settings.value.apiConfig?.top_p, DEFAULTS.TOP_P, 0, 1).toFixed(2));\n        const petScaleLabel = computed(() => toBoundedNumber(settings.value.petScale, DEFAULTS.PET_SCALE, 0.1, 3).toFixed(2));\n        ensureNumericSettingsIntegrity();\n        const recommendedModels = RECOMMENDED_MODELS;\n        const commentStyles = COMMENT_STYLES;\n        const commentTriggerModeOptions = COMMENT_TRIGGER_MODE_OPTIONS;\n        const apiSources = API_SOURCES;\n        const showBrowser = ref(false);\n        const customModelUrl = ref(settings.value.modelPath || '');\n        const diceReferenceSheetOptions = ref([]);\n        const refreshingDiceSheetOptions = ref(false);\n        function normalizeDiceReferenceSheetName(value) {\n            return String(value ?? '')\n                .replace(/\\u00a0/g, ' ')\n                .replace(/\\r\\n/g, '\\n')\n                .replace(/\\n+/g, ' ')\n                .replace(/\\s{2,}/g, ' ')\n                .trim();\n        }\n        function dedupeDiceReferenceSheetNames(values) {\n            const seen = new Set();\n            const list = [];\n            for (const value of values) {\n                const name = normalizeDiceReferenceSheetName(value);\n                if (!name)\n                    continue;\n                if (seen.has(name))\n                    continue;\n                seen.add(name);\n                list.push(name);\n            }\n            return list;\n        }\n        function parseDiceReferenceRecord(value) {\n            if (typeof value === 'string') {\n                const text = value.trim();\n                if (!text)\n                    return null;\n                try {\n                    return parseDiceReferenceRecord(JSON.parse(text));\n                }\n                catch {\n                    return null;\n                }\n            }\n            if (!value || typeof value !== 'object' || Array.isArray(value)) {\n                return null;\n            }\n            return value;\n        }\n        function isDiceReferencePayload(record) {\n            return Object.keys(record).some(key => key.startsWith('sheet_'));\n        }\n        function extractDiceReferenceSheetNamesFromPayload(payload) {\n            const record = parseDiceReferenceRecord(payload);\n            if (!record)\n                return [];\n            let tableRecord = record;\n            if (!isDiceReferencePayload(tableRecord)) {\n                const nested = parseDiceReferenceRecord(tableRecord.independentData);\n                if (!nested || !isDiceReferencePayload(nested)) {\n                    return [];\n                }\n                tableRecord = nested;\n            }\n            return dedupeDiceReferenceSheetNames(Object.keys(tableRecord)\n                .filter(key => key.startsWith('sheet_'))\n                .map(key => {\n                const sheet = parseDiceReferenceRecord(tableRecord?.[key]);\n                return sheet?.name ?? '';\n            }));\n        }\n        function pickDiceReferencePayloadFromIsolatedData(value) {\n            const isolated = parseDiceReferenceRecord(value);\n            if (!isolated)\n                return null;\n            const keys = Object.keys(isolated);\n            for (let i = keys.length - 1; i >= 0; i--) {\n                const slot = parseDiceReferenceRecord(isolated[keys[i]]);\n                if (!slot)\n                    continue;\n                const payload = parseDiceReferenceRecord(slot.independentData);\n                if (payload && isDiceReferencePayload(payload)) {\n                    return payload;\n                }\n            }\n            return null;\n        }\n        function pickDiceReferencePayloadFromMessage(message) {\n            if (!message || typeof message !== 'object')\n                return null;\n            const directCandidates = [\n                message.TavernDB_ACU_IndependentData,\n                message.TavernDB_ACU_Data,\n                message.TavernDB_ACU_SummaryData,\n                message.data?.TavernDB_ACU_IndependentData,\n                message.data?.TavernDB_ACU_Data,\n                message.data?.TavernDB_ACU_SummaryData,\n            ];\n            for (const candidate of directCandidates) {\n                const payload = parseDiceReferenceRecord(candidate);\n                if (!payload)\n                    continue;\n                if (isDiceReferencePayload(payload)) {\n                    return payload;\n                }\n                const nested = parseDiceReferenceRecord(payload.independentData);\n                if (nested && isDiceReferencePayload(nested)) {\n                    return nested;\n                }\n            }\n            const isolatedCandidates = [message.TavernDB_ACU_IsolatedData, message.data?.TavernDB_ACU_IsolatedData];\n            for (const candidate of isolatedCandidates) {\n                const payload = pickDiceReferencePayloadFromIsolatedData(candidate);\n                if (payload)\n                    return payload;\n            }\n            return null;\n        }\n        function readDiceReferenceSheetNamesFromApi() {\n            try {\n                const topWindow = window.parent ?? window;\n                const api = topWindow?.AutoCardUpdaterAPI;\n                if (!api || typeof api.exportTableAsJson !== 'function') {\n                    return [];\n                }\n                return extractDiceReferenceSheetNamesFromPayload(api.exportTableAsJson());\n            }\n            catch {\n                return [];\n            }\n        }\n        function readDiceReferenceSheetNamesFromChat() {\n            try {\n                const messages = getChatMessages(`0-{{lastMessageId}}`, {\n                    role: 'all',\n                    hide_state: 'all',\n                });\n                const list = Array.isArray(messages) ? messages : [];\n                for (let i = list.length - 1; i >= 0; i--) {\n                    const payload = pickDiceReferencePayloadFromMessage(list[i]);\n                    if (!payload)\n                        continue;\n                    const names = extractDiceReferenceSheetNamesFromPayload(payload);\n                    if (names.length > 0)\n                        return names;\n                }\n            }\n            catch {\n                // ignore\n            }\n            return [];\n        }\n        function getDiceReferenceSelectedSheets() {\n            const raw = Array.isArray(settings.value.diceReferenceVisibleSheets)\n                ? settings.value.diceReferenceVisibleSheets\n                : [];\n            return dedupeDiceReferenceSheetNames(raw.map(item => String(item ?? '')));\n        }\n        function setDiceReferenceSelectedSheets(next) {\n            settings.value.diceReferenceVisibleSheets = dedupeDiceReferenceSheetNames(next);\n        }\n        function isDiceSheetVisible(sheetName) {\n            const selected = getDiceReferenceSelectedSheets();\n            if (selected.length === 0)\n                return true;\n            return selected.includes(sheetName);\n        }\n        function onToggleDiceSheetVisibility(sheetName, event) {\n            const target = event?.target;\n            const checked = !!target?.checked;\n            const options = diceReferenceSheetOptions.value;\n            const current = getDiceReferenceSelectedSheets();\n            let next = current.length === 0 ? [...options] : [...current];\n            if (checked) {\n                if (!next.includes(sheetName)) {\n                    next.push(sheetName);\n                }\n            }\n            else {\n                next = next.filter(name => name !== sheetName);\n            }\n            // \n            if (options.length > 0 && next.length === options.length) {\n                next = [];\n            }\n            setDiceReferenceSelectedSheets(next);\n        }\n        const diceReferenceSheetSummary = computed(() => {\n            const optionsCount = diceReferenceSheetOptions.value.length;\n            const selected = getDiceReferenceSelectedSheets();\n            if (optionsCount <= 0) {\n                return '';\n            }\n            if (selected.length === 0) {\n                return `${optionsCount}/${optionsCount}`;\n            }\n            return ` ${selected.length}/${optionsCount}`;\n        });\n        function refreshDiceReferenceSheetOptions() {\n            refreshingDiceSheetOptions.value = true;\n            try {\n                const fromApi = readDiceReferenceSheetNamesFromApi();\n                const fromChat = fromApi.length > 0 ? [] : readDiceReferenceSheetNamesFromChat();\n                const selected = getDiceReferenceSelectedSheets();\n                diceReferenceSheetOptions.value = dedupeDiceReferenceSheetNames([\n                    ...fromApi,\n                    ...fromChat,\n                    ...selected,\n                ]);\n            }\n            finally {\n                refreshingDiceSheetOptions.value = false;\n            }\n        }\n        function selectAllDiceReferenceSheets() {\n            // \n            setDiceReferenceSelectedSheets([]);\n        }\n        function clearDiceReferenceSheets() {\n            // \n            setDiceReferenceSelectedSheets([]);\n        }\n        const ttsEnabled = ref(getTTSEnabled());\n        const ttsVoiceList = ref([]);\n        const refreshingTtsVoices = ref(false);\n        const gptSoVitsVoicesJson = ref('');\n        const ttsTestText = ref(' TTS ');\n        const ttsVoiceHint = computed(() => {\n            const providerHint = settings.value.ttsProvider === TTS_PROVIDER.GPT_SOVITS_V2\n                ? 'GPT-SoVITS name '\n                : settings.value.ttsProvider === TTS_PROVIDER.EDGE_TTS_DIRECT\n                    ? 'EdgeTTS Edge '\n                    : 'LittleWhiteBox/';\n            const emptyHint = ttsVoiceList.value.length === 0 ? '' : '';\n            return `${providerHint}${emptyHint}`;\n        });\n        const emotionTags = EMOTION_TAGS;\n        const live2dExpressions = ref([]);\n        const live2dMotionGroups = ref([]);\n        const live2dMotions = ref([]);\n        const refreshingLive2dLists = ref(false);\n        const live2dExpressionOptions = computed(() => {\n            const dedup = new Set();\n            const list = [];\n            for (const item of live2dExpressions.value) {\n                const value = String(item ?? '').trim();\n                if (!value)\n                    continue;\n                if (dedup.has(value))\n                    continue;\n                dedup.add(value);\n                list.push(value);\n            }\n            return list.sort((a, b) => a.localeCompare(b));\n        });\n        const live2dExpressionOptionSet = computed(() => {\n            return new Set(live2dExpressionOptions.value);\n        });\n        function normalizeMotionIndex(value) {\n            const parsed = Number(value);\n            return Number.isFinite(parsed) ? Math.max(0, Math.floor(parsed)) : 0;\n        }\n        function normalizeMotionOverridePayload(payload) {\n            return {\n                group: String(payload.group ?? '').trim(),\n                index: normalizeMotionIndex(payload.index),\n                name: String(payload.name ?? '').trim(),\n            };\n        }\n        function encodeMotionOption(payload) {\n            const normalized = normalizeMotionOverridePayload(payload);\n            if (!normalized.group)\n                return '';\n            return JSON.stringify(normalized);\n        }\n        function decodeMotionOption(raw) {\n            const text = String(raw || '').trim();\n            if (!text)\n                return null;\n            try {\n                const parsed = JSON.parse(text);\n                if (!parsed || typeof parsed !== 'object')\n                    return null;\n                const group = String(parsed.group ?? '').trim();\n                if (!group)\n                    return null;\n                return {\n                    group,\n                    index: normalizeMotionIndex(parsed.index),\n                    name: String(parsed.name ?? '').trim(),\n                };\n            }\n            catch {\n                return null;\n            }\n        }\n        function resolveMotionOverridePayload(cfg) {\n            const overrideGroup = String(cfg?.live2dMotion?.group || '').trim();\n            if (!overrideGroup)\n                return null;\n            const overrideIndex = normalizeMotionIndex(cfg?.live2dMotion?.index);\n            const exactByGroupIndex = live2dMotions.value.find((motion) => {\n                const group = String(motion?.group ?? '').trim();\n                const index = normalizeMotionIndex(motion?.index);\n                return group === overrideGroup && index === overrideIndex;\n            });\n            if (exactByGroupIndex) {\n                return normalizeMotionOverridePayload({\n                    group: exactByGroupIndex.group,\n                    index: exactByGroupIndex.index,\n                    name: exactByGroupIndex.name,\n                });\n            }\n            // group  motion name\n            const lower = overrideGroup.toLowerCase();\n            const byName = live2dMotions.value.find((motion) => {\n                const name = String(motion?.name ?? '').trim().toLowerCase();\n                const index = normalizeMotionIndex(motion?.index);\n                return name === lower && index === overrideIndex;\n            }) ||\n                live2dMotions.value.find((motion) => String(motion?.name ?? '').trim().toLowerCase() === lower);\n            if (byName) {\n                return normalizeMotionOverridePayload({\n                    group: byName.group,\n                    index: byName.index,\n                    name: byName.name,\n                });\n            }\n            return normalizeMotionOverridePayload({\n                group: overrideGroup,\n                index: overrideIndex,\n            });\n        }\n        function getMotionOverrideValue(cfg) {\n            const payload = resolveMotionOverridePayload(cfg);\n            if (!payload)\n                return '';\n            return encodeMotionOption(payload);\n        }\n        function getMotionOverrideLabel(cfg) {\n            const payload = resolveMotionOverridePayload(cfg);\n            if (!payload)\n                return '';\n            if (payload.name) {\n                const groupLabel = payload.group ? `${payload.group}#${payload.index}` : `#${payload.index}`;\n                return `${payload.name} ${groupLabel}`;\n            }\n            return `${payload.group || '()'}#${payload.index}`;\n        }\n        function setMotionOverrideValue(cfg, rawValue) {\n            const parsed = decodeMotionOption(String(rawValue || '').trim());\n            if (!parsed) {\n                cfg.live2dMotion.group = '';\n                cfg.live2dMotion.index = 0;\n                return;\n            }\n            cfg.live2dMotion.group = parsed.group;\n            cfg.live2dMotion.index = parsed.index;\n        }\n        function onMotionOverrideChange(cfg, event) {\n            const target = event?.target;\n            setMotionOverrideValue(cfg, target?.value || '');\n        }\n        const live2dMotionSelectOptions = computed(() => {\n            const seen = new Set();\n            const options = [];\n            for (const motion of live2dMotions.value) {\n                const group = String(motion?.group ?? '').trim();\n                if (!group)\n                    continue;\n                const index = normalizeMotionIndex(motion?.index);\n                const name = String(motion?.name ?? '').trim();\n                const value = encodeMotionOption({ group, index, name });\n                if (!value || seen.has(value))\n                    continue;\n                seen.add(value);\n                const groupLabel = `${group}#${index}`;\n                const safeName = name || '()';\n                options.push({\n                    key: `motion_${groupLabel}_${safeName}`.replace(/\\s+/g, '_'),\n                    value,\n                    label: `${safeName} ${groupLabel}`,\n                });\n            }\n            for (const group of live2dMotionGroups.value) {\n                const groupName = String(group?.name ?? '').trim();\n                if (!groupName)\n                    continue;\n                const value = encodeMotionOption({ group: groupName, index: 0 });\n                if (!value || seen.has(value))\n                    continue;\n                seen.add(value);\n                options.push({\n                    key: `group_${groupName}_${group.count}`.replace(/\\s+/g, '_'),\n                    value,\n                    label: `${groupName} ${group.count}`,\n                });\n            }\n            return options.sort((a, b) => a.label.localeCompare(b.label, 'zh-CN'));\n        });\n        const live2dMotionOptionSet = computed(() => {\n            return new Set(live2dMotionSelectOptions.value.map(option => option.value));\n        });\n        const live2dListSummary = computed(() => {\n            const exprCount = live2dExpressions.value.length;\n            const motionCount = live2dMotions.value.length;\n            const groupCount = live2dMotionGroups.value.length;\n            if (!Live2DManager.model)\n                return ' Live2D ';\n            const exprHint = exprCount === 0 ? ' Expressions' : '';\n            const motionHint = motionCount === 0 ? ' motions' : '';\n            return ` ${exprCount} ${exprHint} ${motionCount} ${motionHint} ${groupCount} `;\n        });\n        const live2dPreviewMountEl = ref(null);\n        const live2dPreviewInteractEl = ref(null);\n        const previewMounted = ref(false);\n        const previewTag = ref('');\n        const previewStatus = ref('');\n        const previewZoomFactor = ref(1.8);\n        let previewPanOffsetX = 0;\n        let previewPanOffsetY = 0;\n        let previewBasePose = { x: 0, y: 0, scale: 1 };\n        let previewIsDragging = false;\n        let previewDragStart = { x: 0, y: 0 };\n        let previewDragOrigin = { x: 0, y: 0 };\n        let previewMountPromise = null;\n        let previewResizeObserver = null;\n        function clamp(value, min, max) {\n            return Math.max(min, Math.min(max, value));\n        }\n        function getPreviewCanvasSize() {\n            const el = live2dPreviewMountEl.value;\n            const rect = el?.getBoundingClientRect?.();\n            const width = Math.max(1, Math.floor(rect?.width || el?.clientWidth || 320));\n            const height = Math.max(1, Math.floor(rect?.height || el?.clientHeight || 260));\n            return { width, height };\n        }\n        function capturePreviewBasePose() {\n            const model = Live2DManager.model;\n            if (!model)\n                return;\n            const baseScale = Number(model.scale?.x);\n            previewBasePose = {\n                x: Number(model.x) || 0,\n                y: Number(model.y) || 0,\n                scale: Number.isFinite(baseScale) && baseScale > 0 ? baseScale : 1,\n            };\n        }\n        function applyPreviewViewport() {\n            if (!previewMounted.value)\n                return;\n            const model = Live2DManager.model;\n            if (!model)\n                return;\n            const { width, height } = getPreviewCanvasSize();\n            const maxOffsetX = Math.max(60, width * 0.45);\n            const maxOffsetY = Math.max(60, height * 0.45);\n            previewPanOffsetX = clamp(previewPanOffsetX, -maxOffsetX, maxOffsetX);\n            previewPanOffsetY = clamp(previewPanOffsetY, -maxOffsetY, maxOffsetY);\n            previewZoomFactor.value = clamp(previewZoomFactor.value, 0.5, 4);\n            const finalScale = previewBasePose.scale * previewZoomFactor.value;\n            if (model.scale?.set) {\n                model.scale.set(finalScale);\n            }\n            model.x = previewBasePose.x + previewPanOffsetX;\n            model.y = previewBasePose.y + previewPanOffsetY;\n            try {\n                const app = Live2DStage.app;\n                if (app?.renderer && app?.stage) {\n                    app.renderer.render(app.stage);\n                }\n            }\n            catch {\n                // ignore\n            }\n        }\n        function resetPreviewViewport() {\n            previewZoomFactor.value = 1.8;\n            previewPanOffsetX = 0;\n            previewPanOffsetY = 0;\n            applyPreviewViewport();\n        }\n        function getPreviewDragPoint(event) {\n            const ev = event?.originalEvent || event;\n            if (ev?.touches?.length)\n                return { x: ev.touches[0].clientX, y: ev.touches[0].clientY };\n            if (ev?.changedTouches?.length)\n                return { x: ev.changedTouches[0].clientX, y: ev.changedTouches[0].clientY };\n            if (Number.isFinite(ev?.clientX) && Number.isFinite(ev?.clientY))\n                return { x: ev.clientX, y: ev.clientY };\n            return null;\n        }\n        function unbindPreviewViewportEvents() {\n            const interactEl = live2dPreviewInteractEl.value;\n            if (!interactEl)\n                return;\n            const top = window.parent ?? window;\n            const doc = top.document;\n            const handlers = interactEl.__dpPreviewHandlers;\n            if (!handlers)\n                return;\n            try {\n                interactEl.removeEventListener('mousedown', handlers.onDown);\n                interactEl.removeEventListener('touchstart', handlers.onDown);\n                interactEl.removeEventListener('wheel', handlers.onWheel);\n                doc.removeEventListener('mousemove', handlers.onMove);\n                doc.removeEventListener('touchmove', handlers.onMove);\n                doc.removeEventListener('mouseup', handlers.onUp);\n                doc.removeEventListener('touchend', handlers.onUp);\n                doc.removeEventListener('touchcancel', handlers.onUp);\n            }\n            catch {\n                // ignore\n            }\n            interactEl.__dpPreviewHandlers = null;\n        }\n        function bindPreviewViewportEvents() {\n            const interactEl = live2dPreviewInteractEl.value;\n            if (!interactEl)\n                return;\n            if (interactEl.__dpPreviewHandlers)\n                return;\n            const top = window.parent ?? window;\n            const doc = top.document;\n            const onDown = (event) => {\n                if (!previewMounted.value)\n                    return;\n                const point = getPreviewDragPoint(event);\n                if (!point)\n                    return;\n                previewIsDragging = true;\n                previewDragStart = point;\n                previewDragOrigin = { x: previewPanOffsetX, y: previewPanOffsetY };\n                interactEl.style.cursor = 'grabbing';\n                if (typeof event.preventDefault === 'function')\n                    event.preventDefault();\n            };\n            const onMove = (event) => {\n                if (!previewIsDragging)\n                    return;\n                const point = getPreviewDragPoint(event);\n                if (!point)\n                    return;\n                previewPanOffsetX = previewDragOrigin.x + (point.x - previewDragStart.x);\n                previewPanOffsetY = previewDragOrigin.y + (point.y - previewDragStart.y);\n                applyPreviewViewport();\n                if (typeof event.preventDefault === 'function')\n                    event.preventDefault();\n            };\n            const onUp = () => {\n                if (!previewIsDragging)\n                    return;\n                previewIsDragging = false;\n                interactEl.style.cursor = 'grab';\n            };\n            const onWheel = (event) => {\n                if (!previewMounted.value)\n                    return;\n                event.preventDefault();\n                const delta = event.deltaY > 0 ? -0.1 : 0.1;\n                previewZoomFactor.value = clamp(previewZoomFactor.value + delta, 0.5, 4);\n                applyPreviewViewport();\n            };\n            interactEl.style.cursor = 'grab';\n            interactEl.addEventListener('mousedown', onDown);\n            interactEl.addEventListener('touchstart', onDown, { passive: false });\n            interactEl.addEventListener('wheel', onWheel, { passive: false });\n            doc.addEventListener('mousemove', onMove);\n            doc.addEventListener('touchmove', onMove, { passive: false });\n            doc.addEventListener('mouseup', onUp);\n            doc.addEventListener('touchend', onUp);\n            doc.addEventListener('touchcancel', onUp);\n            interactEl.__dpPreviewHandlers = { onDown, onMove, onUp, onWheel };\n        }\n        function disconnectPreviewResizeObserver() {\n            try {\n                previewResizeObserver?.disconnect();\n            }\n            catch {\n                // ignore\n            }\n            finally {\n                previewResizeObserver = null;\n            }\n        }\n        function bindPreviewResizeObserver() {\n            const mountEl = live2dPreviewMountEl.value;\n            if (!mountEl)\n                return;\n            disconnectPreviewResizeObserver();\n            if (typeof ResizeObserver === 'undefined')\n                return;\n            try {\n                previewResizeObserver = new ResizeObserver(() => {\n                    if (!previewMounted.value)\n                        return;\n                    const { width, height } = getPreviewCanvasSize();\n                    Live2DStage.resizePreview(width, height);\n                    applyPreviewViewport();\n                });\n                previewResizeObserver.observe(mountEl);\n            }\n            catch {\n                previewResizeObserver = null;\n            }\n        }\n        async function ensurePreviewMounted() {\n            if (previewMounted.value)\n                return true;\n            if (previewMountPromise)\n                return previewMountPromise;\n            previewMountPromise = (async () => {\n                await nextTick();\n                const mountEl = live2dPreviewMountEl.value;\n                if (!mountEl)\n                    return false;\n                if (!Live2DManager.model) {\n                    previewStatus.value = ' Live2D ';\n                    return false;\n                }\n                if (!Live2DStage.container) {\n                    previewStatus.value = 'Live2D ';\n                    return false;\n                }\n                previewStatus.value = '...';\n                const attached = Live2DStage.pushMount(mountEl);\n                if (!attached) {\n                    previewStatus.value = '';\n                    return false;\n                }\n                previewMounted.value = true;\n                bindPreviewViewportEvents();\n                bindPreviewResizeObserver();\n                const { width, height } = getPreviewCanvasSize();\n                Live2DStage.resizePreview(width, height);\n                Live2DManager.mountToStage(width, height, 1);\n                capturePreviewBasePose();\n                resetPreviewViewport();\n                // \n                refreshLive2DLists();\n                previewStatus.value = '/';\n                return true;\n            })().finally(() => {\n                previewMountPromise = null;\n            });\n            return previewMountPromise;\n        }\n        function cleanupPreviewMount() {\n            disconnectPreviewResizeObserver();\n            unbindPreviewViewportEvents();\n            previewIsDragging = false;\n            if (!previewMounted.value)\n                return;\n            previewMounted.value = false;\n            const restored = Live2DStage.popMount();\n            if (restored && Live2DManager.model) {\n                Live2DManager.mountToStage(restored.width, restored.height, 1);\n            }\n            previewStatus.value = '';\n        }\n        function replayPreview() {\n            void previewEmotion(previewTag.value);\n        }\n        watch(() => ({ visible: props.visible, section: activeSection.value }), ({ visible, section }) => {\n            if (visible && section === 'expression') {\n                void (async () => {\n                    const mounted = await ensurePreviewMounted();\n                    if (mounted) {\n                        void previewEmotion(previewTag.value);\n                    }\n                })();\n                return;\n            }\n            cleanupPreviewMount();\n        }, { immediate: true });\n        onBeforeUnmount(() => {\n            cleanupPreviewMount();\n        });\n        const modelList = ref([]);\n        const fetchingModels = ref(false);\n        const modelFetchError = ref('');\n        const testingConnection = ref(false);\n        const connectionStatus = ref('idle');\n        const connectionError = ref('');\n        const showAdvanced = ref(false);\n        const showEmotionAdvanced = ref(false);\n        const showLipSyncAdvanced = ref(false);\n        const lipSyncManualParamsText = ref('');\n        const overlayFallbackStyle = {\n            position: 'fixed',\n            inset: '0',\n            width: '100vw',\n            height: '100vh',\n            minHeight: '100vh',\n            zIndex: '10001',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n        };\n        const panelFallbackStyle = {\n            position: 'relative',\n            display: 'flex',\n            flexDirection: 'column',\n            width: 'min(1080px, calc(100vw - 24px))',\n            maxHeight: 'calc(100vh - 24px)',\n            minHeight: '280px',\n        };\n        function normalizeModelList(list) {\n            if (!Array.isArray(list))\n                return [];\n            const out = [];\n            for (const item of list) {\n                if (typeof item === 'string') {\n                    const trimmed = item.trim();\n                    if (trimmed)\n                        out.push(trimmed);\n                    continue;\n                }\n                if (item && typeof item === 'object') {\n                    const maybeId = item.id;\n                    const maybeModel = item.model;\n                    const maybeName = item.name;\n                    const picked = typeof maybeId === 'string'\n                        ? maybeId\n                        : typeof maybeModel === 'string'\n                            ? maybeModel\n                            : typeof maybeName === 'string'\n                                ? maybeName\n                                : '';\n                    const trimmed = picked.trim();\n                    if (trimmed)\n                        out.push(trimmed);\n                }\n            }\n            return [...new Set(out)];\n        }\n        async function getModelListByHttp(customApi) {\n            const base = String(customApi.apiurl || '')\n                .trim()\n                .replace(/\\/+$/, '');\n            if (!base)\n                throw new Error('API URL ');\n            const headers = { Accept: 'application/json' };\n            if (customApi.key)\n                headers.Authorization = `Bearer ${customApi.key}`;\n            const request = async (path) => fetch(`${base}${path}`, {\n                method: 'GET',\n                headers,\n                cache: 'no-cache',\n            });\n            let response = await request('/v1/models');\n            if (!response.ok && (response.status === 404 || response.status === 405)) {\n                response = await request('/models');\n            }\n            if (!response.ok) {\n                throw new Error(` (HTTP ${response.status})`);\n            }\n            const payload = (await response.json());\n            return normalizeModelList(payload.data ?? payload.models ?? payload);\n        }\n        async function getModelListSafe(customApi) {\n            const helperGetModelList = window?.TavernHelper?.getModelList;\n            if (typeof helperGetModelList === 'function') {\n                try {\n                    const models = await helperGetModelList(customApi);\n                    const normalized = normalizeModelList(models);\n                    if (normalized.length > 0)\n                        return normalized;\n                }\n                catch (e) {\n                    console.warn(`[${SCRIPT_NAME}] TavernHelper.getModelList  HTTP `, e);\n                }\n            }\n            if (typeof getModelList === 'function') {\n                try {\n                    const models = await getModelList(customApi);\n                    const normalized = normalizeModelList(models);\n                    if (normalized.length > 0)\n                        return normalized;\n                }\n                catch (e) {\n                    console.warn(`[${SCRIPT_NAME}] getModelList  HTTP `, e);\n                }\n            }\n            return getModelListByHttp(customApi);\n        }\n        async function fetchModels() {\n            const url = settings.value.apiConfig.url;\n            if (!url)\n                return;\n            fetchingModels.value = true;\n            modelFetchError.value = '';\n            modelList.value = [];\n            try {\n                const models = await getModelListSafe({\n                    apiurl: url,\n                    key: settings.value.apiConfig.apiKey || undefined,\n                });\n                modelList.value = models;\n                if (models.length > 0 && !models.includes(settings.value.apiConfig.model)) {\n                    settings.value.apiConfig.model = models[0];\n                }\n            }\n            catch (e) {\n                modelFetchError.value = `: ${e instanceof Error ? e.message : String(e)}`;\n            }\n            finally {\n                fetchingModels.value = false;\n            }\n        }\n        async function testConnection() {\n            const url = settings.value.apiConfig.url;\n            if (!url)\n                return;\n            testingConnection.value = true;\n            connectionStatus.value = 'idle';\n            connectionError.value = '';\n            try {\n                const models = await getModelListSafe({\n                    apiurl: url,\n                    key: settings.value.apiConfig.apiKey || undefined,\n                });\n                if (models && models.length >= 0) {\n                    connectionStatus.value = 'success';\n                }\n                else {\n                    connectionStatus.value = 'fail';\n                    connectionError.value = '';\n                }\n            }\n            catch (e) {\n                connectionStatus.value = 'fail';\n                connectionError.value = e instanceof Error ? e.message : String(e);\n            }\n            finally {\n                testingConnection.value = false;\n            }\n        }\n        function selectModel(path) {\n            settings.value.modelPath = path;\n            customModelUrl.value = path;\n            emit('model-change', path);\n        }\n        function onBrowserLoad(url) {\n            settings.value.modelPath = url;\n            customModelUrl.value = url;\n            showBrowser.value = false;\n            emit('model-change', url);\n        }\n        function loadCustomUrl() {\n            let url = customModelUrl.value.trim();\n            if (!url)\n                return;\n            const blobMatch = url.match(/^https?:\\/\\/github\\.com\\/([^/]+\\/[^/]+)\\/blob\\/(.+)$/);\n            if (blobMatch) {\n                url = `https://raw.githubusercontent.com/${blobMatch[1]}/${blobMatch[2]}`;\n                customModelUrl.value = url;\n            }\n            settings.value.modelPath = url;\n            emit('model-change', url);\n        }\n        function resetSettings() {\n            store.resetSettings();\n        }\n        function resetEmotionConfigs() {\n            settings.value.emotionConfigs = createDefaultEmotionConfigs();\n            try {\n                toastr.success('');\n            }\n            catch {\n                // ignore\n            }\n        }\n        function onAliasesBlur(cfg, ev) {\n            const input = ev.target;\n            if (!input)\n                return;\n            cfg.aliases = parseAliasesText(input.value);\n        }\n        function refreshLive2DLists() {\n            refreshingLive2dLists.value = true;\n            try {\n                live2dExpressions.value = Live2DManager.getExpressions();\n                live2dMotions.value = Live2DManager.getMotions()\n                    .map(m => ({ name: m.name, group: m.group, index: m.index }))\n                    .sort((a, b) => a.name.localeCompare(b.name));\n                const groups = Live2DManager.getMotionGroups();\n                live2dMotionGroups.value = Object.entries(groups)\n                    .map(([name, count]) => ({ name, count }))\n                    .sort((a, b) => a.name.localeCompare(b.name));\n                try {\n                    toastr.info('/');\n                }\n                catch {\n                    // ignore\n                }\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] /:`, e);\n                live2dExpressions.value = [];\n                live2dMotions.value = [];\n                live2dMotionGroups.value = [];\n                try {\n                    toastr.error('');\n                }\n                catch {\n                    // ignore\n                }\n            }\n            finally {\n                refreshingLive2dLists.value = false;\n            }\n        }\n        function autoMatchLive2DOverrides(overwrite = false) {\n            const model = Live2DManager.model;\n            if (!model) {\n                try {\n                    toastr.warning('');\n                }\n                catch {\n                    // ignore\n                }\n                return;\n            }\n            let filled = 0;\n            for (const cfg of settings.value.emotionConfigs) {\n                const exprOverride = String(cfg.live2dExpression || '').trim();\n                if (overwrite || !exprOverride) {\n                    const matched = matchLive2DExpression(model, cfg.tag);\n                    if (matched) {\n                        cfg.live2dExpression = matched;\n                        filled += 1;\n                    }\n                }\n                const motionEnabled = cfg.live2dMotion?.enabled !== false;\n                const motionGroupOverride = String(cfg.live2dMotion?.group || '').trim();\n                if (motionEnabled && (overwrite || !motionGroupOverride)) {\n                    const matchedMotion = matchLive2DMotion(model, cfg.tag);\n                    if (matchedMotion) {\n                        cfg.live2dMotion.group = matchedMotion.group;\n                        cfg.live2dMotion.index = matchedMotion.index;\n                        filled += 1;\n                    }\n                }\n            }\n            try {\n                if (overwrite) {\n                    toastr.success(filled > 0 ? ` ${filled} ` : '');\n                }\n                else {\n                    toastr.success(filled > 0 ? ` ${filled} ` : '');\n                }\n            }\n            catch {\n                // ignore\n            }\n        }\n        function clearLive2DOverrides() {\n            let cleared = 0;\n            for (const cfg of settings.value.emotionConfigs) {\n                const hadExpr = !!String(cfg.live2dExpression || '').trim();\n                const hadGroup = !!String(cfg.live2dMotion?.group || '').trim();\n                if (hadExpr) {\n                    cfg.live2dExpression = '';\n                    cleared += 1;\n                }\n                if (hadGroup) {\n                    cfg.live2dMotion.group = '';\n                    cfg.live2dMotion.index = 0;\n                    cleared += 1;\n                }\n            }\n            try {\n                toastr.info(cleared > 0 ? ` ${cleared}  Live2D ` : ' Live2D ');\n            }\n            catch {\n                // ignore\n            }\n        }\n        async function previewEmotion(tag) {\n            previewTag.value = tag;\n            const mounted = await ensurePreviewMounted();\n            if (!mounted)\n                return;\n            const model = Live2DManager.model;\n            if (!model) {\n                previewStatus.value = '';\n                return;\n            }\n            applyPreviewViewport();\n            const cfg = settings.value.emotionConfigs.find(c => c.tag === tag);\n            const expr = matchLive2DExpression(model, tag, cfg?.live2dExpression);\n            if (expr) {\n                Live2DManager.playExpression(expr);\n            }\n            const motion = matchLive2DMotion(model, tag, cfg?.live2dMotion);\n            if (motion) {\n                Live2DManager.playMotion(motion.group, motion.index);\n            }\n            const exprText = expr ? `: ${expr}` : ': ()';\n            const motionText = motion\n                ? motion.name\n                    ? `: ${motion.name} (${motion.group || '()'}#${motion.index})`\n                    : `: ${motion.group || '()'}`\n                : ': ()';\n            previewStatus.value = `${tag} | ${exprText} | ${motionText}`;\n            if (!expr && !motion) {\n                try {\n                    toastr.info('/');\n                }\n                catch {\n                    // ignore\n                }\n            }\n        }\n        function onToggleTtsEnabled() {\n            setTTSEnabled(ttsEnabled.value);\n            if (!ttsEnabled.value) {\n                try {\n                    TTSManager.stop();\n                }\n                catch {\n                    // ignore\n                }\n            }\n        }\n        async function refreshTtsVoices() {\n            refreshingTtsVoices.value = true;\n            try {\n                ttsVoiceList.value = await getTTSVoiceListAsync();\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}]  TTS :`, e);\n                ttsVoiceList.value = [];\n            }\n            finally {\n                refreshingTtsVoices.value = false;\n            }\n        }\n        function saveGptSoVitsVoices() {\n            let parsed = null;\n            try {\n                parsed = JSON.parse(gptSoVitsVoicesJson.value || '[]');\n            }\n            catch {\n                toastr.error(' JSON ');\n                return;\n            }\n            if (!Array.isArray(parsed)) {\n                toastr.error('');\n                return;\n            }\n            const normalized = normalizeGptSoVitsVoicesForStore(parsed);\n            settings.value.gptSoVits.voices = normalized.voices;\n            const firstUsable = pickFirstUsableGptSoVitsVoice(getGptSoVitsVoiceList());\n            if (!settings.value.ttsDefaultSpeaker && firstUsable?.name) {\n                settings.value.ttsDefaultSpeaker = firstUsable.name;\n            }\n            void refreshTtsVoices();\n            let msg = `GPT-SoVITS ${normalized.voices.length} `;\n            if (normalized.ignoredCount > 0)\n                msg += ` ${normalized.ignoredCount} `;\n            if (normalized.missingRefCount > 0)\n                msg += `${normalized.missingRefCount}  refAudioPath`;\n            toastr.success(msg);\n        }\n        function getCurrentCharacterId() {\n            try {\n                const ctx = SillyTavern?.getContext?.();\n                if (ctx?.characterId !== undefined && ctx?.characterId !== null) {\n                    return String(ctx.characterId);\n                }\n            }\n            catch {\n                // ignore\n            }\n            return 'default';\n        }\n        async function testTts() {\n            if (!ttsEnabled.value)\n                return;\n            const text = String(ttsTestText.value || '').trim() || ' TTS ';\n            const speaker = getCurrentCharacterId();\n            let voiceName = String(settings.value.ttsDefaultSpeaker || '').trim();\n            if (settings.value.ttsProvider === TTS_PROVIDER.GPT_SOVITS_V2) {\n                const voices = getGptSoVitsVoiceList();\n                const selected = voices.find(v => v.name === voiceName) || null;\n                const selectedUsable = !!String(selected?.gptSoVits?.refAudioPath || '').trim();\n                const fallback = pickFirstUsableGptSoVitsVoice(voices);\n                const target = selectedUsable ? selected : fallback;\n                const targetName = String(target?.name || '').trim();\n                if (!targetName) {\n                    toastr.error('refAudioPath ');\n                    return;\n                }\n                if (voiceName !== targetName) {\n                    settings.value.ttsDefaultSpeaker = targetName;\n                    voiceName = targetName;\n                    toastr.info(`${targetName}`);\n                }\n            }\n            else if (settings.value.ttsProvider === TTS_PROVIDER.EDGE_TTS_DIRECT && !voiceName) {\n                const voices = ttsVoiceList.value.length > 0 ? ttsVoiceList.value : await getTTSVoiceListAsync();\n                const fallbackName = String(voices[0]?.name || voices[0]?.value || '').trim();\n                if (!fallbackName) {\n                    toastr.error(' EdgeTTS ');\n                    return;\n                }\n                settings.value.ttsDefaultSpeaker = fallbackName;\n                voiceName = fallbackName;\n            }\n            try {\n                TTSManager.stop();\n                await TTSManager.speak({ type: 'dialogue', speaker, text, tts: voiceName ? { speaker: voiceName } : undefined }, `desktop_pet_tts_test_${Date.now()}`);\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] TTS :`, e);\n            }\n        }\n        function stopTts() {\n            try {\n                TTSManager.stop();\n            }\n            catch {\n                // ignore\n            }\n        }\n        function applyLipSyncManualParams() {\n            const raw = String(lipSyncManualParamsText.value || '');\n            const parts = raw\n                .split(/[\\n,]/)\n                .map(item => String(item || '').trim())\n                .filter(Boolean);\n            const dedup = Array.from(new Set(parts));\n            settings.value.lipSyncManualParamIds = dedup;\n            lipSyncManualParamsText.value = dedup.join('\\n');\n        }\n        function close() {\n            applyLipSyncManualParams();\n            emit('close');\n        }\n        watch(() => props.visible, visible => {\n            if (!visible)\n                return;\n            ensureNumericSettingsIntegrity();\n            activeSection.value = 'api';\n            showEmotionAdvanced.value = false;\n            ttsEnabled.value = getTTSEnabled();\n            lipSyncManualParamsText.value = Array.isArray(settings.value.lipSyncManualParamIds)\n                ? settings.value.lipSyncManualParamIds.join('\\n')\n                : '';\n            try {\n                gptSoVitsVoicesJson.value = JSON.stringify(settings.value.gptSoVits?.voices || [], null, 2);\n            }\n            catch {\n                gptSoVitsVoicesJson.value = '[]';\n            }\n            void refreshTtsVoices();\n            refreshDiceReferenceSheetOptions();\n        }, { immediate: true });\n        watch(() => settings.value.ttsProvider, () => {\n            try {\n                TTSManager._refreshProviderState();\n            }\n            catch {\n                // ignore\n            }\n            void refreshTtsVoices();\n        });\n        watch(() => settings.value.useDiceDatabaseReference, enabled => {\n            if (!enabled)\n                return;\n            refreshDiceReferenceSheetOptions();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", null, [\n                (__props.visible)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"settings-overlay dp-settings-overlay\",\n                        style: overlayFallbackStyle,\n                        onClick: _withModifiers(close, [\"self\"])\n                    }, [\n                        _createElementVNode(\"div\", {\n                            class: \"settings-panel dp-settings-panel\",\n                            style: panelFallbackStyle\n                        }, [\n                            _createElementVNode(\"div\", { class: \"panel-header\" }, [\n                                _cache[64] || (_cache[64] = _createElementVNode(\"div\", { class: \"header-title\" }, [\n                                    _createElementVNode(\"h3\", null, \"\"),\n                                    _createElementVNode(\"p\", null, \"SYSTEM // SETTINGS\")\n                                ], -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-btn\",\n                                    type: \"button\",\n                                    onClick: close\n                                }, \"CLOSE\")\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_1, [\n                                _createElementVNode(\"aside\", _hoisted_2, [\n                                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(sectionTabs, (item) => {\n                                        return _createElementVNode(\"button\", {\n                                            key: item.key,\n                                            class: _normalizeClass([\"nav-btn\", { active: activeSection.value === item.key }]),\n                                            type: \"button\",\n                                            onClick: ($event) => (activeSection.value = item.key)\n                                        }, [\n                                            _createElementVNode(\"span\", _hoisted_4, _toDisplayString(item.index), 1 /* TEXT */),\n                                            _createElementVNode(\"span\", _hoisted_5, _toDisplayString(item.label), 1 /* TEXT */),\n                                            _createElementVNode(\"span\", _hoisted_6, _toDisplayString(item.en), 1 /* TEXT */)\n                                        ], 10 /* CLASS, PROPS */, _hoisted_3);\n                                    }), 64 /* STABLE_FRAGMENT */))\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_7, [\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_8, [\n                                        _cache[78] || (_cache[78] = _createElementVNode(\"h4\", null, [\n                                            _createElementVNode(\"span\", { class: \"section-index\" }, \"01\"),\n                                            _createElementVNode(\"span\", { class: \"section-label\" }, \"API \"),\n                                            _createElementVNode(\"span\", { class: \"section-sub\" }, \"API CONTROL\")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_9, [\n                                            _cache[66] || (_cache[66] = _createElementVNode(\"label\", null, \"API \", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"select\", {\n                                                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((_unref(settings).apiMode) = $event))\n                                            }, [...(_cache[65] || (_cache[65] = [\n                                                    _createElementVNode(\"option\", { value: \"tavern\" }, \" API\", -1 /* CACHED */),\n                                                    _createElementVNode(\"option\", { value: \"custom\" }, \" API\", -1 /* CACHED */)\n                                                ]))], 512 /* NEED_PATCH */), [\n                                                [_vModelSelect, _unref(settings).apiMode]\n                                            ])\n                                        ]),\n                                        (_unref(settings).apiMode === 'custom')\n                                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                                                _createElementVNode(\"div\", _hoisted_10, [\n                                                    _cache[67] || (_cache[67] = _createElementVNode(\"label\", null, \"API Source\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"select\", {\n                                                        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((_unref(settings).apiConfig.source) = $event))\n                                                    }, [\n                                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(apiSources), (src) => {\n                                                            return (_openBlock(), _createElementBlock(\"option\", {\n                                                                key: src.value,\n                                                                value: src.value\n                                                            }, _toDisplayString(src.label), 9 /* TEXT, PROPS */, _hoisted_11));\n                                                        }), 128 /* KEYED_FRAGMENT */))\n                                                    ], 512 /* NEED_PATCH */), [\n                                                        [_vModelSelect, _unref(settings).apiConfig.source]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_12, [\n                                                    _cache[68] || (_cache[68] = _createElementVNode(\"label\", null, \"API URL\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"input\", {\n                                                        type: \"text\",\n                                                        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event) => ((_unref(settings).apiConfig.url) = $event)),\n                                                        placeholder: \"https://api.openai.com/v1\"\n                                                    }, null, 512 /* NEED_PATCH */), [\n                                                        [_vModelText, _unref(settings).apiConfig.url]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_13, [\n                                                    _cache[69] || (_cache[69] = _createElementVNode(\"label\", null, \"API Key\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"input\", {\n                                                        type: \"password\",\n                                                        \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event) => ((_unref(settings).apiConfig.apiKey) = $event)),\n                                                        placeholder: \"sk-...\"\n                                                    }, null, 512 /* NEED_PATCH */), [\n                                                        [_vModelText, _unref(settings).apiConfig.apiKey]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_14, [\n                                                    _cache[70] || (_cache[70] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"div\", _hoisted_15, [\n                                                        (modelList.value.length === 0)\n                                                            ? _withDirectives((_openBlock(), _createElementBlock(\"input\", {\n                                                                key: 0,\n                                                                type: \"text\",\n                                                                \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event) => ((_unref(settings).apiConfig.model) = $event)),\n                                                                placeholder: \"gpt-4o-mini\"\n                                                            }, null, 512 /* NEED_PATCH */)), [\n                                                                [_vModelText, _unref(settings).apiConfig.model]\n                                                            ])\n                                                            : _withDirectives((_openBlock(), _createElementBlock(\"select\", {\n                                                                key: 1,\n                                                                \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event) => ((_unref(settings).apiConfig.model) = $event))\n                                                            }, [\n                                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(modelList.value, (m) => {\n                                                                    return (_openBlock(), _createElementBlock(\"option\", {\n                                                                        key: m,\n                                                                        value: m\n                                                                    }, _toDisplayString(m), 9 /* TEXT, PROPS */, _hoisted_16));\n                                                                }), 128 /* KEYED_FRAGMENT */))\n                                                            ], 512 /* NEED_PATCH */)), [\n                                                                [_vModelSelect, _unref(settings).apiConfig.model]\n                                                            ]),\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"input-btn\",\n                                                            type: \"button\",\n                                                            onClick: fetchModels,\n                                                            disabled: !_unref(settings).apiConfig.url || fetchingModels.value\n                                                        }, _toDisplayString(fetchingModels.value ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_17)\n                                                    ]),\n                                                    (modelFetchError.value)\n                                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18, _toDisplayString(modelFetchError.value), 1 /* TEXT */))\n                                                        : _createCommentVNode(\"v-if\", true)\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_19, [\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-test\",\n                                                        type: \"button\",\n                                                        disabled: !_unref(settings).apiConfig.url || testingConnection.value,\n                                                        onClick: testConnection\n                                                    }, _toDisplayString(testingConnection.value ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_20),\n                                                    (connectionStatus.value === 'success')\n                                                        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_21, \"\"))\n                                                        : _createCommentVNode(\"v-if\", true),\n                                                    (connectionStatus.value === 'fail')\n                                                        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_22, _toDisplayString(connectionError.value), 1 /* TEXT */))\n                                                        : _createCommentVNode(\"v-if\", true)\n                                                ])\n                                            ], 64 /* STABLE_FRAGMENT */))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        _createElementVNode(\"div\", _hoisted_23, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[6] || (_cache[6] = ($event) => ((_unref(settings).apiConfig.usePresetSampling) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).apiConfig.usePresetSampling]\n                                                ]),\n                                                _cache[71] || (_cache[71] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[72] || (_cache[72] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_24, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event) => ((_unref(settings).apiConfig.sendWorldInfo) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).apiConfig.sendWorldInfo]\n                                                ]),\n                                                _cache[73] || (_cache[73] = _createTextVNode(\" World Info \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[74] || (_cache[74] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        (!_unref(settings).apiConfig.usePresetSampling)\n                                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                                _createElementVNode(\"div\", _hoisted_25, [\n                                                    _createElementVNode(\"div\", _hoisted_26, [\n                                                        _cache[75] || (_cache[75] = _createElementVNode(\"label\", null, \"Max Tokens\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"number\",\n                                                            \"onUpdate:modelValue\": _cache[8] || (_cache[8] = ($event) => ((_unref(settings).apiConfig.max_tokens) = $event)),\n                                                            min: \"1\",\n                                                            max: \"4096\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).apiConfig.max_tokens,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_27, [\n                                                        _createElementVNode(\"label\", null, \"Temperature (\" + _toDisplayString(temperatureLabel.value) + \")\", 1 /* TEXT */),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"range\",\n                                                            \"onUpdate:modelValue\": _cache[9] || (_cache[9] = ($event) => ((_unref(settings).apiConfig.temperature) = $event)),\n                                                            min: \"0\",\n                                                            max: \"2\",\n                                                            step: \"0.1\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).apiConfig.temperature,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", {\n                                                    class: \"advanced-toggle\",\n                                                    onClick: _cache[10] || (_cache[10] = ($event) => (showAdvanced.value = !showAdvanced.value))\n                                                }, [\n                                                    _createElementVNode(\"span\", _hoisted_28, _toDisplayString(showAdvanced.value ? '' : ''), 1 /* TEXT */),\n                                                    _cache[76] || (_cache[76] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                                ]),\n                                                (showAdvanced.value)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_29, [\n                                                        _createElementVNode(\"div\", _hoisted_30, [\n                                                            _createElementVNode(\"div\", _hoisted_31, [\n                                                                _createElementVNode(\"label\", null, \"Frequency Penalty (\" + _toDisplayString(frequencyPenaltyLabel.value) + \")\", 1 /* TEXT */),\n                                                                _withDirectives(_createElementVNode(\"input\", {\n                                                                    type: \"range\",\n                                                                    \"onUpdate:modelValue\": _cache[11] || (_cache[11] = ($event) => ((_unref(settings).apiConfig.frequency_penalty) = $event)),\n                                                                    min: \"-2\",\n                                                                    max: \"2\",\n                                                                    step: \"0.1\"\n                                                                }, null, 512 /* NEED_PATCH */), [\n                                                                    [\n                                                                        _vModelText,\n                                                                        _unref(settings).apiConfig.frequency_penalty,\n                                                                        void 0,\n                                                                        { number: true }\n                                                                    ]\n                                                                ])\n                                                            ]),\n                                                            _createElementVNode(\"div\", _hoisted_32, [\n                                                                _createElementVNode(\"label\", null, \"Presence Penalty (\" + _toDisplayString(presencePenaltyLabel.value) + \")\", 1 /* TEXT */),\n                                                                _withDirectives(_createElementVNode(\"input\", {\n                                                                    type: \"range\",\n                                                                    \"onUpdate:modelValue\": _cache[12] || (_cache[12] = ($event) => ((_unref(settings).apiConfig.presence_penalty) = $event)),\n                                                                    min: \"-2\",\n                                                                    max: \"2\",\n                                                                    step: \"0.1\"\n                                                                }, null, 512 /* NEED_PATCH */), [\n                                                                    [\n                                                                        _vModelText,\n                                                                        _unref(settings).apiConfig.presence_penalty,\n                                                                        void 0,\n                                                                        { number: true }\n                                                                    ]\n                                                                ])\n                                                            ])\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_33, [\n                                                            _createElementVNode(\"div\", _hoisted_34, [\n                                                                _createElementVNode(\"label\", null, \"Top P (\" + _toDisplayString(topPLabel.value) + \")\", 1 /* TEXT */),\n                                                                _withDirectives(_createElementVNode(\"input\", {\n                                                                    type: \"range\",\n                                                                    \"onUpdate:modelValue\": _cache[13] || (_cache[13] = ($event) => ((_unref(settings).apiConfig.top_p) = $event)),\n                                                                    min: \"0\",\n                                                                    max: \"1\",\n                                                                    step: \"0.01\"\n                                                                }, null, 512 /* NEED_PATCH */), [\n                                                                    [\n                                                                        _vModelText,\n                                                                        _unref(settings).apiConfig.top_p,\n                                                                        void 0,\n                                                                        { number: true }\n                                                                    ]\n                                                                ])\n                                                            ]),\n                                                            _createElementVNode(\"div\", _hoisted_35, [\n                                                                _cache[77] || (_cache[77] = _createElementVNode(\"label\", null, \"Top K\", -1 /* CACHED */)),\n                                                                _withDirectives(_createElementVNode(\"input\", {\n                                                                    type: \"number\",\n                                                                    \"onUpdate:modelValue\": _cache[14] || (_cache[14] = ($event) => ((_unref(settings).apiConfig.top_k) = $event)),\n                                                                    min: \"0\",\n                                                                    max: \"500\"\n                                                                }, null, 512 /* NEED_PATCH */), [\n                                                                    [\n                                                                        _vModelText,\n                                                                        _unref(settings).apiConfig.top_k,\n                                                                        void 0,\n                                                                        { number: true }\n                                                                    ]\n                                                                ])\n                                                            ])\n                                                        ])\n                                                    ]))\n                                                    : _createCommentVNode(\"v-if\", true)\n                                            ], 64 /* STABLE_FRAGMENT */))\n                                            : _createCommentVNode(\"v-if\", true)\n                                    ], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'api']\n                                    ]),\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_36, [\n                                        _cache[87] || (_cache[87] = _createElementVNode(\"h4\", null, [\n                                            _createElementVNode(\"span\", { class: \"section-index\" }, \"02\"),\n                                            _createElementVNode(\"span\", { class: \"section-label\" }, \"Live2D \"),\n                                            _createElementVNode(\"span\", { class: \"section-sub\" }, \"MODEL CONTROL\")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_37, [\n                                            _cache[79] || (_cache[79] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_38, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"text\",\n                                                    \"onUpdate:modelValue\": _cache[15] || (_cache[15] = ($event) => ((customModelUrl).value = $event)),\n                                                    placeholder: \" .model.json  .model3.json  URL\",\n                                                    onKeydown: _withKeys(loadCustomUrl, [\"enter\"])\n                                                }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                                    [_vModelText, customModelUrl.value]\n                                                ]),\n                                                _createElementVNode(\"button\", {\n                                                    class: \"input-btn\",\n                                                    type: \"button\",\n                                                    onClick: loadCustomUrl,\n                                                    disabled: !customModelUrl.value.trim()\n                                                }, \"  \", 8 /* PROPS */, _hoisted_39)\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_40, [\n                                            _cache[80] || (_cache[80] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_41, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(recommendedModels), (m) => {\n                                                    return (_openBlock(), _createElementBlock(\"button\", {\n                                                        key: m.path,\n                                                        class: _normalizeClass([\"model-btn\", { active: _unref(settings).modelPath === m.path }]),\n                                                        type: \"button\",\n                                                        onClick: ($event) => (selectModel(m.path))\n                                                    }, _toDisplayString(m.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_42));\n                                                }), 128 /* KEYED_FRAGMENT */)),\n                                                _createElementVNode(\"button\", {\n                                                    class: \"model-btn browse-btn\",\n                                                    type: \"button\",\n                                                    onClick: _cache[16] || (_cache[16] = ($event) => (showBrowser.value = true))\n                                                }, \"\")\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_43, [\n                                            _createElementVNode(\"label\", null, \" (\" + _toDisplayString(petScaleLabel.value) + \")\", 1 /* TEXT */),\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"range\",\n                                                \"onUpdate:modelValue\": _cache[17] || (_cache[17] = ($event) => ((_unref(settings).petScale) = $event)),\n                                                min: \"0.1\",\n                                                max: \"3\",\n                                                step: \"0.05\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [\n                                                    _vModelText,\n                                                    _unref(settings).petScale,\n                                                    void 0,\n                                                    { number: true }\n                                                ]\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_44, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[18] || (_cache[18] = ($event) => ((_unref(settings).useCdn) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).useCdn]\n                                                ]),\n                                                _cache[81] || (_cache[81] = _createTextVNode(\"  CDN jsDelivr \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[82] || (_cache[82] = _createElementVNode(\"div\", { class: \"hint\" }, \" GitHub  CDN \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_45, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[19] || (_cache[19] = ($event) => ((_unref(settings).doubleTapRandomMotionEnabled) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).doubleTapRandomMotionEnabled]\n                                                ]),\n                                                _cache[83] || (_cache[83] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[84] || (_cache[84] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_46, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[20] || (_cache[20] = ($event) => ((_unref(settings).gazeFollowMouseEnabled) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).gazeFollowMouseEnabled]\n                                                ]),\n                                                _cache[85] || (_cache[85] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[86] || (_cache[86] = _createElementVNode(\"div\", { class: \"hint\" }, \"/\", -1 /* CACHED */))\n                                        ])\n                                    ], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'live2d']\n                                    ]),\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_47, [\n                                        _cache[111] || (_cache[111] = _createElementVNode(\"h4\", null, [\n                                            _createElementVNode(\"span\", { class: \"section-index\" }, \"03\"),\n                                            _createElementVNode(\"span\", { class: \"section-label\" }, \"\"),\n                                            _createElementVNode(\"span\", { class: \"section-sub\" }, \"COMMENT SYSTEM\")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_48, [\n                                            _cache[88] || (_cache[88] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"select\", {\n                                                \"onUpdate:modelValue\": _cache[21] || (_cache[21] = ($event) => ((_unref(settings).commentStyle) = $event))\n                                            }, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(commentStyles), (style) => {\n                                                    return (_openBlock(), _createElementBlock(\"option\", {\n                                                        key: style,\n                                                        value: style\n                                                    }, _toDisplayString(style), 9 /* TEXT, PROPS */, _hoisted_49));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ], 512 /* NEED_PATCH */), [\n                                                [_vModelSelect, _unref(settings).commentStyle]\n                                            ])\n                                        ]),\n                                        (_unref(settings).commentStyle === '')\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_50, [\n                                                _cache[89] || (_cache[89] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                _withDirectives(_createElementVNode(\"textarea\", {\n                                                    \"onUpdate:modelValue\": _cache[22] || (_cache[22] = ($event) => ((_unref(settings).customPrompt) = $event)),\n                                                    rows: \"4\",\n                                                    placeholder: \"...\"\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelText, _unref(settings).customPrompt]\n                                                ])\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        _createElementVNode(\"div\", _hoisted_51, [\n                                            _cache[90] || (_cache[90] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"text\",\n                                                \"onUpdate:modelValue\": _cache[23] || (_cache[23] = ($event) => ((_unref(settings).roleplayName) = $event)),\n                                                placeholder: \"\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [_vModelText, _unref(settings).roleplayName]\n                                            ]),\n                                            _cache[91] || (_cache[91] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_52, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[24] || (_cache[24] = ($event) => ((_unref(settings).roleplayIgnoreCommentStyle) = $event)),\n                                                    disabled: !_unref(settings).roleplayName.trim()\n                                                }, null, 8 /* PROPS */, _hoisted_53), [\n                                                    [_vModelCheckbox, _unref(settings).roleplayIgnoreCommentStyle]\n                                                ]),\n                                                _cache[92] || (_cache[92] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[93] || (_cache[93] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_54, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[25] || (_cache[25] = ($event) => ((_unref(settings).sendCharacterCardContent) = $event)),\n                                                    disabled: !_unref(settings).roleplayName.trim()\n                                                }, null, 8 /* PROPS */, _hoisted_55), [\n                                                    [_vModelCheckbox, _unref(settings).sendCharacterCardContent]\n                                                ]),\n                                                _cache[94] || (_cache[94] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[95] || (_cache[95] = _createElementVNode(\"div\", { class: \"hint\" }, \"//\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_56, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[26] || (_cache[26] = ($event) => ((_unref(settings).autoTrigger) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).autoTrigger]\n                                                ]),\n                                                _cache[96] || (_cache[96] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ])\n                                        ]),\n                                        (_unref(settings).autoTrigger)\n                                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                                _createElementVNode(\"div\", _hoisted_57, [\n                                                    _cache[97] || (_cache[97] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"select\", {\n                                                        \"onUpdate:modelValue\": _cache[27] || (_cache[27] = ($event) => ((_unref(settings).commentTriggerMode) = $event))\n                                                    }, [\n                                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(commentTriggerModeOptions), (option) => {\n                                                            return (_openBlock(), _createElementBlock(\"option\", {\n                                                                key: option.value,\n                                                                value: option.value\n                                                            }, _toDisplayString(option.label), 9 /* TEXT, PROPS */, _hoisted_58));\n                                                        }), 128 /* KEYED_FRAGMENT */))\n                                                    ], 512 /* NEED_PATCH */), [\n                                                        [_vModelSelect, _unref(settings).commentTriggerMode]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_59, [\n                                                    _createElementVNode(\"div\", _hoisted_60, [\n                                                        _cache[98] || (_cache[98] = _createElementVNode(\"label\", null, \" N \", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"number\",\n                                                            \"onUpdate:modelValue\": _cache[28] || (_cache[28] = ($event) => ((_unref(settings).triggerInterval) = $event)),\n                                                            min: \"1\",\n                                                            max: \"100\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).triggerInterval,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_61, [\n                                                        _createElementVNode(\"label\", null, \"\" + _toDisplayString(_unref(settings).triggerProbability) + \"%\", 1 /* TEXT */),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"range\",\n                                                            \"onUpdate:modelValue\": _cache[29] || (_cache[29] = ($event) => ((_unref(settings).triggerProbability) = $event)),\n                                                            min: \"0\",\n                                                            max: \"100\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).triggerProbability,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ])\n                                                    ])\n                                                ])\n                                            ], 64 /* STABLE_FRAGMENT */))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        _createElementVNode(\"div\", _hoisted_62, [\n                                            _cache[99] || (_cache[99] = _createElementVNode(\"label\", null, \" LLM \", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"number\",\n                                                \"onUpdate:modelValue\": _cache[30] || (_cache[30] = ($event) => ((_unref(settings).maxChatContext) = $event)),\n                                                min: \"1\",\n                                                max: \"50\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [\n                                                    _vModelText,\n                                                    _unref(settings).maxChatContext,\n                                                    void 0,\n                                                    { number: true }\n                                                ]\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_63, [\n                                            _cache[100] || (_cache[100] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"number\",\n                                                \"onUpdate:modelValue\": _cache[31] || (_cache[31] = ($event) => ((_unref(settings).bubbleDuration) = $event)),\n                                                min: \"-1\",\n                                                max: \"600\",\n                                                step: \"1\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [\n                                                    _vModelText,\n                                                    _unref(settings).bubbleDuration,\n                                                    void 0,\n                                                    { number: true }\n                                                ]\n                                            ]),\n                                            _cache[101] || (_cache[101] = _createElementVNode(\"div\", { class: \"hint\" }, \" -1  0 \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_64, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[32] || (_cache[32] = ($event) => ((_unref(settings).phoneMessageAutoRead) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).phoneMessageAutoRead]\n                                                ]),\n                                                _cache[102] || (_cache[102] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[103] || (_cache[103] = _createElementVNode(\"div\", { class: \"hint\" }, \" NPC  TTS \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_65, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[33] || (_cache[33] = ($event) => ((_unref(settings).baibaiPhoneMessageAutoRead) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).baibaiPhoneMessageAutoRead]\n                                                ]),\n                                                _cache[104] || (_cache[104] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[105] || (_cache[105] = _createElementVNode(\"div\", { class: \"hint\" }, \" NPC  TTS \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_66, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[34] || (_cache[34] = ($event) => ((_unref(settings).useTamakoTodaySpecial) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).useTamakoTodaySpecial]\n                                                ]),\n                                                _cache[106] || (_cache[106] = _createTextVNode(\"  Tamako  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[107] || (_cache[107] = _createElementVNode(\"div\", { class: \"hint\" }, \" Tamako Market \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_67, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[35] || (_cache[35] = ($event) => ((_unref(settings).useDiceDatabaseReference) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).useDiceDatabaseReference]\n                                                ]),\n                                                _cache[108] || (_cache[108] = _createTextVNode(\"  +  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[109] || (_cache[109] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        (_unref(settings).useDiceDatabaseReference)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_68, [\n                                                _cache[110] || (_cache[110] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                _createElementVNode(\"div\", _hoisted_69, [\n                                                    _createElementVNode(\"div\", _hoisted_70, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-test\",\n                                                            type: \"button\",\n                                                            onClick: refreshDiceReferenceSheetOptions,\n                                                            disabled: refreshingDiceSheetOptions.value\n                                                        }, _toDisplayString(refreshingDiceSheetOptions.value ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_71)\n                                                    ]),\n                                                    _createElementVNode(\"div\", { class: \"form-group half\" }, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: selectAllDiceReferenceSheets\n                                                        }, \"\")\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_72, [\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-secondary\",\n                                                        type: \"button\",\n                                                        onClick: clearDiceReferenceSheets\n                                                    }, \"\"),\n                                                    _createElementVNode(\"div\", _hoisted_73, _toDisplayString(diceReferenceSheetSummary.value), 1 /* TEXT */)\n                                                ]),\n                                                (diceReferenceSheetOptions.value.length > 0)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_74, [\n                                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(diceReferenceSheetOptions.value, (sheetName) => {\n                                                            return (_openBlock(), _createElementBlock(\"label\", {\n                                                                class: \"dice-sheet-item\",\n                                                                key: sheetName\n                                                            }, [\n                                                                _createElementVNode(\"input\", {\n                                                                    type: \"checkbox\",\n                                                                    checked: isDiceSheetVisible(sheetName),\n                                                                    onChange: ($event) => (onToggleDiceSheetVisibility(sheetName, $event))\n                                                                }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_75),\n                                                                _createElementVNode(\"span\", null, _toDisplayString(sheetName), 1 /* TEXT */)\n                                                            ]));\n                                                        }), 128 /* KEYED_FRAGMENT */))\n                                                    ]))\n                                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_76, \"\"))\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true)\n                                    ], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'comment']\n                                    ]),\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_77, [\n                                        _cache[130] || (_cache[130] = _createElementVNode(\"h4\", null, [\n                                            _createElementVNode(\"span\", { class: \"section-index\" }, \"04\"),\n                                            _createElementVNode(\"span\", { class: \"section-label\" }, \"\"),\n                                            _createElementVNode(\"span\", { class: \"section-sub\" }, \"EMOTION COT\")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_78, [\n                                            _createElementVNode(\"div\", _hoisted_79, [\n                                                _createElementVNode(\"div\", _hoisted_80, [\n                                                    _createElementVNode(\"label\", null, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"checkbox\",\n                                                            \"onUpdate:modelValue\": _cache[36] || (_cache[36] = ($event) => ((_unref(settings).emotionCotEnabled) = $event))\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).emotionCotEnabled]\n                                                        ]),\n                                                        _cache[112] || (_cache[112] = _createTextVNode(\"  COT \", -1 /* CACHED */))\n                                                    ]),\n                                                    _cache[113] || (_cache[113] = _createElementVNode(\"div\", { class: \"hint\" }, [\n                                                        _createTextVNode(\" LLM  \"),\n                                                        _createElementVNode(\"code\", null, \"[|]: \"),\n                                                        _createTextVNode(\" /TTS  Live2D \")\n                                                    ], -1 /* CACHED */)),\n                                                    _createElementVNode(\"div\", _hoisted_81, \"\" + _toDisplayString(_unref(emotionTags).join('')), 1 /* TEXT */)\n                                                ]),\n                                                (_unref(settings).emotionCotEnabled)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_82, [\n                                                        _createElementVNode(\"label\", null, [\n                                                            _withDirectives(_createElementVNode(\"input\", {\n                                                                type: \"checkbox\",\n                                                                \"onUpdate:modelValue\": _cache[37] || (_cache[37] = ($event) => ((_unref(settings).emotionCotStripFromText) = $event))\n                                                            }, null, 512 /* NEED_PATCH */), [\n                                                                [_vModelCheckbox, _unref(settings).emotionCotStripFromText]\n                                                            ]),\n                                                            _cache[114] || (_cache[114] = _createTextVNode(\" /TTS  \", -1 /* CACHED */))\n                                                        ]),\n                                                        _cache[115] || (_cache[115] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                                    ]))\n                                                    : _createCommentVNode(\"v-if\", true),\n                                                _createElementVNode(\"div\", _hoisted_83, [\n                                                    _createElementVNode(\"div\", { class: \"form-group half\" }, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: resetEmotionConfigs\n                                                        }, \"\")\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_84, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-test\",\n                                                            type: \"button\",\n                                                            onClick: refreshLive2DLists,\n                                                            disabled: refreshingLive2dLists.value\n                                                        }, _toDisplayString(refreshingLive2dLists.value ? '...' : '/'), 9 /* TEXT, PROPS */, _hoisted_85)\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_86, [\n                                                    _createElementVNode(\"div\", _hoisted_87, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-test\",\n                                                            type: \"button\",\n                                                            onClick: _cache[38] || (_cache[38] = ($event) => (autoMatchLive2DOverrides(false)))\n                                                        }, \"  \")\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_88, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: _cache[39] || (_cache[39] = ($event) => (autoMatchLive2DOverrides(true)))\n                                                        }, \"  \")\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_89, [\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-secondary\",\n                                                        type: \"button\",\n                                                        onClick: clearLive2DOverrides\n                                                    }, \" Live2D \"),\n                                                    _createElementVNode(\"div\", _hoisted_90, _toDisplayString(live2dListSummary.value), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_91, [\n                                                    _createElementVNode(\"div\", {\n                                                        class: \"advanced-toggle\",\n                                                        onClick: _cache[40] || (_cache[40] = ($event) => (showEmotionAdvanced.value = !showEmotionAdvanced.value))\n                                                    }, [\n                                                        _createElementVNode(\"span\", _hoisted_92, _toDisplayString(showEmotionAdvanced.value ? '' : ''), 1 /* TEXT */),\n                                                        _createElementVNode(\"span\", null, _toDisplayString(showEmotionAdvanced.value ? '' : ''), 1 /* TEXT */)\n                                                    ]),\n                                                    _cache[116] || (_cache[116] = _createElementVNode(\"div\", { class: \"hint\" }, \"TTS \", -1 /* CACHED */))\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_93, [\n                                                    _cache[120] || (_cache[120] = _createElementVNode(\"div\", { class: \"emotion-map-head\" }, [\n                                                        _createElementVNode(\"div\", null, \"\"),\n                                                        _createElementVNode(\"div\", null, \"\"),\n                                                        _createElementVNode(\"div\", null, \"Live2D Expression\"),\n                                                        _createElementVNode(\"div\", null, \"Live2D Motion\"),\n                                                        _createElementVNode(\"div\", null, \"\")\n                                                    ], -1 /* CACHED */)),\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(settings).emotionConfigs, (cfg) => {\n                                                        return (_openBlock(), _createElementBlock(\"div\", {\n                                                            key: cfg.tag,\n                                                            class: \"emotion-map-row\"\n                                                        }, [\n                                                            _createElementVNode(\"div\", _hoisted_94, _toDisplayString(cfg.tag), 1 /* TEXT */),\n                                                            _cache[119] || (_cache[119] = _createElementVNode(\"div\", { class: \"emotion-map-arrow\" }, \"\", -1 /* CACHED */)),\n                                                            _withDirectives(_createElementVNode(\"select\", {\n                                                                \"onUpdate:modelValue\": ($event) => ((cfg.live2dExpression) = $event)\n                                                            }, [\n                                                                _cache[117] || (_cache[117] = _createElementVNode(\"option\", { value: \"\" }, \"\", -1 /* CACHED */)),\n                                                                (cfg.live2dExpression && !live2dExpressionOptionSet.value.has(cfg.live2dExpression))\n                                                                    ? (_openBlock(), _createElementBlock(\"option\", {\n                                                                        key: 0,\n                                                                        value: cfg.live2dExpression\n                                                                    }, _toDisplayString(cfg.live2dExpression) + \" \", 9 /* TEXT, PROPS */, _hoisted_96))\n                                                                    : _createCommentVNode(\"v-if\", true),\n                                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(live2dExpressionOptions.value, (expr) => {\n                                                                    return (_openBlock(), _createElementBlock(\"option\", {\n                                                                        key: expr,\n                                                                        value: expr\n                                                                    }, _toDisplayString(expr), 9 /* TEXT, PROPS */, _hoisted_97));\n                                                                }), 128 /* KEYED_FRAGMENT */))\n                                                            ], 8 /* PROPS */, _hoisted_95), [\n                                                                [_vModelSelect, cfg.live2dExpression]\n                                                            ]),\n                                                            _createElementVNode(\"select\", {\n                                                                value: getMotionOverrideValue(cfg),\n                                                                disabled: !cfg.live2dMotion.enabled,\n                                                                onChange: ($event) => (onMotionOverrideChange(cfg, $event))\n                                                            }, [\n                                                                _cache[118] || (_cache[118] = _createElementVNode(\"option\", { value: \"\" }, \"\", -1 /* CACHED */)),\n                                                                (getMotionOverrideValue(cfg) && !live2dMotionOptionSet.value.has(getMotionOverrideValue(cfg)))\n                                                                    ? (_openBlock(), _createElementBlock(\"option\", {\n                                                                        key: 0,\n                                                                        value: getMotionOverrideValue(cfg)\n                                                                    }, _toDisplayString(getMotionOverrideLabel(cfg)) + \" \", 9 /* TEXT, PROPS */, _hoisted_99))\n                                                                    : _createCommentVNode(\"v-if\", true),\n                                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(live2dMotionSelectOptions.value, (opt) => {\n                                                                    return (_openBlock(), _createElementBlock(\"option\", {\n                                                                        key: opt.key,\n                                                                        value: opt.value\n                                                                    }, _toDisplayString(opt.label), 9 /* TEXT, PROPS */, _hoisted_100));\n                                                                }), 128 /* KEYED_FRAGMENT */))\n                                                            ], 40 /* PROPS, NEED_HYDRATION */, _hoisted_98),\n                                                            _createElementVNode(\"button\", {\n                                                                class: \"btn btn-secondary emotion-map-preview-btn\",\n                                                                type: \"button\",\n                                                                title: \"\",\n                                                                onClick: ($event) => (previewEmotion(cfg.tag))\n                                                            }, \"  \", 8 /* PROPS */, _hoisted_101)\n                                                        ]));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]),\n                                                _cache[126] || (_cache[126] = _createElementVNode(\"div\", { class: \"hint\" }, \" Expressions Motions\", -1 /* CACHED */)),\n                                                (showEmotionAdvanced.value)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_102, [\n                                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(settings).emotionConfigs, (cfg) => {\n                                                            return (_openBlock(), _createElementBlock(\"div\", {\n                                                                key: `advanced_${cfg.tag}`,\n                                                                class: \"emotion-advanced-item\"\n                                                            }, [\n                                                                _createElementVNode(\"div\", _hoisted_103, _toDisplayString(cfg.tag) + \"  \", 1 /* TEXT */),\n                                                                _createElementVNode(\"div\", _hoisted_104, [\n                                                                    _createElementVNode(\"div\", _hoisted_105, [\n                                                                        _cache[121] || (_cache[121] = _createElementVNode(\"label\", null, \"raw tag  \", -1 /* CACHED */)),\n                                                                        _createElementVNode(\"input\", {\n                                                                            type: \"text\",\n                                                                            value: (cfg.aliases || []).join(', '),\n                                                                            onBlur: ($event) => (onAliasesBlur(cfg, $event)),\n                                                                            placeholder: \", smile\"\n                                                                        }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_106),\n                                                                        _cache[122] || (_cache[122] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                                                    ]),\n                                                                    _createElementVNode(\"div\", _hoisted_107, [\n                                                                        _cache[123] || (_cache[123] = _createElementVNode(\"label\", null, \"TTS \", -1 /* CACHED */)),\n                                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                                            type: \"text\",\n                                                                            \"onUpdate:modelValue\": ($event) => ((cfg.ttsContext) = $event),\n                                                                            placeholder: \"\"\n                                                                        }, null, 8 /* PROPS */, _hoisted_108), [\n                                                                            [_vModelText, cfg.ttsContext]\n                                                                        ]),\n                                                                        _cache[124] || (_cache[124] = _createElementVNode(\"div\", { class: \"hint\" }, \" |  contextTexts  TTS\", -1 /* CACHED */))\n                                                                    ])\n                                                                ]),\n                                                                _createElementVNode(\"div\", _hoisted_109, [\n                                                                    _createElementVNode(\"label\", null, [\n                                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                                            type: \"checkbox\",\n                                                                            \"onUpdate:modelValue\": ($event) => ((cfg.live2dMotion.enabled) = $event)\n                                                                        }, null, 8 /* PROPS */, _hoisted_110), [\n                                                                            [_vModelCheckbox, cfg.live2dMotion.enabled]\n                                                                        ]),\n                                                                        _cache[125] || (_cache[125] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                                                    ])\n                                                                ])\n                                                            ]));\n                                                        }), 128 /* KEYED_FRAGMENT */))\n                                                    ]))\n                                                    : _createCommentVNode(\"v-if\", true)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_111, [\n                                                _createElementVNode(\"div\", _hoisted_112, [\n                                                    _cache[127] || (_cache[127] = _createElementVNode(\"span\", { class: \"emotion-preview-title\" }, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"span\", _hoisted_113, \": \" + _toDisplayString(previewTag.value), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"div\", {\n                                                    class: \"emotion-preview-canvas\",\n                                                    ref_key: \"live2dPreviewMountEl\",\n                                                    ref: live2dPreviewMountEl\n                                                }, [\n                                                    _createElementVNode(\"div\", {\n                                                        class: \"emotion-preview-interact\",\n                                                        ref_key: \"live2dPreviewInteractEl\",\n                                                        ref: live2dPreviewInteractEl\n                                                    }, null, 512 /* NEED_PATCH */),\n                                                    (!_unref(Live2DManager).model)\n                                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_114, \"\"))\n                                                        : _createCommentVNode(\"v-if\", true)\n                                                ], 512 /* NEED_PATCH */),\n                                                _createElementVNode(\"div\", _hoisted_115, [\n                                                    _createElementVNode(\"div\", _hoisted_116, [\n                                                        _cache[128] || (_cache[128] = _createElementVNode(\"span\", { class: \"zoom-label\" }, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            class: \"zoom-slider\",\n                                                            type: \"range\",\n                                                            min: \"0.5\",\n                                                            max: \"4\",\n                                                            step: \"0.05\",\n                                                            \"onUpdate:modelValue\": _cache[41] || (_cache[41] = ($event) => ((previewZoomFactor).value = $event)),\n                                                            onInput: applyPreviewViewport\n                                                        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                previewZoomFactor.value,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ]),\n                                                        _createElementVNode(\"span\", _hoisted_117, _toDisplayString(Math.round(previewZoomFactor.value * 100)) + \"%\", 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"div\", { class: \"emotion-preview-actions\" }, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: resetPreviewViewport\n                                                        }, \"\"),\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: replayPreview\n                                                        }, \"\")\n                                                    ]),\n                                                    _cache[129] || (_cache[129] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"div\", {\n                                                        class: \"hint\",\n                                                        title: previewStatus.value\n                                                    }, _toDisplayString(previewStatus.value), 9 /* TEXT, PROPS */, _hoisted_118)\n                                                ])\n                                            ])\n                                        ])\n                                    ], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'expression']\n                                    ]),\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_119, [\n                                        _cache[155] || (_cache[155] = _createElementVNode(\"h4\", null, [\n                                            _createElementVNode(\"span\", { class: \"section-index\" }, \"05\"),\n                                            _createElementVNode(\"span\", { class: \"section-label\" }, \"TTS \"),\n                                            _createElementVNode(\"span\", { class: \"section-sub\" }, \"VOICE CONTROL\")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_120, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[42] || (_cache[42] = ($event) => ((ttsEnabled).value = $event)),\n                                                    onChange: onToggleTtsEnabled\n                                                }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                                    [_vModelCheckbox, ttsEnabled.value]\n                                                ]),\n                                                _cache[131] || (_cache[131] = _createTextVNode(\"  TTS  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[132] || (_cache[132] = _createElementVNode(\"div\", { class: \"hint\" }, \"/\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_121, [\n                                            _cache[133] || (_cache[133] = _createElementVNode(\"label\", null, \"TTS \", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"select\", {\n                                                \"onUpdate:modelValue\": _cache[43] || (_cache[43] = ($event) => ((_unref(settings).ttsProvider) = $event))\n                                            }, [\n                                                _createElementVNode(\"option\", {\n                                                    value: _unref(TTS_PROVIDER).LITTLEWHITEBOX\n                                                }, \"X\", 8 /* PROPS */, _hoisted_122),\n                                                _createElementVNode(\"option\", {\n                                                    value: _unref(TTS_PROVIDER).GPT_SOVITS_V2\n                                                }, \"GPT-SoVITS v2ProPlus\", 8 /* PROPS */, _hoisted_123),\n                                                _createElementVNode(\"option\", {\n                                                    value: _unref(TTS_PROVIDER).EDGE_TTS_DIRECT\n                                                }, \"EdgeTTSEdge\", 8 /* PROPS */, _hoisted_124)\n                                            ], 512 /* NEED_PATCH */), [\n                                                [_vModelSelect, _unref(settings).ttsProvider]\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_125, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[44] || (_cache[44] = ($event) => ((_unref(settings).ttsAutoPlay) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).ttsAutoPlay]\n                                                ]),\n                                                _cache[134] || (_cache[134] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_126, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[45] || (_cache[45] = ($event) => ((_unref(settings).phoneMessageAutoRead) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).phoneMessageAutoRead]\n                                                ]),\n                                                _cache[135] || (_cache[135] = _createTextVNode(\"  NPC  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[136] || (_cache[136] = _createElementVNode(\"div\", { class: \"hint\" }, \" sender=contact  type=text \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_127, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[46] || (_cache[46] = ($event) => ((_unref(settings).baibaiPhoneMessageAutoRead) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).baibaiPhoneMessageAutoRead]\n                                                ]),\n                                                _cache[137] || (_cache[137] = _createTextVNode(\"  NPC  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[138] || (_cache[138] = _createElementVNode(\"div\", { class: \"hint\" }, \" qq.private / qq.group  NPC \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_128, [\n                                            _cache[140] || (_cache[140] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_129, [\n                                                _withDirectives(_createElementVNode(\"select\", {\n                                                    \"onUpdate:modelValue\": _cache[47] || (_cache[47] = ($event) => ((_unref(settings).ttsDefaultSpeaker) = $event))\n                                                }, [\n                                                    _cache[139] || (_cache[139] = _createElementVNode(\"option\", { value: \"\" }, \"\", -1 /* CACHED */)),\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(ttsVoiceList.value, (v) => {\n                                                        return (_openBlock(), _createElementBlock(\"option\", {\n                                                            key: v.name,\n                                                            value: v.name\n                                                        }, _toDisplayString(v.name) + _toDisplayString(v.desc ? ' (' + v.desc + ')' : ''), 9 /* TEXT, PROPS */, _hoisted_130));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ], 512 /* NEED_PATCH */), [\n                                                    [_vModelSelect, _unref(settings).ttsDefaultSpeaker]\n                                                ]),\n                                                _createElementVNode(\"button\", {\n                                                    class: \"input-btn\",\n                                                    type: \"button\",\n                                                    onClick: refreshTtsVoices,\n                                                    disabled: refreshingTtsVoices.value\n                                                }, _toDisplayString(refreshingTtsVoices.value ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_131)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_132, _toDisplayString(ttsVoiceHint.value), 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", {\n                                            class: \"advanced-toggle\",\n                                            onClick: _cache[48] || (_cache[48] = ($event) => (showLipSyncAdvanced.value = !showLipSyncAdvanced.value))\n                                        }, [\n                                            _createElementVNode(\"span\", _hoisted_133, _toDisplayString(showLipSyncAdvanced.value ? '' : ''), 1 /* TEXT */),\n                                            _cache[141] || (_cache[141] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                        ]),\n                                        (showLipSyncAdvanced.value)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_134, [\n                                                _createElementVNode(\"div\", _hoisted_135, [\n                                                    _createElementVNode(\"label\", null, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"checkbox\",\n                                                            \"onUpdate:modelValue\": _cache[49] || (_cache[49] = ($event) => ((_unref(settings).lipSyncManualParamsEnabled) = $event))\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).lipSyncManualParamsEnabled]\n                                                        ]),\n                                                        _cache[142] || (_cache[142] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                                    ]),\n                                                    _cache[143] || (_cache[143] = _createElementVNode(\"div\", { class: \"hint\" }, \" Param58 / Param61\", -1 /* CACHED */))\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_136, [\n                                                    _cache[144] || (_cache[144] = _createElementVNode(\"label\", null, \" ID\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"textarea\", {\n                                                        \"onUpdate:modelValue\": _cache[50] || (_cache[50] = ($event) => ((lipSyncManualParamsText).value = $event)),\n                                                        rows: \"3\",\n                                                        placeholder: \"ParamMouthOpenY\\nParam58\",\n                                                        onBlur: applyLipSyncManualParams\n                                                    }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                                        [_vModelText, lipSyncManualParamsText.value]\n                                                    ]),\n                                                    _cache[145] || (_cache[145] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                                ])\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        (_unref(settings).ttsProvider === _unref(TTS_PROVIDER).GPT_SOVITS_V2)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_137, [\n                                                _createElementVNode(\"div\", _hoisted_138, [\n                                                    _cache[146] || (_cache[146] = _createElementVNode(\"label\", null, \"API \", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"input\", {\n                                                        type: \"text\",\n                                                        \"onUpdate:modelValue\": _cache[51] || (_cache[51] = ($event) => ((_unref(settings).gptSoVits.apiUrl) = $event)),\n                                                        placeholder: \"http://127.0.0.1:9880\"\n                                                    }, null, 512 /* NEED_PATCH */), [\n                                                        [_vModelText, _unref(settings).gptSoVits.apiUrl]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_139, [\n                                                    _createElementVNode(\"label\", null, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"checkbox\",\n                                                            \"onUpdate:modelValue\": _cache[52] || (_cache[52] = ($event) => ((_unref(settings).gptSoVits.useCorsProxy) = $event))\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).gptSoVits.useCorsProxy]\n                                                        ]),\n                                                        _cache[147] || (_cache[147] = _createTextVNode(\" /proxy \", -1 /* CACHED */))\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_140, [\n                                                    _createElementVNode(\"div\", _hoisted_141, [\n                                                        _cache[148] || (_cache[148] = _createElementVNode(\"label\", null, \"text_lang\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": _cache[53] || (_cache[53] = ($event) => ((_unref(settings).gptSoVits.textLang) = $event)),\n                                                            placeholder: \"auto/zh/en/ja...\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelText, _unref(settings).gptSoVits.textLang]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_142, [\n                                                        _cache[149] || (_cache[149] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": _cache[54] || (_cache[54] = ($event) => ((_unref(settings).gptSoVits.textSplitMethod) = $event)),\n                                                            placeholder: \"cut5\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelText, _unref(settings).gptSoVits.textSplitMethod]\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_143, [\n                                                    _createElementVNode(\"div\", _hoisted_144, [\n                                                        _cache[151] || (_cache[151] = _createElementVNode(\"label\", null, \"media_type\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"select\", {\n                                                            \"onUpdate:modelValue\": _cache[55] || (_cache[55] = ($event) => ((_unref(settings).gptSoVits.mediaType) = $event))\n                                                        }, [...(_cache[150] || (_cache[150] = [\n                                                                _createElementVNode(\"option\", { value: \"wav\" }, \"wav\", -1 /* CACHED */),\n                                                                _createElementVNode(\"option\", { value: \"ogg\" }, \"ogg\", -1 /* CACHED */),\n                                                                _createElementVNode(\"option\", { value: \"raw\" }, \"raw\", -1 /* CACHED */)\n                                                            ]))], 512 /* NEED_PATCH */), [\n                                                            [_vModelSelect, _unref(settings).gptSoVits.mediaType]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_145, [\n                                                        _createElementVNode(\"label\", null, [\n                                                            _withDirectives(_createElementVNode(\"input\", {\n                                                                type: \"checkbox\",\n                                                                \"onUpdate:modelValue\": _cache[56] || (_cache[56] = ($event) => ((_unref(settings).gptSoVits.streamingMode) = $event))\n                                                            }, null, 512 /* NEED_PATCH */), [\n                                                                [_vModelCheckbox, _unref(settings).gptSoVits.streamingMode]\n                                                            ]),\n                                                            _cache[152] || (_cache[152] = _createTextVNode(\" streaming_mode \", -1 /* CACHED */))\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_146, [\n                                                    _cache[153] || (_cache[153] = _createElementVNode(\"label\", null, \"speed_factor\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"input\", {\n                                                        type: \"number\",\n                                                        \"onUpdate:modelValue\": _cache[57] || (_cache[57] = ($event) => ((_unref(settings).gptSoVits.speedFactor) = $event)),\n                                                        min: \"0.5\",\n                                                        max: \"2\",\n                                                        step: \"0.05\"\n                                                    }, null, 512 /* NEED_PATCH */), [\n                                                        [\n                                                            _vModelText,\n                                                            _unref(settings).gptSoVits.speedFactor,\n                                                            void 0,\n                                                            { number: true }\n                                                        ]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_147, [\n                                                    _cache[154] || (_cache[154] = _createElementVNode(\"label\", null, \"JSON\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"textarea\", {\n                                                        \"onUpdate:modelValue\": _cache[58] || (_cache[58] = ($event) => ((gptSoVitsVoicesJson).value = $event)),\n                                                        rows: \"6\",\n                                                        placeholder: \"[{\\\"name\\\":\\\"\\\",\\\"refAudioPath\\\":\\\"wavs/xxx.wav\\\",\\\"promptText\\\":\\\"\\\",\\\"promptLang\\\":\\\"zh\\\"}]\"\n                                                    }, null, 512 /* NEED_PATCH */), [\n                                                        [_vModelText, gptSoVitsVoicesJson.value]\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_148, [\n                                                        _createElementVNode(\"div\", { class: \"form-group half\" }, [\n                                                            _createElementVNode(\"button\", {\n                                                                class: \"btn btn-secondary\",\n                                                                type: \"button\",\n                                                                onClick: saveGptSoVitsVoices\n                                                            }, \"\")\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_149, [\n                                                            _createElementVNode(\"button\", {\n                                                                class: \"btn btn-test\",\n                                                                type: \"button\",\n                                                                onClick: testTts,\n                                                                disabled: !ttsEnabled.value\n                                                            }, \"\", 8 /* PROPS */, _hoisted_150)\n                                                        ])\n                                                    ]),\n                                                    _withDirectives(_createElementVNode(\"input\", {\n                                                        type: \"text\",\n                                                        \"onUpdate:modelValue\": _cache[59] || (_cache[59] = ($event) => ((ttsTestText).value = $event)),\n                                                        placeholder: \"\"\n                                                    }, null, 512 /* NEED_PATCH */), [\n                                                        [_vModelText, ttsTestText.value]\n                                                    ])\n                                                ])\n                                            ]))\n                                            : (_openBlock(), _createElementBlock(\"div\", _hoisted_151, [\n                                                _createElementVNode(\"button\", {\n                                                    class: \"btn btn-test\",\n                                                    type: \"button\",\n                                                    onClick: testTts,\n                                                    disabled: !ttsEnabled.value\n                                                }, \"\", 8 /* PROPS */, _hoisted_152),\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"text\",\n                                                    \"onUpdate:modelValue\": _cache[60] || (_cache[60] = ($event) => ((ttsTestText).value = $event)),\n                                                    placeholder: \"\"\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelText, ttsTestText.value]\n                                                ])\n                                            ])),\n                                        _createElementVNode(\"div\", { class: \"form-group\" }, [\n                                            _createElementVNode(\"button\", {\n                                                class: \"btn btn-secondary\",\n                                                type: \"button\",\n                                                onClick: stopTts\n                                            }, \"\")\n                                        ])\n                                    ], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'tts']\n                                    ]),\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_153, [...(_cache[156] || (_cache[156] = [\n                                            _createStaticVNode(\"<h4 data-v-7941402e><span class=\\\"section-index\\\" data-v-7941402e>06</span><span class=\\\"section-label\\\" data-v-7941402e></span><span class=\\\"section-sub\\\" data-v-7941402e>ABOUT &amp; LICENSE</span></h4><div class=\\\"about-card\\\" data-v-7941402e><div class=\\\"about-title\\\" data-v-7941402e></div><a class=\\\"about-link\\\" href=\\\"https://discord.com/channels/1134557553011998840/1472242483806077061\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\" data-v-7941402e> https://discord.com/channels/1134557553011998840/1472242483806077061 </a></div><div class=\\\"about-card\\\" data-v-7941402e><div class=\\\"about-title\\\" data-v-7941402e></div><ul class=\\\"about-list\\\" data-v-7941402e><li data-v-7941402e>  Live2D  </li><li data-v-7941402e></li><li data-v-7941402e>  <a class=\\\"about-link\\\" href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\" data-v-7941402e> CC BY-NC-SA 4.0 </a> -- </li><li data-v-7941402e></li></ul></div>\", 3)\n                                        ]))], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'about']\n                                    ])\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", { class: \"panel-footer\" }, [\n                                _createElementVNode(\"button\", {\n                                    class: \"btn btn-secondary\",\n                                    type: \"button\",\n                                    onClick: resetSettings\n                                }, \"\"),\n                                _createElementVNode(\"button\", {\n                                    class: \"btn btn-primary\",\n                                    type: \"button\",\n                                    onClick: close\n                                }, \"\")\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (showBrowser.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 1,\n                        class: \"browser-overlay dp-browser-overlay\",\n                        style: overlayFallbackStyle,\n                        onClick: _cache[63] || (_cache[63] = _withModifiers(($event) => (showBrowser.value = false), [\"self\"]))\n                    }, [\n                        _createElementVNode(\"div\", {\n                            class: \"browser-dialog dp-browser-dialog\",\n                            style: panelFallbackStyle\n                        }, [\n                            _createElementVNode(\"div\", _hoisted_154, [\n                                _cache[157] || (_cache[157] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-btn\",\n                                    type: \"button\",\n                                    onClick: _cache[61] || (_cache[61] = ($event) => (showBrowser.value = false))\n                                }, \"X\")\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_155, [\n                                _createVNode(ModelBrowser, {\n                                    \"use-cdn\": _unref(settings).useCdn,\n                                    onCancel: _cache[62] || (_cache[62] = ($event) => (showBrowser.value = false)),\n                                    onLoadModel: onBrowserLoad\n                                }, null, 8 /* PROPS */, [\"use-cdn\"])\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SettingsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SettingsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SettingsPanel.vue?vue&type=style&index=0&id=7941402e&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7941402e\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createVNode as _createVNode, createElementVNode as _createElementVNode, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"browser-dialog\" };\nconst _hoisted_2 = { class: \"browser-dialog-header\" };\nconst _hoisted_3 = { class: \"browser-dialog-body\" };\nimport { storeToRefs } from 'pinia';\nimport { onMounted, onUnmounted, ref, watch } from 'vue';\nimport { getTTSEnabled } from '../audio/tts-config';\nimport { TTSManager } from '../audio/tts-manager';\nimport { Commentator } from '../chat/commentator';\nimport { parseEmotionCotText } from '../chat/emotion-cot';\nimport { ChatMonitor } from '../chat/monitor';\nimport { DEFAULTS } from '../core/constants';\nimport { getEmotionConfigByTag } from '../core/emotion';\nimport { useSettingsStore } from '../core/settings';\nimport { useUiStore } from '../core/ui';\nimport { Live2DManager } from '../live2d/manager';\nimport { matchLive2DExpression, matchLive2DMotion } from '../live2d/expression-motion';\nimport { LipSyncManager, setLipSyncRefs } from '../live2d/lip-sync';\nimport { Live2DStage } from '../live2d/stage';\nimport { error as logError, log } from '../utils/dom';\nimport ChatBubble from './ChatBubble.vue';\nimport FunctionMenu from './FunctionMenu.vue';\nimport ModelBrowser from './ModelBrowser.vue';\nimport SettingsPanel from './SettingsPanel.vue';\nconst BASE_STAGE_WIDTH = 280;\nconst BASE_STAGE_HEIGHT = 360;\nconst OPEN_SETTINGS_FN_KEY = '__desktopPetOpenSettings_v2';\nconst PHONE_TTS_SEEN_MAX = 4000;\nconst BAIBAI_ASSISTANT_SEEN_MAX = 2000;\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'PetContainer',\n    setup(__props) {\n        const store = useSettingsStore();\n        const { settings } = storeToRefs(store);\n        const uiStore = useUiStore();\n        const { showSettings } = storeToRefs(uiStore);\n        const bubbleText = ref('');\n        const bubbleDone = ref(true);\n        let globalOpenSettingsFn = null;\n        let modelLoadTaskId = 0;\n        let modelLoadingHideTimer = null;\n        let statusCheckTimer = null;\n        let viewportResizeSyncTimer = null;\n        let boundWindowResizeHandler = null;\n        let boundVisualViewportResizeHandler = null;\n        let gazeFollowBound = false;\n        let gazePointerMoveHandler = null;\n        let gazePointerDownHandler = null;\n        let gazeFollowRafId = null;\n        let gazePendingPoint = null;\n        const showMenu = ref(false);\n        const menuAnchor = ref({ x: 0, y: 0 });\n        const menuPlacement = ref('left');\n        const showModelBrowser = ref(false);\n        let phoneTtsBridgeBound = false;\n        let phoneMessageReceivedHandler = null;\n        let phoneAIGenCompleteHandler = null;\n        let phoneTtsListenSinceSec = 0;\n        const phoneSeenMessageKeys = new Set();\n        const phoneSeenMessageOrder = [];\n        const phoneTtsQueue = [];\n        let phoneTtsQueueRunning = false;\n        let baibaiPhoneTtsBridgeBound = false;\n        let baibaiPhonePollTimer = null;\n        const baibaiEventStops = [];\n        const baibaiSeenAssistantIds = new Set();\n        const baibaiSeenAssistantOrder = [];\n        function getTopWindow() {\n            try {\n                return window.parent ?? window;\n            }\n            catch {\n                return window;\n            }\n        }\n        function getCurrentCharacterId() {\n            try {\n                const ctx = SillyTavern?.getContext?.();\n                if (ctx?.characterId !== undefined && ctx?.characterId !== null) {\n                    return String(ctx.characterId);\n                }\n            }\n            catch {\n                // ignore\n            }\n            return 'default';\n        }\n        function getPhoneStore() {\n            try {\n                const topAny = getTopWindow();\n                const store = topAny?.extension_settings?.acsusPawsPuffs?.phone;\n                if (store && typeof store === 'object')\n                    return store;\n            }\n            catch {\n                // ignore\n            }\n            try {\n                const localAny = window;\n                const store = localAny?.extension_settings?.acsusPawsPuffs?.phone;\n                if (store && typeof store === 'object')\n                    return store;\n            }\n            catch {\n                // ignore\n            }\n            return null;\n        }\n        function getPhoneContactName(source, contactId) {\n            const safeId = String(contactId || '').trim();\n            const fallback = safeId.replace(/^chat_/, '').replace(/^tavern_/, '').trim() || '';\n            if (source === 'baibai')\n                return fallback;\n            const store = getPhoneStore();\n            const contacts = Array.isArray(store?.contacts) ? store.contacts : [];\n            const matched = contacts.find((item) => String(item?.id || '').trim() === safeId);\n            const name = String(matched?.name || '').trim();\n            return name || fallback;\n        }\n        function getPhoneChatHistory(contactId) {\n            const store = getPhoneStore();\n            const key = `chat_${String(contactId || '').trim()}`;\n            const history = store?.chats?.[key];\n            return Array.isArray(history) ? history : [];\n        }\n        function isNonUserPhoneMessage(message) {\n            const sender = String(message?.sender || '')\n                .trim()\n                .toLowerCase();\n            const type = String(message?.type || 'text')\n                .trim()\n                .toLowerCase();\n            return sender === 'contact' && type === 'text';\n        }\n        function sanitizePhoneSpeakText(value) {\n            return String(value ?? '')\n                .replace(/\\s+/g, ' ')\n                .trim();\n        }\n        function isPhoneAutoReadEnabled(source) {\n            if (source === 'baibai') {\n                return settings.value.baibaiPhoneMessageAutoRead === true;\n            }\n            return settings.value.phoneMessageAutoRead !== false;\n        }\n        function getNormalizedUserNames() {\n            const names = new Set();\n            const append = (value) => {\n                const normalized = sanitizePhoneSpeakText(value).toLowerCase();\n                if (normalized)\n                    names.add(normalized);\n            };\n            try {\n                append(SillyTavern?.name1);\n            }\n            catch {\n                // ignore\n            }\n            try {\n                const ctx = SillyTavern?.getContext?.();\n                append(ctx?.name1);\n                append(ctx?.userName);\n            }\n            catch {\n                // ignore\n            }\n            append('user');\n            return names;\n        }\n        function isBaibaiUserSender(senderName) {\n            const sender = sanitizePhoneSpeakText(senderName).toLowerCase();\n            if (!sender)\n                return false;\n            return getNormalizedUserNames().has(sender);\n        }\n        function sanitizeAssistantPhoneCommandText(value) {\n            return String(value ?? '')\n                .replace(/<think[ing]*?>[\\s\\S]*?<\\/think[ing]*?>/gi, '')\n                .replace(/<!--[\\s\\S]*?-->/g, '')\n                .trim();\n        }\n        function hasBaibaiPhoneCommand(value) {\n            return /\\bqq\\.(?:private|group)\\s*\\(/i.test(String(value ?? ''));\n        }\n        function parseBaibaiCommandArgs(rawArgs) {\n            const source = String(rawArgs || '').trim();\n            if (!source)\n                return [];\n            const quotedArgs = [];\n            const quotedMatcher = /'([^']*)'|\"([^\"]*)\"/g;\n            for (const match of source.matchAll(quotedMatcher)) {\n                const value = sanitizePhoneSpeakText(match[1] ?? match[2] ?? '');\n                quotedArgs.push(value);\n            }\n            if (quotedArgs.length > 0)\n                return quotedArgs;\n            return source\n                .split(',')\n                .map((item) => sanitizePhoneSpeakText(item))\n                .filter((item) => !!item);\n        }\n        function extractBaibaiTextPayloads(rawPayload) {\n            const payload = String(rawPayload ?? '');\n            if (!payload)\n                return [];\n            const marker = payload.match(/\\[(.+?)-(.+?)\\]/);\n            if (!marker) {\n                const text = sanitizePhoneSpeakText(payload);\n                return text ? [text] : [];\n            }\n            const markerType = sanitizePhoneSpeakText(marker[1]).toLowerCase();\n            if (markerType === 'bqb' || markerType === 'img') {\n                const text = sanitizePhoneSpeakText(payload.replace(marker[0], ''));\n                return text ? [text] : [];\n            }\n            return [];\n        }\n        function extractPhoneSpeakText(message) {\n            const type = String(message?.type || 'text')\n                .trim()\n                .toLowerCase();\n            switch (type) {\n                case 'text': {\n                    let text = sanitizePhoneSpeakText(message.content);\n                    text = text.replace(/^\\[(?:|||)?\\]/, '').trim();\n                    return text;\n                }\n                case 'quote':\n                    return sanitizePhoneSpeakText(message.replyContent || message.content || '');\n                case 'emoji':\n                    return sanitizePhoneSpeakText(` ${message.content || ''}`);\n                case 'image':\n                case 'image-real':\n                case 'image-fake': {\n                    const desc = sanitizePhoneSpeakText(message.description || message.content || '');\n                    return desc ? `${desc}` : '';\n                }\n                case 'redpacket':\n                    return ` ${sanitizePhoneSpeakText(message.amount || 0)} `;\n                case 'transfer': {\n                    const amount = sanitizePhoneSpeakText(message.amount || 0);\n                    const note = sanitizePhoneSpeakText(message.message || message.content || '');\n                    return note ? ` ${amount}  ${note}` : ` ${amount} `;\n                }\n                case 'video':\n                    return sanitizePhoneSpeakText(` ${message.description || ''}`) || '';\n                case 'file':\n                    return sanitizePhoneSpeakText(` ${message.filename || ''}`) || '';\n                case 'poke':\n                    return '';\n                case 'recalled':\n                case 'recalled-pending':\n                    return '';\n                case 'friend_request':\n                case 'friend_added':\n                case 'friend_deleted':\n                    return sanitizePhoneSpeakText(message.content || '');\n                case 'gift-membership':\n                case 'buy-membership': {\n                    const months = sanitizePhoneSpeakText(message.months || '');\n                    const memberType = String(message.membershipType || '').toUpperCase() || '';\n                    return sanitizePhoneSpeakText(`${months ? `${months}` : ''}${memberType}`);\n                }\n                default:\n                    return sanitizePhoneSpeakText(message.content || message.description || '');\n            }\n        }\n        function getPhoneMessageKey(source, contactId, message) {\n            const safeContact = String(contactId || '').trim();\n            const messageId = sanitizePhoneSpeakText(message?.id);\n            if (messageId)\n                return `${source}:${safeContact}:${messageId}`;\n            const sender = sanitizePhoneSpeakText(message?.sender).toLowerCase() || 'unknown';\n            const type = sanitizePhoneSpeakText(message?.type).toLowerCase() || 'text';\n            const time = Number(message?.time || 0);\n            const content = sanitizePhoneSpeakText(message?.content || message?.replyContent || message?.description || message?.filename || '').slice(0, 72);\n            return `${source}:${safeContact}:${sender}:${type}:${time}:${content}`;\n        }\n        function rememberPhoneMessageKey(key) {\n            if (!key || phoneSeenMessageKeys.has(key))\n                return;\n            phoneSeenMessageKeys.add(key);\n            phoneSeenMessageOrder.push(key);\n            if (phoneSeenMessageOrder.length <= PHONE_TTS_SEEN_MAX)\n                return;\n            const stale = phoneSeenMessageOrder.shift();\n            if (stale) {\n                phoneSeenMessageKeys.delete(stale);\n            }\n        }\n        function markExistingPhoneMessagesAsSeen() {\n            const store = getPhoneStore();\n            const chats = store?.chats;\n            if (!chats || typeof chats !== 'object')\n                return;\n            for (const [chatKey, list] of Object.entries(chats)) {\n                if (!Array.isArray(list))\n                    continue;\n                const contactId = String(chatKey || '')\n                    .replace(/^chat_/, '')\n                    .trim();\n                if (!contactId)\n                    continue;\n                for (const raw of list) {\n                    const message = raw;\n                    if (!isNonUserPhoneMessage(message))\n                        continue;\n                    rememberPhoneMessageKey(getPhoneMessageKey('acsus', contactId, message));\n                }\n            }\n        }\n        function resolveTavernEventName(eventKey) {\n            try {\n                const top = getTopWindow();\n                const fromTop = top?.SillyTavern?.eventTypes?.[eventKey];\n                if (fromTop)\n                    return String(fromTop);\n            }\n            catch {\n                // ignore\n            }\n            try {\n                const fromLegacy = tavern_events?.[eventKey];\n                if (fromLegacy)\n                    return String(fromLegacy);\n            }\n            catch {\n                // ignore\n            }\n            return null;\n        }\n        function bindTavernEvent(eventKey, handler) {\n            const eventName = resolveTavernEventName(eventKey);\n            if (!eventName)\n                return null;\n            try {\n                const top = getTopWindow();\n                const eventSource = top?.SillyTavern?.eventSource;\n                if (eventSource && typeof eventSource.on === 'function') {\n                    eventSource.on(eventName, handler);\n                    return {\n                        stop: () => {\n                            try {\n                                if (typeof eventSource.off === 'function') {\n                                    eventSource.off(eventName, handler);\n                                }\n                                else if (typeof eventSource.removeListener === 'function') {\n                                    eventSource.removeListener(eventName, handler);\n                                }\n                            }\n                            catch {\n                                // ignore\n                            }\n                        },\n                    };\n                }\n            }\n            catch {\n                // ignore\n            }\n            if (typeof eventOn === 'function') {\n                return eventOn(eventName, handler);\n            }\n            return null;\n        }\n        function resetBaibaiAssistantSeenState() {\n            baibaiSeenAssistantIds.clear();\n            baibaiSeenAssistantOrder.length = 0;\n        }\n        function rememberBaibaiAssistantMessageId(messageId) {\n            if (!Number.isFinite(messageId))\n                return;\n            if (baibaiSeenAssistantIds.has(messageId))\n                return;\n            baibaiSeenAssistantIds.add(messageId);\n            baibaiSeenAssistantOrder.push(messageId);\n            if (baibaiSeenAssistantOrder.length <= BAIBAI_ASSISTANT_SEEN_MAX)\n                return;\n            const stale = baibaiSeenAssistantOrder.shift();\n            if (typeof stale === 'number') {\n                baibaiSeenAssistantIds.delete(stale);\n            }\n        }\n        function getAssistantChatMessages() {\n            try {\n                const messages = getChatMessages(`0-{{lastMessageId}}`, {\n                    role: 'assistant',\n                    hide_state: 'unhidden',\n                });\n                return Array.isArray(messages) ? messages : [];\n            }\n            catch {\n                return [];\n            }\n        }\n        function parseBaibaiPhoneMessagesFromAssistant(message) {\n            const normalizedText = sanitizeAssistantPhoneCommandText(message?.message);\n            if (!normalizedText || !hasBaibaiPhoneCommand(normalizedText))\n                return [];\n            const assistantMessageId = Number(message?.message_id);\n            const parsed = [];\n            const commandMatches = normalizedText.matchAll(/([a-zA-Z]+\\.[a-zA-Z]+)\\(([\\s\\S]*?)\\);/g);\n            let commandIndex = 0;\n            for (const match of commandMatches) {\n                commandIndex++;\n                const commandName = String(match[1] || '')\n                    .trim()\n                    .toLowerCase();\n                if (commandName !== 'qq.private' && commandName !== 'qq.group')\n                    continue;\n                const args = parseBaibaiCommandArgs(String(match[2] || ''));\n                if (args.length < 4)\n                    continue;\n                const contactId = sanitizePhoneSpeakText(args[0]) || '';\n                const senderName = sanitizePhoneSpeakText(args[1]);\n                if (!senderName || isBaibaiUserSender(senderName))\n                    continue;\n                const textPayloads = extractBaibaiTextPayloads(args[2]);\n                if (textPayloads.length === 0)\n                    continue;\n                const rawTime = sanitizePhoneSpeakText(args[3]);\n                const messageIdPart = Number.isFinite(assistantMessageId) ? String(assistantMessageId) : 'unknown';\n                textPayloads.forEach((text, index) => {\n                    const speakText = sanitizePhoneSpeakText(text);\n                    if (!speakText)\n                        return;\n                    parsed.push({\n                        contactId,\n                        message: {\n                            id: `baibai_${messageIdPart}_${commandIndex}_${index}`,\n                            sender: 'contact',\n                            type: 'text',\n                            content: speakText,\n                            time: rawTime || messageIdPart,\n                        },\n                    });\n                });\n            }\n            return parsed;\n        }\n        function markExistingBaibaiMessagesAsSeen() {\n            const messages = getAssistantChatMessages();\n            for (const item of messages) {\n                const messageId = Number(item?.message_id);\n                if (!Number.isFinite(messageId) || messageId < 0)\n                    continue;\n                rememberBaibaiAssistantMessageId(messageId);\n            }\n        }\n        function collectUnsyncedBaibaiMessages() {\n            const messages = getAssistantChatMessages();\n            if (messages.length === 0)\n                return;\n            for (const item of messages) {\n                const messageId = Number(item?.message_id);\n                if (!Number.isFinite(messageId) || messageId < 0)\n                    continue;\n                if (baibaiSeenAssistantIds.has(messageId))\n                    continue;\n                rememberBaibaiAssistantMessageId(messageId);\n                const parsedMessages = parseBaibaiPhoneMessagesFromAssistant(item);\n                for (const parsed of parsedMessages) {\n                    enqueuePhoneMessageForTTS(parsed.contactId, parsed.message, 'baibai');\n                }\n            }\n        }\n        async function waitForTTSIdle(timeoutMs = 45000) {\n            const startAt = Date.now();\n            while (TTSManager.isLoading || TTSManager.isPlaying) {\n                if (Date.now() - startAt > timeoutMs) {\n                    TTSManager.stop();\n                    return;\n                }\n                await new Promise((resolve) => {\n                    window.setTimeout(resolve, 120);\n                });\n            }\n        }\n        async function drainPhoneTTSQueue() {\n            if (phoneTtsQueueRunning)\n                return;\n            phoneTtsQueueRunning = true;\n            try {\n                while (phoneTtsQueue.length > 0) {\n                    const next = phoneTtsQueue.shift();\n                    if (!next)\n                        continue;\n                    const ttsEnabled = getTTSEnabled();\n                    const autoPlay = !!settings.value.ttsAutoPlay;\n                    const phoneAutoRead = isPhoneAutoReadEnabled(next.source);\n                    if (!ttsEnabled || !autoPlay || !phoneAutoRead)\n                        continue;\n                    const speakText = extractPhoneSpeakText(next.message);\n                    if (!speakText)\n                        continue;\n                    const contactName = getPhoneContactName(next.source, next.contactId);\n                    const speaker = getCurrentCharacterId();\n                    const voiceName = String(settings.value.ttsDefaultSpeaker || '').trim();\n                    const ttsOverrides = {};\n                    if (voiceName)\n                        ttsOverrides.speaker = voiceName;\n                    const contextPrefix = next.source === 'baibai' ? '' : '';\n                    ttsOverrides.context = `${contextPrefix}${contactName}`;\n                    await waitForTTSIdle(45000);\n                    await TTSManager.speak({\n                        type: 'dialogue',\n                        speaker,\n                        text: speakText,\n                        tts: ttsOverrides,\n                    }, `desktop_pet_phone_${next.source}_${next.contactId}_${Date.now()}`);\n                }\n            }\n            catch (e) {\n                logError('', e);\n            }\n            finally {\n                phoneTtsQueueRunning = false;\n            }\n        }\n        function enqueuePhoneMessageForTTS(contactId, message, source = 'acsus') {\n            if (!message)\n                return;\n            if (!isNonUserPhoneMessage(message))\n                return;\n            const key = getPhoneMessageKey(source, contactId, message);\n            if (phoneSeenMessageKeys.has(key))\n                return;\n            rememberPhoneMessageKey(key);\n            const messageSec = Number(message.time || 0);\n            if (source === 'acsus' &&\n                Number.isFinite(messageSec) &&\n                messageSec > 0 &&\n                phoneTtsListenSinceSec > 0 &&\n                messageSec + 2 < phoneTtsListenSinceSec) {\n                return;\n            }\n            if (!isPhoneAutoReadEnabled(source)) {\n                return;\n            }\n            phoneTtsQueue.push({ source, contactId, message });\n            void drainPhoneTTSQueue();\n        }\n        function collectUnsyncedPhoneMessages(contactId) {\n            const history = getPhoneChatHistory(contactId);\n            if (history.length === 0)\n                return;\n            const pending = [];\n            for (let i = history.length - 1; i >= 0; i--) {\n                const message = history[i];\n                if (!isNonUserPhoneMessage(message))\n                    continue;\n                const key = getPhoneMessageKey('acsus', contactId, message);\n                if (phoneSeenMessageKeys.has(key)) {\n                    break;\n                }\n                pending.push(message);\n            }\n            pending.reverse().forEach((message) => {\n                enqueuePhoneMessageForTTS(contactId, message);\n            });\n        }\n        function bindPhoneTTSBridge() {\n            if (phoneTtsBridgeBound)\n                return;\n            phoneTtsListenSinceSec = Math.floor(Date.now() / 1000);\n            markExistingPhoneMessagesAsSeen();\n            const top = getTopWindow();\n            const topDoc = top.document ?? document;\n            phoneMessageReceivedHandler = (event) => {\n                const detail = event.detail || {};\n                const contactId = String(detail.contactId || '').trim();\n                if (!contactId)\n                    return;\n                enqueuePhoneMessageForTTS(contactId, detail.message);\n            };\n            phoneAIGenCompleteHandler = (event) => {\n                const detail = event.detail || {};\n                const contactId = String(detail.contactId || '').trim();\n                if (!contactId)\n                    return;\n                collectUnsyncedPhoneMessages(contactId);\n            };\n            topDoc.addEventListener('phone-message-received', phoneMessageReceivedHandler);\n            topDoc.addEventListener('phone-ai-generation-complete', phoneAIGenCompleteHandler);\n            phoneTtsBridgeBound = true;\n            log(' TTS ');\n        }\n        function unbindPhoneTTSBridge() {\n            if (!phoneTtsBridgeBound)\n                return;\n            const top = getTopWindow();\n            const topDoc = top.document ?? document;\n            if (phoneMessageReceivedHandler) {\n                topDoc.removeEventListener('phone-message-received', phoneMessageReceivedHandler);\n            }\n            if (phoneAIGenCompleteHandler) {\n                topDoc.removeEventListener('phone-ai-generation-complete', phoneAIGenCompleteHandler);\n            }\n            phoneMessageReceivedHandler = null;\n            phoneAIGenCompleteHandler = null;\n            phoneTtsQueue.length = 0;\n            phoneTtsQueueRunning = false;\n            phoneTtsBridgeBound = false;\n        }\n        function bindBaibaiPhoneTTSBridge() {\n            if (baibaiPhoneTtsBridgeBound)\n                return;\n            resetBaibaiAssistantSeenState();\n            markExistingBaibaiMessagesAsSeen();\n            const sync = () => {\n                collectUnsyncedBaibaiMessages();\n            };\n            const onChatChanged = () => {\n                resetBaibaiAssistantSeenState();\n                markExistingBaibaiMessagesAsSeen();\n            };\n            const eventKeys = ['GENERATION_ENDED', 'MESSAGE_UPDATED', 'MESSAGE_SWIPED'];\n            eventKeys.forEach((eventKey) => {\n                const stop = bindTavernEvent(eventKey, sync);\n                if (stop)\n                    baibaiEventStops.push(stop);\n            });\n            const chatChangedStop = bindTavernEvent('CHAT_CHANGED', onChatChanged);\n            if (chatChangedStop) {\n                baibaiEventStops.push(chatChangedStop);\n            }\n            if (baibaiEventStops.length === 0) {\n                baibaiPhonePollTimer = window.setInterval(() => {\n                    collectUnsyncedBaibaiMessages();\n                }, 1200);\n            }\n            baibaiPhoneTtsBridgeBound = true;\n            log(' TTS ');\n        }\n        function unbindBaibaiPhoneTTSBridge() {\n            if (!baibaiPhoneTtsBridgeBound)\n                return;\n            baibaiEventStops.forEach((stop) => {\n                stop.stop();\n            });\n            baibaiEventStops.length = 0;\n            if (baibaiPhonePollTimer !== null) {\n                window.clearInterval(baibaiPhonePollTimer);\n                baibaiPhonePollTimer = null;\n            }\n            resetBaibaiAssistantSeenState();\n            baibaiPhoneTtsBridgeBound = false;\n        }\n        function applyEmotionToLive2D(tag) {\n            try {\n                const model = Live2DManager.model;\n                if (!model)\n                    return false;\n                let applied = false;\n                const cfg = getEmotionConfigByTag(tag, settings.value.emotionConfigs);\n                const expression = matchLive2DExpression(model, tag, cfg?.live2dExpression);\n                if (expression) {\n                    Live2DManager.playExpression(expression);\n                    applied = true;\n                }\n                const motion = matchLive2DMotion(model, tag, cfg?.live2dMotion);\n                if (motion) {\n                    Live2DManager.playMotion(motion.group, motion.index);\n                    applied = true;\n                }\n                return applied;\n            }\n            catch (e) {\n                logError('', e);\n                return false;\n            }\n        }\n        watch(showSettings, (visible) => {\n            log(visible ? '' : '');\n        });\n        function registerGlobalOpenSettings() {\n            try {\n                const top = window.parent ?? window;\n                const fn = () => {\n                    uiStore.openSettings();\n                    log('');\n                };\n                top[OPEN_SETTINGS_FN_KEY] = fn;\n                globalOpenSettingsFn = fn;\n            }\n            catch (e) {\n                notifyInitError('', e);\n            }\n        }\n        function unregisterGlobalOpenSettings() {\n            try {\n                const top = window.parent ?? window;\n                if (globalOpenSettingsFn && top[OPEN_SETTINGS_FN_KEY] === globalOpenSettingsFn) {\n                    delete top[OPEN_SETTINGS_FN_KEY];\n                }\n            }\n            catch {\n                // ignore\n            }\n            finally {\n                globalOpenSettingsFn = null;\n            }\n        }\n        registerGlobalOpenSettings();\n        function openFunctionMenu(e) {\n            try {\n                if (navigator.vibrate) {\n                    navigator.vibrate(50);\n                }\n            }\n            catch {\n                // ignore\n            }\n            const top = getTopWindow();\n            let placement = 'right';\n            let x = e.clientX;\n            let y = e.clientY;\n            try {\n                const stageEl = top.document.getElementById('desktop-pet-stage');\n                const rect = stageEl?.getBoundingClientRect?.();\n                const vw = top.innerWidth || top.document.documentElement.clientWidth || 0;\n                if (rect && vw > 0) {\n                    placement = rect.left > vw / 2 ? 'left' : 'right';\n                    x = placement === 'left' ? rect.left - 10 : rect.right + 10;\n                    y = rect.top + rect.height * 0.5;\n                }\n                else if (vw > 0) {\n                    placement = e.clientX > vw / 2 ? 'left' : 'right';\n                }\n            }\n            catch {\n                // ignore\n            }\n            menuPlacement.value = placement;\n            menuAnchor.value = { x, y };\n            showMenu.value = true;\n        }\n        function toggleMotionLoop() {\n            const next = !settings.value.autoMotionLoop;\n            settings.value.autoMotionLoop = next;\n            Live2DManager.setAutoMotionLoopEnabled(next);\n        }\n        function cyclePersona() {\n            const personas = ['', '', '', ''];\n            const current = settings.value.commentStyle;\n            const idx = personas.indexOf(current);\n            const next = personas[(idx >= 0 ? idx + 1 : 0) % personas.length];\n            settings.value.commentStyle = next;\n            try {\n                toastr.info(`${next}`);\n            }\n            catch {\n                // ignore\n            }\n        }\n        function openModelBrowser() {\n            showMenu.value = false;\n            showModelBrowser.value = true;\n        }\n        function onModelBrowserLoad(url) {\n            settings.value.modelPath = url;\n            showModelBrowser.value = false;\n            void onModelChange(url);\n        }\n        function onManualChat(message) {\n            void Commentator.chat(message);\n        }\n        function closePet() {\n            showMenu.value = false;\n            showModelBrowser.value = false;\n            uiStore.closeSettings();\n            onBubbleHidden();\n            unbindGlobalGazeFollow(true);\n            unbindPhoneTTSBridge();\n            unbindBaibaiPhoneTTSBridge();\n            ChatMonitor.destroy();\n            Commentator.destroy();\n            Live2DManager.destroyModel();\n            Live2DStage.destroy();\n            try {\n                toastr.info('');\n            }\n            catch {\n                // ignore\n            }\n        }\n        function getStageSize(scale) {\n            const safeScale = normalizePetScale(scale);\n            return {\n                width: Math.max(1, Math.round(BASE_STAGE_WIDTH * safeScale)),\n                height: Math.max(1, Math.round(BASE_STAGE_HEIGHT * safeScale)),\n            };\n        }\n        function normalizePetScale(value) {\n            const parsed = typeof value === 'number' ? value : Number(value);\n            if (!Number.isFinite(parsed))\n                return DEFAULTS.PET_SCALE;\n            return Math.max(0.1, Math.min(3, parsed));\n        }\n        function clearModelLoadingHideTimer() {\n            if (modelLoadingHideTimer === null)\n                return;\n            window.clearTimeout(modelLoadingHideTimer);\n            modelLoadingHideTimer = null;\n        }\n        function clearStatusCheckTimer() {\n            if (statusCheckTimer === null)\n                return;\n            window.clearTimeout(statusCheckTimer);\n            statusCheckTimer = null;\n        }\n        function clearViewportResizeSyncTimer() {\n            if (viewportResizeSyncTimer === null)\n                return;\n            window.clearTimeout(viewportResizeSyncTimer);\n            viewportResizeSyncTimer = null;\n        }\n        function clearGazeFollowRaf() {\n            if (gazeFollowRafId === null)\n                return;\n            const top = getTopWindow();\n            try {\n                top.cancelAnimationFrame(gazeFollowRafId);\n            }\n            catch {\n                // ignore\n            }\n            gazeFollowRafId = null;\n        }\n        function isGazePointerTypeSupported(pointerType) {\n            return pointerType === 'mouse' || pointerType === 'pen';\n        }\n        function scheduleGazeFollow(clientX, clientY) {\n            if (!Number.isFinite(clientX) || !Number.isFinite(clientY))\n                return;\n            gazePendingPoint = { x: clientX, y: clientY };\n            if (gazeFollowRafId !== null)\n                return;\n            const top = getTopWindow();\n            gazeFollowRafId = top.requestAnimationFrame(() => {\n                gazeFollowRafId = null;\n                const point = gazePendingPoint;\n                gazePendingPoint = null;\n                if (!point)\n                    return;\n                if (settings.value.gazeFollowMouseEnabled === false)\n                    return;\n                if (Live2DStage.isPreviewMounted())\n                    return;\n                Live2DManager.focusByClientPoint(point.x, point.y, false);\n            });\n        }\n        function bindGlobalGazeFollow() {\n            if (gazeFollowBound)\n                return;\n            const top = getTopWindow();\n            const topDoc = top.document ?? document;\n            const handlePointerEvent = (event) => {\n                if (!isGazePointerTypeSupported(event.pointerType))\n                    return;\n                scheduleGazeFollow(event.clientX, event.clientY);\n            };\n            gazePointerMoveHandler = handlePointerEvent;\n            gazePointerDownHandler = handlePointerEvent;\n            topDoc.addEventListener('pointermove', gazePointerMoveHandler, { passive: true });\n            topDoc.addEventListener('pointerdown', gazePointerDownHandler, { passive: true });\n            gazeFollowBound = true;\n        }\n        function unbindGlobalGazeFollow(resetFocus = true) {\n            clearGazeFollowRaf();\n            gazePendingPoint = null;\n            const top = getTopWindow();\n            const topDoc = top.document ?? document;\n            if (gazePointerMoveHandler) {\n                topDoc.removeEventListener('pointermove', gazePointerMoveHandler);\n            }\n            if (gazePointerDownHandler) {\n                topDoc.removeEventListener('pointerdown', gazePointerDownHandler);\n            }\n            gazePointerMoveHandler = null;\n            gazePointerDownHandler = null;\n            gazeFollowBound = false;\n            if (resetFocus) {\n                Live2DManager.focusCenter(true);\n            }\n        }\n        function syncGazeFollowBinding() {\n            if (settings.value.gazeFollowMouseEnabled === false) {\n                unbindGlobalGazeFollow(true);\n                return;\n            }\n            bindGlobalGazeFollow();\n        }\n        function syncStageAfterViewportResize(reason) {\n            if (Live2DStage.isPreviewMounted())\n                return;\n            const stageSize = getStageSize(settings.value.petScale);\n            const recoverOnce = (label) => {\n                Live2DStage.resizeFloating(stageSize.width, stageSize.height);\n                const top = getTopWindow();\n                const stageEl = top.document.getElementById('desktop-pet-stage');\n                if (stageEl) {\n                    stageEl.style.display = 'block';\n                    stageEl.style.visibility = 'visible';\n                    stageEl.style.opacity = '1';\n                    stageEl.style.zIndex = '10000';\n                }\n                const stage = Live2DStage.getStage();\n                const hasModelOnStage = !!stage && stage.children.length > 0;\n                if (hasModelOnStage) {\n                    Live2DManager.updateScale(stageSize.width, stageSize.height, 1);\n                    log(`Viewport resize recovery synced model (${label})`);\n                    return;\n                }\n                Live2DManager.mountToStage(stageSize.width, stageSize.height, 1);\n                log(`Viewport resize recovery remounted model (${label})`);\n            };\n            recoverOnce(`${reason}-pass1`);\n            window.setTimeout(() => {\n                if (Live2DStage.isPreviewMounted())\n                    return;\n                recoverOnce(`${reason}-pass2`);\n            }, 220);\n            scheduleStatusCheck(`${reason}-recover`);\n        }\n        function scheduleViewportResizeSync(reason) {\n            clearViewportResizeSyncTimer();\n            viewportResizeSyncTimer = window.setTimeout(() => {\n                viewportResizeSyncTimer = null;\n                syncStageAfterViewportResize(reason);\n            }, 160);\n        }\n        function bindViewportResizeRecovery() {\n            const top = getTopWindow();\n            boundWindowResizeHandler = () => {\n                scheduleViewportResizeSync('window-resize');\n            };\n            try {\n                top.addEventListener('resize', boundWindowResizeHandler, { passive: true });\n            }\n            catch (e) {\n                logError('Failed to bind window.resize listener', e);\n                boundWindowResizeHandler = null;\n            }\n            const viewport = top.visualViewport;\n            if (!viewport)\n                return;\n            boundVisualViewportResizeHandler = () => {\n                scheduleViewportResizeSync('visual-viewport-resize');\n            };\n            try {\n                viewport.addEventListener('resize', boundVisualViewportResizeHandler, { passive: true });\n            }\n            catch (e) {\n                logError('Failed to bind visualViewport.resize listener', e);\n                boundVisualViewportResizeHandler = null;\n            }\n        }\n        function unbindViewportResizeRecovery() {\n            const top = getTopWindow();\n            if (boundWindowResizeHandler) {\n                try {\n                    top.removeEventListener('resize', boundWindowResizeHandler);\n                }\n                catch {\n                    // ignore\n                }\n                boundWindowResizeHandler = null;\n            }\n            const viewport = top.visualViewport;\n            if (viewport && boundVisualViewportResizeHandler) {\n                try {\n                    viewport.removeEventListener('resize', boundVisualViewportResizeHandler);\n                }\n                catch {\n                    // ignore\n                }\n                boundVisualViewportResizeHandler = null;\n            }\n        }\n        function renderModelLoadProgress(progress) {\n            const percent = Math.max(0, Math.min(100, Math.round(progress.percent)));\n            Live2DStage.showLoadingProgress(percent, progress.message);\n        }\n        function notifyInitError(message, err) {\n            logError(message, err);\n            try {\n                toastr.error(message);\n            }\n            catch {\n                // ignore\n            }\n        }\n        async function loadModelWithProgress(path) {\n            const taskId = ++modelLoadTaskId;\n            clearModelLoadingHideTimer();\n            renderModelLoadProgress({ percent: 0, message: '' });\n            const loaded = await Live2DManager.loadModel(path, (progress) => {\n                if (taskId !== modelLoadTaskId)\n                    return;\n                renderModelLoadProgress(progress);\n            });\n            if (taskId !== modelLoadTaskId) {\n                return loaded;\n            }\n            renderModelLoadProgress({\n                percent: 100,\n                message: loaded ? '' : '',\n            });\n            modelLoadingHideTimer = window.setTimeout(() => {\n                if (taskId !== modelLoadTaskId)\n                    return;\n                Live2DStage.hideLoadingProgress();\n                modelLoadingHideTimer = null;\n            }, loaded ? 400 : 15000);\n            return loaded;\n        }\n        function scheduleStatusCheck(reason) {\n            clearStatusCheckTimer();\n            statusCheckTimer = window.setTimeout(() => {\n                try {\n                    const top = window.parent ?? window;\n                    const stageEl = top.document.getElementById('desktop-pet-stage');\n                    const rect = stageEl?.getBoundingClientRect?.();\n                    const rectSummary = rect\n                        ? `${Math.round(rect.left)},${Math.round(rect.top)} ${Math.round(rect.width)}x${Math.round(rect.height)}`\n                        : 'none';\n                    const pixiVersion = String(top.PIXI?.VERSION || '').trim() || 'none';\n                    const hasLive2d = !!top.PIXI?.live2d?.Live2DModel;\n                    const hasModel = !!Live2DManager.model;\n                    const stageChildren = (Live2DStage.getStage()?.children?.length ?? 0);\n                    const stageVisible = !!rect &&\n                        rect.width > 10 &&\n                        rect.height > 10 &&\n                        rect.bottom > 0 &&\n                        rect.right > 0 &&\n                        rect.top < (top.innerHeight || 0) &&\n                        rect.left < (top.innerWidth || 0);\n                    if (stageVisible && hasLive2d && hasModel && stageChildren > 0) {\n                        statusCheckTimer = null;\n                        return;\n                    }\n                    if (stageEl) {\n                        const prevOutline = stageEl.style.outline;\n                        const prevBackground = stageEl.style.background;\n                        const prevZIndex = stageEl.style.zIndex;\n                        stageEl.style.outline = '2px dashed rgba(245, 158, 11, 0.95)';\n                        stageEl.style.background = 'rgba(245, 158, 11, 0.08)';\n                        stageEl.style.zIndex = '2147483647';\n                        window.setTimeout(() => {\n                            if (!stageEl?.ownerDocument?.documentElement?.contains(stageEl))\n                                return;\n                            stageEl.style.outline = prevOutline;\n                            stageEl.style.background = prevBackground;\n                            stageEl.style.zIndex = prevZIndex;\n                        }, 10000);\n                    }\n                    const message = `(${reason}) ` +\n                        `stage=${!!stageEl} rect=${rectSummary} visible=${stageVisible} ` +\n                        `pixi=${pixiVersion} live2d=${hasLive2d} model=${hasModel} children=${stageChildren}`;\n                    try {\n                        toastr.warning(message);\n                    }\n                    catch {\n                        // ignore\n                    }\n                }\n                catch (e) {\n                    notifyInitError('', e);\n                }\n                finally {\n                    statusCheckTimer = null;\n                }\n            }, 2500);\n        }\n        async function initPet() {\n            try {\n                log('');\n                const s = settings.value;\n                try {\n                    setLipSyncRefs({\n                        getProxiedAudioUrl: (url) => TTSManager._getProxiedAudioUrl(url),\n                    });\n                    TTSManager.init();\n                }\n                catch (e) {\n                    logError('TTS ', e);\n                }\n                bindPhoneTTSBridge();\n                bindBaibaiPhoneTTSBridge();\n                Commentator.setCallback((text, isDone) => {\n                    const parsed = parseEmotionCotText(text, {\n                        enabled: !!settings.value.emotionCotEnabled,\n                        stripFromText: settings.value.emotionCotStripFromText !== false,\n                        configs: settings.value.emotionConfigs,\n                    });\n                    bubbleText.value = parsed.cleanText;\n                    bubbleDone.value = isDone;\n                    if (!isDone)\n                        return;\n                    const finalText = String(parsed.cleanText || '').trim();\n                    if (!finalText)\n                        return;\n                    if (parsed.normalizedTag) {\n                        const applied = applyEmotionToLive2D(parsed.normalizedTag);\n                        if (!applied) {\n                            Live2DManager.playRandomAnimation();\n                        }\n                    }\n                    else {\n                        Live2DManager.playRandomAnimation();\n                    }\n                    const ttsEnabled = getTTSEnabled();\n                    const autoPlay = !!settings.value.ttsAutoPlay;\n                    const tagLabel = parsed.normalizedTag || '(none)';\n                    log(`TTS: enabled=${ttsEnabled}, autoPlay=${autoPlay}, tag=${tagLabel}, textLen=${finalText.length}`);\n                    if (!ttsEnabled)\n                        return;\n                    if (!autoPlay)\n                        return;\n                    const speaker = getCurrentCharacterId();\n                    const voiceName = String(settings.value.ttsDefaultSpeaker || '').trim();\n                    let context = String(parsed.context || '').trim();\n                    if (!context && parsed.normalizedTag) {\n                        const cfg = getEmotionConfigByTag(parsed.normalizedTag, settings.value.emotionConfigs);\n                        context = String(cfg?.ttsContext || '').trim();\n                    }\n                    log(`: speaker=${speaker}, voice=${voiceName || ''}, context=${context || ''}`);\n                    void (async () => {\n                        try {\n                            TTSManager.stop();\n                            const ttsOverrides = {};\n                            if (voiceName)\n                                ttsOverrides.speaker = voiceName;\n                            if (context)\n                                ttsOverrides.context = context;\n                            await TTSManager.speak({\n                                type: 'dialogue',\n                                speaker,\n                                text: finalText,\n                                tts: Object.keys(ttsOverrides).length > 0 ? ttsOverrides : undefined,\n                            }, `desktop_pet_comment_${Date.now()}`);\n                        }\n                        catch (e) {\n                            logError('', e);\n                        }\n                    })();\n                });\n                const ready = await Live2DManager.init();\n                if (!ready) {\n                    notifyInitError('Live2D SDK  CDN ');\n                    return;\n                }\n                log('Live2D SDK ');\n                Live2DManager.setAutoMotionLoopEnabled(s.autoMotionLoop);\n                const initialScale = normalizePetScale(s.petScale);\n                if (initialScale !== s.petScale) {\n                    settings.value.petScale = initialScale;\n                }\n                const stageSize = getStageSize(initialScale);\n                const created = Live2DStage.create({\n                    width: stageSize.width,\n                    height: stageSize.height,\n                    position: { x: s.petPosition.x, y: s.petPosition.y },\n                    scale: initialScale,\n                    onPositionChange: (x, y) => {\n                        settings.value.petPosition = { x, y };\n                    },\n                    onScaleChange: (scale) => {\n                        const safeScale = normalizePetScale(scale);\n                        if (safeScale !== settings.value.petScale) {\n                            settings.value.petScale = safeScale;\n                        }\n                    },\n                    onTap: (_e) => {\n                        log(' ->  LLM');\n                        Live2DManager.playRandomAnimation();\n                    },\n                    onDoubleTap: (_e) => {\n                        const motionEnabled = settings.value.doubleTapRandomMotionEnabled !== false;\n                        log(motionEnabled ? ' ->  + ' : ' -> ');\n                        ChatMonitor.manualTrigger();\n                        if (motionEnabled) {\n                            Live2DManager.playRandomAnimation();\n                        }\n                    },\n                    onLongPress: (_e) => {\n                        log(' -> ');\n                        openFunctionMenu(_e);\n                    },\n                });\n                if (!created) {\n                    notifyInitError('Live2D  WebGL ');\n                    return;\n                }\n                log('Live2D ');\n                const loaded = await loadModelWithProgress(s.modelPath);\n                if (loaded) {\n                    Live2DManager.mountToStage(stageSize.width, stageSize.height, 1);\n                    log('Live2D ');\n                }\n                else {\n                    notifyInitError('Live2D  CDN');\n                }\n                ChatMonitor.init({\n                    autoTrigger: s.autoTrigger,\n                    triggerInterval: s.triggerInterval,\n                    triggerProbability: s.triggerProbability,\n                    commentTriggerMode: s.commentTriggerMode,\n                }, () => {\n                    void Commentator.generate();\n                });\n                log('');\n                scheduleStatusCheck('init');\n            }\n            catch (e) {\n                notifyInitError('', e);\n            }\n        }\n        async function onModelChange(path) {\n            const loaded = await loadModelWithProgress(path);\n            if (loaded) {\n                const stageSize = getStageSize(settings.value.petScale);\n                Live2DManager.mountToStage(stageSize.width, stageSize.height, 1);\n            }\n            scheduleStatusCheck('model-change');\n        }\n        function onBubbleHidden() {\n            bubbleText.value = '';\n            bubbleDone.value = true;\n        }\n        watch(() => ({\n            autoTrigger: settings.value.autoTrigger,\n            triggerInterval: settings.value.triggerInterval,\n            triggerProbability: settings.value.triggerProbability,\n            commentTriggerMode: settings.value.commentTriggerMode,\n        }), (config) => {\n            ChatMonitor.updateConfig(config);\n        });\n        watch(() => settings.value.autoMotionLoop, (enabled) => {\n            Live2DManager.setAutoMotionLoopEnabled(enabled);\n        });\n        watch(() => settings.value.gazeFollowMouseEnabled, () => {\n            syncGazeFollowBinding();\n        });\n        watch(() => settings.value.petScale, (scale) => {\n            const safeScale = normalizePetScale(scale);\n            if (safeScale !== scale) {\n                settings.value.petScale = safeScale;\n                return;\n            }\n            const stageSize = getStageSize(safeScale);\n            Live2DStage.resizeFloating(stageSize.width, stageSize.height);\n            if (!Live2DStage.isPreviewMounted()) {\n                Live2DManager.updateScale(stageSize.width, stageSize.height, 1);\n            }\n        });\n        onMounted(() => {\n            bindViewportResizeRecovery();\n            syncGazeFollowBinding();\n            initPet();\n        });\n        onUnmounted(() => {\n            unbindViewportResizeRecovery();\n            unbindGlobalGazeFollow(true);\n            unregisterGlobalOpenSettings();\n            unbindPhoneTTSBridge();\n            unbindBaibaiPhoneTTSBridge();\n            modelLoadTaskId++;\n            clearModelLoadingHideTimer();\n            clearStatusCheckTimer();\n            clearViewportResizeSyncTimer();\n            Live2DStage.hideLoadingProgress();\n            ChatMonitor.destroy();\n            Commentator.destroy();\n            try {\n                TTSManager.stop();\n                LipSyncManager.cleanup();\n            }\n            catch {\n                // ignore\n            }\n            Live2DManager.destroyModel();\n            Live2DStage.destroy();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", null, [\n                _createVNode(ChatBubble, {\n                    text: bubbleText.value,\n                    \"is-done\": bubbleDone.value,\n                    \"auto-close-delay-seconds\": _unref(settings).bubbleDuration,\n                    onHidden: onBubbleHidden\n                }, null, 8 /* PROPS */, [\"text\", \"is-done\", \"auto-close-delay-seconds\"]),\n                _createVNode(SettingsPanel, {\n                    visible: _unref(showSettings),\n                    onClose: _cache[0] || (_cache[0] = ($event) => (_unref(uiStore).closeSettings())),\n                    onModelChange: onModelChange\n                }, null, 8 /* PROPS */, [\"visible\"]),\n                _createVNode(FunctionMenu, {\n                    visible: showMenu.value,\n                    x: menuAnchor.value.x,\n                    y: menuAnchor.value.y,\n                    placement: menuPlacement.value,\n                    \"motion-loop-enabled\": _unref(settings).autoMotionLoop,\n                    \"comment-style\": _unref(settings).commentStyle,\n                    onClose: _cache[1] || (_cache[1] = ($event) => (showMenu.value = false)),\n                    onSendChat: onManualChat,\n                    onToggleMotionLoop: toggleMotionLoop,\n                    onSwitchModel: openModelBrowser,\n                    onSwitchPersona: cyclePersona,\n                    onCloseModel: closePet\n                }, null, 8 /* PROPS */, [\"visible\", \"x\", \"y\", \"placement\", \"motion-loop-enabled\", \"comment-style\"]),\n                (showModelBrowser.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"browser-overlay\",\n                        onClick: _cache[4] || (_cache[4] = _withModifiers(($event) => (showModelBrowser.value = false), [\"self\"]))\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_1, [\n                            _createElementVNode(\"div\", _hoisted_2, [\n                                _cache[5] || (_cache[5] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-btn\",\n                                    onClick: _cache[2] || (_cache[2] = ($event) => (showModelBrowser.value = false))\n                                }, \"\")\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_3, [\n                                _createVNode(ModelBrowser, {\n                                    \"use-cdn\": _unref(settings).useCdn,\n                                    onCancel: _cache[3] || (_cache[3] = ($event) => (showModelBrowser.value = false)),\n                                    onLoadModel: onModelBrowserLoad\n                                }, null, 8 /* PROPS */, [\"use-cdn\"])\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./PetContainer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./PetContainer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./PetContainer.vue?vue&type=style&index=0&id=104a329c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-104a329c\"]])\n\nexport default __exports__","/**\n *  iframe  <head> \n *  jQuery  Vue  DOM \n */\nexport function teleport_style(): void {\n  // /\n  deteleport_style();\n  $(`<div>`)\n    .attr('script_id', getScriptId())\n    .append($(`head > style`, document).clone())\n    .appendTo('head');\n}\n\n/**\n * \n */\nexport function deteleport_style(): void {\n  $(`head > div[script_id=\"${getScriptId()}\"]`).remove();\n}\n","import { createApp } from 'vue';\nimport { createPinia } from 'pinia';\nimport PetContainer from './ui/PetContainer.vue';\nimport { ChatMonitor } from './chat/monitor';\nimport { teleport_style, deteleport_style } from './utils/style-teleport';\nimport { error as logError, log, warn } from './utils/dom';\nimport { SCRIPT_NAME } from './core/constants';\nimport { useUiStore } from './core/ui';\n\nconst BUILD_TAG = '20260215.04';\nconst LEGACY_MENU_BUTTON_LABELS = new Set(['', '']);\nconst SETTINGS_LABEL = '';\nconst OPEN_SETTINGS_FN_KEY = '__desktopPetOpenSettings_v2';\n\n// Pinia  $(() => {}) \nconst pinia = createPinia();\nconst uiStore = useUiStore(pinia);\nconst EXTENSIONS_MENU_CONTAINER_ID = 'desktop-pet-settings-menu-container';\nconst EXTENSIONS_MENU_ITEM_ID = 'desktop-pet-settings-menu-item';\nconst EXTENSIONS_MENU_CLICK_NAMESPACE = '.desktopPetSettingsMenu';\n\nlet extensionsMenuRetryTimer: number | null = null;\n\nfunction getParentDocument(): Document {\n  try {\n    return window.parent?.document ?? document;\n  } catch {\n    return document;\n  }\n}\n\nfunction getTopWindow(): Window {\n  return window.parent ?? window;\n}\n\nfunction bindExtensionsMenuDelegation(parentDoc: Document): void {\n  const clickEvent = `click${EXTENSIONS_MENU_CLICK_NAMESPACE}`;\n  $(parentDoc).off(clickEvent, `#${EXTENSIONS_MENU_ITEM_ID}`);\n  $(parentDoc).on(clickEvent, `#${EXTENSIONS_MENU_ITEM_ID}`, (event) => {\n    void onExtensionsMenuItemClick(event as unknown as JQuery.ClickEvent);\n  });\n}\n\nfunction clearExtensionsMenuRetryTimer(): void {\n  if (extensionsMenuRetryTimer !== null) {\n    window.clearTimeout(extensionsMenuRetryTimer);\n    extensionsMenuRetryTimer = null;\n  }\n}\n\nfunction scheduleExtensionsMenuInjection(): void {\n  if (extensionsMenuRetryTimer !== null) {\n    return;\n  }\n\n  extensionsMenuRetryTimer = window.setTimeout(() => {\n    extensionsMenuRetryTimer = null;\n    injectExtensionsMenuItem();\n  }, 1000);\n}\n\nasync function onExtensionsMenuItemClick(event: JQuery.ClickEvent): Promise<void> {\n  event.stopPropagation();\n  log('');\n\n  const parentDoc = getParentDocument();\n  const $extensionsMenu = $('#extensionsMenu', parentDoc);\n  const $extensionsMenuButton = $('#extensionsMenuButton', parentDoc);\n\n  if ($extensionsMenuButton.length > 0 && $extensionsMenu.is(':visible')) {\n    $extensionsMenuButton.trigger('click');\n    await new Promise<void>((resolve) => {\n      window.setTimeout(resolve, 120);\n    });\n  }\n\n  const top = getTopWindow() as any;\n  const openSettings = top?.[OPEN_SETTINGS_FN_KEY];\n  if (typeof openSettings === 'function') {\n    openSettings();\n    log('');\n  } else {\n    uiStore.openSettings();\n    log(` Pinia  (showSettings=${String(uiStore.showSettings)})`);\n  }\n\n  window.setTimeout(() => {\n    try {\n      const overlay = parentDoc.querySelector('#desktop-pet-app .settings-overlay') as HTMLElement | null;\n      const rect = overlay?.getBoundingClientRect?.();\n      const summary = rect\n        ? `${Math.round(rect.left)},${Math.round(rect.top)} ${Math.round(rect.width)}x${Math.round(rect.height)}`\n        : 'none';\n      const style = overlay ? (window.getComputedStyle(overlay) as CSSStyleDeclaration) : null;\n      const styleSummary = style\n        ? `position=${style.position} display=${style.display} width=${style.width} height=${style.height}`\n        : 'style=none';\n      log(` DOM : overlay=${!!overlay} rect=${summary} ${styleSummary}`);\n    } catch (e) {\n      warn(' DOM ', e);\n    }\n  }, 0);\n}\n\nfunction injectExtensionsMenuItem(): void {\n  const parentDoc = getParentDocument();\n  const $extensionsMenu = $('#extensionsMenu', parentDoc);\n\n  if ($extensionsMenu.length === 0) {\n    scheduleExtensionsMenuInjection();\n    return;\n  }\n\n  bindExtensionsMenuDelegation(parentDoc);\n  const $existingItem = $(`#${EXTENSIONS_MENU_ITEM_ID}`, parentDoc);\n  if ($existingItem.length > 0) {\n    return;\n  }\n\n  const $container = $(\n    `<div class=\"extension_container interactable\" id=\"${EXTENSIONS_MENU_CONTAINER_ID}\" tabindex=\"0\"></div>`,\n  );\n\n  const $item = $(\n    `<div class=\"list-group-item flex-container flexGap5 interactable\" id=\"${EXTENSIONS_MENU_ITEM_ID}\" title=\"${SETTINGS_LABEL}\"><div class=\"fa-fw fa-solid fa-paw extensionsMenuExtensionButton\"></div><span>${SETTINGS_LABEL}</span></div>`,\n  );\n\n  $container.append($item);\n  $extensionsMenu.append($container);\n}\n\nfunction removeExtensionsMenuItem(): void {\n  clearExtensionsMenuRetryTimer();\n\n  const parentDoc = getParentDocument();\n  const clickEvent = `click${EXTENSIONS_MENU_CLICK_NAMESPACE}`;\n  $(parentDoc).off(clickEvent, `#${EXTENSIONS_MENU_ITEM_ID}`);\n  $(`#${EXTENSIONS_MENU_CONTAINER_ID}`, parentDoc).remove();\n}\n\nfunction removeLegacyMenuButtons(): void {\n  try {\n    const parentDoc = getParentDocument();\n    $('.qr--button.menu_button.interactable', parentDoc)\n      .filter((_idx, el) => LEGACY_MENU_BUTTON_LABELS.has(String($(el).text() || '').trim()))\n      .remove();\n  } catch (e) {\n    warn('', e);\n  }\n}\n\n$(() => {\n  // \n  teleport_style();\n\n  try {\n    log(`(${BUILD_TAG})`);\n    removeLegacyMenuButtons();\n    window.setTimeout(() => {\n      removeLegacyMenuButtons();\n    }, 1200);\n\n    //  Vue \n    try {\n      const parentDoc = getParentDocument();\n      $('#desktop-pet-app', parentDoc).remove();\n    } catch {\n      // ignore\n    }\n    const $app = $('<div id=\"desktop-pet-app\">').appendTo('body');\n    const app = createApp(PetContainer);\n    app.use(pinia);\n    app.config.errorHandler = (err, _instance, info) => {\n      logError(`Vue error: ${info}`, err);\n    };\n    app.config.warnHandler = (msg, _instance, trace) => {\n      warn(`Vue warn: ${msg}${trace ? `\\n${trace}` : ''}`);\n    };\n    app.mount($app[0]);\n    injectExtensionsMenuItem();\n\n    toastr.success(`${SCRIPT_NAME}(${BUILD_TAG})`);\n    log(`(${BUILD_TAG})`);\n\n    // \n    let chatId = SillyTavern.getCurrentChatId();\n    eventOn(tavern_events.CHAT_CHANGED, (newChatId: string) => {\n      if (chatId !== newChatId) {\n        chatId = newChatId;\n        ChatMonitor.resetState();\n      }\n    });\n  } catch (e) {\n    logError('', e);\n    toastr.error(`${SCRIPT_NAME}(${BUILD_TAG})`);\n    $('#desktop-pet-app').remove();\n  }\n});\n\n$(window).on('pagehide', () => {\n  removeLegacyMenuButtons();\n  removeExtensionsMenuItem();\n  deteleport_style();\n  $('#desktop-pet-app').remove();\n  $('#desktop-pet-stage').remove();\n});\n"],"names":["content","__esModule","default","module","id","locals","exports","add","cssWithMappingToString","list","toString","this","map","item","needLayer","concat","length","join","i","modules","media","dedupe","supports","layer","undefined","alreadyImportedModules","k","_k","push","___CSS_LOADER_EXPORT___","sfc","props","target","__vccOpts","key","val","listToStyles","parentId","styles","newStyles","part","css","sourceMap","parts","hasDocument","document","DEBUG","Error","stylesInDom","head","getElementsByTagName","singletonElement","singletonCounter","isProduction","noop","options","ssrIdKey","isOldIE","navigator","test","userAgent","toLowerCase","addStylesClient","_isProduction","_options","addStylesToDom","newList","mayRemove","domStyle","refs","j","addStyle","createStyleElement","styleElement","createElement","type","appendChild","obj","update","remove","querySelector","parentNode","removeChild","styleIndex","applyToSingletonTag","bind","applyToTag","newObj","textStore","replaceText","index","replacement","filter","Boolean","styleSheet","cssText","cssNode","createTextNode","childNodes","insertBefore","setAttribute","ssrId","sources","btoa","unescape","encodeURIComponent","JSON","stringify","firstChild","cssMapping","base64","data","sourceMapping","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","d","a","definition","o","Object","defineProperty","enumerable","get","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","Vue","SDK_URLS","RECOMMENDED_MODELS","name","path","COMMENT_STYLES","COMMENT_TRIGGER_MODE_OPTIONS","label","EMOTION_TAGS","API_SOURCES","EIKANYA_CDN_BASE","EIKANYA_RAW_BASE","DEFAULTS","x","y","z","isRecord","Array","isArray","EMOTION_TAG_SET","Set","asEmotionTag","s","String","trim","has","DEFAULT_ALIASES","dedupAliases","aliases","out","seen","raw","trimmed","createDefaultEmotionConfigs","tag","ttsContext","live2dExpression","live2dMotion","enabled","group","normalizeEmotionConfigs","byTag","Map","live2dMotionRaw","indexRaw","Number","isFinite","Math","max","floor","cfg","v","set","defaults","def","getEmotionConfigByTag","configs","resolveEmotionTag","rawTag","direct","needle","alias","getTargetConsole","top","window","parent","console","log","args","warn","error","deleteAtPath","current","last","parseSettings","rawObject","first","SettingsSchema","safeParse","success","cleaned","issue","issues","second","parse","object","apiMode","enum","apiConfig","url","string","apiKey","model","source","max_tokens","number","min","temperature","frequency_penalty","presence_penalty","top_p","top_k","usePresetSampling","boolean","sendWorldInfo","modelPath","useCdn","petPosition","petScale","autoMotionLoop","doubleTapRandomMotionEnabled","gazeFollowMouseEnabled","commentStyle","commentTriggerMode","customPrompt","roleplayName","roleplayIgnoreCommentStyle","sendCharacterCardContent","autoTrigger","triggerInterval","triggerProbability","maxChatContext","bubbleDuration","useTamakoTodaySpecial","useDiceDatabaseReference","diceReferenceVisibleSheets","array","emotionCotEnabled","emotionCotStripFromText","emotionConfigs","ttsProvider","ttsAutoPlay","phoneMessageAutoRead","baibaiPhoneMessageAutoRead","ttsDefaultSpeaker","lipSyncManualParamsEnabled","lipSyncManualParamIds","gptSoVits","apiUrl","endpoint","useCorsProxy","mediaType","streamingMode","textLang","textSplitMethod","speedFactor","strictWeightSwitch","probeOnAudioError","modelSwitchMode","setModelEndpoint","importPathPrefix","voices","desc","refAudioPath","promptText","promptLang","gptWeightsPath","sovitsWeightsPath","useSettingsStore","parsed","getVariables","script_id","getScriptId","includes","rawBubbleDuration","bubbleDurationSeconds","round","settings","ref","watchEffect","replaceVariables","updateSettings","partial","resetSettings","next","EDGE_BASE_URL","TRUSTED_CLIENT_TOKEN","WSS_URL","VOICE_LIST_URL","clockSkewSeconds","EDGE_FALLBACK_SHORT_VOICES","shortName","locale","gender","toAbortError","message","DOMException","err","buildConnectionId","bytes","Uint8Array","globalThis","crypto","getRandomValues","random","from","b","padStart","removeIncompatibleCharacters","text","code","charCodeAt","getVoiceName","voice","async","toSha256HexUpper","TextEncoder","encode","subtle","digest","toUpperCase","K","Uint32Array","H","withOneByte","paddedLength","ceil","padded","bitLength","high","low","w","offset","s0","rotateRight","s1","c","e","f","g","h","temp1","maj","word","sha256HexUpperFallback","bits","buildSecurityParamsWithReason","ticks","Date","now","SECONDS_TO_NANOSECONDS","security","secMsGec","toFixed","secMsGecVersion","mapEdgeVoice","ShortName","Locale","Gender","resourceId","FriendlyName","fetchVoicesOnce","response","fetch","headers","Accept","serverDate","date","ts","getTime","parseServerDateHeader","clientDate","ok","status","payload","json","result","sort","localeCompare","dedupeVoices","getEdgeFallbackVoices","synthesizeWithSocketUrl","socketUrl","voiceName","timestampMode","attemptLabel","timeoutMs","Promise","resolve","reject","done","ws","timeoutId","chunks","sawSocketError","sawOpen","closeCode","closeReason","closeWasClean","finish","fn","clearTimeout","onopen","onmessage","onerror","onclose","onSocket","signal","removeEventListener","onAbort","fail","close","aborted","addEventListener","once","WebSocket","binaryType","setTimeout","timestamp","mode","toISOString","replace","slice","toUTCString","dateToString","send","buildSpeechConfigMessage","requestId","ssml","buildSsmlMessage","escapedText","escapeXml","buildSsml","event","textMessage","headerEndIndex","indexOf","headerText","line","split","idx","parseHeadersFromTextMessage","Path","ArrayBuffer","isView","buffer","byteOffset","byteLength","Blob","arrayBuffer","binary","headerLength","headerBytes","TextDecoder","decode","parseHeadersAndDataFromBinaryMessage","contentType","startsWith","handleBinary","catch","reason","wasClean","merged","totalLength","reduce","sum","chunk","concatChunks","blob","TTS_PROVIDER","LITTLEWHITEBOX","GPT_SOVITS_V2","EDGE_TTS_DIRECT","getTopWindow","getStoragePrefix","getTtsEnabledKey","getCharTtsVoiceKey","normalizeGptSoVitsSwitchMode","normalizeSetModelEndpoint","getTTSProvider","getGptSoVitsConfig","assign","normalizeGptSoVitsVoice","rawCfg","speaker","ref_audio_path","ref_audio","prompt_text","prompt_lang","text_lang","gpt_weights_path","gptPath","gpt","sovits_weights_path","sovitsPath","sovits","model_switch_mode","set_model_endpoint","description","toGptSoVitsVoiceConfig","globalDefaults","normalized","globalCfg","isGptSoVitsVoiceUsable","pickFirstUsableGptSoVitsVoice","voiceList","getGptSoVitsVoiceList","_lwbTtsCache","_lwbTtsCacheTime","_edgeTtsCache","_edgeTtsCacheTime","getEdgeDirectVoiceListAsync","securityResult","urls","lastError","base","fetchEdgeVoices","fallback","getTTSVoiceListAsync","provider","getGptSoVitsVoiceListAsync","mySpeakers","cache","volc","fetchLittleWhiteBoxTTSConfig","isFreeVoice","inferResourceId","getVoiceDesc","topAny","xbTts","xiaobaixTts","getConfig","config","xbVoiceData","XB_TTS_VOICE_DATA","inferSource","scene","lower","female_1","female_2","female_3","female_4","female_5","female_6","female_7","male_1","male_2","male_3","male_4","configurable","getTTSEnabled","saved","localStorage","getItem","Live2DLoader","_READY_MARK","_RUNTIME_KEY","_JSDELIVR_HOSTS","isLoaded","loadPromise","load","_getRuntime","_doLoad","getRuntime","targetWindow","getPixi","pixi","runtime","live2dModel","_getPixiMajorVersion","PIXI","live2d","Live2DModel","_setRuntime","pixiVersion","VERSION","loadedAt","pixiMajor","detected","_loadScriptWithFallback","_hasValidCubism4Core","Live2DCubismCore","Live2D","version","majorStr","major","parseInt","_buildUrlCandidates","originalUrl","candidates","candidate","urlObj","URL","hostname","endsWith","u","pathname","owner","repoWithRef","filePath","repo","suffix","search","hash","core","hasVersion","Version","hasMoc","Moc","hasUtils","Utils","_loadScriptBySrc","timer","doc","script","src","dataset","desktopPetSdk","cleanup","onload","DEFAULT_CONFIG","longPressDelay","doubleClickWindow","moveThreshold","GestureRecognizer","element","onGesture","isDraggingCheck","state","startPos","longPressTimer","doubleClickTimer","longPressFired","moved","activePointerId","destroyed","boundPointerDown","boundPointerMove","boundPointerUp","boundContextMenu","constructor","maxTouchPoints","handlePointerDown","handlePointerMove","handlePointerUp","preventDefault","destroy","clearAllTimers","_e","pointerType","isPrimary","pointerId","clientX","clientY","clearLongPressTimer","resetState","dx","dy","sqrt","clearDoubleClickTimer","Live2DStage","app","canvas","glContext","container","mountStack","mountMode","_pendingFloatingResize","loadingOverlay","loadingText","loadingBarFill","interactionLayer","gestureRecognizer","_dragClass","_minVisiblePx","_interactionPaddingPx","_alphaHitThreshold","_maxPixelScanSamples","_onPositionChange","_boundWindowResize","_interactionSyncTimer","_pixelReadBuffer","_lastClampLogAt","_clampPosition","width","height","minVisible","_top","viewportWidth","innerWidth","documentElement","clientWidth","viewportHeight","innerHeight","clientHeight","safeWidth","safeHeight","safeMinVisibleX","safeMinVisibleY","minX","minY","maxX","maxY","safeX","safeY","clampedX","clampedY","clamped","_shouldClampCurrentPosition","hasCustom","style","right","bottom","hasExplicitLeftTop","left","_getContainerRectSize","rect","getBoundingClientRect","_isRectFullyOutsideViewport","_getVisibleAreaRatio","rectWidth","rectHeight","visibleLeft","visibleTop","visibleRight","visibleBottom","visibleArea","totalArea","_clampPositionByAxis","size","viewportSize","safeSize","safeViewport","safeMinVisible","safeValue","_clampContainerToViewport","shouldClamp","fullyOutside","visibleRatio","isResizeClamp","forceFullVisible","minVisibleX","minVisibleY","nextX","nextY","abs","to","_bindWindowResize","_unbindWindowResize","passive","_getPIXI","_measureOpaqueBoundsFromCanvas","containerWidth","containerHeight","gl","bufferWidth","drawingBufferWidth","bufferHeight","drawingBufferHeight","pixels","readPixels","RGBA","UNSIGNED_BYTE","scanStep","alphaThreshold","rowOffset","scaleX","scaleY","_syncInteractionLayerBounds","disableLayer","pointerEvents","cursor","parseFloat","applyBounds","padding","x1","y1","stage","children","alphaBounds","getBounds","bounds","fallbackWidth","fallbackHeight","_startInteractionSyncTimer","_stopInteractionSyncTimer","setInterval","clearInterval","_enablePointerDrag","$container","dragTarget","onPositionChange","startClientX","startClientY","startLeft","startTop","dragging","touchPointerIds","getRectSize","removeClass","button","getRectLeftTop","setPointerCapture","dist","addClass","onPointerUp","delete","topPx","releasePointerCapture","getSelection","removeAllRanges","_ensureLoadingOverlay","overlay","ownerDocument","contains","hideLoadingProgress","panel","textContent","track","fill","showLoadingProgress","percent","safePercent","create","stale","getElementById","position","body","className","dpr","devicePixelRatio","getContext","alpha","antialias","stencil","depth","preserveDrawingBuffer","premultipliedAlpha","attrs","getContextAttributes","Application","view","context","backgroundAlpha","autoStart","resolution","autoDensity","$","draggable","handle","start","ui","drag","stop","interactionTarget","currentScale","scale","isPinching","pinchStartDistance","pinchStartScale","activeTouchPointers","emitScaleChange","nextScale","safeScale","onScaleChange","getPinchDistance","points","values","setDraggableState","onTouchPointerEnd","distance","delta","deltaY","onTap","onDoubleTap","onLongPress","hasClass","getStage","isPreviewMounted","pushMount","mountEl","isConnected","nextSibling","styleText","getComputedStyle","popMount","entry","pop","restore","resize","resizeFloating","renderer","resizePreview","EXPRESSION_LIVE2D_MAP","expressions","motions","uniquePush","uniquePushAllowEmpty","finalValue","uniqueMotionPush","normalizeFileStem","input","noQuery","filePart","decoded","decodeURIComponent","normalizeDefinitionName","directName","Name","Id","stem","File","file","collectSettingsCandidates","motionManager","internalModel","rawSettings","modelJson","isExpressionFileLike","isMotionFileLike","isMotionDefinition","node","soundLike","Sound","sound","countMotionDefinitions","count","mergeGroupCount","keyRaw","groupName","parsedCount","safeCount","prev","pushFromContainer","names","fallbackPrefix","fallbackPrefixInner","pushFromList","entries","fallbackName","collectExpressionNamesFromUnknown","visited","visit","itemAny","fileLike","anyObj","directFile","rawKey","keyLower","keyIsExpression","nextContext","collectMotionGroupCountsFromUnknown","groups","parentKey","some","keyIsMotionContainer","nested","nestedRawKey","nestedValue","nestedRaw","nestedKey","nestedCount","pushMotionEntriesFromGroupContainer","groupRaw","groupTrimmed","collectMotionEntries","definitions","settingsCandidates","Motions","FileReferences","collectExpressionNames","expressionManager","Expressions","getExpressionCount","getExpressionName","getExpressionFile","collectMotionGroupNames","groupNames","pushFromObject","keys","motionGroups","anySettings","getMotionGroupCount","getMotionGroupName","getMotionGroupNames","matchLive2DExpression","targetExpression","override","overrideName","mapping","candidateRaw","exact","find","matchLive2DMotion","overrideGroup","overrideIndexRaw","overrideIndex","exactByGroupIndex","exactGroup","exactInGroup","firstInGroup","exactByName","fuzzyByName","nameLower","fuzzyGroup","fuzzy","TICKER_REGISTERED_FLAG","Live2DManager","_runtime","isReady","modelBaseWidth","modelBaseHeight","modelBaseBounds","_lastModelJson","_lastModelJsonSourceUrl","_autoMotionTimer","autoMotionLoopEnabled","_mouthParamCore","_mouthParamIds","_mouthParamIndexes","_mouthParamRangeMins","_mouthParamRangeMaxs","_mouthParamWarned","_mouthCurrentValue","_lipSyncActive","_inModelUpdate","_writeMaskCore","_writeMaskRestore","_updateHookModel","_updateHookRestore","_manualMouthParamEnabled","_manualMouthParamIds","_manualMouthParamIdSet","runtimePixi","_encodePathSegment","segment","safeChar","encoded","ch","_normalizeRemoteUrl","inputUrl","_normalizeResourceRef","inputRef","qIndex","pathPart","queryPart","_getMirrorEikanyaModelUrl","modelUrl","_expandJsDelivrHosts","results","host","_convertJsDelivrGhToRawCandidates","_buildModelUrlCandidates","bases","addBase","mirrorUrl","variant","_createModelWithTimeout","dataUrl","timeoutPromise","_resolve","race","autoUpdate","autoInteract","_fetchWithTimeout","init","AbortController","controller","abort","_toPositiveNumber","_toScale","_readModelBaseBounds","getLocalBounds","_resolveModelBaseBounds","measured","_applyStageTransform","stageWidth","stageHeight","safeStageWidth","safeStageHeight","safeModelWidth","safeModelHeight","fitScale","finalScale","visible","anchor","pivot","modelWidth","modelHeight","_normalizeLegacyCubism2Settings","textures","Textures","hintKeys","texture","textureId","skin","modelId","defaultTexture","defaultSkin","selected","hint","matched","normalizedTextures","textureCount","_clearAutoMotionLoop","_stopCurrentMotion","stopped","tryCall","method","mm","animator","internal","_refreshManualMouthParams","ids","_setLipSyncActive","active","coreModel","_ensureLipSyncHooks","_installCoreWriteMask","setAutoMotionLoopEnabled","_startAutoMotionLoop","_pickDefaultMotionGroup","preferred","token","initialGroups","getMotionGroups","motionGroup","allGroupNames","playOne","playMotion","randGroup","randIndex","intervalMs","groupCount","_stripJsonComments","output","inString","quoteChar","escaping","inLineComment","inBlockComment","_tryParseModelJson","_buildModelJsonCandidates","addCandidate","_fetchModelJsonCandidate","useProxy","requestUrl","_getProxiedUrl","resp","sourceUrl","getCorsProxyUrl","proxied","enableCorsProxy","corsProxy","getProxyUrl","origin","location","retries","registerTicker","Ticker","loadModel","onProgress","progress","reportProgress","destroyModel","modelUrlCandidates","texturesReady","loadedFromUrl","candidateUrl","attemptModel","attemptTexturesReady","attemptProgressStart","_buildRemoteModelDataUrl","fromError","proxyDataUrl","_waitForTextures","loadedCount","totalCount","textureRatio","proxyModel","retryError","attemptError","measuredBounds","getExpressions","forceProxyResources","candidateUrls","sourceModelUrl","directError","proxyError","modifiedModelJson","resolveUrl","p","Physics","Pose","UserData","motionList","motionDef","exprDef","Model","physics","pose","modelJsonStr","mountToStage","removeChildAt","transform","addChild","updateScale","_getModelBaseSize","cached","fallbackNames","mergeGroupMap","keyTrimmed","defs","getMotions","pushAll","items","cachedAny","motionsContainer","playExpression","expression","runMotion","motionIndex","motion","firstError","startMotion","startRandomMotion","playRandomAnimation","focusByClientPoint","immediate","focus","focusController","normalizedX","normalizedY","focusCenter","setMouthOpen","_characterId","clampedValue","logPrefix","getParamRange","paramId","paramIndex","NaN","readNumber","getParameterMinimumValue","getParameterMaximumValue","getParamMin","getParamMax","mapToParamValue","getIndexById","getParameterIndex","getParamIndex","applyById","mappedValue","setParameterValueById","addParameterValueById","setParamFloat","addParamFloat","applyByIndex","getParameterId","setParameterValueByIndex","addParameterValueByIndex","setParameterValue","addParameterValue","paramNames","appliedAny","manualId","paramName","getParameterCount","numericFallback","pid","range","picked","pidx","msg","presetCandidates","scannedIds","_isMouthParam","paramIdOrIndex","restoreEntries","methods","getParamRef","paramRef","apply","updater","rawUpdate","self","ret","_applyMouthValueToModel","targetValue","oldValue","applied","_getMouthParamSource","getLipSyncDebugInfo","lipSyncOverride","mouthParamsSource","mouthParamsCount","clear","retryCount","check","_textures","textureList","tex","baseTexture","valid","every","_ttsGetProxiedAudioUrlRef","LipSyncManager","audioContext","analyser","dataArray","animationFrameId","currentCharacterId","lastVolume","connectedAudioElements","WeakSet","_proxyAudio","_proxyAudioCleanup","fftSize","smoothingFactor","sensitivity","minThreshold","resume","then","AudioContextClass","AudioContext","webkitAudioContext","createAnalyser","smoothingTimeConstant","frequencyBinCount","_getProxiedAudioUrl","connectAudio","audioElement","disconnect","targetAudio","isLocalhost","isDataUrl","isBlobUrl","isSameOrigin","proxiedUrl","Audio","crossOrigin","substring","currentTime","volume","paused","play","syncPlay","syncPause","pause","syncSeek","createMediaElementSource","connect","destination","getVolume","getByteFrequencyData","average","startSync","characterId","stopSync","frameCount","requestAnimationFrame","cancelAnimationFrame","getSettingsSnapshot","_showToastRef","showToast","t","toastr","info","clipText","isProxyNotFound","bodyText","hasLive2D","TTSManager","autoPlay","isPlaying","isLoading","currentAudio","currentSegmentId","littleWhiteBox","_gptSoVitsResolvedProxyRoute","_gptSoVitsActiveWeights","_gptSoVitsWeightSwitchUnavailable","_gptSoVitsWeightSwitchWarned","_gptSoVitsProxyWarned","_gptSoVitsFetchController","_edgeDirectFetchController","_edgeDirectSocket","_edgeDirectObjectUrl","_refreshProviderState","LittleWhiteBox","_onPlaybackEnded","_cleanupEdgeDirectResources","hideLoadingIndicator","jq","jQuery","on","showLoadingIndicator","classList","_abortGptSoVitsFetch","revokeObjectURL","player","_stopCurrent","_getCurrentAudioElement","audio","audioElements","allAudio","querySelectorAll","anyAudio","_getPreferredAudioElement","_isProxyUrl","safeUrl","_buildGptSoVitsProxyUrl","route","_rememberProxyRoute","directUrl","remembered","rememberedUrl","_buildGptSoVitsTtsUrl","resolvedVoice","endpointRaw","vcfg","searchParams","_requestGptSoVitsApi","queryParams","jsonBody","pathRaw","directUrlObj","forEach","attemptTargets","addTarget","errors","credentials","_fetchGptSoVitsApi","_postGptSoVitsApi","_setGptSoVitsWeights","kind","weightsPath","normalizedKind","weights_path","_setGptSoVitsModelPair","endpointOverride","gpt_model_path","sovits_model_path","_ensureGptSoVitsWeights","desiredGpt","desiredSovits","switchMode","_speakWithGptSoVits","segmentId","audioUrl","onEnded","lipId","_startLipSyncOnPlay","_speakWithEdgeDirect","cleanText","attempts","plainBase","attemptErrors","attempt","ua","isEdgeUA","allUnopened","likelyUaRejected","securityHint","synthesizeToBlob","socket","blockedHint","objectUrl","createObjectURL","_startLipSyncWhenModelReady","maxWait","startTime","tryWait","_waitForModelReadyBeforeTTS","hasStarted","tryBind","preferredAudio","_bindLipSyncToAudio","onPlaying","onTimeUpdate","onEnd","speak","ttsConfig","tts","boundVoice","getCharacterTTSVoice","defaultVoice","resolveVoiceByName","speakerValue","contextTexts","callGenerate","ChatMonitor","messageCount","ignoreNextCount","_onTrigger","_stops","_lastUserSignalAt","_config","onTrigger","messageSentStop","_bindEvent","_messageId","_recordUserSignal","userRenderedStop","afterCommandsStop","_type","option","dryRun","quiet_prompt","generationStartedStop","generationEndedStop","_handleTriggerCount","_resolveEventName","eventKey","fromSillyTavern","SillyTavern","eventTypes","fromLegacy","tavern_events","handler","eventName","eventSource","off","eventOn","updateConfig","_shouldCountBySource","_checkAutoTrigger","roll","manualTrigger","markSelfGeneration","PROMPT_TEMPLATES","systemPrompt","responseFormat","resolvePromptTemplate","template","appendEmotionCotFormat","buildRoleplayInstruction","roleplay","roleName","lines","characterCardContent","shouldIgnoreStyleByRoleplay","ignoreCommentStyle","buildContextLines","chatContext","role","getDiceReferenceText","diceReference","referenceText","buildDiceReferenceInstruction","appendDiceAdviceRequirement","Commentator","isGenerating","_onComment","_streamStop","_latestStreamText","setCallback","cb","generate","emittedDone","chatMessages","_getChatContext","todaySpecial","_getTamakoTodaySpecialContent","roleplayOptions","_resolveRoleplayOptions","diceReferenceOptions","_resolveDiceReferenceOptions","system","user","ignoreStyleByRoleplay","responseFormatWithAdvice","finalFormat","roleplayInstruction","diceReferenceInstruction","contextLines","systemParts","buildPrompt","_generateCustom","_generateTavern","finalText","chat","userMessage","getChatResponseFormat","safeUserMessage","buildChatPrompt","maxTokens","_setupStreamListener","orderedPrompts","generateRaw","should_silence","should_stream","ordered_prompts","custom_api","_cleanupStreamListener","usePreset","buildAttemptBody","messages","stream","chat_completion_source","custom_prompt_post_processing","reverse_proxy","custom_url","custom_include_headers","requestWithAttempt","getRequestHeaders","errTxt","statusText","choices","details","iframe_events","STREAM_TOKEN_RECEIVED_FULLY","fullText","maxCount","getChatMessages","hide_state","safeMaxCount","_getCurrentCharacterCardContent","visibleSheets","visibleSheetNames","_normalizeDiceVisibleSheetNames","_getDiceDatabaseReferenceContent","apiData","_getDiceDatabaseDataFromApi","apiSummary","_summarizeDiceDatabasePayload","chatData","_getDiceDatabaseDataFromChatContext","topWindow","api","AutoCardUpdaterAPI","exportTableAsJson","_normalizeDiceDatabasePayload","_pickDiceDatabasePayloadFromMessage","directCandidates","TavernDB_ACU_IndependentData","TavernDB_ACU_Data","TavernDB_ACU_SummaryData","isolatedCandidates","TavernDB_ACU_IsolatedData","_pickDiceDatabasePayloadFromIsolatedData","isolated","_parseMaybeJsonRecord","slot","independentData","record","_isDiceDatabasePayload","sourceLabel","visibleNameSet","_normalizeReferenceText","sheets","sheet","priority","_getDiceSheetPriority","_buildDiceSheetSummary","nextLine","sheetName","rows","row","cell","dataRows","rowText","_formatDiceSheetRow","pairs","_truncateReferenceText","maxLength","characters","charIdRaw","idText","idNum","currentName","name2","fields","personality","scenario","first_mes","mes_example","system_prompt","post_history_instructions","_normalizeCharacterCardField","topDocument","currentSelector","plotContent","directText","_sanitizeTamakoText","innerText","beautifierFrame","_readTamakoPayloadFromIframe","payloadText","_extractTamakoTextFromPayload","currentContent","iframe","captureTags","_getTamakoCaptureTags","tags","valuesFromTags","_extractTamakoTagText","extensionSettings","TamakoMarket","safeTag","escapedTag","regex","RegExp","match","exec","RE_THINK_CLOSED","RE_THINK_UNCLOSED","parseBracketContent","bracketContent","pipeParts","exprVoicePart","parseEmotionCotText","rawText","stripThinkBlocks","normalizedTag","trimStart","open","after","isPendingPrefix","speakerMatch","stripFromText","prefixMatch","useUiStore","showSettings","openSettings","closeSettings","_hoisted_1","class","_hoisted_2","_hoisted_3","__name","isDone","autoCloseDelaySeconds","emits","setup","__props","emit","__emit","displayText","bubbleStyle","LOADING_FRAMES","positionTimer","loadingTimer","autoCloseTimer","loadingFrameIndex","getFiniteNumber","updateBubblePosition","vw","vh","getModelHeadAnchor","fallbackX","fallbackY","rawLeft","rawTop","safeLeft","safeTop","startPositionSync","stopPositionSync","stopLoadingAnimation","stopAutoCloseTimer","scheduleAutoClose","delayMs","delaySeconds","normalizedSeconds","getAutoCloseDelayMs","closeBubble","watch","onUnmounted","_ctx","_cache","onClick","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","placement","motionLoopEnabled","menuEl","inputEl","chatOpen","posX","posY","panelTransform","computed","panelStyle","clampIntoViewport","el","openChat","nextTick","select","onInputKeydown","shiftKey","onGlobalKeydown","ref_key","$event","$emit","placeholder","onKeydown","disabled","_","isModelFile","FILTERED_EXTENSIONS","shouldShow","ext","fetchDirectory","remaining","resetTime","resetDate","RateLimitError","isModel","super","toLocaleTimeString","searchQuery","expanded","loading","loadedOnce","childError","isSelected","filteredChildren","q","loadChildren","handleClick","_component_TreeNode","paddingLeft","title","child","onSelectModel","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","rootEntries","rootLoading","errorMsg","selectedPath","selectedName","filteredRootEntries","confirmLoad","cdnUrl","encodedPath","buildCdnUrl","loadRoot","TreeNode","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","_hoisted_58","_hoisted_59","_hoisted_60","_hoisted_61","_hoisted_62","_hoisted_63","_hoisted_64","_hoisted_65","_hoisted_66","_hoisted_67","_hoisted_68","_hoisted_69","_hoisted_70","_hoisted_71","_hoisted_72","_hoisted_73","_hoisted_74","_hoisted_75","_hoisted_76","_hoisted_77","_hoisted_78","_hoisted_79","_hoisted_80","_hoisted_81","_hoisted_82","_hoisted_83","_hoisted_84","_hoisted_85","_hoisted_86","_hoisted_87","_hoisted_88","_hoisted_89","_hoisted_90","_hoisted_91","_hoisted_92","_hoisted_93","_hoisted_94","_hoisted_95","_hoisted_96","_hoisted_97","_hoisted_98","_hoisted_99","_hoisted_100","_hoisted_101","_hoisted_102","_hoisted_103","_hoisted_104","_hoisted_105","_hoisted_106","_hoisted_107","_hoisted_108","_hoisted_109","_hoisted_110","_hoisted_111","_hoisted_112","_hoisted_113","_hoisted_114","_hoisted_115","_hoisted_116","_hoisted_117","_hoisted_118","_hoisted_119","_hoisted_120","_hoisted_121","_hoisted_122","_hoisted_123","_hoisted_124","_hoisted_125","_hoisted_126","_hoisted_127","_hoisted_128","_hoisted_129","_hoisted_130","_hoisted_131","_hoisted_132","_hoisted_133","_hoisted_134","_hoisted_135","_hoisted_136","_hoisted_137","_hoisted_138","_hoisted_139","_hoisted_140","_hoisted_141","_hoisted_142","_hoisted_143","_hoisted_144","_hoisted_145","_hoisted_146","_hoisted_147","_hoisted_148","_hoisted_149","_hoisted_150","_hoisted_151","_hoisted_152","_hoisted_153","_hoisted_154","_hoisted_155","sectionTabs","en","activeSection","store","toBoundedNumber","clamp","ensureNumericSettingsIntegrity","temperatureLabel","frequencyPenaltyLabel","presencePenaltyLabel","topPLabel","petScaleLabel","recommendedModels","commentStyles","commentTriggerModeOptions","apiSources","showBrowser","customModelUrl","diceReferenceSheetOptions","refreshingDiceSheetOptions","normalizeDiceReferenceSheetName","dedupeDiceReferenceSheetNames","parseDiceReferenceRecord","isDiceReferencePayload","extractDiceReferenceSheetNamesFromPayload","tableRecord","pickDiceReferencePayloadFromIsolatedData","pickDiceReferencePayloadFromMessage","getDiceReferenceSelectedSheets","setDiceReferenceSelectedSheets","isDiceSheetVisible","diceReferenceSheetSummary","optionsCount","refreshDiceReferenceSheetOptions","fromApi","readDiceReferenceSheetNamesFromApi","fromChat","readDiceReferenceSheetNamesFromChat","selectAllDiceReferenceSheets","clearDiceReferenceSheets","ttsEnabled","ttsVoiceList","refreshingTtsVoices","gptSoVitsVoicesJson","ttsTestText","ttsVoiceHint","emotionTags","live2dExpressions","live2dMotionGroups","live2dMotions","refreshingLive2dLists","live2dExpressionOptions","dedup","live2dExpressionOptionSet","normalizeMotionIndex","normalizeMotionOverridePayload","encodeMotionOption","resolveMotionOverridePayload","byName","getMotionOverrideValue","getMotionOverrideLabel","groupLabel","setMotionOverrideValue","rawValue","decodeMotionOption","live2dMotionSelectOptions","safeName","live2dMotionOptionSet","live2dListSummary","exprCount","motionCount","live2dPreviewMountEl","live2dPreviewInteractEl","previewMounted","previewTag","previewStatus","previewZoomFactor","previewPanOffsetX","previewPanOffsetY","previewBasePose","previewIsDragging","previewDragStart","previewDragOrigin","previewMountPromise","previewResizeObserver","getPreviewCanvasSize","applyPreviewViewport","maxOffsetX","maxOffsetY","render","resetPreviewViewport","getPreviewDragPoint","ev","originalEvent","touches","changedTouches","disconnectPreviewResizeObserver","ensurePreviewMounted","interactEl","__dpPreviewHandlers","onDown","point","onMove","onUp","onWheel","bindPreviewViewportEvents","ResizeObserver","observe","bindPreviewResizeObserver","baseScale","capturePreviewBasePose","refreshLive2DLists","finally","cleanupPreviewMount","handlers","unbindPreviewViewportEvents","restored","replayPreview","previewEmotion","section","onBeforeUnmount","modelList","fetchingModels","modelFetchError","testingConnection","connectionStatus","connectionError","showAdvanced","showEmotionAdvanced","showLipSyncAdvanced","lipSyncManualParamsText","overlayFallbackStyle","inset","minHeight","zIndex","display","alignItems","justifyContent","panelFallbackStyle","flexDirection","maxHeight","normalizeModelList","maybeId","maybeModel","maybeName","getModelListSafe","customApi","helperGetModelList","TavernHelper","getModelList","apiurl","Authorization","request","models","getModelListByHttp","fetchModels","testConnection","onBrowserLoad","loadCustomUrl","blobMatch","resetEmotionConfigs","onAliasesBlur","parseAliasesText","m","autoMatchLive2DOverrides","overwrite","warning","filled","exprOverride","motionEnabled","motionGroupOverride","matchedMotion","clearLive2DOverrides","cleared","hadExpr","hadGroup","expr","exprText","motionText","onToggleTtsEnabled","setItem","setTTSEnabled","refreshTtsVoices","saveGptSoVitsVoices","ignoredCount","missingRefCount","normalizeGptSoVitsVoicesForStore","firstUsable","testTts","ctx","getCurrentCharacterId","selectedUsable","targetName","stopTts","applyLipSyncManualParams","step","checked","onChange","opt","onBlur","onInput","ModelBrowser","onCancel","onLoadModel","OPEN_SETTINGS_FN_KEY","uiStore","bubbleText","bubbleDone","globalOpenSettingsFn","modelLoadTaskId","modelLoadingHideTimer","statusCheckTimer","viewportResizeSyncTimer","boundWindowResizeHandler","boundVisualViewportResizeHandler","gazeFollowBound","gazePointerMoveHandler","gazePointerDownHandler","gazeFollowRafId","gazePendingPoint","showMenu","menuAnchor","menuPlacement","showModelBrowser","phoneTtsBridgeBound","phoneMessageReceivedHandler","phoneAIGenCompleteHandler","phoneTtsListenSinceSec","phoneSeenMessageKeys","phoneSeenMessageOrder","phoneTtsQueue","phoneTtsQueueRunning","baibaiPhoneTtsBridgeBound","baibaiPhonePollTimer","baibaiEventStops","baibaiSeenAssistantIds","baibaiSeenAssistantOrder","getPhoneStore","extension_settings","acsusPawsPuffs","phone","localAny","getPhoneContactName","contactId","safeId","contacts","isNonUserPhoneMessage","sender","sanitizePhoneSpeakText","isPhoneAutoReadEnabled","isBaibaiUserSender","senderName","append","name1","userName","getNormalizedUserNames","parseBaibaiCommandArgs","rawArgs","quotedArgs","quotedMatcher","matchAll","extractBaibaiTextPayloads","rawPayload","marker","markerType","extractPhoneSpeakText","replyContent","amount","note","filename","months","membershipType","getPhoneMessageKey","safeContact","messageId","time","rememberPhoneMessageKey","shift","bindTavernEvent","fromTop","resolveTavernEventName","removeListener","resetBaibaiAssistantSeenState","rememberBaibaiAssistantMessageId","getAssistantChatMessages","parseBaibaiPhoneMessagesFromAssistant","normalizedText","hasBaibaiPhoneCommand","assistantMessageId","message_id","commandMatches","commandIndex","commandName","textPayloads","rawTime","messageIdPart","speakText","markExistingBaibaiMessagesAsSeen","collectUnsyncedBaibaiMessages","parsedMessages","enqueuePhoneMessageForTTS","waitForTTSIdle","startAt","messageSec","phoneAutoRead","contactName","ttsOverrides","contextPrefix","drainPhoneTTSQueue","collectUnsyncedPhoneMessages","history","chats","getPhoneChatHistory","pending","reverse","bindPhoneTTSBridge","chatKey","markExistingPhoneMessagesAsSeen","topDoc","detail","unbindPhoneTTSBridge","unbindBaibaiPhoneTTSBridge","toggleMotionLoop","cyclePersona","personas","openModelBrowser","onModelBrowserLoad","onModelChange","onManualChat","closePet","onBubbleHidden","unbindGlobalGazeFollow","getStageSize","normalizePetScale","clearModelLoadingHideTimer","clearStatusCheckTimer","clearViewportResizeSyncTimer","bindGlobalGazeFollow","handlePointerEvent","scheduleGazeFollow","resetFocus","clearGazeFollowRaf","syncGazeFollowBinding","scheduleViewportResizeSync","stageSize","recoverOnce","stageEl","visibility","opacity","scheduleStatusCheck","syncStageAfterViewportResize","renderModelLoadProgress","notifyInitError","loadModelWithProgress","taskId","loaded","rectSummary","hasLive2d","hasModel","stageChildren","stageVisible","prevOutline","outline","prevBackground","background","prevZIndex","initPet","getProxiedAudioUrl","setLipSyncRefs","sync","chatChangedStop","bindBaibaiPhoneTTSBridge","applyEmotionToLive2D","initialScale","vibrate","openFunctionMenu","registerGlobalOpenSettings","onMounted","viewport","visualViewport","bindViewportResizeRecovery","unbindViewportResizeRecovery","unregisterGlobalOpenSettings","ChatBubble","onHidden","SettingsPanel","onClose","FunctionMenu","onSendChat","onToggleMotionLoop","onSwitchModel","onSwitchPersona","onCloseModel","deteleport_style","BUILD_TAG","LEGACY_MENU_BUTTON_LABELS","SETTINGS_LABEL","pinia","EXTENSIONS_MENU_CONTAINER_ID","EXTENSIONS_MENU_ITEM_ID","EXTENSIONS_MENU_CLICK_NAMESPACE","extensionsMenuRetryTimer","getParentDocument","bindExtensionsMenuDelegation","parentDoc","clickEvent","stopPropagation","$extensionsMenu","$extensionsMenuButton","is","trigger","summary","onExtensionsMenuItemClick","injectExtensionsMenuItem","$item","removeExtensionsMenuItem","removeLegacyMenuButtons","_idx","attr","clone","appendTo","$app","createApp","PetContainer","use","errorHandler","_instance","warnHandler","trace","mount","chatId","getCurrentChatId","CHAT_CHANGED","newChatId"],"sourceRoot":""}