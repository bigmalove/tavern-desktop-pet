{"version":3,"file":"index.js","mappings":"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","sources":["webpack://tavern_helper_template////ui/FunctionMenu.vue?bf5d","src://tavern_helper_template/node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js","webpack://tavern_helper_template////ui/TreeNode.vue?5d18","src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js","webpack://tavern_helper_template////ui/ModelBrowser.vue?6a09","webpack://tavern_helper_template////ui/ModelBrowser.vue?1256","webpack://tavern_helper_template////ui/FunctionMenu.vue?0566","webpack://tavern_helper_template////ui/SettingsPanel.vue?bbc2","src://tavern_helper_template/node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/listToStyles.js","src://tavern_helper_template/node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js","webpack://tavern_helper_template////ui/SettingsPanel.vue?2ea5","webpack://tavern_helper_template////ui/TreeNode.vue?7472","webpack://tavern_helper_template////ui/ChatBubble.vue?2609","webpack://tavern_helper_template////ui/PetContainer.vue?f0b6","src://tavern_helper_template/node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js","webpack://tavern_helper_template////ui/PetContainer.vue?68f1","webpack://tavern_helper_template////ui/ChatBubble.vue?d14c","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/webpack/runtime/compat get default export","src://tavern_helper_template/webpack/runtime/define property getters","src://tavern_helper_template/webpack/runtime/hasOwnProperty shorthand","src://tavern_helper_template/webpack/runtime/make namespace object","src://tavern_helper_template/external var \"Vue\"","src://tavern_helper_template////core/constants.ts","src://tavern_helper_template/external var \"z\"","src://tavern_helper_template////core/emotion.ts","src://tavern_helper_template////utils/dom.ts","src://tavern_helper_template////core/settings.ts","src://tavern_helper_template////audio/edge-tts-direct.ts","src://tavern_helper_template////audio/tts-config.ts","src://tavern_helper_template////core/state.ts","src://tavern_helper_template////db/init.ts","src://tavern_helper_template////live2d/runtime-router.ts","src://tavern_helper_template////db/live2d-models.ts","src://tavern_helper_template////live2d/loader.ts","src://tavern_helper_template////utils/gesture-recognizer.ts","src://tavern_helper_template////live2d/stage.ts","src://tavern_helper_template////live2d/expression-motion.ts","src://tavern_helper_template////live2d/manager.ts","src://tavern_helper_template////live2d/lip-sync.ts","src://tavern_helper_template////audio/tts-manager.ts","src://tavern_helper_template////chat/monitor.ts","src://tavern_helper_template////chat/prompt-templates.ts","src://tavern_helper_template////chat/commentator.ts","src://tavern_helper_template////chat/emotion-cot.ts","src://tavern_helper_template////core/ui.ts","src://tavern_helper_template////ui/ChatBubble.vue","webpack://tavern_helper_template////ui/ChatBubble.vue?4a23","src://tavern_helper_template////ui/FunctionMenu.vue","webpack://tavern_helper_template////ui/FunctionMenu.vue?e028","src://tavern_helper_template////live2d/model-browser.ts","src://tavern_helper_template////ui/TreeNode.vue","webpack://tavern_helper_template////ui/TreeNode.vue?c5ea","src://tavern_helper_template////ui/ModelBrowser.vue","webpack://tavern_helper_template////ui/ModelBrowser.vue?8203","src://tavern_helper_template////live2d/uploader.ts","src://tavern_helper_template////ui/SettingsPanel.vue","webpack://tavern_helper_template////ui/SettingsPanel.vue?6f86","src://tavern_helper_template////ui/PetContainer.vue","webpack://tavern_helper_template////ui/PetContainer.vue?aed4","src://tavern_helper_template////utils/style-teleport.ts","src://tavern_helper_template////index.ts"],"sourcesContent":["/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./FunctionMenu.vue?vue&type=style&index=0&id=ff4f8948&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"078f2c0f\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./FunctionMenu.vue?vue&type=style&index=0&id=ff4f8948&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./FunctionMenu.vue?vue&type=style&index=0&id=ff4f8948&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = [];\n\n  // return the list of modules as css string\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n      content += cssWithMappingToString(item);\n      if (needLayer) {\n        content += \"}\";\n      }\n      if (item[2]) {\n        content += \"}\";\n      }\n      if (item[4]) {\n        content += \"}\";\n      }\n      return content;\n    }).join(\"\");\n  };\n\n  // import a list of modules into the list\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n    var alreadyImportedModules = {};\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n      list.push(item);\n    }\n  };\n  return list;\n};","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.node-row[data-v-3a6a95ba]{display:flex;align-items:center;padding:5px 8px;cursor:pointer;border-bottom:1px solid hsla(0,0%,100%,.08);font-size:12px;gap:4px;-webkit-user-select:none;user-select:none;transition:background .14s}.node-row[data-v-3a6a95ba]:hover{background:rgba(255,225,0,.12)}.node-row.is-model .node-name[data-v-3a6a95ba]{color:#00dac2;font-weight:600}.node-row.is-selected[data-v-3a6a95ba]{background:rgba(255,225,0,.2)}.expand-icon[data-v-3a6a95ba]{width:14px;font-size:8px;color:#8d8d8d;transition:transform .2s;flex-shrink:0;text-align:center}.expand-icon.expanded[data-v-3a6a95ba]{transform:rotate(90deg)}.expand-icon.placeholder[data-v-3a6a95ba]{visibility:hidden}.node-icon[data-v-3a6a95ba]{font-size:13px;flex-shrink:0;line-height:1}.node-name[data-v-3a6a95ba]{color:#f1f1f1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1}.node-spinner[data-v-3a6a95ba]{display:inline-block;width:10px;height:10px;border:1.5px solid #4d4d4d;border-top-color:#00dac2;border-radius:50%;animation:spin-3a6a95ba .8s linear infinite;flex-shrink:0;margin-left:4px}@keyframes spin-3a6a95ba{to{transform:rotate(360deg)}}.empty-hint[data-v-3a6a95ba]{font-size:11px;color:#8d8d8d;padding:4px 8px}.child-error[data-v-3a6a95ba]{font-size:11px;color:#ffb5af;padding:4px 8px}.child-error .retry-link[data-v-3a6a95ba]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.child-error .retry-link[data-v-3a6a95ba]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.child-error .retry-link[data-v-3a6a95ba]:disabled{opacity:.45;cursor:not-allowed}.child-error .retry-link[data-v-3a6a95ba]{height:22px;min-width:56px;padding:0 8px;margin-left:6px;font-size:10px;border-color:rgba(0,218,194,.55);color:#c5fff9;cursor:pointer}.child-error .retry-link[data-v-3a6a95ba]:hover{background:#00dac2;border-color:#00dac2;color:#000}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/TreeNode.vue\"],\"names\":[],\"mappings\":\"AAAA,iEAAA,CCAwH,2BAAU,YAAa,CAAA,kBAAmB,CAAA,eAAgB,CAAA,cAAe,CAAA,2CAA4C,CAAA,cAAe,CAAA,OAAQ,CAAA,wBAAiB,CAAjB,gBAAiB,CAAA,0BAA2B,CAAA,iCAAgB,8BAA+B,CAAA,+CAA8B,aAAc,CAAA,eAAgB,CAAA,uCAAsB,6BAA8B,CAAA,8BAAa,UAAW,CAAA,aAAc,CAAA,aAAc,CAAA,wBAAyB,CAAA,aAAc,CAAA,iBAAkB,CAAA,uCAAsB,uBAAwB,CAAA,0CAAyB,iBAAkB,CAAA,4BAAW,cAAe,CAAA,aAAc,CAAA,aAAc,CAAA,4BAAW,aAAc,CAAA,eAAgB,CAAA,sBAAuB,CAAA,kBAAmB,CAAA,MAAO,CAAA,+BAAc,oBAAqB,CAAA,UAAW,CAAA,WAAY,CAAA,0BAA2B,CAAA,wBAAyB,CAAA,iBAAkB,CAAA,2CAAmC,CAAA,aAAc,CAAA,eAAgB,CAAA,yBAAgB,GAAG,wBAAyB,CAAC,CAAA,6BAAY,cAAe,CAAA,aAAc,CAAA,eAAgB,CAAA,8BAAa,cAAe,CAAA,aAAc,CAAA,eAAgB,CAAA,0CAAyB,uBAAgB,CAAhB,eAAgB,CAAA,oCAAqC,CAAA,wBAAyB,CAAA,UAAW,CAAA,iDAAkD,CAAA,eAAgB,CAAA,oBAAqB,CAAA,wBAAyB,CAAA,cAAe,CAAA,kFAAuF,CAAA,sEAAuE,CAAA,+DAA8C,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,mDAAkC,WAAY,CAAA,kBAAmB,CAAA,0CAAyB,WAAY,CAAA,cAAe,CAAA,aAAc,CAAA,eAAgB,CAAA,cAAe,CAAA,gCAAiC,CAAA,aAAc,CAAA,cAAe,CAAA,gDAA+B,kBAAmB,CAAA,oBAAqB,CAAA,UAAW\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.node-row{display:flex;align-items:center;padding:5px 8px;cursor:pointer;border-bottom:1px solid hsla(0,0%,100%,.08);font-size:12px;gap:4px;user-select:none;transition:background .14s}.node-row:hover{background:rgba(255,225,0,.12)}.node-row.is-model .node-name{color:#00dac2;font-weight:600}.node-row.is-selected{background:rgba(255,225,0,.2)}.expand-icon{width:14px;font-size:8px;color:#8d8d8d;transition:transform .2s;flex-shrink:0;text-align:center}.expand-icon.expanded{transform:rotate(90deg)}.expand-icon.placeholder{visibility:hidden}.node-icon{font-size:13px;flex-shrink:0;line-height:1}.node-name{color:#f1f1f1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1}.node-spinner{display:inline-block;width:10px;height:10px;border:1.5px solid #4d4d4d;border-top-color:#00dac2;border-radius:50%;animation:spin .8s linear infinite;flex-shrink:0;margin-left:4px}@keyframes spin{to{transform:rotate(360deg)}}.empty-hint{font-size:11px;color:#8d8d8d;padding:4px 8px}.child-error{font-size:11px;color:#ffb5af;padding:4px 8px}.child-error .retry-link{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.child-error .retry-link:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.child-error .retry-link:disabled{opacity:.45;cursor:not-allowed}.child-error .retry-link{height:22px;min-width:56px;padding:0 8px;margin-left:6px;font-size:10px;border-color:rgba(0,218,194,.55);color:#c5fff9;cursor:pointer}.child-error .retry-link:hover{background:#00dac2;border-color:#00dac2;color:#000}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.model-browser[data-v-7ee23a0a]{display:flex;flex-direction:column;height:100%;max-height:60vh;color:#fff;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif}.browser-header[data-v-7ee23a0a]{display:flex;align-items:center;justify-content:space-between;padding:8px 0 10px;margin-bottom:10px;border-bottom:1px solid rgba(255,225,0,.35)}.browser-header .browser-title[data-v-7ee23a0a]{font-size:14px;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;letter-spacing:.08em;color:#ffe100}.browser-header .browser-hint[data-v-7ee23a0a]{font-size:10px;color:#8d8d8d;letter-spacing:.08em}.search-box[data-v-7ee23a0a]{margin-bottom:10px}.search-box input[data-v-7ee23a0a]{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.search-box input[data-v-7ee23a0a]:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.search-box input[data-v-7ee23a0a]::placeholder{color:#8d8d8d}.search-box input[data-v-7ee23a0a]{color:#fff}.error-bar[data-v-7ee23a0a]{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:8px 10px;background:rgba(255,59,48,.12);border:1px solid rgba(255,59,48,.4);margin-bottom:10px;font-size:12px;color:#ffc9c5}.error-bar .retry-btn[data-v-7ee23a0a]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.error-bar .retry-btn[data-v-7ee23a0a]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.error-bar .retry-btn[data-v-7ee23a0a]:disabled{opacity:.45;cursor:not-allowed}.error-bar .retry-btn[data-v-7ee23a0a]{min-width:72px;height:26px;padding:0 8px;font-size:11px;border-color:rgba(255,59,48,.6);color:#ffc9c5}.error-bar .retry-btn[data-v-7ee23a0a]:hover{background:#ff3b30;border-color:#ff3b30;color:#fff}.tree-container[data-v-7ee23a0a]{flex:1;overflow-y:auto;min-height:150px;padding:4px 0 6px;border:1px solid hsla(0,0%,100%,.12);background:rgba(0,0,0,.3)}.tree-container[data-v-7ee23a0a]::-webkit-scrollbar{width:7px;height:7px}.tree-container[data-v-7ee23a0a]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.tree-container[data-v-7ee23a0a]::-webkit-scrollbar-thumb{background:#555}.tree-container[data-v-7ee23a0a]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.tree-container[data-v-7ee23a0a]:empty{border-style:dashed}.loading-state[data-v-7ee23a0a]{display:flex;align-items:center;justify-content:center;padding:24px;color:#8d8d8d;font-size:13px;gap:8px}.spinner[data-v-7ee23a0a]{display:inline-block;width:14px;height:14px;border:2px solid #4d4d4d;border-top-color:#00dac2;border-radius:50%;animation:spin-7ee23a0a .8s linear infinite}@keyframes spin-7ee23a0a{to{transform:rotate(360deg)}}.empty-state[data-v-7ee23a0a]{text-align:center;padding:24px;color:#8d8d8d;font-size:13px}.browser-footer[data-v-7ee23a0a]{border-top:1px solid hsla(0,0%,100%,.16);padding-top:12px;margin-top:10px}.browser-footer .selected-info[data-v-7ee23a0a]{font-size:12px;color:#d5d5d5;margin-bottom:8px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.browser-footer .selected-info .selected-path[data-v-7ee23a0a]{color:#ffe100;font-weight:600}.browser-footer .selected-info .no-selection[data-v-7ee23a0a]{color:#8d8d8d}.browser-footer .footer-actions[data-v-7ee23a0a]{display:flex;justify-content:flex-end;gap:8px}.btn[data-v-7ee23a0a]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.btn[data-v-7ee23a0a]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.btn[data-v-7ee23a0a]:disabled{opacity:.45;cursor:not-allowed}.btn[data-v-7ee23a0a]{min-width:90px;height:32px;padding:0 14px;font-size:12px}.btn[data-v-7ee23a0a]:disabled{opacity:.4;cursor:not-allowed}.btn.btn-primary[data-v-7ee23a0a]{background:#ffe100;color:#000;border-color:#ffe100}.btn.btn-primary[data-v-7ee23a0a]:hover:not(:disabled){background:#fff26e;border-color:#fff26e}.btn.btn-secondary[data-v-7ee23a0a]{background:rgba(0,218,194,.08);border-color:rgba(0,218,194,.55);color:#c5fff9}.btn.btn-secondary[data-v-7ee23a0a]:hover{background:#00dac2;border-color:#00dac2;color:#000}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/ModelBrowser.vue\"],\"names\":[],\"mappings\":\"AAAA,iEAAA,CCAwH,gCAAe,YAAa,CAAA,qBAAsB,CAAA,WAAY,CAAA,eAAgB,CAAA,UAAW,CAAA,gFAAiF,CAAA,iCAAgB,YAAa,CAAA,kBAAmB,CAAA,6BAA8B,CAAA,kBAAmB,CAAA,kBAAmB,CAAA,2CAA4C,CAAA,gDAA+B,cAAe,CAAA,iDAAkD,CAAA,oBAAqB,CAAA,aAAc,CAAA,+CAA8B,cAAe,CAAA,aAAc,CAAA,oBAAqB,CAAA,6BAAY,kBAAmB,CAAA,mCAAkB,UAAW,CAAA,qBAAsB,CAAA,gBAAiB,CAAA,wBAAyB,CAAA,+BAAgC,CAAA,eAAgB,CAAA,0BAA2B,CAAA,aAAc,CAAA,+DAAgE,CAAA,cAAe,CAAA,YAAa,CAAA,sDAAuD,CAAA,yCAAwB,oBAAqB,CAAA,8BAA+B,CAAA,gDAA+B,aAAc,CAAA,mCAAkB,UAAW,CAAA,4BAAW,YAAa,CAAA,kBAAmB,CAAA,6BAA8B,CAAA,OAAQ,CAAA,gBAAiB,CAAA,8BAA+B,CAAA,mCAAoC,CAAA,kBAAmB,CAAA,cAAe,CAAA,aAAc,CAAA,uCAAsB,uBAAgB,CAAhB,eAAgB,CAAA,oCAAqC,CAAA,wBAAyB,CAAA,UAAW,CAAA,iDAAkD,CAAA,eAAgB,CAAA,oBAAqB,CAAA,wBAAyB,CAAA,cAAe,CAAA,kFAAuF,CAAA,sEAAuE,CAAA,4DAA2C,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,gDAA+B,WAAY,CAAA,kBAAmB,CAAA,uCAAsB,cAAe,CAAA,WAAY,CAAA,aAAc,CAAA,cAAe,CAAA,+BAAgC,CAAA,aAAc,CAAA,6CAA4B,kBAAmB,CAAA,oBAAqB,CAAA,UAAW,CAAA,iCAAgB,MAAO,CAAA,eAAgB,CAAA,gBAAiB,CAAA,iBAAkB,CAAA,oCAAqC,CAAA,yBAA0B,CAAA,oDAAmC,SAAU,CAAA,UAAW,CAAA,0DAAyC,8BAA+B,CAAA,0DAAyC,eAAgB,CAAA,gEAA+C,kBAAmB,CAAA,uCAAsB,mBAAoB,CAAA,gCAAe,YAAa,CAAA,kBAAmB,CAAA,sBAAuB,CAAA,YAAa,CAAA,aAAc,CAAA,cAAe,CAAA,OAAQ,CAAA,0BAAS,oBAAqB,CAAA,UAAW,CAAA,WAAY,CAAA,wBAAyB,CAAA,wBAAyB,CAAA,iBAAkB,CAAA,2CAAmC,CAAA,yBAAgB,GAAG,wBAAyB,CAAC,CAAA,8BAAa,iBAAkB,CAAA,YAAa,CAAA,aAAc,CAAA,cAAe,CAAA,iCAAgB,wCAAyC,CAAA,gBAAiB,CAAA,eAAgB,CAAA,gDAA+B,cAAe,CAAA,aAAc,CAAA,iBAAkB,CAAA,eAAgB,CAAA,sBAAuB,CAAA,kBAAmB,CAAA,+DAA8C,aAAc,CAAA,eAAgB,CAAA,8DAA6C,aAAc,CAAA,iDAAgC,YAAa,CAAA,wBAAyB,CAAA,OAAQ,CAAA,sBAAK,uBAAgB,CAAhB,eAAgB,CAAA,oCAAqC,CAAA,wBAAyB,CAAA,UAAW,CAAA,iDAAkD,CAAA,eAAgB,CAAA,oBAAqB,CAAA,wBAAyB,CAAA,cAAe,CAAA,kFAAuF,CAAA,sEAAuE,CAAA,2CAA0B,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,+BAAc,WAAY,CAAA,kBAAmB,CAAA,sBAAK,cAAe,CAAA,WAAY,CAAA,cAAe,CAAA,cAAe,CAAA,+BAAc,UAAW,CAAA,kBAAmB,CAAA,kCAAiB,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,uDAAsC,kBAAmB,CAAA,oBAAqB,CAAA,oCAAmB,8BAA+B,CAAA,gCAAiC,CAAA,aAAc,CAAA,0CAAyB,kBAAmB,CAAA,oBAAqB,CAAA,UAAW\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.model-browser{display:flex;flex-direction:column;height:100%;max-height:60vh;color:#fff;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif}.browser-header{display:flex;align-items:center;justify-content:space-between;padding:8px 0 10px;margin-bottom:10px;border-bottom:1px solid rgba(255,225,0,.35)}.browser-header .browser-title{font-size:14px;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;letter-spacing:.08em;color:#ffe100}.browser-header .browser-hint{font-size:10px;color:#8d8d8d;letter-spacing:.08em}.search-box{margin-bottom:10px}.search-box input{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.search-box input:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.search-box input::placeholder{color:#8d8d8d}.search-box input{color:#fff}.error-bar{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:8px 10px;background:rgba(255,59,48,.12);border:1px solid rgba(255,59,48,.4);margin-bottom:10px;font-size:12px;color:#ffc9c5}.error-bar .retry-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.error-bar .retry-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.error-bar .retry-btn:disabled{opacity:.45;cursor:not-allowed}.error-bar .retry-btn{min-width:72px;height:26px;padding:0 8px;font-size:11px;border-color:rgba(255,59,48,.6);color:#ffc9c5}.error-bar .retry-btn:hover{background:#ff3b30;border-color:#ff3b30;color:#fff}.tree-container{flex:1;overflow-y:auto;min-height:150px;padding:4px 0 6px;border:1px solid hsla(0,0%,100%,.12);background:rgba(0,0,0,.3)}.tree-container::-webkit-scrollbar{width:7px;height:7px}.tree-container::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.tree-container::-webkit-scrollbar-thumb{background:#555}.tree-container::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.tree-container:empty{border-style:dashed}.loading-state{display:flex;align-items:center;justify-content:center;padding:24px;color:#8d8d8d;font-size:13px;gap:8px}.spinner{display:inline-block;width:14px;height:14px;border:2px solid #4d4d4d;border-top-color:#00dac2;border-radius:50%;animation:spin .8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.empty-state{text-align:center;padding:24px;color:#8d8d8d;font-size:13px}.browser-footer{border-top:1px solid hsla(0,0%,100%,.16);padding-top:12px;margin-top:10px}.browser-footer .selected-info{font-size:12px;color:#d5d5d5;margin-bottom:8px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.browser-footer .selected-info .selected-path{color:#ffe100;font-weight:600}.browser-footer .selected-info .no-selection{color:#8d8d8d}.browser-footer .footer-actions{display:flex;justify-content:flex-end;gap:8px}.btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.btn:disabled{opacity:.45;cursor:not-allowed}.btn{min-width:90px;height:32px;padding:0 14px;font-size:12px}.btn:disabled{opacity:.4;cursor:not-allowed}.btn.btn-primary{background:#ffe100;color:#000;border-color:#ffe100}.btn.btn-primary:hover:not(:disabled){background:#fff26e;border-color:#fff26e}.btn.btn-secondary{background:rgba(0,218,194,.08);border-color:rgba(0,218,194,.55);color:#c5fff9}.btn.btn-secondary:hover{background:#00dac2;border-color:#00dac2;color:#000}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ModelBrowser.vue?vue&type=style&index=0&id=7ee23a0a&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"db518fdc\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ModelBrowser.vue?vue&type=style&index=0&id=7ee23a0a&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ModelBrowser.vue?vue&type=style&index=0&id=7ee23a0a&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.menu-overlay[data-v-ff4f8948]{position:fixed;inset:0;z-index:10002;background:rgba(0,0,0,.12);display:flex;align-items:center;justify-content:center}.menu-cluster[data-v-ff4f8948]{position:fixed;display:flex;align-items:center;gap:10px;max-width:calc(100vw - 16px);pointer-events:auto}.menu-cluster.is-left[data-v-ff4f8948]{flex-direction:row-reverse}.menu-panel[data-v-ff4f8948]{width:164px;padding:8px;background:#181818;color:#fff;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0,100% 0,100% calc(100% - 12px),calc(100% - 12px) 100%,0 100%)}.menu-panel[data-v-ff4f8948]::before{content:\"\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.menu-panel[data-v-ff4f8948]{background-image:linear-gradient(rgba(255,255,255,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.03) 1px,transparent 1px);background-size:20px 20px}.panel-top[data-v-ff4f8948]{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;padding:4px 4px 8px;border-bottom:1px solid rgba(255,225,0,.35)}.panel-title[data-v-ff4f8948]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;color:#ffe100;font-size:12px;letter-spacing:.12em}.icon-btn[data-v-ff4f8948]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.icon-btn[data-v-ff4f8948]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.icon-btn[data-v-ff4f8948]:disabled{opacity:.45;cursor:not-allowed}.icon-btn[data-v-ff4f8948]{width:28px;height:24px;padding:0;font-size:16px;line-height:1}.command-btn[data-v-ff4f8948]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.command-btn[data-v-ff4f8948]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.command-btn[data-v-ff4f8948]:disabled{opacity:.45;cursor:not-allowed}.command-btn[data-v-ff4f8948]{width:100%;min-height:52px;padding:8px 10px;margin-bottom:8px;text-align:left;display:grid;grid-template-columns:auto 1fr;grid-template-areas:\"idx main\" \"idx sub\";-moz-column-gap:8px;column-gap:8px;row-gap:2px}.command-btn[data-v-ff4f8948]:last-child{margin-bottom:0}.command-btn.active[data-v-ff4f8948]{background:#ffe100;color:#000;border-color:#ffe100}.command-btn.danger[data-v-ff4f8948]{border-color:rgba(255,59,48,.45);color:#ffc9c5}.command-btn.danger[data-v-ff4f8948]:hover{background:#ff3b30;border-color:#ff3b30;color:#fff}.command-index[data-v-ff4f8948]{grid-area:idx;align-self:center;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:16px;color:#00dac2}.command-main[data-v-ff4f8948]{grid-area:main;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:12px;line-height:1}.command-sub[data-v-ff4f8948]{grid-area:sub;font-size:10px;color:#8d8d8d;text-transform:none}.chat-drawer[data-v-ff4f8948]{width:min(320px,100vw - 36px);max-height:min(68vh,420px);padding:12px;background:#262626;color:#fff;overflow:auto;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0,100% 0,100% calc(100% - 12px),calc(100% - 12px) 100%,0 100%)}.chat-drawer[data-v-ff4f8948]::before{content:\"\";position:absolute;top:0;left:0;width:56px;height:2px;background:#00dac2;z-index:2}.chat-drawer[data-v-ff4f8948]{background-image:linear-gradient(rgba(255,255,255,0.024) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.024) 1px,transparent 1px);background-size:20px 20px}.chat-drawer[data-v-ff4f8948]::-webkit-scrollbar{width:7px;height:7px}.chat-drawer[data-v-ff4f8948]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.chat-drawer[data-v-ff4f8948]::-webkit-scrollbar-thumb{background:#555}.chat-drawer[data-v-ff4f8948]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.drawer-head[data-v-ff4f8948]{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;padding-bottom:8px;border-bottom:1px solid rgba(0,218,194,.38)}.drawer-title[data-v-ff4f8948]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:12px;letter-spacing:.12em;color:#00dac2}.drawer-close[data-v-ff4f8948]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.drawer-close[data-v-ff4f8948]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.drawer-close[data-v-ff4f8948]:disabled{opacity:.45;cursor:not-allowed}.drawer-close[data-v-ff4f8948]{width:26px;height:24px;padding:0;font-size:16px;line-height:1}.chat-input[data-v-ff4f8948]{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.chat-input[data-v-ff4f8948]:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.chat-input[data-v-ff4f8948]::placeholder{color:#8d8d8d}.chat-input[data-v-ff4f8948]{min-height:96px;resize:vertical;color:#fff}.drawer-actions[data-v-ff4f8948]{display:flex;justify-content:flex-end;margin-top:10px}.send-btn[data-v-ff4f8948]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.send-btn[data-v-ff4f8948]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.send-btn[data-v-ff4f8948]:disabled{opacity:.45;cursor:not-allowed}.send-btn[data-v-ff4f8948]{min-width:96px;height:34px}.drawer-hint[data-v-ff4f8948]{margin-top:8px;font-size:11px;color:#8d8d8d}.drawer-enter-active[data-v-ff4f8948],.drawer-leave-active[data-v-ff4f8948]{transition:opacity .16s ease,transform .16s ease}.drawer-enter-from[data-v-ff4f8948],.drawer-leave-to[data-v-ff4f8948]{opacity:0;transform:translateX(-8px)}.menu-cluster.is-left .drawer-enter-from[data-v-ff4f8948],.menu-cluster.is-left .drawer-leave-to[data-v-ff4f8948]{transform:translateX(8px)}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/FunctionMenu.vue\"],\"names\":[],\"mappings\":\"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\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.menu-overlay{position:fixed;inset:0;z-index:10002;background:rgba(0,0,0,.12);display:flex;align-items:center;justify-content:center}.menu-cluster{position:fixed;display:flex;align-items:center;gap:10px;max-width:calc(100vw - 16px);pointer-events:auto}.menu-cluster.is-left{flex-direction:row-reverse}.menu-panel{width:164px;padding:8px;background:#181818;color:#fff;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%)}.menu-panel::before{content:\\\"\\\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.menu-panel{background-image:linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);background-size:20px 20px}.panel-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;padding:4px 4px 8px;border-bottom:1px solid rgba(255,225,0,.35)}.panel-title{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;color:#ffe100;font-size:12px;letter-spacing:.12em}.icon-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.icon-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.icon-btn:disabled{opacity:.45;cursor:not-allowed}.icon-btn{width:28px;height:24px;padding:0;font-size:16px;line-height:1}.command-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.command-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.command-btn:disabled{opacity:.45;cursor:not-allowed}.command-btn{width:100%;min-height:52px;padding:8px 10px;margin-bottom:8px;text-align:left;display:grid;grid-template-columns:auto 1fr;grid-template-areas:\\\"idx main\\\" \\\"idx sub\\\";column-gap:8px;row-gap:2px}.command-btn:last-child{margin-bottom:0}.command-btn.active{background:#ffe100;color:#000;border-color:#ffe100}.command-btn.danger{border-color:rgba(255,59,48,.45);color:#ffc9c5}.command-btn.danger:hover{background:#ff3b30;border-color:#ff3b30;color:#fff}.command-index{grid-area:idx;align-self:center;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:16px;color:#00dac2}.command-main{grid-area:main;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:12px;line-height:1}.command-sub{grid-area:sub;font-size:10px;color:#8d8d8d;text-transform:none}.chat-drawer{width:min(320px,100vw - 36px);max-height:min(68vh,420px);padding:12px;background:#262626;color:#fff;overflow:auto;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%)}.chat-drawer::before{content:\\\"\\\";position:absolute;top:0;left:0;width:56px;height:2px;background:#00dac2;z-index:2}.chat-drawer{background-image:linear-gradient(rgba(255, 255, 255, 0.024) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.024) 1px, transparent 1px);background-size:20px 20px}.chat-drawer::-webkit-scrollbar{width:7px;height:7px}.chat-drawer::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.chat-drawer::-webkit-scrollbar-thumb{background:#555}.chat-drawer::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.drawer-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;padding-bottom:8px;border-bottom:1px solid rgba(0,218,194,.38)}.drawer-title{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:12px;letter-spacing:.12em;color:#00dac2}.drawer-close{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.drawer-close:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.drawer-close:disabled{opacity:.45;cursor:not-allowed}.drawer-close{width:26px;height:24px;padding:0;font-size:16px;line-height:1}.chat-input{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.chat-input:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.chat-input::placeholder{color:#8d8d8d}.chat-input{min-height:96px;resize:vertical;color:#fff}.drawer-actions{display:flex;justify-content:flex-end;margin-top:10px}.send-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.send-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.send-btn:disabled{opacity:.45;cursor:not-allowed}.send-btn{min-width:96px;height:34px}.drawer-hint{margin-top:8px;font-size:11px;color:#8d8d8d}.drawer-enter-active,.drawer-leave-active{transition:opacity .16s ease,transform .16s ease}.drawer-enter-from,.drawer-leave-to{opacity:0;transform:translateX(-8px)}.menu-cluster.is-left .drawer-enter-from,.menu-cluster.is-left .drawer-leave-to{transform:translateX(8px)}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./SettingsPanel.vue?vue&type=style&index=0&id=216a7ce1&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"be1b4460\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./SettingsPanel.vue?vue&type=style&index=0&id=216a7ce1&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./SettingsPanel.vue?vue&type=style&index=0&id=216a7ce1&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","/**\n * Translates the list format produced by css-loader into something\n * easier to manipulate.\n */\nexport default function listToStyles (parentId, list) {\n  var styles = []\n  var newStyles = {}\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i]\n    var id = item[0]\n    var css = item[1]\n    var media = item[2]\n    var sourceMap = item[3]\n    var part = {\n      id: parentId + ':' + i,\n      css: css,\n      media: media,\n      sourceMap: sourceMap\n    }\n    if (!newStyles[id]) {\n      styles.push(newStyles[id] = { id: id, parts: [part] })\n    } else {\n      newStyles[id].parts.push(part)\n    }\n  }\n  return styles\n}\n","/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n  Modified by Evan You @yyx990803\n*/\n\nimport listToStyles from './listToStyles'\n\nvar hasDocument = typeof document !== 'undefined'\n\nif (typeof DEBUG !== 'undefined' && DEBUG) {\n  if (!hasDocument) {\n    throw new Error(\n    'vue-style-loader cannot be used in a non-browser environment. ' +\n    \"Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.\"\n  ) }\n}\n\n/*\ntype StyleObject = {\n  id: number;\n  parts: Array<StyleObjectPart>\n}\n\ntype StyleObjectPart = {\n  css: string;\n  media: string;\n  sourceMap: ?string\n}\n*/\n\nvar stylesInDom = {/*\n  [id: number]: {\n    id: number,\n    refs: number,\n    parts: Array<(obj?: StyleObjectPart) => void>\n  }\n*/}\n\nvar head = hasDocument && (document.head || document.getElementsByTagName('head')[0])\nvar singletonElement = null\nvar singletonCounter = 0\nvar isProduction = false\nvar noop = function () {}\nvar options = null\nvar ssrIdKey = 'data-vue-ssr-id'\n\n// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n// tags it will allow on a page\nvar isOldIE = typeof navigator !== 'undefined' && /msie [6-9]\\b/.test(navigator.userAgent.toLowerCase())\n\nexport default function addStylesClient (parentId, list, _isProduction, _options) {\n  isProduction = _isProduction\n\n  options = _options || {}\n\n  var styles = listToStyles(parentId, list)\n  addStylesToDom(styles)\n\n  return function update (newList) {\n    var mayRemove = []\n    for (var i = 0; i < styles.length; i++) {\n      var item = styles[i]\n      var domStyle = stylesInDom[item.id]\n      domStyle.refs--\n      mayRemove.push(domStyle)\n    }\n    if (newList) {\n      styles = listToStyles(parentId, newList)\n      addStylesToDom(styles)\n    } else {\n      styles = []\n    }\n    for (var i = 0; i < mayRemove.length; i++) {\n      var domStyle = mayRemove[i]\n      if (domStyle.refs === 0) {\n        for (var j = 0; j < domStyle.parts.length; j++) {\n          domStyle.parts[j]()\n        }\n        delete stylesInDom[domStyle.id]\n      }\n    }\n  }\n}\n\nfunction addStylesToDom (styles /* Array<StyleObject> */) {\n  for (var i = 0; i < styles.length; i++) {\n    var item = styles[i]\n    var domStyle = stylesInDom[item.id]\n    if (domStyle) {\n      domStyle.refs++\n      for (var j = 0; j < domStyle.parts.length; j++) {\n        domStyle.parts[j](item.parts[j])\n      }\n      for (; j < item.parts.length; j++) {\n        domStyle.parts.push(addStyle(item.parts[j]))\n      }\n      if (domStyle.parts.length > item.parts.length) {\n        domStyle.parts.length = item.parts.length\n      }\n    } else {\n      var parts = []\n      for (var j = 0; j < item.parts.length; j++) {\n        parts.push(addStyle(item.parts[j]))\n      }\n      stylesInDom[item.id] = { id: item.id, refs: 1, parts: parts }\n    }\n  }\n}\n\nfunction createStyleElement () {\n  var styleElement = document.createElement('style')\n  styleElement.type = 'text/css'\n  head.appendChild(styleElement)\n  return styleElement\n}\n\nfunction addStyle (obj /* StyleObjectPart */) {\n  var update, remove\n  var styleElement = document.querySelector('style[' + ssrIdKey + '~=\"' + obj.id + '\"]')\n\n  if (styleElement) {\n    if (isProduction) {\n      // has SSR styles and in production mode.\n      // simply do nothing.\n      return noop\n    } else {\n      // has SSR styles but in dev mode.\n      // for some reason Chrome can't handle source map in server-rendered\n      // style tags - source maps in <style> only works if the style tag is\n      // created and inserted dynamically. So we remove the server rendered\n      // styles and inject new ones.\n      styleElement.parentNode.removeChild(styleElement)\n    }\n  }\n\n  if (isOldIE) {\n    // use singleton mode for IE9.\n    var styleIndex = singletonCounter++\n    styleElement = singletonElement || (singletonElement = createStyleElement())\n    update = applyToSingletonTag.bind(null, styleElement, styleIndex, false)\n    remove = applyToSingletonTag.bind(null, styleElement, styleIndex, true)\n  } else {\n    // use multi-style-tag mode in all other cases\n    styleElement = createStyleElement()\n    update = applyToTag.bind(null, styleElement)\n    remove = function () {\n      styleElement.parentNode.removeChild(styleElement)\n    }\n  }\n\n  update(obj)\n\n  return function updateStyle (newObj /* StyleObjectPart */) {\n    if (newObj) {\n      if (newObj.css === obj.css &&\n          newObj.media === obj.media &&\n          newObj.sourceMap === obj.sourceMap) {\n        return\n      }\n      update(obj = newObj)\n    } else {\n      remove()\n    }\n  }\n}\n\nvar replaceText = (function () {\n  var textStore = []\n\n  return function (index, replacement) {\n    textStore[index] = replacement\n    return textStore.filter(Boolean).join('\\n')\n  }\n})()\n\nfunction applyToSingletonTag (styleElement, index, remove, obj) {\n  var css = remove ? '' : obj.css\n\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = replaceText(index, css)\n  } else {\n    var cssNode = document.createTextNode(css)\n    var childNodes = styleElement.childNodes\n    if (childNodes[index]) styleElement.removeChild(childNodes[index])\n    if (childNodes.length) {\n      styleElement.insertBefore(cssNode, childNodes[index])\n    } else {\n      styleElement.appendChild(cssNode)\n    }\n  }\n}\n\nfunction applyToTag (styleElement, obj) {\n  var css = obj.css\n  var media = obj.media\n  var sourceMap = obj.sourceMap\n\n  if (media) {\n    styleElement.setAttribute('media', media)\n  }\n  if (options.ssrId) {\n    styleElement.setAttribute(ssrIdKey, obj.id)\n  }\n\n  if (sourceMap) {\n    // https://developer.chrome.com/devtools/docs/javascript-debugging\n    // this makes source maps inside style tags work properly in Chrome\n    css += '\\n/*# sourceURL=' + sourceMap.sources[0] + ' */'\n    // http://stackoverflow.com/a/26603875\n    css += '\\n/*# sourceMappingURL=data:application/json;base64,' + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + ' */'\n  }\n\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = css\n  } else {\n    while (styleElement.firstChild) {\n      styleElement.removeChild(styleElement.firstChild)\n    }\n    styleElement.appendChild(document.createTextNode(css))\n  }\n}\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.settings-overlay[data-v-216a7ce1]{position:fixed;inset:0;z-index:10001;background:rgba(0,0,0,.82);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.settings-panel[data-v-216a7ce1]{width:min(1080px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0,100% 0,100% calc(100% - 12px),calc(100% - 12px) 100%,0 100%)}.settings-panel[data-v-216a7ce1]::before{content:\"\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.settings-panel[data-v-216a7ce1]{background-image:linear-gradient(rgba(255,255,255,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.03) 1px,transparent 1px);background-size:22px 22px}.panel-header[data-v-216a7ce1]{display:flex;align-items:center;justify-content:space-between;gap:14px;padding:14px 18px;border-bottom:2px solid #ffe100;background:rgba(0,0,0,.32)}.header-title[data-v-216a7ce1]{min-width:0}.header-title h3[data-v-216a7ce1]{margin:0;font-size:20px;line-height:1;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase}.header-title p[data-v-216a7ce1]{margin:4px 0 0;font-size:10px;color:#8d8d8d;letter-spacing:.14em;text-transform:uppercase}.close-btn[data-v-216a7ce1]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.close-btn[data-v-216a7ce1]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.close-btn[data-v-216a7ce1]:disabled{opacity:.45;cursor:not-allowed}.close-btn[data-v-216a7ce1]{min-width:88px;height:32px;padding:0 10px;font-size:12px}.panel-main[data-v-216a7ce1]{flex:1;min-height:0;display:grid;grid-template-columns:220px 1fr}.panel-nav[data-v-216a7ce1]{border-right:1px solid hsla(0,0%,100%,.16);padding:12px;overflow:auto}.panel-nav[data-v-216a7ce1]::-webkit-scrollbar{width:7px;height:7px}.panel-nav[data-v-216a7ce1]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-nav[data-v-216a7ce1]::-webkit-scrollbar-thumb{background:#555}.panel-nav[data-v-216a7ce1]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.nav-btn[data-v-216a7ce1]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.nav-btn[data-v-216a7ce1]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.nav-btn[data-v-216a7ce1]:disabled{opacity:.45;cursor:not-allowed}.nav-btn[data-v-216a7ce1]{width:100%;min-height:62px;padding:10px 12px;margin-bottom:10px;text-align:left;display:grid;grid-template-columns:auto 1fr;grid-template-areas:\"idx label\" \"idx sub\";-moz-column-gap:8px;column-gap:8px;row-gap:2px}.nav-btn[data-v-216a7ce1]:last-child{margin-bottom:0}.nav-btn.active[data-v-216a7ce1]{background:#ffe100;color:#000;border-color:#ffe100}.nav-index[data-v-216a7ce1]{grid-area:idx;align-self:center;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;color:#00dac2;font-size:18px}.nav-label[data-v-216a7ce1]{grid-area:label;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:13px;letter-spacing:.05em}.nav-sub[data-v-216a7ce1]{grid-area:sub;font-size:10px;color:#8d8d8d;letter-spacing:.06em}.panel-body[data-v-216a7ce1]{padding:14px 18px 16px;overflow:auto}.panel-body[data-v-216a7ce1]::-webkit-scrollbar{width:7px;height:7px}.panel-body[data-v-216a7ce1]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-body[data-v-216a7ce1]::-webkit-scrollbar-thumb{background:#555}.panel-body[data-v-216a7ce1]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.setting-section[data-v-216a7ce1]{max-width:740px}.setting-section h4[data-v-216a7ce1]{margin:0 0 12px;display:inline-flex;align-items:center;gap:8px;padding:4px 12px;background:#0f0f0f;border-left:4px solid #ffe100;transform:skewX(-14deg)}.setting-section h4[data-v-216a7ce1]>*{transform:skewX(14deg)}.section-index[data-v-216a7ce1]{color:#00dac2;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:13px}.section-label[data-v-216a7ce1]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:14px;letter-spacing:.04em}.section-sub[data-v-216a7ce1]{font-size:10px;color:#8d8d8d;letter-spacing:.06em}.form-group[data-v-216a7ce1]{margin-bottom:12px}.form-group>label[data-v-216a7ce1]{display:block;margin-bottom:5px;font-size:12px;color:#d5d5d5;line-height:1.35}.form-group>label>input[type=checkbox][data-v-216a7ce1]{margin-right:8px;accent-color:#00dac2}.form-group input[type=text][data-v-216a7ce1],.form-group input[type=password][data-v-216a7ce1],.form-group input[type=number][data-v-216a7ce1],.form-group select[data-v-216a7ce1],.form-group textarea[data-v-216a7ce1]{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.form-group input[type=text][data-v-216a7ce1]:focus,.form-group input[type=password][data-v-216a7ce1]:focus,.form-group input[type=number][data-v-216a7ce1]:focus,.form-group select[data-v-216a7ce1]:focus,.form-group textarea[data-v-216a7ce1]:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.form-group input[type=text][data-v-216a7ce1]::placeholder,.form-group input[type=password][data-v-216a7ce1]::placeholder,.form-group input[type=number][data-v-216a7ce1]::placeholder,.form-group select[data-v-216a7ce1]::placeholder,.form-group textarea[data-v-216a7ce1]::placeholder{color:#8d8d8d}.form-group textarea[data-v-216a7ce1]{resize:vertical;min-height:86px;font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;color:#fff}.form-group select[data-v-216a7ce1]{color:#fff;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif}.form-group select option[data-v-216a7ce1]{background:#101010;color:#fff}.form-group input[type=range][data-v-216a7ce1]{width:100%;-webkit-appearance:none;appearance:none;height:4px;border:none;background:#4a4a4a;border-radius:0;padding:0;margin:7px 0 4px}.form-group input[type=range][data-v-216a7ce1]::-webkit-slider-thumb{-webkit-appearance:none;width:12px;height:12px;background:#ffe100;border:2px solid #000;transform:rotate(45deg)}.form-group input[type=range][data-v-216a7ce1]::-moz-range-thumb{width:12px;height:12px;border:2px solid #000;border-radius:0;background:#ffe100;transform:rotate(45deg)}.form-group input[type=range][data-v-216a7ce1]::-moz-range-track{height:4px;background:#4a4a4a;border:none}.form-group input[type=checkbox][data-v-216a7ce1]{accent-color:#00dac2}.form-group .hint[data-v-216a7ce1]{margin-top:4px;font-size:11px;color:#8d8d8d}.hint-error[data-v-216a7ce1]{color:#ff3b30 !important}.form-row[data-v-216a7ce1]{display:flex;gap:12px;align-items:flex-start}.form-row .half[data-v-216a7ce1]{flex:1;min-width:0}.dice-sheet-list[data-v-216a7ce1]{margin-top:6px;display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:8px}.dice-sheet-item[data-v-216a7ce1]{display:flex;align-items:center;gap:8px;padding:6px 8px;border:1px solid hsla(0,0%,100%,.18);background:hsla(0,0%,100%,.04);font-size:12px;color:#e8e8e8;line-height:1.35}.dice-sheet-item input[type=checkbox][data-v-216a7ce1]{margin:0}.input-with-btn[data-v-216a7ce1]{display:grid;grid-template-columns:1fr auto;gap:8px;align-items:stretch}.input-with-btn .input-btn[data-v-216a7ce1]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.input-with-btn .input-btn[data-v-216a7ce1]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.input-with-btn .input-btn[data-v-216a7ce1]:disabled{opacity:.45;cursor:not-allowed}.input-with-btn .input-btn[data-v-216a7ce1]{min-width:84px;padding:0 12px;font-size:11px;white-space:nowrap}.model-list[data-v-216a7ce1]{display:flex;flex-wrap:wrap;gap:8px}.hidden-file-input[data-v-216a7ce1]{display:none}.local-model-info[data-v-216a7ce1]{margin-top:6px;padding:8px 10px;border:1px solid hsla(0,0%,100%,.16);background:hsla(0,0%,100%,.04);font-size:12px;line-height:1.45;color:#e8e8e8}.model-btn[data-v-216a7ce1]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.model-btn[data-v-216a7ce1]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.model-btn[data-v-216a7ce1]:disabled{opacity:.45;cursor:not-allowed}.model-btn[data-v-216a7ce1]{min-height:30px;padding:0 12px;font-size:12px;text-transform:none;letter-spacing:.03em}.model-btn.active[data-v-216a7ce1]{background:#ffe100;border-color:#ffe100;color:#000}.model-btn.browse-btn[data-v-216a7ce1]{border-color:rgba(0,218,194,.55);color:#b2fff6}.model-btn.browse-btn[data-v-216a7ce1]:hover{background:#00dac2;border-color:#00dac2;color:#000}.emotion-layout[data-v-216a7ce1]{display:grid;grid-template-columns:minmax(0,1fr) 340px;gap:14px;align-items:start}.emotion-configs[data-v-216a7ce1]{min-width:0}.emotion-preview-panel[data-v-216a7ce1]{position:sticky;top:10px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.28);padding:10px 12px 12px;background-image:linear-gradient(rgba(255,255,255,0.02) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.02) 1px,transparent 1px);background-size:18px 18px}.emotion-preview-header[data-v-216a7ce1]{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:10px}.emotion-preview-title[data-v-216a7ce1]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:700;letter-spacing:.08em;color:#00dac2}.emotion-preview-tag[data-v-216a7ce1]{font-size:12px;color:hsla(0,0%,100%,.78)}.emotion-preview-canvas[data-v-216a7ce1]{position:relative;width:100%;aspect-ratio:3/4;border-radius:10px;overflow:hidden;background:rgba(15,23,42,.95);border:1px solid hsla(0,0%,100%,.18)}.emotion-preview-interact[data-v-216a7ce1]{position:absolute;inset:0;z-index:3}.emotion-preview-empty[data-v-216a7ce1]{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;padding:10px;text-align:center;z-index:4;pointer-events:none;color:hsla(0,0%,100%,.78);font-size:12px}.emotion-preview-controls[data-v-216a7ce1]{margin-top:10px;display:flex;flex-direction:column;gap:8px}.emotion-zoom-row[data-v-216a7ce1]{display:grid;grid-template-columns:auto 1fr auto;gap:10px;align-items:center}.zoom-label[data-v-216a7ce1]{font-size:12px;color:hsla(0,0%,100%,.78)}.zoom-value[data-v-216a7ce1]{font-size:12px;color:#ffe100;font-variant-numeric:tabular-nums}.emotion-preview-actions[data-v-216a7ce1]{display:flex;gap:8px}.emotion-tag[data-v-216a7ce1]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:700;letter-spacing:.08em;color:#ffe100;text-transform:uppercase}.emotion-map-table[data-v-216a7ce1]{margin-top:4px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.22);max-height:none;overflow:visible;background-image:linear-gradient(rgba(255,255,255,0.02) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.02) 1px,transparent 1px);background-size:20px 20px}.emotion-map-head[data-v-216a7ce1],.emotion-map-row[data-v-216a7ce1]{display:grid;grid-template-columns:72px 22px minmax(0,1fr) minmax(0,1fr) 52px;gap:10px;align-items:center}.emotion-map-head[data-v-216a7ce1]{position:sticky;top:0;z-index:2;padding:8px 10px;font-size:10px;color:hsla(0,0%,100%,.68);letter-spacing:.03em;background:rgba(2,8,20,.92);border-bottom:1px solid hsla(0,0%,100%,.2)}.emotion-map-row[data-v-216a7ce1]{padding:10px;border-bottom:1px solid hsla(0,0%,100%,.12)}.emotion-map-row[data-v-216a7ce1]:nth-child(odd){background:hsla(0,0%,100%,.02)}.emotion-map-tag[data-v-216a7ce1]{font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:700;letter-spacing:.08em;color:#ffe100}.emotion-map-arrow[data-v-216a7ce1]{text-align:center;color:hsla(0,0%,100%,.78);font-size:18px;line-height:1}.emotion-map-preview-btn[data-v-216a7ce1]{min-width:0;width:44px;height:32px;padding:0;font-size:14px;line-height:1}.emotion-map-row select[data-v-216a7ce1]{width:100%;min-width:0;text-overflow:ellipsis;white-space:nowrap}.emotion-advanced-list[data-v-216a7ce1]{margin-top:10px;display:flex;flex-direction:column;gap:10px}.emotion-advanced-item[data-v-216a7ce1]{border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.28);padding:10px 12px 2px;background-image:linear-gradient(rgba(255,255,255,0.025) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.025) 1px,transparent 1px);background-size:18px 18px}.emotion-advanced-title[data-v-216a7ce1]{margin-bottom:8px;font-size:12px;letter-spacing:.06em;color:hsla(0,0%,100%,.85)}.advanced-toggle[data-v-216a7ce1]{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border:1px solid hsla(0,0%,100%,.2);background:hsla(0,0%,100%,.04);font-size:11px;color:#d5d5d5;cursor:pointer;-webkit-user-select:none;user-select:none;clip-path:polygon(0 0,100% 0,100% calc(100% - 8px),calc(100% - 8px) 100%,0 100%)}.advanced-toggle[data-v-216a7ce1]:hover{border-color:rgba(255,225,0,.65);color:#ffe100}.advanced-toggle .toggle-icon[data-v-216a7ce1]{width:12px;text-align:center;color:#00dac2}.advanced-params[data-v-216a7ce1]{margin-top:8px;padding-top:10px;border-top:1px dashed hsla(0,0%,100%,.2)}.about-card[data-v-216a7ce1]{margin-bottom:12px;padding:10px 12px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.26);background-image:linear-gradient(rgba(255,255,255,0.02) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.02) 1px,transparent 1px);background-size:18px 18px}.about-title[data-v-216a7ce1]{margin-bottom:8px;font-size:12px;letter-spacing:.06em;color:#ffe100}.about-link[data-v-216a7ce1]{color:#00dac2;word-break:break-all;text-decoration:underline}.about-list[data-v-216a7ce1]{margin:0;padding-left:18px;display:flex;flex-direction:column;gap:8px;font-size:12px;line-height:1.5;color:#d5d5d5}.status-badge[data-v-216a7ce1]{margin-left:8px;font-size:12px}.status-success[data-v-216a7ce1]{color:#00dac2}.status-fail[data-v-216a7ce1]{color:#ff9c94}.panel-footer[data-v-216a7ce1]{display:flex;justify-content:flex-end;gap:10px;padding:12px 18px 14px;border-top:1px solid hsla(0,0%,100%,.18);background:rgba(0,0,0,.36)}.btn[data-v-216a7ce1]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.btn[data-v-216a7ce1]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.btn[data-v-216a7ce1]:disabled{opacity:.45;cursor:not-allowed}.btn[data-v-216a7ce1]{min-width:100px;height:34px;padding:0 14px;font-size:12px}.btn-primary[data-v-216a7ce1]{background:#ffe100;color:#000;border-color:#ffe100}.btn-secondary[data-v-216a7ce1]{background:hsla(0,0%,100%,.06);border-color:hsla(0,0%,100%,.3)}.btn-test[data-v-216a7ce1]{min-width:96px;background:rgba(0,218,194,.1);border-color:rgba(0,218,194,.6);color:#bcfff7}.btn-test[data-v-216a7ce1]:hover:not(:disabled){background:#00dac2;border-color:#00dac2;color:#000}.browser-overlay[data-v-216a7ce1]{position:fixed;inset:0;z-index:10002;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.browser-dialog[data-v-216a7ce1]{width:min(980px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0,100% 0,100% calc(100% - 12px),calc(100% - 12px) 100%,0 100%)}.browser-dialog[data-v-216a7ce1]::before{content:\"\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.browser-dialog[data-v-216a7ce1]{background-image:linear-gradient(rgba(255,255,255,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.03) 1px,transparent 1px);background-size:22px 22px}.browser-dialog-header[data-v-216a7ce1]{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 18px;border-bottom:1px solid rgba(255,225,0,.36);background:rgba(0,0,0,.28)}.browser-dialog-header h3[data-v-216a7ce1]{margin:0;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:15px;letter-spacing:.08em}.browser-dialog-header .close-btn[data-v-216a7ce1]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.browser-dialog-header .close-btn[data-v-216a7ce1]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.browser-dialog-header .close-btn[data-v-216a7ce1]:disabled{opacity:.45;cursor:not-allowed}.browser-dialog-header .close-btn[data-v-216a7ce1]{width:34px;height:28px;padding:0;line-height:1;font-size:16px}.browser-dialog-body[data-v-216a7ce1]{padding:14px 18px 16px;overflow:auto;flex:1}.browser-dialog-body[data-v-216a7ce1]::-webkit-scrollbar{width:7px;height:7px}.browser-dialog-body[data-v-216a7ce1]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.browser-dialog-body[data-v-216a7ce1]::-webkit-scrollbar-thumb{background:#555}.browser-dialog-body[data-v-216a7ce1]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.gpt-model-dialog[data-v-216a7ce1]{width:min(1240px,100vw - 24px)}.gpt-model-editor-dialog[data-v-216a7ce1]{width:min(1080px,100vw - 24px)}.gpt-model-header[data-v-216a7ce1]{align-items:flex-start}.gpt-model-header-actions[data-v-216a7ce1]{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end;align-items:center}.gpt-model-header-actions .btn[data-v-216a7ce1]{min-width:84px;height:30px;padding:0 10px;font-size:11px}.gpt-model-body[data-v-216a7ce1]{display:flex;flex-direction:column;gap:10px}.gpt-model-tools[data-v-216a7ce1]{display:grid;grid-template-columns:minmax(0,1fr) auto auto;gap:8px;align-items:center}.gpt-model-tools input[data-v-216a7ce1]{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.gpt-model-tools input[data-v-216a7ce1]:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.gpt-model-tools input[data-v-216a7ce1]::placeholder{color:#8d8d8d}.gpt-model-card-list[data-v-216a7ce1]{display:flex;flex-direction:column;gap:10px}.gpt-model-card[data-v-216a7ce1]{border:1px solid hsla(0,0%,100%,.18);background:hsla(0,0%,100%,.03);padding:10px 12px;background-image:linear-gradient(rgba(255,255,255,0.02) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.02) 1px,transparent 1px);background-size:18px 18px}.gpt-model-card-head[data-v-216a7ce1]{display:flex;align-items:center;justify-content:space-between;gap:10px}.gpt-model-card-head label[data-v-216a7ce1]{display:inline-flex;align-items:center;gap:8px;font-size:12px}.gpt-model-id[data-v-216a7ce1]{font-size:11px;color:hsla(0,0%,100%,.65);font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;word-break:break-all}.gpt-model-card-actions[data-v-216a7ce1]{margin-top:6px;display:flex;flex-wrap:wrap;gap:8px}.gpt-model-card-actions .btn[data-v-216a7ce1]{min-width:110px}.gpt-ref-list[data-v-216a7ce1]{display:flex;flex-direction:column;gap:10px;margin-bottom:8px}.gpt-ref-item[data-v-216a7ce1]{border:1px solid hsla(0,0%,100%,.16);background:hsla(0,0%,100%,.02);padding:10px}.gpt-ref-actions[data-v-216a7ce1]{display:flex;gap:8px;align-items:flex-end;flex-wrap:wrap}.gpt-expression-map-list[data-v-216a7ce1]{display:flex;flex-direction:column;gap:8px;margin-bottom:8px}.gpt-expression-map-row[data-v-216a7ce1]{display:grid;grid-template-columns:minmax(0,1fr) minmax(0,1fr) auto;gap:8px;align-items:center}.gpt-expression-map-row input[data-v-216a7ce1],.gpt-expression-map-row select[data-v-216a7ce1]{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\"JetBrains Mono\",\"Consolas\",\"Courier New\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.gpt-expression-map-row input[data-v-216a7ce1]:focus,.gpt-expression-map-row select[data-v-216a7ce1]:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.gpt-expression-map-row input[data-v-216a7ce1]::placeholder,.gpt-expression-map-row select[data-v-216a7ce1]::placeholder{color:#8d8d8d}.gpt-expression-map-row input[data-v-216a7ce1],.gpt-expression-map-row select[data-v-216a7ce1]{width:100%}@media (max-width:860px){.settings-overlay[data-v-216a7ce1]{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.settings-panel[data-v-216a7ce1]{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}.settings-panel[data-v-216a7ce1]::before{width:40px}.panel-main[data-v-216a7ce1]{grid-template-columns:1fr;grid-template-rows:auto 1fr;min-height:0}.panel-nav[data-v-216a7ce1]{border-right:none;border-bottom:1px solid hsla(0,0%,100%,.16);display:flex;gap:6px;padding:8px 10px;overflow-x:auto;overflow-y:hidden}.panel-nav[data-v-216a7ce1]::-webkit-scrollbar{width:7px;height:7px}.panel-nav[data-v-216a7ce1]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-nav[data-v-216a7ce1]::-webkit-scrollbar-thumb{background:#555}.panel-nav[data-v-216a7ce1]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.nav-btn[data-v-216a7ce1]{flex:0 0 auto;width:150px;min-height:42px;padding:6px 10px;margin-bottom:0;grid-template-areas:\"idx label\";grid-template-columns:auto 1fr;row-gap:0;align-items:center}.panel-body[data-v-216a7ce1]{min-height:0}.nav-index[data-v-216a7ce1]{font-size:16px}.nav-label[data-v-216a7ce1]{font-size:12px}.nav-sub[data-v-216a7ce1]{display:none}.browser-overlay[data-v-216a7ce1]{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.browser-dialog[data-v-216a7ce1]{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}.gpt-model-dialog[data-v-216a7ce1],.gpt-model-editor-dialog[data-v-216a7ce1]{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px)}.gpt-model-tools[data-v-216a7ce1]{grid-template-columns:1fr}.gpt-expression-map-row[data-v-216a7ce1]{grid-template-columns:1fr}.emotion-layout[data-v-216a7ce1]{grid-template-columns:1fr}.emotion-preview-panel[data-v-216a7ce1]{order:-1;position:sticky;top:8px;z-index:8;margin-bottom:8px;padding:8px 10px 10px;background:rgba(0,0,0,.9)}.emotion-preview-header[data-v-216a7ce1]{margin-bottom:6px}.emotion-preview-canvas[data-v-216a7ce1]{aspect-ratio:16/9;max-height:210px}.emotion-preview-controls[data-v-216a7ce1]{margin-top:8px;gap:6px}.emotion-map-head[data-v-216a7ce1]{position:static}.emotion-preview-controls .hint[data-v-216a7ce1]{display:none}}@media (max-width:620px){.settings-overlay[data-v-216a7ce1]{align-items:stretch;padding:0}.settings-panel[data-v-216a7ce1]{width:100vw;max-height:100dvh;border-left:none;border-right:none;box-shadow:none}.panel-header[data-v-216a7ce1]{padding:10px 12px}.header-title h3[data-v-216a7ce1]{font-size:15px;letter-spacing:.06em}.header-title p[data-v-216a7ce1]{display:none}.panel-nav[data-v-216a7ce1]{padding:6px 8px}.nav-btn[data-v-216a7ce1]{width:126px;min-height:38px;padding:5px 8px}.nav-index[data-v-216a7ce1]{font-size:14px}.nav-label[data-v-216a7ce1]{font-size:11px;letter-spacing:.04em}.close-btn[data-v-216a7ce1]{min-width:66px;height:28px;padding:0 8px;font-size:11px}.panel-footer[data-v-216a7ce1]{padding:10px 12px calc(10px + env(safe-area-inset-bottom))}.panel-body[data-v-216a7ce1]{padding:8px 10px}.form-row[data-v-216a7ce1]{flex-direction:column;gap:0}.input-with-btn[data-v-216a7ce1]{grid-template-columns:1fr}.btn[data-v-216a7ce1]{min-width:86px}.emotion-preview-panel[data-v-216a7ce1]{top:6px;padding:8px}.emotion-preview-canvas[data-v-216a7ce1]{max-height:180px}.emotion-map-head[data-v-216a7ce1],.emotion-map-row[data-v-216a7ce1]{grid-template-columns:56px 16px minmax(0,1fr) minmax(0,1fr) 42px;gap:6px}.emotion-map-row[data-v-216a7ce1]{padding:8px}.emotion-map-arrow[data-v-216a7ce1]{font-size:14px}.emotion-map-preview-btn[data-v-216a7ce1]{width:38px;height:30px;font-size:12px}.browser-overlay[data-v-216a7ce1]{align-items:stretch;padding:0}.browser-dialog[data-v-216a7ce1]{width:100vw;max-height:100dvh;box-shadow:none;clip-path:none}.gpt-model-dialog[data-v-216a7ce1],.gpt-model-editor-dialog[data-v-216a7ce1]{width:100vw;max-height:100dvh;box-shadow:none;clip-path:none}.browser-dialog-header[data-v-216a7ce1]{padding:12px}.browser-dialog-body[data-v-216a7ce1]{padding:10px 12px 12px}.gpt-model-header-actions[data-v-216a7ce1]{width:100%;justify-content:flex-start}.gpt-model-card-actions .btn[data-v-216a7ce1]{min-width:0;flex:1 1 120px}}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/SettingsPanel.vue\"],\"names\":[],\"mappings\":\"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\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.settings-overlay{position:fixed;inset:0;z-index:10001;background:rgba(0,0,0,.82);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.settings-panel{width:min(1080px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%)}.settings-panel::before{content:\\\"\\\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.settings-panel{background-image:linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);background-size:22px 22px}.panel-header{display:flex;align-items:center;justify-content:space-between;gap:14px;padding:14px 18px;border-bottom:2px solid #ffe100;background:rgba(0,0,0,.32)}.header-title{min-width:0}.header-title h3{margin:0;font-size:20px;line-height:1;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase}.header-title p{margin:4px 0 0;font-size:10px;color:#8d8d8d;letter-spacing:.14em;text-transform:uppercase}.close-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.close-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.close-btn:disabled{opacity:.45;cursor:not-allowed}.close-btn{min-width:88px;height:32px;padding:0 10px;font-size:12px}.panel-main{flex:1;min-height:0;display:grid;grid-template-columns:220px 1fr}.panel-nav{border-right:1px solid hsla(0,0%,100%,.16);padding:12px;overflow:auto}.panel-nav::-webkit-scrollbar{width:7px;height:7px}.panel-nav::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-nav::-webkit-scrollbar-thumb{background:#555}.panel-nav::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.nav-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.nav-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.nav-btn:disabled{opacity:.45;cursor:not-allowed}.nav-btn{width:100%;min-height:62px;padding:10px 12px;margin-bottom:10px;text-align:left;display:grid;grid-template-columns:auto 1fr;grid-template-areas:\\\"idx label\\\" \\\"idx sub\\\";column-gap:8px;row-gap:2px}.nav-btn:last-child{margin-bottom:0}.nav-btn.active{background:#ffe100;color:#000;border-color:#ffe100}.nav-index{grid-area:idx;align-self:center;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;color:#00dac2;font-size:18px}.nav-label{grid-area:label;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:13px;letter-spacing:.05em}.nav-sub{grid-area:sub;font-size:10px;color:#8d8d8d;letter-spacing:.06em}.panel-body{padding:14px 18px 16px;overflow:auto}.panel-body::-webkit-scrollbar{width:7px;height:7px}.panel-body::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-body::-webkit-scrollbar-thumb{background:#555}.panel-body::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.setting-section{max-width:740px}.setting-section h4{margin:0 0 12px;display:inline-flex;align-items:center;gap:8px;padding:4px 12px;background:#0f0f0f;border-left:4px solid #ffe100;transform:skewX(-14deg)}.setting-section h4>*{transform:skewX(14deg)}.section-index{color:#00dac2;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:13px}.section-label{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:14px;letter-spacing:.04em}.section-sub{font-size:10px;color:#8d8d8d;letter-spacing:.06em}.form-group{margin-bottom:12px}.form-group>label{display:block;margin-bottom:5px;font-size:12px;color:#d5d5d5;line-height:1.35}.form-group>label>input[type=checkbox]{margin-right:8px;accent-color:#00dac2}.form-group input[type=text],.form-group input[type=password],.form-group input[type=number],.form-group select,.form-group textarea{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.form-group input[type=text]:focus,.form-group input[type=password]:focus,.form-group input[type=number]:focus,.form-group select:focus,.form-group textarea:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.form-group input[type=text]::placeholder,.form-group input[type=password]::placeholder,.form-group input[type=number]::placeholder,.form-group select::placeholder,.form-group textarea::placeholder{color:#8d8d8d}.form-group textarea{resize:vertical;min-height:86px;font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;color:#fff}.form-group select{color:#fff;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif}.form-group select option{background:#101010;color:#fff}.form-group input[type=range]{width:100%;appearance:none;height:4px;border:none;background:#4a4a4a;border-radius:0;padding:0;margin:7px 0 4px}.form-group input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:12px;height:12px;background:#ffe100;border:2px solid #000;transform:rotate(45deg)}.form-group input[type=range]::-moz-range-thumb{width:12px;height:12px;border:2px solid #000;border-radius:0;background:#ffe100;transform:rotate(45deg)}.form-group input[type=range]::-moz-range-track{height:4px;background:#4a4a4a;border:none}.form-group input[type=checkbox]{accent-color:#00dac2}.form-group .hint{margin-top:4px;font-size:11px;color:#8d8d8d}.hint-error{color:#ff3b30 !important}.form-row{display:flex;gap:12px;align-items:flex-start}.form-row .half{flex:1;min-width:0}.dice-sheet-list{margin-top:6px;display:grid;grid-template-columns:repeat(auto-fit, minmax(180px, 1fr));gap:8px}.dice-sheet-item{display:flex;align-items:center;gap:8px;padding:6px 8px;border:1px solid hsla(0,0%,100%,.18);background:hsla(0,0%,100%,.04);font-size:12px;color:#e8e8e8;line-height:1.35}.dice-sheet-item input[type=checkbox]{margin:0}.input-with-btn{display:grid;grid-template-columns:1fr auto;gap:8px;align-items:stretch}.input-with-btn .input-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.input-with-btn .input-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.input-with-btn .input-btn:disabled{opacity:.45;cursor:not-allowed}.input-with-btn .input-btn{min-width:84px;padding:0 12px;font-size:11px;white-space:nowrap}.model-list{display:flex;flex-wrap:wrap;gap:8px}.hidden-file-input{display:none}.local-model-info{margin-top:6px;padding:8px 10px;border:1px solid hsla(0,0%,100%,.16);background:hsla(0,0%,100%,.04);font-size:12px;line-height:1.45;color:#e8e8e8}.model-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.model-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.model-btn:disabled{opacity:.45;cursor:not-allowed}.model-btn{min-height:30px;padding:0 12px;font-size:12px;text-transform:none;letter-spacing:.03em}.model-btn.active{background:#ffe100;border-color:#ffe100;color:#000}.model-btn.browse-btn{border-color:rgba(0,218,194,.55);color:#b2fff6}.model-btn.browse-btn:hover{background:#00dac2;border-color:#00dac2;color:#000}.emotion-layout{display:grid;grid-template-columns:minmax(0, 1fr) 340px;gap:14px;align-items:start}.emotion-configs{min-width:0}.emotion-preview-panel{position:sticky;top:10px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.28);padding:10px 12px 12px;background-image:linear-gradient(rgba(255, 255, 255, 0.02) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.02) 1px, transparent 1px);background-size:18px 18px}.emotion-preview-header{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:10px}.emotion-preview-title{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:700;letter-spacing:.08em;color:#00dac2}.emotion-preview-tag{font-size:12px;color:hsla(0,0%,100%,.78)}.emotion-preview-canvas{position:relative;width:100%;aspect-ratio:3/4;border-radius:10px;overflow:hidden;background:rgba(15,23,42,.95);border:1px solid hsla(0,0%,100%,.18)}.emotion-preview-interact{position:absolute;inset:0;z-index:3}.emotion-preview-empty{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;padding:10px;text-align:center;z-index:4;pointer-events:none;color:hsla(0,0%,100%,.78);font-size:12px}.emotion-preview-controls{margin-top:10px;display:flex;flex-direction:column;gap:8px}.emotion-zoom-row{display:grid;grid-template-columns:auto 1fr auto;gap:10px;align-items:center}.zoom-label{font-size:12px;color:hsla(0,0%,100%,.78)}.zoom-value{font-size:12px;color:#ffe100;font-variant-numeric:tabular-nums}.emotion-preview-actions{display:flex;gap:8px}.emotion-tag{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:700;letter-spacing:.08em;color:#ffe100;text-transform:uppercase}.emotion-map-table{margin-top:4px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.22);max-height:none;overflow:visible;background-image:linear-gradient(rgba(255, 255, 255, 0.02) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.02) 1px, transparent 1px);background-size:20px 20px}.emotion-map-head,.emotion-map-row{display:grid;grid-template-columns:72px 22px minmax(0, 1fr) minmax(0, 1fr) 52px;gap:10px;align-items:center}.emotion-map-head{position:sticky;top:0;z-index:2;padding:8px 10px;font-size:10px;color:hsla(0,0%,100%,.68);letter-spacing:.03em;background:rgba(2,8,20,.92);border-bottom:1px solid hsla(0,0%,100%,.2)}.emotion-map-row{padding:10px;border-bottom:1px solid hsla(0,0%,100%,.12)}.emotion-map-row:nth-child(odd){background:hsla(0,0%,100%,.02)}.emotion-map-tag{font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:700;letter-spacing:.08em;color:#ffe100}.emotion-map-arrow{text-align:center;color:hsla(0,0%,100%,.78);font-size:18px;line-height:1}.emotion-map-preview-btn{min-width:0;width:44px;height:32px;padding:0;font-size:14px;line-height:1}.emotion-map-row select{width:100%;min-width:0;text-overflow:ellipsis;white-space:nowrap}.emotion-advanced-list{margin-top:10px;display:flex;flex-direction:column;gap:10px}.emotion-advanced-item{border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.28);padding:10px 12px 2px;background-image:linear-gradient(rgba(255, 255, 255, 0.025) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.025) 1px, transparent 1px);background-size:18px 18px}.emotion-advanced-title{margin-bottom:8px;font-size:12px;letter-spacing:.06em;color:hsla(0,0%,100%,.85)}.advanced-toggle{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border:1px solid hsla(0,0%,100%,.2);background:hsla(0,0%,100%,.04);font-size:11px;color:#d5d5d5;cursor:pointer;user-select:none;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 8px), calc(100% - 8px) 100%, 0 100%)}.advanced-toggle:hover{border-color:rgba(255,225,0,.65);color:#ffe100}.advanced-toggle .toggle-icon{width:12px;text-align:center;color:#00dac2}.advanced-params{margin-top:8px;padding-top:10px;border-top:1px dashed hsla(0,0%,100%,.2)}.about-card{margin-bottom:12px;padding:10px 12px;border:1px solid hsla(0,0%,100%,.16);background:rgba(0,0,0,.26);background-image:linear-gradient(rgba(255, 255, 255, 0.02) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.02) 1px, transparent 1px);background-size:18px 18px}.about-title{margin-bottom:8px;font-size:12px;letter-spacing:.06em;color:#ffe100}.about-link{color:#00dac2;word-break:break-all;text-decoration:underline}.about-list{margin:0;padding-left:18px;display:flex;flex-direction:column;gap:8px;font-size:12px;line-height:1.5;color:#d5d5d5}.status-badge{margin-left:8px;font-size:12px}.status-success{color:#00dac2}.status-fail{color:#ff9c94}.panel-footer{display:flex;justify-content:flex-end;gap:10px;padding:12px 18px 14px;border-top:1px solid hsla(0,0%,100%,.18);background:rgba(0,0,0,.36)}.btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.btn:disabled{opacity:.45;cursor:not-allowed}.btn{min-width:100px;height:34px;padding:0 14px;font-size:12px}.btn-primary{background:#ffe100;color:#000;border-color:#ffe100}.btn-secondary{background:hsla(0,0%,100%,.06);border-color:hsla(0,0%,100%,.3)}.btn-test{min-width:96px;background:rgba(0,218,194,.1);border-color:rgba(0,218,194,.6);color:#bcfff7}.btn-test:hover:not(:disabled){background:#00dac2;border-color:#00dac2;color:#000}.browser-overlay{position:fixed;inset:0;z-index:10002;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.browser-dialog{width:min(980px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%)}.browser-dialog::before{content:\\\"\\\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.browser-dialog{background-image:linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);background-size:22px 22px}.browser-dialog-header{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 18px;border-bottom:1px solid rgba(255,225,0,.36);background:rgba(0,0,0,.28)}.browser-dialog-header h3{margin:0;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:15px;letter-spacing:.08em}.browser-dialog-header .close-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.browser-dialog-header .close-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.browser-dialog-header .close-btn:disabled{opacity:.45;cursor:not-allowed}.browser-dialog-header .close-btn{width:34px;height:28px;padding:0;line-height:1;font-size:16px}.browser-dialog-body{padding:14px 18px 16px;overflow:auto;flex:1}.browser-dialog-body::-webkit-scrollbar{width:7px;height:7px}.browser-dialog-body::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.browser-dialog-body::-webkit-scrollbar-thumb{background:#555}.browser-dialog-body::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.gpt-model-dialog{width:min(1240px,100vw - 24px)}.gpt-model-editor-dialog{width:min(1080px,100vw - 24px)}.gpt-model-header{align-items:flex-start}.gpt-model-header-actions{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end;align-items:center}.gpt-model-header-actions .btn{min-width:84px;height:30px;padding:0 10px;font-size:11px}.gpt-model-body{display:flex;flex-direction:column;gap:10px}.gpt-model-tools{display:grid;grid-template-columns:minmax(0, 1fr) auto auto;gap:8px;align-items:center}.gpt-model-tools input{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.gpt-model-tools input:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.gpt-model-tools input::placeholder{color:#8d8d8d}.gpt-model-card-list{display:flex;flex-direction:column;gap:10px}.gpt-model-card{border:1px solid hsla(0,0%,100%,.18);background:hsla(0,0%,100%,.03);padding:10px 12px;background-image:linear-gradient(rgba(255, 255, 255, 0.02) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.02) 1px, transparent 1px);background-size:18px 18px}.gpt-model-card-head{display:flex;align-items:center;justify-content:space-between;gap:10px}.gpt-model-card-head label{display:inline-flex;align-items:center;gap:8px;font-size:12px}.gpt-model-id{font-size:11px;color:hsla(0,0%,100%,.65);font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;word-break:break-all}.gpt-model-card-actions{margin-top:6px;display:flex;flex-wrap:wrap;gap:8px}.gpt-model-card-actions .btn{min-width:110px}.gpt-ref-list{display:flex;flex-direction:column;gap:10px;margin-bottom:8px}.gpt-ref-item{border:1px solid hsla(0,0%,100%,.16);background:hsla(0,0%,100%,.02);padding:10px}.gpt-ref-actions{display:flex;gap:8px;align-items:flex-end;flex-wrap:wrap}.gpt-expression-map-list{display:flex;flex-direction:column;gap:8px;margin-bottom:8px}.gpt-expression-map-row{display:grid;grid-template-columns:minmax(0, 1fr) minmax(0, 1fr) auto;gap:8px;align-items:center}.gpt-expression-map-row input,.gpt-expression-map-row select{width:100%;box-sizing:border-box;padding:8px 10px;border:1px solid #3b3b3b;border-bottom:2px solid #585858;border-radius:0;background:rgba(0,0,0,.56);color:#ffe100;font-family:\\\"JetBrains Mono\\\",\\\"Consolas\\\",\\\"Courier New\\\",monospace;font-size:13px;outline:none;transition:border-color .18s ease,background .18s ease}.gpt-expression-map-row input:focus,.gpt-expression-map-row select:focus{border-color:#ffe100;background:rgba(255,225,0,.08)}.gpt-expression-map-row input::placeholder,.gpt-expression-map-row select::placeholder{color:#8d8d8d}.gpt-expression-map-row input,.gpt-expression-map-row select{width:100%}@media(max-width: 860px){.settings-overlay{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.settings-panel{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}.settings-panel::before{width:40px}.panel-main{grid-template-columns:1fr;grid-template-rows:auto 1fr;min-height:0}.panel-nav{border-right:none;border-bottom:1px solid hsla(0,0%,100%,.16);display:flex;gap:6px;padding:8px 10px;overflow-x:auto;overflow-y:hidden}.panel-nav::-webkit-scrollbar{width:7px;height:7px}.panel-nav::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.panel-nav::-webkit-scrollbar-thumb{background:#555}.panel-nav::-webkit-scrollbar-thumb:hover{background:#6f6f6f}.nav-btn{flex:0 0 auto;width:150px;min-height:42px;padding:6px 10px;margin-bottom:0;grid-template-areas:\\\"idx label\\\";grid-template-columns:auto 1fr;row-gap:0;align-items:center}.panel-body{min-height:0}.nav-index{font-size:16px}.nav-label{font-size:12px}.nav-sub{display:none}.browser-overlay{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.browser-dialog{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}.gpt-model-dialog,.gpt-model-editor-dialog{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px)}.gpt-model-tools{grid-template-columns:1fr}.gpt-expression-map-row{grid-template-columns:1fr}.emotion-layout{grid-template-columns:1fr}.emotion-preview-panel{order:-1;position:sticky;top:8px;z-index:8;margin-bottom:8px;padding:8px 10px 10px;background:rgba(0,0,0,.9)}.emotion-preview-header{margin-bottom:6px}.emotion-preview-canvas{aspect-ratio:16/9;max-height:210px}.emotion-preview-controls{margin-top:8px;gap:6px}.emotion-map-head{position:static}.emotion-preview-controls .hint{display:none}}@media(max-width: 620px){.settings-overlay{align-items:stretch;padding:0}.settings-panel{width:100vw;max-height:100dvh;border-left:none;border-right:none;box-shadow:none}.panel-header{padding:10px 12px}.header-title h3{font-size:15px;letter-spacing:.06em}.header-title p{display:none}.panel-nav{padding:6px 8px}.nav-btn{width:126px;min-height:38px;padding:5px 8px}.nav-index{font-size:14px}.nav-label{font-size:11px;letter-spacing:.04em}.close-btn{min-width:66px;height:28px;padding:0 8px;font-size:11px}.panel-footer{padding:10px 12px calc(10px + env(safe-area-inset-bottom))}.panel-body{padding:8px 10px}.form-row{flex-direction:column;gap:0}.input-with-btn{grid-template-columns:1fr}.btn{min-width:86px}.emotion-preview-panel{top:6px;padding:8px}.emotion-preview-canvas{max-height:180px}.emotion-map-head,.emotion-map-row{grid-template-columns:56px 16px minmax(0, 1fr) minmax(0, 1fr) 42px;gap:6px}.emotion-map-row{padding:8px}.emotion-map-arrow{font-size:14px}.emotion-map-preview-btn{width:38px;height:30px;font-size:12px}.browser-overlay{align-items:stretch;padding:0}.browser-dialog{width:100vw;max-height:100dvh;box-shadow:none;clip-path:none}.gpt-model-dialog,.gpt-model-editor-dialog{width:100vw;max-height:100dvh;box-shadow:none;clip-path:none}.browser-dialog-header{padding:12px}.browser-dialog-body{padding:10px 12px 12px}.gpt-model-header-actions{width:100%;justify-content:flex-start}.gpt-model-card-actions .btn{min-width:0;flex:1 1 120px}}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./TreeNode.vue?vue&type=style&index=0&id=3a6a95ba&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"bd0944e8\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./TreeNode.vue?vue&type=style&index=0&id=3a6a95ba&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./TreeNode.vue?vue&type=style&index=0&id=3a6a95ba&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.chat-bubble[data-v-98097aea]{position:fixed;transform:translate(-50%,-100%);max-width:320px;min-width:80px;animation:bubble-in-98097aea .22s ease-out;z-index:10004;pointer-events:none}.bubble-content[data-v-98097aea]{position:relative;background:rgba(14,14,14,.96);color:#fff;border:1px solid #ffe100;padding:9px 26px 10px 13px;clip-path:polygon(10px 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%,0 10px);font-size:12px;line-height:1.5;word-break:break-word;box-shadow:8px 8px 0 rgba(0,0,0,.56);font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif;pointer-events:auto}.bubble-content[data-v-98097aea]::after{content:\"\";position:absolute;right:22px;bottom:-2px;width:30px;height:3px;background:#ffe100}.bubble-text[data-v-98097aea]{white-space:pre-wrap}.cursor[data-v-98097aea]{animation:blink-98097aea .64s infinite;margin-left:1px;color:#00dac2}.bubble-close[data-v-98097aea]{position:absolute;right:6px;top:5px;width:15px;height:15px;border:1px solid hsla(0,0%,100%,.3);background:hsla(0,0%,100%,.08);color:#fff;line-height:13px;text-align:center;cursor:pointer;font-size:10px;padding:0;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif}.bubble-close[data-v-98097aea]:hover{background:#ff3b30;border-color:#ff3b30}.bubble-arrow[data-v-98097aea]{width:11px;height:11px;background:rgba(14,14,14,.96);border-left:1px solid #ffe100;border-bottom:1px solid #ffe100;transform:rotate(-45deg);margin:0 auto;margin-top:-6px}@keyframes bubble-in-98097aea{from{opacity:0;transform:translateX(-50%) translateY(8px) scale(0.9)}to{opacity:1;transform:translateX(-50%) translateY(0) scale(1)}}@keyframes blink-98097aea{0%,50%{opacity:1}51%,100%{opacity:0}}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/ChatBubble.vue\"],\"names\":[],\"mappings\":\"AAAA,iEAAA,CCAwH,8BAAa,cAAe,CAAA,+BAAiC,CAAA,eAAgB,CAAA,cAAe,CAAA,0CAAkC,CAAA,aAAc,CAAA,mBAAoB,CAAA,iCAAgB,iBAAkB,CAAA,6BAA8B,CAAA,UAAW,CAAA,wBAAyB,CAAA,0BAA2B,CAAA,4FAAkG,CAAA,cAAe,CAAA,eAAgB,CAAA,qBAAsB,CAAA,oCAAqC,CAAA,gFAAiF,CAAA,mBAAoB,CAAA,wCAAuB,UAAW,CAAA,iBAAkB,CAAA,UAAW,CAAA,WAAY,CAAA,UAAW,CAAA,UAAW,CAAA,kBAAmB,CAAA,8BAAa,oBAAqB,CAAA,yBAAQ,sCAA8B,CAAA,eAAgB,CAAA,aAAc,CAAA,+BAAc,iBAAkB,CAAA,SAAU,CAAA,OAAQ,CAAA,UAAW,CAAA,WAAY,CAAA,mCAAoC,CAAA,8BAA+B,CAAA,UAAW,CAAA,gBAAiB,CAAA,iBAAkB,CAAA,cAAe,CAAA,cAAe,CAAA,SAAU,CAAA,iDAAkD,CAAA,qCAAoB,kBAAmB,CAAA,oBAAqB,CAAA,+BAAc,UAAW,CAAA,WAAY,CAAA,6BAA8B,CAAA,6BAA8B,CAAA,+BAAgC,CAAA,wBAAyB,CAAA,aAAc,CAAA,eAAgB,CAAA,8BAAqB,KAAK,SAAU,CAAA,qDAAsD,CAAA,GAAG,SAAU,CAAA,iDAAkD,CAAC,CAAA,0BAAiB,OAAO,SAAU,CAAA,SAAS,SAAU,CAAC\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.chat-bubble{position:fixed;transform:translate(-50%, -100%);max-width:320px;min-width:80px;animation:bubble-in .22s ease-out;z-index:10004;pointer-events:none}.bubble-content{position:relative;background:rgba(14,14,14,.96);color:#fff;border:1px solid #ffe100;padding:9px 26px 10px 13px;clip-path:polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);font-size:12px;line-height:1.5;word-break:break-word;box-shadow:8px 8px 0 rgba(0,0,0,.56);font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif;pointer-events:auto}.bubble-content::after{content:\\\"\\\";position:absolute;right:22px;bottom:-2px;width:30px;height:3px;background:#ffe100}.bubble-text{white-space:pre-wrap}.cursor{animation:blink .64s infinite;margin-left:1px;color:#00dac2}.bubble-close{position:absolute;right:6px;top:5px;width:15px;height:15px;border:1px solid hsla(0,0%,100%,.3);background:hsla(0,0%,100%,.08);color:#fff;line-height:13px;text-align:center;cursor:pointer;font-size:10px;padding:0;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif}.bubble-close:hover{background:#ff3b30;border-color:#ff3b30}.bubble-arrow{width:11px;height:11px;background:rgba(14,14,14,.96);border-left:1px solid #ffe100;border-bottom:1px solid #ffe100;transform:rotate(-45deg);margin:0 auto;margin-top:-6px}@keyframes bubble-in{from{opacity:0;transform:translateX(-50%) translateY(8px) scale(0.9)}to{opacity:1;transform:translateX(-50%) translateY(0) scale(1)}}@keyframes blink{0%,50%{opacity:1}51%,100%{opacity:0}}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./PetContainer.vue?vue&type=style&index=0&id=f0a5fb30&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"82b08ae2\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./PetContainer.vue?vue&type=style&index=0&id=f0a5fb30&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./PetContainer.vue?vue&type=style&index=0&id=f0a5fb30&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n  if (!cssMapping) {\n    return content;\n  }\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    return [content].concat([sourceMapping]).join(\"\\n\");\n  }\n  return [content].join(\"\\n\");\n};","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.push([module.id, \"@import url(https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap);\"]);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */.browser-overlay[data-v-f0a5fb30]{position:fixed;inset:0;z-index:10003;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.browser-dialog[data-v-f0a5fb30]{width:min(980px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\"Source Han Sans SC\",\"Noto Sans CJK SC\",\"Microsoft YaHei\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0,100% 0,100% calc(100% - 12px),calc(100% - 12px) 100%,0 100%)}.browser-dialog[data-v-f0a5fb30]::before{content:\"\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.browser-dialog[data-v-f0a5fb30]{background-image:linear-gradient(rgba(255,255,255,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.03) 1px,transparent 1px);background-size:22px 22px}.browser-dialog-header[data-v-f0a5fb30]{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 18px;border-bottom:1px solid rgba(255,225,0,.36);background:rgba(0,0,0,.28)}.browser-dialog-header h3[data-v-f0a5fb30]{margin:0;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-size:15px;letter-spacing:.08em}.browser-dialog-header .close-btn[data-v-f0a5fb30]{-webkit-appearance:none;appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\"Oswald\",\"Teko\",\"Segoe UI\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0,100% 0,100% calc(100% - 10px),calc(100% - 10px) 100%,0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.browser-dialog-header .close-btn[data-v-f0a5fb30]:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.browser-dialog-header .close-btn[data-v-f0a5fb30]:disabled{opacity:.45;cursor:not-allowed}.browser-dialog-header .close-btn[data-v-f0a5fb30]{width:34px;height:28px;padding:0;line-height:1;font-size:16px}.browser-dialog-body[data-v-f0a5fb30]{padding:14px 18px 16px;overflow:auto;flex:1}.browser-dialog-body[data-v-f0a5fb30]::-webkit-scrollbar{width:7px;height:7px}.browser-dialog-body[data-v-f0a5fb30]::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.browser-dialog-body[data-v-f0a5fb30]::-webkit-scrollbar-thumb{background:#555}.browser-dialog-body[data-v-f0a5fb30]::-webkit-scrollbar-thumb:hover{background:#6f6f6f}@media (max-width:860px){.browser-overlay[data-v-f0a5fb30]{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.browser-dialog[data-v-f0a5fb30]{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}}@media (max-width:620px){.browser-overlay[data-v-f0a5fb30]{align-items:stretch;padding:0}.browser-dialog[data-v-f0a5fb30]{width:100vw;max-height:100dvh;box-shadow:none;clip-path:none;border-left:none;border-right:none}.browser-dialog-header[data-v-f0a5fb30]{padding:12px}.browser-dialog-body[data-v-f0a5fb30]{padding:10px 12px 12px}}`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://.////ui/PetContainer.vue\"],\"names\":[],\"mappings\":\"AAAA,iEAAA,CCAwH,kCAAiB,cAAe,CAAA,OAAQ,CAAA,aAAc,CAAA,yBAA0B,CAAA,YAAa,CAAA,kBAAmB,CAAA,sBAAuB,CAAA,YAAa,CAAA,qBAAsB,CAAA,aAAc,CAAA,iCAAgB,6BAA8B,CAAA,8BAA+B,CAAA,YAAa,CAAA,qBAAsB,CAAA,eAAgB,CAAA,UAAW,CAAA,kBAAmB,CAAA,gFAAiF,CAAA,iBAAkB,CAAA,wBAAyB,CAAA,sCAAuC,CAAA,kFAAuF,CAAA,yCAAwB,UAAW,CAAA,iBAAkB,CAAA,KAAM,CAAA,MAAO,CAAA,UAAW,CAAA,UAAW,CAAA,kBAAmB,CAAA,SAAU,CAAA,iCAAgB,8IAAwJ,CAAA,yBAA0B,CAAA,wCAAuB,YAAa,CAAA,kBAAmB,CAAA,6BAA8B,CAAA,QAAS,CAAA,iBAAkB,CAAA,2CAA4C,CAAA,0BAA2B,CAAA,2CAA0B,QAAS,CAAA,iDAAkD,CAAA,cAAe,CAAA,oBAAqB,CAAA,mDAAkC,uBAAgB,CAAhB,eAAgB,CAAA,oCAAqC,CAAA,wBAAyB,CAAA,UAAW,CAAA,iDAAkD,CAAA,eAAgB,CAAA,oBAAqB,CAAA,wBAAyB,CAAA,cAAe,CAAA,kFAAuF,CAAA,sEAAuE,CAAA,wEAAuD,kBAAmB,CAAA,UAAW,CAAA,oBAAqB,CAAA,4DAA2C,WAAY,CAAA,kBAAmB,CAAA,mDAAkC,UAAW,CAAA,WAAY,CAAA,SAAU,CAAA,aAAc,CAAA,cAAe,CAAA,sCAAqB,sBAAuB,CAAA,aAAc,CAAA,MAAO,CAAA,yDAAwC,SAAU,CAAA,UAAW,CAAA,+DAA8C,8BAA+B,CAAA,+DAA8C,eAAgB,CAAA,qEAAoD,kBAAmB,CAAA,yBAAyB,kCAAiB,sBAAuB,CAAA,wFAAyF,CAAA,iCAAgB,UAAW,CAAA,uFAAwF,CAAA,cAAe,CAAA,wCAAyC,CAAC,CAAA,yBAAyB,kCAAiB,mBAAoB,CAAA,SAAU,CAAA,iCAAgB,WAAY,CAAA,iBAAkB,CAAA,eAAgB,CAAA,cAAe,CAAA,gBAAiB,CAAA,iBAAkB,CAAA,wCAAuB,YAAa,CAAA,sCAAqB,sBAAuB,CAAC\",\"sourcesContent\":[null,\"@import\\\"https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Teko:wght@500;600;700&display=swap\\\";.browser-overlay{position:fixed;inset:0;z-index:10003;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow:auto}.browser-dialog{width:min(980px,100vw - 24px);max-height:calc(100dvh - 24px);display:flex;flex-direction:column;overflow:hidden;color:#fff;background:#181818;font-family:\\\"Source Han Sans SC\\\",\\\"Noto Sans CJK SC\\\",\\\"Microsoft YaHei\\\",sans-serif;position:relative;border:1px solid #3b3b3b;box-shadow:10px 10px 0 rgba(0,0,0,.62);clip-path:polygon(0 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%)}.browser-dialog::before{content:\\\"\\\";position:absolute;top:0;left:0;width:56px;height:2px;background:#ffe100;z-index:2}.browser-dialog{background-image:linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);background-size:22px 22px}.browser-dialog-header{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 18px;border-bottom:1px solid rgba(255,225,0,.36);background:rgba(0,0,0,.28)}.browser-dialog-header h3{margin:0;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-size:15px;letter-spacing:.08em}.browser-dialog-header .close-btn{appearance:none;border:1px solid hsla(0,0%,100%,.24);background:rgba(0,0,0,0);color:#fff;font-family:\\\"Oswald\\\",\\\"Teko\\\",\\\"Segoe UI\\\",sans-serif;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;clip-path:polygon(0 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%);transition:background .18s ease,color .18s ease,border-color .18s ease}.browser-dialog-header .close-btn:hover:not(:disabled){background:#ffe100;color:#000;border-color:#ffe100}.browser-dialog-header .close-btn:disabled{opacity:.45;cursor:not-allowed}.browser-dialog-header .close-btn{width:34px;height:28px;padding:0;line-height:1;font-size:16px}.browser-dialog-body{padding:14px 18px 16px;overflow:auto;flex:1}.browser-dialog-body::-webkit-scrollbar{width:7px;height:7px}.browser-dialog-body::-webkit-scrollbar-track{background:hsla(0,0%,100%,.04)}.browser-dialog-body::-webkit-scrollbar-thumb{background:#555}.browser-dialog-body::-webkit-scrollbar-thumb:hover{background:#6f6f6f}@media(max-width: 860px){.browser-overlay{align-items:flex-start;padding:calc(env(safe-area-inset-top) + 6px) 6px calc(env(safe-area-inset-bottom) + 6px)}.browser-dialog{width:100%;max-height:calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 12px);clip-path:none;box-shadow:0 0 0 1px hsla(0,0%,100%,.15)}}@media(max-width: 620px){.browser-overlay{align-items:stretch;padding:0}.browser-dialog{width:100vw;max-height:100dvh;box-shadow:none;clip-path:none;border-left:none;border-right:none}.browser-dialog-header{padding:12px}.browser-dialog-body{padding:10px 12px 12px}}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","/* unplugin-vue-components disabled */// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ChatBubble.vue?vue&type=style&index=0&id=98097aea&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/.pnpm/vue-style-loader@4.1.3/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"266a4174\", content, false, {\"ssrId\":true});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ChatBubble.vue?vue&type=style&index=0&id=98097aea&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.102.1/node_modules/css-loader/dist/cjs.js??clonedRuleSet-45.use[1]!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@8.2.0_postcs_37bafd025248bbddf6b8842180147e3c/node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/.pnpm/sass-loader@16.0.6_sass@1.94.0_webpack@5.102.1/node_modules/sass-loader/dist/cjs.js!../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./ChatBubble.vue?vue&type=style&index=0&id=98097aea&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","/**  */\nexport const SCRIPT_NAME = '';\n\n/** IndexedDB  */\nexport const DB_NAME = 'DesktopPetPluginDB';\nexport const DB_VERSION = 1;\nexport const STORE_LIVE2D_MODELS = 'live2dModels';\nexport const STORE_SDK_CACHE = 'sdkCache';\n\n/** Live2D runtime  */\nexport type Live2DRuntimeType = 'legacy' | 'cubism5';\n\n/**  */\nexport const LOCAL_LIVE2D_MODEL_PATH_PREFIX = 'local://desktop-pet/';\nexport const LOCAL_LIVE2D_MODEL_SLOT_ID = 'default';\nexport const LOCAL_LIVE2D_MODEL_PATH = `${LOCAL_LIVE2D_MODEL_PATH_PREFIX}${LOCAL_LIVE2D_MODEL_SLOT_ID}`;\nexport const EMPTY_MOTION_GROUP_VALUE = '__desktop_pet_empty_motion_group__';\n\n/** Live2D CDN  pixi-live2d-display  */\nexport const LIVE2D_CDN_BASE = 'https://cdn.jsdelivr.net/gh/guansss/pixi-live2d-display/test/assets/';\n\n/** SDK CDN  */\nexport const SDK_URLS = {\n  PIXI: 'https://cdn.jsdelivr.net/npm/pixi.js@6.5.10/dist/browser/pixi.min.js',\n  CUBISM4_CORE: 'https://cdn.jsdelivr.net/npm/live2dcubismcore@1.0.2/live2dcubismcore.min.js',\n  CUBISM4_CORE_FALLBACK_URLS: Object.freeze([\n    'https://gcore.jsdelivr.net/npm/live2dcubismcore@1.0.2/live2dcubismcore.min.js',\n    'https://unpkg.com/live2dcubismcore@1.0.2/live2dcubismcore.min.js',\n    'https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js',\n  ]),\n  CUBISM5_CORE: 'https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js',\n  CUBISM5_CORE_FALLBACK_URLS: Object.freeze([\n    'https://cdn.jsdelivr.net/gh/bigmalove/galgame@main/dist/live2dcubismcore.min.js',\n    'https://gcore.jsdelivr.net/gh/bigmalove/galgame@main/dist/live2dcubismcore.min.js',\n  ]),\n  CUBISM2_CORE: 'https://cdn.jsdelivr.net/gh/dylanNew/live2d/webgl/Live2D/lib/live2d.min.js',\n  PIXI_LIVE2D_DISPLAY: 'https://cdn.jsdelivr.net/npm/pixi-live2d-display@0.4.0/dist/index.min.js',\n  CUBISM5_RUNTIME: 'https://cdn.jsdelivr.net/gh/bigmalove/galgame@main/dist/cubism5.runtime.min.js',\n  CUBISM5_RUNTIME_FALLBACK_URLS: Object.freeze([\n    'https://gcore.jsdelivr.net/gh/bigmalove/galgame@main/dist/cubism5.runtime.min.js',\n    'https://cdn.jsdelivr.net/gh/bigmalove/galgame@main/dist/cubism5.js',\n    'https://gcore.jsdelivr.net/gh/bigmalove/galgame@main/dist/cubism5.js',\n  ]),\n} as const;\n\n/**  */\nexport const RECOMMENDED_MODELS = [\n  {\n    name: 'Haru (Cubism 4)',\n    path: 'haru/haru_greeter_t03.model3.json',\n  },\n  {\n    name: 'Shizuku (Cubism 2)',\n    path: 'shizuku/shizuku.model.json',\n  },\n] as const;\n\n/**  */\nexport const COMMENT_STYLES = ['', '', '', '', ''] as const;\nexport type CommentStyle = (typeof COMMENT_STYLES)[number];\n\n/**  */\nexport const COMMENT_TRIGGER_MODES = ['user', 'ai', 'both'] as const;\nexport type CommentTriggerMode = (typeof COMMENT_TRIGGER_MODES)[number];\nexport const COMMENT_TRIGGER_MODE_OPTIONS: ReadonlyArray<{\n  value: CommentTriggerMode;\n  label: string;\n}> = [\n  { value: 'user', label: '' },\n  { value: 'ai', label: 'AI' },\n  { value: 'both', label: '' },\n];\n\n/**  COT  */\nexport const EMOTION_TAGS = [\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n] as const;\nexport type EmotionTag = (typeof EMOTION_TAGS)[number];\n\n/** API source  */\nexport const API_SOURCES = [\n  { value: 'openai', label: 'OpenAI ()' },\n  { value: 'claude', label: 'Claude' },\n  { value: 'makersuite', label: 'Google Gemini' },\n  { value: 'openrouter', label: 'OpenRouter' },\n] as const;\n\n/** Eikanya Live2D  */\nexport const EIKANYA_REPO = 'Eikanya/Live2d-model';\nexport const EIKANYA_API_BASE = 'https://api.github.com/repos/Eikanya/Live2d-model/contents/';\nexport const EIKANYA_CDN_BASE = 'https://cdn.jsdelivr.net/gh/Eikanya/Live2d-model@master/';\nexport const EIKANYA_RAW_BASE = 'https://raw.githubusercontent.com/Eikanya/Live2d-model/master/';\n\n/**  */\nexport const DEFAULTS = {\n  MODEL_PATH: 'shizuku/shizuku.model.json',\n  PET_SCALE: 0.3,\n  PET_POSITION: { x: -1, y: -1 }, // -1 \n  AUTO_MOTION_LOOP: true,\n  DOUBLE_TAP_RANDOM_MOTION_ENABLED: true,\n  GAZE_FOLLOW_MOUSE_ENABLED: true,\n  COMMENT_TRIGGER_MODE: 'ai' as CommentTriggerMode,\n  COMMENT_STYLE: '' as CommentStyle,\n  ROLEPLAY_NAME: '',\n  ROLEPLAY_IGNORE_COMMENT_STYLE: false,\n  SEND_CHARACTER_CARD_CONTENT: false,\n  AUTO_TRIGGER: true,\n  TRIGGER_INTERVAL: 3,\n  TRIGGER_PROBABILITY: 60,\n  MAX_CHAT_CONTEXT: 10,\n  USE_TAMAKO_TODAY_SPECIAL: false,\n  USE_DICE_DATABASE_REFERENCE: false,\n  PHONE_MESSAGE_AUTO_READ: true,\n  BAIBAI_PHONE_MESSAGE_AUTO_READ: false,\n  MAX_TOKENS: 150,\n  TEMPERATURE: 0.9,\n  FREQUENCY_PENALTY: 0,\n  PRESENCE_PENALTY: 0,\n  TOP_P: 1,\n  TOP_K: 0,\n  BUBBLE_DURATION: -1,\n} as const;\n","const __WEBPACK_NAMESPACE_OBJECT__ = z;","import { EMOTION_TAGS, type EmotionTag } from './constants';\n\nexport type EmotionMotionOverride = {\n  enabled: boolean;\n  group: string;\n  index: number;\n};\n\nexport type EmotionConfig = {\n  tag: EmotionTag;\n  aliases: string[];\n  ttsContext: string;\n  live2dExpression: string;\n  live2dMotion: EmotionMotionOverride;\n};\n\nfunction isRecord(value: unknown): value is Record<string, unknown> {\n  return !!value && typeof value === 'object' && !Array.isArray(value);\n}\n\nconst EMOTION_TAG_SET = new Set<string>(EMOTION_TAGS as unknown as string[]);\n\nfunction asEmotionTag(value: unknown): EmotionTag | null {\n  const s = String(value || '').trim();\n  if (!s) return null;\n  return EMOTION_TAG_SET.has(s) ? (s as EmotionTag) : null;\n}\n\nconst DEFAULT_ALIASES: Record<EmotionTag, string[]> = {\n  : ['', 'normal', 'default', 'neutral', 'idle', 'base'],\n  : ['', '', 'smile', 'happy', 'joy', 'glad'],\n  : ['', 'angry', 'mad', 'rage'],\n  : ['', 'sad', 'cry', 'sorrow', 'upset'],\n  : ['', 'surprised', 'shock', 'amazed', 'wow'],\n  : ['', 'smirk', 'mock', 'sneer', 'tease', 'sarcastic'],\n  : ['', 'shy', 'blush', 'embarrassed', 'bashful'],\n  : ['', 'think', 'ponder', 'confused', 'wonder', 'curious'],\n  : ['', 'laugh', 'lol', 'haha', 'giggle', 'rofl'],\n  : ['', 'wink', 'playful', 'silly', 'mischievous', 'fun'],\n};\n\nfunction dedupAliases(aliases: string[]): string[] {\n  const out: string[] = [];\n  const seen = new Set<string>();\n  for (const raw of Array.isArray(aliases) ? aliases : []) {\n    const trimmed = String(raw || '').trim();\n    if (!trimmed) continue;\n    const key = trimmed.toLowerCase();\n    if (seen.has(key)) continue;\n    seen.add(key);\n    out.push(trimmed);\n  }\n  return out;\n}\n\nexport function parseAliasesText(input: unknown): string[] {\n  const text = String(input || '');\n  const parts = text\n    .split(/[,\\n\\r]+/g)\n    .map((s) => s.trim())\n    .filter(Boolean);\n  return dedupAliases(parts);\n}\n\nexport function createDefaultEmotionConfigs(): EmotionConfig[] {\n  return EMOTION_TAGS.map((tag) => ({\n    tag,\n    aliases: [...(DEFAULT_ALIASES[tag] ?? [])],\n    ttsContext: '',\n    live2dExpression: '',\n    live2dMotion: { enabled: true, group: '', index: 0 },\n  }));\n}\n\nexport function normalizeEmotionConfigs(raw: unknown): EmotionConfig[] {\n  const byTag = new Map<EmotionTag, EmotionConfig>();\n\n  for (const item of Array.isArray(raw) ? raw : []) {\n    if (!isRecord(item)) continue;\n    const tag = asEmotionTag(item.tag);\n    if (!tag) continue;\n    if (byTag.has(tag)) continue;\n\n    const live2dMotionRaw = isRecord(item.live2dMotion) ? item.live2dMotion : {};\n    const enabled = (live2dMotionRaw.enabled as unknown) !== false;\n    const group = String(live2dMotionRaw.group || '').trim();\n    const indexRaw = Number(live2dMotionRaw.index);\n    const index = Number.isFinite(indexRaw) ? Math.max(0, Math.floor(indexRaw)) : 0;\n\n    const cfg: EmotionConfig = {\n      tag,\n      aliases: dedupAliases(\n        Array.isArray(item.aliases)\n          ? item.aliases.map((v) => String(v || '').trim()).filter(Boolean)\n          : [],\n      ),\n      ttsContext: String(item.ttsContext || '').trim(),\n      live2dExpression: String(item.live2dExpression || '').trim(),\n      live2dMotion: { enabled, group, index },\n    };\n\n    byTag.set(tag, cfg);\n  }\n\n  const defaults = createDefaultEmotionConfigs();\n  for (const def of defaults) {\n    if (!byTag.has(def.tag)) byTag.set(def.tag, def);\n  }\n\n  return EMOTION_TAGS.map((tag) => byTag.get(tag)!).map((cfg) => ({\n    tag: cfg.tag,\n    aliases: dedupAliases(cfg.aliases),\n    ttsContext: String(cfg.ttsContext || '').trim(),\n    live2dExpression: String(cfg.live2dExpression || '').trim(),\n    live2dMotion: {\n      enabled: cfg.live2dMotion?.enabled !== false,\n      group: String(cfg.live2dMotion?.group || '').trim(),\n      index: Number.isFinite(cfg.live2dMotion?.index) ? Math.max(0, Math.floor(cfg.live2dMotion.index)) : 0,\n    },\n  }));\n}\n\nexport function getEmotionConfigByTag(tag: EmotionTag, configs: unknown): EmotionConfig | null {\n  for (const cfg of Array.isArray(configs) ? (configs as EmotionConfig[]) : []) {\n    if (cfg?.tag === tag) return cfg;\n  }\n  return null;\n}\n\nexport function resolveEmotionTag(rawTag: unknown, configs: unknown): EmotionTag | null {\n  const s = String(rawTag || '').trim();\n  if (!s) return null;\n  const direct = asEmotionTag(s);\n  if (direct) return direct;\n\n  const needle = s.toLowerCase();\n  for (const cfg of Array.isArray(configs) ? (configs as EmotionConfig[]) : []) {\n    const aliases = Array.isArray(cfg?.aliases) ? cfg.aliases : [];\n    for (const alias of aliases) {\n      if (String(alias || '').trim().toLowerCase() === needle) {\n        const tag = asEmotionTag(cfg.tag);\n        if (tag) return tag;\n      }\n    }\n  }\n  return null;\n}\n\n","import { SCRIPT_NAME } from '../core/constants';\n\n/**\n *  DOM  body\n */\nexport function createContainer(id: string): JQuery<HTMLElement> {\n  // \n  $(`#${id}`).remove();\n  return $(`<div id=\"${id}\">`).appendTo('body');\n}\n\n/**\n *  ID \n */\nexport function removeContainer(id: string): void {\n  $(`#${id}`).remove();\n}\n\nfunction getTargetConsole(): Console {\n  try {\n    const top = window.parent ?? window;\n    if (top.console) return top.console;\n  } catch {\n    // ignore\n  }\n  return console;\n}\n\n/**\n * \n */\nexport function log(...args: unknown[]): void {\n  getTargetConsole().log(`[${SCRIPT_NAME}]`, ...args);\n}\n\nexport function warn(...args: unknown[]): void {\n  getTargetConsole().warn(`[${SCRIPT_NAME}]`, ...args);\n}\n\nexport function error(...args: unknown[]): void {\n  getTargetConsole().error(`[${SCRIPT_NAME}]`, ...args);\n}\n","import { klona } from 'klona';\r\nimport { defineStore } from 'pinia';\r\nimport { ref, watchEffect } from 'vue';\r\nimport { z } from 'zod';\r\nimport { COMMENT_STYLES, COMMENT_TRIGGER_MODES, DEFAULTS, EMOTION_TAGS } from './constants';\r\nimport { normalizeEmotionConfigs } from './emotion';\r\nimport { error as logError, warn } from '../utils/dom';\r\n\r\nfunction isRecord(value: unknown): value is Record<string, any> {\r\n  return !!value && typeof value === 'object' && !Array.isArray(value);\r\n}\r\n\r\nfunction deleteAtPath(target: any, path: (string | number)[]): void {\r\n  if (!target || typeof target !== 'object') return;\r\n  if (path.length === 0) return;\r\n\r\n  let current: any = target;\r\n  for (let i = 0; i < path.length - 1; i++) {\r\n    const key = path[i];\r\n    if (!current || typeof current !== 'object') return;\r\n    current = current[key as any];\r\n  }\r\n\r\n  const last = path[path.length - 1];\r\n  if (!current || typeof current !== 'object') return;\r\n  if (Array.isArray(current) && typeof last === 'number') {\r\n    current[last] = undefined;\r\n    return;\r\n  }\r\n  delete current[last as any];\r\n}\r\n\r\nfunction parseSettings(raw: unknown): Settings {\r\n  const rawObject = isRecord(raw) ? raw : {};\r\n  const first = SettingsSchema.safeParse(rawObject);\r\n  if (first.success) return first.data;\r\n\r\n  const cleaned = klona(rawObject);\r\n  for (const issue of first.error.issues) {\r\n    deleteAtPath(cleaned, issue.path);\r\n  }\r\n\r\n  const second = SettingsSchema.safeParse(cleaned);\r\n  if (second.success) {\r\n    warn('', first.error.issues);\r\n    return second.data;\r\n  }\r\n\r\n  logError('', first.error);\r\n  return SettingsSchema.parse({});\r\n}\r\n\r\n/**  Schema */\r\nconst SettingsSchema = z\r\n  .object({\r\n    // API \r\n    apiMode: z.enum(['custom', 'tavern']).default('tavern'),\r\n    apiConfig: z\r\n      .object({\r\n        url: z.string().default(''),\r\n        apiKey: z.string().default(''),\r\n        model: z.string().default('gpt-4o-mini'),\r\n        source: z.string().default('openai'),\r\n        max_tokens: z.number().min(1).max(4096).default(DEFAULTS.MAX_TOKENS),\r\n        temperature: z.number().min(0).max(2).default(DEFAULTS.TEMPERATURE),\r\n        frequency_penalty: z.number().min(-2).max(2).default(DEFAULTS.FREQUENCY_PENALTY),\r\n        presence_penalty: z.number().min(-2).max(2).default(DEFAULTS.PRESENCE_PENALTY),\r\n        top_p: z.number().min(0).max(1).default(DEFAULTS.TOP_P),\r\n        top_k: z.number().min(0).max(500).default(DEFAULTS.TOP_K),\r\n        usePresetSampling: z.boolean().default(false),\r\n        sendWorldInfo: z.boolean().default(false),\r\n      })\r\n      .default({}),\r\n\r\n    // Live2D \r\n    modelPath: z.string().default(DEFAULTS.MODEL_PATH),\r\n    useCdn: z.boolean().default(true),\r\n    petPosition: z\r\n      .object({\r\n        x: z.number().default(DEFAULTS.PET_POSITION.x),\r\n        y: z.number().default(DEFAULTS.PET_POSITION.y),\r\n      })\r\n      .default({}),\r\n    petScale: z.number().min(0.1).max(3).default(DEFAULTS.PET_SCALE),\r\n    autoMotionLoop: z.boolean().default(DEFAULTS.AUTO_MOTION_LOOP),\r\n    doubleTapRandomMotionEnabled: z.boolean().default(DEFAULTS.DOUBLE_TAP_RANDOM_MOTION_ENABLED),\r\n    gazeFollowMouseEnabled: z.boolean().default(DEFAULTS.GAZE_FOLLOW_MOUSE_ENABLED),\r\n\r\n    // \r\n    commentStyle: z.enum(COMMENT_STYLES).default(DEFAULTS.COMMENT_STYLE),\r\n    commentTriggerMode: z.enum(COMMENT_TRIGGER_MODES).default(DEFAULTS.COMMENT_TRIGGER_MODE),\r\n    customPrompt: z.string().default(''),\r\n    roleplayName: z.string().default(DEFAULTS.ROLEPLAY_NAME),\r\n    roleplayIgnoreCommentStyle: z.boolean().default(DEFAULTS.ROLEPLAY_IGNORE_COMMENT_STYLE),\r\n    sendCharacterCardContent: z.boolean().default(DEFAULTS.SEND_CHARACTER_CARD_CONTENT),\r\n    autoTrigger: z.boolean().default(DEFAULTS.AUTO_TRIGGER),\r\n    triggerInterval: z.number().min(1).max(100).default(DEFAULTS.TRIGGER_INTERVAL),\r\n    triggerProbability: z.number().min(0).max(100).default(DEFAULTS.TRIGGER_PROBABILITY),\r\n    maxChatContext: z.number().min(1).max(50).default(DEFAULTS.MAX_CHAT_CONTEXT),\r\n    bubbleDuration: z.number().min(-1).max(600000).default(DEFAULTS.BUBBLE_DURATION),\r\n    useTamakoTodaySpecial: z.boolean().default(DEFAULTS.USE_TAMAKO_TODAY_SPECIAL),\r\n    useDiceDatabaseReference: z.boolean().default(DEFAULTS.USE_DICE_DATABASE_REFERENCE),\r\n    diceReferenceVisibleSheets: z.array(z.string()).default([]),\r\n\r\n    //  COT \r\n    emotionCotEnabled: z.boolean().default(true),\r\n    emotionCotStripFromText: z.boolean().default(true),\r\n    emotionConfigs: z\r\n      .array(\r\n        z\r\n          .object({\r\n            tag: z.enum(EMOTION_TAGS).default(''),\r\n            aliases: z.array(z.string()).default([]),\r\n            ttsContext: z.string().default(''),\r\n            live2dExpression: z.string().default(''),\r\n            live2dMotion: z\r\n              .object({\r\n                enabled: z.boolean().default(true),\r\n                group: z.string().default(''),\r\n                index: z.number().min(0).max(999).default(0),\r\n              })\r\n              .default({}),\r\n          })\r\n          .default({}),\r\n      )\r\n      .default([]),\r\n    // TTS provider\r\n    ttsProvider: z.enum(['littlewhitebox', 'gpt_sovits_v2', 'edge_tts_direct']).default('littlewhitebox'),\r\n    ttsAutoPlay: z.boolean().default(true),\r\n    phoneMessageAutoRead: z.boolean().default(DEFAULTS.PHONE_MESSAGE_AUTO_READ),\r\n    baibaiPhoneMessageAutoRead: z.boolean().default(DEFAULTS.BAIBAI_PHONE_MESSAGE_AUTO_READ),\r\n    ttsDefaultSpeaker: z.string().default(''),\r\n    lipSyncManualParamsEnabled: z.boolean().default(false),\r\n    lipSyncManualParamIds: z.array(z.string()).default([]),\r\n    gptSoVits: z\r\n      .object({\r\n        apiUrl: z.string().default('http://127.0.0.1:9880'),\r\n        endpoint: z.string().default('/tts'),\r\n        useCorsProxy: z.boolean().default(true),\r\n        mediaType: z.enum(['wav', 'ogg', 'raw']).default('wav'),\r\n        streamingMode: z.boolean().default(true),\r\n        textLang: z.string().default('auto'),\r\n        textSplitMethod: z.string().default('cut5'),\r\n        speedFactor: z.number().min(0.1).max(3).default(1),\r\n        strictWeightSwitch: z.boolean().default(false),\n        probeOnAudioError: z.boolean().default(false),\n        modelSwitchMode: z.enum(['none', 'set_model', 'set_weights']).default('set_weights'),\n        setModelEndpoint: z.string().default('/set_model'),\n        rootDir: z.string().default(''),\n        importPathPrefix: z.string().default(''),\n        models: z\n          .array(\n            z\n              .object({\n                id: z.string().default(''),\n                name: z.string().default(''),\n                enabled: z.boolean().default(true),\n                desc: z.string().default(''),\n                paths: z\n                  .object({\n                    gptWeightsPath: z.string().default(''),\n                    sovitsWeightsPath: z.string().default(''),\n                    defaultRefAudioPath: z.string().default(''),\n                  })\n                  .default({}),\n                params: z\n                  .object({\n                    promptText: z.string().default(''),\n                    promptLang: z.string().default('zh'),\n                    textLang: z.string().default('auto'),\n                    textSplitMethod: z.string().default('cut5'),\n                    speedFactor: z.number().min(0.1).max(3).default(1),\n                    mediaType: z.enum(['wav', 'ogg', 'raw']).default('wav'),\n                    streamingMode: z.boolean().default(true),\n                    modelSwitchMode: z.enum(['none', 'set_model', 'set_weights']).default('set_weights'),\n                    setModelEndpoint: z.string().default('/set_model'),\n                    strictWeightSwitch: z.boolean().default(false),\n                  })\n                  .default({}),\n                refAudios: z\n                  .array(\n                    z\n                      .object({\n                        id: z.string().default(''),\n                        name: z.string().default(''),\n                        path: z.string().default(''),\n                        promptText: z.string().default(''),\n                        promptLang: z.string().default('zh'),\n                        textLang: z.string().default('auto'),\n                      })\n                      .default({}),\n                  )\n                  .default([]),\n                defaultRefId: z.string().default(''),\n                expressionRefMap: z.record(z.string(), z.string()).default({}),\n              })\n              .default({}),\n          )\n          .default([]),\n        voices: z\n          .array(\n            z\n              .object({\n                name: z.string().default(''),\r\n                desc: z.string().default(''),\r\n                refAudioPath: z.string().default(''),\r\n                promptText: z.string().default(''),\r\n                promptLang: z.string().default(''),\r\n                textLang: z.string().default(''),\r\n                gptWeightsPath: z.string().default(''),\n                sovitsWeightsPath: z.string().default(''),\n                modelSwitchMode: z.enum(['none', 'set_model', 'set_weights']).default('set_weights'),\n                setModelEndpoint: z.string().default('/set_model'),\n                strictWeightSwitch: z.boolean().default(false),\n              })\n              .default({}),\n          )\n          .default([]),\n      })\n      .default({}),\r\n  })\r\n  .default({});\r\n\r\nexport type Settings = z.infer<typeof SettingsSchema>;\r\n\r\n/** Pinia  Store */\r\nexport const useSettingsStore = defineStore('desktop-pet-settings', () => {\r\n  const raw = getVariables({ type: 'script', script_id: getScriptId() });\r\n  const parsed = parseSettings(raw);\r\n\r\n  //  Eikanya CDN  CDN\r\n  if (\r\n    parsed.modelPath.includes('live2d-widget-model/') ||\r\n    parsed.modelPath.includes('Live2D/Samples/')\r\n  ) {\r\n    parsed.modelPath = DEFAULTS.MODEL_PATH;\r\n  }\r\n\r\n  // jsDelivr / raw  Live2DManager \r\n  // \r\n  parsed.emotionConfigs = normalizeEmotionConfigs(parsed.emotionConfigs);\r\n\r\n  // > 600 \r\n  const rawBubbleDuration = Number((parsed as any).bubbleDuration);\r\n  if (Number.isFinite(rawBubbleDuration)) {\r\n    const bubbleDurationSeconds = rawBubbleDuration > 600 ? rawBubbleDuration / 1000 : rawBubbleDuration;\r\n    (parsed as any).bubbleDuration = Math.round(Math.max(-1, Math.min(600, bubbleDurationSeconds)));\r\n  } else {\r\n    (parsed as any).bubbleDuration = DEFAULTS.BUBBLE_DURATION;\r\n  }\r\n\r\n  const settings = ref<Settings>(parsed);\r\n\r\n  // \r\n  watchEffect(() => {\r\n    replaceVariables(klona(settings.value), { type: 'script', script_id: getScriptId() });\r\n  });\r\n\r\n  /**  */\r\n  function updateSettings(partial: Partial<Settings>) {\r\n    settings.value = SettingsSchema.parse({ ...klona(settings.value), ...partial });\r\n    settings.value.emotionConfigs = normalizeEmotionConfigs(settings.value.emotionConfigs);\r\n  }\r\n\r\n  /**  */\r\n  function resetSettings() {\r\n    const next = SettingsSchema.parse({});\r\n    next.emotionConfigs = normalizeEmotionConfigs(next.emotionConfigs);\r\n    settings.value = next;\r\n  }\r\n\r\n  return { settings, updateSettings, resetSettings };\r\n});\r\n\r\n\r\n","import type { TTSSpeakerVoice } from './tts-config';\n\nconst EDGE_BASE_URL = 'speech.platform.bing.com/consumer/speech/synthesize/readaloud';\nconst TRUSTED_CLIENT_TOKEN = '6A5AA1D4EAFF4E9FB37E23D68491D6F4';\nconst CHROMIUM_FULL_VERSION = '143.0.3537.57';\n\nconst WSS_URL = `wss://${EDGE_BASE_URL}/edge/v1?TrustedClientToken=${TRUSTED_CLIENT_TOKEN}`;\nconst VOICE_LIST_URL = `https://${EDGE_BASE_URL}/voices/list?trustedclienttoken=${TRUSTED_CLIENT_TOKEN}`;\nconst SEC_MS_GEC_VERSION = `1-${CHROMIUM_FULL_VERSION}`;\n\nconst WIN_EPOCH_SECONDS = 11644473600;\nconst SECONDS_TO_NANOSECONDS = 1e9;\n\nconst DEFAULT_RATE = '+0%';\nconst DEFAULT_VOLUME = '+0%';\nconst DEFAULT_PITCH = '+0Hz';\n\nlet clockSkewSeconds = 0;\n\ntype EdgeVoiceApiItem = {\n  ShortName?: string;\n  FriendlyName?: string;\n  Locale?: string;\n  Gender?: string;\n};\n\nexport type EdgeDirectSynthesisOptions = {\n  signal?: AbortSignal;\n  onSocket?: (socket: WebSocket | null) => void;\n  timeoutMs?: number;\n};\n\ntype EdgeTimestampMode = 'utc_string' | 'iso_compact';\n\ntype EdgeSecurityParams = {\n  secMsGec: string;\n  secMsGecVersion: string;\n};\n\ntype SecurityBuildResult = {\n  security: EdgeSecurityParams | null;\n  error: string;\n};\n\nconst EDGE_FALLBACK_SHORT_VOICES: ReadonlyArray<{ shortName: string; locale: string; gender: string }> = [\n  { shortName: 'zh-CN-XiaoxiaoNeural', locale: 'zh-CN', gender: 'Female' },\n  { shortName: 'zh-CN-YunxiNeural', locale: 'zh-CN', gender: 'Male' },\n  { shortName: 'zh-CN-YunyangNeural', locale: 'zh-CN', gender: 'Male' },\n  { shortName: 'zh-CN-XiaoyiNeural', locale: 'zh-CN', gender: 'Female' },\n  { shortName: 'en-US-JennyNeural', locale: 'en-US', gender: 'Female' },\n  { shortName: 'en-US-AriaNeural', locale: 'en-US', gender: 'Female' },\n  { shortName: 'en-US-GuyNeural', locale: 'en-US', gender: 'Male' },\n  { shortName: 'ja-JP-NanamiNeural', locale: 'ja-JP', gender: 'Female' },\n  { shortName: 'ja-JP-KeitaNeural', locale: 'ja-JP', gender: 'Male' },\n];\n\nfunction toAbortError(message = 'Aborted'): Error {\n  try {\n    return new DOMException(message, 'AbortError');\n  } catch {\n    const err = new Error(message);\n    (err as any).name = 'AbortError';\n    return err;\n  }\n}\n\nfunction buildConnectionId(): string {\n  const bytes = new Uint8Array(16);\n  if (globalThis.crypto?.getRandomValues) {\n    globalThis.crypto.getRandomValues(bytes);\n  } else {\n    for (let i = 0; i < bytes.length; i++) {\n      bytes[i] = Math.floor(Math.random() * 256);\n    }\n  }\n  bytes[6] = (bytes[6] & 0x0f) | 0x40;\n  bytes[8] = (bytes[8] & 0x3f) | 0x80;\n  return Array.from(bytes, b => b.toString(16).padStart(2, '0')).join('');\n}\n\nfunction dateToString(mode: EdgeTimestampMode = 'utc_string'): string {\n  const now = new Date();\n  if (mode === 'iso_compact') {\n    return now.toISOString().replace(/[-:.]/g, '').slice(0, -1);\n  }\n  return now.toUTCString().replace('GMT', 'GMT+0000 (Coordinated Universal Time)');\n}\n\nfunction removeIncompatibleCharacters(text: string): string {\n  let out = '';\n  for (let i = 0; i < text.length; i++) {\n    const code = text.charCodeAt(i);\n    const isControl =\n      (code >= 0x00 && code <= 0x08) || code === 0x0b || code === 0x0c || (code >= 0x0e && code <= 0x1f);\n    out += isControl ? ' ' : text[i];\n  }\n  return out;\n}\n\nexport function escapeXml(text: string): string {\n  return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&apos;');\n}\n\nfunction getVoiceName(voice: TTSSpeakerVoice | string): string {\n  if (typeof voice === 'string') return voice.trim();\n  return String(voice.value || voice.name || '').trim();\n}\n\nexport function buildSsml(text: string, voice: TTSSpeakerVoice | string): string {\n  const voiceName = getVoiceName(voice);\n  const escapedText = escapeXml(removeIncompatibleCharacters(String(text || '')));\n  return (\n    `<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xml:lang='en-US'>` +\n    `<voice name='${voiceName}'>` +\n    `<prosody pitch='${DEFAULT_PITCH}' rate='${DEFAULT_RATE}' volume='${DEFAULT_VOLUME}'>${escapedText}</prosody>` +\n    `</voice>` +\n    `</speak>`\n  );\n}\n\nfunction buildSpeechConfigMessage(timestamp: string): string {\n  return (\n    `X-Timestamp:${timestamp}\\r\\n` +\n    `Content-Type:application/json; charset=utf-8\\r\\n` +\n    `Path:speech.config\\r\\n\\r\\n` +\n    `{\"context\":{\"synthesis\":{\"audio\":{\"metadataoptions\":{\"sentenceBoundaryEnabled\":\"false\",\"wordBoundaryEnabled\":\"true\"},\"outputFormat\":\"audio-24khz-48kbitrate-mono-mp3\"}}}}\\r\\n`\n  );\n}\n\nfunction buildSsmlMessage(requestId: string, timestamp: string, ssml: string): string {\n  return (\n    `X-RequestId:${requestId}\\r\\n` +\n    `Content-Type:application/ssml+xml\\r\\n` +\n    `X-Timestamp:${timestamp}Z\\r\\n` +\n    `Path:ssml\\r\\n\\r\\n` +\n    `${ssml}`\n  );\n}\n\nfunction parseHeadersFromTextMessage(textMessage: string): Record<string, string> {\n  const headerEndIndex = textMessage.indexOf('\\r\\n\\r\\n');\n  const headerText = headerEndIndex >= 0 ? textMessage.slice(0, headerEndIndex) : textMessage;\n  const headers: Record<string, string> = {};\n  for (const line of headerText.split('\\r\\n')) {\n    const idx = line.indexOf(':');\n    if (idx <= 0) continue;\n    headers[line.slice(0, idx)] = line.slice(idx + 1).trim();\n  }\n  return headers;\n}\n\nfunction parseHeadersAndDataFromBinaryMessage(binary: Uint8Array): { headers: Record<string, string>; payload: Uint8Array } {\n  if (binary.length < 2) return { headers: {}, payload: new Uint8Array(0) };\n  const headerLength = (binary[0] << 8) | binary[1];\n  if (headerLength <= 0 || headerLength + 2 > binary.length) {\n    return { headers: {}, payload: binary.slice(2) };\n  }\n\n  const headers: Record<string, string> = {};\n  const headerBytes = binary.slice(2, headerLength + 2);\n  const headerText = new TextDecoder().decode(headerBytes);\n  for (const line of headerText.split('\\r\\n')) {\n    const idx = line.indexOf(':');\n    if (idx <= 0) continue;\n    headers[line.slice(0, idx)] = line.slice(idx + 1).trim();\n  }\n\n  return { headers, payload: binary.slice(headerLength + 2) };\n}\n\nfunction concatChunks(chunks: Uint8Array[]): Uint8Array {\n  if (chunks.length === 0) return new Uint8Array(0);\n  if (chunks.length === 1) return chunks[0];\n  const totalLength = chunks.reduce((sum, chunk) => sum + chunk.length, 0);\n  const merged = new Uint8Array(totalLength);\n  let offset = 0;\n  for (const chunk of chunks) {\n    merged.set(chunk, offset);\n    offset += chunk.length;\n  }\n  return merged;\n}\n\nasync function toSha256HexUpper(text: string): Promise<string> {\n  const bytes = new TextEncoder().encode(text);\n  const subtle = globalThis.crypto?.subtle;\n  if (subtle?.digest) {\n    try {\n      const digest = await subtle.digest('SHA-256', bytes);\n      return Array.from(new Uint8Array(digest))\n        .map(b => b.toString(16).padStart(2, '0'))\n        .join('')\n        .toUpperCase();\n    } catch {\n      // fallback to pure-js implementation\n    }\n  }\n  return sha256HexUpperFallback(bytes);\n}\n\nfunction rotateRight(value: number, bits: number): number {\n  return ((value >>> bits) | (value << (32 - bits))) >>> 0;\n}\n\nfunction sha256HexUpperFallback(message: Uint8Array): string {\n  const K = new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2,\n  ]);\n\n  const H = new Uint32Array([\n    0x6a09e667,\n    0xbb67ae85,\n    0x3c6ef372,\n    0xa54ff53a,\n    0x510e527f,\n    0x9b05688c,\n    0x1f83d9ab,\n    0x5be0cd19,\n  ]);\n\n  const withOneByte = message.length + 1;\n  const paddedLength = Math.ceil((withOneByte + 8) / 64) * 64;\n  const padded = new Uint8Array(paddedLength);\n  padded.set(message);\n  padded[message.length] = 0x80;\n\n  const bitLength = message.length * 8;\n  const high = Math.floor(bitLength / 0x100000000);\n  const low = bitLength >>> 0;\n  padded[paddedLength - 8] = (high >>> 24) & 0xff;\n  padded[paddedLength - 7] = (high >>> 16) & 0xff;\n  padded[paddedLength - 6] = (high >>> 8) & 0xff;\n  padded[paddedLength - 5] = high & 0xff;\n  padded[paddedLength - 4] = (low >>> 24) & 0xff;\n  padded[paddedLength - 3] = (low >>> 16) & 0xff;\n  padded[paddedLength - 2] = (low >>> 8) & 0xff;\n  padded[paddedLength - 1] = low & 0xff;\n\n  const w = new Uint32Array(64);\n  for (let offset = 0; offset < padded.length; offset += 64) {\n    for (let i = 0; i < 16; i++) {\n      const j = offset + i * 4;\n      w[i] = ((padded[j] << 24) | (padded[j + 1] << 16) | (padded[j + 2] << 8) | padded[j + 3]) >>> 0;\n    }\n\n    for (let i = 16; i < 64; i++) {\n      const s0 = rotateRight(w[i - 15], 7) ^ rotateRight(w[i - 15], 18) ^ (w[i - 15] >>> 3);\n      const s1 = rotateRight(w[i - 2], 17) ^ rotateRight(w[i - 2], 19) ^ (w[i - 2] >>> 10);\n      w[i] = (w[i - 16] + s0 + w[i - 7] + s1) >>> 0;\n    }\n\n    let a = H[0];\n    let b = H[1];\n    let c = H[2];\n    let d = H[3];\n    let e = H[4];\n    let f = H[5];\n    let g = H[6];\n    let h = H[7];\n\n    for (let i = 0; i < 64; i++) {\n      const S1 = rotateRight(e, 6) ^ rotateRight(e, 11) ^ rotateRight(e, 25);\n      const ch = (e & f) ^ (~e & g);\n      const temp1 = (h + S1 + ch + K[i] + w[i]) >>> 0;\n      const S0 = rotateRight(a, 2) ^ rotateRight(a, 13) ^ rotateRight(a, 22);\n      const maj = (a & b) ^ (a & c) ^ (b & c);\n      const temp2 = (S0 + maj) >>> 0;\n\n      h = g;\n      g = f;\n      f = e;\n      e = (d + temp1) >>> 0;\n      d = c;\n      c = b;\n      b = a;\n      a = (temp1 + temp2) >>> 0;\n    }\n\n    H[0] = (H[0] + a) >>> 0;\n    H[1] = (H[1] + b) >>> 0;\n    H[2] = (H[2] + c) >>> 0;\n    H[3] = (H[3] + d) >>> 0;\n    H[4] = (H[4] + e) >>> 0;\n    H[5] = (H[5] + f) >>> 0;\n    H[6] = (H[6] + g) >>> 0;\n    H[7] = (H[7] + h) >>> 0;\n  }\n\n  return Array.from(H)\n    .map(word => word.toString(16).padStart(8, '0'))\n    .join('')\n    .toUpperCase();\n}\n\nasync function buildSecurityParamsWithReason(): Promise<SecurityBuildResult> {\n  try {\n    let ticks = Date.now() / 1000 + clockSkewSeconds;\n    ticks += WIN_EPOCH_SECONDS;\n    ticks -= ticks % 300;\n    ticks *= SECONDS_TO_NANOSECONDS / 100;\n    const secMsGec = await toSha256HexUpper(`${ticks.toFixed(0)}${TRUSTED_CLIENT_TOKEN}`);\n    return {\n      security: { secMsGec, secMsGecVersion: SEC_MS_GEC_VERSION },\n      error: '',\n    };\n  } catch (e) {\n    return {\n      security: null,\n      error: e instanceof Error ? e.message : String(e),\n    };\n  }\n}\n\nexport async function buildSecurityParams(): Promise<EdgeSecurityParams | null> {\n  const { security } = await buildSecurityParamsWithReason();\n  return security;\n}\n\nfunction mapEdgeVoice(item: EdgeVoiceApiItem): TTSSpeakerVoice | null {\n  const shortName = String(item.ShortName || '').trim();\n  if (!shortName) return null;\n\n  const locale = String(item.Locale || '').trim();\n  const gender = String(item.Gender || '').trim();\n  const friendlyName = String(item.FriendlyName || '').trim();\n  const desc = [friendlyName, locale, gender].filter(Boolean).join(' | ');\n\n  return {\n    name: shortName,\n    value: shortName,\n    source: 'edge_tts_direct',\n    resourceId: null,\n    desc: desc || 'EdgeTTS Direct',\n  };\n}\n\nfunction dedupeVoices(list: TTSSpeakerVoice[]): TTSSpeakerVoice[] {\n  const seen = new Set<string>();\n  const result: TTSSpeakerVoice[] = [];\n  for (const voice of list) {\n    const key = String(voice.value || voice.name || '').trim().toLowerCase();\n    if (!key || seen.has(key)) continue;\n    seen.add(key);\n    result.push(voice);\n  }\n  return result.sort((a, b) => a.name.localeCompare(b.name));\n}\n\nfunction parseServerDateHeader(response: Response): number | null {\n  const date = response.headers.get('date') || response.headers.get('Date');\n  if (!date) return null;\n  const ts = new Date(date).getTime();\n  if (!Number.isFinite(ts)) return null;\n  return ts / 1000;\n}\n\nasync function fetchVoicesOnce(url: string): Promise<TTSSpeakerVoice[]> {\n  const response = await fetch(url, {\n    headers: {\n      Accept: '*/*',\n      'Accept-Language': 'en-US,en;q=0.9',\n    },\n  });\n\n  const serverDate = parseServerDateHeader(response);\n  if (serverDate !== null) {\n    const clientDate = Date.now() / 1000 + clockSkewSeconds;\n    clockSkewSeconds += serverDate - clientDate;\n  }\n\n  if (!response.ok) {\n    throw new Error(`EdgeTTS voices request failed (HTTP ${response.status})`);\n  }\n\n  const payload = (await response.json()) as EdgeVoiceApiItem[];\n  if (!Array.isArray(payload)) {\n    throw new Error('EdgeTTS voices response is not an array');\n  }\n\n  const mapped = payload.map(mapEdgeVoice).filter(Boolean) as TTSSpeakerVoice[];\n  return dedupeVoices(mapped);\n}\n\nexport async function fetchEdgeVoices(): Promise<TTSSpeakerVoice[]> {\n  const securityResult = await buildSecurityParamsWithReason();\n  const security = securityResult.security;\n  const urls: string[] = [];\n\n  if (security) {\n    urls.push(\n      `${VOICE_LIST_URL}&Sec-MS-GEC=${encodeURIComponent(security.secMsGec)}&Sec-MS-GEC-Version=${encodeURIComponent(security.secMsGecVersion)}`,\n    );\n  }\n  urls.push(VOICE_LIST_URL);\n\n  let lastError: unknown = null;\n  for (const url of urls) {\n    try {\n      const voices = await fetchVoicesOnce(url);\n      if (voices.length > 0) return voices;\n      lastError = new Error('EdgeTTS voices response is empty');\n    } catch (e) {\n      lastError = e;\n    }\n  }\n\n  if (!security && securityResult.error) {\n    const base = lastError instanceof Error ? lastError.message : String(lastError || 'unknown');\n    throw new Error(`EdgeTTS voices request failed. security-unavailable: ${securityResult.error}; last: ${base}`);\n  }\n  throw lastError instanceof Error ? lastError : new Error('EdgeTTS voices request failed');\n}\n\nexport function getEdgeFallbackVoices(): TTSSpeakerVoice[] {\n  return EDGE_FALLBACK_SHORT_VOICES.map(item => ({\n    name: item.shortName,\n    value: item.shortName,\n    source: 'edge_tts_direct',\n    resourceId: null,\n    desc: `${item.locale} | ${item.gender}`,\n  }));\n}\n\nasync function synthesizeWithSocketUrl(\n  socketUrl: string,\n  text: string,\n  voiceName: string,\n  options: EdgeDirectSynthesisOptions,\n  timestampMode: EdgeTimestampMode,\n  attemptLabel: string,\n): Promise<Blob> {\n  const timeoutMs = Number.isFinite(options.timeoutMs) ? Math.max(3000, Number(options.timeoutMs)) : 25000;\n\n  return new Promise<Blob>((resolve, reject) => {\n    let done = false;\n    let ws: WebSocket | null = null;\n    let timeoutId: number | null = null;\n    const chunks: Uint8Array[] = [];\n    let sawSocketError = false;\n    let sawOpen = false;\n    let closeCode = 0;\n    let closeReason = '';\n    let closeWasClean = false;\n\n    const finish = (fn: () => void) => {\n      if (done) return;\n      done = true;\n      if (timeoutId !== null) window.clearTimeout(timeoutId);\n      if (ws) {\n        ws.onopen = null;\n        ws.onmessage = null;\n        ws.onerror = null;\n        ws.onclose = null;\n      }\n      options.onSocket?.(null);\n      if (options.signal) {\n        options.signal.removeEventListener('abort', onAbort);\n      }\n      fn();\n    };\n\n    const fail = (error: unknown) => {\n      finish(() => reject(error instanceof Error ? error : new Error(String(error))));\n    };\n\n    const onAbort = () => {\n      try {\n        ws?.close(1000, 'abort');\n      } catch {\n        // ignore\n      }\n      fail(toAbortError('EdgeTTS direct synthesis aborted'));\n    };\n\n    if (options.signal?.aborted) {\n      fail(toAbortError('EdgeTTS direct synthesis aborted'));\n      return;\n    }\n\n    if (options.signal) {\n      options.signal.addEventListener('abort', onAbort, { once: true });\n    }\n\n    ws = new WebSocket(socketUrl);\n    ws.binaryType = 'arraybuffer';\n    options.onSocket?.(ws);\n\n    timeoutId = window.setTimeout(() => {\n      try {\n        ws?.close(1013, 'timeout');\n      } catch {\n        // ignore\n      }\n      fail(new Error(`EdgeTTS direct websocket timeout (${attemptLabel})`));\n    }, timeoutMs);\n\n    ws.onopen = () => {\n      sawOpen = true;\n      const timestamp = dateToString(timestampMode);\n      ws?.send(buildSpeechConfigMessage(timestamp));\n      ws?.send(buildSsmlMessage(buildConnectionId(), timestamp, buildSsml(text, voiceName)));\n    };\n\n    ws.onmessage = event => {\n      if (done) return;\n\n      if (typeof event.data === 'string') {\n        const headers = parseHeadersFromTextMessage(event.data);\n        const path = String(headers.Path || headers.path || '').toLowerCase();\n        if (path === 'turn.end') {\n          try {\n            ws?.close(1000, 'turn.end');\n          } catch {\n            // ignore\n          }\n        }\n        return;\n      }\n\n      const handleBinary = async () => {\n        const data = event.data;\n        let bytes: Uint8Array | null = null;\n\n        if (data instanceof ArrayBuffer) {\n          bytes = new Uint8Array(data);\n        } else if (ArrayBuffer.isView(data)) {\n          bytes = new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n        } else if (data instanceof Blob) {\n          bytes = new Uint8Array(await data.arrayBuffer());\n        }\n        if (!bytes || bytes.length < 2) return;\n\n        const { headers, payload } = parseHeadersAndDataFromBinaryMessage(bytes);\n        const path = String(headers.Path || headers.path || '').toLowerCase();\n        if (path !== 'audio') return;\n\n        const contentType = String(headers['Content-Type'] || headers['content-type'] || '').toLowerCase();\n        if (contentType && !contentType.startsWith('audio/')) return;\n        if (payload.length > 0) {\n          chunks.push(payload);\n        }\n      };\n\n      void handleBinary().catch(fail);\n    };\n\n    ws.onerror = () => {\n      // Browser WebSocket error events don't expose useful details.\n      // Keep the event and wait for onclose to obtain close code/reason.\n      sawSocketError = true;\n    };\n\n    ws.onclose = event => {\n      closeCode = event.code;\n      closeReason = String(event.reason || '').trim();\n      closeWasClean = !!event.wasClean;\n\n      if (done) return;\n      if (options.signal?.aborted) {\n        fail(toAbortError('EdgeTTS direct synthesis aborted'));\n        return;\n      }\n      if (chunks.length <= 0) {\n        fail(\n          new Error(\n            `No audio frame received from EdgeTTS direct websocket (${attemptLabel}; code=${closeCode}, clean=${closeWasClean}, opened=${sawOpen}, errorEvent=${sawSocketError}, reason=${closeReason || 'n/a'})`,\n          ),\n        );\n        return;\n      }\n\n      const merged = concatChunks(chunks);\n      const blob = new Blob([merged as unknown as ArrayBufferView], { type: 'audio/mpeg' });\n      finish(() => resolve(blob));\n    };\n  });\n}\n\nexport async function synthesizeToBlob(\n  text: string,\n  voice: TTSSpeakerVoice | string,\n  options: EdgeDirectSynthesisOptions = {},\n): Promise<Blob> {\n  const cleanText = removeIncompatibleCharacters(String(text || '')).trim();\n  if (!cleanText) {\n    throw new Error('EdgeTTS text is empty');\n  }\n\n  const voiceName = getVoiceName(voice);\n  if (!voiceName) {\n    throw new Error('EdgeTTS voice is empty');\n  }\n\n  const securityResult = await buildSecurityParamsWithReason();\n  const security = securityResult.security;\n  const attempts: Array<{ socketUrl: string; timestampMode: EdgeTimestampMode; label: string }> = [];\n  if (security) {\n    attempts.push({\n      socketUrl: `${WSS_URL}&Sec-MS-GEC=${encodeURIComponent(security.secMsGec)}&Sec-MS-GEC-Version=${encodeURIComponent(security.secMsGecVersion)}&ConnectionId=${buildConnectionId()}`,\n      timestampMode: 'utc_string',\n      label: 'with-sec/utc',\n    });\n    attempts.push({\n      socketUrl: `${WSS_URL}&Sec-MS-GEC=${encodeURIComponent(security.secMsGec)}&Sec-MS-GEC-Version=${encodeURIComponent(security.secMsGecVersion)}&ConnectionId=${buildConnectionId()}`,\n      timestampMode: 'iso_compact',\n      label: 'with-sec/iso',\n    });\n  }\n  const plainBase = `${WSS_URL}&ConnectionId=${buildConnectionId()}`;\n  attempts.push({\n    socketUrl: plainBase,\n    timestampMode: 'utc_string',\n    label: 'plain/utc',\n  });\n  attempts.push({\n    socketUrl: plainBase,\n    timestampMode: 'iso_compact',\n    label: 'plain/iso',\n  });\n\n  let lastError: unknown = null;\n  const attemptErrors: string[] = [];\n  for (const attempt of attempts) {\n    try {\n      return await synthesizeWithSocketUrl(\n        attempt.socketUrl,\n        cleanText,\n        voiceName,\n        options,\n        attempt.timestampMode,\n        attempt.label,\n      );\n    } catch (e) {\n      lastError = e;\n      const message = e instanceof Error ? e.message : String(e);\n      attemptErrors.push(`${attempt.label}: ${message}`);\n      if (options.signal?.aborted) {\n        throw toAbortError('EdgeTTS direct synthesis aborted');\n      }\n    }\n  }\n\n  if (attemptErrors.length > 0) {\n    const ua = String(globalThis.navigator?.userAgent || '');\n    const isEdgeUA = /Edg\\//i.test(ua);\n    const allUnopened = attemptErrors.every(msg => /opened=false/.test(msg));\n    const likelyUaRejected = !isEdgeUA && allUnopened;\n    const securityHint =\n      !security && securityResult.error ? ` security-unavailable=${securityResult.error};` : '';\n    const uaHint = likelyUaRejected ? ' likely-cause=ua-not-edg;' : '';\n    throw new Error(`EdgeTTS direct synthesis failed.${securityHint}${uaHint} ${attemptErrors.join(' | ')}`);\n  }\n  throw lastError instanceof Error ? lastError : new Error('EdgeTTS direct synthesis failed');\n}\n","import { SCRIPT_NAME } from '../core/constants';\nimport { useSettingsStore } from '../core/settings';\nimport { fetchEdgeVoices, getEdgeFallbackVoices } from './edge-tts-direct';\n// ============================================\n// TTS  (Providers)\n// : galgame/src/audio/tts-config.js\n// ============================================\nexport const TTS_PROVIDER = {\n    LITTLEWHITEBOX: 'littlewhitebox',\n    GPT_SOVITS_V2: 'gpt_sovits_v2',\n    EDGE_TTS_DIRECT: 'edge_tts_direct',\n};\nfunction normalizePathSep(path) {\n    return String(path || '').replace(/\\\\/g, '/');\n}\nfunction getTopWindow() {\n    try {\n        return window.parent ?? window;\n    }\n    catch {\n        return window;\n    }\n}\nfunction getStoragePrefix() {\n    try {\n        if (typeof getScriptId === 'function') {\n            const id = String(getScriptId() ?? '').trim();\n            if (id)\n                return id;\n        }\n    }\n    catch {\n        // ignore\n    }\n    return SCRIPT_NAME;\n}\nfunction getTtsEnabledKey() {\n    return `${getStoragePrefix()}_tts_enabled`;\n}\nfunction getCharTtsVoiceKey() {\n    return `${getStoragePrefix()}_char_tts_voice`;\n}\nexport function normalizeGptSoVitsSwitchMode(mode) {\n    const s = String(mode || '').trim().toLowerCase();\n    if (s === 'none' || s === 'off' || s === 'disabled')\n        return 'none';\n    if (s === 'set_model' || s === 'model')\n        return 'set_model';\n    return 'set_weights';\n}\nfunction normalizeSetModelEndpoint(endpoint) {\n    const raw = String(endpoint || '').trim();\n    if (!raw)\n        return '/set_model';\n    return raw.startsWith('/') ? raw : `/${raw}`;\n}\nfunction toFiniteNumber(value, fallback) {\n    const n = Number(value);\n    return Number.isFinite(n) ? n : fallback;\n}\nfunction safeObject(value) {\n    return (value && typeof value === 'object' ? value : {});\n}\nfunction safeArray(value) {\n    return Array.isArray(value) ? value : [];\n}\nfunction buildGptSoVitsModelId(seed = 'model') {\n    const base = String(seed || 'model')\n        .trim()\n        .replace(/[^\\w\\u4e00-\\u9fff.-]+/g, '_')\n        .replace(/^_+|_+$/g, '')\n        .toLowerCase();\n    const ts = Date.now().toString(36);\n    const rnd = Math.floor(Math.random() * 1e6).toString(36);\n    return `${base || 'model'}_${ts}_${rnd}`;\n}\nfunction normalizeGptSoVitsRefAudio(ref, index = 0, defaults = {}) {\n    const raw = safeObject(ref);\n    const path = normalizePathSep(String(raw.path || raw.refAudioPath || raw.ref_audio_path || '').trim());\n    if (!path)\n        return null;\n    const idRaw = String(raw.id || raw.refId || '').trim() || `ref_${index + 1}`;\n    const id = idRaw.replace(/[^\\w\\u4e00-\\u9fff.-]+/g, '_');\n    const name = String(raw.name || raw.label || id || `${index + 1}`).trim() || `${index + 1}`;\n    return {\n        id,\n        name,\n        path,\n        promptText: String(raw.promptText || raw.prompt_text || defaults.promptText || '').trim(),\n        promptLang: String(raw.promptLang || raw.prompt_lang || defaults.promptLang || 'zh').trim() || 'zh',\n        textLang: String(raw.textLang || raw.text_lang || defaults.textLang || 'auto').trim() || 'auto',\n    };\n}\nfunction normalizeGptSoVitsModel(model, globalDefaults, index = 0) {\n    const raw = safeObject(model);\n    const paths = safeObject(raw.paths);\n    const params = safeObject(raw.params);\n    const name = String(raw.name || raw.modelName || raw.voice || raw.speaker || '').trim();\n    if (!name)\n        return null;\n    const id = String(raw.id || '')\n        .trim()\n        .replace(/[^\\w\\u4e00-\\u9fff.-]+/g, '_') || buildGptSoVitsModelId(name || `model_${index + 1}`);\n    const modelParams = {\n        promptText: String(params.promptText || params.prompt_text || raw.promptText || raw.prompt_text || '').trim(),\n        promptLang: String(params.promptLang || params.prompt_lang || raw.promptLang || raw.prompt_lang || 'zh').trim() || 'zh',\n        textLang: String(params.textLang || params.text_lang || raw.textLang || raw.text_lang || globalDefaults.textLang || 'auto').trim() || 'auto',\n        textSplitMethod: String(params.textSplitMethod ||\n            params.text_split_method ||\n            raw.textSplitMethod ||\n            raw.text_split_method ||\n            globalDefaults.textSplitMethod ||\n            'cut5').trim() || 'cut5',\n        speedFactor: toFiniteNumber(params.speedFactor ?? params.speed_factor ?? raw.speedFactor ?? raw.speed_factor, toFiniteNumber(globalDefaults.speedFactor, 1)),\n        mediaType: String(params.mediaType || params.media_type || raw.mediaType || raw.media_type || globalDefaults.mediaType || 'wav')\n            .trim() || 'wav',\n        streamingMode: !!(params.streamingMode ??\n            params.streaming_mode ??\n            raw.streamingMode ??\n            raw.streaming_mode ??\n            globalDefaults.streamingMode),\n        modelSwitchMode: normalizeGptSoVitsSwitchMode(params.modelSwitchMode || raw.modelSwitchMode || globalDefaults.modelSwitchMode || 'set_weights'),\n        setModelEndpoint: normalizeSetModelEndpoint(params.setModelEndpoint || raw.setModelEndpoint || globalDefaults.setModelEndpoint || '/set_model'),\n        strictWeightSwitch: !!(params.strictWeightSwitch ?? raw.strictWeightSwitch ?? globalDefaults.strictWeightSwitch),\n    };\n    const gptWeightsPath = normalizePathSep(String(paths.gptWeightsPath || paths.gpt_weights_path || raw.gptWeightsPath || raw.gpt_weights_path || '').trim());\n    const sovitsWeightsPath = normalizePathSep(String(paths.sovitsWeightsPath || paths.sovits_weights_path || raw.sovitsWeightsPath || raw.sovits_weights_path || '').trim());\n    const defaultRefAudioPath = normalizePathSep(String(paths.defaultRefAudioPath || raw.defaultRefAudioPath || raw.refAudioPath || raw.ref_audio_path || '').trim());\n    const refAudioCandidates = [\n        ...safeArray(raw.refAudios),\n        ...safeArray(raw.references),\n        ...safeArray(raw.refAudioList),\n    ];\n    if (defaultRefAudioPath) {\n        refAudioCandidates.unshift({\n            id: String(raw.defaultRefId || 'ref_default').trim() || 'ref_default',\n            name: '',\n            path: defaultRefAudioPath,\n            promptText: modelParams.promptText,\n            promptLang: modelParams.promptLang,\n            textLang: modelParams.textLang,\n        });\n    }\n    const refAudios = [];\n    const refIds = new Set();\n    const refPaths = new Set();\n    for (const [refIndex, item] of refAudioCandidates.entries()) {\n        const normalized = normalizeGptSoVitsRefAudio(item, refIndex, modelParams);\n        if (!normalized)\n            continue;\n        if (refPaths.has(normalized.path))\n            continue;\n        let nextId = normalized.id || `ref_${refAudios.length + 1}`;\n        let dedupe = 2;\n        while (refIds.has(nextId)) {\n            nextId = `${normalized.id}_${dedupe++}`;\n        }\n        normalized.id = nextId;\n        refIds.add(nextId);\n        refPaths.add(normalized.path);\n        refAudios.push(normalized);\n    }\n    let defaultRefId = String(raw.defaultRefId || '').trim();\n    if (defaultRefId && !refAudios.some(item => item.id === defaultRefId)) {\n        defaultRefId = '';\n    }\n    if (!defaultRefId && defaultRefAudioPath) {\n        defaultRefId = refAudios.find(item => item.path === defaultRefAudioPath)?.id || '';\n    }\n    if (!defaultRefId && refAudios.length > 0) {\n        defaultRefId = refAudios[0].id;\n    }\n    const resolvedDefaultRefPath = refAudios.find(item => item.id === defaultRefId)?.path || defaultRefAudioPath || refAudios[0]?.path || '';\n    const rawMap = safeObject(raw.expressionRefMap || raw.expressionMap);\n    const expressionRefMap = {};\n    Object.entries(rawMap).forEach(([expr, refId]) => {\n        const exprText = String(expr || '').trim();\n        const resolvedRefId = String(refId || '').trim();\n        if (!exprText || !resolvedRefId)\n            return;\n        if (!refAudios.some(item => item.id === resolvedRefId))\n            return;\n        expressionRefMap[exprText] = resolvedRefId;\n    });\n    return {\n        id,\n        name,\n        enabled: raw.enabled !== false,\n        desc: String(raw.desc || raw.description || '').trim(),\n        paths: {\n            gptWeightsPath,\n            sovitsWeightsPath,\n            defaultRefAudioPath: resolvedDefaultRefPath,\n        },\n        params: modelParams,\n        refAudios,\n        defaultRefId,\n        expressionRefMap,\n    };\n}\nfunction normalizeGptSoVitsModelsForStoreInternal(modelList, globalDefaults) {\n    const out = [];\n    const idSet = new Set();\n    const nameSet = new Set();\n    for (const [index, model] of safeArray(modelList).entries()) {\n        const normalized = normalizeGptSoVitsModel(model, globalDefaults, index);\n        if (!normalized)\n            continue;\n        let id = normalized.id;\n        while (idSet.has(id))\n            id = buildGptSoVitsModelId(id);\n        normalized.id = id;\n        idSet.add(id);\n        const baseName = normalized.name;\n        let nextName = baseName;\n        let dedupe = 2;\n        while (nameSet.has(nextName)) {\n            nextName = `${baseName}_${dedupe++}`;\n        }\n        normalized.name = nextName;\n        nameSet.add(nextName);\n        out.push(normalized);\n    }\n    return out;\n}\nfunction buildRuntimeVoiceFromModel(model, globalCfg) {\n    if (!model || model.enabled === false)\n        return null;\n    const refs = safeArray(model.refAudios);\n    const defaultRef = refs.find(item => item.id === model.defaultRefId) ||\n        refs.find(item => item.path === model.paths?.defaultRefAudioPath) ||\n        refs[0] ||\n        null;\n    const params = safeObject(model.params);\n    const promptText = String(defaultRef?.promptText || params.promptText || '').trim();\n    const promptLang = String(defaultRef?.promptLang || params.promptLang || 'zh').trim() || 'zh';\n    const textLang = String(defaultRef?.textLang || params.textLang || globalCfg.textLang || 'auto').trim() || 'auto';\n    return {\n        name: model.name,\n        value: model.name,\n        source: TTS_PROVIDER.GPT_SOVITS_V2,\n        resourceId: null,\n        desc: model.desc || 'GPT-SoVITS',\n        gptSoVitsModel: model,\n        gptSoVits: {\n            refAudioPath: String(defaultRef?.path || model.paths?.defaultRefAudioPath || '').trim(),\n            promptText,\n            promptLang,\n            textLang,\n            gptWeightsPath: String(model.paths?.gptWeightsPath || '').trim(),\n            sovitsWeightsPath: String(model.paths?.sovitsWeightsPath || '').trim(),\n            textSplitMethod: String(params.textSplitMethod || globalCfg.textSplitMethod || 'cut5').trim() || 'cut5',\n            speedFactor: toFiniteNumber(params.speedFactor, toFiniteNumber(globalCfg.speedFactor, 1)),\n            mediaType: String(params.mediaType || globalCfg.mediaType || 'wav').trim() || 'wav',\n            streamingMode: !!(params.streamingMode ?? globalCfg.streamingMode),\n            modelSwitchMode: normalizeGptSoVitsSwitchMode(params.modelSwitchMode || globalCfg.modelSwitchMode || 'set_weights'),\n            setModelEndpoint: normalizeSetModelEndpoint(params.setModelEndpoint || globalCfg.setModelEndpoint || '/set_model'),\n            strictWeightSwitch: !!(params.strictWeightSwitch ?? globalCfg.strictWeightSwitch),\n        },\n    };\n}\nexport function getTTSProvider() {\n    try {\n        const store = useSettingsStore();\n        return store.settings.ttsProvider || TTS_PROVIDER.LITTLEWHITEBOX;\n    }\n    catch {\n        return TTS_PROVIDER.LITTLEWHITEBOX;\n    }\n}\nexport function getGptSoVitsConfig() {\n    const defaults = {\n        apiUrl: 'http://127.0.0.1:9880',\n        endpoint: '/tts',\n        useCorsProxy: true,\n        mediaType: 'wav',\n        streamingMode: false,\n        textLang: 'auto',\n        textSplitMethod: 'cut5',\n        speedFactor: 1,\n        strictWeightSwitch: false,\n        probeOnAudioError: false,\n        modelSwitchMode: 'set_weights',\n        setModelEndpoint: '/set_model',\n        rootDir: '',\n        importPathPrefix: '',\n        models: [],\n        voices: [],\n    };\n    try {\n        const store = useSettingsStore();\n        const cfg = store.settings.gptSoVits || {};\n        const normalizedRootDir = normalizePathSep(String(cfg.rootDir || cfg.importPathPrefix || '').trim());\n        const normalizedImportPrefix = normalizePathSep(String(cfg.importPathPrefix || normalizedRootDir || '').trim());\n        const merged = Object.assign(Object.assign({}, defaults), cfg, {\n            modelSwitchMode: normalizeGptSoVitsSwitchMode(cfg.modelSwitchMode || defaults.modelSwitchMode),\n            setModelEndpoint: normalizeSetModelEndpoint(cfg.setModelEndpoint || defaults.setModelEndpoint),\n            rootDir: normalizedRootDir || normalizedImportPrefix,\n            importPathPrefix: normalizedImportPrefix || normalizedRootDir,\n            models: Array.isArray(cfg.models) ? cfg.models : defaults.models,\n            voices: Array.isArray(cfg.voices) ? cfg.voices : defaults.voices,\n        });\n        const normalizedModels = merged.models.length > 0\n            ? normalizeGptSoVitsModelsForStoreInternal(merged.models, merged)\n            : legacyVoicesToModels(merged.voices, merged);\n        return Object.assign({}, merged, {\n            models: normalizedModels,\n        });\n    }\n    catch {\n        return defaults;\n    }\n}\nexport function normalizeGptSoVitsVoice(voice) {\n    if (!voice)\n        return null;\n    const rawCfg = voice?.gptSoVits || {};\n    const name = String(voice.name || voice.voice || voice.speaker || rawCfg.name || '').trim();\n    if (!name)\n        return null;\n    const refAudioPath = normalizePathSep(String(voice.refAudioPath ||\n        voice.ref_audio_path ||\n        voice.ref_audio ||\n        voice.ref ||\n        rawCfg.refAudioPath ||\n        '').trim());\n    const promptText = String(voice.promptText || voice.prompt_text || rawCfg.promptText || '').trim();\n    const promptLang = String(voice.promptLang || voice.prompt_lang || rawCfg.promptLang || '').trim();\n    const textLang = String(voice.textLang || voice.text_lang || rawCfg.textLang || '').trim();\n    const gptWeightsPath = normalizePathSep(String(voice.gptWeightsPath || voice.gpt_weights_path || voice.gptPath || voice.gpt || rawCfg.gptWeightsPath || '').trim());\n    const sovitsWeightsPath = normalizePathSep(String(voice.sovitsWeightsPath ||\n        voice.sovits_weights_path ||\n        voice.sovitsPath ||\n        voice.sovits ||\n        rawCfg.sovitsWeightsPath ||\n        '').trim());\n    const modelSwitchMode = normalizeGptSoVitsSwitchMode(voice.modelSwitchMode || voice.model_switch_mode || rawCfg.modelSwitchMode || '');\n    const setModelEndpoint = normalizeSetModelEndpoint(voice.setModelEndpoint || voice.set_model_endpoint || rawCfg.setModelEndpoint || '/set_model');\n    const strictWeightSwitch = !!(voice.strictWeightSwitch ??\n        voice.strict_weight_switch ??\n        rawCfg.strictWeightSwitch);\n    const desc = String(voice.desc || voice.description || '').trim();\n    return {\n        name,\n        value: name,\n        source: TTS_PROVIDER.GPT_SOVITS_V2,\n        resourceId: null,\n        desc: desc || 'GPT-SoVITS',\n        gptSoVits: {\n            refAudioPath,\n            promptText,\n            promptLang,\n            textLang,\n            gptWeightsPath,\n            sovitsWeightsPath,\n            modelSwitchMode,\n            setModelEndpoint,\n            strictWeightSwitch,\n        },\n    };\n}\nfunction toGptSoVitsVoiceConfig(voice, globalDefaults = null) {\n    const normalized = normalizeGptSoVitsVoice(voice);\n    if (!normalized)\n        return null;\n    const cfg = normalized.gptSoVits || {};\n    const globalCfg = globalDefaults || getGptSoVitsConfig();\n    const desc = String(voice?.desc || voice?.description || '').trim();\n    return {\n        name: normalized.name,\n        desc,\n        refAudioPath: normalizePathSep(String(cfg.refAudioPath || '').trim()),\n        promptText: String(cfg.promptText || '').trim(),\n        promptLang: String(cfg.promptLang || '').trim(),\n        textLang: String(cfg.textLang || '').trim(),\n        gptWeightsPath: normalizePathSep(String(cfg.gptWeightsPath || '').trim()),\n        sovitsWeightsPath: normalizePathSep(String(cfg.sovitsWeightsPath || '').trim()),\n        modelSwitchMode: normalizeGptSoVitsSwitchMode(cfg.modelSwitchMode || globalCfg.modelSwitchMode),\n        setModelEndpoint: normalizeSetModelEndpoint(cfg.setModelEndpoint || globalCfg.setModelEndpoint),\n        strictWeightSwitch: !!(cfg.strictWeightSwitch ?? globalCfg.strictWeightSwitch),\n    };\n}\nfunction legacyVoicesToModels(voiceList, globalDefaults) {\n    const models = [];\n    for (const [index, voice] of safeArray(voiceList).entries()) {\n        const cfg = toGptSoVitsVoiceConfig(voice, globalDefaults);\n        if (!cfg)\n            continue;\n        models.push({\n            id: buildGptSoVitsModelId(cfg.name || `model_${index + 1}`),\n            name: cfg.name || `${index + 1}`,\n            enabled: true,\n            desc: cfg.desc || '',\n            paths: {\n                gptWeightsPath: cfg.gptWeightsPath || '',\n                sovitsWeightsPath: cfg.sovitsWeightsPath || '',\n                defaultRefAudioPath: cfg.refAudioPath || '',\n            },\n            params: {\n                promptText: cfg.promptText || '',\n                promptLang: cfg.promptLang || 'zh',\n                textLang: cfg.textLang || globalDefaults.textLang || 'auto',\n                textSplitMethod: globalDefaults.textSplitMethod || 'cut5',\n                speedFactor: toFiniteNumber(globalDefaults.speedFactor, 1),\n                mediaType: globalDefaults.mediaType || 'wav',\n                streamingMode: !!globalDefaults.streamingMode,\n                modelSwitchMode: normalizeGptSoVitsSwitchMode(globalDefaults.modelSwitchMode || 'set_weights'),\n                setModelEndpoint: normalizeSetModelEndpoint(globalDefaults.setModelEndpoint || '/set_model'),\n                strictWeightSwitch: !!globalDefaults.strictWeightSwitch,\n            },\n            refAudios: cfg.refAudioPath\n                ? [\n                    {\n                        id: 'ref_default',\n                        name: '',\n                        path: cfg.refAudioPath,\n                        promptText: cfg.promptText || '',\n                        promptLang: cfg.promptLang || 'zh',\n                        textLang: cfg.textLang || globalDefaults.textLang || 'auto',\n                    },\n                ]\n                : [],\n            defaultRefId: cfg.refAudioPath ? 'ref_default' : '',\n            expressionRefMap: {},\n        });\n    }\n    return normalizeGptSoVitsModelsForStoreInternal(models, globalDefaults);\n}\nexport function normalizeGptSoVitsModelsForStore(modelList, globalDefaults = null) {\n    const defaults = globalDefaults || getGptSoVitsConfig();\n    return normalizeGptSoVitsModelsForStoreInternal(modelList, defaults);\n}\nexport function isGptSoVitsVoiceUsable(voice) {\n    const cfg = toGptSoVitsVoiceConfig(voice);\n    return !!String(cfg?.refAudioPath || '').trim();\n}\nexport function normalizeGptSoVitsVoicesForStore(voiceList, globalDefaults = null) {\n    const out = [];\n    let ignoredCount = 0;\n    let missingRefCount = 0;\n    for (const voice of Array.isArray(voiceList) ? voiceList : []) {\n        const cfg = toGptSoVitsVoiceConfig(voice, globalDefaults);\n        if (!cfg) {\n            ignoredCount += 1;\n            continue;\n        }\n        if (!cfg.refAudioPath)\n            missingRefCount += 1;\n        out.push(cfg);\n    }\n    return { voices: out, ignoredCount, missingRefCount };\n}\nexport function pickFirstUsableGptSoVitsVoice(voiceList) {\n    for (const voice of Array.isArray(voiceList) ? voiceList : []) {\n        if (isGptSoVitsVoiceUsable(voice))\n            return voice;\n    }\n    return null;\n}\nfunction getFileExtLower(name) {\n    const s = String(name || '');\n    const idx = s.lastIndexOf('.');\n    return idx >= 0 ? s.slice(idx + 1).toLowerCase() : '';\n}\nfunction stripFileExt(name) {\n    const s = String(name || '');\n    return s.replace(/\\.[^./\\\\]+$/, '');\n}\nexport function isAbsoluteFileSystemPath(pathStr) {\n    const p = String(pathStr || '').trim();\n    if (!p)\n        return false;\n    if (/^[a-zA-Z]:[\\\\/]/.test(p))\n        return true;\n    if (p.startsWith('\\\\\\\\'))\n        return true;\n    if (p.startsWith('/'))\n        return true;\n    return false;\n}\nfunction joinPathPrefix(prefix, relPath) {\n    const p = String(prefix || '').trim();\n    const rel = String(relPath || '').trim();\n    if (!p)\n        return rel;\n    const useBackslash = p.includes('\\\\') && !p.includes('/');\n    const sep = useBackslash ? '\\\\' : '/';\n    const cleanPrefix = p.replace(/[\\\\/]+$/, '');\n    const cleanRel = rel.replace(/^[\\\\/]+/, '');\n    if (!cleanRel)\n        return cleanPrefix;\n    const normalizedPrefix = useBackslash ? cleanPrefix.replace(/[\\\\/]+/g, '\\\\') : cleanPrefix.replace(/[\\\\/]+/g, '/');\n    const normalizedRel = useBackslash ? cleanRel.replace(/[\\\\/]+/g, '\\\\') : cleanRel.replace(/[\\\\/]+/g, '/');\n    const lowerPrefix = normalizedPrefix.toLowerCase();\n    const lowerRel = normalizedRel.toLowerCase();\n    if (lowerRel === lowerPrefix || lowerRel.startsWith(`${lowerPrefix}${sep}`)) {\n        return normalizedRel;\n    }\n    const prefixSegs = normalizedPrefix.split(/[\\\\/]+/).filter(Boolean);\n    const relSegs = normalizedRel.split(/[\\\\/]+/).filter(Boolean);\n    if (prefixSegs.length > 0 && relSegs.length > 0) {\n        const tail = prefixSegs[prefixSegs.length - 1];\n        const head = relSegs[0];\n        if (tail && head && tail.toLowerCase() === head.toLowerCase()) {\n            return prefixSegs.concat(relSegs.slice(1)).join(sep);\n        }\n    }\n    return `${normalizedPrefix}${sep}${normalizedRel}`;\n}\nfunction inferLangFromText(text) {\n    const t = String(text || '');\n    if (/[\\u3040-\\u30ff]/.test(t))\n        return 'ja';\n    if (/[\\uac00-\\ud7af]/.test(t))\n        return 'ko';\n    if (/[a-zA-Z]/.test(t) && !/[\\u4e00-\\u9fff]/.test(t))\n        return 'en';\n    if (/[\\u4e00-\\u9fff]/.test(t))\n        return 'zh';\n    return 'zh';\n}\nfunction cleanPromptTextFromFilenameBase(baseName) {\n    let t = String(baseName || '').trim();\n    if (!t)\n        return '';\n    t = t.replace(/^[\\s\\uFEFF]*(?:[\\(\\[][^\\)\\]]{1,10}[\\)\\]])\\s*/g, '');\n    t = t.replace(/[.!?,]+$/g, '');\n    t = t.replace(/\\.{3,}/g, '...');\n    return t.trim();\n}\nfunction cleanVoiceNameFromWeightsBase(baseName) {\n    let t = String(baseName || '').trim();\n    if (!t)\n        return '';\n    t = t.replace(/^[A-Za-z0-9]{2,8}[_-]+/, '');\n    const suffixes = [\n        /[_-]v\\d+(?:proplus|pro|pp|p)?$/i,\n        /[_-](?:v2pp|v2p|v2|v3|v4)$/i,\n        /[_-](?:proplus|pro|pp|p)$/i,\n        /[_-](?:gpt|sovits|so-vits|vits)$/i,\n    ];\n    for (let i = 0; i < 4; i++) {\n        const before = t;\n        for (const re of suffixes)\n            t = t.replace(re, '');\n        if (before === t)\n            break;\n        t = t.trim();\n    }\n    return t.trim();\n}\nfunction pickLargestFile(files) {\n    if (!Array.isArray(files) || files.length === 0)\n        return null;\n    return files.slice().sort((a, b) => Number(b?.size || 0) - Number(a?.size || 0))[0] || null;\n}\nfunction pickBestAudioFile(audioFiles) {\n    if (!Array.isArray(audioFiles) || audioFiles.length === 0)\n        return null;\n    const candidates = audioFiles.map(file => {\n        const base = stripFileExt(file.name);\n        const promptText = cleanPromptTextFromFilenameBase(base);\n        const ext = getFileExtLower(file.name);\n        const extScore = ext === 'wav' ? 3 : ext === 'flac' ? 2 : ext === 'ogg' ? 1 : 0;\n        const lenScore = Math.min(200, promptText.length);\n        return { file, score: extScore * 1000 + lenScore };\n    });\n    candidates.sort((a, b) => b.score - a.score);\n    return candidates[0]?.file || null;\n}\nfunction weightsStemKey(fileName) {\n    let stem = String(stripFileExt(fileName) || '').toLowerCase().trim();\n    if (!stem)\n        return '';\n    stem = stem.replace(/[\\s._-]+/g, '');\n    stem = stem.replace(/(gpt|sovits|sovit|vits)+$/g, '');\n    return stem;\n}\nfunction collectWeightCandidates(ckpts, pths) {\n    const ckptList = Array.isArray(ckpts) ? ckpts.slice() : [];\n    const pthList = Array.isArray(pths) ? pths.slice() : [];\n    if (ckptList.length === 0 && pthList.length === 0)\n        return [];\n    ckptList.sort((a, b) => Number(b?.size || 0) - Number(a?.size || 0));\n    pthList.sort((a, b) => Number(b?.size || 0) - Number(a?.size || 0));\n    const ckptByBase = new Map();\n    const ckptByStem = new Map();\n    ckptList.forEach(file => {\n        const base = stripFileExt(file.name).toLowerCase();\n        if (!ckptByBase.has(base))\n            ckptByBase.set(base, file);\n        const stem = weightsStemKey(file.name);\n        if (stem && !ckptByStem.has(stem))\n            ckptByStem.set(stem, file);\n    });\n    const out = [];\n    const used = new Set();\n    const addCandidate = (gptFile, sovitsFile) => {\n        if (!gptFile && !sovitsFile)\n            return;\n        const key = `${gptFile?.name || ''}::${sovitsFile?.name || ''}`.toLowerCase();\n        if (used.has(key))\n            return;\n        used.add(key);\n        out.push({ gptFile: gptFile || null, sovitsFile: sovitsFile || null });\n    };\n    pthList.forEach(pth => {\n        const base = stripFileExt(pth.name).toLowerCase();\n        const matched = ckptByBase.get(base) || null;\n        if (matched)\n            addCandidate(matched, pth);\n    });\n    pthList.forEach(pth => {\n        const stem = weightsStemKey(pth.name);\n        const matched = stem ? ckptByStem.get(stem) || null : null;\n        if (matched)\n            addCandidate(matched, pth);\n    });\n    if (out.length === 0) {\n        addCandidate(pickLargestFile(ckptList), pickLargestFile(pthList));\n    }\n    const usedGpt = new Set(out.map(item => item.gptFile?.name).filter(Boolean));\n    const usedSovits = new Set(out.map(item => item.sovitsFile?.name).filter(Boolean));\n    pthList.forEach(file => {\n        if (!usedSovits.has(file.name))\n            addCandidate(null, file);\n    });\n    ckptList.forEach(file => {\n        if (!usedGpt.has(file.name))\n            addCandidate(file, null);\n    });\n    return out;\n}\nexport function inferGptSoVitsVoicesFromFolderFiles(fileList, importPathPrefix = '') {\n    const files = Array.from(fileList || []).filter(Boolean);\n    if (files.length === 0)\n        return [];\n    const groups = new Map();\n    for (const file of files) {\n        const rel = normalizePathSep(file.webkitRelativePath || file.name || '');\n        const dir = rel.split('/').slice(0, -1).join('/');\n        const key = dir || '__root__';\n        if (!groups.has(key))\n            groups.set(key, []);\n        groups.get(key).push(file);\n    }\n    const result = [];\n    for (const [dirKey, groupFiles] of groups.entries()) {\n        const ckpts = [];\n        const pths = [];\n        const audios = [];\n        for (const file of groupFiles) {\n            const ext = getFileExtLower(file.name);\n            if (ext === 'ckpt')\n                ckpts.push(file);\n            else if (ext === 'pth')\n                pths.push(file);\n            else if (['wav', 'mp3', 'flac', 'ogg', 'm4a'].includes(ext))\n                audios.push(file);\n        }\n        const audioFile = pickBestAudioFile(audios);\n        const promptText = audioFile ? cleanPromptTextFromFilenameBase(stripFileExt(audioFile.name)) : '';\n        const inferredLang = promptText ? inferLangFromText(promptText) : 'zh';\n        const toServerPath = (file) => {\n            const abs = typeof file?.path === 'string' ? String(file.path) : '';\n            if (isAbsoluteFileSystemPath(abs))\n                return abs;\n            const rel = normalizePathSep(file?.webkitRelativePath || file?.name || '');\n            return joinPathPrefix(importPathPrefix, rel);\n        };\n        const dirName = dirKey !== '__root__' ? dirKey.split('/').pop() || '' : '';\n        const candidatesRaw = collectWeightCandidates(ckpts, pths);\n        const candidates = candidatesRaw.length > 0 ? candidatesRaw : [{ gptFile: null, sovitsFile: null }];\n        const usedName = new Set();\n        for (const pair of candidates) {\n            const gptFile = pair.gptFile || null;\n            const sovitsFile = pair.sovitsFile || null;\n            const weightsBase = stripFileExt((sovitsFile || gptFile || audioFile || {}).name || '');\n            const baseName = cleanVoiceNameFromWeightsBase(weightsBase) || cleanVoiceNameFromWeightsBase(dirName) || '';\n            let voiceName = baseName;\n            let idx = 2;\n            while (usedName.has(voiceName)) {\n                voiceName = `${baseName}_${idx++}`;\n            }\n            usedName.add(voiceName);\n            const voice = {\n                name: voiceName,\n                desc: '',\n                refAudioPath: audioFile ? toServerPath(audioFile) : '',\n                promptText,\n                promptLang: inferredLang,\n                textLang: inferredLang,\n                gptWeightsPath: gptFile ? toServerPath(gptFile) : '',\n                sovitsWeightsPath: sovitsFile ? toServerPath(sovitsFile) : '',\n                modelSwitchMode: 'set_weights',\n                setModelEndpoint: '/set_model',\n                strictWeightSwitch: false,\n            };\n            if (voice.refAudioPath) {\n                result.push(voice);\n            }\n        }\n    }\n    return result;\n}\nfunction inferExpressionTagFromAudioName(baseName) {\n    const name = String(baseName || '')\n        .trim()\n        .toLowerCase();\n    if (!name)\n        return '';\n    const rules = [\n        { tag: '', patterns: ['happy', 'smile', 'laugh', 'joy', '', '', '', '', ''] },\n        { tag: '', patterns: ['angry', 'mad', 'rage', '', '', ''] },\n        { tag: '', patterns: ['sad', 'cry', 'sob', '', '', ''] },\n        { tag: '', patterns: ['surprise', 'wow', '', '', ''] },\n        { tag: '', patterns: ['shy', 'blush', '', ''] },\n        { tag: '', patterns: ['calm', 'normal', 'neutral', '', '', ''] },\n    ];\n    for (const rule of rules) {\n        if (rule.patterns.some(pattern => name.includes(pattern)))\n            return rule.tag;\n    }\n    return '';\n}\nexport function inferGptSoVitsModelsFromFolderFiles(fileList, importPathPrefix = '', importOptions = {}) {\n    const files = Array.from(fileList || []).filter(Boolean);\n    if (files.length === 0)\n        return [];\n    const normalizedImportPrefix = normalizePathSep(String(importPathPrefix || '').trim());\n    const rootHintRaw = String(importOptions?.relativeRootName || '').trim();\n    const normalizedRootHint = normalizePathSep(rootHintRaw).replace(/^[\\\\/]+|[\\\\/]+$/g, '');\n    const normalizeRelativePath = (file) => {\n        let rel = normalizePathSep(String(file?.webkitRelativePath || file?.name || '').trim()).replace(/^[\\\\/]+/, '');\n        if (!rel)\n            return '';\n        if (!normalizedRootHint)\n            return rel;\n        const lowerRel = rel.toLowerCase();\n        const lowerRoot = normalizedRootHint.toLowerCase();\n        if (lowerRel === lowerRoot || lowerRel.startsWith(`${lowerRoot}/`))\n            return rel;\n        return `${normalizedRootHint}/${rel}`;\n    };\n    const groups = new Map();\n    for (const file of files) {\n        const rel = normalizeRelativePath(file);\n        const dir = rel.split('/').slice(0, -1).join('/');\n        const key = dir || '__root__';\n        if (!groups.has(key))\n            groups.set(key, []);\n        groups.get(key).push(file);\n    }\n    const cfg = getGptSoVitsConfig();\n    const models = [];\n    for (const [dirKey, groupFiles] of groups.entries()) {\n        const ckpts = [];\n        const pths = [];\n        const audios = [];\n        for (const file of groupFiles) {\n            const ext = getFileExtLower(file.name);\n            if (ext === 'ckpt')\n                ckpts.push(file);\n            else if (ext === 'pth')\n                pths.push(file);\n            else if (['wav', 'mp3', 'flac', 'ogg', 'm4a'].includes(ext))\n                audios.push(file);\n        }\n        if (ckpts.length === 0 && pths.length === 0 && audios.length === 0)\n            continue;\n        const toServerPath = (file) => {\n            const abs = normalizePathSep(typeof file?.path === 'string' ? String(file.path) : '');\n            if (isAbsoluteFileSystemPath(abs))\n                return abs;\n            const rel = normalizeRelativePath(file);\n            if (!rel)\n                return '';\n            const prefixed = normalizePathSep(joinPathPrefix(normalizedImportPrefix, rel));\n            return prefixed || rel;\n        };\n        const audioCandidates = audios\n            .map(file => {\n            const base = stripFileExt(file.name);\n            const promptText = cleanPromptTextFromFilenameBase(base);\n            const inferredTag = inferExpressionTagFromAudioName(base);\n            return { file, promptText, inferredTag };\n        })\n            .filter(item => !!item.file);\n        const bestAudio = pickBestAudioFile(audios);\n        const weightCandidatesRaw = collectWeightCandidates(ckpts, pths);\n        const weightCandidates = weightCandidatesRaw.length > 0 ? weightCandidatesRaw : [{ gptFile: null, sovitsFile: null }];\n        const dirName = dirKey !== '__root__' ? dirKey.split('/').pop() || '' : '';\n        const groupNameUsed = new Set();\n        for (const pair of weightCandidates) {\n            const gptFile = pair.gptFile || null;\n            const sovitsFile = pair.sovitsFile || null;\n            const weightsBase = stripFileExt((sovitsFile || gptFile || bestAudio || {}).name || '');\n            const baseName = cleanVoiceNameFromWeightsBase(weightsBase) || cleanVoiceNameFromWeightsBase(dirName) || '';\n            let modelName = baseName;\n            let idx = 2;\n            while (groupNameUsed.has(modelName)) {\n                modelName = `${baseName}_${idx++}`;\n            }\n            groupNameUsed.add(modelName);\n            const refAudios = [];\n            const expressionRefMap = {};\n            const defaultRefBase = bestAudio ? normalizePathSep(toServerPath(bestAudio)) : '';\n            audioCandidates.forEach((item, audioIndex) => {\n                const path = normalizePathSep(toServerPath(item.file));\n                if (!path)\n                    return;\n                const id = `ref_${audioIndex + 1}`;\n                const name = stripFileExt(item.file.name) || `${audioIndex + 1}`;\n                const text = String(item.promptText || '').trim();\n                const lang = text ? inferLangFromText(text) : 'zh';\n                refAudios.push({\n                    id,\n                    name,\n                    path,\n                    promptText: text,\n                    promptLang: lang,\n                    textLang: lang,\n                });\n                if (item.inferredTag && !expressionRefMap[item.inferredTag]) {\n                    expressionRefMap[item.inferredTag] = id;\n                }\n            });\n            const defaultRef = refAudios.find(item => item.path === defaultRefBase) || refAudios[0] || null;\n            const defaultPromptText = String(defaultRef?.promptText || '').trim();\n            const defaultLang = defaultPromptText ? inferLangFromText(defaultPromptText) : 'zh';\n            const model = {\n                id: buildGptSoVitsModelId(modelName),\n                name: modelName,\n                enabled: true,\n                desc: '',\n                paths: {\n                    gptWeightsPath: gptFile ? normalizePathSep(toServerPath(gptFile)) : '',\n                    sovitsWeightsPath: sovitsFile ? normalizePathSep(toServerPath(sovitsFile)) : '',\n                    defaultRefAudioPath: defaultRef?.path || '',\n                },\n                params: {\n                    promptText: defaultPromptText,\n                    promptLang: defaultRef?.promptLang || defaultLang,\n                    textLang: defaultRef?.textLang || defaultLang,\n                    textSplitMethod: cfg.textSplitMethod || 'cut5',\n                    speedFactor: toFiniteNumber(cfg.speedFactor, 1),\n                    mediaType: cfg.mediaType || 'wav',\n                    streamingMode: !!cfg.streamingMode,\n                    modelSwitchMode: normalizeGptSoVitsSwitchMode(cfg.modelSwitchMode || 'set_weights'),\n                    setModelEndpoint: normalizeSetModelEndpoint(cfg.setModelEndpoint || '/set_model'),\n                    strictWeightSwitch: !!cfg.strictWeightSwitch,\n                },\n                refAudios,\n                defaultRefId: defaultRef?.id || '',\n                expressionRefMap,\n            };\n            if (model.paths.defaultRefAudioPath) {\n                models.push(model);\n            }\n        }\n    }\n    return normalizeGptSoVitsModelsForStore(models, cfg);\n}\nexport async function getGptSoVitsVoiceListAsync() {\n    const cfg = getGptSoVitsConfig();\n    const modelList = safeArray(cfg.models);\n    if (modelList.length > 0) {\n        return modelList.map(model => buildRuntimeVoiceFromModel(model, cfg)).filter(Boolean);\n    }\n    const list = Array.isArray(cfg.voices) ? cfg.voices : [];\n    return list.map(normalizeGptSoVitsVoice).filter(Boolean);\n}\nexport function getGptSoVitsVoiceList() {\n    try {\n        const cfg = getGptSoVitsConfig();\n        const modelList = safeArray(cfg.models);\n        if (modelList.length > 0) {\n            return modelList.map(model => buildRuntimeVoiceFromModel(model, cfg)).filter(Boolean);\n        }\n        const list = Array.isArray(cfg.voices) ? cfg.voices : [];\n        return list.map(normalizeGptSoVitsVoice).filter(Boolean);\n    }\n    catch {\n        return [];\n    }\n}\n// LittleWhiteBox TTS \nlet _lwbTtsCache = null;\nlet _lwbTtsCacheTime = 0;\nconst LWB_TTS_CACHE_MS = 5000;\nlet _edgeTtsCache = null;\nlet _edgeTtsCacheTime = 0;\nconst EDGE_TTS_CACHE_MS = 2 * 60 * 1000;\nexport async function getEdgeDirectVoiceListAsync() {\n    const now = Date.now();\n    if (_edgeTtsCache && now - _edgeTtsCacheTime <= EDGE_TTS_CACHE_MS) {\n        return _edgeTtsCache;\n    }\n    try {\n        const voices = await fetchEdgeVoices();\n        if (voices.length > 0) {\n            _edgeTtsCache = voices;\n            _edgeTtsCacheTime = now;\n            return voices;\n        }\n    }\n    catch (e) {\n        console.warn(`[${SCRIPT_NAME}] EdgeTTS :`, e);\n    }\n    const fallback = getEdgeFallbackVoices();\n    _edgeTtsCache = fallback;\n    _edgeTtsCacheTime = now;\n    return fallback;\n}\nexport function getEdgeDirectVoiceList() {\n    if (_edgeTtsCache && _edgeTtsCache.length > 0) {\n        return _edgeTtsCache;\n    }\n    return getEdgeFallbackVoices();\n}\nasync function fetchLittleWhiteBoxTTSConfig() {\n    try {\n        const response = await fetch('/user/files/LittleWhiteBox_TTS.json', { cache: 'no-cache' });\n        if (!response.ok)\n            return null;\n        const data = await response.json();\n        return data?.volc?.mySpeakers || null;\n    }\n    catch (e) {\n        console.log(`[${SCRIPT_NAME}]  LittleWhiteBox TTS :`, e);\n        return null;\n    }\n}\nexport async function getTTSVoiceListAsync() {\n    const provider = getTTSProvider();\n    if (provider === TTS_PROVIDER.GPT_SOVITS_V2) {\n        return getGptSoVitsVoiceListAsync();\n    }\n    if (provider === TTS_PROVIDER.EDGE_TTS_DIRECT) {\n        return getEdgeDirectVoiceListAsync();\n    }\n    const now = Date.now();\n    if (!_lwbTtsCache || now - _lwbTtsCacheTime > LWB_TTS_CACHE_MS) {\n        const mySpeakers = await fetchLittleWhiteBoxTTSConfig();\n        if (mySpeakers && mySpeakers.length > 0) {\n            _lwbTtsCache = mySpeakers.map((s) => ({\n                name: s.name,\n                value: s.value,\n                source: s.source || (isFreeVoice(s.value) ? 'free' : 'auth'),\n                resourceId: s.resourceId || inferResourceId(s.value),\n                desc: getVoiceDesc(s.value),\n            }));\n            _lwbTtsCacheTime = now;\n            return _lwbTtsCache;\n        }\n    }\n    else if (_lwbTtsCache) {\n        return _lwbTtsCache;\n    }\n    const topAny = getTopWindow();\n    const xbTts = topAny?.xiaobaixTts || window?.xiaobaixTts;\n    if (xbTts?.getConfig) {\n        const config = xbTts.getConfig();\n        const mySpeakers = config?.volc?.mySpeakers || [];\n        if (mySpeakers.length > 0) {\n            return mySpeakers.map((s) => ({\n                name: s.name,\n                value: s.value,\n                source: s.source || (isFreeVoice(s.value) ? 'free' : 'auth'),\n                resourceId: s.resourceId || inferResourceId(s.value),\n                desc: getVoiceDesc(s.value),\n            }));\n        }\n    }\n    const xbVoiceData = topAny?.XB_TTS_VOICE_DATA || window?.XB_TTS_VOICE_DATA;\n    if (Array.isArray(xbVoiceData) && xbVoiceData.length > 0) {\n        return xbVoiceData.slice(0, 20).map((v) => ({\n            name: v.name,\n            value: v.value,\n            source: inferSource(v.value),\n            resourceId: inferResourceId(v.value),\n            desc: v.scene || '',\n        }));\n    }\n    return getDefaultFreeVoices();\n}\nexport function getTTSVoiceList() {\n    const provider = getTTSProvider();\n    if (provider === TTS_PROVIDER.GPT_SOVITS_V2) {\n        return getGptSoVitsVoiceList();\n    }\n    if (provider === TTS_PROVIDER.EDGE_TTS_DIRECT) {\n        return getEdgeDirectVoiceList();\n    }\n    if (_lwbTtsCache) {\n        return _lwbTtsCache;\n    }\n    const topAny = getTopWindow();\n    const xbTts = topAny?.xiaobaixTts || window?.xiaobaixTts;\n    if (xbTts?.getConfig) {\n        const config = xbTts.getConfig();\n        const mySpeakers = config?.volc?.mySpeakers || [];\n        if (mySpeakers.length > 0) {\n            return mySpeakers.map((s) => ({\n                name: s.name,\n                value: s.value,\n                source: s.source || (isFreeVoice(s.value) ? 'free' : 'auth'),\n                resourceId: s.resourceId || inferResourceId(s.value),\n                desc: getVoiceDesc(s.value),\n            }));\n        }\n    }\n    const xbVoiceData = topAny?.XB_TTS_VOICE_DATA || window?.XB_TTS_VOICE_DATA;\n    if (Array.isArray(xbVoiceData) && xbVoiceData.length > 0) {\n        return xbVoiceData.slice(0, 20).map((v) => ({\n            name: v.name,\n            value: v.value,\n            source: inferSource(v.value),\n            resourceId: inferResourceId(v.value),\n            desc: v.scene || '',\n        }));\n    }\n    return getDefaultFreeVoices();\n}\nfunction isFreeVoice(value) {\n    const freeVoices = [\n        'female_1',\n        'female_2',\n        'female_3',\n        'female_4',\n        'female_5',\n        'female_6',\n        'female_7',\n        'male_1',\n        'male_2',\n        'male_3',\n        'male_4',\n    ];\n    return freeVoices.includes(value);\n}\nfunction inferSource(value) {\n    return isFreeVoice(value) ? 'free' : 'auth';\n}\nexport function inferResourceId(value) {\n    const lower = (value || '').toLowerCase();\n    if (lower.startsWith('icl_') || lower.startsWith('s_'))\n        return 'seed-icl-2.0';\n    if (lower.startsWith('saturn_') ||\n        lower.startsWith('uranus_') ||\n        lower.includes('_saturn_') ||\n        lower.includes('_uranus_')) {\n        return 'seed-tts-2.0';\n    }\n    return 'seed-tts-1.0';\n}\nfunction getVoiceDesc(value) {\n    const descMap = {\n        female_1: '()',\n        female_2: '()',\n        female_3: '()',\n        female_4: '()',\n        female_5: '()',\n        female_6: '()',\n        female_7: '()',\n        male_1: '()',\n        male_2: '()',\n        male_3: '()',\n        male_4: '()',\n    };\n    return descMap[value] || '';\n}\nfunction getDefaultFreeVoices() {\n    return [\n        { name: '', value: 'female_1', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'male_1', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'female_2', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'female_3', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'female_4', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'female_5', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'female_6', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'female_7', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'male_2', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'male_3', source: 'free', resourceId: null, desc: '()' },\n        { name: '', value: 'male_4', source: 'free', resourceId: null, desc: '()' },\n    ];\n}\nexport async function resolveVoiceByName(voiceName) {\n    if (!voiceName)\n        return null;\n    const voiceList = await getTTSVoiceListAsync();\n    let voice = voiceList.find(v => v.name === voiceName);\n    if (voice)\n        return voice;\n    voice = voiceList.find(v => v.value === voiceName);\n    if (voice)\n        return voice;\n    const provider = getTTSProvider();\n    const defaultVoice = provider === TTS_PROVIDER.GPT_SOVITS_V2\n        ? (pickFirstUsableGptSoVitsVoice(voiceList) || voiceList[0])\n        : provider === TTS_PROVIDER.EDGE_TTS_DIRECT\n            ? voiceList[0]\n            : voiceList[0];\n    if (defaultVoice) {\n        console.warn(`[${SCRIPT_NAME}]  \"${voiceName}\": ${defaultVoice.name}`);\n        return defaultVoice;\n    }\n    return null;\n}\n// TTS_VOICE_LIST getter \ntry {\n    Object.defineProperty(getTopWindow(), 'TTS_VOICE_LIST', {\n        get: getTTSVoiceList,\n        configurable: true,\n    });\n}\ncatch {\n    // ignore\n}\nexport function getTTSEnabled() {\n    try {\n        const saved = localStorage.getItem(getTtsEnabledKey());\n        if (saved === null)\n            return true;\n        return saved === 'true';\n    }\n    catch {\n        return true;\n    }\n}\nexport function setTTSEnabled(enabled) {\n    try {\n        localStorage.setItem(getTtsEnabledKey(), String(enabled));\n    }\n    catch (e) {\n        console.error(`[${SCRIPT_NAME}] TTS:`, e);\n    }\n}\nexport function getCharacterTTSVoice(characterId) {\n    try {\n        const map = JSON.parse(localStorage.getItem(getCharTtsVoiceKey()) || '{}');\n        return map[characterId] || null;\n    }\n    catch {\n        return null;\n    }\n}\nexport function setCharacterTTSVoice(characterId, voiceName) {\n    try {\n        const map = JSON.parse(localStorage.getItem(getCharTtsVoiceKey()) || '{}');\n        if (voiceName) {\n            map[characterId] = voiceName;\n        }\n        else {\n            delete map[characterId];\n        }\n        localStorage.setItem(getCharTtsVoiceKey(), JSON.stringify(map));\n    }\n    catch (e) {\n        console.error(`[${SCRIPT_NAME}] TTS:`, e);\n    }\n}\nexport function getAllCharacterTTSVoices() {\n    try {\n        return JSON.parse(localStorage.getItem(getCharTtsVoiceKey()) || '{}');\n    }\n    catch {\n        return {};\n    }\n}\n","let _db: IDBDatabase | null = null;\n\nexport function getDb(): IDBDatabase | null {\n  return _db;\n}\n\nexport function setDb(value: IDBDatabase | null): void {\n  _db = value;\n}\n","import {\n  DB_NAME,\n  DB_VERSION,\n  SCRIPT_NAME,\n  STORE_LIVE2D_MODELS,\n  STORE_SDK_CACHE,\n} from '../core/constants';\nimport { getDb, setDb } from '../core/state';\n\nfunction ensureLive2DStore(database: IDBDatabase, transaction: IDBTransaction | null): void {\n  if (!database.objectStoreNames.contains(STORE_LIVE2D_MODELS)) {\n    const store = database.createObjectStore(STORE_LIVE2D_MODELS, { keyPath: 'modelId' });\n    store.createIndex('uploadTime', 'uploadTime', { unique: false });\n    store.createIndex('runtimeType', 'runtimeType', { unique: false });\n    return;\n  }\n\n  if (!transaction) return;\n  try {\n    const store = transaction.objectStore(STORE_LIVE2D_MODELS);\n    if (!store.indexNames.contains('uploadTime')) {\n      store.createIndex('uploadTime', 'uploadTime', { unique: false });\n    }\n    if (!store.indexNames.contains('runtimeType')) {\n      store.createIndex('runtimeType', 'runtimeType', { unique: false });\n    }\n  } catch {\n    // ignore\n  }\n}\n\nfunction ensureSdkCacheStore(database: IDBDatabase): void {\n  if (database.objectStoreNames.contains(STORE_SDK_CACHE)) {\n    return;\n  }\n\n  database.createObjectStore(STORE_SDK_CACHE, { keyPath: 'id' });\n}\n\nexport function initDB(): Promise<IDBDatabase> {\n  const existing = getDb();\n  if (existing) return Promise.resolve(existing);\n\n  return new Promise((resolve, reject) => {\n    const request = indexedDB.open(DB_NAME, DB_VERSION);\n    request.onerror = () => reject(request.error ?? new Error('IndexedDB '));\n    request.onsuccess = () => {\n      const db = request.result;\n      setDb(db);\n      try {\n        db.onversionchange = () => {\n          try {\n            db.close();\n          } catch {\n            // ignore\n          }\n          setDb(null);\n        };\n      } catch {\n        // ignore\n      }\n      try {\n        console.log(`[${SCRIPT_NAME}] IndexedDB `);\n      } catch {\n        // ignore\n      }\n      resolve(db);\n    };\n    request.onupgradeneeded = (event) => {\n      const database = request.result;\n      const transaction = (event.target as IDBOpenDBRequest | null)?.transaction ?? null;\n      ensureLive2DStore(database, transaction);\n      ensureSdkCacheStore(database);\n    };\n  });\n}\n","import type { Live2DRuntimeType } from '../core/constants';\n\nexport const LIVE2D_RUNTIME_TYPES = Object.freeze({\n  LEGACY: 'legacy' as Live2DRuntimeType,\n  CUBISM5: 'cubism5' as Live2DRuntimeType,\n});\n\nconst RUNTIME_TYPE_SET = new Set<string>(Object.values(LIVE2D_RUNTIME_TYPES));\n\nfunction parseMajorVersion(value: unknown): number | null {\n  if (typeof value === 'number' && Number.isFinite(value)) {\n    return Math.floor(value);\n  }\n\n  if (typeof value !== 'string') return null;\n  const match = value.trim().match(/(\\d+)(?:\\.\\d+)?/);\n  if (!match) return null;\n  const major = Number.parseInt(match[1], 10);\n  return Number.isFinite(major) ? major : null;\n}\n\nexport function normalizeCubismVersion(value: unknown): number | null {\n  const major = parseMajorVersion(value);\n  if (major == null) return null;\n  if (major >= 5) return 5;\n  if (major >= 3) return 4;\n  if (major === 2) return 2;\n  return null;\n}\n\nexport function inferCubismVersionFromModelJson(modelJson: unknown, fallback: unknown = null): number | null {\n  if (!modelJson || typeof modelJson !== 'object') {\n    return normalizeCubismVersion(fallback);\n  }\n\n  const jsonRecord = modelJson as Record<string, any>;\n  const directCandidates = [\n    jsonRecord.Version,\n    jsonRecord.version,\n    jsonRecord.Meta?.Version,\n    jsonRecord.meta?.version,\n  ];\n\n  for (const candidate of directCandidates) {\n    const parsed = normalizeCubismVersion(candidate);\n    if (parsed != null) return parsed;\n  }\n\n  if (jsonRecord.FileReferences && typeof jsonRecord.FileReferences === 'object') {\n    return normalizeCubismVersion(fallback) ?? 4;\n  }\n\n  if (typeof jsonRecord.model === 'string' || typeof jsonRecord.Model === 'string') {\n    return normalizeCubismVersion(fallback) ?? 2;\n  }\n\n  return normalizeCubismVersion(fallback);\n}\n\nexport function normalizeLive2DRuntimeType(\n  value: unknown,\n  fallback: Live2DRuntimeType | '' = LIVE2D_RUNTIME_TYPES.LEGACY,\n): Live2DRuntimeType | '' {\n  const normalized = String(value || '').trim().toLowerCase();\n  if (RUNTIME_TYPE_SET.has(normalized)) {\n    return normalized as Live2DRuntimeType;\n  }\n  return fallback;\n}\n\nexport function resolveRuntimeTypeFromCubismVersion(cubismVersion: unknown): Live2DRuntimeType {\n  const normalized = normalizeCubismVersion(cubismVersion);\n  if (normalized != null && normalized >= 5) {\n    return LIVE2D_RUNTIME_TYPES.CUBISM5;\n  }\n  return LIVE2D_RUNTIME_TYPES.LEGACY;\n}\n\nexport function resolveLive2DRuntime(modelData: Record<string, any> | null = null): {\n  runtimeType: Live2DRuntimeType;\n  cubismVersion: number | null;\n} {\n  const input = modelData && typeof modelData === 'object' ? modelData : {};\n  const inferredVersion = inferCubismVersionFromModelJson(input.modelJson, input.cubismVersion);\n  const explicitRuntime = normalizeLive2DRuntimeType(input.runtimeType || '', '');\n  const runtimeType = explicitRuntime || resolveRuntimeTypeFromCubismVersion(inferredVersion);\n  const cubismVersion = inferredVersion ?? (runtimeType === LIVE2D_RUNTIME_TYPES.CUBISM5 ? 5 : null);\n\n  return {\n    runtimeType,\n    cubismVersion,\n  };\n}\n\nexport function withResolvedLive2DRuntime<T extends Record<string, any>>(modelData: T | null = null): T & {\n  runtimeType: Live2DRuntimeType;\n  cubismVersion: number | null;\n} {\n  const input = modelData && typeof modelData === 'object' ? modelData : ({} as T);\n  const resolved = resolveLive2DRuntime(input);\n  return {\n    ...input,\n    runtimeType: resolved.runtimeType,\n    cubismVersion: resolved.cubismVersion,\n  };\n}\n","import { LOCAL_LIVE2D_MODEL_SLOT_ID, SCRIPT_NAME, type Live2DRuntimeType, STORE_LIVE2D_MODELS } from '../core/constants';\nimport { getDb } from '../core/state';\nimport { initDB } from './init';\nimport { LIVE2D_RUNTIME_TYPES, normalizeLive2DRuntimeType } from '../live2d/runtime-router';\n\nexport type StoredLive2DTexture = {\n  name: string;\n  data: Blob;\n};\n\nexport type StoredLive2DMotion = {\n  name: string;\n  data: ArrayBuffer;\n};\n\nexport type StoredLive2DExpression = {\n  name: string;\n  file?: string;\n  data: ArrayBuffer;\n};\n\nexport type StoredLive2DModel = {\n  modelId: string;\n  source: 'local';\n  fileName: string;\n  modelJson: any;\n  runtimeType: Live2DRuntimeType;\n  cubismVersion: number | null;\n  moc3Version?: number | null;\n  moc3: ArrayBuffer | null;\n  moc: ArrayBuffer | null;\n  textures: StoredLive2DTexture[];\n  motions: Record<string, StoredLive2DMotion[]>;\n  expressions: StoredLive2DExpression[];\n  physics: ArrayBuffer | null;\n  pose: ArrayBuffer | null;\n  uploadTime: number;\n  fileSize: number;\n};\n\nfunction resolveSlotId(_modelId?: string): string {\n  return LOCAL_LIVE2D_MODEL_SLOT_ID;\n}\n\nfunction normalizeStoredModel(modelData: StoredLive2DModel): StoredLive2DModel {\n  const runtimeType = normalizeLive2DRuntimeType(modelData?.runtimeType, LIVE2D_RUNTIME_TYPES.LEGACY);\n  const cubismVersionRaw = Number(modelData?.cubismVersion);\n  const cubismVersion = Number.isFinite(cubismVersionRaw) ? cubismVersionRaw : null;\n  const uploadTimeRaw = Number(modelData?.uploadTime);\n  const uploadTime = Number.isFinite(uploadTimeRaw) && uploadTimeRaw > 0 ? uploadTimeRaw : Date.now();\n  const fileSizeRaw = Number(modelData?.fileSize);\n  const fileSize = Number.isFinite(fileSizeRaw) && fileSizeRaw >= 0 ? fileSizeRaw : 0;\n\n  return {\n    ...modelData,\n    modelId: resolveSlotId(modelData?.modelId),\n    source: 'local',\n    fileName: String(modelData?.fileName || '').trim() || 'uploaded-live2d.zip',\n    runtimeType,\n    cubismVersion,\n    uploadTime,\n    fileSize,\n    moc3: modelData?.moc3 ?? null,\n    moc: modelData?.moc ?? null,\n    physics: modelData?.physics ?? null,\n    pose: modelData?.pose ?? null,\n    textures: Array.isArray(modelData?.textures) ? modelData.textures : [],\n    motions: modelData?.motions && typeof modelData.motions === 'object' ? modelData.motions : {},\n    expressions: Array.isArray(modelData?.expressions) ? modelData.expressions : [],\n  };\n}\n\nasync function ensureDb(): Promise<IDBDatabase> {\n  if (!getDb()) {\n    await initDB();\n  }\n  const db = getDb();\n  if (!db) {\n    throw new Error('IndexedDB ');\n  }\n  return db;\n}\n\nexport async function saveLive2DModel(modelData: StoredLive2DModel): Promise<void> {\n  const db = await ensureDb();\n  const normalized = normalizeStoredModel(modelData);\n  return new Promise((resolve, reject) => {\n    try {\n      const transaction = db.transaction([STORE_LIVE2D_MODELS], 'readwrite');\n      const store = transaction.objectStore(STORE_LIVE2D_MODELS);\n      store.put(normalized);\n      transaction.oncomplete = () => {\n        try {\n          console.log(`[${SCRIPT_NAME}]  Live2D : ${normalized.fileName}`);\n        } catch {\n          // ignore\n        }\n        resolve();\n      };\n      transaction.onerror = () => reject(transaction.error ?? new Error(''));\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\n\nexport async function getLive2DModel(modelId?: string): Promise<StoredLive2DModel | null> {\n  const db = await ensureDb();\n  const slotId = resolveSlotId(modelId);\n  return new Promise((resolve) => {\n    try {\n      if (!db.objectStoreNames.contains(STORE_LIVE2D_MODELS)) {\n        resolve(null);\n        return;\n      }\n      const transaction = db.transaction([STORE_LIVE2D_MODELS], 'readonly');\n      const store = transaction.objectStore(STORE_LIVE2D_MODELS);\n      const request = store.get(slotId);\n      request.onsuccess = () => {\n        const result = request.result as StoredLive2DModel | undefined;\n        resolve(result ?? null);\n      };\n      request.onerror = () => resolve(null);\n    } catch {\n      resolve(null);\n    }\n  });\n}\n\nexport async function deleteLive2DModel(modelId?: string): Promise<void> {\n  const db = await ensureDb();\n  const slotId = resolveSlotId(modelId);\n  return new Promise((resolve, reject) => {\n    try {\n      if (!db.objectStoreNames.contains(STORE_LIVE2D_MODELS)) {\n        resolve();\n        return;\n      }\n      const transaction = db.transaction([STORE_LIVE2D_MODELS], 'readwrite');\n      const store = transaction.objectStore(STORE_LIVE2D_MODELS);\n      store.delete(slotId);\n      transaction.oncomplete = () => {\n        try {\n          console.log(`[${SCRIPT_NAME}]  Live2D : ${slotId}`);\n        } catch {\n          // ignore\n        }\n        resolve();\n      };\n      transaction.onerror = () => reject(transaction.error ?? new Error(''));\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\n\nexport async function hasLive2DModel(modelId?: string): Promise<boolean> {\n  const model = await getLive2DModel(modelId);\n  return !!(model && model.modelJson);\n}\n","import { SCRIPT_NAME, DB_NAME, DB_VERSION, STORE_SDK_CACHE, type Live2DRuntimeType } from '../core/constants';\r\n\r\ntype Live2DRuntime = {\r\n  pixi: any;\r\n  live2dModel: any;\r\n  pixiVersion: string;\r\n  loadedAt: number;\r\n  runtimeType: Live2DRuntimeType;\r\n};\n\n// ============================================\n// Live2D SDK ?\n// ============================================\nexport const Live2DLoader = {\n  PIXI_URL: 'https://cdn.jsdelivr.net/npm/pixi.js@6.5.10/dist/browser/pixi.min.js',\n  CUBISM4_CORE_URL: 'https://cdn.jsdelivr.net/npm/live2dcubismcore@1.0.2/live2dcubismcore.min.js',\n  CUBISM4_CORE_FALLBACK_URLS: Object.freeze([\n    'https://gcore.jsdelivr.net/npm/live2dcubismcore@1.0.2/live2dcubismcore.min.js',\n    'https://unpkg.com/live2dcubismcore@1.0.2/live2dcubismcore.min.js',\n    'https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js',\n  ]),\n  CUBISM5_CORE_URL: 'https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js',\n  CUBISM5_CORE_FALLBACK_URLS: Object.freeze([\n    'https://cdn.jsdelivr.net/gh/bigmalove/galgame@main/dist/live2dcubismcore.min.js',\n    'https://gcore.jsdelivr.net/gh/bigmalove/galgame@main/dist/live2dcubismcore.min.js',\n  ]),\n  CUBISM2_CORE_URL: 'https://cdn.jsdelivr.net/gh/dylanNew/live2d/webgl/Live2D/lib/live2d.min.js',\n  SDK_URL: 'https://cdn.jsdelivr.net/npm/pixi-live2d-display/dist/index.min.js',\n  CUBISM5_RUNTIME_URL: 'https://cdn.jsdelivr.net/gh/bigmalove/galgame@main/dist/cubism5.runtime.min.js',\n  CUBISM5_RUNTIME_FALLBACK_URLS: Object.freeze([\n    'https://gcore.jsdelivr.net/gh/bigmalove/galgame@main/dist/cubism5.runtime.min.js',\n    'https://cdn.jsdelivr.net/gh/bigmalove/galgame@main/dist/cubism5.js',\n    'https://gcore.jsdelivr.net/gh/bigmalove/galgame@main/dist/cubism5.js',\n  ]),\n  SDK_CACHE_KEY: 'live2d_sdk_v3',\r\n  _READY_MARK: '__desktopPetLive2dLoaderReady_v3',\r\n  _RUNTIME_KEY: '__desktopPetLive2dRuntime_v3',\n\n  isLoaded: false,\n  loadPromise: null,\n  legacyCoreLoaded: false,\n  legacyCorePromise: null,\n  legacyCoreSource: null,\n  cubism5CoreLoaded: false,\n  cubism5CorePromise: null,\n  cubism5CoreSource: null,\n  cubism5RuntimeLoaded: false,\n  cubism5RuntimePromise: null,\n  cubism5RuntimeSource: null,\n  legacyLive2DNamespace: null,\n  cubism5Live2DNamespace: null,\n  patchedResolveUrlPrototypes: new WeakSet(),\n  patchedXhrLoaderNamespaces: new WeakSet(),\n  pixiUrlResolvePatched: false,\n  pixiUrlResolveOriginal: null,\n  legacyCoreObject: null,\n  cubism5CoreObject: null,\n  activeCoreType: null,\n  loadedScriptUrls: new Set(),\n\n  _getUrlBase(url) {\n    try {\n      const resolved = new URL(url, window.location.href);\n      resolved.hash = '';\n      resolved.search = '';\n      const text = resolved.toString();\n      const slashIndex = text.lastIndexOf('/');\n      return slashIndex >= 0 ? text.slice(0, slashIndex + 1) : text;\n    } catch (e) {\n      const value = this._normalizeRuntimeUrl(url);\n      const slashIndex = value.lastIndexOf('/');\n      return slashIndex >= 0 ? value.slice(0, slashIndex + 1) : value;\n    }\n  },\n\n  _ensureCubismCoreLocateFile(_topWindow, coreUrl) {\n    if (!_topWindow) return;\n    const baseUrl = this._getUrlBase(coreUrl);\n    if (!baseUrl) return;\n\n    const existing = _topWindow.Live2DCubismCore;\n    if (existing && typeof existing === 'object') {\n      if (typeof existing.locateFile !== 'function') {\n        existing.locateFile = (path) => `${baseUrl}${path}`;\n      }\n      return;\n    }\n\n    _topWindow.Live2DCubismCore = {\n      locateFile: (path) => `${baseUrl}${path}`,\n    };\n  },\n\n  _loadScriptSrc(url, timeoutMs = 12000) {\n    return new Promise((resolve, reject) => {\n      if (!url) {\n        reject(new Error('Script URL is empty'));\n        return;\n      }\n\n      if (this.loadedScriptUrls.has(url)) {\n        resolve(true);\n        return;\n      }\n\n      const _topWindow = typeof window.parent !== 'undefined' ? window.parent : window;\n      const doc = _topWindow?.document || document;\n      const script = doc.createElement('script');\n      let done = false;\n\n      const finish = (ok, err) => {\n        if (done) return;\n        done = true;\n        if (ok) {\n          this.loadedScriptUrls.add(url);\n          resolve(true);\n        } else {\n          reject(err || new Error(`Script load failed: ${url}`));\n        }\n      };\n\n      const timer = setTimeout(() => {\n        finish(false, new Error(`Script load timeout: ${url}`));\n      }, timeoutMs);\n\n      script.async = true;\n      script.src = url;\n      script.crossOrigin = 'anonymous';\n      script.onload = () => {\n        clearTimeout(timer);\n        finish(true);\n      };\n      script.onerror = () => {\n        clearTimeout(timer);\n        finish(false, new Error(`Script load failed: ${url}`));\n      };\n      doc.head.appendChild(script);\n    });\n  },\n\n  async load() {\n    const _topWindow = typeof window.parent !== 'undefined' ? window.parent : window;\n\n    if (this.isLoaded) {\n      const runtime = this._getRuntime(_topWindow);\n      if (runtime) return true;\n      this.isLoaded = false;\n      this.loadPromise = null;\n    }\n\n    const existingRuntime = this.getRuntime(_topWindow);\n    if (existingRuntime) {\n      this.isLoaded = true;\n      _topWindow[this._READY_MARK] = true;\n      return true;\n    }\n\n    if (this.loadPromise) return this.loadPromise;\n\n    this.loadPromise = this._doLoad();\n    return this.loadPromise;\n  },\n\n  getRuntime(targetWindow) {\n    const _topWindow = targetWindow ?? (typeof window.parent !== 'undefined' ? window.parent : window);\n    const runtime = this._getRuntime(_topWindow);\n    if (runtime) return runtime;\n    return this._setRuntime(_topWindow, this._detectActiveRuntimeType(_topWindow));\n  },\n\n  getPixi(targetWindow) {\n    return this.getRuntime(targetWindow)?.pixi ?? null;\n  },\n\n  _detectActiveRuntimeType(_topWindow) {\n    const activeNamespace = _topWindow?.PIXI?.live2d;\n    if (\n      this.cubism5Live2DNamespace &&\n      activeNamespace &&\n      activeNamespace === this.cubism5Live2DNamespace &&\n      !!activeNamespace.Live2DModel\n    ) {\n      return 'cubism5';\n    }\n    return 'legacy';\n  },\n\n  _getRuntime(_topWindow) {\n    const runtime = _topWindow?.[this._RUNTIME_KEY];\n    if (!runtime || typeof runtime !== 'object') return null;\n\n    const pixi = runtime.pixi;\n    const live2dModel = runtime.live2dModel;\n    if (!pixi || !live2dModel) return null;\n\n    if (_topWindow?.PIXI !== pixi) return null;\n    if (_topWindow?.PIXI?.live2d?.Live2DModel !== live2dModel) return null;\n\n    return runtime;\n  },\n\n  _setRuntime(_topWindow, runtimeType = 'legacy') {\n    const pixi = _topWindow?.PIXI;\n    const live2dNamespace = this.getRuntimeNamespace(runtimeType) || pixi?.live2d;\n    const live2dModel = live2dNamespace?.Live2DModel;\n    if (!pixi || !live2dModel) return null;\n\n    const runtime = {\n      pixi,\n      live2dModel,\n      pixiVersion: String(pixi?.VERSION || 'unknown'),\n      loadedAt: Date.now(),\n      runtimeType,\n    };\n    _topWindow[this._RUNTIME_KEY] = runtime;\n    return runtime;\n  },\n\n  _getLatestMocVersion(_topWindow) {\n    try {\n      return Number(_topWindow?.Live2DCubismCore?.Version?.csmGetLatestMocVersion?.() || 0) || 0;\n    } catch (e) {\n      return 0;\n    }\n  },\n\n  async _waitForLatestMocVersion(_topWindow, expectedMajor = 5, timeoutMs = 4000, intervalMs = 50) {\n    const startedAt = Date.now();\n    while (Date.now() - startedAt < timeoutMs) {\n      const latestVersion = this._getLatestMocVersion(_topWindow);\n      if (latestVersion >= expectedMajor) return latestVersion;\n      await new Promise(r => setTimeout(r, intervalMs));\n    }\n    return this._getLatestMocVersion(_topWindow);\n  },\n\n  _isLegacyMocVersion(latestMocVersion) {\n    const value = Number(latestMocVersion || 0) || 0;\n    return value > 0 && value <= 4;\n  },\n\n  _isCubism5MocVersion(latestMocVersion, requiredVersion = 5) {\n    const value = Number(latestMocVersion || 0) || 0;\n    const required = Math.max(5, Number(requiredVersion || 0) || 0);\n    return value >= required;\n  },\n\n  _setGlobalCubismCore(_topWindow, coreObject) {\n    if (!_topWindow) return;\n    if (coreObject) {\n      _topWindow.Live2DCubismCore = coreObject;\n      return;\n    }\n    try {\n      delete _topWindow.Live2DCubismCore;\n    } catch (e) {\n      _topWindow.Live2DCubismCore = undefined;\n    }\n  },\n\n  async ensureLegacyCore() {\n    const _topWindow = typeof window.parent !== 'undefined' ? window.parent : window;\n    const latestVersion = this._getLatestMocVersion(_topWindow);\n    if (this._isLegacyMocVersion(latestVersion)) {\n      this.legacyCoreLoaded = true;\n      this.cubism5CoreLoaded = false;\n      this.activeCoreType = 'legacy';\n      this.legacyCoreObject = _topWindow.Live2DCubismCore || this.legacyCoreObject;\n      if (!this.legacyCoreSource) {\n        this.legacyCoreSource = 'window.Live2DCubismCore(existing)';\n      }\n      return true;\n    }\n\n    if (this._isLegacyMocVersion(this._getLatestMocVersion({ Live2DCubismCore: this.legacyCoreObject }))) {\n      this._setGlobalCubismCore(_topWindow, this.legacyCoreObject);\n      if (this._isLegacyMocVersion(this._getLatestMocVersion(_topWindow))) {\n        this.legacyCoreLoaded = true;\n        this.cubism5CoreLoaded = false;\n        this.activeCoreType = 'legacy';\n        if (!this.legacyCoreSource) {\n          this.legacyCoreSource = 'window.Live2DCubismCore(snapshot)';\n        }\n        return true;\n      }\n    }\n\n    if (this.legacyCorePromise) return this.legacyCorePromise;\n\n    this.legacyCorePromise = (async () => {\n      const previousCore = _topWindow.Live2DCubismCore;\n      const coreUrls = this._getCubism4CoreUrls();\n      if (!coreUrls.length) {\n        console.error(`[${SCRIPT_NAME}] Cubism 4 Core load failed: no core URL candidates`);\n        this.legacyCorePromise = null;\n        return false;\n      }\n\n      let lastError = null;\n      try {\n        for (const coreUrl of coreUrls) {\n          try {\n            const coreText = await fetch(coreUrl).then(r => {\n              if (!r.ok) throw new Error(`Cubism 4 Core load failed: ${r.status}`);\n              return r.text();\n            });\n            this._setGlobalCubismCore(_topWindow, null);\n            await this._executeScript(coreText, _topWindow);\n\n            const startedAt = Date.now();\n            let loadedVersion = this._getLatestMocVersion(_topWindow);\n            while (Date.now() - startedAt < 5000 && !this._isLegacyMocVersion(loadedVersion)) {\n              await new Promise(r => setTimeout(r, 80));\n              loadedVersion = this._getLatestMocVersion(_topWindow);\n            }\n\n            if (!this._isLegacyMocVersion(loadedVersion)) {\n              throw new Error(`latest moc version check failed: ${loadedVersion}`);\n            }\n\n            this.legacyCoreLoaded = true;\n            this.legacyCoreObject = _topWindow.Live2DCubismCore || this.legacyCoreObject;\n            this.legacyCoreSource = coreUrl;\n            this.cubism5CoreLoaded = false;\n            this.activeCoreType = 'legacy';\n            console.log(`[${SCRIPT_NAME}] Cubism 4 Core loaded from ${coreUrl}`);\n            return true;\n          } catch (candidateError) {\n            this._setGlobalCubismCore(_topWindow, previousCore);\n            lastError = candidateError;\n            console.warn(`[${SCRIPT_NAME}] Cubism 4 Core candidate failed: ${coreUrl}`, candidateError);\n          }\n        }\n\n        this._setGlobalCubismCore(_topWindow, previousCore);\n        if (this._isLegacyMocVersion(this._getLatestMocVersion(_topWindow))) {\n          this.legacyCoreLoaded = true;\n          this.cubism5CoreLoaded = false;\n          this.activeCoreType = 'legacy';\n          this.legacyCoreObject = _topWindow.Live2DCubismCore || this.legacyCoreObject;\n          if (!this.legacyCoreSource) {\n            this.legacyCoreSource = 'window.Live2DCubismCore(existing)';\n          }\n          console.warn(`[${SCRIPT_NAME}] Cubism 4 Core candidates failed; fallback to existing core`);\n          return true;\n        }\n\n        console.warn(`[${SCRIPT_NAME}] Cubism 4 Core load failed: all candidates failed`, {\n          candidates: coreUrls,\n          lastError: String(lastError?.message || lastError || ''),\n        });\n        if (lastError) {\n          this._setGlobalCubismCore(_topWindow, previousCore);\n          throw lastError;\n        }\n        return false;\n      } catch (e) {\n        this._setGlobalCubismCore(_topWindow, previousCore);\n        console.error(`[${SCRIPT_NAME}] Cubism 4 Core load failed:`, e);\n        return false;\n      } finally {\n        this.legacyCorePromise = null;\n      }\n    })();\n\n    return this.legacyCorePromise;\n  },\n\n  async ensureCubism5Core(requiredLatestVersion = 5) {\n    const _topWindow = typeof window.parent !== 'undefined' ? window.parent : window;\n\n    const requiredVersion = Math.max(5, Number(requiredLatestVersion || 0) || 0);\n    const latestVersion = this._getLatestMocVersion(_topWindow);\n    const existingIsCubism5 = latestVersion >= requiredVersion;\n    const hasPinnedCubism5Source =\n      typeof this.cubism5CoreSource === 'string' &&\n      /^https?:/i.test(this.cubism5CoreSource);\n    if (existingIsCubism5 && hasPinnedCubism5Source) {\n      this.cubism5CoreLoaded = true;\n      this.legacyCoreLoaded = false;\n      this.activeCoreType = 'cubism5';\n      this.cubism5CoreObject = _topWindow.Live2DCubismCore || this.cubism5CoreObject;\n      return true;\n    }\n\n    if (existingIsCubism5 && !hasPinnedCubism5Source) {\n      this.cubism5CoreObject = _topWindow.Live2DCubismCore || this.cubism5CoreObject;\n      console.warn(\n        `[${SCRIPT_NAME}] Existing Cubism Core detected without pinned source, will try configured Cubism 5 core URL candidates`,\n      );\n    }\n\n    if (this._isCubism5MocVersion(this._getLatestMocVersion({ Live2DCubismCore: this.cubism5CoreObject }), requiredVersion)) {\n      this._setGlobalCubismCore(_topWindow, this.cubism5CoreObject);\n      if (this._isCubism5MocVersion(this._getLatestMocVersion(_topWindow), requiredVersion)) {\n        this.cubism5CoreLoaded = true;\n        this.legacyCoreLoaded = false;\n        this.activeCoreType = 'cubism5';\n        if (!this.cubism5CoreSource) {\n          this.cubism5CoreSource = 'window.Live2DCubismCore(snapshot)';\n        }\n        return true;\n      }\n    }\n    if (this.cubism5CorePromise) return this.cubism5CorePromise;\n\n    this.cubism5CorePromise = (async () => {\n      const coreUrls = this._getCubism5CoreUrls(_topWindow);\n      if (!coreUrls.length) {\n        console.error(`[${SCRIPT_NAME}] Cubism 5 Core load failed: no core URL candidates`);\n        this.cubism5CorePromise = null;\n        return false;\n      }\n\n      let lastError = null;\n      const previousCore = _topWindow.Live2DCubismCore;\n      try {\n        for (const coreUrl of coreUrls) {\n          try {\n            this._setGlobalCubismCore(_topWindow, null);\n            this._ensureCubismCoreLocateFile(_topWindow, coreUrl);\n            await this._loadScriptSrc(coreUrl);\n\n            const loadedVersion = await this._waitForLatestMocVersion(_topWindow, requiredVersion, 8000, 80);\n            if (loadedVersion >= requiredVersion) {\n              this.cubism5CoreLoaded = true;\n              this.legacyCoreLoaded = false;\n              this.activeCoreType = 'cubism5';\n              this.cubism5CoreObject = _topWindow.Live2DCubismCore || this.cubism5CoreObject;\n              this.cubism5CoreSource = coreUrl;\n              console.log(`[${SCRIPT_NAME}] Cubism 5 Core loaded from ${coreUrl}`);\n              return true;\n            }\n\n            throw new Error(`latest moc version check failed: ${loadedVersion} (required >= ${requiredVersion})`);\n          } catch (candidateError) {\n            this._setGlobalCubismCore(_topWindow, previousCore);\n            lastError = candidateError;\n            console.warn(`[${SCRIPT_NAME}] Cubism 5 Core candidate failed: ${coreUrl}`, candidateError);\n          }\n        }\n\n        this._setGlobalCubismCore(_topWindow, previousCore);\n        if (this._isCubism5MocVersion(this._getLatestMocVersion(_topWindow), requiredVersion)) {\n          this.cubism5CoreLoaded = true;\n          this.legacyCoreLoaded = false;\n          this.activeCoreType = 'cubism5';\n          this.cubism5CoreObject = _topWindow.Live2DCubismCore || this.cubism5CoreObject;\n          if (!this.cubism5CoreSource) {\n            this.cubism5CoreSource = 'window.Live2DCubismCore(existing)';\n          }\n          console.warn(`[${SCRIPT_NAME}] Cubism 5 Core candidates failed; fallback to existing core`);\n          return true;\n        }\n        this.cubism5CoreLoaded = false;\n        this.cubism5CoreSource = null;\n        console.error(`[${SCRIPT_NAME}] Cubism 5 Core load failed: all candidates failed`, {\n          candidates: coreUrls,\n          lastError: String(lastError?.message || lastError || ''),\n        });\n        return false;\n      } finally {\n        this.cubism5CorePromise = null;\n      }\n    })();\n\n    return this.cubism5CorePromise;\n  },\n\n  _normalizeRuntimeUrl(url) {\n    if (typeof url !== 'string') return '';\n    return url.trim();\n  },\n\n  _isDirectResourceUrl(url) {\n    const value = this._normalizeRuntimeUrl(url);\n    if (!value) return false;\n    if (value.startsWith('//')) return true;\n    return /^(?:blob|data|https?|file|stscript|chrome-extension|moz-extension|capacitor|app):/i.test(value);\n  },\n\n  _patchPixiUrlResolve(_topWindow) {\n    if (this.pixiUrlResolvePatched) return true;\n    const utils = _topWindow?.PIXI?.utils;\n    const urlApi = utils?.url;\n    const originalResolve = urlApi?.resolve;\n    if (typeof originalResolve !== 'function') return false;\n\n    const loaderRef = this;\n    this.pixiUrlResolveOriginal = originalResolve;\n    urlApi.resolve = function patchedPixiUrlResolve(baseUrl, resourcePath) {\n      if (loaderRef._isDirectResourceUrl(resourcePath)) {\n        return loaderRef._normalizeRuntimeUrl(resourcePath);\n      }\n      return originalResolve.call(this, baseUrl, resourcePath);\n    };\n\n    this.pixiUrlResolvePatched = true;\n    console.log(`[${SCRIPT_NAME}] Patched PIXI.utils.url.resolve`);\n    return true;\n  },\n\n  _patchModelSettingsResolveURL(runtimeNamespace, runtimeLabel = 'unknown') {\n    if (!runtimeNamespace || typeof runtimeNamespace !== 'object') return 0;\n\n    const candidates = [\n      'ModelSettings',\n      'Cubism2ModelSettings',\n      'Cubism4ModelSettings',\n      'Cubism5ModelSettings',\n    ];\n    let patchedCount = 0;\n\n    for (const ctorName of candidates) {\n      const proto = runtimeNamespace?.[ctorName]?.prototype;\n      if (!proto || typeof proto.resolveURL !== 'function') continue;\n      if (this.patchedResolveUrlPrototypes.has(proto) || proto.__galgameResolveUrlPatched) continue;\n\n      const originalResolveURL = proto.resolveURL;\n      const loaderRef = this;\n      proto.resolveURL = function patchedResolveURL(resourcePath) {\n        if (loaderRef._isDirectResourceUrl(resourcePath)) {\n          return loaderRef._normalizeRuntimeUrl(resourcePath);\n        }\n        return originalResolveURL.call(this, resourcePath);\n      };\n\n      try {\n        proto.__galgameResolveUrlPatched = true;\n      } catch (e) {}\n      this.patchedResolveUrlPrototypes.add(proto);\n      patchedCount++;\n      console.log(`[${SCRIPT_NAME}] Patched ModelSettings.resolveURL (${runtimeLabel}:${ctorName})`);\n    }\n\n    return patchedCount;\n  },\n\n  _patchXhrLoader(runtimeNamespace, runtimeLabel = 'unknown') {\n    if (!runtimeNamespace || typeof runtimeNamespace !== 'object') return false;\n    if (this.patchedXhrLoaderNamespaces.has(runtimeNamespace)) return true;\n\n    const XHRLoader = runtimeNamespace.XHRLoader;\n    const originalLoader = XHRLoader?.loader;\n    if (typeof originalLoader !== 'function') {\n      console.warn(`[${SCRIPT_NAME}] XHRLoader.loader missing (${runtimeLabel})`, {\n        hasNamespace: !!runtimeNamespace,\n        hasXHRLoader: !!XHRLoader,\n        loaderType: typeof originalLoader,\n      });\n      return false;\n    }\n\n    const loaderRef = this;\n    XHRLoader.loader = (context) => {\n      const rawUrl = context?.settings ? context.settings.resolveURL(context.url) : context?.url;\n      const requestUrl = loaderRef._normalizeRuntimeUrl(rawUrl);\n      if (!loaderRef._isDirectResourceUrl(requestUrl)) {\n        return originalLoader(context);\n      }\n\n      const requestType = String(context?.type || '').toLowerCase();\n      return fetch(requestUrl)\n        .then((response) => {\n          if (!response.ok) {\n            throw new Error(`Fetch failed (${response.status}) for ${requestUrl}`);\n          }\n          if (requestType === 'json') return response.json();\n          if (requestType === 'text') return response.text();\n          return response.arrayBuffer();\n        })\n        .then((payload) => {\n          if (requestType !== 'json' && requestType !== 'text' && payload instanceof ArrayBuffer) {\n            const header = new Uint8Array(payload, 0, Math.min(4, payload.byteLength));\n            const signature = String.fromCharCode(...header);\n            console.log(`[${SCRIPT_NAME}] XHRLoader patched fetch arraybuffer`, {\n              url: requestUrl.slice(0, 128),\n              byteLength: payload.byteLength,\n              signature,\n            });\n          }\n          context.result = payload;\n        });\n    };\n\n    this.patchedXhrLoaderNamespaces.add(runtimeNamespace);\n    console.log(`[${SCRIPT_NAME}] Patched XHRLoader.loader (${runtimeLabel})`);\n    return true;\n  },\n\n  _getCubism5RuntimeUrls() {\n    const urls = [];\n    const seen = new Set();\n    const pushUrl = (value) => {\n      const normalized = this._normalizeRuntimeUrl(value);\n      if (!normalized || seen.has(normalized)) return;\n      seen.add(normalized);\n      urls.push(normalized);\n    };\n\n    pushUrl(this.CUBISM5_RUNTIME_URL);\n    for (const fallbackUrl of this.CUBISM5_RUNTIME_FALLBACK_URLS) {\n      pushUrl(fallbackUrl);\n    }\n\n    return urls;\n  },\n\n  _getCubism5CoreUrls() {\n    const urls = [];\n    const seen = new Set();\n    const pushUrl = (value) => {\n      const normalized = this._normalizeRuntimeUrl(value);\n      if (!normalized || seen.has(normalized)) return;\n      seen.add(normalized);\n      urls.push(normalized);\n    };\n\n    pushUrl(this.CUBISM5_CORE_URL);\n    for (const fallbackUrl of this.CUBISM5_CORE_FALLBACK_URLS) {\n      pushUrl(fallbackUrl);\n    }\n\n    return urls;\n  },\n\n  _getCubism4CoreUrls() {\n    const urls = [];\n    const seen = new Set();\n    const pushUrl = (value) => {\n      const normalized = this._normalizeRuntimeUrl(value);\n      if (!normalized || seen.has(normalized)) return;\n      seen.add(normalized);\n      urls.push(normalized);\n    };\n\n    pushUrl(this.CUBISM4_CORE_URL);\n    for (const fallbackUrl of this.CUBISM4_CORE_FALLBACK_URLS) {\n      pushUrl(fallbackUrl);\n    }\n    return urls;\n  },\n\n  async ensureCubism5Runtime() {\n    if (this.cubism5RuntimeLoaded && this.cubism5Live2DNamespace?.Live2DModel) {\n      if (!this.cubism5RuntimeSource) {\n        this.cubism5RuntimeSource = 'window.PIXI.live2d(existing)';\n      }\n      return true;\n    }\n    if (this.cubism5RuntimePromise) return this.cubism5RuntimePromise;\n\n    this.cubism5RuntimePromise = (async () => {\n      const _topWindow = typeof window.parent !== 'undefined' ? window.parent : window;\n\n      if (!this.isLoaded) {\n        const loaded = await this.load();\n        if (!loaded) return false;\n      }\n\n      const coreReady = await this.ensureCubism5Core();\n      if (!coreReady) {\n        console.error(`[${SCRIPT_NAME}] Cubism 5 runtime load aborted: core unavailable`);\n        return false;\n      }\n\n      try {\n        const runtimeUrls = this._getCubism5RuntimeUrls();\n        if (!runtimeUrls.length) {\n          console.error(`[${SCRIPT_NAME}] Cubism 5 runtime load failed: no runtime URL candidates`);\n          return false;\n        }\n\n        let lastError = null;\n        for (const runtimeUrl of runtimeUrls) {\n          try {\n            const runtimeText = await fetch(runtimeUrl).then(r => {\n              if (!r.ok) throw new Error(`Cubism 5 runtime load failed: ${r.status}`);\n              return r.text();\n            });\n            await this._executeScript(runtimeText, _topWindow);\n            await new Promise(r => setTimeout(r, 100));\n\n            const runtimeNamespace = _topWindow?.PIXI?.live2d;\n            if (!runtimeNamespace?.Live2DModel) {\n              throw new Error('Live2DModel is unavailable after Cubism 5 runtime script execution');\n            }\n\n            this._patchModelSettingsResolveURL(runtimeNamespace, 'cubism5');\n            this._patchXhrLoader(runtimeNamespace, 'cubism5');\n\n            this.cubism5Live2DNamespace = runtimeNamespace;\n            this.cubism5RuntimeLoaded = true;\n            this.cubism5RuntimeSource = runtimeUrl;\n\n            if (this.legacyLive2DNamespace?.Live2DModel) {\n              _topWindow.PIXI.live2d = this.legacyLive2DNamespace;\n            }\n            console.log(`[${SCRIPT_NAME}] Cubism 5 runtime loaded from ${runtimeUrl}`);\n            return true;\n          } catch (candidateError) {\n            lastError = candidateError;\n            console.warn(`[${SCRIPT_NAME}] Cubism 5 runtime candidate failed: ${runtimeUrl}`, candidateError);\n          }\n        }\n\n        console.error(`[${SCRIPT_NAME}] Cubism 5 runtime load failed: all candidates failed`, {\n          candidates: runtimeUrls,\n          lastError: String(lastError?.message || lastError || ''),\n        });\n        return false;\n      } catch (e) {\n        console.error(`[${SCRIPT_NAME}] Cubism 5 runtime load failed:`, e);\n        return false;\n      } finally {\n        this.cubism5RuntimePromise = null;\n      }\n    })();\n\n    return this.cubism5RuntimePromise;\n  },\n\n  getRuntimeNamespace(runtimeType = 'legacy') {\n    if (runtimeType === 'cubism5' && this.cubism5Live2DNamespace?.Live2DModel) {\n      return this.cubism5Live2DNamespace;\n    }\n    if (this.legacyLive2DNamespace?.Live2DModel) return this.legacyLive2DNamespace;\n\n    const _topWindow = typeof window.parent !== 'undefined' ? window.parent : window;\n    return _topWindow?.PIXI?.live2d || null;\n  },\n\n  activateRuntime(runtimeType = 'legacy') {\n    const _topWindow = typeof window.parent !== 'undefined' ? window.parent : window;\n    if (!_topWindow?.PIXI) return false;\n\n    const target = this.getRuntimeNamespace(runtimeType);\n    if (!target?.Live2DModel) return false;\n\n    _topWindow.PIXI.live2d = target;\n    this._setRuntime(_topWindow, runtimeType);\n    return true;\n  },\n\n  async _doLoad() {\n    const _topWindow = typeof window.parent !== 'undefined' ? window.parent : window;\n\n    try {\n      if (_topWindow.PIXI?.live2d?.Live2DModel) {\n        console.log(`[${SCRIPT_NAME}] Live2D SDK already available`);\n        this._patchPixiUrlResolve(_topWindow);\n        this.legacyLive2DNamespace = _topWindow.PIXI.live2d;\n        this._patchModelSettingsResolveURL(this.legacyLive2DNamespace, 'legacy-existing');\n        this._patchXhrLoader(this.legacyLive2DNamespace, 'legacy-existing');\n        this.activateRuntime('legacy');\n        _topWindow[this._READY_MARK] = true;\n        this.isLoaded = true;\n        this.loadPromise = null;\n        return true;\n      }\n\n      if (!_topWindow.PIXI) {\n        console.log(`[${SCRIPT_NAME}]  PIXI.js...`);\n        const pixiText = await fetch(this.PIXI_URL).then(r => {\n          if (!r.ok) throw new Error(`PIXI.js : ${r.status}`);\n          return r.text();\n        });\n        await this._executeScript(pixiText, _topWindow);\n        console.log(`[${SCRIPT_NAME}] PIXI.js `);\n      }\n\n      if (!_topWindow.window.PIXI) {\n        _topWindow.window.PIXI = _topWindow.PIXI;\n      }\n\n      this._patchPixiUrlResolve(_topWindow);\n\n      if (!_topWindow.Live2DCubismCore) {\n        console.log(`[${SCRIPT_NAME}]  Cubism 4 Core...`);\n        try {\n          const coreText = await fetch(this.CUBISM4_CORE_URL).then(r => {\n            if (!r.ok) throw new Error(`Cubism 4 Core : ${r.status}`);\n            return r.text();\n          });\n          await this._executeScript(coreText, _topWindow);\n          this.legacyCoreLoaded = true;\n          this.legacyCoreSource = this.CUBISM4_CORE_URL;\n          this.legacyCoreObject = _topWindow.Live2DCubismCore || this.legacyCoreObject;\n          this.activeCoreType = 'legacy';\n          console.log(`[${SCRIPT_NAME}] Cubism 4 Core `);\n        } catch (e) {\n          console.warn(`[${SCRIPT_NAME}] Cubism 4 Core ...`, e);\n        }\n      } else {\n        const latestMocVersion = this._getLatestMocVersion(_topWindow);\n        if (latestMocVersion >= 5) {\n          this.cubism5CoreLoaded = true;\n          this.cubism5CoreSource = this.cubism5CoreSource || 'window.Live2DCubismCore(existing)';\n          this.cubism5CoreObject = _topWindow.Live2DCubismCore || this.cubism5CoreObject;\n          this.activeCoreType = 'cubism5';\n        } else if (this._isLegacyMocVersion(latestMocVersion)) {\n          this.legacyCoreLoaded = true;\n          this.legacyCoreSource = this.legacyCoreSource || 'window.Live2DCubismCore(existing)';\n          this.legacyCoreObject = _topWindow.Live2DCubismCore || this.legacyCoreObject;\n          this.activeCoreType = 'legacy';\n        }\n      }\n\n      if (!_topWindow.Live2D) {\n        console.log(`[${SCRIPT_NAME}]  Cubism 2.1 Core...`);\n        try {\n          const core2Text = await fetch(this.CUBISM2_CORE_URL).then(r => {\n            if (!r.ok) throw new Error(`Cubism 2.1 Core : ${r.status}`);\n            return r.text();\n          });\n          await this._executeScript(core2Text, _topWindow);\n          console.log(`[${SCRIPT_NAME}] Cubism 2.1 Core `);\n        } catch (e) {\n          console.warn(`[${SCRIPT_NAME}] Cubism 2.1 Core :`, e);\n        }\n      }\n\n      const cached = await this._getFromCache();\n      if (cached && cached.sdk) {\n        console.log(`[${SCRIPT_NAME}] ?pixi-live2d-display`);\n        await this._executeScript(cached.sdk, _topWindow);\n      } else {\n        console.log(`[${SCRIPT_NAME}] ?CDN  pixi-live2d-display...`);\n        const sdkText = await fetch(this.SDK_URL).then(r => {\n          if (!r.ok) throw new Error(`pixi-live2d-display : ${r.status}`);\n          return r.text();\n        });\n        await this._saveToCache({ sdk: sdkText });\n        await this._executeScript(sdkText, _topWindow);\n      }\n\n      await new Promise(r => setTimeout(r, 100));\n      this._patchPixiUrlResolve(_topWindow);\n\n      if (_topWindow.PIXI?.live2d?.Live2DModel) {\n        this.legacyLive2DNamespace = _topWindow.PIXI.live2d;\n        this._patchModelSettingsResolveURL(this.legacyLive2DNamespace, 'legacy');\n        this._patchXhrLoader(this.legacyLive2DNamespace, 'legacy');\n      }\n\n      this.activateRuntime('legacy');\n      this._setRuntime(_topWindow, 'legacy');\n      this.isLoaded = true;\n      _topWindow[this._READY_MARK] = true;\n      this.loadPromise = null;\n      console.log(`[${SCRIPT_NAME}] Live2D SDK `);\n      return true;\n    } catch (e) {\n      console.error(`[${SCRIPT_NAME}] Live2D SDK :`, e);\n      _topWindow[this._READY_MARK] = false;\n      _topWindow[this._RUNTIME_KEY] = null;\n      this.isLoaded = false;\n      this.loadPromise = null;\n      return false;\n    }\n  },\n\n  _executeScript(code, targetWindow) {\n    return new Promise((resolve, reject) => {\n      try {\n        const script = targetWindow.document.createElement('script');\n        script.textContent = code;\n        targetWindow.document.head.appendChild(script);\n        setTimeout(resolve, 10);\n      } catch (e) {\n        reject(e);\n      }\n    });\n  },\n\n  async _getFromCache() {\n    return new Promise((resolve) => {\n      try {\n        const request = indexedDB.open(DB_NAME, DB_VERSION);\n        request.onsuccess = (e) => {\n          const database = e.target.result;\n          if (!database.objectStoreNames.contains(STORE_SDK_CACHE)) {\n            database.close();\n            resolve(null);\n            return;\n          }\n          const tx = database.transaction(STORE_SDK_CACHE, 'readonly');\n          const store = tx.objectStore(STORE_SDK_CACHE);\n          const get = store.get(this.SDK_CACHE_KEY);\n          get.onsuccess = () => {\n            database.close();\n            resolve(get.result?.data || null);\n          };\n          get.onerror = () => {\n            database.close();\n            resolve(null);\n          };\n        };\n        request.onerror = () => resolve(null);\n      } catch (e) {\n        resolve(null);\n      }\n    });\n  },\n\n  async _saveToCache(data) {\n    return new Promise((resolve) => {\n      try {\n        const request = indexedDB.open(DB_NAME, DB_VERSION);\n        request.onsuccess = (e) => {\n          const database = e.target.result;\n          if (!database.objectStoreNames.contains(STORE_SDK_CACHE)) {\n            database.close();\n            resolve();\n            return;\n          }\n          const tx = database.transaction(STORE_SDK_CACHE, 'readwrite');\n          const store = tx.objectStore(STORE_SDK_CACHE);\n          store.put({ id: this.SDK_CACHE_KEY, data, timestamp: Date.now() });\n          tx.oncomplete = () => {\n            database.close();\n            console.log(`[${SCRIPT_NAME}] Live2D SDK  IndexedDB`);\n            resolve();\n          };\n          tx.onerror = () => {\n            database.close();\n            resolve();\n          };\n        };\n        request.onerror = () => resolve();\n      } catch (e) {\n        resolve();\n      }\n    });\n  },\n\n  async clearCache() {\n    return new Promise((resolve) => {\n      try {\n        const request = indexedDB.open(DB_NAME, DB_VERSION);\n        request.onsuccess = (e) => {\n          const database = e.target.result;\n          if (!database.objectStoreNames.contains(STORE_SDK_CACHE)) {\n            database.close();\n            resolve();\n            return;\n          }\n          const tx = database.transaction(STORE_SDK_CACHE, 'readwrite');\n          const store = tx.objectStore(STORE_SDK_CACHE);\n          store.delete(this.SDK_CACHE_KEY);\n          tx.oncomplete = () => {\n            database.close();\n            this.isLoaded = false;\n            this.loadPromise = null;\n            this.legacyCoreLoaded = false;\n            this.legacyCorePromise = null;\n            this.legacyCoreSource = null;\n            this.cubism5CoreLoaded = false;\n            this.cubism5CorePromise = null;\n            this.cubism5CoreSource = null;\n            this.cubism5RuntimeLoaded = false;\n            this.cubism5RuntimePromise = null;\n            this.cubism5RuntimeSource = null;\n            this.legacyLive2DNamespace = null;\n            this.cubism5Live2DNamespace = null;\n            this.patchedResolveUrlPrototypes = new WeakSet();\n            this.patchedXhrLoaderNamespaces = new WeakSet();\n            this.pixiUrlResolvePatched = false;\n            this.pixiUrlResolveOriginal = null;\n            this.legacyCoreObject = null;\n            this.cubism5CoreObject = null;\n            this.activeCoreType = null;\n            this.loadedScriptUrls = new Set();\n            console.log(`[${SCRIPT_NAME}] Live2D SDK cache cleared`);\n            resolve();\n          };\n        };\n        request.onerror = () => resolve();\n      } catch (e) {\n        resolve();\n      }\n    });\n  }\n};\n\n\r\n\r\n\r\n\r\n\r\n\r\n","/**\n * \n *  jQueryUI draggable  //  LLM\n *  jQueryUI draggable \n *\n * \n * IDLE  pointerdown  PENDING\n * PENDING   >   IDLE jQueryUI\n * PENDING  longPressDelay   LONG_PRESS  IDLE\n * PENDING  pointerup  WAIT_DOUBLE\n * WAIT_DOUBLE  doubleClickWindow  pointerdown+up  DOUBLE_TAP  IDLE\n * WAIT_DOUBLE    TAP  IDLE\n */\n\nexport type GestureType = 'tap' | 'double-tap' | 'long-press';\n\nexport interface GestureEvent {\n  type: GestureType;\n  clientX: number;\n  clientY: number;\n}\n\nexport interface GestureConfig {\n  /** (ms) */\n  longPressDelay: number;\n  /** (ms) */\n  doubleClickWindow: number;\n  /** (px) */\n  moveThreshold: number;\n}\n\nconst DEFAULT_CONFIG: GestureConfig = {\n  longPressDelay: 500,\n  doubleClickWindow: 300,\n  moveThreshold: 8,\n};\n\nfunction isTouchDevice(): boolean {\n  return 'ontouchstart' in window || navigator.maxTouchPoints > 0;\n}\n\nexport class GestureRecognizer {\n  private element: HTMLElement;\n  private config: GestureConfig;\n  private onGesture: (event: GestureEvent) => void;\n  private isDraggingCheck: () => boolean;\n\n  private state: 'idle' | 'pending' | 'wait-double' = 'idle';\n  private startPos = { x: 0, y: 0 };\n  private longPressTimer: number | null = null;\n  private doubleClickTimer: number | null = null;\n  private longPressFired = false;\n  private moved = false;\n  private activePointerId: number | null = null;\n  private destroyed = false;\n\n  private boundPointerDown: (e: PointerEvent) => void;\n  private boundPointerMove: (e: PointerEvent) => void;\n  private boundPointerUp: (e: PointerEvent) => void;\n  private boundContextMenu: (e: Event) => void;\n\n  /**\n   * @param element \n   * @param config \n   * @param onGesture \n   * @param isDraggingCheck  jQueryUI draggable \n   */\n  constructor(\n    element: HTMLElement,\n    config: Partial<GestureConfig>,\n    onGesture: (event: GestureEvent) => void,\n    isDraggingCheck: () => boolean = () => false,\n  ) {\n    this.element = element;\n    this.config = {\n      ...DEFAULT_CONFIG,\n      moveThreshold: isTouchDevice() ? 12 : 8,\n      ...config,\n    };\n    this.onGesture = onGesture;\n    this.isDraggingCheck = isDraggingCheck;\n\n    this.boundPointerDown = this.handlePointerDown.bind(this);\n    this.boundPointerMove = this.handlePointerMove.bind(this);\n    this.boundPointerUp = this.handlePointerUp.bind(this);\n    this.boundContextMenu = (e: Event) => e.preventDefault();\n\n    element.addEventListener('pointerdown', this.boundPointerDown);\n    element.addEventListener('pointermove', this.boundPointerMove);\n    element.addEventListener('pointerup', this.boundPointerUp);\n    element.addEventListener('pointercancel', this.boundPointerUp);\n    element.addEventListener('contextmenu', this.boundContextMenu);\n  }\n\n  destroy(): void {\n    this.destroyed = true;\n    this.clearAllTimers();\n    this.element.removeEventListener('pointerdown', this.boundPointerDown);\n    this.element.removeEventListener('pointermove', this.boundPointerMove);\n    this.element.removeEventListener('pointerup', this.boundPointerUp);\n    this.element.removeEventListener('pointercancel', this.boundPointerUp);\n    this.element.removeEventListener('contextmenu', this.boundContextMenu);\n  }\n\n  private handlePointerDown(_e: PointerEvent): void {\n    if (this.destroyed) return;\n    if (_e.pointerType === 'touch' && _e.isPrimary === false) {\n      this.resetState();\n      return;\n    }\n\n    if (this.activePointerId !== null && _e.pointerId !== this.activePointerId) {\n      return;\n    }\n    this.activePointerId = _e.pointerId;\n\n    this.startPos = { x: _e.clientX, y: _e.clientY };\n    this.longPressFired = false;\n    this.moved = false;\n\n    if (this.state === 'wait-double') {\n      //  pointerup \n      return;\n    }\n\n    this.state = 'pending';\n    this.clearLongPressTimer();\n\n    this.longPressTimer = window.setTimeout(() => {\n      if (this.state === 'pending' && !this.moved && !this.isDraggingCheck()) {\n        this.longPressFired = true;\n        this.state = 'idle';\n        this.onGesture({\n          type: 'long-press',\n          clientX: this.startPos.x,\n          clientY: this.startPos.y,\n        });\n      }\n    }, this.config.longPressDelay);\n  }\n\n  private handlePointerMove(_e: PointerEvent): void {\n    if (this.destroyed || this.state !== 'pending') return;\n    if (this.activePointerId !== _e.pointerId) return;\n\n    const dx = _e.clientX - this.startPos.x;\n    const dy = _e.clientY - this.startPos.y;\n\n    if (Math.sqrt(dx * dx + dy * dy) > this.config.moveThreshold) {\n      //    idle jQueryUI \n      this.moved = true;\n      this.clearLongPressTimer();\n      this.state = 'idle';\n    }\n  }\n\n  private handlePointerUp(_e: PointerEvent): void {\n    if (this.destroyed) return;\n    if (this.activePointerId !== _e.pointerId) return;\n    this.activePointerId = null;\n    this.clearLongPressTimer();\n\n    // jQueryUI  \n    if (this.moved || this.isDraggingCheck()) {\n      this.state = 'idle';\n      return;\n    }\n\n    //    idle\n    if (this.longPressFired) {\n      this.state = 'idle';\n      return;\n    }\n\n    if (this.state === 'wait-double') {\n      // \n      this.clearDoubleClickTimer();\n      this.state = 'idle';\n      this.onGesture({\n        type: 'double-tap',\n        clientX: _e.clientX,\n        clientY: _e.clientY,\n      });\n      return;\n    }\n\n    if (this.state === 'pending' && !this.moved) {\n      //   \n      this.state = 'wait-double';\n      const x = _e.clientX;\n      const y = _e.clientY;\n      this.doubleClickTimer = window.setTimeout(() => {\n        //   \n        this.state = 'idle';\n        this.onGesture({ type: 'tap', clientX: x, clientY: y });\n      }, this.config.doubleClickWindow);\n    }\n  }\n\n  private resetState(): void {\n    this.activePointerId = null;\n    this.longPressFired = false;\n    this.moved = false;\n    this.state = 'idle';\n    this.clearAllTimers();\n  }\n\n  private clearLongPressTimer(): void {\n    if (this.longPressTimer !== null) {\n      window.clearTimeout(this.longPressTimer);\n      this.longPressTimer = null;\n    }\n  }\n\n  private clearDoubleClickTimer(): void {\n    if (this.doubleClickTimer !== null) {\n      window.clearTimeout(this.doubleClickTimer);\n      this.doubleClickTimer = null;\n    }\n  }\n\n  private clearAllTimers(): void {\n    this.clearLongPressTimer();\n    this.clearDoubleClickTimer();\n  }\n}\n","import { log, warn } from '../utils/dom';\r\nimport { GestureRecognizer, type GestureEvent } from '../utils/gesture-recognizer';\r\nimport { Live2DLoader } from './loader';\r\n\r\n/**\r\n * Live2D PIXI \r\n *  fixed  canvas\r\n */\r\nexport const Live2DStage = {\r\n  app: null as any,\r\n  canvas: null as HTMLCanvasElement | null,\r\n  glContext: null as WebGLRenderingContext | WebGL2RenderingContext | null,\r\n  container: null as HTMLDivElement | null,\r\n  mountStack: [] as Array<{\r\n    parent: ParentNode | null;\r\n    nextSibling: ChildNode | null;\r\n    styleText: string;\r\n    width: number;\r\n    height: number;\r\n    onPositionChange: ((x: number, y: number) => void) | null;\r\n  }>,\r\n  mountMode: 'floating' as 'floating' | 'preview',\r\n  _pendingFloatingResize: null as { width: number; height: number } | null,\r\n  loadingOverlay: null as HTMLDivElement | null,\r\n  loadingText: null as HTMLDivElement | null,\r\n  loadingBarFill: null as HTMLDivElement | null,\r\n  interactionLayer: null as HTMLDivElement | null,\r\n  gestureRecognizer: null as GestureRecognizer | null,\r\n  _dragClass: 'desktop-pet-dragging',\r\n  _minVisiblePx: 48,\r\n  _interactionPaddingPx: 14,\r\n  _alphaHitThreshold: 10,\r\n  _maxPixelScanSamples: 360000,\r\n  _onPositionChange: null as ((x: number, y: number) => void) | null,\r\n  _boundWindowResize: null as (() => void) | null,\r\n  _interactionSyncTimer: null as number | null,\r\n  _pixelReadBuffer: null as Uint8Array | null,\r\n  _lastClampLogAt: 0,\r\n\r\n  _clampPosition(\r\n    x: number,\r\n    y: number,\r\n    width: number,\r\n    height: number,\r\n    minVisible: number = 0,\r\n  ): { x: number; y: number; clamped: boolean } {\r\n    const top = this._top();\r\n    const viewportWidth = top.innerWidth || top.document.documentElement.clientWidth || width;\r\n    const viewportHeight = top.innerHeight || top.document.documentElement.clientHeight || height;\r\n\r\n    const safeWidth = Number.isFinite(width) && width > 0 ? width : viewportWidth;\r\n    const safeHeight = Number.isFinite(height) && height > 0 ? height : viewportHeight;\r\n    const safeMinVisibleX = Math.max(0, Math.min(minVisible, safeWidth, viewportWidth));\r\n    const safeMinVisibleY = Math.max(0, Math.min(minVisible, safeHeight, viewportHeight));\r\n\r\n    const minX = Math.min(0, -safeWidth + safeMinVisibleX);\r\n    const minY = Math.min(0, -safeHeight + safeMinVisibleY);\r\n    const maxX = Math.max(0, viewportWidth - safeMinVisibleX);\r\n    const maxY = Math.max(0, viewportHeight - safeMinVisibleY);\r\n    const safeX = Number.isFinite(x) ? x : 0;\r\n    const safeY = Number.isFinite(y) ? y : 0;\r\n    const clampedX = Math.min(Math.max(safeX, minX), maxX);\r\n    const clampedY = Math.min(Math.max(safeY, minY), maxY);\r\n    return { x: clampedX, y: clampedY, clamped: clampedX !== safeX || clampedY !== safeY };\r\n  },\r\n\r\n  _shouldClampCurrentPosition(): boolean {\r\n    if (!this.container) return false;\r\n    if (this.mountMode === 'preview') return false;\r\n\r\n    //  right/bottom  resize  left/top\r\n    const hasCustom = this.container.style.right === 'auto' || this.container.style.bottom === 'auto';\r\n    const hasExplicitLeftTop = !!this.container.style.left || !!this.container.style.top;\r\n    return hasCustom || hasExplicitLeftTop;\r\n  },\r\n\r\n  _getContainerRectSize(options: { width: number; height: number }): { width: number; height: number } {\r\n    const rect = this.container?.getBoundingClientRect?.();\r\n    return {\r\n      width: rect?.width && rect.width > 0 ? rect.width : options.width,\r\n      height: rect?.height && rect.height > 0 ? rect.height : options.height,\r\n    };\r\n  },\r\n\r\n  _isRectFullyOutsideViewport(rect: DOMRect): boolean {\r\n    const top = this._top();\r\n    const viewportWidth = top.innerWidth || top.document.documentElement.clientWidth || 0;\r\n    const viewportHeight = top.innerHeight || top.document.documentElement.clientHeight || 0;\r\n    if (viewportWidth <= 0 || viewportHeight <= 0) return false;\r\n    return rect.right <= 0 || rect.bottom <= 0 || rect.left >= viewportWidth || rect.top >= viewportHeight;\r\n  },\r\n\r\n  _getVisibleAreaRatio(rect: DOMRect, viewportWidth: number, viewportHeight: number): number {\r\n    const rectWidth = Number.isFinite(rect.width) ? rect.width : 0;\r\n    const rectHeight = Number.isFinite(rect.height) ? rect.height : 0;\r\n    if (rectWidth <= 0 || rectHeight <= 0) return 1;\r\n    if (viewportWidth <= 0 || viewportHeight <= 0) return 1;\r\n\r\n    const visibleLeft = Math.max(0, rect.left);\r\n    const visibleTop = Math.max(0, rect.top);\r\n    const visibleRight = Math.min(viewportWidth, rect.right);\r\n    const visibleBottom = Math.min(viewportHeight, rect.bottom);\r\n    const visibleWidth = Math.max(0, visibleRight - visibleLeft);\r\n    const visibleHeight = Math.max(0, visibleBottom - visibleTop);\r\n    const visibleArea = visibleWidth * visibleHeight;\r\n    const totalArea = rectWidth * rectHeight;\r\n    if (totalArea <= 0) return 1;\r\n\r\n    return Math.max(0, Math.min(1, visibleArea / totalArea));\r\n  },\r\n\r\n  _clampPositionByAxis(value: number, size: number, viewportSize: number, minVisible: number): number {\r\n    const safeSize = Number.isFinite(size) && size > 0 ? size : viewportSize;\r\n    const safeViewport = Number.isFinite(viewportSize) && viewportSize > 0 ? viewportSize : safeSize;\r\n    const safeMinVisible = Math.max(0, Math.min(minVisible, safeSize, safeViewport));\r\n    const min = Math.min(0, -safeSize + safeMinVisible);\r\n    const max = Math.max(0, safeViewport - safeMinVisible);\r\n    const safeValue = Number.isFinite(value) ? value : 0;\r\n    return Math.min(Math.max(safeValue, min), max);\r\n  },\r\n\r\n  _clampContainerToViewport(options: { width: number; height: number }, reason: string): void {\r\n    if (!this.container) return;\r\n    const rect = this.container.getBoundingClientRect();\r\n    const size = this._getContainerRectSize(options);\r\n    const top = this._top();\r\n    const viewportWidth = top.innerWidth || top.document.documentElement.clientWidth || size.width;\r\n    const viewportHeight = top.innerHeight || top.document.documentElement.clientHeight || size.height;\r\n    const shouldClamp = this._shouldClampCurrentPosition();\r\n    const fullyOutside = this._isRectFullyOutsideViewport(rect);\r\n    const visibleRatio = this._getVisibleAreaRatio(rect, viewportWidth, viewportHeight);\r\n    const isResizeClamp = reason.includes('resize');\r\n    const forceFullVisible = (fullyOutside || isResizeClamp) && visibleRatio < 0.72;\r\n    if (!shouldClamp && !fullyOutside && !forceFullVisible) return;\r\n\r\n    const minVisibleX = forceFullVisible\r\n      ? Math.min(size.width, viewportWidth)\r\n      : Math.max(0, Math.min(this._minVisiblePx, size.width, viewportWidth));\r\n    const minVisibleY = forceFullVisible\r\n      ? Math.min(size.height, viewportHeight)\r\n      : Math.max(0, Math.min(this._minVisiblePx, size.height, viewportHeight));\r\n\r\n    const nextX = this._clampPositionByAxis(rect.left, size.width, viewportWidth, minVisibleX);\r\n    const nextY = this._clampPositionByAxis(rect.top, size.height, viewportHeight, minVisibleY);\r\n    const hasPositionChange = Math.abs(nextX - rect.left) > 0.5 || Math.abs(nextY - rect.top) > 0.5;\r\n    if (!hasPositionChange) return;\r\n\r\n    this.container.style.left = `${nextX}px`;\r\n    this.container.style.top = `${nextY}px`;\r\n    this.container.style.right = 'auto';\r\n    this.container.style.bottom = 'auto';\r\n\r\n    const now = Date.now();\r\n    if (now - this._lastClampLogAt > 600) {\r\n      this._lastClampLogAt = now;\r\n      log(`(${reason})`, {\r\n        from: { x: rect.left, y: rect.top },\r\n        to: { x: nextX, y: nextY },\r\n        fullyOutside,\r\n        visibleRatio,\r\n        forceFullVisible,\r\n      });\r\n    }\r\n\r\n    this._onPositionChange?.(nextX, nextY);\r\n  },\r\n\r\n  _bindWindowResize(options: { width: number; height: number }): void {\r\n    const top = this._top();\r\n    this._unbindWindowResize();\r\n\r\n    this._boundWindowResize = () => {\r\n      this._clampContainerToViewport(options, 'window-resize');\r\n    };\r\n\r\n    try {\r\n      top.addEventListener('resize', this._boundWindowResize, { passive: true });\r\n    } catch (e) {\r\n      warn(' window.resize ', e);\r\n      this._boundWindowResize = null;\r\n    }\r\n  },\r\n\r\n  _unbindWindowResize(): void {\r\n    const top = this._top();\r\n    if (!this._boundWindowResize) return;\r\n    try {\r\n      top.removeEventListener('resize', this._boundWindowResize);\r\n    } catch {\r\n      // ignore\r\n    } finally {\r\n      this._boundWindowResize = null;\r\n    }\r\n  },\r\n\r\n  /**  */\r\n  _top(): Window {\r\n    return window.parent ?? window;\r\n  },\r\n\r\n  /**  PIXI */\r\n  _getPIXI(): any {\r\n    const top = this._top();\r\n    return Live2DLoader.getPixi(top);\r\n  },\r\n\r\n  _measureOpaqueBoundsFromCanvas(\r\n    containerWidth: number,\r\n    containerHeight: number,\r\n  ): { left: number; top: number; width: number; height: number } | null {\r\n    const gl = this.glContext;\r\n    if (!gl) return null;\r\n\r\n    const bufferWidth = gl.drawingBufferWidth;\r\n    const bufferHeight = gl.drawingBufferHeight;\r\n    if (bufferWidth <= 0 || bufferHeight <= 0) return null;\r\n\r\n    const byteLength = bufferWidth * bufferHeight * 4;\r\n    if (!this._pixelReadBuffer || this._pixelReadBuffer.length !== byteLength) {\r\n      this._pixelReadBuffer = new Uint8Array(byteLength);\r\n    }\r\n    const pixels = this._pixelReadBuffer;\r\n\r\n    try {\r\n      gl.readPixels(0, 0, bufferWidth, bufferHeight, gl.RGBA, gl.UNSIGNED_BYTE, pixels);\r\n    } catch {\r\n      return null;\r\n    }\r\n\r\n    const scanStep = Math.max(1, Math.floor(Math.sqrt((bufferWidth * bufferHeight) / this._maxPixelScanSamples)));\r\n    const alphaThreshold = Math.max(0, Math.min(255, this._alphaHitThreshold));\r\n\r\n    let minX = bufferWidth;\r\n    let minY = bufferHeight;\r\n    let maxX = -1;\r\n    let maxY = -1;\r\n\r\n    for (let y = 0; y < bufferHeight; y += scanStep) {\r\n      const rowOffset = y * bufferWidth * 4;\r\n      for (let x = 0; x < bufferWidth; x += scanStep) {\r\n        const alpha = pixels[rowOffset + x * 4 + 3];\r\n        if (alpha <= alphaThreshold) continue;\r\n\r\n        if (x < minX) minX = x;\r\n        if (y < minY) minY = y;\r\n        if (x > maxX) maxX = x;\r\n        if (y > maxY) maxY = y;\r\n      }\r\n    }\r\n\r\n    if (maxX < 0 || maxY < 0) return null;\r\n\r\n    if (scanStep > 1) {\r\n      maxX = Math.min(bufferWidth - 1, maxX + scanStep);\r\n      maxY = Math.min(bufferHeight - 1, maxY + scanStep);\r\n    }\r\n\r\n    const scaleX = containerWidth / bufferWidth;\r\n    const scaleY = containerHeight / bufferHeight;\r\n    const left = Math.max(0, Math.floor(minX * scaleX));\r\n    const right = Math.min(Math.ceil(containerWidth), Math.ceil((maxX + 1) * scaleX));\r\n    const top = Math.max(0, Math.floor(containerHeight - (maxY + 1) * scaleY));\r\n    const bottom = Math.min(Math.ceil(containerHeight), Math.ceil(containerHeight - minY * scaleY));\r\n    const width = right - left;\r\n    const height = bottom - top;\r\n    if (width < 8 || height < 8) return null;\r\n\r\n    return { left, top, width, height };\r\n  },\r\n\r\n  _syncInteractionLayerBounds(): void {\r\n    if (!this.container || !this.interactionLayer) return;\r\n\r\n    const layer = this.interactionLayer;\r\n    const container = this.container;\r\n    const disableLayer = () => {\r\n      layer.style.left = '0px';\r\n      layer.style.top = '0px';\r\n      layer.style.width = '100%';\r\n      layer.style.height = '100%';\r\n      layer.style.pointerEvents = 'none';\r\n      layer.style.cursor = 'default';\r\n    };\r\n\r\n    if (this.mountMode === 'preview') {\r\n      disableLayer();\r\n      return;\r\n    }\r\n\r\n    const rect = container.getBoundingClientRect();\r\n    const containerWidth =\r\n      rect.width > 0 ? rect.width : Number.parseFloat(String(container.style.width || '').replace('px', ''));\r\n    const containerHeight =\r\n      rect.height > 0 ? rect.height : Number.parseFloat(String(container.style.height || '').replace('px', ''));\r\n\r\n    if (!Number.isFinite(containerWidth) || !Number.isFinite(containerHeight) || containerWidth <= 0 || containerHeight <= 0) {\r\n      return;\r\n    }\r\n\r\n    const applyBounds = (left: number, top: number, width: number, height: number): boolean => {\r\n      const padding = Math.max(0, this._interactionPaddingPx);\r\n      const x1 = Math.max(0, Math.floor(left - padding));\r\n      const y1 = Math.max(0, Math.floor(top - padding));\r\n      const x2 = Math.min(Math.ceil(containerWidth), Math.ceil(left + width + padding));\r\n      const y2 = Math.min(Math.ceil(containerHeight), Math.ceil(top + height + padding));\r\n      const w = x2 - x1;\r\n      const h = y2 - y1;\r\n      if (w < 16 || h < 16) return false;\r\n\r\n      layer.style.left = `${x1}px`;\r\n      layer.style.top = `${y1}px`;\r\n      layer.style.width = `${w}px`;\r\n      layer.style.height = `${h}px`;\r\n      layer.style.pointerEvents = 'auto';\r\n      layer.style.cursor = 'pointer';\r\n      return true;\r\n    };\r\n\r\n    const model = this.app?.stage?.children?.[0] as any;\r\n    if (!model) {\r\n      disableLayer();\r\n      return;\r\n    }\r\n\r\n    const alphaBounds = this._measureOpaqueBoundsFromCanvas(containerWidth, containerHeight);\r\n    if (alphaBounds) {\r\n      const suspiciouslyHuge =\r\n        alphaBounds.width >= containerWidth * 0.95 && alphaBounds.height >= containerHeight * 0.95;\r\n      if (!suspiciouslyHuge && applyBounds(alphaBounds.left, alphaBounds.top, alphaBounds.width, alphaBounds.height)) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    if (typeof model.getBounds === 'function') {\r\n      try {\r\n        const bounds = model.getBounds();\r\n        const x = Number(bounds?.x);\r\n        const y = Number(bounds?.y);\r\n        const width = Number(bounds?.width);\r\n        const height = Number(bounds?.height);\r\n        const isValid =\r\n          Number.isFinite(x) &&\r\n          Number.isFinite(y) &&\r\n          Number.isFinite(width) &&\r\n          Number.isFinite(height) &&\r\n          width > 0 &&\r\n          height > 0;\r\n        if (isValid) {\r\n          const suspiciouslyHuge = width >= containerWidth * 0.95 && height >= containerHeight * 0.95;\r\n          if (!suspiciouslyHuge && applyBounds(x, y, width, height)) {\r\n            return;\r\n          }\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    const fallbackWidth = Math.max(80, Math.round(containerWidth * 0.62));\r\n    const fallbackHeight = Math.max(120, Math.round(containerHeight * 0.88));\r\n    const fallbackLeft = Math.max(0, Math.round((containerWidth - fallbackWidth) / 2));\r\n    const fallbackTop = Math.max(0, Math.round(containerHeight - fallbackHeight));\r\n    if (!applyBounds(fallbackLeft, fallbackTop, fallbackWidth, fallbackHeight)) {\r\n      disableLayer();\r\n      return;\r\n    }\r\n  },\r\n\r\n  _startInteractionSyncTimer(): void {\r\n    this._stopInteractionSyncTimer();\r\n    this._syncInteractionLayerBounds();\r\n    this._interactionSyncTimer = window.setInterval(() => {\r\n      this._syncInteractionLayerBounds();\r\n    }, 250);\r\n  },\r\n\r\n  _stopInteractionSyncTimer(): void {\r\n    if (this._interactionSyncTimer === null) return;\r\n    window.clearInterval(this._interactionSyncTimer);\r\n    this._interactionSyncTimer = null;\r\n  },\r\n\r\n  _enablePointerDrag(\r\n    $container: JQuery<HTMLElement>,\r\n    options: {\r\n      width: number;\r\n      height: number;\r\n      onPositionChange?: (x: number, y: number) => void;\r\n    },\r\n  ): void {\r\n    if (!this.container) return;\r\n\r\n    const top = this._top();\r\n    const container = this.container;\r\n    const dragTarget = this.interactionLayer ?? container;\r\n    const onPositionChange = options.onPositionChange;\r\n\r\n    const state = {\r\n      pointerId: null as number | null,\r\n      startClientX: 0,\r\n      startClientY: 0,\r\n      startLeft: 0,\r\n      startTop: 0,\r\n      dragging: false,\r\n      touchPointerIds: new Set<number>(),\r\n    };\r\n\r\n    const getRectLeftTop = () => {\r\n      const rect = container.getBoundingClientRect();\r\n      return { left: rect.left, top: rect.top };\r\n    };\r\n\r\n    const getRectSize = () => {\r\n      const rect = container.getBoundingClientRect();\r\n      return {\r\n        width: rect.width > 0 ? rect.width : options.width,\r\n        height: rect.height > 0 ? rect.height : options.height,\r\n      };\r\n    };\r\n\r\n    const cleanup = () => {\r\n      state.pointerId = null;\r\n      state.dragging = false;\r\n      $container.removeClass(this._dragClass);\r\n    };\r\n\r\n    dragTarget.addEventListener('pointerdown', (e: PointerEvent) => {\r\n      if (e.button !== 0) return;\r\n      if (e.pointerType === 'touch') {\r\n        state.touchPointerIds.add(e.pointerId);\r\n        if (state.touchPointerIds.size > 1) {\r\n          cleanup();\r\n          return;\r\n        }\r\n      }\r\n      if (state.pointerId !== null) return;\r\n\r\n      state.pointerId = e.pointerId;\r\n      state.startClientX = e.clientX;\r\n      state.startClientY = e.clientY;\r\n\r\n      const { left, top } = getRectLeftTop();\r\n      state.startLeft = left;\r\n      state.startTop = top;\r\n\r\n      try {\r\n        dragTarget.setPointerCapture(e.pointerId);\r\n      } catch {\r\n        // ignore\r\n      }\r\n    });\r\n\r\n    dragTarget.addEventListener('pointermove', (e: PointerEvent) => {\r\n      if (state.pointerId === null || e.pointerId !== state.pointerId) return;\r\n      if (e.pointerType === 'touch' && state.touchPointerIds.size > 1) {\r\n        cleanup();\r\n        return;\r\n      }\r\n\r\n      const dx = e.clientX - state.startClientX;\r\n      const dy = e.clientY - state.startClientY;\r\n      const dist = Math.sqrt(dx * dx + dy * dy);\r\n\r\n      if (!state.dragging) {\r\n        if (dist < 8) return;\r\n        state.dragging = true;\r\n        $container.addClass(this._dragClass);\r\n\r\n        container.style.left = `${state.startLeft}px`;\r\n        container.style.top = `${state.startTop}px`;\r\n        container.style.right = 'auto';\r\n        container.style.bottom = 'auto';\r\n      }\r\n\r\n      const clamped = this._clampPosition(\r\n        state.startLeft + dx,\r\n        state.startTop + dy,\r\n        getRectSize().width,\r\n        getRectSize().height,\r\n        this._minVisiblePx,\r\n      );\r\n\r\n      container.style.left = `${clamped.x}px`;\r\n      container.style.top = `${clamped.y}px`;\r\n      container.style.right = 'auto';\r\n      container.style.bottom = 'auto';\r\n      e.preventDefault();\r\n    }, { passive: false });\r\n\r\n    const onPointerUp = (e: PointerEvent) => {\r\n      if (e.pointerType === 'touch') {\r\n        state.touchPointerIds.delete(e.pointerId);\r\n      }\r\n      if (state.pointerId === null || e.pointerId !== state.pointerId) return;\r\n\r\n      const dragging = state.dragging;\r\n      cleanup();\r\n\r\n      if (!dragging) return;\r\n\r\n      const left = parseFloat(container.style.left || '0');\r\n      const topPx = parseFloat(container.style.top || '0');\r\n      const size = getRectSize();\r\n      const clamped = this._clampPosition(left, topPx, size.width, size.height, this._minVisiblePx);\r\n\r\n      container.style.left = `${clamped.x}px`;\r\n      container.style.top = `${clamped.y}px`;\r\n      container.style.right = 'auto';\r\n      container.style.bottom = 'auto';\r\n\r\n      this._onPositionChange = onPositionChange ?? this._onPositionChange;\r\n      this._onPositionChange?.(clamped.x, clamped.y);\r\n\r\n      try {\r\n        dragTarget.releasePointerCapture(e.pointerId);\r\n      } catch {\r\n        // ignore\r\n      }\r\n\r\n      // iOS  pointerup  selection\r\n      try {\r\n        top.getSelection?.()?.removeAllRanges?.();\r\n      } catch {\r\n        // ignore\r\n      }\r\n    };\r\n\r\n    dragTarget.addEventListener('pointerup', onPointerUp);\r\n    dragTarget.addEventListener('pointercancel', onPointerUp);\r\n  },\r\n\r\n  _ensureLoadingOverlay(): boolean {\r\n    if (!this.container) return false;\r\n\r\n    const overlay = this.loadingOverlay;\r\n    const overlayAlive = !!overlay && !!overlay.ownerDocument?.documentElement?.contains(overlay);\r\n    if (overlayAlive) return true;\r\n\r\n    this.hideLoadingProgress();\r\n\r\n    const doc = this.container.ownerDocument;\r\n    const panel = doc.createElement('div');\r\n    panel.style.cssText = `\r\n      position: absolute;\r\n      left: 8px;\r\n      right: 8px;\r\n      bottom: 8px;\r\n      padding: 8px 10px;\r\n      border-radius: 8px;\r\n      background: rgba(15, 23, 42, 0.72);\r\n      backdrop-filter: blur(3px);\r\n      pointer-events: none;\r\n      z-index: 5;\r\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);\r\n      color: #e2e8f0;\r\n      font-size: 12px;\r\n      line-height: 1.4;\r\n    `;\r\n\r\n    const text = doc.createElement('div');\r\n    text.style.cssText = 'margin-bottom: 6px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;';\r\n    text.textContent = ' (0%)';\r\n\r\n    const track = doc.createElement('div');\r\n    track.style.cssText = 'width: 100%; height: 6px; border-radius: 999px; background: rgba(148, 163, 184, 0.35); overflow: hidden;';\r\n\r\n    const fill = doc.createElement('div');\r\n    fill.style.cssText = 'height: 100%; width: 0%; border-radius: 999px; background: linear-gradient(90deg, #60a5fa, #22d3ee); transition: width 0.2s ease;';\r\n\r\n    track.appendChild(fill);\r\n    panel.appendChild(text);\r\n    panel.appendChild(track);\r\n    this.container.appendChild(panel);\r\n\r\n    this.loadingOverlay = panel;\r\n    this.loadingText = text;\r\n    this.loadingBarFill = fill;\r\n    return true;\r\n  },\r\n\r\n  showLoadingProgress(percent: number, message: string): void {\r\n    if (!this._ensureLoadingOverlay()) return;\r\n\r\n    const safePercent = Math.max(0, Math.min(100, Math.round(percent)));\r\n    if (this.loadingText) {\r\n      this.loadingText.textContent = `${message} (${safePercent}%)`;\r\n    }\r\n    if (this.loadingBarFill) {\r\n      this.loadingBarFill.style.width = `${safePercent}%`;\r\n    }\r\n  },\r\n\r\n  hideLoadingProgress(): void {\r\n    if (this.loadingOverlay) {\r\n      try {\r\n        this.loadingOverlay.remove();\r\n      } catch (e) {\r\n        warn('Failed to remove loading progress overlay', e);\r\n      }\r\n    }\r\n    this.loadingOverlay = null;\r\n    this.loadingText = null;\r\n    this.loadingBarFill = null;\r\n  },\r\n\r\n  /**\r\n   *  PIXI Application\r\n   */\r\n  create(options: {\r\n    width: number;\r\n    height: number;\r\n    position: { x: number; y: number };\r\n    scale: number;\r\n    onPositionChange?: (x: number, y: number) => void;\r\n    onScaleChange?: (scale: number) => void;\r\n    onTap?: (e: GestureEvent) => void;\r\n    onDoubleTap?: (e: GestureEvent) => void;\r\n    onLongPress?: (e: GestureEvent) => void;\r\n  }): boolean {\r\n    const top = this._top();\r\n    const PIXI = this._getPIXI();\r\n    if (!PIXI) {\r\n      warn('PIXI ');\r\n      return false;\r\n    }\r\n\r\n    // \r\n    this.destroy();\r\n    this._onPositionChange = options.onPositionChange ?? null;\r\n    this._bindWindowResize({ width: options.width, height: options.height });\r\n    const stale = top.document.getElementById('desktop-pet-stage');\r\n    if (stale) stale.remove();\r\n\r\n    //  div\r\n    this.container = top.document.createElement('div');\r\n    this.container.id = 'desktop-pet-stage';\r\n    this.container.style.cssText = `\r\n      position: fixed;\r\n      right: 20px;\r\n      bottom: 20px;\r\n      width: ${options.width}px;\r\n      height: ${options.height}px;\r\n      overflow: hidden;\r\n      z-index: 10000;\r\n      pointer-events: none;\r\n      cursor: default;\r\n      touch-action: none;\r\n    `;\r\n\r\n    // Apply persisted position.\r\n    const hasSavedPosition =\r\n      Number.isFinite(options.position.x) &&\r\n      Number.isFinite(options.position.y) &&\r\n      !(options.position.x === -1 && options.position.y === -1);\r\n\r\n    if (hasSavedPosition) {\r\n      const clamped = this._clampPosition(\r\n        options.position.x,\r\n        options.position.y,\r\n        options.width,\r\n        options.height,\r\n        this._minVisiblePx,\r\n      );\r\n\r\n      this.container.style.left = `${clamped.x}px`;\r\n      this.container.style.top = `${clamped.y}px`;\r\n      this.container.style.right = 'auto';\r\n      this.container.style.bottom = 'auto';\r\n\r\n      if (clamped.clamped) {\r\n        log('', {\r\n          from: options.position,\r\n          to: { x: clamped.x, y: clamped.y },\r\n        });\r\n        options.onPositionChange?.(clamped.x, clamped.y);\r\n      }\r\n    }\r\n\r\n    top.document.body.appendChild(this.container);\r\n\r\n    //  canvas\r\n    this.canvas = top.document.createElement('canvas');\r\n    this.canvas.style.cssText = 'width: 100%; height: 100%; pointer-events: none;';\r\n    this.container.appendChild(this.canvas);\r\n\r\n    this.interactionLayer = top.document.createElement('div');\r\n    this.interactionLayer.className = 'desktop-pet-interaction-layer';\r\n    this.interactionLayer.style.cssText = `\r\n      position: absolute;\r\n      left: 0;\r\n      top: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n      pointer-events: auto;\r\n      cursor: pointer;\r\n      touch-action: none;\r\n      z-index: 4;\r\n    `;\r\n    this.container.appendChild(this.interactionLayer);\r\n\r\n    //  PIXI Application\r\n    const dpr = top.devicePixelRatio || 1;\r\n    this.canvas.width = Math.floor(options.width * dpr);\r\n    this.canvas.height = Math.floor(options.height * dpr);\r\n\r\n    const glContext =\r\n      this.canvas.getContext('webgl2', {\r\n        alpha: true,\r\n        antialias: true,\r\n        stencil: true,\r\n        depth: true,\r\n        preserveDrawingBuffer: true,\r\n        premultipliedAlpha: true,\r\n      }) ||\r\n      this.canvas.getContext('webgl', {\r\n        alpha: true,\r\n        antialias: true,\r\n        stencil: true,\r\n        depth: true,\r\n        preserveDrawingBuffer: true,\r\n        premultipliedAlpha: true,\r\n      });\r\n\r\n    if (!glContext) {\r\n      warn('WebGL is unavailable');\r\n      return false;\r\n    }\r\n    this.glContext = glContext as WebGLRenderingContext | WebGL2RenderingContext;\r\n    this._pixelReadBuffer = null;\r\n\r\n    try {\r\n      const attrs = (glContext as WebGLRenderingContext | WebGL2RenderingContext).getContextAttributes?.();\r\n      if (attrs && attrs.stencil === false) {\r\n        warn('Current WebGL context has no stencil buffer; mask rendering may be abnormal');\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    this.app = new PIXI.Application({\r\n      view: this.canvas,\r\n      context: glContext,\r\n      backgroundAlpha: 0,\r\n      autoStart: true,\r\n      width: options.width,\r\n      height: options.height,\r\n      resolution: dpr,\r\n      autoDensity: true,\r\n      antialias: true,\r\n    });\r\n\r\n    //  jQueryUI \r\n    const $container = $(this.container);\r\n    const draggable = ($container as any).draggable;\r\n    if (typeof draggable === 'function') {\r\n      try {\r\n        $container.draggable({\r\n          handle: '.desktop-pet-interaction-layer',\r\n          start: (_e: any, ui: any) => {\r\n            $container.addClass(this._dragClass);\r\n\r\n            const rect = this.container?.getBoundingClientRect?.();\r\n            if (!rect) return;\r\n\r\n            this.container!.style.left = `${rect.left}px`;\r\n            this.container!.style.top = `${rect.top}px`;\r\n            this.container!.style.right = 'auto';\r\n            this.container!.style.bottom = 'auto';\r\n\r\n            if (ui?.position) {\r\n              ui.position.left = rect.left;\r\n              ui.position.top = rect.top;\r\n            }\r\n          },\r\n          drag: (_e: any, ui: any) => {\r\n            const rect = this.container?.getBoundingClientRect?.();\r\n            const width = rect?.width && rect.width > 0 ? rect.width : options.width;\r\n            const height = rect?.height && rect.height > 0 ? rect.height : options.height;\r\n\r\n            const clamped = this._clampPosition(ui.position.left, ui.position.top, width, height, this._minVisiblePx);\r\n            ui.position.left = clamped.x;\r\n            ui.position.top = clamped.y;\r\n          },\r\n          stop: (_e: any, ui: any) => {\r\n            $container.removeClass(this._dragClass);\r\n\r\n            const rect = this.container?.getBoundingClientRect?.();\r\n            const width = rect?.width && rect.width > 0 ? rect.width : options.width;\r\n            const height = rect?.height && rect.height > 0 ? rect.height : options.height;\r\n\r\n            const clamped = this._clampPosition(\r\n              ui.position.left,\r\n              ui.position.top,\r\n              width,\r\n              height,\r\n              this._minVisiblePx,\r\n            );\r\n\r\n            this.container!.style.left = `${clamped.x}px`;\r\n            this.container!.style.top = `${clamped.y}px`;\r\n            this.container!.style.right = 'auto';\r\n            this.container!.style.bottom = 'auto';\r\n\r\n            this._onPositionChange?.(clamped.x, clamped.y);\r\n          },\r\n        });\r\n      } catch (e) {\r\n        warn('Failed to initialize jQueryUI draggable, fallback to native pointer drag', e);\r\n        this._enablePointerDrag($container, {\r\n          width: options.width,\r\n          height: options.height,\r\n          onPositionChange: options.onPositionChange,\r\n        });\r\n      }\r\n    } else {\r\n      warn('jQueryUI draggable not found, fallback to native pointer drag');\r\n      this._enablePointerDrag($container, {\r\n        width: options.width,\r\n        height: options.height,\r\n        onPositionChange: options.onPositionChange,\r\n      });\r\n    }\r\n\r\n    // Mouse wheel + touch pinch zoom.\r\n    const interactionTarget = this.interactionLayer ?? this.container;\r\n    const SCALE_MIN = 0.1;\r\n    const SCALE_MAX = 3;\r\n    const SCALE_EPSILON = 0.002;\r\n    let currentScale = Number.isFinite(options.scale) ? options.scale : 1;\r\n    let isPinching = false;\r\n    let pinchStartDistance = 0;\r\n    let pinchStartScale = currentScale;\r\n    const activeTouchPointers = new Map<number, { x: number; y: number }>();\r\n\r\n    const emitScaleChange = (nextScale: number) => {\r\n      const safeScale = Math.max(SCALE_MIN, Math.min(SCALE_MAX, nextScale));\r\n      if (Math.abs(safeScale - currentScale) < SCALE_EPSILON) return;\r\n      currentScale = safeScale;\r\n      options.scale = safeScale;\r\n      options.onScaleChange?.(safeScale);\r\n    };\r\n\r\n    const getPinchDistance = () => {\r\n      if (activeTouchPointers.size < 2) return 0;\r\n      const points = Array.from(activeTouchPointers.values());\r\n      const a = points[0];\r\n      const b = points[1];\r\n      const dx = a.x - b.x;\r\n      const dy = a.y - b.y;\r\n      return Math.sqrt(dx * dx + dy * dy);\r\n    };\r\n\r\n    const setDraggableState = (enabled: boolean) => {\r\n      if (typeof draggable !== 'function') return;\r\n      try {\r\n        $container.draggable(enabled ? 'enable' : 'disable');\r\n      } catch {\r\n        // ignore\r\n      }\r\n    };\r\n\r\n    const onTouchPointerDown = (e: PointerEvent) => {\r\n      if (e.pointerType !== 'touch') return;\r\n      activeTouchPointers.set(e.pointerId, { x: e.clientX, y: e.clientY });\r\n      if (activeTouchPointers.size < 2) return;\r\n\r\n      const distance = getPinchDistance();\r\n      if (distance <= 0) return;\r\n\r\n      if (!isPinching) {\r\n        isPinching = true;\r\n        setDraggableState(false);\r\n      }\r\n      pinchStartDistance = distance;\r\n      pinchStartScale = currentScale;\r\n      e.preventDefault();\r\n    };\r\n\r\n    const onTouchPointerMove = (e: PointerEvent) => {\r\n      if (e.pointerType !== 'touch') return;\r\n      if (!activeTouchPointers.has(e.pointerId)) return;\r\n\r\n      activeTouchPointers.set(e.pointerId, { x: e.clientX, y: e.clientY });\r\n      if (!isPinching || activeTouchPointers.size < 2) return;\r\n\r\n      const distance = getPinchDistance();\r\n      if (distance <= 0 || pinchStartDistance <= 0) return;\r\n\r\n      const ratio = distance / pinchStartDistance;\r\n      emitScaleChange(pinchStartScale * ratio);\r\n      e.preventDefault();\r\n    };\r\n\r\n    const onTouchPointerEnd = (e: PointerEvent) => {\r\n      if (e.pointerType !== 'touch') return;\r\n      activeTouchPointers.delete(e.pointerId);\r\n\r\n      if (activeTouchPointers.size >= 2) {\r\n        const distance = getPinchDistance();\r\n        if (distance > 0) {\r\n          pinchStartDistance = distance;\r\n          pinchStartScale = currentScale;\r\n        }\r\n        return;\r\n      }\r\n\r\n      pinchStartDistance = 0;\r\n      pinchStartScale = currentScale;\r\n      if (isPinching) {\r\n        isPinching = false;\r\n        setDraggableState(true);\r\n      }\r\n    };\r\n\r\n    interactionTarget.addEventListener('pointerdown', onTouchPointerDown, { passive: false });\r\n    interactionTarget.addEventListener('pointermove', onTouchPointerMove, { passive: false });\r\n    interactionTarget.addEventListener('pointerup', onTouchPointerEnd);\r\n    interactionTarget.addEventListener('pointercancel', onTouchPointerEnd);\r\n\r\n    interactionTarget.addEventListener('wheel', (e: WheelEvent) => {\r\n      e.preventDefault();\r\n      const delta = e.deltaY > 0 ? -0.05 : 0.05;\r\n      emitScaleChange(currentScale + delta);\r\n    }, { passive: false });\r\n\r\n    // Gesture recognizer (replaces raw click handler).\r\n    this.gestureRecognizer = new GestureRecognizer(\r\n      interactionTarget,\r\n      {},\r\n      (event: GestureEvent) => {\r\n        switch (event.type) {\r\n          case 'tap':\r\n            options.onTap?.(event);\r\n            break;\r\n          case 'double-tap':\r\n            options.onDoubleTap?.(event);\r\n            break;\r\n          case 'long-press':\r\n            options.onLongPress?.(event);\r\n            break;\r\n        }\r\n      },\r\n      () =>\r\n        isPinching ||\r\n        $container.hasClass('ui-draggable-dragging') ||\r\n        $container.hasClass(this._dragClass),\r\n    );\r\n    this._startInteractionSyncTimer();\r\n\r\n    log('Live2D ');\r\n    return true;\r\n  },\r\n\r\n  /**\r\n   *  PIXI Application  stage\r\n   */\r\n  getStage(): any {\r\n    return this.app?.stage;\r\n  },\r\n\r\n  /**\r\n   * \r\n   */\r\n  isPreviewMounted(): boolean {\r\n    return this.mountMode === 'preview';\r\n  },\r\n\r\n  pushMount(mountEl: HTMLElement | null): boolean {\r\n    if (!this.container || !this.app || !this.canvas) return false;\r\n    if (!mountEl || !mountEl.isConnected) return false;\r\n\r\n    const top = this._top();\r\n\r\n    const rect = this.container.getBoundingClientRect?.();\r\n    const width =\r\n      rect?.width && rect.width > 0\r\n        ? Math.round(rect.width)\r\n        : Number(String(this.container.style.width || '').replace('px', '')) || 1;\r\n    const height =\r\n      rect?.height && rect.height > 0\r\n        ? Math.round(rect.height)\r\n        : Number(String(this.container.style.height || '').replace('px', '')) || 1;\r\n\r\n    this.mountStack.push({\r\n      parent: this.container.parentNode,\r\n      nextSibling: this.container.nextSibling,\r\n      styleText: this.container.style.cssText,\r\n      width,\r\n      height,\r\n      onPositionChange: this._onPositionChange,\r\n    });\r\n\r\n    try {\r\n      const pos = top.getComputedStyle(mountEl).position;\r\n      if (pos === 'static') {\r\n        mountEl.style.position = 'relative';\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    // \r\n    this._onPositionChange = null;\r\n    this._unbindWindowResize();\r\n\r\n    try {\r\n      mountEl.appendChild(this.container);\r\n    } catch {\r\n      return false;\r\n    }\r\n\r\n    this.mountMode = 'preview';\r\n    this.container.style.cssText = `\r\n      position: absolute;\r\n      inset: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n      overflow: hidden;\r\n      z-index: 1;\r\n      pointer-events: none;\r\n      cursor: default;\r\n      touch-action: none;\r\n    `;\r\n    if (this.interactionLayer) {\r\n      this.interactionLayer.style.left = '0px';\r\n      this.interactionLayer.style.top = '0px';\r\n      this.interactionLayer.style.width = '100%';\r\n      this.interactionLayer.style.height = '100%';\r\n      this.interactionLayer.style.pointerEvents = 'none';\r\n      this.interactionLayer.style.cursor = 'default';\r\n    }\r\n\r\n    try {\r\n      const $container = $(this.container);\r\n      const draggable = ($container as any).draggable;\r\n      if (typeof draggable === 'function') {\r\n        $container.draggable('disable');\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    return true;\r\n  },\r\n\r\n  popMount(): { width: number; height: number } | null {\r\n    if (!this.container || !this.app || !this.canvas) return null;\r\n    const entry = this.mountStack.pop();\r\n    if (!entry) return null;\r\n\r\n    try {\r\n      const parent = entry.parent;\r\n      if (parent) {\r\n        if (entry.nextSibling && entry.nextSibling.parentNode === parent) {\r\n          parent.insertBefore(this.container, entry.nextSibling);\r\n        } else {\r\n          parent.appendChild(this.container);\r\n        }\r\n      } else {\r\n        this._top().document.body.appendChild(this.container);\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    this.container.style.cssText = entry.styleText;\r\n    this._onPositionChange = entry.onPositionChange;\r\n    this.mountMode = this.mountStack.length > 0 ? 'preview' : 'floating';\r\n    this._syncInteractionLayerBounds();\r\n\r\n    try {\r\n      const $container = $(this.container);\r\n      const draggable = ($container as any).draggable;\r\n      if (typeof draggable === 'function') {\r\n        $container.draggable('enable');\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    //  resize clamp\r\n    this._bindWindowResize({ width: entry.width, height: entry.height });\r\n\r\n    const restore = this._pendingFloatingResize ?? { width: entry.width, height: entry.height };\r\n    this._pendingFloatingResize = null;\r\n    this.resize(restore.width, restore.height);\r\n\r\n    return restore;\r\n  },\r\n\r\n  /**\r\n   *  popMount \r\n   */\r\n  resizeFloating(width: number, height: number): void {\r\n    if (this.mountMode === 'preview') {\r\n      this._pendingFloatingResize = { width, height };\r\n      return;\r\n    }\r\n\r\n    if (this.container) {\r\n      this.container.style.width = `${width}px`;\r\n      this.container.style.height = `${height}px`;\r\n      this._clampContainerToViewport({ width, height }, 'stage-resize');\r\n      this._syncInteractionLayerBounds();\r\n    }\r\n    if (this.app) {\r\n      try {\r\n        this.app.renderer.resize(width, height);\r\n      } catch (e) {\r\n        warn('renderer.resize ', e);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  width/height \r\n   */\r\n  resizePreview(width: number, height: number): void {\r\n    if (this.mountMode !== 'preview') return;\r\n    if (!this.app) return;\r\n    try {\r\n      this.app.renderer.resize(width, height);\r\n      this._syncInteractionLayerBounds();\r\n    } catch (e) {\r\n      warn('renderer.resize ', e);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  resizeFloating\r\n   */\r\n  resize(width: number, height: number): void {\r\n    this.resizeFloating(width, height);\r\n  },\r\n\r\n  /**\n   * \n   */\n  destroy(): void {\n    this.hideLoadingProgress();\r\n    this._unbindWindowResize();\r\n    this._stopInteractionSyncTimer();\r\n    this.mountStack = [];\r\n    this.mountMode = 'floating';\r\n    this._pendingFloatingResize = null;\r\n\r\n    if (this.gestureRecognizer) {\r\n      this.gestureRecognizer.destroy();\r\n      this.gestureRecognizer = null;\r\n    }\r\n\r\n    if (this.app) {\r\n      try {\r\n        this.app.destroy(true);\r\n      } catch (e) {\r\n        warn('Failed to destroy PIXI Application', e);\r\n      }\r\n      this.app = null;\r\n    }\r\n    if (this.container) {\r\n      try {\r\n        this.container.remove();\r\n      } catch (e) {\r\n        warn('', e);\r\n      }\r\n      this.container = null;\r\n    }\r\n    this.interactionLayer = null;\r\n    this.canvas = null;\r\n    this.glContext = null;\r\n    this._pixelReadBuffer = null;\r\n  },\r\n};\r\n\r\n","import { EMPTY_MOTION_GROUP_VALUE, type EmotionTag } from '../core/constants';\nimport type { EmotionMotionOverride } from '../core/emotion';\n\nexport const EXPRESSION_LIVE2D_MAP: Record<\n  EmotionTag,\n  {\n    expressions: string[];\n    motions: string[];\n  }\n> = {\n  : {\n    expressions: ['normal', 'default', 'neutral', 'idle', 'base'],\n    motions: ['idle', 'normal', 'wait', 'default', 'stand'],\n  },\n  : {\n    expressions: ['smile', 'happy', 'joy', 'glad', 'pleased'],\n    motions: ['happy', 'smile', 'joy', 'weixiao', 'xiao', ''],\n  },\n  : {\n    expressions: ['angry', 'anger', 'mad', 'rage', 'annoyed'],\n    motions: ['angry', 'rage', 'mad', 'shengqi', 'duqi', ''],\n  },\n  : {\n    expressions: ['sad', 'sorrow', 'cry', 'upset', 'depressed'],\n    motions: ['sad', 'cry', 'sorrow', 'nanguo', 'leiw', ''],\n  },\n  : {\n    expressions: ['surprised', 'shock', 'amazed', 'wow', 'astonished'],\n    motions: ['surprised', 'shock', 'amazed', 'jingya', 'jingxi', ''],\n  },\n  : {\n    expressions: ['smirk', 'mock', 'sneer', 'tease', 'sarcastic'],\n    motions: ['mock', 'tease', 'tiaoxi', ''],\n  },\n  : {\n    expressions: ['shy', 'blush', 'embarrassed', 'bashful', 'timid'],\n    motions: ['shy', 'embarrassed', 'blush', 'haixiu', 'shame', ''],\n  },\n  : {\n    expressions: ['think', 'ponder', 'confused', 'wonder', 'curious'],\n    motions: ['think', 'ponder', 'wonder', 'sikao', ''],\n  },\n  : {\n    expressions: ['laugh', 'lol', 'haha', 'giggle', 'rofl'],\n    motions: ['laugh', 'giggle', 'haha', 'daxiao', 'oowarai', ''],\n  },\n  : {\n    expressions: ['playful', 'wink', 'silly', 'fun', 'mischievous'],\n    motions: ['playful', 'wink', 'fun', 'gaoguai', 'silly', ''],\n  },\n};\n\nfunction uniquePush(list: string[], seen: Set<string>, value: unknown): void {\n  const normalized = String(value ?? '').trim();\n  if (!normalized || seen.has(normalized)) return;\n  seen.add(normalized);\n  list.push(normalized);\n}\n\nfunction uniquePushAllowEmpty(list: string[], seen: Set<string>, value: unknown): void {\n  const raw = String(value ?? '');\n  const normalized = raw.trim();\n  if (!normalized && raw !== '') return;\n  const finalValue = normalized || '';\n  if (seen.has(finalValue)) return;\n  seen.add(finalValue);\n  list.push(finalValue);\n}\n\nexport type Live2DMotionEntry = {\n  group: string;\n  index: number;\n  name: string;\n};\n\nfunction uniqueMotionPush(list: Live2DMotionEntry[], seen: Set<string>, entry: Live2DMotionEntry): void {\n  const group = String(entry.group ?? '');\n  const index = Number.isFinite(entry.index) ? Math.max(0, Math.floor(entry.index)) : 0;\n  const name = String(entry.name ?? '').trim();\n  if (!name) return;\n  const key = `${group}#${index}#${name.toLowerCase()}`;\n  if (seen.has(key)) return;\n  seen.add(key);\n  list.push({ group, index, name });\n}\n\nfunction normalizeFileStem(input: unknown): string {\n  const raw = String(input ?? '').trim();\n  if (!raw) return '';\n\n  const noHash = raw.split('#')[0];\n  const noQuery = noHash.split('?')[0];\n  const filePart = noQuery.split('/').pop() || noQuery;\n  let decoded = filePart;\n  try {\n    decoded = decodeURIComponent(filePart);\n  } catch {\n    // ignore\n  }\n\n  return decoded\n    .replace(/\\.exp3\\.json$/i, '')\n    .replace(/\\.motion3\\.json$/i, '')\n    .replace(/\\.mtn$/i, '')\n    .replace(/\\.json$/i, '')\n    .trim();\n}\n\nfunction normalizeDefinitionName(def: unknown, fallback = ''): string {\n  if (typeof def === 'string') {\n    return normalizeFileStem(def) || def.trim();\n  }\n  if (!def || typeof def !== 'object') {\n    return fallback;\n  }\n\n  const obj = def as any;\n  const directName = obj.Name || obj.name || obj.Id || obj.id || '';\n  if (String(directName ?? '').trim()) {\n    return String(directName).trim();\n  }\n\n  const fileLike = obj.File || obj.file || obj.Path || obj.path || '';\n  const stem = normalizeFileStem(fileLike);\n  if (stem) return stem;\n\n  return fallback;\n}\n\nfunction collectSettingsCandidates(model: any): any[] {\n  const candidates: any[] = [];\n  const seen = new Set<any>();\n\n  const add = (obj: any) => {\n    if (!obj || typeof obj !== 'object') return;\n    if (seen.has(obj)) return;\n    seen.add(obj);\n    candidates.push(obj);\n  };\n\n  const motionManager = model?.internalModel?.motionManager;\n  const settings = model?.internalModel?.settings;\n\n  add(settings);\n  add(settings?.json);\n  add(settings?.rawSettings);\n  add(settings?.modelJson);\n  add(motionManager?.settings);\n  add(motionManager?.settings?.json);\n  add(motionManager?.settings?.rawSettings);\n  add(motionManager?.settings?.modelJson);\n\n  return candidates;\n}\n\nfunction isExpressionFileLike(input: unknown): boolean {\n  const raw = String(input ?? '').trim().toLowerCase();\n  if (!raw) return false;\n  return /\\.exp3\\.json($|[?#])/.test(raw) || /\\.exp\\.json($|[?#])/.test(raw) || /\\.exp($|[?#])/.test(raw);\n}\n\nfunction isMotionFileLike(input: unknown): boolean {\n  const raw = String(input ?? '').trim().toLowerCase();\n  if (!raw) return false;\n  return /\\.motion3\\.json($|[?#])/.test(raw) || /\\.mtn($|[?#])/.test(raw);\n}\n\nfunction isMotionDefinition(node: unknown): boolean {\n  if (typeof node === 'string') {\n    return isMotionFileLike(node);\n  }\n  if (!node || typeof node !== 'object') return false;\n\n  const obj = node as any;\n  const fileLike = obj.File || obj.file || obj.Path || obj.path || '';\n  if (isMotionFileLike(fileLike)) return true;\n\n  const soundLike = obj.Sound || obj.sound || '';\n  if (typeof soundLike === 'string' && soundLike.trim()) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction countMotionDefinitions(list: unknown[]): number {\n  let count = 0;\n  for (const item of list) {\n    if (isMotionDefinition(item)) count++;\n  }\n  return count > 0 ? count : list.length;\n}\n\nfunction mergeGroupCount(target: Record<string, number>, key: unknown, count: unknown): void {\n  const keyRaw = String(key ?? '');\n  const normalized = keyRaw.trim();\n  if (!normalized && keyRaw !== '') return;\n\n  const groupName = normalized || '';\n  const parsedCount = Number(count);\n  const safeCount = Number.isFinite(parsedCount) && parsedCount > 0 ? Math.max(1, Math.floor(parsedCount)) : 1;\n  const prev = target[groupName];\n  target[groupName] = Number.isFinite(prev) && prev > 0 ? Math.max(prev, safeCount) : safeCount;\n}\n\nfunction pushFromContainer(names: string[], seen: Set<string>, container: unknown, fallbackPrefix: string): void {\n  const pushFromList = (list: unknown[], fallbackPrefixInner: string) => {\n    for (let i = 0; i < list.length; i++) {\n      const normalized = normalizeDefinitionName(list[i], `${fallbackPrefixInner}_${i + 1}`);\n      uniquePush(names, seen, normalized);\n    }\n  };\n\n  if (Array.isArray(container)) {\n    pushFromList(container, fallbackPrefix);\n    return;\n  }\n  if (!container || typeof container !== 'object') return;\n\n  let i = 0;\n  for (const [key, value] of Object.entries(container as Record<string, unknown>)) {\n    const fallbackName = normalizeFileStem(key) || String(key || '').trim() || `${fallbackPrefix}_${i + 1}`;\n    const normalized = normalizeDefinitionName(value, fallbackName);\n    uniquePush(names, seen, normalized || fallbackName);\n    i++;\n  }\n}\n\nexport function collectExpressionNamesFromUnknown(raw: unknown): string[] {\n  const names: string[] = [];\n  const seen = new Set<string>();\n  const visited = new Set<any>();\n\n  const visit = (node: unknown, context = ''): void => {\n    if (node == null) return;\n\n    if (typeof node === 'string') {\n      const text = node.trim();\n      if (!text) return;\n      if (isExpressionFileLike(text) || /exp|expression/.test(context)) {\n        uniquePush(names, seen, normalizeFileStem(text) || text);\n      }\n      return;\n    }\n\n    if (Array.isArray(node)) {\n      for (let i = 0; i < node.length; i++) {\n        const item = node[i];\n        const fallback = `${context || 'expression'}_${i + 1}`;\n        if (typeof item === 'string') {\n          if (isExpressionFileLike(item) || /exp|expression/.test(context)) {\n            uniquePush(names, seen, normalizeFileStem(item) || item);\n          }\n          continue;\n        }\n\n        if (item && typeof item === 'object') {\n          const normalized = normalizeDefinitionName(item, fallback);\n          const itemAny = item as any;\n          const fileLike = itemAny.File || itemAny.file || itemAny.Path || itemAny.path || '';\n          if (/exp|expression/.test(context) || isExpressionFileLike(fileLike)) {\n            uniquePush(names, seen, normalized || fallback);\n          }\n        }\n\n        visit(item, context);\n      }\n      return;\n    }\n\n    if (typeof node !== 'object') return;\n    if (visited.has(node)) return;\n    visited.add(node);\n\n    const obj = node as Record<string, unknown>;\n    const anyObj = obj as any;\n    const directFile = anyObj.File || anyObj.file || anyObj.Path || anyObj.path || '';\n    if (isExpressionFileLike(directFile)) {\n      uniquePush(names, seen, normalizeDefinitionName(obj, normalizeFileStem(directFile)));\n    }\n\n    for (const [rawKey, value] of Object.entries(obj)) {\n      const key = String(rawKey || '').trim();\n      if (!key) continue;\n      const keyLower = key.toLowerCase();\n      const keyIsExpression = keyLower.includes('expression') || keyLower.includes('expr') || keyLower === 'exp';\n      const nextContext = keyIsExpression ? 'expression' : context;\n\n      if (typeof value === 'string') {\n        const text = value.trim();\n        if (!text) continue;\n        if (isExpressionFileLike(text) || keyIsExpression || /exp|expression/.test(context)) {\n          const fallback = normalizeFileStem(key) || key;\n          const normalized = normalizeDefinitionName({ Name: fallback, File: text }, fallback);\n          uniquePush(names, seen, normalized || fallback);\n        }\n        continue;\n      }\n\n      if (Array.isArray(value)) {\n        if (keyIsExpression || /exp|expression/.test(context)) {\n          pushFromContainer(names, seen, value, normalizeFileStem(key) || 'expression');\n        }\n        visit(value, nextContext);\n        continue;\n      }\n\n      if (value && typeof value === 'object') {\n        if (keyIsExpression) {\n          const fallback = normalizeFileStem(key) || key;\n          uniquePush(names, seen, normalizeDefinitionName(value, fallback));\n        }\n        visit(value, nextContext);\n      }\n    }\n  };\n\n  visit(raw, '');\n  return names;\n}\n\nexport function collectMotionGroupCountsFromUnknown(raw: unknown): Record<string, number> {\n  const groups: Record<string, number> = {};\n  const visited = new Set<any>();\n\n  const visit = (node: unknown, parentKey = '', context = ''): void => {\n    if (node == null) return;\n\n    if (Array.isArray(node)) {\n      const count = countMotionDefinitions(node);\n      if ((parentKey === '' || !!parentKey) && count > 0 && (context === 'motion' || node.some(item => isMotionDefinition(item)))) {\n        mergeGroupCount(groups, parentKey, count);\n      }\n\n      for (const item of node) {\n        if (item && typeof item === 'object') {\n          visit(item, parentKey, context);\n        }\n      }\n      return;\n    }\n\n    if (typeof node !== 'object') return;\n    if (visited.has(node)) return;\n    visited.add(node);\n\n    const obj = node as Record<string, unknown>;\n    for (const [rawKey, value] of Object.entries(obj)) {\n      const keyRaw = String(rawKey ?? '');\n      const keyTrimmed = keyRaw.trim();\n      const key = keyTrimmed || (keyRaw === '' ? '' : '');\n      if (!key && keyRaw !== '') continue;\n\n      const keyLower = key.toLowerCase();\n      const keyIsMotionContainer =\n        keyLower.includes('motions') ||\n        keyLower.includes('motion') ||\n        keyLower.includes('anim') ||\n        keyLower.includes('mtn');\n      const nextContext = keyIsMotionContainer ? 'motion' : context;\n\n      if (Array.isArray(value)) {\n        const count = countMotionDefinitions(value);\n        if (count > 0 && (nextContext === 'motion' || value.some(item => isMotionDefinition(item)))) {\n          mergeGroupCount(groups, key, count);\n        }\n        visit(value, key, nextContext);\n        continue;\n      }\n\n      if (typeof value === 'string') {\n        if (isMotionFileLike(value) && parentKey) {\n          mergeGroupCount(groups, parentKey, 1);\n        }\n        continue;\n      }\n\n      if (value && typeof value === 'object') {\n        if (keyIsMotionContainer) {\n          const nested = value as Record<string, unknown>;\n          for (const [nestedRawKey, nestedValue] of Object.entries(nested)) {\n            const nestedRaw = String(nestedRawKey ?? '');\n            const nestedTrimmed = nestedRaw.trim();\n            const nestedKey = nestedTrimmed || (nestedRaw === '' ? '' : '');\n            if (!nestedKey && nestedRaw !== '') continue;\n            if (!Array.isArray(nestedValue)) continue;\n            const nestedCount = countMotionDefinitions(nestedValue);\n            if (nestedCount > 0) {\n              mergeGroupCount(groups, nestedKey, nestedCount);\n            }\n          }\n        }\n        visit(value, key, nextContext);\n      }\n    }\n  };\n\n  visit(raw, '', '');\n  return groups;\n}\n\nfunction pushMotionEntriesFromGroupContainer(entries: Live2DMotionEntry[], seen: Set<string>, container: unknown): void {\n  if (!container) return;\n\n  const pushFromList = (group: string, list: unknown[]) => {\n    const isKnownMotionDef = (def: unknown): boolean => {\n      if (typeof def === 'string') return String(def).trim().length > 0;\n      if (!def || typeof def !== 'object') return false;\n      const obj = def as any;\n      if (String(obj.File || obj.file || obj.Path || obj.path || '').trim()) return true;\n      if (String(obj.Name || obj.name || obj.Id || obj.id || '').trim()) return true;\n      return isMotionDefinition(def);\n    };\n\n    for (let i = 0; i < list.length; i++) {\n      const def = list[i];\n      if (!isKnownMotionDef(def)) continue;\n      const name = normalizeDefinitionName(def, `motion_${i + 1}`);\n      uniqueMotionPush(entries, seen, { group, index: i, name });\n    }\n  };\n\n  if (Array.isArray(container)) {\n    pushFromList('', container);\n    return;\n  }\n\n  if (typeof container !== 'object') return;\n\n  for (const [rawKey, value] of Object.entries(container as Record<string, unknown>)) {\n    const groupRaw = String(rawKey ?? '');\n    const groupTrimmed = groupRaw.trim();\n    if (!groupTrimmed && groupRaw !== '') continue;\n    const group = groupTrimmed || '';\n    if (!Array.isArray(value)) continue;\n    pushFromList(group, value);\n  }\n}\n\nexport function collectMotionEntries(model: any): Live2DMotionEntry[] {\n  const entries: Live2DMotionEntry[] = [];\n  const seen = new Set<string>();\n\n  const motionManager = model?.internalModel?.motionManager;\n  pushMotionEntriesFromGroupContainer(entries, seen, motionManager?.definitions);\n\n  const settingsCandidates = collectSettingsCandidates(model);\n  for (const settings of settingsCandidates) {\n    pushMotionEntriesFromGroupContainer(entries, seen, settings?.motions);\n    pushMotionEntriesFromGroupContainer(entries, seen, settings?.Motions);\n    pushMotionEntriesFromGroupContainer(entries, seen, settings?.FileReferences?.Motions);\n  }\n\n  return entries;\n}\n\nexport function collectExpressionNames(model: any): string[] {\n  const names: string[] = [];\n  const seen = new Set<string>();\n  const expressionManager = model?.internalModel?.motionManager?.expressionManager;\n\n  pushFromContainer(names, seen, expressionManager?.definitions, 'definition');\n  pushFromContainer(names, seen, expressionManager?.expressions, 'expression');\n  for (const name of collectExpressionNamesFromUnknown(expressionManager?.definitions)) {\n    uniquePush(names, seen, name);\n  }\n  for (const name of collectExpressionNamesFromUnknown(expressionManager?.expressions)) {\n    uniquePush(names, seen, name);\n  }\n\n  const settingsCandidates = collectSettingsCandidates(model);\n  for (const settings of settingsCandidates) {\n    pushFromContainer(names, seen, settings?.expressions, 'settings_expr');\n    pushFromContainer(names, seen, settings?.Expressions, 'settings_expr');\n    pushFromContainer(names, seen, settings?.FileReferences?.Expressions, 'file_ref_expr');\n    for (const name of collectExpressionNamesFromUnknown(settings)) {\n      uniquePush(names, seen, name);\n    }\n  }\n\n  const settings = model?.internalModel?.settings;\n  if (settings && typeof settings === 'object') {\n    if (typeof (settings as any).getExpressionCount === 'function') {\n      let count = 0;\n      try {\n        count = Number((settings as any).getExpressionCount()) || 0;\n      } catch {\n        // ignore\n      }\n      count = Math.max(0, Math.min(count, 1000));\n\n      for (let i = 0; i < count; i++) {\n        let name = '';\n        if (typeof (settings as any).getExpressionName === 'function') {\n          try {\n            name = String((settings as any).getExpressionName(i) ?? '').trim();\n          } catch {\n            // ignore\n          }\n        }\n        if (!name && typeof (settings as any).getExpressionFile === 'function') {\n          try {\n            name = normalizeFileStem((settings as any).getExpressionFile(i));\n          } catch {\n            // ignore\n          }\n        }\n        uniquePush(names, seen, name || `expression_${i + 1}`);\n      }\n    }\n  }\n\n  return names;\n}\n\nexport function collectMotionGroupNames(model: any): string[] {\n  const groupNames: string[] = [];\n  const seen = new Set<string>();\n  const motionManager = model?.internalModel?.motionManager;\n\n  const pushFromObject = (obj: unknown) => {\n    if (!obj || typeof obj !== 'object') return;\n    for (const key of Object.keys(obj as Record<string, unknown>)) {\n      uniquePushAllowEmpty(groupNames, seen, key);\n    }\n  };\n\n  pushFromObject(motionManager?.motionGroups);\n  pushFromObject(motionManager?.groups);\n  pushFromObject(motionManager?.definitions);\n  for (const [groupName] of Object.entries(collectMotionGroupCountsFromUnknown(motionManager?.definitions))) {\n    uniquePushAllowEmpty(groupNames, seen, groupName);\n  }\n\n  const settingsCandidates = collectSettingsCandidates(model);\n  for (const settings of settingsCandidates) {\n    pushFromObject(settings?.motions);\n    pushFromObject(settings?.Motions);\n    pushFromObject(settings?.FileReferences?.Motions);\n    for (const [groupName] of Object.entries(collectMotionGroupCountsFromUnknown(settings))) {\n      uniquePushAllowEmpty(groupNames, seen, groupName);\n    }\n  }\n\n  const settings = model?.internalModel?.settings;\n  if (settings && typeof settings === 'object') {\n    const anySettings = settings as any;\n    if (typeof anySettings.getMotionGroupCount === 'function' && typeof anySettings.getMotionGroupName === 'function') {\n      let count = 0;\n      try {\n        count = Number(anySettings.getMotionGroupCount()) || 0;\n      } catch {\n        // ignore\n      }\n      count = Math.max(0, Math.min(count, 1000));\n\n      for (let i = 0; i < count; i++) {\n        try {\n          uniquePushAllowEmpty(groupNames, seen, String(anySettings.getMotionGroupName(i) ?? ''));\n        } catch {\n          // ignore\n        }\n      }\n    } else if (typeof anySettings.getMotionGroupNames === 'function') {\n      try {\n        const names = anySettings.getMotionGroupNames();\n        if (Array.isArray(names)) {\n          for (const name of names) uniquePushAllowEmpty(groupNames, seen, name);\n        }\n      } catch {\n        // ignore\n      }\n    }\n  }\n\n  return groupNames;\n}\n\nexport function matchLive2DExpression(model: any, targetExpression: EmotionTag, override?: string): string | null {\n  const overrideName = String(override || '').trim();\n  if (overrideName) return overrideName;\n\n  const mapping = EXPRESSION_LIVE2D_MAP[targetExpression];\n  const candidates = mapping?.expressions || [String(targetExpression || '').toLowerCase()];\n\n  const definitions = collectExpressionNames(model);\n  if (!definitions.length) return null;\n\n  for (const candidateRaw of candidates) {\n    const candidate = String(candidateRaw || '').toLowerCase();\n    const exact = definitions.find((def) => String(def || '').toLowerCase() === candidate);\n    if (exact) return exact;\n  }\n\n  for (const candidateRaw of candidates) {\n    const candidate = String(candidateRaw || '').toLowerCase();\n    for (const def of definitions) {\n      const name = String(def || '').toLowerCase();\n      if (name.includes(candidate) || candidate.includes(name)) {\n        return def;\n      }\n    }\n  }\n\n  return null;\n}\n\nexport type Live2DMotionMatch = { group: string; index: number; name?: string };\n\nfunction normalizeMotionOverrideGroup(rawGroup: unknown): string {\n  const normalized = String(rawGroup ?? '').trim();\n  if (normalized === EMPTY_MOTION_GROUP_VALUE) return '';\n  return normalized;\n}\n\nexport function matchLive2DMotion(\n  model: any,\n  targetExpression: EmotionTag,\n  override?: EmotionMotionOverride,\n): Live2DMotionMatch | null {\n  if (override && override.enabled === false) return null;\n\n  const overrideGroupRaw = String(override?.group ?? '');\n  const hasEmptyGroupMarker = overrideGroupRaw.trim() === EMPTY_MOTION_GROUP_VALUE;\n  const overrideGroup = normalizeMotionOverrideGroup(override?.group);\n  const overrideIndexRaw = Number(override?.index);\n  const overrideIndex = Number.isFinite(overrideIndexRaw) ? Math.max(0, Math.floor(overrideIndexRaw)) : 0;\n  const hasExplicitOverride = hasEmptyGroupMarker || !!overrideGroup || overrideIndex > 0;\n  if (hasExplicitOverride) {\n    const entries = collectMotionEntries(model);\n    const groupNames = collectMotionGroupNames(model);\n    const lower = overrideGroup.toLowerCase();\n\n    const exactByGroupIndex = entries.find((e) => {\n      const groupLower = String(e.group || '').trim().toLowerCase();\n      return groupLower === lower && e.index === overrideIndex;\n    });\n    if (exactByGroupIndex) {\n      return { group: exactByGroupIndex.group, index: exactByGroupIndex.index, name: exactByGroupIndex.name };\n    }\n\n    const exactGroup = groupNames.find((name) => String(name || '').trim().toLowerCase() === lower);\n    if (exactGroup !== undefined) {\n      const exactInGroup = entries.find((e) => String(e.group || '').trim() === exactGroup && e.index === overrideIndex);\n      if (exactInGroup) {\n        return { group: exactInGroup.group, index: exactInGroup.index, name: exactInGroup.name };\n      }\n      const firstInGroup = entries.find((e) => String(e.group || '').trim() === exactGroup);\n      if (firstInGroup) {\n        return { group: firstInGroup.group, index: firstInGroup.index, name: firstInGroup.name };\n      }\n      return { group: exactGroup, index: overrideIndex };\n    }\n\n    if (lower) {\n      // group  motion name\n      const exactByName =\n        entries.find((e) => e.name.toLowerCase() === lower && e.index === overrideIndex) ||\n        entries.find((e) => e.name.toLowerCase() === lower);\n      if (exactByName) {\n        return { group: exactByName.group, index: exactByName.index, name: exactByName.name };\n      }\n\n      const fuzzyByName = entries.find((e) => {\n        const nameLower = e.name.toLowerCase();\n        return nameLower.includes(lower) || lower.includes(nameLower);\n      });\n      if (fuzzyByName) {\n        return { group: fuzzyByName.group, index: fuzzyByName.index, name: fuzzyByName.name };\n      }\n\n      const fuzzyGroup = groupNames.find((name) => {\n        const nameLower = String(name || '').trim().toLowerCase();\n        return !!nameLower && (nameLower.includes(lower) || lower.includes(nameLower));\n      });\n      if (fuzzyGroup !== undefined) {\n        const exactInGroup = entries.find(\n          (e) => String(e.group || '').trim() === fuzzyGroup && e.index === overrideIndex,\n        );\n        if (exactInGroup) {\n          return { group: exactInGroup.group, index: exactInGroup.index, name: exactInGroup.name };\n        }\n        const firstInGroup = entries.find((e) => String(e.group || '').trim() === fuzzyGroup);\n        if (firstInGroup) {\n          return { group: firstInGroup.group, index: firstInGroup.index, name: firstInGroup.name };\n        }\n        return { group: fuzzyGroup, index: overrideIndex };\n      }\n    }\n  }\n\n  const mapping = EXPRESSION_LIVE2D_MAP[targetExpression];\n  if (!mapping?.motions?.length) return null;\n\n  const groupNames = collectMotionGroupNames(model);\n  if (!groupNames.length) return null;\n\n  for (const candidateRaw of mapping.motions) {\n    const candidate = String(candidateRaw || '').trim().toLowerCase();\n    if (!candidate) continue;\n    const exact = groupNames.find((name) => String(name || '').trim().toLowerCase() === candidate);\n    if (exact) {\n      return { group: exact, index: 0 };\n    }\n  }\n\n  for (const candidateRaw of mapping.motions) {\n    const candidate = String(candidateRaw || '').toLowerCase();\n    if (!candidate) continue;\n    for (const groupName of groupNames) {\n      const nameLower = String(groupName || '').toLowerCase();\n      if (!nameLower) continue;\n      if (nameLower.includes(candidate) || candidate.includes(nameLower)) {\n        return { group: groupName, index: 0 };\n      }\n    }\n  }\n\n  const entries = collectMotionEntries(model);\n  if (!entries.length) return null;\n\n  for (const candidateRaw of mapping.motions) {\n    const candidate = String(candidateRaw || '').trim().toLowerCase();\n    if (!candidate) continue;\n    const exact = entries.find((e) => e.name.toLowerCase() === candidate);\n    if (exact) return { group: exact.group, index: exact.index, name: exact.name };\n  }\n\n  for (const candidateRaw of mapping.motions) {\n    const candidate = String(candidateRaw || '').trim().toLowerCase();\n    if (!candidate) continue;\n    const fuzzy = entries.find((e) => {\n      const nameLower = e.name.toLowerCase();\n      return nameLower.includes(candidate) || candidate.includes(nameLower);\n    });\n    if (fuzzy) return { group: fuzzy.group, index: fuzzy.index, name: fuzzy.name };\n  }\n\n  if (entries.length > 0) {\n    const first = entries[0];\n    return { group: first.group, index: first.index, name: first.name };\n  }\n\n  if (groupNames.length > 0) {\n    return { group: groupNames[0], index: 0 };\n  }\n\n  return null;\n}\n","import {\r\n  EIKANYA_CDN_BASE,\r\n  EIKANYA_RAW_BASE,\r\n  LIVE2D_CDN_BASE,\r\n  LOCAL_LIVE2D_MODEL_PATH_PREFIX,\r\n  LOCAL_LIVE2D_MODEL_SLOT_ID,\r\n  type Live2DRuntimeType,\r\n} from '../core/constants';\r\nimport { useSettingsStore } from '../core/settings';\nimport { error, log, warn } from '../utils/dom';\nimport { getLive2DModel, type StoredLive2DModel } from '../db/live2d-models';\r\nimport { Live2DLoader } from './loader';\r\nimport { LIVE2D_RUNTIME_TYPES, resolveLive2DRuntime, withResolvedLive2DRuntime } from './runtime-router';\nimport { Live2DStage } from './stage';\nimport {\n  collectExpressionNames,\n  collectExpressionNamesFromUnknown,\n  collectMotionEntries,\n  collectMotionGroupCountsFromUnknown,\n  collectMotionGroupNames,\n  type Live2DMotionEntry,\n} from './expression-motion';\n\nconst TICKER_REGISTERED_FLAG = '__desktopPetLive2dTickerV1';\n\nexport type ModelLoadProgress = {\n  percent: number;\n  message: string;\n};\n\r\n/**\n * Live2D \n * /\n */\nexport const Live2DManager = {\n  _JSDELIVR_HOSTS: [\n    'cdn.jsdelivr.net',\n    'fastly.jsdelivr.net',\n    'testingcf.jsdelivr.net',\n    'gcore.jsdelivr.net',\n  ],\n  _runtime: null as any,\n  _runtimeType: LIVE2D_RUNTIME_TYPES.LEGACY as Live2DRuntimeType,\n  _runtimeInfo: withResolvedLive2DRuntime({}),\n  _localBlobUrls: [] as string[],\n  _xhrBlobUrlSupport: null as boolean | null,\n  _xhrBlobUrlSupportPromise: null as Promise<boolean> | null,\n  _hasLoggedBlobUrlDisabled: false,\n  model: null as any,\n  isReady: false,\n  modelBaseWidth: null as number | null,\n  modelBaseHeight: null as number | null,\n  modelBaseBounds: null as { x: number; y: number; width: number; height: number } | null,\n  _lastModelJson: null as any,\n  _lastModelJsonSourceUrl: '' as string,\n  _autoMotionTimer: null as number | null,\n  autoMotionLoopEnabled: true,\n  _mouthParamCore: null as any,\n  _mouthParamIds: [] as string[],\n  _mouthParamIndexes: [] as number[],\n  _mouthParamRangeMins: [] as number[],\r\n  _mouthParamRangeMaxs: [] as number[],\r\n  _mouthParamWarned: false,\r\n  _mouthCurrentValue: 0,\r\n  _lipSyncActive: false,\r\n  _inModelUpdate: false,\r\n  _writeMaskCore: null as any,\r\n  _writeMaskRestore: null as (() => void) | null,\r\n  _updateHookModel: null as any,\r\n  _updateHookRestore: null as (() => void) | null,\r\n  _manualMouthParamEnabled: false,\r\n  _manualMouthParamIds: [] as string[],\r\n  _manualMouthParamIdSet: new Set<string>(),\r\n\r\n  /**  */\n  _top(): Window {\n    return window.parent ?? window;\n  },\n\n  /**  PIXI  */\r\n  _getPIXI(): any {\r\n    const runtimePixi = Live2DLoader.getPixi(this._top());\r\n    if (runtimePixi) return runtimePixi;\r\n    return this._runtime?.pixi ?? null;\r\n  },\r\n\r\n  _setRuntimeInfo(runtimeInfo: Record<string, any> | null): {\n    runtimeType: Live2DRuntimeType;\n    cubismVersion: number | null;\n    moc3Version?: number | null;\n  } {\n    const resolved = withResolvedLive2DRuntime(runtimeInfo || {});\n    this._runtimeInfo = resolved;\n    this._runtimeType = resolved.runtimeType;\n    return resolved;\n  },\n\n  _registerLocalBlobUrl(url: string): void {\n    const value = String(url || '').trim();\n    if (!value) return;\n    if (!this._localBlobUrls.includes(value)) {\n      this._localBlobUrls.push(value);\n    }\n  },\n\n  _revokeLocalBlobUrls(): void {\n    if (!Array.isArray(this._localBlobUrls) || this._localBlobUrls.length === 0) {\n      this._localBlobUrls = [];\n      return;\n    }\n\n    const top = this._top() as any;\n    const topURL = top?.URL || URL;\n    for (const url of this._localBlobUrls) {\n      try {\n        topURL.revokeObjectURL(url);\n      } catch {\n        // ignore\n      }\n    }\n    this._localBlobUrls = [];\n  },\n\n  _disableXhrBlobUrls(reason: string): void {\n    this._xhrBlobUrlSupport = false;\n    this._xhrBlobUrlSupportPromise = null;\n    if (!this._hasLoggedBlobUrlDisabled) {\n      this._hasLoggedBlobUrlDisabled = true;\n      warn(` Live2D XHR  blob URL Data URL${reason}`);\n    }\n  },\n\n  async _supportsXhrBlobUrls(): Promise<boolean> {\n    if (this._xhrBlobUrlSupport === true || this._xhrBlobUrlSupport === false) {\n      return this._xhrBlobUrlSupport;\n    }\n    if (this._xhrBlobUrlSupportPromise) {\n      return await this._xhrBlobUrlSupportPromise;\n    }\n\n    this._xhrBlobUrlSupportPromise = (async () => {\n      try {\n        const top = this._top() as any;\n        const topURL = top?.URL || URL;\n        const XHR = top?.XMLHttpRequest;\n        if (!topURL?.createObjectURL || !topURL?.revokeObjectURL || typeof XHR !== 'function') {\n          return false;\n        }\n\n        const payload = new Uint8Array([1, 2, 3, 4]);\n        const blob = new Blob([payload], { type: 'application/octet-stream' });\n        const blobUrl = topURL.createObjectURL(blob);\n\n        const ok = await new Promise<boolean>((resolve) => {\n          let done = false;\n          const finish = (value: boolean) => {\n            if (done) return;\n            done = true;\n            resolve(value);\n          };\n\n          try {\n            const xhr = new XHR();\n            xhr.open('GET', blobUrl, true);\n            xhr.responseType = 'arraybuffer';\n            xhr.timeout = 1500;\n            xhr.onload = () => {\n              const buf = xhr.response;\n              finish(!!buf && buf.byteLength === payload.byteLength);\n            };\n            xhr.onerror = () => finish(false);\n            xhr.onabort = () => finish(false);\n            xhr.ontimeout = () => finish(false);\n            xhr.send();\n          } catch {\n            finish(false);\n          }\n        });\n\n        try {\n          topURL.revokeObjectURL(blobUrl);\n        } catch {\n          // ignore\n        }\n        return ok;\n      } catch {\n        return false;\n      }\n    })().finally(() => {\n      this._xhrBlobUrlSupportPromise = null;\n    });\n\n    const supported = await this._xhrBlobUrlSupportPromise;\n    this._xhrBlobUrlSupport = supported;\n    if (!supported) {\n      this._disableXhrBlobUrls('xhr-probe-failed');\n    }\n    return supported;\n  },\n\n  _isLocalModelPath(path: string): boolean {\n    return String(path || '').trim().toLowerCase().startsWith(LOCAL_LIVE2D_MODEL_PATH_PREFIX.toLowerCase());\n  },\n\n  _normalizeLocalModelId(_path: string): string {\n    return LOCAL_LIVE2D_MODEL_SLOT_ID;\n  },\n\n  _toArrayBuffer(input: unknown): ArrayBuffer | null {\n    if (!input) return null;\n    if (input instanceof ArrayBuffer) return input;\n    if (ArrayBuffer.isView(input)) {\n      return input.buffer.slice(input.byteOffset, input.byteOffset + input.byteLength);\n    }\n    return null;\n  },\n\n  _normalizeMocVersion(rawMocVersion: unknown): number | null {\n    const value = Number(rawMocVersion || 0);\n    if (!Number.isFinite(value)) return null;\n    if (value >= 5) return 5;\n    if (value >= 1 && value <= 4) return 4;\n    return null;\n  },\n\n  _readMoc3HeaderVersion(moc3Data: unknown): number | null {\n    const moc3Buffer = this._toArrayBuffer(moc3Data);\n    if (!moc3Buffer || moc3Buffer.byteLength < 8) return null;\n\n    try {\n      const header = new Uint8Array(moc3Buffer, 0, 4);\n      const signature = String.fromCharCode(...header);\n      if (signature !== 'MOC3') return null;\n      const view = new DataView(moc3Buffer);\n      return Number(view.getUint32(4, true) || 0) || null;\n    } catch {\n      return null;\n    }\n  },\n\n  _detectCubismVersionFromMoc3Buffer(moc3Data: unknown): number | null {\n    const moc3Buffer = this._toArrayBuffer(moc3Data);\n    if (!moc3Buffer) return null;\n\n    const top = this._top() as any;\n    const core = top?.Live2DCubismCore;\n    const Moc = core?.Moc;\n    const Version = core?.Version;\n    if (typeof Moc?.fromArrayBuffer !== 'function' || typeof Version?.csmGetMocVersion !== 'function') {\n      return null;\n    }\n\n    let mocRef: any = null;\n    try {\n      mocRef = Moc.fromArrayBuffer(moc3Buffer);\n      if (!mocRef) return null;\n\n      const rawMocVersion = Number(Version.csmGetMocVersion(mocRef, moc3Buffer) || 0) || 0;\n      const latestMocVersion = Number(Version?.csmGetLatestMocVersion?.() || 0) || 0;\n      const normalized = this._normalizeMocVersion(rawMocVersion);\n      if (latestMocVersion > 0 && rawMocVersion > latestMocVersion) {\n        return null;\n      }\n      return normalized;\n    } catch {\n      return null;\n    } finally {\n      try {\n        if (mocRef && typeof mocRef._release === 'function') {\n          mocRef._release();\n        } else if (mocRef && typeof mocRef.release === 'function') {\n          mocRef.release();\n        }\n      } catch {\n        // ignore\n      }\n    }\n  },\n\n  async _detectRuntimeFromMoc3(\n    moc3Data: unknown,\n    runtimeInfo: Record<string, any> | null = null,\n  ): Promise<{\n    runtimeType: Live2DRuntimeType;\n    cubismVersion: number | null;\n    moc3Version?: number | null;\n  }> {\n    const resolvedRuntime = resolveLive2DRuntime(runtimeInfo || this._runtimeInfo || null);\n    const moc3Buffer = this._toArrayBuffer(moc3Data);\n    if (!moc3Buffer) {\n      return this._setRuntimeInfo(resolvedRuntime);\n    }\n\n    const headerVersionRaw = this._readMoc3HeaderVersion(moc3Buffer);\n    const headerVersion = this._normalizeMocVersion(headerVersionRaw);\n    const runtimeWithHeader = {\n      ...resolvedRuntime,\n      moc3Version: headerVersionRaw ?? null,\n    };\n\n    try {\n      const requiredLatestVersion = headerVersionRaw && headerVersionRaw >= 5 ? headerVersionRaw : 5;\n      await Live2DLoader.ensureCubism5Core(requiredLatestVersion);\n    } catch {\n      // ignore\n    }\n\n    const mocVersion = this._detectCubismVersionFromMoc3Buffer(moc3Buffer);\n    const resolvedVersion = mocVersion ?? headerVersion ?? runtimeWithHeader.cubismVersion ?? null;\n    return this._setRuntimeInfo({\n      ...runtimeWithHeader,\n      cubismVersion: resolvedVersion,\n    });\n  },\n\n  _isCoreParseError(err: unknown): boolean {\n    const message = String((err as any)?.message || err || '');\n    const stack = String((err as any)?.stack || '');\n    return /unknown error/i.test(message) || /createcoremodel/i.test(stack) || /be\\.create/i.test(stack);\n  },\n\n  async _ensureRuntimeDependencies(\n    runtimeInfo: Record<string, any> | null,\n    contextLabel: string,\n  ): Promise<{\n    runtimeType: Live2DRuntimeType;\n    cubismVersion: number | null;\n    moc3Version?: number | null;\n  }> {\n    const resolvedRuntime = this._setRuntimeInfo(runtimeInfo || null);\n    const requiredMocVersion = Number((resolvedRuntime as any)?.moc3Version || 0) || 0;\n    const requiredLatestVersion = requiredMocVersion >= 5 ? requiredMocVersion : 5;\n\n    if (resolvedRuntime.runtimeType === LIVE2D_RUNTIME_TYPES.CUBISM5) {\n      const coreLoaded = await Live2DLoader.ensureCubism5Core(requiredLatestVersion);\n      if (!coreLoaded) {\n        throw new Error(`Cubism5 Core ${contextLabel}`);\n      }\n      const runtimeLoaded = await Live2DLoader.ensureCubism5Runtime();\n      if (!runtimeLoaded) {\n        throw new Error(`Cubism5 runtime ${contextLabel}`);\n      }\n      Live2DLoader.activateRuntime(LIVE2D_RUNTIME_TYPES.CUBISM5);\n      this._setRuntimeInfo(resolvedRuntime);\n      return resolvedRuntime;\n    }\n\n    if (requiredMocVersion >= 5) {\n      const coreLoaded = await Live2DLoader.ensureCubism5Core(requiredLatestVersion);\n      if (!coreLoaded) {\n        throw new Error(`Cubism5 Core legacy+core5${contextLabel}`);\n      }\n      Live2DLoader.activateRuntime(LIVE2D_RUNTIME_TYPES.LEGACY);\n      const patched = this._setRuntimeInfo({\n        ...resolvedRuntime,\n        runtimeType: LIVE2D_RUNTIME_TYPES.LEGACY,\n        cubismVersion: resolvedRuntime.cubismVersion ?? 5,\n      });\n      log('legacy runtime + Cubism5 core ', {\n        context: contextLabel,\n        runtimeType: patched.runtimeType,\n        cubismVersion: patched.cubismVersion,\n        moc3Version: (patched as any).moc3Version ?? null,\n      });\n      return patched;\n    }\n\n    const legacyLoaded = await Live2DLoader.ensureLegacyCore();\n    if (!legacyLoaded) {\n      const top = this._top() as any;\n      const latestMocVersion = Number(top?.Live2DCubismCore?.Version?.csmGetLatestMocVersion?.() || 0) || 0;\n      if (latestMocVersion >= 5) {\n        const fallbackRuntime = this._setRuntimeInfo({\n          ...resolvedRuntime,\n          runtimeType: LIVE2D_RUNTIME_TYPES.CUBISM5,\n          cubismVersion: 5,\n        });\n        const coreLoaded = await Live2DLoader.ensureCubism5Core(requiredLatestVersion);\n        if (!coreLoaded) {\n          throw new Error(`Cubism5 Core ${contextLabel}`);\n        }\n        const runtimeLoaded = await Live2DLoader.ensureCubism5Runtime();\n        if (!runtimeLoaded) {\n          throw new Error(`Cubism5 runtime ${contextLabel}`);\n        }\n        Live2DLoader.activateRuntime(LIVE2D_RUNTIME_TYPES.CUBISM5);\n        return fallbackRuntime;\n      }\n      throw new Error(`legacy Core ${contextLabel}`);\n    }\n\n    Live2DLoader.activateRuntime(LIVE2D_RUNTIME_TYPES.LEGACY);\n    this._setRuntimeInfo(resolvedRuntime);\n    return resolvedRuntime;\n  },\n\n  _getLive2DModelClass(runtimeType: Live2DRuntimeType): any {\n    const top = this._top() as any;\n    const namespace = Live2DLoader.getRuntimeNamespace(runtimeType) || top?.PIXI?.live2d;\n    return namespace?.Live2DModel || null;\n  },\n\n  _registerTickerForRuntime(Live2DModel: any, PIXI: any): void {\n    if (!Live2DModel || !PIXI || typeof Live2DModel.registerTicker !== 'function') {\n      return;\n    }\n    const lastRegisteredTicker = (Live2DModel as any)[TICKER_REGISTERED_FLAG] as unknown;\n    if (lastRegisteredTicker !== PIXI.Ticker) {\n      Live2DModel.registerTicker(PIXI.Ticker);\n      (Live2DModel as any)[TICKER_REGISTERED_FLAG] = PIXI.Ticker;\n      log('Live2D ticker ');\n    }\n  },\n\n  _blobToDataUrl(blob: Blob): Promise<string> {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = () => resolve(String(reader.result || ''));\n      reader.onerror = () => reject(reader.error || new Error('Blob  DataURL '));\n      reader.readAsDataURL(blob);\n    });\n  },\n\n  _normalizeStoredPath(path: unknown): string {\n    return String(path || '')\n      .replace(/\\\\/g, '/')\n      .trim();\n  },\n\n  _getPathBaseName(path: unknown): string {\n    const normalized = this._normalizeStoredPath(path);\n    const lastSlash = normalized.lastIndexOf('/');\n    return lastSlash >= 0 ? normalized.slice(lastSlash + 1) : normalized;\n  },\n\n  _guessMimeTypeByPath(path: unknown, fallback = 'application/octet-stream'): string {\n    const lower = this._normalizeStoredPath(path).toLowerCase();\n    if (lower.endsWith('.png')) return 'image/png';\n    if (lower.endsWith('.webp')) return 'image/webp';\n    if (lower.endsWith('.jpg') || lower.endsWith('.jpeg')) return 'image/jpeg';\n    if (lower.endsWith('.json') || lower.endsWith('.model3.json') || lower.endsWith('.model.json')) {\n      return 'application/json';\n    }\n    if (lower.endsWith('.moc') || lower.endsWith('.moc3')) return 'application/octet-stream';\n    return fallback;\n  },\n\n  _findStoredTextureBlob(modelData: StoredLive2DModel, targetPath: unknown, index = -1): Blob | null {\n    const textures = Array.isArray(modelData?.textures) ? modelData.textures : [];\n    if (!textures.length) return null;\n\n    const normalizedTarget = this._normalizeStoredPath(targetPath);\n    const targetBaseName = this._getPathBaseName(normalizedTarget);\n\n    const exact = textures.find((item) => this._normalizeStoredPath(item?.name) === normalizedTarget);\n    if (exact?.data instanceof Blob) return exact.data;\n\n    const byBase = textures.find((item) => this._getPathBaseName(item?.name) === targetBaseName);\n    if (byBase?.data instanceof Blob) return byBase.data;\n\n    const indexed = index >= 0 ? textures[index] : null;\n    if (indexed?.data instanceof Blob) return indexed.data;\n\n    return null;\n  },\n\n  _findStoredMotionData(\n    modelData: StoredLive2DModel,\n    groupName: string,\n    targetPath: unknown,\n    index = -1,\n  ): ArrayBuffer | null {\n    const motions = modelData?.motions && typeof modelData.motions === 'object' ? modelData.motions : {};\n    const targetNormalized = this._normalizeStoredPath(targetPath);\n    const targetBaseName = this._getPathBaseName(targetNormalized);\n    const targetGroup = String(groupName || '');\n\n    const groupList = Array.isArray((motions as any)?.[targetGroup]) ? (motions as any)[targetGroup] : [];\n    const exact = groupList.find((item: any) => this._normalizeStoredPath(item?.name) === targetNormalized);\n    if (exact?.data instanceof ArrayBuffer) return exact.data;\n\n    const byBase = groupList.find((item: any) => this._getPathBaseName(item?.name) === targetBaseName);\n    if (byBase?.data instanceof ArrayBuffer) return byBase.data;\n\n    const indexed = index >= 0 ? groupList[index] : null;\n    if (indexed?.data instanceof ArrayBuffer) return indexed.data;\n\n    for (const value of Object.values(motions)) {\n      const list = Array.isArray(value) ? value : [];\n      const crossExact = list.find((item: any) => this._normalizeStoredPath(item?.name) === targetNormalized);\n      if (crossExact?.data instanceof ArrayBuffer) return crossExact.data;\n      const crossByBase = list.find((item: any) => this._getPathBaseName(item?.name) === targetBaseName);\n      if (crossByBase?.data instanceof ArrayBuffer) return crossByBase.data;\n    }\n\n    return null;\n  },\n\n  _findStoredExpressionData(modelData: StoredLive2DModel, targetPath: unknown, index = -1): ArrayBuffer | null {\n    const expressions = Array.isArray(modelData?.expressions) ? modelData.expressions : [];\n    if (!expressions.length) return null;\n\n    const targetNormalized = this._normalizeStoredPath(targetPath);\n    const targetBaseName = this._getPathBaseName(targetNormalized);\n\n    const exact = expressions.find((item) => this._normalizeStoredPath(item?.file || item?.name) === targetNormalized);\n    if (exact?.data instanceof ArrayBuffer) return exact.data;\n\n    const byBase = expressions.find((item) => this._getPathBaseName(item?.file || item?.name) === targetBaseName);\n    if (byBase?.data instanceof ArrayBuffer) return byBase.data;\n\n    const indexed = index >= 0 ? expressions[index] : null;\n    if (indexed?.data instanceof ArrayBuffer) return indexed.data;\n\n    return null;\n  },\n\n  _toLocalBlobUrl(payload: Blob | ArrayBuffer, mimeType = 'application/octet-stream'): string {\n    const top = this._top() as any;\n    const topURL = top?.URL || URL;\n    const blob = payload instanceof Blob ? payload : new Blob([payload], { type: mimeType });\n    const url = topURL.createObjectURL(blob);\n    this._registerLocalBlobUrl(url);\n    return url;\n  },\n\n  async _toLocalDataUrl(payload: Blob | ArrayBuffer, mimeType = 'application/octet-stream'): Promise<string> {\n    const blob = payload instanceof Blob ? payload : new Blob([payload], { type: mimeType });\n    return await this._blobToDataUrl(blob);\n  },\n\n  async _buildLocalModelBlobUrl(modelData: StoredLive2DModel): Promise<string> {\n    const modifiedModelJson = JSON.parse(JSON.stringify(modelData?.modelJson || {}));\n    this._normalizeLegacyCubism2Settings(modifiedModelJson);\n\n    const mapFile = (\n      payload: Blob | ArrayBuffer | null,\n      pathHint: unknown,\n      fallbackMime = 'application/octet-stream',\n    ): string | null => {\n      if (!payload) return null;\n      const mimeType =\n        payload instanceof Blob ? payload.type || this._guessMimeTypeByPath(pathHint, fallbackMime) : this._guessMimeTypeByPath(pathHint, fallbackMime);\n      return this._toLocalBlobUrl(payload, mimeType || fallbackMime);\n    };\n\n    const isModel3 = !!modifiedModelJson?.FileReferences;\n    if (isModel3) {\n      const refs = modifiedModelJson.FileReferences;\n      if (refs && typeof refs === 'object') {\n        const mocUrl = mapFile(modelData?.moc3 ?? null, refs.Moc, 'application/octet-stream');\n        if (mocUrl) refs.Moc = mocUrl;\n\n        if (Array.isArray(refs.Textures)) {\n          refs.Textures = refs.Textures.map((texPath: unknown, index: number) => {\n            const textureBlob = this._findStoredTextureBlob(modelData, texPath, index);\n            return mapFile(textureBlob, texPath, 'image/png') || texPath;\n          });\n        }\n\n        const physicsUrl = mapFile(modelData?.physics ?? null, refs.Physics, 'application/json');\n        if (physicsUrl && typeof refs.Physics === 'string') refs.Physics = physicsUrl;\n        const poseUrl = mapFile(modelData?.pose ?? null, refs.Pose, 'application/json');\n        if (poseUrl && typeof refs.Pose === 'string') refs.Pose = poseUrl;\n\n        if (!refs.Motions || typeof refs.Motions !== 'object') {\n          refs.Motions = {};\n        }\n        if (modelData?.motions && typeof modelData.motions === 'object') {\n          for (const [groupName, motionListRaw] of Object.entries(modelData.motions)) {\n            const motionList = Array.isArray(motionListRaw) ? motionListRaw : [];\n            if (!Array.isArray((refs as any).Motions[groupName])) {\n              (refs as any).Motions[groupName] = [];\n            }\n            const targetList = (refs as any).Motions[groupName] as any[];\n\n            for (let index = 0; index < motionList.length; index++) {\n              const storedMotion = motionList[index];\n              const existingDef = targetList[index];\n              const motionPath =\n                (existingDef && typeof existingDef === 'object'\n                  ? (existingDef as any).File || (existingDef as any).file\n                  : existingDef) ||\n                storedMotion?.name;\n              const motionData =\n                this._findStoredMotionData(modelData, groupName, motionPath, index) ?? storedMotion?.data ?? null;\n              const motionUrl = mapFile(motionData, motionPath || storedMotion?.name, 'application/json');\n              if (!motionUrl) continue;\n\n              if (existingDef && typeof existingDef === 'object') {\n                if (typeof (existingDef as any).File === 'string') (existingDef as any).File = motionUrl;\n                else (existingDef as any).file = motionUrl;\n                const existingName = String((existingDef as any).Name || (existingDef as any).name || '').trim();\n                if (!existingName) {\n                  (existingDef as any).Name = this._getPathBaseName(motionPath || storedMotion?.name);\n                }\n              } else if (typeof existingDef === 'string') {\n                targetList[index] = motionUrl;\n              } else {\n                targetList.push({\n                  Name: this._getPathBaseName(storedMotion?.name || motionPath || `motion_${index + 1}`),\n                  File: motionUrl,\n                });\n              }\n            }\n          }\n        }\n\n        if (!Array.isArray(refs.Expressions)) {\n          refs.Expressions = [];\n        }\n        if (Array.isArray(modelData?.expressions)) {\n          for (let index = 0; index < modelData.expressions.length; index++) {\n            const storedExpr = modelData.expressions[index];\n            const existingDef = refs.Expressions[index];\n            const exprPath =\n              (existingDef && typeof existingDef === 'object'\n                ? (existingDef as any).File || (existingDef as any).file\n                : existingDef) ||\n              storedExpr?.file ||\n              storedExpr?.name;\n            const exprData =\n              this._findStoredExpressionData(modelData, exprPath, index) ?? storedExpr?.data ?? null;\n            const exprUrl = mapFile(exprData, exprPath || storedExpr?.name, 'application/json');\n            if (!exprUrl) continue;\n\n            if (existingDef && typeof existingDef === 'object') {\n              if (typeof (existingDef as any).File === 'string') (existingDef as any).File = exprUrl;\n              else (existingDef as any).file = exprUrl;\n              const existingName = String((existingDef as any).Name || (existingDef as any).name || '').trim();\n              if (!existingName) {\n                (existingDef as any).Name = this._getPathBaseName(storedExpr?.name || exprPath);\n              }\n            } else if (typeof existingDef === 'string') {\n              refs.Expressions[index] = exprUrl;\n            } else {\n              refs.Expressions.push({\n                Name: this._getPathBaseName(storedExpr?.name || exprPath || `expression_${index + 1}`),\n                File: exprUrl,\n              });\n            }\n          }\n        }\n      }\n    } else {\n      const mocPath = modifiedModelJson.model || modifiedModelJson.Model;\n      const mocUrl = mapFile(modelData?.moc ?? null, mocPath, 'application/octet-stream');\n      if (mocUrl) {\n        if (typeof modifiedModelJson.model === 'string') modifiedModelJson.model = mocUrl;\n        else if (typeof modifiedModelJson.Model === 'string') modifiedModelJson.Model = mocUrl;\n        else modifiedModelJson.model = mocUrl;\n      }\n\n      const textureList = modifiedModelJson.textures || modifiedModelJson.Textures;\n      if (Array.isArray(textureList)) {\n        for (let index = 0; index < textureList.length; index++) {\n          const texturePath = textureList[index];\n          const textureBlob = this._findStoredTextureBlob(modelData, texturePath, index);\n          const textureUrl = mapFile(textureBlob, texturePath, 'image/png');\n          if (textureUrl) textureList[index] = textureUrl;\n        }\n      }\n\n      const physicsPath = modifiedModelJson.physics || modifiedModelJson.Physics;\n      const physicsUrl = mapFile(modelData?.physics ?? null, physicsPath, 'application/json');\n      if (physicsUrl) {\n        if (typeof modifiedModelJson.physics === 'string') modifiedModelJson.physics = physicsUrl;\n        if (typeof modifiedModelJson.Physics === 'string') modifiedModelJson.Physics = physicsUrl;\n      }\n\n      const posePath = modifiedModelJson.pose || modifiedModelJson.Pose;\n      const poseUrl = mapFile(modelData?.pose ?? null, posePath, 'application/json');\n      if (poseUrl) {\n        if (typeof modifiedModelJson.pose === 'string') modifiedModelJson.pose = poseUrl;\n        if (typeof modifiedModelJson.Pose === 'string') modifiedModelJson.Pose = poseUrl;\n      }\n\n      const motions = modifiedModelJson.motions || modifiedModelJson.Motions;\n      if (motions && typeof motions === 'object') {\n        for (const groupName of Object.keys(motions)) {\n          const motionList = motions[groupName];\n          if (!Array.isArray(motionList)) continue;\n          for (let index = 0; index < motionList.length; index++) {\n            const motionDef = motionList[index];\n            const motionPath =\n              typeof motionDef === 'string' ? motionDef : (motionDef as any)?.file || (motionDef as any)?.File;\n            const motionData = this._findStoredMotionData(modelData, groupName, motionPath, index);\n            const motionUrl = mapFile(motionData, motionPath, 'application/octet-stream');\n            if (!motionUrl) continue;\n\n            if (typeof motionDef === 'string') {\n              motionList[index] = motionUrl;\n            } else if (typeof (motionDef as any).file === 'string') {\n              (motionDef as any).file = motionUrl;\n            } else {\n              (motionDef as any).File = motionUrl;\n            }\n          }\n        }\n      }\n\n      const expressions = modifiedModelJson.expressions || modifiedModelJson.Expressions;\n      if (Array.isArray(expressions)) {\n        for (let index = 0; index < expressions.length; index++) {\n          const exprDef = expressions[index];\n          const exprPath = typeof exprDef === 'string' ? exprDef : (exprDef as any)?.file || (exprDef as any)?.File;\n          const exprData = this._findStoredExpressionData(modelData, exprPath, index);\n          const exprUrl = mapFile(exprData, exprPath, 'application/json');\n          if (!exprUrl) continue;\n\n          if (typeof exprDef === 'string') {\n            expressions[index] = exprUrl;\n          } else if (typeof (exprDef as any).file === 'string') {\n            (exprDef as any).file = exprUrl;\n          } else {\n            (exprDef as any).File = exprUrl;\n          }\n        }\n      }\n    }\n\n    this._lastModelJson = JSON.parse(JSON.stringify(modifiedModelJson));\n\n    const modelBlob = new Blob([JSON.stringify(modifiedModelJson)], { type: 'application/json' });\n    return this._toLocalBlobUrl(modelBlob, 'application/json');\n  },\n\n  async _buildLocalModelDataUrl(modelData: StoredLive2DModel): Promise<string> {\n    const modifiedModelJson = JSON.parse(JSON.stringify(modelData?.modelJson || {}));\n    this._normalizeLegacyCubism2Settings(modifiedModelJson);\n\n    const mapFile = async (\n      payload: Blob | ArrayBuffer | null,\n      pathHint: unknown,\n      fallbackMime = 'application/octet-stream',\n    ): Promise<string | null> => {\n      if (!payload) return null;\n      const mimeType =\n        payload instanceof Blob ? payload.type || this._guessMimeTypeByPath(pathHint, fallbackMime) : this._guessMimeTypeByPath(pathHint, fallbackMime);\n      return await this._toLocalDataUrl(payload, mimeType || fallbackMime);\n    };\n\n    const isModel3 = !!modifiedModelJson?.FileReferences;\n    if (isModel3) {\n      const refs = modifiedModelJson.FileReferences;\n      if (refs && typeof refs === 'object') {\n        const mocUrl = await mapFile(modelData?.moc3 ?? null, refs.Moc, 'application/octet-stream');\n        if (mocUrl) refs.Moc = mocUrl;\n\n        if (Array.isArray(refs.Textures)) {\n          for (let index = 0; index < refs.Textures.length; index++) {\n            const texturePath = refs.Textures[index];\n            const textureBlob = this._findStoredTextureBlob(modelData, texturePath, index);\n            const textureUrl = await mapFile(textureBlob, texturePath, 'image/png');\n            if (textureUrl) refs.Textures[index] = textureUrl;\n          }\n        }\n\n        const physicsUrl = await mapFile(modelData?.physics ?? null, refs.Physics, 'application/json');\n        if (physicsUrl && typeof refs.Physics === 'string') refs.Physics = physicsUrl;\n        const poseUrl = await mapFile(modelData?.pose ?? null, refs.Pose, 'application/json');\n        if (poseUrl && typeof refs.Pose === 'string') refs.Pose = poseUrl;\n\n        if (!refs.Motions || typeof refs.Motions !== 'object') {\n          refs.Motions = {};\n        }\n        if (modelData?.motions && typeof modelData.motions === 'object') {\n          for (const [groupName, motionListRaw] of Object.entries(modelData.motions)) {\n            const motionList = Array.isArray(motionListRaw) ? motionListRaw : [];\n            if (!Array.isArray((refs as any).Motions[groupName])) {\n              (refs as any).Motions[groupName] = [];\n            }\n            const targetList = (refs as any).Motions[groupName] as any[];\n\n            for (let index = 0; index < motionList.length; index++) {\n              const storedMotion = motionList[index];\n              const existingDef = targetList[index];\n              const motionPath =\n                (existingDef && typeof existingDef === 'object'\n                  ? (existingDef as any).File || (existingDef as any).file\n                  : existingDef) ||\n                storedMotion?.name;\n              const motionData =\n                this._findStoredMotionData(modelData, groupName, motionPath, index) ?? storedMotion?.data ?? null;\n              const motionUrl = await mapFile(motionData, motionPath || storedMotion?.name, 'application/json');\n              if (!motionUrl) continue;\n\n              if (existingDef && typeof existingDef === 'object') {\n                if (typeof (existingDef as any).File === 'string') (existingDef as any).File = motionUrl;\n                else (existingDef as any).file = motionUrl;\n                const existingName = String((existingDef as any).Name || (existingDef as any).name || '').trim();\n                if (!existingName) {\n                  (existingDef as any).Name = this._getPathBaseName(motionPath || storedMotion?.name);\n                }\n              } else if (typeof existingDef === 'string') {\n                targetList[index] = motionUrl;\n              } else {\n                targetList.push({\n                  Name: this._getPathBaseName(storedMotion?.name || motionPath || `motion_${index + 1}`),\n                  File: motionUrl,\n                });\n              }\n            }\n          }\n        }\n\n        if (!Array.isArray(refs.Expressions)) {\n          refs.Expressions = [];\n        }\n        if (Array.isArray(modelData?.expressions)) {\n          for (let index = 0; index < modelData.expressions.length; index++) {\n            const storedExpr = modelData.expressions[index];\n            const existingDef = refs.Expressions[index];\n            const exprPath =\n              (existingDef && typeof existingDef === 'object'\n                ? (existingDef as any).File || (existingDef as any).file\n                : existingDef) ||\n              storedExpr?.file ||\n              storedExpr?.name;\n            const exprData =\n              this._findStoredExpressionData(modelData, exprPath, index) ?? storedExpr?.data ?? null;\n            const exprUrl = await mapFile(exprData, exprPath || storedExpr?.name, 'application/json');\n            if (!exprUrl) continue;\n\n            if (existingDef && typeof existingDef === 'object') {\n              if (typeof (existingDef as any).File === 'string') (existingDef as any).File = exprUrl;\n              else (existingDef as any).file = exprUrl;\n              const existingName = String((existingDef as any).Name || (existingDef as any).name || '').trim();\n              if (!existingName) {\n                (existingDef as any).Name = this._getPathBaseName(storedExpr?.name || exprPath);\n              }\n            } else if (typeof existingDef === 'string') {\n              refs.Expressions[index] = exprUrl;\n            } else {\n              refs.Expressions.push({\n                Name: this._getPathBaseName(storedExpr?.name || exprPath || `expression_${index + 1}`),\n                File: exprUrl,\n              });\n            }\n          }\n        }\n      }\n    } else {\n      const mocPath = modifiedModelJson.model || modifiedModelJson.Model;\n      const mocUrl = await mapFile(modelData?.moc ?? null, mocPath, 'application/octet-stream');\n      if (mocUrl) {\n        if (typeof modifiedModelJson.model === 'string') modifiedModelJson.model = mocUrl;\n        else if (typeof modifiedModelJson.Model === 'string') modifiedModelJson.Model = mocUrl;\n        else modifiedModelJson.model = mocUrl;\n      }\n\n      const textureList = modifiedModelJson.textures || modifiedModelJson.Textures;\n      if (Array.isArray(textureList)) {\n        for (let index = 0; index < textureList.length; index++) {\n          const texturePath = textureList[index];\n          const textureBlob = this._findStoredTextureBlob(modelData, texturePath, index);\n          const textureUrl = await mapFile(textureBlob, texturePath, 'image/png');\n          if (textureUrl) textureList[index] = textureUrl;\n        }\n      }\n\n      const physicsPath = modifiedModelJson.physics || modifiedModelJson.Physics;\n      const physicsUrl = await mapFile(modelData?.physics ?? null, physicsPath, 'application/json');\n      if (physicsUrl) {\n        if (typeof modifiedModelJson.physics === 'string') modifiedModelJson.physics = physicsUrl;\n        if (typeof modifiedModelJson.Physics === 'string') modifiedModelJson.Physics = physicsUrl;\n      }\n\n      const posePath = modifiedModelJson.pose || modifiedModelJson.Pose;\n      const poseUrl = await mapFile(modelData?.pose ?? null, posePath, 'application/json');\n      if (poseUrl) {\n        if (typeof modifiedModelJson.pose === 'string') modifiedModelJson.pose = poseUrl;\n        if (typeof modifiedModelJson.Pose === 'string') modifiedModelJson.Pose = poseUrl;\n      }\n\n      const motions = modifiedModelJson.motions || modifiedModelJson.Motions;\n      if (motions && typeof motions === 'object') {\n        for (const groupName of Object.keys(motions)) {\n          const motionList = motions[groupName];\n          if (!Array.isArray(motionList)) continue;\n          for (let index = 0; index < motionList.length; index++) {\n            const motionDef = motionList[index];\n            const motionPath =\n              typeof motionDef === 'string' ? motionDef : (motionDef as any)?.file || (motionDef as any)?.File;\n            const motionData = this._findStoredMotionData(modelData, groupName, motionPath, index);\n            const motionUrl = await mapFile(motionData, motionPath, 'application/octet-stream');\n            if (!motionUrl) continue;\n\n            if (typeof motionDef === 'string') {\n              motionList[index] = motionUrl;\n            } else if (typeof (motionDef as any).file === 'string') {\n              (motionDef as any).file = motionUrl;\n            } else {\n              (motionDef as any).File = motionUrl;\n            }\n          }\n        }\n      }\n\n      const expressions = modifiedModelJson.expressions || modifiedModelJson.Expressions;\n      if (Array.isArray(expressions)) {\n        for (let index = 0; index < expressions.length; index++) {\n          const exprDef = expressions[index];\n          const exprPath = typeof exprDef === 'string' ? exprDef : (exprDef as any)?.file || (exprDef as any)?.File;\n          const exprData = this._findStoredExpressionData(modelData, exprPath, index);\n          const exprUrl = await mapFile(exprData, exprPath, 'application/json');\n          if (!exprUrl) continue;\n\n          if (typeof exprDef === 'string') {\n            expressions[index] = exprUrl;\n          } else if (typeof (exprDef as any).file === 'string') {\n            (exprDef as any).file = exprUrl;\n          } else {\n            (exprDef as any).File = exprUrl;\n          }\n        }\n      }\n    }\n\n    this._lastModelJson = JSON.parse(JSON.stringify(modifiedModelJson));\n\n    const modelBlob = new Blob([JSON.stringify(modifiedModelJson)], { type: 'application/json' });\n    return await this._blobToDataUrl(modelBlob);\n  },\n\n  _encodePathSegment(segment: string): string {\n    if (typeof segment !== 'string' || !segment) return segment;\n\r\n    let decoded = segment;\r\n    try {\r\n      decoded = decodeURIComponent(segment);\r\n    } catch {\r\n      return segment;\r\n    }\r\n\r\n    const safeChar = /[A-Za-z0-9\\-._~!$&'()*+,;=:@]/;\r\n    let encoded = '';\r\n    for (const ch of decoded) {\r\n      encoded += safeChar.test(ch) ? ch : encodeURIComponent(ch);\r\n    }\r\n    return encoded;\r\n  },\r\n\r\n  _normalizeRemoteUrl(inputUrl: string): string {\r\n    const url = String(inputUrl || '').trim();\r\n    if (!url) return url;\r\n\r\n    try {\r\n      const urlObj = new URL(url);\r\n      urlObj.pathname = urlObj.pathname\r\n        .split('/')\r\n        .map(segment => this._encodePathSegment(segment))\r\n        .join('/');\r\n      return urlObj.toString();\r\n    } catch {\r\n      return url;\r\n    }\r\n  },\r\n\r\n  _normalizeResourceRef(inputRef: string): string {\r\n    const raw = String(inputRef || '').trim();\r\n    if (!raw) return raw;\r\n\r\n    //  #  %23 URL \r\n    const hashSafe = raw.replace(/#/g, '%23');\r\n    const normalized = hashSafe.replace(/\\\\/g, '/');\r\n\r\n    const qIndex = normalized.indexOf('?');\r\n    const pathPart = qIndex >= 0 ? normalized.slice(0, qIndex) : normalized;\r\n    const queryPart = qIndex >= 0 ? normalized.slice(qIndex) : '';\r\n\r\n    const encodedPath = pathPart\r\n      .split('/')\r\n      .map(segment => this._encodePathSegment(segment))\r\n      .join('/');\r\n\r\n    return `${encodedPath}${queryPart.replace(/#/g, '%23')}`;\r\n  },\r\n\r\n  _getMirrorEikanyaModelUrl(modelUrl: string): string | null {\r\n    const url = String(modelUrl || '').trim();\r\n    if (!url) return null;\r\n\r\n    if (url.startsWith(EIKANYA_CDN_BASE)) {\r\n      return `${EIKANYA_RAW_BASE}${url.slice(EIKANYA_CDN_BASE.length)}`;\r\n    }\r\n    if (url.startsWith(EIKANYA_RAW_BASE)) {\r\n      return `${EIKANYA_CDN_BASE}${url.slice(EIKANYA_RAW_BASE.length)}`;\r\n    }\r\n    return null;\r\n  },\r\n\r\n  _expandJsDelivrHosts(inputUrl: string): string[] {\r\n    const url = String(inputUrl || '').trim();\r\n    if (!url) return [];\r\n\r\n    let urlObj: URL;\r\n    try {\r\n      urlObj = new URL(url);\r\n    } catch {\r\n      return [];\r\n    }\r\n\r\n    if (!urlObj.hostname.toLowerCase().endsWith('jsdelivr.net')) return [];\r\n\r\n    const results: string[] = [];\r\n    for (const host of this._JSDELIVR_HOSTS) {\r\n      try {\r\n        const u = new URL(url);\r\n        u.hostname = host;\r\n        results.push(u.toString());\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n    return results;\r\n  },\r\n\r\n  _convertJsDelivrGhToRawCandidates(inputUrl: string): string[] {\r\n    const url = String(inputUrl || '').trim();\r\n    if (!url) return [];\r\n\r\n    let urlObj: URL;\r\n    try {\r\n      urlObj = new URL(url);\r\n    } catch {\r\n      return [];\r\n    }\r\n\r\n    const host = urlObj.hostname.toLowerCase();\r\n    if (!host.endsWith('jsdelivr.net')) return [];\r\n    if (!urlObj.pathname.startsWith('/gh/')) return [];\r\n\r\n    const rest = urlObj.pathname.slice('/gh/'.length);\r\n    const parts = rest.split('/').filter(Boolean);\r\n    if (parts.length < 2) return [];\r\n\r\n    const owner = parts[0];\r\n    const repoWithRef = parts[1];\r\n    const filePath = parts.slice(2).join('/');\r\n    if (!owner || !repoWithRef || !filePath) return [];\r\n\r\n    const [repo, ref] = repoWithRef.split('@');\r\n    const suffix = `${urlObj.search || ''}${urlObj.hash || ''}`;\r\n\r\n    if (ref) {\r\n      return [`https://raw.githubusercontent.com/${owner}/${repo}/${ref}/${filePath}${suffix}`];\r\n    }\r\n\r\n    return [\r\n      `https://raw.githubusercontent.com/${owner}/${repo}/master/${filePath}${suffix}`,\r\n      `https://raw.githubusercontent.com/${owner}/${repo}/main/${filePath}${suffix}`,\r\n    ];\r\n  },\r\n\r\n  _buildModelUrlCandidates(modelUrl: string): string[] {\r\n    const bases: string[] = [];\r\n    const addBase = (url: string) => {\r\n      const normalized = this._normalizeRemoteUrl(url);\r\n      if (!normalized) return;\r\n      if (!bases.includes(normalized)) bases.push(normalized);\r\n    };\r\n\r\n    addBase(modelUrl);\r\n    const mirrorUrl = this._getMirrorEikanyaModelUrl(modelUrl);\r\n    if (mirrorUrl) addBase(mirrorUrl);\r\n\r\n    const candidates: string[] = [];\r\n    const add = (url: string) => {\r\n      const normalized = this._normalizeRemoteUrl(url);\r\n      if (!normalized) return;\r\n      if (!candidates.includes(normalized)) candidates.push(normalized);\r\n    };\r\n\r\n    for (const base of bases) {\r\n      add(base);\r\n      for (const variant of this._expandJsDelivrHosts(base)) add(variant);\r\n      for (const raw of this._convertJsDelivrGhToRawCandidates(base)) add(raw);\r\n    }\r\n\r\n    return candidates;\r\n  },\r\n\r\n  async _createModelWithTimeout(Live2DModel: any, dataUrl: string, timeoutMs = 30000): Promise<any> {\n    let timer: number | null = null;\n    try {\n      const timeoutPromise = new Promise<never>((_resolve, reject) => {\n        timer = window.setTimeout(() => {\n          reject(new Error(` (${timeoutMs}ms)`));\n        }, timeoutMs);\n      });\n\n      return await Promise.race([\n        Live2DModel.from(dataUrl, {\n          //  galgame  WebGL renderer  autoUpdate\n          //  Cubism2/ WebGL program \n          autoUpdate: false,\n          autoInteract: false,\n        }),\n        timeoutPromise,\n      ]);\n    } finally {\n      if (timer !== null) {\n        window.clearTimeout(timer);\n      }\n    }\n  },\n\r\n  async _fetchWithTimeout(url: string, init: RequestInit, timeoutMs = 12000): Promise<Response> {\r\n    if (typeof AbortController === 'undefined') {\r\n      return fetch(url, init);\r\n    }\r\n\r\n    const controller = new AbortController();\r\n    const timer = window.setTimeout(() => controller.abort(), timeoutMs);\r\n\r\n    try {\r\n      return await fetch(url, { ...init, signal: controller.signal });\r\n    } catch (e: any) {\r\n      if (e?.name === 'AbortError') {\r\n        throw new Error(` (${timeoutMs}ms): ${url}`);\r\n      }\r\n      throw e;\r\n    } finally {\r\n      window.clearTimeout(timer);\r\n    }\r\n  },\r\n\r\n  _toPositiveNumber(value: unknown, fallback: number): number {\r\n    const n = typeof value === 'number' ? value : Number(value);\r\n    return Number.isFinite(n) && n > 0 ? n : fallback;\r\n  },\r\n\r\n  _toScale(value: unknown, fallback = 1): number {\n    const n = typeof value === 'number' ? value : Number(value);\n    if (!Number.isFinite(n) || n <= 0) return fallback;\n    return Math.min(20, Math.max(0.01, n));\n  },\n\n  _readModelBaseBounds(model: any): { x: number; y: number; width: number; height: number } | null {\n    if (!model || typeof model.getLocalBounds !== 'function') return null;\n    try {\n      const bounds = model.getLocalBounds();\n      if (!bounds) return null;\n      const width = Number(bounds.width);\n      const height = Number(bounds.height);\n      if (!Number.isFinite(width) || !Number.isFinite(height) || width <= 0 || height <= 0) {\n        return null;\n      }\n      const x = Number.isFinite(Number(bounds.x)) ? Number(bounds.x) : 0;\n      const y = Number.isFinite(Number(bounds.y)) ? Number(bounds.y) : 0;\n      return { x, y, width, height };\n    } catch {\n      return null;\n    }\n  },\n\n  _resolveModelBaseBounds(): { x: number; y: number; width: number; height: number } {\n    if (this.modelBaseBounds) return this.modelBaseBounds;\n\n    const measured = this._readModelBaseBounds(this.model);\n    if (measured) {\n      this.modelBaseBounds = measured;\n      this.modelBaseWidth = measured.width;\n      this.modelBaseHeight = measured.height;\n      return measured;\n    }\n\n    return {\n      x: 0,\n      y: 0,\n      width: this._toPositiveNumber(this.modelBaseWidth, 500),\n      height: this._toPositiveNumber(this.modelBaseHeight, 800),\n    };\n  },\n\n  _applyStageTransform(stageWidth: number, stageHeight: number, scale: number): {\n    finalScale: number;\n    stageWidth: number;\n    stageHeight: number;\n    modelWidth: number;\n    modelHeight: number;\n  } | null {\n    if (!this.model) return null;\n\n    const safeStageWidth = this._toPositiveNumber(stageWidth, 280);\n    const safeStageHeight = this._toPositiveNumber(stageHeight, 360);\n    const bounds = this._resolveModelBaseBounds();\n    const safeModelWidth = this._toPositiveNumber(bounds.width, 500);\n    const safeModelHeight = this._toPositiveNumber(bounds.height, 800);\n    const fitScale = Math.min(safeStageWidth / safeModelWidth, safeStageHeight / safeModelHeight) * 0.9;\n    const finalScale = this._toScale(fitScale * this._toScale(scale, 1), 0.3);\n\n    this.model.visible = true;\n    this.model.alpha = 1;\n    this.model.scale.set(finalScale);\n\n    if (this.model.anchor?.set) {\n      this.model.anchor.set(0.5, 1);\n      this.model.x = safeStageWidth / 2;\n      this.model.y = safeStageHeight;\n    } else if (this.model.pivot?.set) {\n      this.model.pivot.set(bounds.x + safeModelWidth / 2, bounds.y + safeModelHeight);\n      this.model.x = safeStageWidth / 2;\n      this.model.y = safeStageHeight;\n    } else {\n      this.model.x = safeStageWidth / 2;\n      this.model.y = safeStageHeight / 2;\n    }\n\n    return {\n      finalScale,\n      stageWidth: safeStageWidth,\n      stageHeight: safeStageHeight,\n      modelWidth: safeModelWidth,\n      modelHeight: safeModelHeight,\n    };\n  },\n\r\n  _normalizeLegacyCubism2Settings(modelJson: any): void {\r\n    if (!modelJson || modelJson.FileReferences) return;\r\n\r\n    const textures = modelJson.textures || modelJson.Textures;\r\n    if (Array.isArray(textures)) return;\r\n    if (!textures || typeof textures !== 'object') return;\r\n\r\n    const entries = Object.entries(textures)\r\n      .filter((entry): entry is [string, string[]] => Array.isArray(entry[1]) && entry[1].length > 0);\r\n    if (entries.length === 0) return;\r\n\r\n    const hintKeys = [\r\n      modelJson.config?.texture,\r\n      modelJson.config?.textureId,\r\n      modelJson.config?.skin,\r\n      modelJson.config?.modelId,\r\n      modelJson.config?.defaultTexture,\r\n      modelJson.config?.defaultSkin,\r\n    ]\r\n      .map(v => (v === undefined || v === null ? '' : String(v).trim()))\r\n      .filter(Boolean);\r\n\r\n    let selected = entries[0];\r\n    for (const hint of hintKeys) {\r\n      const matched = entries.find(([key]) => key === hint);\r\n      if (matched) {\r\n        selected = matched;\r\n        break;\r\n      }\r\n    }\r\n\r\n    const normalizedTextures = selected[1].map((item: string) => {\r\n      const raw = String(item || '').trim();\r\n      if (!raw) return raw;\r\n      if (/^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(raw)) return raw;\r\n      if (raw.startsWith('/')) return raw;\r\n      if (raw.includes('/')) return raw;\r\n      //  textures/  JSON \r\n      return `textures/${raw}`;\r\n    });\r\n    modelJson.textures = normalizedTextures;\r\n    modelJson.Textures = normalizedTextures;\r\n    log(' Cubism2 ', {\r\n      key: selected[0],\r\n      textureCount: normalizedTextures.length,\r\n    });\r\n  },\r\n\r\n  _clearAutoMotionLoop(): void {\r\n    if (this._autoMotionTimer !== null) {\r\n      window.clearInterval(this._autoMotionTimer);\r\n      this._autoMotionTimer = null;\r\n    }\r\n  },\r\n\r\n  _stopCurrentMotion(reason = 'manual'): void {\r\n    const model = this.model;\r\n    if (!model) return;\r\n\r\n    let stopped = false;\r\n    const tryCall = (obj: any, method: string) => {\r\n      if (!obj || typeof obj[method] !== 'function') return;\r\n      try {\r\n        obj[method]();\r\n        stopped = true;\r\n      } catch {\r\n        // ignore\r\n      }\r\n    };\r\n\r\n    const mm = model?.internalModel?.motionManager as any;\r\n    const animator = model?.internalModel?.animator as any;\r\n    const internal = model?.internalModel as any;\r\n\r\n    tryCall(model, 'stopMotions');\r\n    tryCall(mm, 'stopAllMotions');\r\n    tryCall(mm, 'stopAllMotion');\r\n    tryCall(mm, 'stopMotion');\r\n    tryCall(mm, 'stop');\r\n    tryCall(animator, 'stopAllMotions');\r\n    tryCall(animator, 'stopAllMotion');\r\n    tryCall(animator, 'stop');\r\n    tryCall(internal, 'stopAllMotions');\r\n\r\n    if (stopped) {\r\n      log('', { reason });\r\n    }\r\n  },\r\n\r\n  _refreshManualMouthParams(): void {\r\n    let enabled = false;\r\n    const ids: string[] = [];\r\n    try {\n      const store = useSettingsStore();\n      const s = store.settings as any;\n      enabled = !!s?.lipSyncManualParamsEnabled;\n      const raw = Array.isArray(s?.lipSyncManualParamIds) ? s.lipSyncManualParamIds : [];\n      const set = new Set<string>();\n      for (const item of raw) {\n        const id = String(item || '').trim();\n        if (!id) continue;\r\n        const low = id.toLowerCase();\r\n        if (set.has(low)) continue;\r\n        set.add(low);\r\n        ids.push(id);\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    this._manualMouthParamEnabled = enabled;\r\n    this._manualMouthParamIds = ids;\r\n    this._manualMouthParamIdSet = new Set(ids.map(id => id.toLowerCase()));\r\n  },\r\n\r\n  _setLipSyncActive(active: boolean): void {\r\n    const next = !!active;\r\n    if (this._lipSyncActive === next) return;\r\n\r\n    this._lipSyncActive = next;\r\n    if (next) {\r\n      this._refreshManualMouthParams();\r\n      const model = this.model;\r\n      const coreModel = model?.internalModel?.coreModel;\r\n      if (model) this._ensureLipSyncHooks(model);\r\n      if (coreModel) this._installCoreWriteMask(coreModel);\r\n    }\r\n    log(`LipSync active=${next}`);\r\n  },\r\n\r\n  setAutoMotionLoopEnabled(enabled: boolean): void {\r\n    this.autoMotionLoopEnabled = Boolean(enabled);\r\n\r\n    if (!this.model) {\r\n      this._clearAutoMotionLoop();\r\n      return;\r\n    }\r\n\r\n    if (this.autoMotionLoopEnabled) {\r\n      this._startAutoMotionLoop();\r\n    } else {\r\n      this._clearAutoMotionLoop();\r\n      this._stopCurrentMotion('auto-motion-disabled');\r\n    }\r\n  },\r\n\r\n  _pickDefaultMotionGroup(groups: Record<string, number>): string | null {\r\n    const keys = Object.keys(groups).filter(key => groups[key] > 0);\r\n    if (keys.length === 0) return null;\r\n\r\n    const preferred = ['idle', 'home', 'stand', 'normal', 'default', 'main', 'loop', 'wait'];\r\n    for (const key of keys) {\r\n      const lower = key.toLowerCase();\r\n      if (preferred.some(token => lower.includes(token))) {\r\n        return key;\r\n      }\r\n    }\r\n\r\n    if (keys.includes('')) {\r\n      return '';\r\n    }\r\n\r\n    return null;\r\n  },\r\n\r\n  _startAutoMotionLoop(): void {\r\n    this._clearAutoMotionLoop();\r\n    if (!this.model) return;\r\n\r\n    const initialGroups = this.getMotionGroups();\r\n    const motionGroup = this._pickDefaultMotionGroup(initialGroups);\r\n    const allGroupNames = Object.keys(initialGroups).filter(key => initialGroups[key] > 0);\r\n    if (allGroupNames.length === 0) {\r\n      log('');\r\n      return;\r\n    }\r\n\r\n    const playOne = () => {\r\n      if (!this.model) return;\r\n      const groups = this.getMotionGroups();\r\n\r\n      if (motionGroup !== null) {\r\n        const count = groups[motionGroup] ?? 0;\r\n        if (count <= 0) return;\r\n        const idx = Math.floor(Math.random() * count);\r\n        this.playMotion(motionGroup, idx);\r\n        return;\r\n      }\r\n\r\n      const groupNames = Object.keys(groups).filter(key => groups[key] > 0);\r\n      if (groupNames.length === 0) return;\r\n      const randGroup = groupNames[Math.floor(Math.random() * groupNames.length)];\r\n      const count = groups[randGroup];\r\n      if (count <= 0) return;\r\n      const randIndex = Math.floor(Math.random() * count);\r\n      this.playMotion(randGroup, randIndex);\r\n    };\r\n\r\n    playOne();\r\n    this._autoMotionTimer = window.setInterval(playOne, 10000);\r\n    if (motionGroup !== null) {\r\n      log('', {\r\n        mode: 'preferred-group',\r\n        group: motionGroup || '(empty)',\r\n        intervalMs: 10000,\r\n      });\r\n    } else {\r\n      log('', {\r\n        mode: 'random-all-groups',\r\n        groupCount: allGroupNames.length,\r\n        intervalMs: 10000,\r\n      });\r\n    }\r\n  },\r\n\r\n  _stripJsonComments(text: string): string {\r\n    let output = '';\r\n    let inString = false;\r\n    let quoteChar = '\"';\r\n    let escaping = false;\r\n    let inLineComment = false;\r\n    let inBlockComment = false;\r\n\r\n    for (let i = 0; i < text.length; i++) {\r\n      const ch = text[i];\r\n      const next = i + 1 < text.length ? text[i + 1] : '';\r\n\r\n      if (inLineComment) {\r\n        if (ch === '\\n') {\r\n          inLineComment = false;\r\n          output += ch;\r\n        }\r\n        continue;\r\n      }\r\n\r\n      if (inBlockComment) {\r\n        if (ch === '*' && next === '/') {\r\n          inBlockComment = false;\r\n          i++;\r\n        }\r\n        continue;\r\n      }\r\n\r\n      if (inString) {\r\n        output += ch;\r\n        if (escaping) {\r\n          escaping = false;\r\n        } else if (ch === '\\\\') {\r\n          escaping = true;\r\n        } else if (ch === quoteChar) {\r\n          inString = false;\r\n        }\r\n        continue;\r\n      }\r\n\r\n      if (ch === '/' && next === '/') {\r\n        inLineComment = true;\r\n        i++;\r\n        continue;\r\n      }\r\n\r\n      if (ch === '/' && next === '*') {\r\n        inBlockComment = true;\r\n        i++;\r\n        continue;\r\n      }\r\n\r\n      if (ch === '\"' || ch === '\\'') {\r\n        inString = true;\r\n        quoteChar = ch;\r\n      }\r\n\r\n      output += ch;\r\n    }\r\n\r\n    return output;\r\n  },\r\n\r\n  _tryParseModelJson(text: string): any | null {\r\n    const raw = String(text ?? '').replace(/^\\uFEFF/, '').trim();\r\n    if (!raw) return null;\r\n\r\n    try {\r\n      return JSON.parse(raw);\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    let cleaned = this._stripJsonComments(raw);\r\n    cleaned = cleaned.replace(/,\\s*([}\\]])/g, '$1');\r\n    cleaned = cleaned.replace(/}(\\s*){/g, '},$1{');\r\n    cleaned = cleaned.replace(/](\\s*){/g, '],$1{');\r\n    cleaned = cleaned.replace(/([}\\]0-9\"'])(\\s*)(?=\"[^\"]+\"\\s*:)/g, '$1,$2');\r\n\r\n    try {\r\n      return JSON.parse(cleaned);\r\n    } catch {\r\n      return null;\r\n    }\r\n  },\r\n\r\n  _buildModelJsonCandidates(modelUrl: string): string[] {\r\n    const candidates = [modelUrl];\r\n\r\n    const addCandidate = (url: string) => {\r\n      if (!url) return;\r\n      if (!candidates.includes(url)) candidates.push(url);\r\n    };\r\n\r\n    addCandidate(modelUrl.replace(/\\/model\\.json(?=([?#].*)?$)/i, '/model.model.json'));\r\n    addCandidate(modelUrl.replace(/\\/model3\\.json(?=([?#].*)?$)/i, '/model.model3.json'));\r\n\r\n    return candidates;\r\n  },\r\n\r\n  async _fetchModelJsonCandidate(modelUrl: string, useProxy: boolean): Promise<any | null> {\r\n    const requestUrl = useProxy ? this._getProxiedUrl(modelUrl) : modelUrl;\r\n    const resp = await this._fetchWithTimeout(requestUrl, { method: 'GET', cache: 'no-store' }, 12000);\r\n    if (!resp.ok) return null;\r\n\r\n    const text = await resp.text();\r\n    const modelJson = this._tryParseModelJson(text);\r\n    if (!modelJson) return null;\r\n\r\n    return { modelJson, sourceUrl: modelUrl, useProxy };\r\n  },\r\n\r\n  /**\n   *  CORS  URL\n   * : getCorsProxyUrl -> enableCorsProxy -> corsProxy.getProxyUrl -> /proxy?url=\n   */\n  _getProxiedUrl(originalUrl: string): string {\n    const top = this._top() as any;\n    const url = String(originalUrl || '').trim();\n    if (!url) return url;\n    //  URL\n    if (url.toLowerCase().includes('/proxy?url=')) return url;\n\r\n    // SillyTavern  CORS \n    if (typeof top.getCorsProxyUrl === 'function') {\r\n      try {\r\n        const proxied = top.getCorsProxyUrl(url);\r\n        if (typeof proxied === 'string' && proxied) return proxied;\r\n      } catch (_e) { /* ignore */ }\r\n    }\r\n\r\n    if (typeof top.enableCorsProxy === 'function') {\r\n      try {\r\n        const proxied = top.enableCorsProxy(url);\r\n        if (typeof proxied === 'string' && proxied) return proxied;\r\n      } catch (_e) { /* ignore */ }\r\n    }\r\n\r\n    if (top.corsProxy?.getProxyUrl) {\r\n      try {\r\n        const proxied = top.corsProxy.getProxyUrl(url);\r\n        if (typeof proxied === 'string' && proxied) return proxied;\r\n      } catch (_e) { /* ignore */ }\r\n    }\r\n\r\n    // \n    const origin = top.location?.origin;\n    if (origin) {\n      return `${origin}/proxy?url=${encodeURIComponent(url)}`;\n    }\n\r\n    return url;\r\n  },\r\n\r\n  /**\n   *  SDK  Ticker\n   */\n  async init(): Promise<boolean> {\n    if (this.isReady) {\r\n      const runtime = Live2DLoader.getRuntime(this._top());\r\n      if (runtime) {\r\n        this._runtime = runtime;\r\n        return true;\r\n      }\r\n      this.isReady = false;\r\n    }\r\n\r\n    const sdkLoaded = await Live2DLoader.load();\r\n    if (!sdkLoaded) {\r\n      error('SDK  Live2DManager');\r\n      return false;\r\n    }\r\n\r\n    //  runtime \r\n    let runtime = Live2DLoader.getRuntime(this._top());\r\n    let retries = 30;\r\n    while (!runtime && retries > 0) {\r\n      await new Promise(r => setTimeout(r, 100));\r\n      runtime = Live2DLoader.getRuntime(this._top());\r\n      retries--;\r\n    }\r\n\r\n    if (!runtime?.pixi || !runtime?.live2dModel) {\r\n      error(' Live2D runtime ');\r\n      return false;\r\n    }\r\n\r\n    try {\n      const PIXI = runtime.pixi;\n      const Live2DModel = runtime.live2dModel;\n      if (typeof Live2DModel?.registerTicker !== 'function') {\n        throw new Error('Live2DModel.registerTicker ');\n      }\n\n      //  ticker\n      const lastRegisteredTicker = (Live2DModel as any)[TICKER_REGISTERED_FLAG] as unknown;\n      if (lastRegisteredTicker !== PIXI.Ticker) {\n        Live2DModel.registerTicker(PIXI.Ticker);\n        (Live2DModel as any)[TICKER_REGISTERED_FLAG] = PIXI.Ticker;\n        log('Live2D ticker ');\n      } else {\n        log('Live2D ticker ');\n      }\n\n      this._runtime = runtime;\n      this.isReady = true;\n      log('Live2DManager ');\n      return true;\n    } catch (e) {\r\n      error('Live2DManager ', e);\r\n      return false;\r\n    }\r\n  },\r\n\r\n  /**\n   *  URL + \n   * - :  model JSON runtime \n   * - :  IndexedDB  blob/data URL runtime \n   */\n  async loadModel(\n    modelPath: string,\n    onProgress?: (progress: ModelLoadProgress) => void,\n  ): Promise<boolean> {\n    let progress = 0;\n    const reportProgress = (percent: number, message: string): void => {\n      if (!onProgress) return;\n      progress = Math.max(progress, Math.round(percent));\n      onProgress({\n        percent: Math.max(0, Math.min(100, progress)),\n        message,\n      });\n    };\n\n    const loadWithRuntime = async (\n      modelUrl: string,\n      runtimeInfo: Record<string, any> | null,\n      contextLabel: string,\n      progressStart: number,\n      progressSuffix = '',\n    ): Promise<{\n      model: any;\n      texturesReady: boolean;\n      runtimeInfo: {\n        runtimeType: Live2DRuntimeType;\n        cubismVersion: number | null;\n        moc3Version?: number | null;\n      };\n    }> => {\n      const resolvedRuntime = await this._ensureRuntimeDependencies(runtimeInfo, contextLabel);\n      const PIXI = this._getPIXI();\n      const Live2DModel = this._getLive2DModelClass(resolvedRuntime.runtimeType);\n      if (!PIXI || !Live2DModel) {\n        throw new Error(`Live2D ${contextLabel}`);\n      }\n\n      this._registerTickerForRuntime(Live2DModel, PIXI);\n      reportProgress(progressStart, `${progressSuffix}`);\n      const model = await this._createModelWithTimeout(Live2DModel, modelUrl);\n      reportProgress(progressStart + 10, `${progressSuffix}`);\n      const texturesReady = await this._waitForTextures(model, (loadedCount, totalCount) => {\n        if (totalCount <= 0) return;\n        const ratio = Math.max(0, Math.min(1, loadedCount / totalCount));\n        reportProgress(\n          progressStart + 10 + ratio * 10,\n          ` ${loadedCount}/${totalCount}${progressSuffix}`,\n        );\n      });\n\n      return {\n        model,\n        texturesReady,\n        runtimeInfo: resolvedRuntime,\n      };\n    };\n\n    reportProgress(2, '');\n    if (!this.isReady) {\n      reportProgress(8, ' Live2D ');\n      const ready = await this.init();\n      if (!ready) {\n        reportProgress(100, 'Live2D ');\n        return false;\n      }\n    }\n\n    try {\n      log(':', modelPath);\n      reportProgress(14, '');\n      this.destroyModel();\n      this._revokeLocalBlobUrls();\n\n      let model: any = null;\n      let texturesReady = false;\n      let loadedFrom = modelPath;\n      let lastError: unknown = null;\n\n      if (this._isLocalModelPath(modelPath)) {\n        reportProgress(20, '');\n        const localModelId = this._normalizeLocalModelId(modelPath);\n        const localModelData = await getLive2DModel(localModelId);\n        if (!localModelData) {\n          throw new Error(' ZIP ');\n        }\n\n        this._lastModelJson = JSON.parse(JSON.stringify(localModelData.modelJson || {}));\n        this._lastModelJsonSourceUrl = modelPath;\n\n        let runtimeInfo = this._setRuntimeInfo(localModelData);\n        if (localModelData.moc3) {\n          runtimeInfo = await this._detectRuntimeFromMoc3(localModelData.moc3, runtimeInfo);\n        }\n\n        const buildLocalUrl = async (preferBlob: boolean): Promise<string> => {\n          if (!preferBlob) {\n            return await this._buildLocalModelDataUrl(localModelData);\n          }\n          const supported = await this._supportsXhrBlobUrls();\n          if (!supported) {\n            return await this._buildLocalModelDataUrl(localModelData);\n          }\n          return await this._buildLocalModelBlobUrl(localModelData);\n        };\n\n        let usedBlobUrl = false;\n        try {\n          reportProgress(30, '');\n          const localUrl = await buildLocalUrl(true);\n          usedBlobUrl = String(localUrl || '').startsWith('blob:');\n          const loaded = await loadWithRuntime(localUrl, runtimeInfo, 'local-model', 42, ' ()');\n          model = loaded.model;\n          texturesReady = loaded.texturesReady;\n          runtimeInfo = loaded.runtimeInfo;\n          loadedFrom = modelPath;\n        } catch (localError) {\n          lastError = localError;\n          warn('', localError);\n\n          if (usedBlobUrl) {\n            this._disableXhrBlobUrls('local-load-failed');\n            this._revokeLocalBlobUrls();\n            try {\n              const localDataUrl = await buildLocalUrl(false);\n              const loaded = await loadWithRuntime(\n                localDataUrl,\n                runtimeInfo,\n                'local-model-data-fallback',\n                46,\n                ' ( DataURL )',\n              );\n              model = loaded.model;\n              texturesReady = loaded.texturesReady;\n              runtimeInfo = loaded.runtimeInfo;\n              loadedFrom = `${modelPath}#data`;\n              lastError = null;\n            } catch (dataFallbackError) {\n              lastError = dataFallbackError;\n            }\n          }\n\n          const shouldForceCubism5 =\n            !model && this._isCoreParseError(lastError) && runtimeInfo.runtimeType === LIVE2D_RUNTIME_TYPES.LEGACY;\n          if (shouldForceCubism5) {\n            warn('local legacy runtime  Cubism5 runtime ', lastError);\n            this._revokeLocalBlobUrls();\n            try {\n              const forcedRuntime = {\n                ...runtimeInfo,\n                runtimeType: LIVE2D_RUNTIME_TYPES.CUBISM5,\n                cubismVersion: 5,\n              };\n              const retryLocalUrl = await buildLocalUrl(false);\n              const loaded = await loadWithRuntime(\n                retryLocalUrl,\n                forcedRuntime,\n                'local-force-cubism5-retry',\n                50,\n                ' ( Cubism5 )',\n              );\n              model = loaded.model;\n              texturesReady = loaded.texturesReady;\n              loadedFrom = `${modelPath}#cubism5`;\n              lastError = null;\n            } catch (forcedRetryError) {\n              lastError = forcedRetryError;\n            }\n          }\n        }\n\n        if (!model) {\n          throw (lastError instanceof Error ? lastError : new Error(''));\n        }\n      } else {\n        reportProgress(20, '');\n        let modelUrl: string;\n        if (modelPath.startsWith('http://') || modelPath.startsWith('https://')) {\n          modelUrl = modelPath;\n        } else {\n          modelUrl = `${LIVE2D_CDN_BASE}${modelPath}`;\n        }\n        modelUrl = this._normalizeRemoteUrl(modelUrl);\n\n        const modelUrlCandidates = this._buildModelUrlCandidates(modelUrl);\n        for (let i = 0; i < modelUrlCandidates.length; i++) {\n          const candidateUrl = modelUrlCandidates[i];\n          const attemptLabel =\n            modelUrlCandidates.length > 1 ? ` (${i + 1}/${modelUrlCandidates.length})` : '';\n          const attemptProgressStart = 24 + Math.floor((i / Math.max(1, modelUrlCandidates.length)) * 36);\n          let attemptModel: any = null;\n          let attemptTexturesReady = false;\n          let attemptError: unknown = null;\n\n          const tryCreate = async (dataUrl: string, suffix = ''): Promise<void> => {\n            const runtimeHint = this._runtimeInfo;\n            const loaded = await loadWithRuntime(\n              dataUrl,\n              runtimeHint,\n              `remote:${candidateUrl}`,\n              attemptProgressStart + 10,\n              `${attemptLabel}${suffix}`,\n            );\n            attemptModel = loaded.model;\n            attemptTexturesReady = loaded.texturesReady;\n          };\n\n          try {\n            if (i > 0) {\n              log(':', candidateUrl);\n            }\n\n            reportProgress(attemptProgressStart, `${attemptLabel}`);\n            const dataUrl = await this._buildRemoteModelDataUrl(candidateUrl);\n            await tryCreate(dataUrl);\n          } catch (firstError) {\n            attemptError = firstError;\n            if (this._isCoreParseError(firstError) && this._runtimeType === LIVE2D_RUNTIME_TYPES.LEGACY) {\n              warn('remote legacy runtime  Cubism5 runtime ', firstError);\n              try {\n                const forcedRuntime = {\n                  ...this._runtimeInfo,\n                  runtimeType: LIVE2D_RUNTIME_TYPES.CUBISM5,\n                  cubismVersion: 5,\n                };\n                const dataUrl = await this._buildRemoteModelDataUrl(candidateUrl);\n                const loaded = await loadWithRuntime(\n                  dataUrl,\n                  forcedRuntime,\n                  `remote-force-cubism5:${candidateUrl}`,\n                  attemptProgressStart + 12,\n                  `${attemptLabel} ( Cubism5 )`,\n                );\n                attemptModel = loaded.model;\n                attemptTexturesReady = loaded.texturesReady;\n                attemptError = null;\n              } catch (forcedRetryError) {\n                attemptError = forcedRetryError;\n              }\n            }\n\n            if (!attemptModel) {\n              warn('', firstError);\n              try {\n                reportProgress(attemptProgressStart + 6, `${attemptLabel}`);\n                const proxyDataUrl = await this._buildRemoteModelDataUrl(candidateUrl, true);\n                await tryCreate(proxyDataUrl, ' ()');\n                attemptError = null;\n              } catch (proxyError) {\n                attemptError = proxyError;\n                if (this._isCoreParseError(proxyError) && this._runtimeType === LIVE2D_RUNTIME_TYPES.LEGACY) {\n                  try {\n                    const forcedRuntime = {\n                      ...this._runtimeInfo,\n                      runtimeType: LIVE2D_RUNTIME_TYPES.CUBISM5,\n                      cubismVersion: 5,\n                    };\n                    const proxyDataUrl = await this._buildRemoteModelDataUrl(candidateUrl, true);\n                    const loaded = await loadWithRuntime(\n                      proxyDataUrl,\n                      forcedRuntime,\n                      `remote-force-cubism5-proxy:${candidateUrl}`,\n                      attemptProgressStart + 14,\n                      `${attemptLabel} ( Cubism5 )`,\n                    );\n                    attemptModel = loaded.model;\n                    attemptTexturesReady = loaded.texturesReady;\n                    attemptError = null;\n                  } catch (proxyForcedRetryError) {\n                    attemptError = proxyForcedRetryError;\n                  }\n                }\n              }\n            }\n          }\n\n          if (attemptModel) {\n            model = attemptModel;\n            texturesReady = attemptTexturesReady;\n            loadedFrom = candidateUrl;\n            lastError = null;\n            break;\n          }\n\n          lastError = attemptError;\n          warn(` (${i + 1}/${modelUrlCandidates.length})`, candidateUrl, attemptError);\n          try {\n            attemptModel?.destroy?.();\n          } catch {\n            // ignore\n          }\n        }\n\n        if (!model) {\n          throw (lastError instanceof Error ? lastError : new Error(''));\n        }\n      }\n\n      this.model = model;\n      const measuredBounds = this._readModelBaseBounds(model);\n      if (measuredBounds) {\n        this.modelBaseBounds = measuredBounds;\n        this.modelBaseWidth = measuredBounds.width;\n        this.modelBaseHeight = measuredBounds.height;\n      } else {\n        this.modelBaseBounds = null;\n        this.modelBaseWidth = model.width > 0 ? model.width : 500;\n        this.modelBaseHeight = model.height > 0 ? model.height : 800;\n      }\n\n      reportProgress(95, '');\n      log('', this.getExpressions());\n      log('', this.getMotionGroups());\n      if (!texturesReady) {\n        warn('');\n      }\n      if (loadedFrom !== modelPath) {\n        log(':', loadedFrom);\n      }\n      reportProgress(100, '');\n      log('');\n      return true;\n    } catch (e) {\n      reportProgress(100, '');\n      error(':', e);\n      return false;\n    }\n  },\n\r\n  /**\n   *  model JSON URL\n   *  JSON  data URL \n   */\n  async _buildRemoteModelDataUrl(modelUrl: string, forceProxyResources = false): Promise<string> {\n    const candidateUrls = this._buildModelJsonCandidates(modelUrl);\r\n\r\n    let modelJson: any = null;\r\n    let sourceModelUrl = modelUrl;\r\n    let useProxy = false;\r\n\r\n    for (const candidateUrl of candidateUrls) {\r\n      try {\r\n        const direct = await this._fetchModelJsonCandidate(candidateUrl, false);\r\n        if (direct) {\r\n          modelJson = direct.modelJson;\r\n          sourceModelUrl = direct.sourceUrl;\r\n          useProxy = false;\r\n          break;\r\n        }\r\n      } catch (directError) {\r\n        warn(' JSON ', candidateUrl, directError);\r\n      }\r\n\r\n      try {\r\n        const proxied = await this._fetchModelJsonCandidate(candidateUrl, true);\r\n        if (proxied) {\r\n          modelJson = proxied.modelJson;\r\n          sourceModelUrl = proxied.sourceUrl;\r\n          useProxy = true;\r\n          break;\r\n        }\r\n      } catch (proxyError) {\r\n        warn(' JSON ', candidateUrl, proxyError);\r\n      }\r\n    }\r\n\r\n    if (!modelJson) {\r\n      throw new Error(' JSON ');\r\n    }\r\n\r\n    if (sourceModelUrl !== modelUrl) {\r\n      log(' JSON :', sourceModelUrl);\r\n    }\r\n\r\n    const modifiedModelJson = JSON.parse(JSON.stringify(modelJson));\r\n    this._normalizeLegacyCubism2Settings(modifiedModelJson);\r\n\r\n    //  URL\n    const resolveUrl = (p: string): string => {\n      if (typeof p !== 'string') return p;\r\n      const raw = p.trim();\r\n      if (!raw) return p;\r\n\r\n      const normalized = this._normalizeResourceRef(raw);\r\n      const hasScheme = /^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(normalized);\r\n      const abs = hasScheme\r\n        ? this._normalizeRemoteUrl(normalized)\r\n        : this._normalizeRemoteUrl(new URL(normalized, sourceModelUrl).toString());\r\n\r\n      if ((useProxy || forceProxyResources) && (abs.startsWith('http://') || abs.startsWith('https://'))) {\r\n        return this._getProxiedUrl(abs);\r\n      }\r\n      return abs;\r\n    };\r\n\r\n    //  Cubism 3/4 model3.json\n    if (modifiedModelJson?.FileReferences) {\r\n      const refs = modifiedModelJson.FileReferences;\r\n      for (const key of Object.keys(refs)) {\r\n        if (typeof refs[key] === 'string') {\r\n          refs[key] = resolveUrl(refs[key]);\r\n        }\r\n      }\r\n\r\n      if (typeof refs.Moc === 'string') refs.Moc = resolveUrl(refs.Moc);\r\n      if (Array.isArray(refs.Textures)) refs.Textures = refs.Textures.map(resolveUrl);\r\n      if (typeof refs.Physics === 'string') refs.Physics = resolveUrl(refs.Physics);\r\n      if (typeof refs.Pose === 'string') refs.Pose = resolveUrl(refs.Pose);\r\n      if (typeof refs.UserData === 'string') refs.UserData = resolveUrl(refs.UserData);\r\n\r\n      if (refs.Motions && typeof refs.Motions === 'object') {\r\n        for (const groupName of Object.keys(refs.Motions)) {\r\n          const motionList = refs.Motions[groupName];\r\n          if (!Array.isArray(motionList)) continue;\r\n          for (const motionDef of motionList) {\r\n            if (!motionDef || typeof motionDef !== 'object') continue;\r\n            if (typeof motionDef.File === 'string') motionDef.File = resolveUrl(motionDef.File);\r\n            if (typeof motionDef.Sound === 'string') motionDef.Sound = resolveUrl(motionDef.Sound);\r\n          }\r\n        }\r\n      }\r\n\r\n      if (Array.isArray(refs.Expressions)) {\r\n        for (const exprDef of refs.Expressions) {\r\n          if (!exprDef || typeof exprDef !== 'object') continue;\r\n          if (typeof exprDef.File === 'string') exprDef.File = resolveUrl(exprDef.File);\r\n        }\r\n      }\r\n    } else {\n      //  Cubism 2.1 model.json\n      if (typeof modifiedModelJson.model === 'string') {\n        modifiedModelJson.model = resolveUrl(modifiedModelJson.model);\n      } else if (typeof modifiedModelJson.Model === 'string') {\n        modifiedModelJson.Model = resolveUrl(modifiedModelJson.Model);\r\n      }\r\n\r\n      const textures = modifiedModelJson.textures || modifiedModelJson.Textures;\r\n      if (Array.isArray(textures)) {\r\n        for (let i = 0; i < textures.length; i++) {\r\n          if (typeof textures[i] === 'string') textures[i] = resolveUrl(textures[i]);\r\n        }\r\n      }\r\n\r\n      if (typeof modifiedModelJson.physics === 'string') modifiedModelJson.physics = resolveUrl(modifiedModelJson.physics);\r\n      if (typeof modifiedModelJson.Physics === 'string') modifiedModelJson.Physics = resolveUrl(modifiedModelJson.Physics);\r\n      if (typeof modifiedModelJson.pose === 'string') modifiedModelJson.pose = resolveUrl(modifiedModelJson.pose);\r\n      if (typeof modifiedModelJson.Pose === 'string') modifiedModelJson.Pose = resolveUrl(modifiedModelJson.Pose);\r\n\r\n      const motions = modifiedModelJson.motions || modifiedModelJson.Motions;\r\n      if (motions && typeof motions === 'object') {\r\n        for (const groupName of Object.keys(motions)) {\r\n          const motionList = motions[groupName];\r\n          if (!Array.isArray(motionList)) continue;\r\n          for (const motionDef of motionList) {\r\n            if (!motionDef || typeof motionDef !== 'object') continue;\r\n            if (typeof motionDef.file === 'string') motionDef.file = resolveUrl(motionDef.file);\r\n            if (typeof motionDef.File === 'string') motionDef.File = resolveUrl(motionDef.File);\r\n            if (typeof motionDef.sound === 'string') motionDef.sound = resolveUrl(motionDef.sound);\r\n            if (typeof motionDef.Sound === 'string') motionDef.Sound = resolveUrl(motionDef.Sound);\r\n          }\r\n        }\r\n      }\r\n\r\n      const expressions = modifiedModelJson.expressions || modifiedModelJson.Expressions;\r\n      if (Array.isArray(expressions)) {\n        for (const exprDef of expressions) {\n          if (!exprDef || typeof exprDef !== 'object') continue;\n          if (typeof exprDef.file === 'string') exprDef.file = resolveUrl(exprDef.file);\n          if (typeof exprDef.File === 'string') exprDef.File = resolveUrl(exprDef.File);\n        }\n      }\n    }\n\n    let runtimeHint = this._setRuntimeInfo({\n      ...this._runtimeInfo,\n      modelJson: modifiedModelJson,\n    });\n\n    if (modifiedModelJson?.FileReferences?.Moc) {\n      const remoteMocUrl = String(modifiedModelJson.FileReferences.Moc || '').trim();\n      if (remoteMocUrl) {\n        try {\n          const mocResponse = await this._fetchWithTimeout(\n            remoteMocUrl,\n            { method: 'GET', cache: 'no-store' },\n            12000,\n          );\n          if (mocResponse.ok) {\n            const mocBuffer = await mocResponse.arrayBuffer();\n            runtimeHint = await this._detectRuntimeFromMoc3(mocBuffer, runtimeHint);\n          } else {\n            warn(` moc3 HTTP ${mocResponse.status}`, remoteMocUrl);\n          }\n        } catch (mocProbeError) {\n          warn(' moc3 ', mocProbeError);\n        }\n      }\n    } else {\n      runtimeHint = this._setRuntimeInfo({\n        ...runtimeHint,\n        runtimeType: LIVE2D_RUNTIME_TYPES.LEGACY,\n        cubismVersion: runtimeHint.cubismVersion ?? 2,\n      });\n    }\n\n    log(' runtime ', {\n      sourceModelUrl,\n      runtimeType: runtimeHint.runtimeType,\n      cubismVersion: runtimeHint.cubismVersion,\n      moc3Version: (runtimeHint as any)?.moc3Version ?? null,\n    });\n\n    //  model json/\n    this._lastModelJson = modifiedModelJson;\n    this._lastModelJsonSourceUrl = sourceModelUrl;\n\n    //  data URL\n    const modelJsonStr = JSON.stringify(modifiedModelJson);\n    const modelJsonBase64 = btoa(unescape(encodeURIComponent(modelJsonStr)));\n    return `data:application/json;base64,${modelJsonBase64}`;\n  },\n\r\n  /**\n   *  PIXI \n   */\n  mountToStage(stageWidth: number, stageHeight: number, scale: number): void {\n    if (!this.model) return;\n\r\n    const stage = Live2DStage.getStage();\r\n    if (!stage) return;\r\n\r\n    // \n    while (stage.children.length > 0) {\n      stage.removeChildAt(0);\n    }\r\n\r\n    const transform = this._applyStageTransform(stageWidth, stageHeight, scale);\n    if (!transform) return;\n\n    stage.addChild(this.model);\n\n    try {\n      if ('autoUpdate' in this.model) {\n        (this.model as any).autoUpdate = true;\n      }\n    } catch {\n      // ignore\n    }\n\n    log('', {\n      stageWidth: transform.stageWidth,\n      stageHeight: transform.stageHeight,\n      scale: transform.finalScale,\n      modelWidth: transform.modelWidth,\n      modelHeight: transform.modelHeight,\n    });\n\r\n    //  idle\r\n    if (this.autoMotionLoopEnabled) {\r\n      this._startAutoMotionLoop();\r\n    } else {\r\n      this._clearAutoMotionLoop();\r\n    }\r\n  },\r\n\r\n  /**\n   * \n   */\n  updateScale(stageWidth: number, stageHeight: number, scale: number): void {\n    if (!this.model) return;\n    this._applyStageTransform(stageWidth, stageHeight, scale);\n  },\n\r\n  /**\n   * \n   */\n  _getModelBaseSize(): { width: number; height: number } {\n    if (this.modelBaseBounds) {\n      return {\n        width: this.modelBaseBounds.width,\n        height: this.modelBaseBounds.height,\n      };\n    }\n\n    if (this.modelBaseWidth && this.modelBaseHeight) {\n      return {\n        width: this.modelBaseWidth,\n        height: this.modelBaseHeight,\r\n      };\r\n    }\r\n\r\n    if (!this.model) {\r\n      return { width: 500, height: 800 };\r\n    }\r\n\r\n    const scaleX = this.model.scale?.x || 1;\r\n    const scaleY = this.model.scale?.y || 1;\r\n    const width = this.model.width > 0 && scaleX !== 0 ? this.model.width / scaleX : 500;\r\n    const height = this.model.height > 0 && scaleY !== 0 ? this.model.height / scaleY : 800;\r\n\r\n    return { width, height };\r\n  },\r\n\r\n  /**\n   * \n   */\n  getExpressions(): string[] {\n    if (!this.model) return [];\n    try {\n      const names = collectExpressionNames(this.model);\n      if (names.length > 0) return names;\n\n      const cached = this._lastModelJson;\n      if (cached) {\n        const fallbackNames = collectExpressionNamesFromUnknown(cached);\n        if (fallbackNames.length > 0) return fallbackNames;\n      }\n\n      return [];\n    } catch (e) {\n      warn('', e);\n      return [];\n    }\n  },\n\r\n  /**\n   * \n   */\n  getMotionGroups(): Record<string, number> {\n    const groups: Record<string, number> = {};\n    if (!this.model) return groups;\n\n    const mergeGroupMap = (source: Record<string, number> | null | undefined): void => {\n      if (!source || typeof source !== 'object') return;\n      for (const [name, count] of Object.entries(source)) {\n        const keyRaw = String(name ?? '');\n        const keyTrimmed = keyRaw.trim();\n        if (!keyTrimmed && keyRaw !== '') continue;\n        const groupName = keyTrimmed || '';\n        const parsedCount = Number(count);\n        const safeCount = Number.isFinite(parsedCount) && parsedCount > 0 ? Math.max(1, Math.floor(parsedCount)) : 1;\n        const prev = groups[groupName];\n        groups[groupName] = Number.isFinite(prev) && prev > 0 ? Math.max(prev, safeCount) : safeCount;\n      }\n    };\n\n    const motionManager = this.model?.internalModel?.motionManager as any;\n    const defs = motionManager?.definitions;\n    if (defs && typeof defs === 'object') {\n      for (const [group, motions] of Object.entries(defs)) {\n        if (Array.isArray(motions)) {\n          groups[group] = motions.length;\n        }\n      }\n    }\n\n    try {\n      const groupNames = collectMotionGroupNames(this.model);\n      for (const groupName of groupNames) {\n        if (!Object.prototype.hasOwnProperty.call(groups, groupName)) {\n          groups[groupName] = 1;\n        } else if (!Number.isFinite(groups[groupName]) || groups[groupName] <= 0) {\n          groups[groupName] = 1;\n        }\n      }\n    } catch (e) {\n      warn('', e);\n    }\n\n    try {\n      mergeGroupMap(collectMotionGroupCountsFromUnknown(this.model?.internalModel?.settings));\n      mergeGroupMap(collectMotionGroupCountsFromUnknown(this.model?.internalModel?.motionManager?.settings));\n    } catch (e) {\n      warn('', e);\n    }\n\n    try {\n      const cached = this._lastModelJson;\n      if (cached) {\n        mergeGroupMap(collectMotionGroupCountsFromUnknown(cached));\n      }\n    } catch (e) {\n      warn('', e);\n    }\n    return groups;\n  },\n\n  /**\n   *  +  group/index\n   */\n  getMotions(): Live2DMotionEntry[] {\n    if (!this.model) return [];\n\n    try {\n      const merged: Live2DMotionEntry[] = [];\n      const seen = new Set<string>();\n\n      const pushAll = (items: Live2DMotionEntry[]) => {\n        for (const item of Array.isArray(items) ? items : []) {\n          const group = String(item?.group ?? '');\n          const indexRaw = Number(item?.index);\n          const index = Number.isFinite(indexRaw) ? Math.max(0, Math.floor(indexRaw)) : 0;\n          const name = String(item?.name ?? '').trim();\n          if (!name) continue;\n          const key = `${group}#${index}#${name.toLowerCase()}`;\n          if (seen.has(key)) continue;\n          seen.add(key);\n          merged.push({ group, index, name });\n        }\n      };\n\n      pushAll(collectMotionEntries(this.model));\n\n      const cached = this._lastModelJson;\n      if (cached) {\n        const cachedAny = cached as any;\n        const motionsContainer =\n          cachedAny?.FileReferences?.Motions ?? cachedAny?.Motions ?? cachedAny?.motions ?? null;\n        if (motionsContainer) {\n          pushAll(\n            collectMotionEntries({\n              internalModel: { motionManager: { definitions: motionsContainer }, settings: cached },\n            } as any),\n          );\n        }\n      }\n\n      return merged;\n    } catch (e) {\n      warn('', e);\n      return [];\n    }\n  },\n\n  /**\n   * \n   */\n  playExpression(name?: string): void {\n    if (!this.model) return;\r\n    try {\r\n      if (name) {\r\n        this.model.expression(name);\r\n      } else {\r\n        const expressions = this.getExpressions();\r\n        if (expressions.length > 0) {\r\n          const idx = Math.floor(Math.random() * expressions.length);\r\n          this.model.expression(expressions[idx]);\r\n        }\r\n      }\r\n    } catch (e) {\r\n      warn(':', e);\r\n    }\r\n  },\r\n\r\n  /**\n   * \n   */\n  playMotion(group?: string, index?: number): void {\n    if (!this.model) return;\n    const runMotionWithRuntimeFallback = (groupName: string, motionIndex: number) => {\n      try {\n        this.model.motion(groupName, motionIndex);\n        return;\n      } catch (firstError) {\n        const mm = this.model?.internalModel?.motionManager as any;\n        if (typeof mm?.startMotion === 'function') {\n          mm.startMotion(groupName, motionIndex, 3);\n          return;\n        }\n        if (typeof mm?.startRandomMotion === 'function') {\n          mm.startRandomMotion(groupName, 3);\n          return;\n        }\n        throw firstError;\n      }\n    };\n\n    const tryRecoverByKnownEntries = (): boolean => {\n      try {\n        const motions = this.getMotions();\n        if (!motions.length) return false;\n        const preferred =\n          motions.find((item) => item.group === String(group ?? '') && item.index === (index ?? 0)) ||\n          motions.find((item) => String(item.group || '').trim().toLowerCase() === 'default') ||\n          motions[0];\n        if (!preferred) return false;\n        runMotionWithRuntimeFallback(preferred.group, preferred.index);\n        return true;\n      } catch {\n        return false;\n      }\n    };\n\n    try {\n      //  motions key  \"\"\n      if (typeof group === 'string') {\n        runMotionWithRuntimeFallback(group, index ?? 0);\n      } else {\n        const groups = this.getMotionGroups();\n        const groupNames = Object.keys(groups);\n        if (groupNames.length > 0) {\n          const randGroup = groupNames[Math.floor(Math.random() * groupNames.length)];\n          const count = groups[randGroup];\n          const randIndex = Math.floor(Math.random() * count);\n          runMotionWithRuntimeFallback(randGroup, randIndex);\n        }\n      }\n    } catch (e) {\n      if (typeof group === 'string' && this.model) {\n        const recovered = tryRecoverByKnownEntries();\n        if (recovered) return;\n      }\n      warn(':', e);\n    }\n  },\n\r\n  /**\n   * \n   */\n  playRandomAnimation(): void {\n    this.playExpression();\n    this.playMotion();\n  },\n\n  /**\n   *  client \n   *  focus  no-op\n   */\n  focusByClientPoint(clientX: number, clientY: number, immediate = false): void {\n    const model = this.model;\n    if (!model) return;\n    if (!Number.isFinite(clientX) || !Number.isFinite(clientY)) return;\n\n    try {\n      if (typeof model.focus === 'function') {\n        model.focus(clientX, clientY, immediate);\n        return;\n      }\n    } catch {\n      return;\n    }\n\n    try {\n      const controller = model?.internalModel?.focusController;\n      if (!controller || typeof controller.focus !== 'function') return;\n\n      const rect = Live2DStage.container?.getBoundingClientRect?.();\n      if (!rect || rect.width <= 0 || rect.height <= 0) return;\n\n      const normalizedX = ((clientX - rect.left) / rect.width) * 2 - 1;\n      const normalizedY = ((clientY - rect.top) / rect.height) * 2 - 1;\n      controller.focus(\n        Math.max(-1, Math.min(1, normalizedX)),\n        Math.max(-1, Math.min(1, -normalizedY)),\n        immediate,\n      );\n    } catch {\n      // ignore\n    }\n  },\n\n  /**\n   * \n   */\n  focusCenter(immediate = true): void {\n    const model = this.model;\n    if (!model) return;\n\n    const rect = Live2DStage.container?.getBoundingClientRect?.();\n    if (rect && rect.width > 0 && rect.height > 0) {\n      this.focusByClientPoint(rect.left + rect.width / 2, rect.top + rect.height / 2, immediate);\n      return;\n    }\n\n    try {\n      const controller = model?.internalModel?.focusController;\n      if (!controller || typeof controller.focus !== 'function') return;\n      controller.focus(0, 0, immediate);\n    } catch {\n      // ignore\n    }\n  },\n\n  /**\n   *  TTS \n   * -  galgame  Live2DManager.setMouthOpen\n   * -  model characterId \r\n   */\r\n  setMouthOpen(_characterId: string, value: number): boolean {\r\n    const model = this.model;\r\n    if (!model?.internalModel?.coreModel) return false;\r\n\r\n    const coreModel = model.internalModel.coreModel;\r\n    const clampedValue = Math.max(0, Math.min(1, value));\r\n    this._mouthCurrentValue = clampedValue;\r\n    const topAny = this._top() as any;\n    const logPrefix = '[] LipSync';\n    this._ensureLipSyncHooks(model);\n    this._installCoreWriteMask(coreModel);\n\r\n    const getParamRange = (paramId: string, paramIndex: number): { min: number; max: number } => {\r\n      let min = Number.NaN;\r\n      let max = Number.NaN;\r\n\r\n      const readNumber = (v: any): number => {\r\n        const n = Number(v);\r\n        return Number.isFinite(n) ? n : Number.NaN;\r\n      };\r\n\r\n      if (Number.isFinite(paramIndex) && paramIndex >= 0) {\r\n        try {\r\n          if (typeof coreModel.getParameterMinimumValue === 'function') {\r\n            min = readNumber(coreModel.getParameterMinimumValue(paramIndex));\r\n          }\r\n        } catch {\r\n          // ignore\r\n        }\r\n        try {\r\n          if (typeof coreModel.getParameterMaximumValue === 'function') {\r\n            max = readNumber(coreModel.getParameterMaximumValue(paramIndex));\r\n          }\r\n        } catch {\r\n          // ignore\r\n        }\r\n      }\r\n\r\n      if (!Number.isFinite(min)) {\r\n        try {\r\n          if (typeof coreModel.getParamMin === 'function') {\r\n            min = readNumber(coreModel.getParamMin(paramId));\r\n          }\r\n        } catch {\r\n          // ignore\r\n        }\r\n      }\r\n      if (!Number.isFinite(max)) {\r\n        try {\r\n          if (typeof coreModel.getParamMax === 'function') {\r\n            max = readNumber(coreModel.getParamMax(paramId));\r\n          }\r\n        } catch {\r\n          // ignore\r\n        }\r\n      }\r\n\r\n      if (!Number.isFinite(min)) min = 0;\r\n      if (!Number.isFinite(max) || max <= min) max = 1;\r\n      return { min, max };\r\n    };\r\n\r\n    const mapToParamValue = (paramId: string, paramIndex: number): number => {\r\n      const { min, max } = getParamRange(paramId, paramIndex);\r\n      //  [-x, +x]  0 \r\n      if (min < 0 && max > 0) {\r\n        return clampedValue * max;\r\n      }\r\n      return min + (max - min) * clampedValue;\r\n    };\r\n\r\n    const getIndexById = (paramId: string): number => {\r\n      try {\r\n        if (typeof coreModel.getParameterIndex === 'function') {\r\n          return coreModel.getParameterIndex(paramId);\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.getParamIndex === 'function') {\r\n          return coreModel.getParamIndex(paramId);\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      return -1;\r\n    };\r\n\r\n    const applyById = (paramId: string): boolean => {\r\n      const paramIndex = getIndexById(paramId);\r\n      const mappedValue = mapToParamValue(paramId, paramIndex);\r\n      try {\r\n        if (typeof coreModel.setParameterValueById === 'function') {\r\n          coreModel.setParameterValueById(paramId, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.addParameterValueById === 'function') {\r\n          coreModel.addParameterValueById(paramId, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.setParamFloat === 'function') {\r\n          coreModel.setParamFloat(paramId, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.addParamFloat === 'function') {\r\n          coreModel.addParamFloat(paramId, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      return false;\r\n    };\r\n\r\n    const applyByIndex = (paramIndex: number): boolean => {\r\n      if (!Number.isFinite(paramIndex) || paramIndex < 0) return false;\r\n      const paramId = (() => {\r\n        try {\r\n          if (typeof coreModel.getParameterId === 'function') {\r\n            return String(coreModel.getParameterId(paramIndex) || '');\r\n          }\r\n        } catch {\r\n          // ignore\r\n        }\r\n        return '';\r\n      })();\r\n      const mappedValue = mapToParamValue(paramId || `__idx_${paramIndex}`, paramIndex);\r\n      try {\r\n        if (typeof coreModel.setParameterValueByIndex === 'function') {\r\n          coreModel.setParameterValueByIndex(paramIndex, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.addParameterValueByIndex === 'function') {\r\n          coreModel.addParameterValueByIndex(paramIndex, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.setParameterValue === 'function') {\r\n          coreModel.setParameterValue(paramIndex, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      try {\r\n        if (typeof coreModel.addParameterValue === 'function') {\r\n          coreModel.addParameterValue(paramIndex, mappedValue, 1);\r\n          return true;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      return false;\r\n    };\r\n\r\n    const paramNames = [\r\n      'ParamMouthOpenY',\r\n      'PARAM_MOUTH_OPEN_Y',\r\n      'ParamMouthOpen',\r\n      'ParamA',\r\n      'Param58',\r\n      'Param61',\r\n      'Param_Mouth_Open',\r\n      'mouth_open',\r\n    ];\r\n\r\n    let appliedAny = false;\r\n    if (this._manualMouthParamEnabled && this._manualMouthParamIds.length > 0) {\r\n      for (const manualId of this._manualMouthParamIds) {\r\n        const idx = getIndexById(manualId);\r\n        if (applyById(manualId)) appliedAny = true;\r\n        if (applyByIndex(idx)) appliedAny = true;\r\n      }\r\n    }\r\n\r\n    const visited = new Set<string>();\r\n    for (const paramName of paramNames) {\r\n      if (visited.has(paramName)) continue;\r\n      visited.add(paramName);\r\n      const paramIndex = getIndexById(paramName);\r\n      if (paramIndex >= 0) {\r\n        if (applyById(paramName)) appliedAny = true;\r\n        if (applyByIndex(paramIndex)) appliedAny = true;\r\n      }\r\n    }\r\n    if (appliedAny) return true;\r\n\r\n    //  mouth/lip/ParamA\r\n    if (this._mouthParamCore !== coreModel) {\r\n      this._mouthParamCore = coreModel;\r\n      this._mouthParamIds = [];\r\n      this._mouthParamIndexes = [];\r\n      this._mouthParamRangeMins = [];\r\n      this._mouthParamRangeMaxs = [];\r\n      this._mouthParamWarned = false;\r\n      try {\r\n        if (typeof coreModel.getParameterCount === 'function' && typeof coreModel.getParameterId === 'function') {\r\n          const count = Number(coreModel.getParameterCount()) || 0;\r\n          const numericFallback: Array<{ id: string; idx: number; min: number; max: number }> = [];\r\n          for (let i = 0; i < count; i++) {\r\n            const pid = String(coreModel.getParameterId(i) || '');\r\n            const low = pid.toLowerCase();\r\n            const range = getParamRange(pid, i);\r\n            if (low.includes('mouth') || low.includes('lip') || pid === 'ParamA') {\r\n              this._mouthParamIds.push(pid);\r\n              this._mouthParamIndexes.push(i);\r\n              this._mouthParamRangeMins.push(range.min);\r\n              this._mouthParamRangeMaxs.push(range.max);\r\n              continue;\r\n            }\r\n\r\n            // Cubism2  Param58/Param61\r\n            if (/^param\\d+$/i.test(pid) && range.max >= 8 && range.min >= -1) {\r\n              numericFallback.push({ id: pid, idx: i, min: range.min, max: range.max });\r\n            }\r\n          }\r\n\r\n          if (this._mouthParamIds.length === 0 && numericFallback.length > 0) {\r\n            numericFallback.sort((a, b) => b.max - a.max);\r\n            const picked = numericFallback.slice(0, 3);\r\n            for (const item of picked) {\r\n              this._mouthParamIds.push(item.id);\r\n              this._mouthParamIndexes.push(item.idx);\r\n              this._mouthParamRangeMins.push(item.min);\r\n              this._mouthParamRangeMaxs.push(item.max);\r\n            }\r\n            try {\r\n              topAny?.console?.log?.(`${logPrefix}: `, picked);\r\n            } catch {\r\n              // ignore\r\n            }\r\n          }\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    for (let i = 0; i < this._mouthParamIds.length; i++) {\r\n      const pid = this._mouthParamIds[i];\r\n      const pidx = this._mouthParamIndexes[i] ?? -1;\r\n      if (applyById(pid)) appliedAny = true;\r\n      if (applyByIndex(pidx)) appliedAny = true;\r\n    }\r\n    if (appliedAny) return true;\r\n\r\n    if (!this._mouthParamWarned) {\r\n      this._mouthParamWarned = true;\r\n      const msg = `${logPrefix}: `;\r\n      try {\r\n        topAny?.console?.warn?.(msg, {\r\n          presetCandidates: paramNames,\r\n          scannedIds: this._mouthParamIds,\r\n        });\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    return false;\r\n  },\r\n\r\n  _isMouthParam(paramIdOrIndex: string | number, coreModel: any): boolean {\r\n    const preset = [\r\n      'parammouthopeny',\r\n      'param_mouth_open_y',\r\n      'parammouthopen',\r\n      'parama',\r\n      'param58',\r\n      'param61',\r\n      'param_mouth_open',\r\n      'mouth_open',\r\n    ];\r\n\r\n    if (typeof paramIdOrIndex === 'number') {\r\n      if (this._mouthParamIndexes.includes(paramIdOrIndex)) return true;\r\n      try {\r\n        if (typeof coreModel?.getParameterId === 'function') {\r\n          const pid = String(coreModel.getParameterId(paramIdOrIndex) || '').trim();\r\n          if (pid) return this._isMouthParam(pid, coreModel);\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n      return false;\r\n    }\r\n\r\n    const id = String(paramIdOrIndex || '').trim().toLowerCase();\r\n    if (!id) return false;\r\n\r\n    if (this._manualMouthParamEnabled && this._manualMouthParamIdSet.size > 0) {\r\n      if (this._manualMouthParamIdSet.has(id)) return true;\r\n    }\r\n\r\n    if (preset.includes(id)) return true;\r\n\r\n    return this._mouthParamIds.some(pid => String(pid || '').trim().toLowerCase() === id);\r\n  },\r\n\r\n  _installCoreWriteMask(coreModel: any): void {\r\n    if (!coreModel) return;\r\n    if (this._writeMaskCore === coreModel) return;\r\n\r\n    if (this._writeMaskRestore) {\r\n      try {\r\n        this._writeMaskRestore();\r\n      } catch {\r\n        // ignore\r\n      }\r\n      this._writeMaskCore = null;\r\n      this._writeMaskRestore = null;\r\n    }\r\n\r\n    const restoreEntries: Array<{ method: string; raw: any }> = [];\r\n    const methods = [\r\n      'setParameterValueById',\r\n      'addParameterValueById',\r\n      'setParamFloat',\r\n      'addParamFloat',\r\n      'setParameterValueByIndex',\r\n      'addParameterValueByIndex',\r\n      'setParameterValue',\r\n      'addParameterValue',\r\n    ];\r\n\r\n    const getParamRef = (method: string, args: any[]): string | number | null => {\r\n      if (!Array.isArray(args) || args.length === 0) return null;\r\n      const first = args[0];\r\n      if (method.includes('ById') || method === 'setParamFloat' || method === 'addParamFloat') {\r\n        return typeof first === 'string' ? first : null;\r\n      }\r\n      if (method.includes('ByIndex')) {\r\n        return typeof first === 'number' ? first : null;\r\n      }\r\n      if (method === 'setParameterValue' || method === 'addParameterValue') {\r\n        if (typeof first === 'number' || typeof first === 'string') return first;\r\n      }\r\n      return null;\r\n    };\r\n\r\n    for (const method of methods) {\r\n      const raw = coreModel?.[method];\r\n      if (typeof raw !== 'function') continue;\r\n      restoreEntries.push({ method, raw });\r\n      coreModel[method] = (...args: any[]) => {\r\n        const paramRef = getParamRef(method, args);\r\n        if (\r\n          paramRef !== null &&\r\n          this._lipSyncActive &&\r\n          this._inModelUpdate &&\r\n          this._isMouthParam(paramRef, coreModel)\r\n        ) {\r\n          return undefined;\r\n        }\r\n        return raw.apply(coreModel, args);\r\n      };\r\n    }\r\n\r\n    this._writeMaskCore = coreModel;\r\n    this._writeMaskRestore = () => {\r\n      for (const entry of restoreEntries) {\r\n        try {\r\n          coreModel[entry.method] = entry.raw;\r\n        } catch {\r\n          // ignore\r\n        }\r\n      }\r\n    };\r\n  },\r\n\r\n  _ensureLipSyncHooks(model: any): void {\r\n    if (!model) return;\r\n    if (this._updateHookModel === model) return;\r\n\r\n    if (this._updateHookRestore) {\r\n      try {\r\n        this._updateHookRestore();\r\n      } catch {\r\n        // ignore\r\n      }\r\n      this._updateHookRestore = null;\r\n      this._updateHookModel = null;\r\n    }\r\n\r\n    const internal = model?.internalModel;\r\n    const updater = internal?.update;\r\n    if (typeof updater !== 'function') return;\r\n\r\n    const rawUpdate = updater.bind(internal);\r\n    const self = this;\r\n    internal.update = function (...args: any[]) {\r\n      self._inModelUpdate = true;\r\n      let ret: any;\r\n      try {\r\n        ret = rawUpdate(...args);\r\n      } finally {\r\n        self._inModelUpdate = false;\r\n        if (self._lipSyncActive) {\r\n          try {\r\n            self._applyMouthValueToModel(model);\r\n          } catch {\r\n            // ignore\r\n          }\r\n        }\r\n      }\r\n      return ret;\r\n    };\r\n\r\n    this._updateHookModel = model;\r\n    this._updateHookRestore = () => {\r\n      try {\r\n        internal.update = updater;\r\n      } catch {\r\n        // ignore\r\n      }\r\n    };\r\n  },\r\n\r\n  _applyMouthValueToModel(model: any): boolean {\r\n    if (!model?.internalModel?.coreModel) return false;\r\n    const targetValue = Math.max(0, Math.min(1, this._mouthCurrentValue || 0));\r\n    const oldValue = this._mouthCurrentValue;\r\n    this._mouthCurrentValue = targetValue;\r\n    const applied = this.setMouthOpen('__mouth_hook__', targetValue);\r\n    this._mouthCurrentValue = oldValue;\r\n    return applied;\r\n  },\r\n\r\n  _getMouthParamSource(): 'manual' | 'auto' {\r\n    if (this._manualMouthParamEnabled && this._manualMouthParamIdSet.size > 0) {\r\n      return 'manual';\r\n    }\r\n    return 'auto';\r\n  },\r\n\r\n  getLipSyncDebugInfo(): {\n    lipSyncOverride: 'active' | 'inactive';\n    mouthParamsSource: 'manual' | 'auto';\n    mouthParamsCount: number;\n  } {\n    this._refreshManualMouthParams();\n    const source = this._getMouthParamSource();\n    const count = source === 'manual' ? this._manualMouthParamIdSet.size : this._mouthParamIds.length;\n    return {\n      lipSyncOverride: this._lipSyncActive ? 'active' : 'inactive',\n      mouthParamsSource: source,\r\n      mouthParamsCount: count,\r\n    };\r\n  },\r\n\r\n  /**\n   * \n   */\n  destroyModel(): void {\n    this._clearAutoMotionLoop();\n    this._lipSyncActive = false;\n    this._inModelUpdate = false;\n\n    if (this.model) {\r\n      try {\r\n        if (this.model.parent) {\r\n          this.model.parent.removeChild(this.model);\r\n        }\r\n        this.model.destroy();\r\n      } catch (e) {\r\n        warn('', e);\r\n      }\r\n      this.model = null;\r\n    }\r\n    this._mouthParamCore = null;\r\n    this._mouthParamIds = [];\r\n    this._mouthParamIndexes = [];\r\n    this._mouthParamRangeMins = [];\r\n    this._mouthParamRangeMaxs = [];\r\n    this._mouthParamWarned = false;\r\n    this._mouthCurrentValue = 0;\r\n    if (this._writeMaskRestore) {\r\n      try {\r\n        this._writeMaskRestore();\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n    this._writeMaskCore = null;\r\n    this._writeMaskRestore = null;\r\n    if (this._updateHookRestore) {\r\n      try {\r\n        this._updateHookRestore();\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n    this._updateHookModel = null;\r\n    this._updateHookRestore = null;\r\n    this._manualMouthParamEnabled = false;\n    this._manualMouthParamIds = [];\n    this._manualMouthParamIdSet.clear();\n    this.modelBaseWidth = null;\n    this.modelBaseHeight = null;\n    this.modelBaseBounds = null;\n    this._lastModelJson = null;\n    this._lastModelJsonSourceUrl = '';\n    this._revokeLocalBlobUrls();\n  },\n\r\n  /**\n   * \n   */\n  async _waitForTextures(\n    model: any,\r\n    onProgress?: (loadedCount: number, totalCount: number) => void,\r\n  ): Promise<boolean> {\r\n    return new Promise((resolve) => {\r\n      let retryCount = 0;\r\n      const maxRetries = 80;\r\n\r\n      const check = () => {\r\n        retryCount++;\r\n        if (retryCount > maxRetries) {\r\n          const internal = model.internalModel;\r\n          const textures = internal?.textures || internal?._textures || [];\r\n          const textureList = Array.isArray(textures) ? textures : [];\r\n          const loadedCount = textureList.filter((tex: any) => !!tex?.baseTexture?.valid).length;\r\n          onProgress?.(loadedCount, textureList.length);\r\n          warn(` (${loadedCount}/${textureList.length})`);\r\n          resolve(false);\r\n          return;\r\n        }\r\n\r\n        const internal = model.internalModel;\r\n        if (!internal) {\r\n          setTimeout(check, 100);\r\n          return;\r\n        }\r\n\r\n        const textures = internal.textures || internal._textures || [];\r\n        if (textures.length === 0) {\r\n          onProgress?.(1, 1);\r\n          resolve(true);\r\n          return;\r\n        }\r\n\r\n        const loadedCount = textures.filter((tex: any) => {\r\n          if (!tex) return false;\r\n          if (tex.baseTexture) return tex.baseTexture.valid;\r\n          return true;\r\n        }).length;\r\n        onProgress?.(loadedCount, textures.length);\r\n\r\n        const allLoaded = textures.every((tex: any) => {\r\n          if (!tex) return false;\r\n          if (tex.baseTexture) return tex.baseTexture.valid;\r\n          return true;\r\n        });\r\n\r\n        if (allLoaded) {\r\n          resolve(true);\r\n        } else {\r\n          setTimeout(check, 100);\r\n        }\r\n      };\r\n\r\n      check();\r\n    });\r\n  },\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import { SCRIPT_NAME } from '../core/constants';\nimport { Live2DManager } from './manager';\n\n// : TTSManager._getProxiedAudioUrl ( audio/tts-manager.ts)\nlet _ttsGetProxiedAudioUrlRef: ((url: string) => string) | null = null;\nexport function setLipSyncRefs({ getProxiedAudioUrl }: { getProxiedAudioUrl?: (url: string) => string }): void {\n  if (getProxiedAudioUrl) _ttsGetProxiedAudioUrlRef = getProxiedAudioUrl;\n}\n\nfunction getTopWindow(): Window {\n  try {\n    return window.parent ?? window;\n  } catch {\n    return window;\n  }\n}\n\n// ============================================\n// LipSync  ()\n// : galgame/src/live2d/lip-sync.js\n// ============================================\nexport const LipSyncManager = {\n  audioContext: null as AudioContext | null,\n  analyser: null as AnalyserNode | null,\n  dataArray: null as Uint8Array | null,\n  source: null as MediaElementAudioSourceNode | null,\n  animationFrameId: null as number | null,\n  currentCharacterId: null as string | null,\n  lastVolume: 0,\n  connectedAudioElements: new WeakSet<HTMLAudioElement>(),\n  _proxyAudio: null as HTMLAudioElement | null,\n  _proxyAudioCleanup: null as (() => void) | null,\n\n  config: {\n    fftSize: 256,\n    smoothingFactor: 0.5,\n    sensitivity: 2.5,\n    minThreshold: 0.01,\n  },\n\n  init(): void {\n    if (this.audioContext) {\n      if (this.audioContext.state === 'suspended') {\n        this.audioContext.resume().then(() => {\n          console.log(`[${SCRIPT_NAME}] LipSync: AudioContext `);\n        });\n      }\n      return;\n    }\n\n    const topAny: any = getTopWindow() as any;\n    const AudioContextClass = topAny.AudioContext || topAny.webkitAudioContext;\n    if (!AudioContextClass) {\n      console.warn(`[${SCRIPT_NAME}] LipSync:  Web Audio API`);\n      return;\n    }\n\n    this.audioContext = new AudioContextClass();\n    this.analyser = this.audioContext.createAnalyser();\n    this.analyser.fftSize = this.config.fftSize;\n    this.analyser.smoothingTimeConstant = this.config.smoothingFactor;\n    this.dataArray = new Uint8Array(this.analyser.frequencyBinCount);\n    console.log(`[${SCRIPT_NAME}] LipSyncManager `);\n  },\n\n  _getProxiedAudioUrl(originalUrl: string): string {\n    if (_ttsGetProxiedAudioUrlRef) {\n      return _ttsGetProxiedAudioUrlRef(originalUrl);\n    }\n\n    const topAny: any = getTopWindow() as any;\n\n    if (typeof topAny.getCorsProxyUrl === 'function') {\n      try {\n        const proxied = topAny.getCorsProxyUrl(originalUrl);\n        console.log(`[${SCRIPT_NAME}] LipSync:  getCorsProxyUrl `);\n        return proxied;\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] LipSync: getCorsProxyUrl `, e);\n      }\n    }\n\n    if (typeof topAny.enableCorsProxy === 'function') {\n      try {\n        const proxied = topAny.enableCorsProxy(originalUrl);\n        if (typeof proxied === 'string' && proxied) {\n          console.log(`[${SCRIPT_NAME}] LipSync:  enableCorsProxy `);\n          return proxied;\n        }\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] LipSync: enableCorsProxy `, e);\n      }\n    }\n\n    if (topAny.corsProxy?.getProxyUrl) {\n      try {\n        const proxied = topAny.corsProxy.getProxyUrl(originalUrl);\n        console.log(`[${SCRIPT_NAME}] LipSync:  corsProxy.getProxyUrl `);\n        return proxied;\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] LipSync: corsProxy.getProxyUrl `, e);\n      }\n    }\n\n    if (topAny.location) {\n      const origin = topAny.location.origin;\n      console.log(`[${SCRIPT_NAME}] LipSync:  /proxy`);\n      return `${origin}/proxy?url=${encodeURIComponent(originalUrl)}`;\n    }\n\n    return originalUrl;\n  },\n\n  connectAudio(audioElement: HTMLAudioElement): boolean {\n    if (!audioElement) return false;\n\n    if (this.connectedAudioElements.has(audioElement)) {\n      this.init();\n      if (this.audioContext?.state === 'suspended') {\n        this.audioContext.resume();\n      }\n      return true;\n    }\n\n    this.init();\n    if (!this.audioContext || !this.analyser) return false;\n\n    if (this.audioContext.state === 'suspended') {\n      this.audioContext.resume().catch(e => console.warn('AudioContext resume failed:', e));\n    }\n\n    try {\n      if (this.source) {\n        try {\n          this.source.disconnect();\n        } catch {\n          // ignore\n        }\n      }\n\n      const topAny: any = getTopWindow() as any;\n      let targetAudio: HTMLAudioElement = audioElement;\n      const src = audioElement.src || '';\n      const isLocalhost = src.includes('127.0.0.1') || src.includes('localhost');\n      const isDataUrl = src.startsWith('data:');\n      const isBlobUrl = src.startsWith('blob:');\n      let isSameOrigin = false;\n      try {\n        const base = topAny.location?.origin || window.location.origin;\n        const url = new URL(src, base);\n        isSameOrigin = url.origin === base;\n      } catch {\n        // ignore\n      }\n\n      if (!isLocalhost && !isDataUrl && !isBlobUrl && !isSameOrigin) {\n        console.log(`[${SCRIPT_NAME}] LipSync: `);\n        const proxiedUrl = this._getProxiedAudioUrl(src);\n        if (proxiedUrl && proxiedUrl !== src) {\n          targetAudio = new Audio(proxiedUrl);\n          targetAudio.crossOrigin = 'anonymous';\n          console.log(`[${SCRIPT_NAME}] LipSync: `, proxiedUrl.substring(0, 50) + '...');\n\n          targetAudio.currentTime = audioElement.currentTime;\n          targetAudio.volume = 0.001;\n\n          if (!audioElement.paused) {\n            targetAudio.play().catch(e => {\n              console.warn(`[${SCRIPT_NAME}] LipSync: `, e);\n            });\n          }\n\n          const syncPlay = () => {\n            if (this._proxyAudio && this._proxyAudio.paused) {\n              this._proxyAudio.currentTime = audioElement.currentTime;\n              this._proxyAudio.play().catch(() => {});\n            }\n          };\n          const syncPause = () => {\n            if (this._proxyAudio) {\n              this._proxyAudio.pause();\n            }\n          };\n          const syncSeek = () => {\n            if (this._proxyAudio) {\n              this._proxyAudio.currentTime = audioElement.currentTime;\n            }\n          };\n\n          audioElement.addEventListener('play', syncPlay);\n          audioElement.addEventListener('playing', syncPlay);\n          audioElement.addEventListener('pause', syncPause);\n          audioElement.addEventListener('ended', syncPause);\n          audioElement.addEventListener('seeked', syncSeek);\n\n          this._proxyAudio = targetAudio;\n          this._proxyAudioCleanup = () => {\n            audioElement.removeEventListener('play', syncPlay);\n            audioElement.removeEventListener('playing', syncPlay);\n            audioElement.removeEventListener('pause', syncPause);\n            audioElement.removeEventListener('ended', syncPause);\n            audioElement.removeEventListener('seeked', syncSeek);\n          };\n        }\n      }\n\n      console.log(`[${SCRIPT_NAME}] LipSync: `, targetAudio.src?.substring(0, 50) + '...');\n      this.source = this.audioContext.createMediaElementSource(targetAudio);\n      this.source.connect(this.analyser);\n      this.analyser.connect(this.audioContext.destination);\n      this.connectedAudioElements.add(audioElement);\n      return true;\n    } catch (e) {\n      console.warn(`[${SCRIPT_NAME}] LipSync:  ( Source )`, e);\n      return false;\n    }\n  },\n\n  getVolume(): number {\n    if (!this.analyser || !this.dataArray) return 0;\n    this.analyser.getByteFrequencyData(this.dataArray);\n\n    let sum = 0;\n    const length = Math.floor(this.dataArray.length * 0.75);\n    for (let i = 0; i < length; i++) {\n      sum += this.dataArray[i];\n    }\n    const average = sum / length / 255;\n    return Math.min(1, average * this.config.sensitivity);\n  },\n\n  async startSync(characterId: string): Promise<void> {\n    this.stopSync();\n    this.currentCharacterId = characterId;\n    Live2DManager._setLipSyncActive(true);\n\n    if (this.audioContext?.state === 'suspended') {\n      try {\n        await this.audioContext.resume();\n        console.log(`[${SCRIPT_NAME}] LipSync: AudioContext `);\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] LipSync: AudioContext `, e);\n      }\n    }\n\n    console.log(\n      `[${SCRIPT_NAME}] LipSync:  - characterId=${characterId}, AudioContext.state=${this.audioContext?.state}`,\n    );\n\n    let frameCount = 0;\n    const update = () => {\n      if (!this.currentCharacterId) return;\n\n      let volume = this.getVolume();\n      if (volume < this.config.minThreshold) volume = 0;\n\n      volume = this.lastVolume * 0.4 + volume * 0.6;\n      this.lastVolume = volume;\n\n      frameCount++;\n      if (frameCount % 30 === 0) {\n        console.log(`[${SCRIPT_NAME}] LipSync: =${volume.toFixed(3)}, rawData[0]=${this.dataArray?.[0]}`);\n      }\n\n      Live2DManager.setMouthOpen(this.currentCharacterId, volume);\n      this.animationFrameId = requestAnimationFrame(update);\n    };\n    update();\n  },\n\n  stopSync(): void {\n    if (this.animationFrameId) {\n      cancelAnimationFrame(this.animationFrameId);\n      this.animationFrameId = null;\n    }\n\n    if (this.currentCharacterId) {\n      Live2DManager.setMouthOpen(this.currentCharacterId, 0);\n    }\n    this.currentCharacterId = null;\n    this.lastVolume = 0;\n    Live2DManager._setLipSyncActive(false);\n\n    if (this._proxyAudioCleanup) {\n      try {\n        this._proxyAudioCleanup();\n      } catch {\n        // ignore\n      }\n      this._proxyAudioCleanup = null;\n    }\n\n    if (this._proxyAudio) {\n      try {\n        this._proxyAudio.pause();\n        this._proxyAudio.src = '';\n      } catch {\n        // ignore\n      }\n      this._proxyAudio = null;\n    }\n  },\n\n  cleanup(): void {\n    this.stopSync();\n    if (this.source) {\n      try {\n        this.source.disconnect();\n      } catch {\n        // ignore\n      }\n      this.source = null;\n    }\n  },\n};\n","import { SCRIPT_NAME } from '../core/constants';\r\nimport { useSettingsStore } from '../core/settings';\r\nimport { Live2DManager } from '../live2d/manager';\r\nimport { LipSyncManager } from '../live2d/lip-sync';\r\nimport {\r\n  TTS_PROVIDER,\r\n  getTTSProvider,\r\n  getGptSoVitsConfig,\r\n  getCharacterTTSVoice,\r\n  resolveVoiceByName,\r\n  inferResourceId,\r\n  normalizeGptSoVitsSwitchMode,\r\n  type TTSSpeakerVoice,\r\n} from './tts-config';\r\nimport { synthesizeToBlob } from './edge-tts-direct';\r\n\r\n// ============================================\r\n// TTS  (LittleWhiteBox / GPT-SoVITS / EdgeTTS Direct)\n// : galgame src/audio/tts-manager.js\n// ============================================\r\n\r\nexport type TTSSegment = {\r\n  type: 'dialogue' | 'narration';\r\n  speaker: string;\r\n  text: string;\r\n  tts?: {\r\n    speaker?: string;\r\n    context?: string;\r\n  };\r\n};\r\n\r\ntype ToastFn = (msg: string) => void;\r\n\r\nfunction getTopWindow(): Window {\r\n  try {\r\n    return window.parent ?? window;\r\n  } catch {\r\n    return window;\r\n  }\r\n}\r\n\r\nfunction getSettingsSnapshot(): any {\r\n  try {\r\n    const store = useSettingsStore();\r\n    return store.settings;\r\n  } catch {\r\n    return {};\r\n  }\r\n}\r\n\r\n// : showToast ( UI )\nlet _showToastRef: ToastFn | null = null;\r\nexport function setTTSManagerRefs({ showToast }: { showToast?: ToastFn }): void {\r\n  if (showToast) _showToastRef = showToast;\r\n}\r\n\r\nfunction showToast(msg: string): void {\r\n  if (_showToastRef) {\r\n    _showToastRef(msg);\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const topAny: any = getTopWindow() as any;\r\n    const t = topAny?.toastr || (window as any)?.toastr;\r\n    if (t?.info) {\r\n      t.info(msg);\r\n      return;\r\n    }\r\n  } catch {\r\n    // ignore\r\n  }\r\n\r\n  console.log(`[${SCRIPT_NAME}]`, msg);\r\n}\r\n\r\nfunction clipText(text: unknown, max = 160): string {\r\n  const value = String(text || '');\r\n  if (value.length <= max) return value;\r\n  return `${value.slice(0, max)}...`;\r\n}\r\n\r\nfunction isProxyNotFound(status: number, bodyText = ''): boolean {\r\n  if (status !== 404) return false;\r\n  const body = String(bodyText || '').toLowerCase();\r\n  return body.includes('not found') || body.includes('/proxy') || body.includes('cannot get');\r\n}\r\n\r\nfunction safeUrl(input: unknown): URL | null {\r\n  try {\r\n    return new URL(String(input || ''));\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nfunction hasLive2D(): boolean {\r\n  return !!Live2DManager.model;\r\n}\r\n\r\nexport const TTSManager = {\r\n  enabled: true,\r\n  provider: TTS_PROVIDER.LITTLEWHITEBOX,\r\n  autoPlay: true,\r\n  isPlaying: false,\r\n  isLoading: false,\r\n  currentAudio: null as HTMLAudioElement | null,\r\n  currentSegmentId: null as string | null,\r\n  littleWhiteBox: null as any,\r\n  xiaobaixTts: null as any,\r\n\r\n  _gptSoVitsResolvedProxyRoute: '',\r\n  _gptSoVitsActiveWeights: { gpt: '', sovits: '' },\r\n  _gptSoVitsWeightSwitchUnavailable: false,\r\n  _gptSoVitsWeightSwitchWarned: false,\r\n  _gptSoVitsProxyWarned: false,\r\n  _gptSoVitsFetchController: null as AbortController | null,\r\n  _edgeDirectFetchController: null as AbortController | null,\r\n  _edgeDirectSocket: null as WebSocket | null,\r\n  _edgeDirectObjectUrl: '' as string,\r\n\r\n  _refreshProviderState(): boolean {\r\n    const provider = getTTSProvider();\r\n    this.provider = provider;\r\n    this.autoPlay = getSettingsSnapshot()?.ttsAutoPlay !== false;\r\n\r\n    const topAny: any = getTopWindow() as any;\r\n\r\n    if (provider === TTS_PROVIDER.LITTLEWHITEBOX) {\r\n      this.xiaobaixTts = null;\r\n      this.littleWhiteBox = null;\r\n\r\n      if (topAny?.xiaobaixTts) {\r\n        this.xiaobaixTts = topAny.xiaobaixTts;\r\n        console.log(`[${SCRIPT_NAME}] TTSManager:  xiaobaixTts`);\n      } else if (topAny?.LittleWhiteBox) {\r\n        this.littleWhiteBox = topAny.LittleWhiteBox;\r\n        console.log(`[${SCRIPT_NAME}] TTSManager:  LittleWhiteBox`);\n      }\r\n\r\n      if (!this.xiaobaixTts && !this.littleWhiteBox) {\n        console.warn(`[${SCRIPT_NAME}] TTSManager:  xiaobaixTts/LittleWhiteBoxTTS`);\n        this.enabled = false;\r\n        return false;\r\n      }\r\n\r\n      this.enabled = true;\r\n      return true;\r\n    }\r\n\r\n    if (provider === TTS_PROVIDER.GPT_SOVITS_V2) {\r\n      this.enabled = true;\r\n      return true;\r\n    }\r\n\r\n    if (provider === TTS_PROVIDER.EDGE_TTS_DIRECT) {\r\n      this.enabled = true;\r\n      return true;\r\n    }\r\n\r\n    this.enabled = true;\r\n    return true;\r\n  },\r\n\r\n  _onPlaybackEnded(reason = 'unknown'): void {\r\n    this._cleanupEdgeDirectResources();\r\n    console.log(`[${SCRIPT_NAME}] TTS:  - reason=${reason}`);\n    this.isPlaying = false;\r\n    this.isLoading = false;\r\n    this.currentAudio = null;\r\n    this.currentSegmentId = null;\r\n    this.hideLoadingIndicator();\r\n    LipSyncManager.stopSync();\r\n  },\r\n\r\n  init(): void {\r\n    this._refreshProviderState();\r\n\r\n    try {\r\n      const topAny: any = getTopWindow() as any;\r\n      const jq = topAny?.jQuery || topAny?.$;\r\n      if (jq) {\r\n        jq(topAny).on('tts_complete tts_end', () => {\r\n          this._onPlaybackEnded('littlewhitebox_event');\r\n        });\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n  },\r\n\r\n  showLoadingIndicator(): void {\r\n    try {\r\n      const top = getTopWindow();\r\n      top.document.getElementById('desktop-pet-stage')?.classList.add('desktop-pet-tts-active');\r\n    } catch {\r\n      // ignore\r\n    }\r\n  },\r\n\r\n  hideLoadingIndicator(): void {\r\n    try {\r\n      const top = getTopWindow();\r\n      top.document.getElementById('desktop-pet-stage')?.classList.remove('desktop-pet-tts-active');\r\n    } catch {\r\n      // ignore\r\n    }\r\n  },\r\n\r\n  _abortGptSoVitsFetch(reason = 'manual'): void {\r\n    if (this._gptSoVitsFetchController) {\r\n      try {\r\n        this._gptSoVitsFetchController.abort(reason);\r\n      } catch {\r\n        // ignore\r\n      }\r\n      this._gptSoVitsFetchController = null;\r\n    }\r\n  },\r\n\r\n  _cleanupEdgeDirectResources(): void {\r\n    if (this._edgeDirectFetchController) {\r\n      try {\r\n        this._edgeDirectFetchController.abort('cleanup');\r\n      } catch {\r\n        // ignore\r\n      }\r\n      this._edgeDirectFetchController = null;\r\n    }\r\n\r\n    if (this._edgeDirectSocket) {\r\n      try {\r\n        this._edgeDirectSocket.close(1000, 'cleanup');\r\n      } catch {\r\n        // ignore\r\n      }\r\n      this._edgeDirectSocket = null;\r\n    }\r\n\r\n    if (this._edgeDirectObjectUrl) {\r\n      try {\r\n        URL.revokeObjectURL(this._edgeDirectObjectUrl);\r\n      } catch {\r\n        // ignore\r\n      }\r\n      this._edgeDirectObjectUrl = '';\r\n    }\r\n  },\r\n\r\n  stop(): void {\r\n    if (\r\n      !this.isPlaying &&\r\n      !this.isLoading &&\r\n      !this._edgeDirectSocket &&\r\n      !this._edgeDirectFetchController &&\r\n      !this._edgeDirectObjectUrl\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    this._abortGptSoVitsFetch('stop');\r\n    this._cleanupEdgeDirectResources();\r\n    console.log(`[${SCRIPT_NAME}] TTS: `);\n\r\n    try {\r\n      if (this.currentAudio && typeof this.currentAudio.pause === 'function') {\r\n        try {\r\n          this.currentAudio.pause();\r\n        } catch {\r\n          // ignore\r\n        }\r\n        try {\r\n          this.currentAudio.src = '';\r\n          if (typeof this.currentAudio.load === 'function') this.currentAudio.load();\r\n        } catch {\r\n          // ignore\r\n        }\r\n      }\r\n\r\n      if (this.xiaobaixTts && this.xiaobaixTts.player) {\r\n        const player = this.xiaobaixTts.player;\r\n        if (typeof player._stopCurrent === 'function') {\r\n          player._stopCurrent();\r\n        }\r\n        if (typeof player.clear === 'function') {\r\n          player.clear();\r\n          console.log(`[${SCRIPT_NAME}] TTS: `);\r\n        }\r\n      } else if (this.xiaobaixTts && typeof this.xiaobaixTts.stop === 'function') {\r\n        this.xiaobaixTts.stop();\r\n      } else if (this.littleWhiteBox && typeof this.littleWhiteBox.stop === 'function') {\r\n        this.littleWhiteBox.stop();\r\n      }\r\n    } catch (e) {\r\n      console.warn(`[${SCRIPT_NAME}] TTS: `, e);\r\n    }\r\n\r\n    this.isPlaying = false;\r\n    this.isLoading = false;\r\n    this.currentAudio = null;\r\n    this.currentSegmentId = null;\r\n    this.hideLoadingIndicator();\r\n    LipSyncManager.stopSync();\r\n  },\r\n\r\n  _getCurrentAudioElement(): HTMLAudioElement | null {\r\n    if (this.currentAudio) return this.currentAudio;\r\n\r\n    if (this.xiaobaixTts?.player?.currentAudio) {\r\n      return this.xiaobaixTts.player.currentAudio;\r\n    }\r\n    if (this.xiaobaixTts?.player?.audio) {\r\n      return this.xiaobaixTts.player.audio;\r\n    }\r\n    if (this.xiaobaixTts?.player?.audioElements?.length > 0) {\r\n      return this.xiaobaixTts.player.audioElements[0];\r\n    }\r\n    if (this.xiaobaixTts?.audio) {\r\n      return this.xiaobaixTts.audio;\r\n    }\r\n\r\n    const top = getTopWindow();\r\n    const allAudio = top.document.querySelectorAll('audio');\r\n    for (const audio of allAudio) {\r\n      if ((audio as HTMLAudioElement).src && !(audio as HTMLAudioElement).paused) {\r\n        return audio as HTMLAudioElement;\r\n      }\r\n    }\r\n    const anyAudio = top.document.querySelector('audio[src]') as HTMLAudioElement | null;\r\n    if (anyAudio) return anyAudio;\r\n    return null;\r\n  },\r\n\r\n  _getPreferredAudioElement(): HTMLAudioElement | null {\r\n    if (this.currentAudio) return this.currentAudio;\r\n    if (this.xiaobaixTts?.player?.currentAudio) {\r\n      return this.xiaobaixTts.player.currentAudio;\r\n    }\r\n    if (this.xiaobaixTts?.player?.audio) {\r\n      return this.xiaobaixTts.player.audio;\r\n    }\r\n    if (this.xiaobaixTts?.player?.audioElements?.length > 0) {\r\n      return this.xiaobaixTts.player.audioElements[0];\r\n    }\r\n    if (this.xiaobaixTts?.audio) {\r\n      return this.xiaobaixTts.audio;\r\n    }\r\n    return null;\r\n  },\r\n\r\n  _isProxyUrl(url: unknown): boolean {\r\n    const parsed = safeUrl(url);\r\n    if (!parsed) return false;\r\n    return /^\\/proxy(\\/|\\?|$)/i.test(parsed.pathname);\r\n  },\r\n\r\n  _buildGptSoVitsProxyUrl(route: string, originalUrl: string): string {\r\n    const direct = String(originalUrl || '').trim();\r\n    if (!direct) return '';\r\n    const encoded = encodeURIComponent(direct);\r\n    const origin = window.location?.origin || '';\r\n\r\n    switch (route) {\r\n      case 'proxy_path_relative':\r\n        return `/proxy/${encoded}`;\r\n      case 'proxy_path_origin':\r\n        return origin ? `${origin}/proxy/${encoded}` : '';\r\n      case 'proxy_query_relative':\r\n        return `/proxy?url=${encoded}`;\r\n      case 'proxy_query_origin':\r\n        return origin ? `${origin}/proxy?url=${encoded}` : '';\r\n      default:\r\n        return '';\r\n    }\r\n  },\r\n\r\n  _rememberProxyRoute(route: string, url: string): void {\r\n    if (!route) return;\r\n    if (this._gptSoVitsResolvedProxyRoute !== route) {\r\n      this._gptSoVitsResolvedProxyRoute = route;\r\n      console.log(`[${SCRIPT_NAME}] GPT-SoVITS ? ${route} -> ${clipText(url, 96)}`);\r\n    }\r\n  },\r\n\r\n  _getProxiedAudioUrl(originalUrl: string): string {\r\n    const directUrl = String(originalUrl || '').trim();\r\n    if (!directUrl) return directUrl;\r\n    if (this._isProxyUrl(directUrl)) return directUrl;\r\n\r\n    const topAny: any = getTopWindow() as any;\r\n\r\n    if (typeof topAny.getCorsProxyUrl === 'function') {\r\n      try {\r\n        const proxied = topAny.getCorsProxyUrl(directUrl);\r\n        if (typeof proxied === 'string' && proxied) return proxied;\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    if (typeof topAny.enableCorsProxy === 'function') {\r\n      try {\r\n        const proxied = topAny.enableCorsProxy(directUrl);\r\n        if (typeof proxied === 'string' && proxied) return proxied;\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    if (topAny.corsProxy?.getProxyUrl) {\r\n      try {\r\n        const proxied = topAny.corsProxy.getProxyUrl(directUrl);\r\n        if (typeof proxied === 'string' && proxied) return proxied;\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    const remembered = String(this._gptSoVitsResolvedProxyRoute || '').trim();\r\n    if (remembered) {\r\n      const rememberedUrl = this._buildGptSoVitsProxyUrl(remembered, directUrl);\r\n      if (rememberedUrl) return rememberedUrl;\r\n    }\r\n\r\n    return (\r\n      this._buildGptSoVitsProxyUrl('proxy_path_relative', directUrl) ||\r\n      this._buildGptSoVitsProxyUrl('proxy_query_relative', directUrl) ||\r\n      directUrl\r\n    );\r\n  },\r\n\r\n  _buildGptSoVitsTtsUrl(text: string, resolvedVoice: TTSSpeakerVoice): string {\n    const cfg = getGptSoVitsConfig();\n    const base = String(cfg.apiUrl || '').replace(/\\/$/, '');\n    const endpointRaw = String(cfg.endpoint || '/tts').trim();\n    const endpoint = endpointRaw.startsWith('/') ? endpointRaw : `/${endpointRaw}`;\r\n    if (!base) return '';\r\n\r\n    try {\n      const url = new URL(base + endpoint);\n      const modelCfg: any = (resolvedVoice as any)?.gptSoVitsModel || null;\n      const modelParams: any = modelCfg?.params || {};\n      const vcfg: any = resolvedVoice?.gptSoVits || {};\n\n      const textLang = String(vcfg.textLang || modelParams.textLang || cfg.textLang || 'auto').trim() || 'auto';\n      const promptLang = String(vcfg.promptLang || modelParams.promptLang || 'zh').trim() || 'zh';\n      const refAudioPath = String(vcfg.refAudioPath || '').trim();\n      const promptText = String(vcfg.promptText || modelParams.promptText || '').trim();\n      const textSplitMethod = String(vcfg.textSplitMethod || modelParams.textSplitMethod || cfg.textSplitMethod || '').trim();\n      const mediaType = String(vcfg.mediaType || modelParams.mediaType || cfg.mediaType || '').trim();\n      const streamingMode = !!(vcfg.streamingMode ?? modelParams.streamingMode ?? cfg.streamingMode);\n      const speedFactor = Number(vcfg.speedFactor ?? modelParams.speedFactor ?? cfg.speedFactor);\n\n      url.searchParams.set('text', text);\n      url.searchParams.set('text_lang', textLang);\n      url.searchParams.set('ref_audio_path', refAudioPath);\n      url.searchParams.set('prompt_lang', promptLang);\n      url.searchParams.set('prompt_text', promptText);\n\n      if (textSplitMethod) url.searchParams.set('text_split_method', textSplitMethod);\n      if (mediaType) url.searchParams.set('media_type', mediaType);\n      url.searchParams.set('streaming_mode', streamingMode ? 'true' : 'false');\n      if (Number.isFinite(speedFactor) && speedFactor > 0) {\n        url.searchParams.set('speed_factor', String(speedFactor));\n      }\n\n      return url.toString();\n    } catch (e) {\n      console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: URL`, e);\n      return '';\r\n    }\r\n  },\r\n\r\n  async _requestGptSoVitsApi(\r\n    method: 'GET' | 'POST',\r\n    pathname: string,\r\n    queryParams: Record<string, any> = {},\r\n    jsonBody: any = undefined,\r\n  ): Promise<{ text: string; status: number; url: string; route: string }> {\r\n    const cfg = getGptSoVitsConfig();\r\n    const base = String(cfg.apiUrl || '').replace(/\\/$/, '');\r\n    const pathRaw = String(pathname || '').trim() || '/';\r\n    const path = pathRaw.startsWith('/') ? pathRaw : `/${pathRaw}`;\r\n    if (!base) throw new Error('GPT-SoVITS API ');\n\r\n    const directUrlObj = new URL(base + path);\r\n    Object.entries(queryParams || {}).forEach(([key, value]) => {\r\n      if (value !== undefined && value !== null && value !== '') {\r\n        directUrlObj.searchParams.set(String(key), String(value));\r\n      }\r\n    });\r\n    const directUrl = directUrlObj.toString();\r\n\r\n    const attemptTargets: Array<{ route: string; url: string }> = [];\r\n    if (!cfg.useCorsProxy) {\r\n      attemptTargets.push({ route: 'direct', url: directUrl });\r\n    } else {\r\n      const preferred = String(this._gptSoVitsResolvedProxyRoute || '').trim();\r\n      const seen = new Set<string>();\r\n      const addTarget = (route: string, url: string) => {\r\n        if (!url || seen.has(url)) return;\r\n        seen.add(url);\r\n        attemptTargets.push({ route, url });\r\n      };\r\n\r\n      if (preferred) addTarget(preferred, this._buildGptSoVitsProxyUrl(preferred, directUrl));\r\n      addTarget('proxy_path_relative', this._buildGptSoVitsProxyUrl('proxy_path_relative', directUrl));\r\n      addTarget('proxy_path_origin', this._buildGptSoVitsProxyUrl('proxy_path_origin', directUrl));\r\n      addTarget('proxy_query_relative', this._buildGptSoVitsProxyUrl('proxy_query_relative', directUrl));\r\n      addTarget('proxy_query_origin', this._buildGptSoVitsProxyUrl('proxy_query_origin', directUrl));\r\n      addTarget('direct', directUrl);\r\n    }\r\n\r\n    const errors: string[] = [];\r\n    for (const target of attemptTargets) {\r\n      const controller = new AbortController();\r\n      this._gptSoVitsFetchController = controller;\r\n\r\n      try {\r\n        const options: RequestInit & { headers: Record<string, string> } = {\r\n          method,\r\n          mode: 'cors',\r\n          credentials: 'omit',\r\n          signal: controller.signal,\r\n          headers: {},\r\n        };\r\n\r\n        if (jsonBody !== undefined) {\r\n          options.headers['Content-Type'] = 'application/json';\r\n          options.body = JSON.stringify(jsonBody);\r\n        }\r\n\r\n        const response = await fetch(target.url, options);\r\n        const text = await response.text();\r\n\r\n        if (response.ok) {\r\n          if (target.route !== 'direct') {\r\n            this._rememberProxyRoute(target.route, target.url);\r\n          }\r\n          return { text, status: response.status, url: target.url, route: target.route };\r\n        }\r\n\r\n        if (target.route !== 'direct' && isProxyNotFound(response.status, text)) {\r\n          errors.push(`${target.route}:HTTP${response.status}(proxy-not-found)`);\r\n          continue;\r\n        }\r\n\r\n        errors.push(`${target.route}:HTTP${response.status}:${clipText(text, 120)}`);\r\n      } catch (e: any) {\r\n        const msg = e?.message || String(e);\r\n        errors.push(`${target.route}:${msg}`);\r\n      } finally {\r\n        if (this._gptSoVitsFetchController === controller) {\r\n          this._gptSoVitsFetchController = null;\r\n        }\r\n      }\r\n    }\r\n\r\n    throw new Error(`${method} ${path}  -> ${errors.join(' | ')}`);\n  },\r\n\r\n  async _fetchGptSoVitsApi(pathname: string, queryParams: Record<string, any> = {}): Promise<string> {\r\n    const { text } = await this._requestGptSoVitsApi('GET', pathname, queryParams);\r\n    return text;\r\n  },\r\n\r\n  async _postGptSoVitsApi(pathname: string, jsonBody: Record<string, any> = {}): Promise<string> {\r\n    const { text } = await this._requestGptSoVitsApi('POST', pathname, {}, jsonBody);\r\n    return text;\r\n  },\r\n\r\n  async _setGptSoVitsWeights(kind: 'gpt' | 'sovits', weightsPath: string): Promise<void> {\r\n    const normalizedKind = kind === 'gpt' ? 'gpt' : 'sovits';\r\n    const path = String(weightsPath || '').trim();\r\n    if (!path) return;\r\n    const endpoint = `/set_${normalizedKind}_weights`;\r\n    await this._fetchGptSoVitsApi(endpoint, { weights_path: path });\r\n  },\r\n\r\n  async _setGptSoVitsModelPair(\r\n    gptWeightsPath: string,\r\n    sovitsWeightsPath: string,\r\n    endpointOverride = '',\r\n  ): Promise<void> {\r\n    const cfg = getGptSoVitsConfig();\r\n    const endpoint = String(endpointOverride || cfg.setModelEndpoint || '/set_model').trim() || '/set_model';\r\n\r\n    try {\r\n      await this._postGptSoVitsApi(endpoint, {\r\n        gpt_model_path: String(gptWeightsPath || '').trim(),\r\n        sovits_model_path: String(sovitsWeightsPath || '').trim(),\r\n      });\r\n      return;\r\n    } catch {\r\n      await this._fetchGptSoVitsApi(endpoint, {\r\n        gpt_model_path: String(gptWeightsPath || '').trim(),\r\n        sovits_model_path: String(sovitsWeightsPath || '').trim(),\r\n      });\r\n    }\r\n  },\r\n\r\n  async _ensureGptSoVitsWeights(resolvedVoice: TTSSpeakerVoice): Promise<boolean> {\n    const cfg = getGptSoVitsConfig();\n    const modelCfg: any = (resolvedVoice as any)?.gptSoVitsModel || null;\n    const vcfg: any = resolvedVoice?.gptSoVits || {};\n    const modelParams: any = modelCfg?.params || {};\n    const modelPaths: any = modelCfg?.paths || {};\n\n    const strictWeightSwitch = !!(vcfg.strictWeightSwitch ?? modelParams.strictWeightSwitch ?? cfg.strictWeightSwitch);\n    let switchMode = normalizeGptSoVitsSwitchMode(vcfg.modelSwitchMode || modelParams.modelSwitchMode || cfg.modelSwitchMode);\n    const setModelEndpoint = String(\n      vcfg.setModelEndpoint || modelParams.setModelEndpoint || cfg.setModelEndpoint || '/set_model',\n    ).trim() || '/set_model';\n    const desiredGpt = String(vcfg.gptWeightsPath || modelPaths.gptWeightsPath || '').trim();\n    const desiredSovits = String(vcfg.sovitsWeightsPath || modelPaths.sovitsWeightsPath || '').trim();\n\n    if (switchMode === 'none') return false;\n    if (!desiredGpt && !desiredSovits) return true;\n    if (this._gptSoVitsWeightSwitchUnavailable) {\n      if (!this._gptSoVitsWeightSwitchWarned) {\n        this._gptSoVitsWeightSwitchWarned = true;\n        showToast('GPT-SoVITS:  /set_*CORS/');\n      }\n      if (strictWeightSwitch) {\n        throw new Error(' CORS ');\n      }\n      return false;\n    }\n\n    const failures: string[] = [];\n    const trySetModelFallback = async (triggerMsg: unknown): Promise<boolean> => {\n      const canFallback = switchMode === 'set_weights' && !!desiredGpt && !!desiredSovits && !strictWeightSwitch;\n      if (!canFallback) return false;\n      const msg = String(triggerMsg || '');\n      const looksLikeEndpointMismatch = /404|405|not found|cannot\\s+(get|post)|method not allowed/i.test(msg);\n      if (!looksLikeEndpointMismatch) return false;\n\n      try {\n        console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: set_weights  set_model`);\n        await this._setGptSoVitsModelPair(desiredGpt, desiredSovits, setModelEndpoint);\n        this._gptSoVitsActiveWeights.gpt = desiredGpt;\n        this._gptSoVitsActiveWeights.sovits = desiredSovits;\n        return true;\n      } catch (fallbackErr) {\n        console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: set_model `, fallbackErr);\n        return false;\n      }\n    };\n\n    if (switchMode === 'set_model' && desiredGpt && desiredSovits) {\n      const needPairSwitch =\n        desiredGpt !== this._gptSoVitsActiveWeights.gpt || desiredSovits !== this._gptSoVitsActiveWeights.sovits;\n      if (needPairSwitch) {\n        let setModelError = '';\n        let setModelFetchBlocked = false;\n\n        try {\n          await this._setGptSoVitsModelPair(desiredGpt, desiredSovits, setModelEndpoint);\n          this._gptSoVitsActiveWeights.gpt = desiredGpt;\n          this._gptSoVitsActiveWeights.sovits = desiredSovits;\n        } catch (e) {\n          setModelError = String((e as any)?.message || e || 'unknown error');\n          setModelFetchBlocked = /failed to fetch/i.test(setModelError);\n          console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: set_model `, e);\n        }\n\n        if (setModelError && !strictWeightSwitch) {\n          console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: set_model  set_weights `);\n          try {\n            if (desiredGpt && desiredGpt !== this._gptSoVitsActiveWeights.gpt) {\n              await this._setGptSoVitsWeights('gpt', desiredGpt);\n              this._gptSoVitsActiveWeights.gpt = desiredGpt;\n            }\n            if (desiredSovits && desiredSovits !== this._gptSoVitsActiveWeights.sovits) {\n              await this._setGptSoVitsWeights('sovits', desiredSovits);\n              this._gptSoVitsActiveWeights.sovits = desiredSovits;\n            }\n            setModelError = '';\n          } catch (fallbackErr) {\n            const fallbackMsg = String((fallbackErr as any)?.message || fallbackErr || 'unknown error');\n            setModelError = `${setModelError} | fallback_set_weights: ${fallbackMsg}`;\n          }\n        }\n\n        if (setModelError && setModelFetchBlocked) {\n          this._gptSoVitsWeightSwitchUnavailable = true;\n          console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: /set_model `);\n          if (!strictWeightSwitch) {\n            if (!this._gptSoVitsWeightSwitchWarned) {\n              this._gptSoVitsWeightSwitchWarned = true;\n              showToast('GPT-SoVITS:  /set_*CORS/');\n            }\n            return false;\n          }\n        }\n\n        if (setModelError) {\n          failures.push(`set_model: ${setModelError}`);\n        }\n      }\n\n      if (failures.length > 0) {\n        if (strictWeightSwitch) {\n          throw new Error(`: ${failures.join(' | ')}`);\n        }\n        const clipped = failures[0].length > 120 ? `${failures[0].slice(0, 120)}...` : failures[0];\n        showToast(`GPT-SoVITS ${clipped}`);\n      }\n      return true;\n    }\n\n    if (switchMode === 'set_model' && (!desiredGpt || !desiredSovits)) {\n      console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: modelSwitchMode=set_model  set_weights `);\n      switchMode = 'set_weights';\n    }\n\n    if (switchMode === 'set_weights') {\n      if (desiredGpt && desiredGpt !== this._gptSoVitsActiveWeights.gpt) {\n        try {\n          await this._setGptSoVitsWeights('gpt', desiredGpt);\n          this._gptSoVitsActiveWeights.gpt = desiredGpt;\n        } catch (e) {\n          const msg = String((e as any)?.message || e || 'unknown error');\n          if (await trySetModelFallback(msg)) {\n            return true;\n          }\n          failures.push(`gpt: ${msg}`);\n          const fetchBlocked = /failed to fetch/i.test(msg);\n          if (fetchBlocked) this._gptSoVitsWeightSwitchUnavailable = true;\n          if (fetchBlocked) {\n            console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: /set_gpt_weights `);\n            if (!strictWeightSwitch) {\n              if (!this._gptSoVitsWeightSwitchWarned) {\n                this._gptSoVitsWeightSwitchWarned = true;\n                showToast('GPT-SoVITS:  /set_*CORS/');\n              }\n              return false;\n            }\n          } else {\n            console.warn(`[${SCRIPT_NAME}] GPT-SoVITS:  gpt `, e);\n          }\n        }\n      }\n\n      if (desiredSovits && desiredSovits !== this._gptSoVitsActiveWeights.sovits) {\n        try {\n          await this._setGptSoVitsWeights('sovits', desiredSovits);\n          this._gptSoVitsActiveWeights.sovits = desiredSovits;\n        } catch (e) {\n          const msg = String((e as any)?.message || e || 'unknown error');\n          if (await trySetModelFallback(msg)) {\n            return true;\n          }\n          failures.push(`sovits: ${msg}`);\n          const fetchBlocked = /failed to fetch/i.test(msg);\n          if (fetchBlocked) this._gptSoVitsWeightSwitchUnavailable = true;\n          if (fetchBlocked) {\n            console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: /set_sovits_weights `);\n            if (!strictWeightSwitch) {\n              if (!this._gptSoVitsWeightSwitchWarned) {\n                this._gptSoVitsWeightSwitchWarned = true;\n                showToast('GPT-SoVITS:  /set_*CORS/');\n              }\n              return false;\n            }\n          } else {\n            console.warn(`[${SCRIPT_NAME}] GPT-SoVITS:  sovits `, e);\n          }\n        }\n      }\n    }\n\n    if (failures.length > 0) {\n      const detail = failures[0];\n      const clipped = detail.length > 120 ? `${detail.slice(0, 120)}...` : detail;\n      if (strictWeightSwitch) {\n        throw new Error(`: ${failures.join(' | ')}`);\n      }\n      showToast(`GPT-SoVITS ${clipped}`);\n    }\n\n    return true;\n  },\n\r\n  async _speakWithGptSoVits(segment: TTSSegment, segmentId: string, resolvedVoice: TTSSpeakerVoice): Promise<boolean> {\r\n    const cfg = getGptSoVitsConfig();\r\n    const vcfg: any = resolvedVoice?.gptSoVits || {};\r\n\r\n    if (!cfg.apiUrl) {\r\n      showToast('GPT-SoVITS:  API ');\n      return false;\r\n    }\r\n    if (!String(vcfg.refAudioPath || '').trim()) {\r\n      showToast('GPT-SoVITS:  refAudioPath');\n      return false;\r\n    }\r\n\r\n    try {\n      await this._ensureGptSoVitsWeights(resolvedVoice);\n    } catch (e: any) {\n      const reason = String(e?.message || e || 'unknown error');\n      showToast(`GPT-SoVITS ${clipText(reason, 120)}`);\n      return false;\n    }\n\r\n    const directUrl = this._buildGptSoVitsTtsUrl(segment.text, resolvedVoice);\r\n    if (!directUrl) {\r\n      showToast('GPT-SoVITS: URL');\n      return false;\r\n    }\r\n\r\n    const audioUrl = cfg.useCorsProxy ? this._getProxiedAudioUrl(directUrl) : directUrl;\r\n\r\n    const audio = new Audio();\r\n    audio.crossOrigin = 'anonymous';\r\n    audio.src = audioUrl;\r\n\r\n    this.currentAudio = audio;\r\n    this.currentSegmentId = segmentId;\r\n\r\n    const onEnded = () => {\r\n      if (this.currentAudio === audio) {\r\n        this._onPlaybackEnded('gpt_sovits_audio_ended');\r\n      }\r\n    };\r\n    const onError = (e: any) => {\r\n      console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: audio error`, e);\r\n      if (!this._gptSoVitsProxyWarned && cfg.useCorsProxy) {\r\n        this._gptSoVitsProxyWarned = true;\r\n        showToast('GPT-SoVITS  /proxy  CORS ');\r\n      } else {\r\n        showToast('GPT-SoVITS //CORS');\r\n      }\r\n      onEnded();\r\n    };\r\n\r\n    audio.addEventListener('ended', onEnded, { once: true });\r\n    audio.addEventListener('error', onError, { once: true });\r\n\r\n    try {\r\n      await audio.play();\r\n    } catch (e) {\r\n      console.warn(`[${SCRIPT_NAME}] GPT-SoVITS: play() `, e);\n      showToast('GPT-SoVITS ');\n      onEnded();\r\n      return false;\r\n    }\r\n\r\n    this.isPlaying = true;\r\n\r\n    if (hasLive2D()) {\r\n      const lipId = segment.speaker || 'pet';\r\n      console.log(`[${SCRIPT_NAME}] TTS: : hasLive2D=true, speaker=${lipId}`);\n      this._startLipSyncOnPlay(lipId);\r\n    } else {\r\n      console.log(`[${SCRIPT_NAME}] TTS: Live2D `);\n    }\r\n\r\n    return true;\r\n  },\r\n\r\n  async _speakWithEdgeDirect(segment: TTSSegment, segmentId: string, resolvedVoice: TTSSpeakerVoice): Promise<boolean> {\r\n    const voiceName = String(resolvedVoice.value || resolvedVoice.name || '').trim();\r\n    if (!voiceName) {\r\n      showToast('EdgeTTS ');\r\n      return false;\r\n    }\r\n\r\n    this._cleanupEdgeDirectResources();\r\n\r\n    const controller = new AbortController();\r\n    this._edgeDirectFetchController = controller;\r\n\r\n    let blob: Blob;\r\n    try {\r\n      blob = await synthesizeToBlob(segment.text, resolvedVoice, {\r\n        signal: controller.signal,\r\n        onSocket: socket => {\r\n          this._edgeDirectSocket = socket;\r\n        },\r\n      });\r\n    } catch (e: any) {\r\n      const isAbort = e?.name === 'AbortError';\r\n      if (!isAbort) {\n        const reason = clipText(e?.message || String(e), 180);\n        const blockedHint = /likely-cause=ua-not-edg/i.test(reason)\n          ? ' Edge Edge '\n          : /1006|403|websocket/i.test(reason)\n            ? ' CSP/ wss  Edge '\n            : '';\n        console.warn(`[${SCRIPT_NAME}] EdgeTTS :`, e);\n        showToast(`EdgeTTS ${reason}${blockedHint}`);\n      }\n      return false;\r\n    } finally {\r\n      if (this._edgeDirectFetchController === controller) {\r\n        this._edgeDirectFetchController = null;\r\n      }\r\n      this._edgeDirectSocket = null;\r\n    }\r\n\r\n    if (!blob || blob.size <= 0) {\r\n      showToast('EdgeTTS ');\r\n      return false;\r\n    }\r\n\r\n    const objectUrl = URL.createObjectURL(blob);\r\n    this._edgeDirectObjectUrl = objectUrl;\r\n\r\n    const audio = new Audio();\r\n    audio.crossOrigin = 'anonymous';\r\n    audio.src = objectUrl;\r\n\r\n    this.currentAudio = audio;\r\n    this.currentSegmentId = segmentId;\r\n\r\n    const onEnded = () => {\r\n      if (this.currentAudio === audio) {\r\n        this._onPlaybackEnded('edge_direct_audio_ended');\r\n      }\r\n    };\r\n    const onError = (err: any) => {\r\n      console.warn(`[${SCRIPT_NAME}] EdgeTTS :`, err);\r\n      showToast('EdgeTTS  Edge ');\r\n      onEnded();\r\n    };\r\n\r\n    audio.addEventListener('ended', onEnded, { once: true });\r\n    audio.addEventListener('error', onError, { once: true });\r\n\r\n    try {\r\n      await audio.play();\r\n    } catch (e) {\r\n      console.warn(`[${SCRIPT_NAME}] EdgeTTS  play() :`, e);\r\n      showToast('EdgeTTS ');\r\n      onEnded();\r\n      return false;\r\n    }\r\n\r\n    this.isPlaying = true;\r\n\r\n    if (hasLive2D()) {\r\n      const lipId = segment.speaker || 'pet';\r\n      this._startLipSyncOnPlay(lipId);\r\n    }\r\n\r\n    return true;\r\n  },\r\n\r\n  _startLipSyncWhenModelReady(characterId: string, maxWait = 5000): void {\r\n    const startTime = Date.now();\r\n    const tryWait = () => {\r\n      if (hasLive2D()) {\r\n        this._startLipSyncOnPlay(characterId, maxWait);\r\n        return;\r\n      }\r\n      if (Date.now() - startTime < maxWait) {\r\n        setTimeout(tryWait, 120);\r\n      } else {\r\n        console.warn(`[${SCRIPT_NAME}] LipSync:  - characterId=${characterId}`);\n      }\r\n    };\r\n    tryWait();\r\n  },\r\n\r\n  async _waitForModelReadyBeforeTTS(_characterId: string, maxWait = 5000): Promise<boolean> {\r\n    const startTime = Date.now();\r\n    while (Date.now() - startTime < maxWait) {\r\n      if (hasLive2D()) return true;\r\n      await new Promise(r => setTimeout(r, 120));\r\n    }\r\n    console.warn(`[${SCRIPT_NAME}] TTS: TTS`);\n    return false;\r\n  },\r\n\r\n  _startLipSyncOnPlay(characterId: string, maxWait = 5000): void {\r\n    console.log(`[${SCRIPT_NAME}] LipSync: _startLipSyncOnPlay  - characterId=${characterId}`);\n    const startTime = Date.now();\r\n    let hasStarted = false;\r\n\r\n    const tryBind = () => {\r\n      const preferredAudio = this._getPreferredAudioElement();\r\n      const audioElement = preferredAudio || this._getCurrentAudioElement();\r\n      console.log(\r\n        `[${SCRIPT_NAME}] LipSync:  -`,\n        audioElement\r\n          ? `src=${audioElement.src?.substring(0, 50)}... paused=${audioElement.paused} currentTime=${audioElement.currentTime}`\r\n          : 'null',\r\n      );\r\n\r\n      if (!audioElement) {\r\n        if (Date.now() - startTime < maxWait && !hasStarted) {\r\n          setTimeout(tryBind, 100);\r\n        } else if (!hasStarted) {\r\n          console.warn(`[${SCRIPT_NAME}] LipSync: `);\n        }\r\n        return;\r\n      }\r\n\r\n      if (!audioElement.paused) {\r\n        console.log(`[${SCRIPT_NAME}] LipSync: `);\n        hasStarted = true;\r\n        this._bindLipSyncToAudio(audioElement, characterId);\r\n        return;\r\n      }\r\n\r\n      if (!preferredAudio) {\r\n        if (Date.now() - startTime < maxWait && !hasStarted) {\r\n          setTimeout(tryBind, 100);\r\n        } else if (!hasStarted) {\r\n          console.warn(`[${SCRIPT_NAME}] LipSync: `);\n          if (audioElement.src) {\r\n            this._bindLipSyncToAudio(audioElement, characterId);\r\n          }\r\n        }\r\n        return;\r\n      }\r\n\r\n      console.log(`[${SCRIPT_NAME}] LipSync: ...`);\n\r\n      const onPlaying = () => {\r\n        if (hasStarted) return;\r\n        hasStarted = true;\r\n        console.log(`[${SCRIPT_NAME}] LipSync: `);\n        this._bindLipSyncToAudio(audioElement, characterId);\r\n      };\r\n\r\n      audioElement.addEventListener('playing', onPlaying, { once: true });\r\n      audioElement.addEventListener('play', onPlaying, { once: true });\r\n\r\n      const onTimeUpdate = () => {\r\n        if (hasStarted) return;\r\n        if (audioElement.currentTime > 0 && !audioElement.paused) {\r\n          console.log(`[${SCRIPT_NAME}] LipSync: timeupdate `);\n          onPlaying();\r\n        }\r\n      };\r\n      audioElement.addEventListener('timeupdate', onTimeUpdate);\r\n\r\n      setTimeout(() => {\r\n        audioElement.removeEventListener('playing', onPlaying);\r\n        audioElement.removeEventListener('play', onPlaying);\r\n        audioElement.removeEventListener('timeupdate', onTimeUpdate);\r\n        if (!hasStarted) {\r\n          console.warn(`[${SCRIPT_NAME}] LipSync: `);\n          if (audioElement.src) {\r\n            this._bindLipSyncToAudio(audioElement, characterId);\r\n          }\r\n        }\r\n      }, maxWait);\r\n    };\r\n\r\n    tryBind();\r\n  },\r\n\r\n  _bindLipSyncToAudio(audioElement: HTMLAudioElement, characterId: string): void {\r\n    if (LipSyncManager.connectAudio(audioElement)) {\r\n      void LipSyncManager.startSync(characterId);\r\n    }\r\n\r\n    const onEnd = () => {\r\n      console.log(`[${SCRIPT_NAME}] LipSync: /`);\n      LipSyncManager.stopSync();\r\n      audioElement.removeEventListener('ended', onEnd);\r\n      audioElement.removeEventListener('pause', onEnd);\r\n    };\r\n\r\n    audioElement.addEventListener('ended', onEnd, { once: true });\r\n    audioElement.addEventListener('pause', onEnd, { once: true });\r\n  },\r\n\r\n  async speak(segment: TTSSegment, segmentId: string): Promise<void> {\r\n    if (!segment || segment.type !== 'dialogue') {\r\n      if (segment && segment.type === 'narration') {\r\n        console.log(`[${SCRIPT_NAME}] TTS:  - ${segment.text.substring(0, 30)}...`);\n      }\r\n      return;\r\n    }\r\n    if (!segment.text) return;\r\n\r\n    const provider = getTTSProvider();\r\n    if (provider !== this.provider || !this.enabled) {\r\n      this._refreshProviderState();\r\n    }\r\n    if (!this.enabled) return;\r\n\r\n    const settings = getSettingsSnapshot();\r\n    const ttsConfig = segment.tts || {};\r\n    const boundVoice = getCharacterTTSVoice(segment.speaker);\r\n    let voiceName = ttsConfig.speaker || boundVoice || settings.ttsDefaultSpeaker;\r\n    if (!voiceName) {\r\n      voiceName = provider === TTS_PROVIDER.GPT_SOVITS_V2 ? segment.speaker || '' : '';\n    }\r\n    if (!voiceName) voiceName = '';\n    const context = ttsConfig.context || '';\r\n\r\n    const resolvedVoice = await resolveVoiceByName(String(voiceName || ''));\r\n    if (!resolvedVoice) {\r\n      console.error(`[${SCRIPT_NAME}] TTS:  \"${voiceName}\" (provider=${provider})`);\n      if (provider === TTS_PROVIDER.GPT_SOVITS_V2) {\r\n        showToast('GPT-SoVITS: ');\n      }\r\n      return;\r\n    }\r\n\r\n    console.log(\n      `[${SCRIPT_NAME}] TTS: provider=${provider}, voiceName=${voiceName}, context=${context || ''}, text=${segment.text.substring(0, 30)}...`,\n    );\n    if (hasLive2D()) {\r\n      try {\r\n        const info = Live2DManager.getLipSyncDebugInfo();\r\n        console.log(\r\n          `[${SCRIPT_NAME}] TTS: lipSyncOverride=active, mouthParamsSource=${info.mouthParamsSource}, count=${info.mouthParamsCount}`,\n        );\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    this.isLoading = true;\r\n    this.showLoadingIndicator();\r\n\r\n    try {\r\n      await this._waitForModelReadyBeforeTTS(segment.speaker);\r\n\r\n      if (provider === TTS_PROVIDER.GPT_SOVITS_V2) {\r\n        await this._speakWithGptSoVits(segment, segmentId, resolvedVoice);\r\n        return;\r\n      }\r\n\r\n      if (provider === TTS_PROVIDER.EDGE_TTS_DIRECT) {\r\n        await this._speakWithEdgeDirect(segment, segmentId, resolvedVoice);\r\n        return;\r\n      }\r\n\r\n      const speakerValue = resolvedVoice.value;\r\n      const resourceId = inferResourceId(speakerValue);\r\n\r\n      if (this.xiaobaixTts && typeof this.xiaobaixTts.speak === 'function') {\r\n        await this.xiaobaixTts.speak(segment.text, {\r\n          speaker: speakerValue,\r\n          resourceId,\r\n          contextTexts: context ? [context] : [],\r\n        });\r\n        this.isPlaying = true;\r\n        this.currentSegmentId = segmentId;\r\n        if (hasLive2D()) {\r\n          this._startLipSyncOnPlay(segment.speaker || 'pet');\r\n        }\r\n        return;\r\n      }\r\n\r\n      if (this.littleWhiteBox && typeof this.littleWhiteBox.callGenerate === 'function') {\r\n        await this.littleWhiteBox.callGenerate({\r\n          message: segment.text,\r\n          speaker: speakerValue,\r\n          resourceId,\r\n          contextTexts: context ? [context] : [],\r\n        });\r\n        this.isPlaying = true;\r\n        this.currentSegmentId = segmentId;\r\n        if (hasLive2D()) {\r\n          this._startLipSyncOnPlay(segment.speaker || 'pet');\r\n        }\r\n        return;\r\n      }\r\n\r\n      console.warn(`[${SCRIPT_NAME}] TTS:  TTS  LittleWhiteBox `);\n    } catch (err) {\r\n      console.error(`[${SCRIPT_NAME}] TTS:`, err);\n    } finally {\r\n      this.isLoading = false;\r\n      this.hideLoadingIndicator();\r\n    }\r\n  },\r\n};\r\n","import { log, warn } from '../utils/dom';\nimport type { CommentTriggerMode } from '../core/constants';\n\ntype MonitorCallback = () => void;\ntype StopHandle = { stop: () => void };\ntype UserSignalSource = 'message_sent' | 'generation_after_commands' | 'user_message_rendered';\ntype TriggerSource = 'user' | 'ai';\n\n/**\n * Chat message monitor.\n * Uses event-gating to separate real user/AI turns from the plugin's own generateRaw flow.\n */\nexport const ChatMonitor = {\n  /** Count since last trigger. */\n  messageCount: 0,\n\n  /** Ignore next N GENERATION_ENDED events (our own generateRaw). */\n  ignoreNextCount: 0,\n\n  /** Trigger callback. */\n  _onTrigger: null as MonitorCallback | null,\n\n  /** Event stop handles. */\n  _stops: [] as StopHandle[],\n\n  /** Latest user-side signal time (for dedupe). */\n  _lastUserSignalAt: 0,\n\n  /** Runtime config. */\n  _config: {\n    autoTrigger: true,\n    triggerInterval: 3,\n    triggerProbability: 60,\n    commentTriggerMode: 'ai' as CommentTriggerMode,\n  },\n\n  init(\n    config: {\n      autoTrigger: boolean;\n      triggerInterval: number;\n      triggerProbability: number;\n      commentTriggerMode: CommentTriggerMode;\n    },\n    onTrigger: MonitorCallback,\n  ): void {\n    this._config = { ...config };\n    this._onTrigger = onTrigger;\n    this._lastUserSignalAt = 0;\n\n    const messageSentStop = this._bindEvent('MESSAGE_SENT', (_messageId: number) => {\n      log('(MESSAGE_SENT)');\n      this._recordUserSignal('message_sent');\n    });\n    if (messageSentStop) {\n      this._stops.push(messageSentStop);\n    }\n\n    // Fallback for environments where MESSAGE_SENT exists but does not fire.\n    const userRenderedStop = this._bindEvent('USER_MESSAGE_RENDERED', (_messageId: number) => {\n      log('(USER_MESSAGE_RENDERED)');\n      this._recordUserSignal('user_message_rendered');\n    });\n    if (userRenderedStop) {\n      this._stops.push(userRenderedStop);\n    }\n\n    // Fallback for some /send command paths.\n    const afterCommandsStop = this._bindEvent(\n      'GENERATION_AFTER_COMMANDS',\n      (_type: string, option: { quiet_prompt?: string }, dryRun: boolean) => {\n        if (dryRun) return;\n        if (option?.quiet_prompt) return;\n        log('(GENERATION_AFTER_COMMANDS)');\n        this._recordUserSignal('generation_after_commands');\n      },\n    );\n    if (afterCommandsStop) {\n      this._stops.push(afterCommandsStop);\n    }\n\n    const generationStartedStop = this._bindEvent(\n      'GENERATION_STARTED',\n      (_type: string, option: { quiet_prompt?: string }, dryRun: boolean) => {\n        if (dryRun) return;\n        if (option?.quiet_prompt) return;\n      },\n    );\n    if (generationStartedStop) {\n      this._stops.push(generationStartedStop);\n    }\n\n    const generationEndedStop = this._bindEvent('GENERATION_ENDED', (_messageId: number) => {\n      if (this.ignoreNextCount > 0) {\n        this.ignoreNextCount--;\n        return;\n      }\n      this._handleTriggerCount('ai');\n    });\n    if (generationEndedStop) {\n      this._stops.push(generationEndedStop);\n    }\n\n    log(\n      `(mode=${this._config.commentTriggerMode}, interval=${this._config.triggerInterval}, prob=${this._config.triggerProbability})`,\n    );\n  },\n\n  _resolveEventName(eventKey: string): string | null {\n    try {\n      const top = window.parent ?? window;\n      const fromSillyTavern = (top as any)?.SillyTavern?.eventTypes?.[eventKey];\n      if (fromSillyTavern) return String(fromSillyTavern);\n    } catch {\n      // ignore\n    }\n\n    try {\n      const fromLegacy = (tavern_events as any)?.[eventKey];\n      if (fromLegacy) return String(fromLegacy);\n    } catch {\n      // ignore\n    }\n\n    return null;\n  },\n\n  _bindEvent(eventKey: string, handler: (...args: any[]) => void): StopHandle | null {\n    const eventName = this._resolveEventName(eventKey);\n    if (!eventName) {\n      warn(`: ${eventKey}`);\n      return null;\n    }\n\n    try {\n      const top = window.parent ?? window;\n      const eventSource = (top as any)?.SillyTavern?.eventSource;\n      if (eventSource && typeof eventSource.on === 'function') {\n        eventSource.on(eventName, handler);\n        log(`(${eventKey} -> ${eventName}, via eventSource)`);\n        return {\n          stop: () => {\n            try {\n              if (typeof eventSource.off === 'function') {\n                eventSource.off(eventName, handler);\n              }\n            } catch {\n              // ignore\n            }\n          },\n        };\n      }\n    } catch {\n      // ignore\n    }\n\n    if (typeof eventOn === 'function') {\n      const stop = eventOn(eventName as any, handler);\n      log(`(${eventKey} -> ${eventName}, via eventOn)`);\n      return stop;\n    }\n\n    warn(`: ${eventKey}`);\n    return null;\n  },\n\n  updateConfig(config: {\n    autoTrigger: boolean;\n    triggerInterval: number;\n    triggerProbability: number;\n    commentTriggerMode: CommentTriggerMode;\n  }): void {\n    this._config = { ...config };\n  },\n\n  _shouldCountBySource(source: TriggerSource): boolean {\n    const mode = this._config.commentTriggerMode;\n    return mode === 'both' || mode === source;\n  },\n\n  _recordUserSignal(source: UserSignalSource): void {\n    const now = Date.now();\n\n    // MESSAGE_SENT / USER_MESSAGE_RENDERED / GENERATION_AFTER_COMMANDS may fire in one send flow.\n    if (now - this._lastUserSignalAt < 800) {\n      log(`(${source})`);\n      return;\n    }\n\n    this._lastUserSignalAt = now;\n    this._handleTriggerCount('user');\n  },\n\n  _handleTriggerCount(source: TriggerSource): void {\n    if (!this._shouldCountBySource(source)) return;\n    this.messageCount++;\n    log(`(${source}): ${this.messageCount}`);\n    this._checkAutoTrigger();\n  },\n\n  _checkAutoTrigger(): void {\n    if (!this._config.autoTrigger || !this._onTrigger) return;\n    if (this.messageCount < this._config.triggerInterval) return;\n\n    const roll = Math.random() * 100;\n    if (roll > this._config.triggerProbability) {\n      log(`(${roll.toFixed(1)} > ${this._config.triggerProbability})`);\n      return;\n    }\n\n    this.messageCount = 0;\n    log('');\n    this._onTrigger();\n  },\n\n  manualTrigger(): void {\n    if (!this._onTrigger) return;\n    log('');\n    this._onTrigger();\n  },\n\n  resetState(): void {\n    this.messageCount = 0;\n    this.ignoreNextCount = 0;\n    this._lastUserSignalAt = 0;\n    log('');\n  },\n\n  markSelfGeneration(): void {\n    this.ignoreNextCount++;\n  },\n\n  destroy(): void {\n    for (const s of this._stops) {\n      s.stop();\n    }\n    this._stops = [];\n    this._onTrigger = null;\n    this.messageCount = 0;\n    this.ignoreNextCount = 0;\n    this._lastUserSignalAt = 0;\n  },\n};\n","import { EMOTION_TAGS, type CommentStyle } from '../core/constants';\n\n/**  */\ninterface StyleTemplate {\n  systemPrompt: string;\n  responseFormat: string;\n}\n\nexport interface RoleplayPromptOptions {\n  roleName?: string;\n  characterCardContent?: string;\n  ignoreCommentStyle?: boolean;\n}\n\nexport interface DiceReferencePromptOptions {\n  referenceText?: string;\n}\n\n/**  */\nexport const PROMPT_TEMPLATES: Record<Exclude<CommentStyle, ''>, StyleTemplate> = {\n  : {\n    systemPrompt: `\n\n`,\n    responseFormat: '1-250',\n  },\n\n  : {\n    systemPrompt: `\n`,\n    responseFormat: '1-250()(><)(  )',\n  },\n\n  : {\n    systemPrompt: `\n`,\n    responseFormat: '1-250',\n  },\n\n  : {\n    systemPrompt: `\n\"\"\"\"`,\n    responseFormat: '1-250',\n  },\n};\n\nfunction resolvePromptTemplate(\n  style: CommentStyle,\n  customPrompt: string,\n): { systemPrompt: string; responseFormat: string } {\n  if (style === '' && customPrompt) {\n    return {\n      systemPrompt: customPrompt,\n      responseFormat: '1-250',\n    };\n  }\n\n  const template = PROMPT_TEMPLATES[style as Exclude<CommentStyle, ''>] ?? PROMPT_TEMPLATES[''];\n\n  return {\n    systemPrompt: template.systemPrompt,\n    responseFormat: template.responseFormat,\n  };\n}\n\nfunction getChatResponseFormat(style: CommentStyle): string {\n  switch (style) {\n    case '':\n      return '1-380()(><)(  )';\n    case '':\n      return '1-380';\n    case '':\n      return '1-380';\n    case '':\n      return '1-380';\n    case '':\n    default:\n      return '1-380';\n  }\n}\n\nfunction appendEmotionCotFormat(responseFormat: string): string {\n  const tags = EMOTION_TAGS.join('');\n  return (\n    `${responseFormat}\\n\\n` +\n    `COT\\n` +\n    `- [|]: \\n` +\n    `-  1 ${tags}\\n` +\n    `- \\n` +\n    `-  Markdown//`\n  );\n}\n\nfunction buildRoleplayInstruction(roleplay?: RoleplayPromptOptions): string {\n  const roleName = String(roleplay?.roleName || '').trim();\n  if (!roleName) {\n    return '';\n  }\n\n  const lines = [\n    '',\n    `- ${roleName}`,\n    '- ',\n    '-  AI',\n  ];\n\n  const characterCardContent = String(roleplay?.characterCardContent || '').trim();\n  if (characterCardContent) {\n    lines.push('');\n    lines.push(characterCardContent);\n  }\n\n  return lines.join('\\n');\n}\n\nfunction shouldIgnoreStyleByRoleplay(roleplay?: RoleplayPromptOptions): boolean {\n  const roleName = String(roleplay?.roleName || '').trim();\n  return !!roleName && roleplay?.ignoreCommentStyle === true;\n}\n\nfunction buildContextLines(chatContext: Array<{ role: string; name: string; message: string }>): string {\n  return chatContext.map(msg => `${msg.name}(${msg.role}): ${String(msg.message ?? '')}`).join('\\n');\n}\n\nfunction getDiceReferenceText(diceReference?: DiceReferencePromptOptions): string {\n  return String(diceReference?.referenceText || '').trim();\n}\n\nfunction buildDiceReferenceInstruction(diceReference?: DiceReferencePromptOptions): string {\n  const referenceText = getDiceReferenceText(diceReference);\n  if (!referenceText) {\n    return '';\n  }\n\n  return (\n    `\\n` +\n    `\\n` +\n    `${referenceText}`\n  );\n}\n\nfunction appendDiceAdviceRequirement(responseFormat: string, diceReference?: DiceReferencePromptOptions): string {\n  const referenceText = getDiceReferenceText(diceReference);\n  if (!referenceText) {\n    return responseFormat;\n  }\n  return `${responseFormat}\\n 1 `;\n}\n\n/**\n *  LLM \n */\nexport function buildPrompt(\n  style: CommentStyle,\n  customPrompt: string,\n  chatContext: Array<{ role: string; name: string; message: string }>,\n  emotionCotEnabled = false,\n  roleplay?: RoleplayPromptOptions,\n  diceReference?: DiceReferencePromptOptions,\n): { system: string; user: string } {\n  const ignoreStyleByRoleplay = shouldIgnoreStyleByRoleplay(roleplay);\n  const { systemPrompt, responseFormat } = ignoreStyleByRoleplay\n    ? {\n        systemPrompt: '',\n        responseFormat: '1-250',\n      }\n    : resolvePromptTemplate(style, customPrompt);\n  const responseFormatWithAdvice = appendDiceAdviceRequirement(responseFormat, diceReference);\n  const finalFormat = emotionCotEnabled ? appendEmotionCotFormat(responseFormatWithAdvice) : responseFormatWithAdvice;\n  const roleplayInstruction = buildRoleplayInstruction(roleplay);\n  const diceReferenceInstruction = buildDiceReferenceInstruction(diceReference);\n\n  // \n  const contextLines = buildContextLines(chatContext);\n\n  const systemParts = [systemPrompt];\n  if (roleplayInstruction) {\n    systemParts.push(roleplayInstruction);\n  }\n  if (diceReferenceInstruction) {\n    systemParts.push(diceReferenceInstruction);\n  }\n  systemParts.push(`${finalFormat}`);\n\n  const system = systemParts.join('\\n\\n');\n  const user = `\\n\\n${contextLines}`;\n\n  return { system, user };\n}\n\n/**\n * \n */\nexport function buildChatPrompt(\n  style: CommentStyle,\n  customPrompt: string,\n  chatContext: Array<{ role: string; name: string; message: string }>,\n  userMessage: string,\n  emotionCotEnabled = false,\n  roleplay?: RoleplayPromptOptions,\n  diceReference?: DiceReferencePromptOptions,\n): { system: string; user: string } {\n  const ignoreStyleByRoleplay = shouldIgnoreStyleByRoleplay(roleplay);\n  const { systemPrompt } = ignoreStyleByRoleplay\n    ? {\n        systemPrompt: '',\n      }\n    : resolvePromptTemplate(style, customPrompt);\n  const responseFormat = ignoreStyleByRoleplay ? '1-380' : getChatResponseFormat(style);\n  const responseFormatWithAdvice = appendDiceAdviceRequirement(responseFormat, diceReference);\n  const finalFormat = emotionCotEnabled ? appendEmotionCotFormat(responseFormatWithAdvice) : responseFormatWithAdvice;\n  const roleplayInstruction = buildRoleplayInstruction(roleplay);\n  const diceReferenceInstruction = buildDiceReferenceInstruction(diceReference);\n  const roleName = String(roleplay?.roleName || '').trim();\n\n  const contextLines = buildContextLines(chatContext);\n  const safeUserMessage = String(userMessage || '').trim();\n\n  const systemParts = [systemPrompt];\n  if (roleplayInstruction) {\n    systemParts.push(roleplayInstruction);\n  }\n  if (diceReferenceInstruction) {\n    systemParts.push(diceReferenceInstruction);\n  }\n  systemParts.push(`${finalFormat}`);\n  systemParts.push(roleName ? '' : '');\n\n  const system = systemParts.join('\\n\\n');\n\n  const user =\n    `\\n\\n` +\n    `${contextLines || '()'}\\n\\n` +\n    `\\n${safeUserMessage}\\n\\n` +\n    ``;\n\n  return { system, user };\n}\n","import { useSettingsStore } from '../core/settings';\nimport { error, log, warn } from '../utils/dom';\nimport { ChatMonitor } from './monitor';\nimport {\n  buildChatPrompt,\n  buildPrompt,\n  type DiceReferencePromptOptions,\n  type RoleplayPromptOptions,\n} from './prompt-templates';\n\ntype CommentCallback = (text: string, isDone: boolean) => void;\n\n/**\n * \n *  LLM / UI\n */\nexport const Commentator = {\n  isGenerating: false,\n\n  _onComment: null as CommentCallback | null,\n  _streamStop: null as { stop: () => void } | null,\n  _latestStreamText: '',\n\n  setCallback(cb: CommentCallback): void {\n    this._onComment = cb;\n  },\n\n  async generate(): Promise<void> {\n    if (this.isGenerating) {\n      log('');\n      return;\n    }\n\n    this.isGenerating = true;\n    log('');\n    let emittedDone = false;\n\n    try {\n      this._onComment?.('', false);\n\n      const store = useSettingsStore();\n      const s = store.settings;\n\n      let chatMessages = this._getChatContext(s.maxChatContext);\n      if (s.useTamakoTodaySpecial) {\n        const todaySpecial = this._getTamakoTodaySpecialContent();\n        if (todaySpecial) {\n          chatMessages = [\n            ...chatMessages,\n            {\n              role: 'system',\n              name: '',\n              message: todaySpecial,\n            },\n          ];\n          log(`${todaySpecial.length} `);\n        } else {\n          log('');\n        }\n      }\n\n      if (chatMessages.length === 0) {\n        log('');\n        return;\n      }\n\n      const roleplayOptions = this._resolveRoleplayOptions({\n        roleName: s.roleplayName,\n        ignoreCommentStyle: !!s.roleplayIgnoreCommentStyle,\n        sendCharacterCardContent: !!s.sendCharacterCardContent,\n      });\n      const diceReferenceOptions = this._resolveDiceReferenceOptions(\n        !!s.useDiceDatabaseReference,\n        (s as any).diceReferenceVisibleSheets,\n      );\n      const { system, user } = buildPrompt(\n        s.commentStyle,\n        s.customPrompt,\n        chatMessages,\n        !!s.emotionCotEnabled,\n        roleplayOptions,\n        diceReferenceOptions,\n      );\n\n      this._latestStreamText = '';\n      let result: string;\n\n      if (s.apiMode === 'custom' && s.apiConfig.url) {\n        result = await this._generateCustom(system, user, s.apiConfig);\n      } else {\n        ChatMonitor.markSelfGeneration();\n        result = await this._generateTavern(\n          system,\n          user,\n          s.apiConfig.max_tokens,\n          s.apiConfig.temperature,\n          !!s.apiConfig.sendWorldInfo,\n        );\n      }\n\n      const finalText = String(result || '').trim() || String(this._latestStreamText || '').trim();\n      if (finalText) {\n        this._onComment?.(finalText, true);\n        emittedDone = true;\n      } else {\n        warn('');\n      }\n    } catch (e) {\n      error(':', e);\n    } finally {\n      if (!emittedDone) {\n        this._onComment?.('', true);\n      }\n      this.isGenerating = false;\n    }\n  },\n\n  /**\n   * \n   * - \n   * -  API  API /  API\n   */\n  async chat(userMessage: string): Promise<void> {\n    const input = String(userMessage || '').trim();\n    if (!input) return;\n\n    if (this.isGenerating) {\n      log('');\n      return;\n    }\n\n    this.isGenerating = true;\n    log('');\n    let emittedDone = false;\n\n    try {\n      this._onComment?.('', false);\n\n      const store = useSettingsStore();\n      const s = store.settings;\n\n      const chatMessages = this._getChatContext(s.maxChatContext);\n      const roleplayOptions = this._resolveRoleplayOptions({\n        roleName: s.roleplayName,\n        ignoreCommentStyle: !!s.roleplayIgnoreCommentStyle,\n        sendCharacterCardContent: !!s.sendCharacterCardContent,\n      });\n      const diceReferenceOptions = this._resolveDiceReferenceOptions(\n        !!s.useDiceDatabaseReference,\n        (s as any).diceReferenceVisibleSheets,\n      );\n      const { system, user } = buildChatPrompt(\n        s.commentStyle,\n        s.customPrompt,\n        chatMessages,\n        input,\n        !!s.emotionCotEnabled,\n        roleplayOptions,\n        diceReferenceOptions,\n      );\n\n      this._latestStreamText = '';\n      let result: string;\n\n      if (s.apiMode === 'custom' && s.apiConfig.url) {\n        result = await this._generateCustom(system, user, s.apiConfig);\n      } else {\n        ChatMonitor.markSelfGeneration();\n        result = await this._generateTavern(\n          system,\n          user,\n          s.apiConfig.max_tokens,\n          s.apiConfig.temperature,\n          !!s.apiConfig.sendWorldInfo,\n        );\n      }\n\n      const finalText = String(result || '').trim() || String(this._latestStreamText || '').trim();\n      if (finalText) {\n        this._onComment?.(finalText, true);\n        emittedDone = true;\n      } else {\n        warn('');\n      }\n    } catch (e) {\n      error(':', e);\n    } finally {\n      if (!emittedDone) {\n        this._onComment?.('', true);\n      }\n      this.isGenerating = false;\n    }\n  },\n\n  async _generateTavern(\n    system: string,\n    user: string,\n    maxTokens: number,\n    temperature: number,\n    sendWorldInfo: boolean,\n  ): Promise<string> {\n    this._setupStreamListener();\n    const orderedPrompts: Array<\n      'world_info_before' | 'world_info_after' | { role: 'system' | 'assistant' | 'user'; content: string }\n    > = sendWorldInfo\n      ? ['world_info_before', { role: 'system', content: system }, 'world_info_after', { role: 'user', content: user }]\n      : [\n          { role: 'system', content: system },\n          { role: 'user', content: user },\n        ];\n\n    try {\n      return await generateRaw({\n        should_silence: true,\n        should_stream: true,\n        ordered_prompts: orderedPrompts,\n        custom_api: undefined,\n      });\n    } finally {\n      this._cleanupStreamListener();\n    }\n  },\n\n  async _generateCustom(\n    system: string,\n    user: string,\n    apiConfig: {\n      url: string;\n      apiKey: string;\n      model: string;\n      source: string;\n      max_tokens: number;\n      temperature: number;\n      frequency_penalty: number;\n      presence_penalty: number;\n      top_p: number;\n      top_k: number;\n      usePresetSampling: boolean;\n      sendWorldInfo?: boolean;\n    },\n  ): Promise<string> {\n    const apiUrl = String(apiConfig.url || '').trim();\n    const apiKey = String(apiConfig.apiKey || '').trim();\n    const model = String(apiConfig.model || '')\n      .trim()\n      .replace(/^models\\//, '');\n\n    if (!apiUrl) {\n      throw new Error(' API URL ');\n    }\n    if (!model) {\n      throw new Error(' API ');\n    }\n\n    const usePreset = !!apiConfig.usePresetSampling;\n    const sendWorldInfo = !!apiConfig.sendWorldInfo;\n    const requestUrl = '/api/backends/chat-completions/generate';\n    const orderedPrompts = [\n      { role: 'system', content: system },\n      { role: 'user', content: user },\n    ];\n\n    const buildAttemptBody = (attempt: 'full' | 'safe' | 'minimal') => {\n      const body: Record<string, unknown> = {\n        messages: orderedPrompts,\n        model,\n        stream: false,\n        chat_completion_source: 'custom',\n        custom_prompt_post_processing: sendWorldInfo ? 'strict' : 'none',\n        reverse_proxy: apiUrl,\n        custom_url: apiUrl,\n        custom_include_headers: apiKey ? `Authorization: Bearer ${apiKey}` : '',\n      };\n\n      //  OpenAI \n      if (!usePreset && attempt !== 'minimal') {\n        body.max_tokens = apiConfig.max_tokens;\n        body.temperature = apiConfig.temperature;\n        body.top_p = apiConfig.top_p;\n      }\n\n      if (!usePreset && attempt === 'full') {\n        body.frequency_penalty = apiConfig.frequency_penalty;\n        body.presence_penalty = apiConfig.presence_penalty;\n        body.top_k = apiConfig.top_k;\n      }\n\n      return body;\n    };\n\n    const requestWithAttempt = async (attempt: 'full' | 'safe' | 'minimal'): Promise<string> => {\n      const response = await fetch(requestUrl, {\n        method: 'POST',\n        headers: {\n          ...SillyTavern.getRequestHeaders(),\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(buildAttemptBody(attempt)),\n      });\n\n      if (!response.ok) {\n        const errTxt = await response.text();\n        const err = new Error(`API: ${response.status} ${errTxt || response.statusText}`);\n        (err as Error & { status?: number }).status = response.status;\n        throw err;\n      }\n\n      const data = (await response.json()) as any;\n      if (data?.choices?.[0]?.message?.content) {\n        return String(data.choices[0].message.content).trim();\n      }\n      if (typeof data?.content === 'string') {\n        return data.content.trim();\n      }\n      if (typeof data?.text === 'string') {\n        return data.text.trim();\n      }\n\n      const details = typeof data === 'object' ? JSON.stringify(data) : String(data);\n      throw new Error(`API: ${details}`);\n    };\n\n    const attempts: Array<'full' | 'safe' | 'minimal'> = ['full', 'safe', 'minimal'];\n    let lastError: unknown = null;\n\n    for (let i = 0; i < attempts.length; i++) {\n      const attempt = attempts[i];\n      try {\n        if (i > 0) {\n          warn(` API ${attempt}`);\n        }\n        return await requestWithAttempt(attempt);\n      } catch (e) {\n        lastError = e;\n        const status = (e as { status?: number } | null)?.status;\n        const msg = e instanceof Error ? e.message : String(e);\n        const is422 = status === 422 || /\\b422\\b/.test(msg);\n        const canRetry = is422 && i < attempts.length - 1;\n        if (!canRetry) throw e;\n        warn(` API  422${attempt} -> ${attempts[i + 1]}`);\n      }\n    }\n\n    throw lastError instanceof Error ? lastError : new Error(String(lastError));\n  },\n\n  _setupStreamListener(): void {\n    this._cleanupStreamListener();\n    this._streamStop = eventOn(iframe_events.STREAM_TOKEN_RECEIVED_FULLY, (fullText: string) => {\n      this._latestStreamText = String(fullText || '');\n      this._onComment?.(fullText, false);\n    });\n  },\n\n  _cleanupStreamListener(): void {\n    if (this._streamStop) {\n      this._streamStop.stop();\n      this._streamStop = null;\n    }\n  },\n\n  _getChatContext(maxCount: number): Array<{ role: string; name: string; message: string }> {\n    try {\n      const messages = getChatMessages(`0-{{lastMessageId}}`, {\n        role: 'all',\n        hide_state: 'unhidden',\n      });\n\n      const list = Array.isArray(messages) ? messages : [];\n      const safeMaxCount = Number.isFinite(maxCount) && maxCount > 0 ? Math.floor(maxCount) : 20;\n      const recent = list.slice(-safeMaxCount);\n\n      return recent.map(msg => ({\n        role: msg.role,\n        name: msg.name,\n        message: msg.message,\n      }));\n    } catch (e) {\n      warn(':', e);\n      return [];\n    }\n  },\n\n  _resolveRoleplayOptions(config: {\n    roleName?: string;\n    ignoreCommentStyle?: boolean;\n    sendCharacterCardContent?: boolean;\n  }): RoleplayPromptOptions | undefined {\n    const roleName = String(config.roleName || '').trim();\n    if (!roleName) {\n      return undefined;\n    }\n\n    const roleplay: RoleplayPromptOptions = {\n      roleName,\n      ignoreCommentStyle: config.ignoreCommentStyle === true,\n    };\n    if (config.sendCharacterCardContent) {\n      const characterCardContent = this._getCurrentCharacterCardContent();\n      if (characterCardContent) {\n        roleplay.characterCardContent = characterCardContent;\n      } else {\n        log('');\n      }\n    }\n\n    return roleplay;\n  },\n\n  _resolveDiceReferenceOptions(enabled: boolean, visibleSheets?: unknown): DiceReferencePromptOptions | undefined {\n    if (!enabled) {\n      return undefined;\n    }\n\n    const visibleSheetNames = this._normalizeDiceVisibleSheetNames(visibleSheets);\n    const referenceText = this._getDiceDatabaseReferenceContent(visibleSheetNames);\n    if (!referenceText) {\n      log('');\n      return undefined;\n    }\n\n    log(`${referenceText.length} `);\n    return { referenceText };\n  },\n\n  _getDiceDatabaseReferenceContent(visibleSheetNames: string[]): string {\n    const apiData = this._getDiceDatabaseDataFromApi();\n    if (apiData) {\n      const apiSummary = this._summarizeDiceDatabasePayload(\n        apiData,\n        'AutoCardUpdaterAPI.exportTableAsJson',\n        visibleSheetNames,\n      );\n      if (apiSummary) {\n        return apiSummary;\n      }\n    }\n\n    const chatData = this._getDiceDatabaseDataFromChatContext();\n    if (!chatData) {\n      return '';\n    }\n\n    return this._summarizeDiceDatabasePayload(chatData, ' TavernDB_ACU_* ', visibleSheetNames);\n  },\n\n  _getDiceDatabaseDataFromApi(): Record<string, unknown> | null {\n    try {\n      const topWindow = window.parent ?? window;\n      const api = (topWindow as any)?.AutoCardUpdaterAPI;\n      if (!api || typeof api.exportTableAsJson !== 'function') {\n        return null;\n      }\n\n      return this._normalizeDiceDatabasePayload(api.exportTableAsJson());\n    } catch (e) {\n      warn(' API :', e);\n      return null;\n    }\n  },\n\n  _getDiceDatabaseDataFromChatContext(): Record<string, unknown> | null {\n    try {\n      const messages = getChatMessages(`0-{{lastMessageId}}`, {\n        role: 'all',\n        hide_state: 'all',\n      });\n      const list = Array.isArray(messages) ? messages : [];\n\n      for (let i = list.length - 1; i >= 0; i--) {\n        const payload = this._pickDiceDatabasePayloadFromMessage(list[i] as any);\n        if (payload) {\n          return payload;\n        }\n      }\n    } catch (e) {\n      warn(':', e);\n    }\n\n    return null;\n  },\n\n  _pickDiceDatabasePayloadFromMessage(message: any): Record<string, unknown> | null {\n    if (!message || typeof message !== 'object') {\n      return null;\n    }\n\n    const directCandidates: unknown[] = [\n      message.TavernDB_ACU_IndependentData,\n      message.TavernDB_ACU_Data,\n      message.TavernDB_ACU_SummaryData,\n      message.data?.TavernDB_ACU_IndependentData,\n      message.data?.TavernDB_ACU_Data,\n      message.data?.TavernDB_ACU_SummaryData,\n    ];\n    for (const candidate of directCandidates) {\n      const payload = this._normalizeDiceDatabasePayload(candidate);\n      if (payload) {\n        return payload;\n      }\n    }\n\n    const isolatedCandidates: unknown[] = [message.TavernDB_ACU_IsolatedData, message.data?.TavernDB_ACU_IsolatedData];\n    for (const candidate of isolatedCandidates) {\n      const payload = this._pickDiceDatabasePayloadFromIsolatedData(candidate);\n      if (payload) {\n        return payload;\n      }\n    }\n\n    return null;\n  },\n\n  _pickDiceDatabasePayloadFromIsolatedData(value: unknown): Record<string, unknown> | null {\n    const isolated = this._parseMaybeJsonRecord(value);\n    if (!isolated) {\n      return null;\n    }\n\n    const keys = Object.keys(isolated);\n    for (let i = keys.length - 1; i >= 0; i--) {\n      const slot = this._parseMaybeJsonRecord(isolated[keys[i]]);\n      if (!slot) {\n        continue;\n      }\n      const payload = this._normalizeDiceDatabasePayload(slot.independentData);\n      if (payload) {\n        return payload;\n      }\n    }\n\n    return null;\n  },\n\n  _normalizeDiceDatabasePayload(value: unknown): Record<string, unknown> | null {\n    const record = this._parseMaybeJsonRecord(value);\n    if (!record) {\n      return null;\n    }\n    if (this._isDiceDatabasePayload(record)) {\n      return record;\n    }\n\n    const independentData = this._parseMaybeJsonRecord(record.independentData);\n    if (independentData && this._isDiceDatabasePayload(independentData)) {\n      return independentData;\n    }\n\n    return null;\n  },\n\n  _parseMaybeJsonRecord(value: unknown): Record<string, unknown> | null {\n    if (typeof value === 'string') {\n      const text = value.trim();\n      if (!text) {\n        return null;\n      }\n      try {\n        return this._parseMaybeJsonRecord(JSON.parse(text));\n      } catch {\n        return null;\n      }\n    }\n\n    if (!value || typeof value !== 'object' || Array.isArray(value)) {\n      return null;\n    }\n    return value as Record<string, unknown>;\n  },\n\n  _isDiceDatabasePayload(value: Record<string, unknown>): boolean {\n    return Object.keys(value).some(key => key.startsWith('sheet_'));\n  },\n\n  _summarizeDiceDatabasePayload(\n    data: Record<string, unknown>,\n    sourceLabel: string,\n    visibleSheetNames: string[],\n  ): string {\n    const visibleNameSet = new Set(\n      visibleSheetNames.map(name => this._normalizeReferenceText(name)).filter(name => !!name),\n    );\n    const sheets = Object.keys(data)\n      .filter(key => key.startsWith('sheet_'))\n      .map(key => this._parseMaybeJsonRecord(data[key]))\n      .filter((sheet): sheet is Record<string, unknown> => !!sheet)\n      .map(sheet => {\n        const name = this._normalizeReferenceText(sheet.name || '');\n        return {\n          name,\n          priority: this._getDiceSheetPriority(name),\n          text: this._buildDiceSheetSummary(sheet),\n        };\n      })\n      .filter(item => !!item.text)\n      .filter(item => visibleNameSet.size === 0 || visibleNameSet.has(item.name))\n      .sort((a, b) => a.priority - b.priority || a.name.localeCompare(b.name, 'zh-CN'))\n      .slice(0, 8);\n\n    if (sheets.length === 0) {\n      return '';\n    }\n\n    const maxLength = 1800;\n    const lines = [`${sourceLabel}`, ''];\n\n    for (const item of sheets) {\n      const nextLine = `- ${item.text}`;\n      const nextText = `${lines.join('\\n')}\\n${nextLine}`;\n      if (nextText.length > maxLength) {\n        break;\n      }\n      lines.push(nextLine);\n    }\n\n    return lines.join('\\n');\n  },\n\n  _normalizeDiceVisibleSheetNames(value: unknown): string[] {\n    if (!Array.isArray(value)) {\n      return [];\n    }\n    const list: string[] = [];\n    const seen = new Set<string>();\n    for (const item of value) {\n      const name = this._normalizeReferenceText(item);\n      if (!name) {\n        continue;\n      }\n      if (seen.has(name)) {\n        continue;\n      }\n      seen.add(name);\n      list.push(name);\n    }\n    return list;\n  },\n\n  _getDiceSheetPriority(sheetName: string): number {\n    const map: Record<string, number> = {\n      : 0,\n      : 1,\n      : 2,\n      : 3,\n      : 4,\n      : 5,\n    };\n    return map[sheetName] ?? 99;\n  },\n\n  _buildDiceSheetSummary(sheet: Record<string, unknown>): string {\n    const sheetName = this._normalizeReferenceText(sheet.name || '') || '';\n    const content = Array.isArray(sheet.content) ? (sheet.content as unknown[]) : [];\n    const rows = content.filter((row): row is unknown[] => Array.isArray(row));\n\n    if (rows.length === 0) {\n      return '';\n    }\n\n    const headerRow = Array.isArray(rows[0]) ? rows[0] : [];\n    const headers = headerRow.map((cell, index) => this._normalizeReferenceText(cell) || `${index}`);\n    const dataRows = rows\n      .slice(1)\n      .filter(row => row.some((cell, index) => index > 0 && !!this._normalizeReferenceText(cell)));\n\n    if (dataRows.length === 0) {\n      return `${sheetName}: `;\n    }\n\n    const rowText = dataRows\n      .slice(-2)\n      .map(row => this._formatDiceSheetRow(headers, row))\n      .filter(text => !!text);\n    if (rowText.length === 0) {\n      return `${sheetName}: `;\n    }\n\n    return `${sheetName}: ${rowText.join(' | ')}`;\n  },\n\n  _formatDiceSheetRow(headers: string[], row: unknown[]): string {\n    const pairs: string[] = [];\n    for (let index = 1; index < row.length; index++) {\n      const value = this._normalizeReferenceText(row[index]);\n      if (!value) {\n        continue;\n      }\n      const label = headers[index] || `${index}`;\n      pairs.push(`${label}: ${this._truncateReferenceText(value, 56)}`);\n      if (pairs.length >= 3) {\n        break;\n      }\n    }\n\n    if (pairs.length > 0) {\n      return pairs.join('');\n    }\n\n    const fallback = row.map(cell => this._normalizeReferenceText(cell)).find(text => !!text) || '';\n    return this._truncateReferenceText(fallback, 90);\n  },\n\n  _normalizeReferenceText(value: unknown): string {\n    return String(value ?? '')\n      .replace(/\\u00a0/g, ' ')\n      .replace(/\\r\\n/g, '\\n')\n      .replace(/\\n+/g, ' ')\n      .replace(/\\s{2,}/g, ' ')\n      .trim();\n  },\n\n  _truncateReferenceText(text: string, maxLength: number): string {\n    if (text.length <= maxLength) {\n      return text;\n    }\n    return `${text.slice(0, Math.max(0, maxLength - 1))}`;\n  },\n\n  _getCurrentCharacterCardContent(): string {\n    try {\n      const context = SillyTavern?.getContext?.() as any;\n      if (!context) {\n        return '';\n      }\n\n      const characters = Array.isArray(context.characters) ? context.characters : [];\n      if (characters.length === 0) {\n        return '';\n      }\n\n      const charIdRaw = context.characterId;\n      let current: any = null;\n\n      if (charIdRaw !== undefined && charIdRaw !== null) {\n        const idText = String(charIdRaw).trim();\n        const idNum = Number(idText);\n        if (Number.isFinite(idNum) && idNum >= 0 && idNum < characters.length) {\n          current = characters[idNum];\n        }\n      }\n\n      if (!current) {\n        const currentName = String(context.name2 || '').trim();\n        if (currentName) {\n          current = characters.find((item: any) => String(item?.name || '').trim() === currentName) || null;\n        }\n      }\n\n      if (!current && characters.length === 1) {\n        current = characters[0];\n      }\n\n      if (!current) {\n        return '';\n      }\n\n      const fields: Array<[string, unknown]> = [\n        ['', current.name],\n        ['', current.description ?? current.data?.description],\n        ['', current.personality ?? current.data?.personality],\n        ['', current.scenario ?? current.data?.scenario],\n        ['', current.first_mes ?? current.data?.first_mes],\n        ['', current.mes_example ?? current.data?.mes_example],\n        ['', current.data?.system_prompt],\n        ['', current.data?.post_history_instructions],\n      ];\n\n      const lines = fields\n        .map(([label, value]) => {\n          const text = this._normalizeCharacterCardField(value);\n          return text ? `${label}: ${text}` : '';\n        })\n        .filter(line => !!line);\n\n      return lines.join('\\n');\n    } catch (e) {\n      warn(':', e);\n      return '';\n    }\n  },\n\n  _normalizeCharacterCardField(value: unknown): string {\n    return String(value ?? '')\n      .replace(/\\u00a0/g, ' ')\n      .replace(/\\r\\n/g, '\\n')\n      .replace(/\\n{3,}/g, '\\n\\n')\n      .trim();\n  },\n\n  _getTamakoTodaySpecialContent(): string {\n    try {\n      const topWindow = window.parent ?? window;\n      const topDocument = topWindow.document ?? document;\n      const currentSelector = '#tamako-market-window .tamako-content[data-content=\"current\"]';\n\n      const emptyMessage = topDocument.querySelector(`${currentSelector} .tamako-empty .message`);\n      if (emptyMessage) {\n        return '';\n      }\n\n      const plotContent = topDocument.querySelector(`${currentSelector} .tamako-plot-content`) as HTMLElement | null;\n      const directText = this._sanitizeTamakoText(plotContent?.innerText || plotContent?.textContent || '');\n      if (directText) {\n        return directText;\n      }\n\n      const beautifierFrame = topDocument.querySelector(\n        `${currentSelector} iframe.tamako-beautifier-frame`,\n      ) as HTMLIFrameElement | null;\n      const payload = this._readTamakoPayloadFromIframe(beautifierFrame);\n      const payloadText = this._extractTamakoTextFromPayload(payload);\n      if (payloadText) {\n        return payloadText;\n      }\n\n      const currentContent = topDocument.querySelector(currentSelector) as HTMLElement | null;\n      return this._sanitizeTamakoText(currentContent?.innerText || currentContent?.textContent || '');\n    } catch (e) {\n      warn(':', e);\n      return '';\n    }\n  },\n\n  _readTamakoPayloadFromIframe(iframe: HTMLIFrameElement | null): any | null {\n    if (!iframe) {\n      return null;\n    }\n    const name = String(iframe.name || '').trim();\n    if (!name.startsWith('TAMAKO_DATA:')) {\n      return null;\n    }\n    try {\n      return JSON.parse(name.slice('TAMAKO_DATA:'.length));\n    } catch (e) {\n      warn(' payload :', e);\n      return null;\n    }\n  },\n\n  _extractTamakoTextFromPayload(payload: any): string {\n    if (!payload || typeof payload !== 'object') {\n      return '';\n    }\n\n    const captureTags = this._getTamakoCaptureTags();\n    const tags = payload.tags && typeof payload.tags === 'object' ? payload.tags : {};\n    const valuesFromTags: string[] = [];\n    for (const tag of captureTags) {\n      const value = this._sanitizeTamakoText(tags[tag]);\n      if (value) {\n        valuesFromTags.push(value);\n      }\n    }\n    if (valuesFromTags.length > 0) {\n      return valuesFromTags.join('\\n\\n');\n    }\n\n    const raw = String(payload.raw || '');\n    if (!raw) {\n      return '';\n    }\n    return this._extractTamakoTagText(raw, captureTags);\n  },\n\n  _getTamakoCaptureTags(): string[] {\n    try {\n      const context = SillyTavern?.getContext?.() as any;\n      const tags = context?.extensionSettings?.TamakoMarket?.captureTags;\n      if (Array.isArray(tags)) {\n        const normalized = tags.map(tag => String(tag || '').trim()).filter(tag => !!tag);\n        if (normalized.length > 0) {\n          return normalized;\n        }\n      }\n    } catch {\n      // ignore\n    }\n    return ['recall', 'scene_direction'];\n  },\n\n  _extractTamakoTagText(raw: string, tags: string[]): string {\n    const values: string[] = [];\n    for (const tag of tags) {\n      const safeTag = String(tag || '').trim();\n      if (!safeTag) {\n        continue;\n      }\n      const escapedTag = safeTag.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n      const regex = new RegExp(`<${escapedTag}(?:\\\\s[^>]*)?>([\\\\s\\\\S]*?)<\\\\/${escapedTag}>`, 'gi');\n      let match: RegExpExecArray | null;\n      while ((match = regex.exec(raw)) !== null) {\n        const value = this._sanitizeTamakoText(match[1] || '');\n        if (value) {\n          values.push(value);\n        }\n      }\n    }\n    return values.join('\\n\\n');\n  },\n\n  _sanitizeTamakoText(value: unknown): string {\n    const text = String(value ?? '')\n      .replace(/\\u00a0/g, ' ')\n      .replace(/\\r\\n/g, '\\n')\n      .replace(/\\n{3,}/g, '\\n\\n')\n      .trim();\n    if (!text) {\n      return '';\n    }\n    if (/^(~|\\.\\.\\.||\\.\\.\\.|\\.\\.\\.|\\.\\.\\.)$/.test(text)) {\n      return '';\n    }\n    return text;\n  },\n\n  destroy(): void {\n    this._cleanupStreamListener();\n    this._onComment = null;\n    this._latestStreamText = '';\n    this.isGenerating = false;\n  },\n};\n","import type { EmotionTag } from '../core/constants';\nimport { resolveEmotionTag, type EmotionConfig } from '../core/emotion';\n\nconst RE_THINK_CLOSED = /<(think|thinking)>[\\s\\S]*?<\\/\\1>/gi;\nconst RE_THINK_UNCLOSED = /<(think|thinking)>[\\s\\S]*$/gi;\n\nexport type EmotionCotParseResult = {\n  cleanText: string;\n  rawTag: string | null;\n  normalizedTag: EmotionTag | null;\n  context: string | null;\n};\n\nexport function stripThinkBlocks(input: unknown): string {\n  const text = String(input || '');\n  return text.replace(RE_THINK_CLOSED, '').replace(RE_THINK_UNCLOSED, '');\n}\n\nfunction parseBracketContent(bracketContent: string): { rawTag: string; context: string | null } {\n  const content = String(bracketContent || '').trim();\n  if (!content) return { rawTag: '', context: null };\n\n  const pipeParts = content.split('|');\n  const exprVoicePart = (pipeParts[0] || '').trim();\n  const context = (pipeParts[1] || '').trim();\n\n  const expression = (exprVoicePart.split(',')[0] || '').trim();\n  return { rawTag: expression, context: context || null };\n}\n\nfunction isPendingPrefix(text: string): boolean {\n  const t = String(text || '').trimStart();\n  if (!t) return false;\n\n  if (t.startsWith('[')) {\n    const close = t.indexOf(']');\n    if (close === -1) return true;\n    const body = t.slice(close + 1);\n    return !body.trim();\n  }\n\n  const open = t.indexOf('[');\n  if (open > 0 && open < 30) {\n    const close = t.indexOf(']', open + 1);\n    if (close === -1) return true;\n    const after = t.slice(close + 1);\n    if (!/^\\s*[:]/.test(after)) return true;\n    const body = after.replace(/^\\s*[:]\\s*/, '');\n    return !body.trim();\n  }\n\n  return false;\n}\n\nexport function parseEmotionCotText(\n  input: unknown,\n  options: {\n    enabled: boolean;\n    stripFromText: boolean;\n    configs: EmotionConfig[];\n  },\n): EmotionCotParseResult {\n  const rawText = stripThinkBlocks(input);\n\n  if (!options.enabled) {\n    return {\n      cleanText: rawText,\n      rawTag: null,\n      normalizedTag: null,\n      context: null,\n    };\n  }\n\n  if (isPendingPrefix(rawText)) {\n    return {\n      cleanText: '',\n      rawTag: null,\n      normalizedTag: null,\n      context: null,\n    };\n  }\n\n  // Speaker : [|]: \n  const speakerMatch = rawText.match(/^\\s*([^\\[\\]\\n\\r]{1,40})\\s*\\[([^\\]]+)\\]\\s*[:]\\s*([\\s\\S]*)$/);\n  if (speakerMatch) {\n    const bracketContent = speakerMatch[2] || '';\n    const body = speakerMatch[3] || '';\n    const { rawTag, context } = parseBracketContent(bracketContent);\n    const normalizedTag = resolveEmotionTag(rawTag, options.configs);\n\n    return {\n      cleanText: normalizedTag && options.stripFromText ? body.trimStart() : rawText,\n      rawTag: rawTag || null,\n      normalizedTag,\n      context,\n    };\n  }\n\n  // : [|] \n  const prefixMatch = rawText.match(/^\\s*\\[([^\\]]+)\\]\\s*([\\s\\S]*)$/);\n  if (prefixMatch) {\n    const bracketContent = prefixMatch[1] || '';\n    const body = prefixMatch[2] || '';\n    const { rawTag, context } = parseBracketContent(bracketContent);\n    const normalizedTag = resolveEmotionTag(rawTag, options.configs);\n\n    return {\n      cleanText: normalizedTag && options.stripFromText ? body.trimStart() : rawText,\n      rawTag: rawTag || null,\n      normalizedTag,\n      context,\n    };\n  }\n\n  return {\n    cleanText: rawText,\n    rawTag: null,\n    normalizedTag: null,\n    context: null,\n  };\n}\n","import { defineStore } from 'pinia';\nimport { ref } from 'vue';\n\n/**\n *  UI \n */\nexport const useUiStore = defineStore('desktop-pet-ui', () => {\n  const showSettings = ref(false);\n\n  function openSettings(): void {\n    showSettings.value = true;\n  }\n\n  function closeSettings(): void {\n    showSettings.value = false;\n  }\n\n  return { showSettings, openSettings, closeSettings };\n});\n\n","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"bubble-content\" };\nconst _hoisted_2 = { class: \"bubble-text\" };\nconst _hoisted_3 = {\n    key: 1,\n    class: \"cursor\"\n};\nimport { onUnmounted, ref, watch } from 'vue';\nimport { Live2DManager } from '../live2d/manager';\nconst HEAD_ANCHOR_RATIO = 0.2;\nconst BUBBLE_GAP = 12;\nconst MIN_BUBBLE_TOP = 8;\nconst EDGE_PADDING = 8;\nconst LOADING_INTERVAL_MS = 340;\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ChatBubble',\n    props: {\n        text: {},\n        isDone: { type: Boolean },\n        autoCloseDelaySeconds: {}\n    },\n    emits: [\"hidden\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const visible = ref(false);\n        const displayText = ref('');\n        const bubbleStyle = ref({});\n        const LOADING_FRAMES = ['', '', '', ''];\n        let positionTimer = null;\n        let loadingTimer = null;\n        let autoCloseTimer = null;\n        let loadingFrameIndex = 0;\n        function getTopWindow() {\n            try {\n                return window.parent ?? window;\n            }\n            catch {\n                return window;\n            }\n        }\n        function getFiniteNumber(value) {\n            const n = typeof value === 'number' ? value : Number(value);\n            return Number.isFinite(n) ? n : null;\n        }\n        function getModelHeadAnchor(rect) {\n            const model = Live2DManager.model;\n            if (!model || typeof model.getBounds !== 'function')\n                return null;\n            try {\n                const bounds = model.getBounds?.();\n                const x = getFiniteNumber(bounds?.x);\n                const y = getFiniteNumber(bounds?.y);\n                const width = getFiniteNumber(bounds?.width);\n                const height = getFiniteNumber(bounds?.height);\n                if (x === null || y === null || width === null || height === null || width <= 0 || height <= 0) {\n                    return null;\n                }\n                return {\n                    x: rect.left + x + width / 2,\n                    y: rect.top + y + height * HEAD_ANCHOR_RATIO,\n                };\n            }\n            catch {\n                return null;\n            }\n        }\n        function updateBubblePosition() {\n            try {\n                const top = getTopWindow();\n                const stage = top.document.getElementById('desktop-pet-stage');\n                const rect = stage?.getBoundingClientRect?.();\n                const vw = top.innerWidth || top.document.documentElement.clientWidth || 0;\n                const vh = top.innerHeight || top.document.documentElement.clientHeight || 0;\n                if (rect && rect.width > 0 && rect.height > 0) {\n                    const anchor = getModelHeadAnchor(rect);\n                    const fallbackX = rect.left + rect.width / 2;\n                    const fallbackY = rect.top + rect.height * 0.22;\n                    const rawLeft = anchor?.x ?? fallbackX;\n                    const rawTop = (anchor?.y ?? fallbackY) - BUBBLE_GAP;\n                    const safeLeft = Math.max(EDGE_PADDING, Math.min(rawLeft, Math.max(EDGE_PADDING, vw - EDGE_PADDING)));\n                    const safeTop = Math.max(MIN_BUBBLE_TOP, Math.min(rawTop, Math.max(MIN_BUBBLE_TOP, vh - EDGE_PADDING)));\n                    bubbleStyle.value = {\n                        left: `${Math.round(safeLeft)}px`,\n                        top: `${Math.round(safeTop)}px`,\n                    };\n                    return;\n                }\n                bubbleStyle.value = {\n                    left: `${Math.round(vw * 0.5)}px`,\n                    top: `${Math.round(Math.max(8, vh * 0.2))}px`,\n                };\n            }\n            catch {\n                bubbleStyle.value = {\n                    left: '50vw',\n                    top: '20vh',\n                };\n            }\n        }\n        function startPositionSync() {\n            stopPositionSync();\n            updateBubblePosition();\n            positionTimer = setInterval(updateBubblePosition, 100);\n        }\n        function stopPositionSync() {\n            if (!positionTimer)\n                return;\n            clearInterval(positionTimer);\n            positionTimer = null;\n        }\n        function startLoadingAnimation() {\n            if (loadingTimer)\n                return;\n            loadingFrameIndex = 0;\n            displayText.value = LOADING_FRAMES[loadingFrameIndex];\n            loadingTimer = setInterval(() => {\n                loadingFrameIndex = (loadingFrameIndex + 1) % LOADING_FRAMES.length;\n                displayText.value = LOADING_FRAMES[loadingFrameIndex];\n            }, LOADING_INTERVAL_MS);\n        }\n        function stopLoadingAnimation() {\n            if (!loadingTimer)\n                return;\n            clearInterval(loadingTimer);\n            loadingTimer = null;\n        }\n        function stopAutoCloseTimer() {\n            if (!autoCloseTimer)\n                return;\n            clearTimeout(autoCloseTimer);\n            autoCloseTimer = null;\n        }\n        function getAutoCloseDelayMs() {\n            const delaySeconds = typeof props.autoCloseDelaySeconds === 'number'\n                ? props.autoCloseDelaySeconds\n                : Number(props.autoCloseDelaySeconds ?? Number.NaN);\n            if (!Number.isFinite(delaySeconds))\n                return -1;\n            const normalizedSeconds = Math.round(delaySeconds);\n            if (normalizedSeconds < 0)\n                return normalizedSeconds;\n            return normalizedSeconds * 1000;\n        }\n        function scheduleAutoClose() {\n            stopAutoCloseTimer();\n            if (!props.isDone)\n                return;\n            if (!String(props.text || '').trim())\n                return;\n            const delayMs = getAutoCloseDelayMs();\n            if (delayMs < 0)\n                return;\n            autoCloseTimer = setTimeout(() => {\n                autoCloseTimer = null;\n                closeBubble();\n            }, delayMs);\n        }\n        function syncBubbleState() {\n            const text = String(props.text || '');\n            if (text) {\n                visible.value = true;\n                displayText.value = text;\n                stopLoadingAnimation();\n                startPositionSync();\n                scheduleAutoClose();\n                return;\n            }\n            if (!props.isDone) {\n                visible.value = true;\n                startLoadingAnimation();\n                startPositionSync();\n                stopAutoCloseTimer();\n                return;\n            }\n            visible.value = false;\n            displayText.value = '';\n            stopLoadingAnimation();\n            stopPositionSync();\n            stopAutoCloseTimer();\n        }\n        watch([() => props.text, () => props.isDone, () => props.autoCloseDelaySeconds], syncBubbleState, {\n            immediate: true,\n        });\n        function closeBubble() {\n            visible.value = false;\n            displayText.value = '';\n            stopLoadingAnimation();\n            stopPositionSync();\n            stopAutoCloseTimer();\n            emit('hidden');\n        }\n        onUnmounted(() => {\n            stopLoadingAnimation();\n            stopPositionSync();\n            stopAutoCloseTimer();\n        });\n        return (_ctx, _cache) => {\n            return (visible.value)\n                ? (_openBlock(), _createElementBlock(\"div\", {\n                    key: 0,\n                    class: \"chat-bubble\",\n                    style: _normalizeStyle(bubbleStyle.value)\n                }, [\n                    _createElementVNode(\"div\", _hoisted_1, [\n                        (__props.isDone)\n                            ? (_openBlock(), _createElementBlock(\"button\", {\n                                key: 0,\n                                type: \"button\",\n                                class: \"bubble-close\",\n                                \"aria-label\": \"\",\n                                onClick: closeBubble\n                            }, \"  \"))\n                            : _createCommentVNode(\"v-if\", true),\n                        _createElementVNode(\"span\", _hoisted_2, _toDisplayString(displayText.value), 1 /* TEXT */),\n                        (!__props.isDone)\n                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_3, \"|\"))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]),\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"bubble-arrow\" }, null, -1 /* CACHED */))\n                ], 4 /* STYLE */))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ChatBubble.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ChatBubble.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ChatBubble.vue?vue&type=style&index=0&id=98097aea&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-98097aea\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, toDisplayString as _toDisplayString, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, Transition as _Transition, withCtx as _withCtx, createVNode as _createVNode, withModifiers as _withModifiers, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"menu-panel\" };\nconst _hoisted_2 = { class: \"command-sub\" };\nconst _hoisted_3 = { class: \"command-sub\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"chat-drawer\"\n};\nconst _hoisted_5 = { class: \"drawer-head\" };\nconst _hoisted_6 = { class: \"drawer-actions\" };\nconst _hoisted_7 = [\"disabled\"];\nimport { computed, nextTick, onUnmounted, ref, watch } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'FunctionMenu',\n    props: {\n        visible: { type: Boolean },\n        x: {},\n        y: {},\n        placement: {},\n        motionLoopEnabled: { type: Boolean },\n        commentStyle: {}\n    },\n    emits: [\"close\", \"send-chat\", \"toggle-motion-loop\", \"switch-model\", \"switch-persona\", \"close-model\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const menuEl = ref(null);\n        const inputEl = ref(null);\n        const input = ref('');\n        const chatOpen = ref(false);\n        const posX = ref(0);\n        const posY = ref(0);\n        function getTopWindow() {\n            try {\n                return window.parent ?? window;\n            }\n            catch {\n                return window;\n            }\n        }\n        const panelTransform = computed(() => (props.placement === 'left'\n            ? 'translate(-100%, -50%)'\n            : 'translate(0, -50%)'));\n        const panelStyle = computed(() => ({\n            left: `${posX.value}px`,\n            top: `${posY.value}px`,\n            transform: panelTransform.value,\n        }));\n        function clampIntoViewport() {\n            const el = menuEl.value;\n            if (!el)\n                return;\n            const top = getTopWindow();\n            const vw = top.innerWidth || top.document.documentElement.clientWidth || 0;\n            const vh = top.innerHeight || top.document.documentElement.clientHeight || 0;\n            const margin = 8;\n            const rect = el.getBoundingClientRect();\n            if (vw > 0) {\n                if (rect.left < margin) {\n                    posX.value += margin - rect.left;\n                }\n                else if (rect.right > vw - margin) {\n                    posX.value -= rect.right - (vw - margin);\n                }\n            }\n            if (vh > 0) {\n                if (rect.top < margin) {\n                    posY.value += margin - rect.top;\n                }\n                else if (rect.bottom > vh - margin) {\n                    posY.value -= rect.bottom - (vh - margin);\n                }\n            }\n        }\n        function close() {\n            chatOpen.value = false;\n            emit('close');\n        }\n        function send() {\n            const message = input.value.trim();\n            if (!message)\n                return;\n            emit('send-chat', message);\n            input.value = '';\n        }\n        function openChat() {\n            chatOpen.value = true;\n            void nextTick(() => {\n                clampIntoViewport();\n                inputEl.value?.focus();\n                inputEl.value?.select();\n            });\n        }\n        function onInputKeydown(e) {\n            if (e.key === 'Escape') {\n                e.preventDefault();\n                close();\n                return;\n            }\n            if (e.key === 'Enter' && !e.shiftKey) {\n                e.preventDefault();\n                send();\n            }\n        }\n        const onGlobalKeydown = (e) => {\n            if (!props.visible)\n                return;\n            if (e.key === 'Escape') {\n                e.preventDefault();\n                close();\n            }\n        };\n        watch(() => props.visible, async (visible) => {\n            if (!visible) {\n                chatOpen.value = false;\n                return;\n            }\n            posX.value = Number.isFinite(props.x) ? props.x : 0;\n            posY.value = Number.isFinite(props.y) ? props.y : 0;\n            chatOpen.value = false;\n            await nextTick();\n            clampIntoViewport();\n        }, { immediate: true });\n        watch(() => [props.x, props.y, props.placement, chatOpen.value], async () => {\n            if (!props.visible)\n                return;\n            posX.value = Number.isFinite(props.x) ? props.x : 0;\n            posY.value = Number.isFinite(props.y) ? props.y : 0;\n            await nextTick();\n            clampIntoViewport();\n        });\n        try {\n            getTopWindow().addEventListener('keydown', onGlobalKeydown);\n        }\n        catch {\n            // ignore\n        }\n        onUnmounted(() => {\n            try {\n                getTopWindow().removeEventListener('keydown', onGlobalKeydown);\n            }\n            catch {\n                // ignore\n            }\n        });\n        return (_ctx, _cache) => {\n            return (__props.visible)\n                ? (_openBlock(), _createElementBlock(\"div\", {\n                    key: 0,\n                    class: \"menu-overlay\",\n                    onClick: _withModifiers(close, [\"self\"])\n                }, [\n                    _createElementVNode(\"div\", {\n                        ref_key: \"menuEl\",\n                        ref: menuEl,\n                        class: _normalizeClass([\"menu-cluster\", [`is-${__props.placement}`, { 'chat-open': chatOpen.value }]]),\n                        style: _normalizeStyle(panelStyle.value),\n                        onClick: _cache[6] || (_cache[6] = _withModifiers(() => { }, [\"stop\"]))\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_1, [\n                            _createElementVNode(\"div\", { class: \"panel-top\" }, [\n                                _cache[7] || (_cache[7] = _createElementVNode(\"span\", { class: \"panel-title\" }, \"TACTICAL\", -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"icon-btn\",\n                                    type: \"button\",\n                                    onClick: close\n                                }, \"\")\n                            ]),\n                            _createElementVNode(\"button\", {\n                                class: _normalizeClass([\"command-btn\", { active: chatOpen.value }]),\n                                type: \"button\",\n                                onClick: openChat\n                            }, [...(_cache[8] || (_cache[8] = [\n                                    _createElementVNode(\"span\", { class: \"command-index\" }, \"01\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-main\" }, \"CHAT\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-sub\" }, \"MESSAGE LINK\", -1 /* CACHED */)\n                                ]))], 2 /* CLASS */),\n                            _createElementVNode(\"button\", {\n                                class: \"command-btn\",\n                                type: \"button\",\n                                onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('toggle-motion-loop')))\n                            }, [\n                                _cache[9] || (_cache[9] = _createElementVNode(\"span\", { class: \"command-index\" }, \"02\", -1 /* CACHED */)),\n                                _cache[10] || (_cache[10] = _createElementVNode(\"span\", { class: \"command-main\" }, \"MOTION\", -1 /* CACHED */)),\n                                _createElementVNode(\"span\", _hoisted_2, _toDisplayString(__props.motionLoopEnabled ? 'ON' : 'OFF'), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"button\", {\n                                class: \"command-btn\",\n                                type: \"button\",\n                                onClick: _cache[1] || (_cache[1] = ($event) => (_ctx.$emit('switch-model')))\n                            }, [...(_cache[11] || (_cache[11] = [\n                                    _createElementVNode(\"span\", { class: \"command-index\" }, \"03\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-main\" }, \"MODEL\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-sub\" }, \"SWITCH\", -1 /* CACHED */)\n                                ]))]),\n                            _createElementVNode(\"button\", {\n                                class: \"command-btn\",\n                                type: \"button\",\n                                onClick: _cache[2] || (_cache[2] = ($event) => (_ctx.$emit('switch-persona')))\n                            }, [\n                                _cache[12] || (_cache[12] = _createElementVNode(\"span\", { class: \"command-index\" }, \"04\", -1 /* CACHED */)),\n                                _cache[13] || (_cache[13] = _createElementVNode(\"span\", { class: \"command-main\" }, \"PERSONA\", -1 /* CACHED */)),\n                                _createElementVNode(\"span\", _hoisted_3, _toDisplayString(__props.commentStyle), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"button\", {\n                                class: \"command-btn danger\",\n                                type: \"button\",\n                                onClick: _cache[3] || (_cache[3] = ($event) => (_ctx.$emit('close-model')))\n                            }, [...(_cache[14] || (_cache[14] = [\n                                    _createElementVNode(\"span\", { class: \"command-index\" }, \"05\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-main\" }, \"CLOSE\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", { class: \"command-sub\" }, \"MODEL OFF\", -1 /* CACHED */)\n                                ]))])\n                        ]),\n                        _createVNode(_Transition, { name: \"drawer\" }, {\n                            default: _withCtx(() => [\n                                (chatOpen.value)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                                        _createElementVNode(\"div\", _hoisted_5, [\n                                            _cache[15] || (_cache[15] = _createElementVNode(\"span\", { class: \"drawer-title\" }, \"MESSAGE LINK\", -1 /* CACHED */)),\n                                            _createElementVNode(\"button\", {\n                                                class: \"drawer-close\",\n                                                type: \"button\",\n                                                onClick: _cache[4] || (_cache[4] = ($event) => (chatOpen.value = false))\n                                            }, \"\")\n                                        ]),\n                                        _withDirectives(_createElementVNode(\"textarea\", {\n                                            ref_key: \"inputEl\",\n                                            ref: inputEl,\n                                            \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event) => ((input).value = $event)),\n                                            class: \"chat-input\",\n                                            rows: \"4\",\n                                            placeholder: \"... (Enter  / Shift+Enter )\",\n                                            onKeydown: onInputKeydown\n                                        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                            [_vModelText, input.value]\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_6, [\n                                            _createElementVNode(\"button\", {\n                                                class: \"send-btn\",\n                                                type: \"button\",\n                                                disabled: !input.value.trim(),\n                                                onClick: send\n                                            }, \" SEND \", 8 /* PROPS */, _hoisted_7)\n                                        ]),\n                                        _cache[16] || (_cache[16] = _createElementVNode(\"div\", { class: \"drawer-hint\" }, \"\", -1 /* CACHED */))\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]),\n                            _: 1 /* STABLE */\n                        })\n                    ], 6 /* CLASS, STYLE */)\n                ]))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./FunctionMenu.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FunctionMenu.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./FunctionMenu.vue?vue&type=style&index=0&id=ff4f8948&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-ff4f8948\"]])\n\nexport default __exports__","import { EIKANYA_API_BASE, EIKANYA_CDN_BASE, EIKANYA_RAW_BASE } from '../core/constants';\nimport { Live2DManager } from './manager';\n\n/**  */\nexport interface RepoEntry {\n  name: string;\n  path: string;\n  type: 'file' | 'dir';\n  isModel: boolean;\n}\n\n/**  */\nconst cache = new Map<string, RepoEntry[]>();\n\n/**  Live2D  JSON */\nexport function isModelFile(name: string): boolean {\n  const lower = name.toLowerCase();\n  return (\n    lower === 'model.json' ||\n    lower === 'model3.json' ||\n    lower.endsWith('.model.json') ||\n    lower.endsWith('.model3.json')\n  );\n}\n\n/**  */\nconst FILTERED_EXTENSIONS = ['.zip', '.rar', '.7z', '.md', '.txt', '.png', '.jpg', '.jpeg', '.gif', '.bmp', '.psd', '.webp', '.mp3', '.wav', '.ogg', '.mp4', '.mtn'];\n\nfunction shouldShow(entry: { name: string; type: string }): boolean {\n  if (entry.type === 'dir') return true;\n  if (isModelFile(entry.name)) return true;\n  // \n  const lower = entry.name.toLowerCase();\n  for (const ext of FILTERED_EXTENSIONS) {\n    if (lower.endsWith(ext)) return false;\n  }\n  //  JSON \n  return isModelFile(entry.name);\n}\n\n/**  GitHub API  */\nexport async function fetchDirectory(path: string): Promise<RepoEntry[]> {\n  // \n  const cached = cache.get(path);\n  if (cached) return cached;\n\n  const apiUrl = `${EIKANYA_API_BASE}${path}`;\n\n  let data: any[];\n  try {\n    //  GitHub API CORS\n    const resp = await fetch(apiUrl, {\n      headers: { Accept: 'application/vnd.github.v3+json' },\n    });\n\n    if (resp.status === 403) {\n      const remaining = resp.headers.get('X-RateLimit-Remaining');\n      const resetTime = resp.headers.get('X-RateLimit-Reset');\n      const resetDate = resetTime ? new Date(parseInt(resetTime) * 1000) : null;\n      throw new RateLimitError(remaining, resetDate);\n    }\n\n    if (!resp.ok) throw new Error(`HTTP ${resp.status}`);\n    data = await resp.json();\n  } catch (e) {\n    if (e instanceof RateLimitError) throw e;\n    //  CORS \n    const proxiedUrl = Live2DManager._getProxiedUrl(apiUrl);\n    const resp = await fetch(proxiedUrl, {\n      headers: { Accept: 'application/vnd.github.v3+json' },\n    });\n\n    if (resp.status === 403) {\n      throw new RateLimitError(null, null);\n    }\n    if (!resp.ok) throw new Error(`: HTTP ${resp.status}`);\n    data = await resp.json();\n  }\n\n  if (!Array.isArray(data)) {\n    throw new Error('GitHub API ');\n  }\n\n  const entries: RepoEntry[] = data\n    .map((item: any) => ({\n      name: item.name as string,\n      path: item.path as string,\n      type: (item.type === 'dir' ? 'dir' : 'file') as 'file' | 'dir',\n      isModel: item.type === 'file' && isModelFile(item.name),\n    }))\n    .filter(shouldShow)\n    .sort((a, b) => {\n      // \n      if (a.type !== b.type) return a.type === 'dir' ? -1 : 1;\n      return a.name.localeCompare(b.name);\n    });\n\n  cache.set(path, entries);\n  return entries;\n}\n\n/**  GitHub  CDN  raw URL ASCII  */\nexport function buildCdnUrl(path: string, useCdn: boolean = true): string {\n  const encodedPath = path.split('/').map(s => encodeURIComponent(s)).join('/');\n  const base = useCdn ? EIKANYA_CDN_BASE : EIKANYA_RAW_BASE;\n  return `${base}${encodedPath}`;\n}\n\n/**  */\nexport function clearCache(): void {\n  cache.clear();\n}\n\n/** API  */\nexport class RateLimitError extends Error {\n  remaining: string | null;\n  resetDate: Date | null;\n\n  constructor(remaining: string | null, resetDate: Date | null) {\n    const resetStr = resetDate ? resetDate.toLocaleTimeString() : '';\n    super(`GitHub API  ${resetStr} `);\n    this.name = 'RateLimitError';\n    this.remaining = remaining;\n    this.resetDate = resetDate;\n  }\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode, Fragment as _Fragment, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, renderList as _renderList, resolveComponent as _resolveComponent, createBlock as _createBlock, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = { class: \"tree-node\" };\nconst _hoisted_2 = {\n    key: 1,\n    class: \"expand-icon placeholder\"\n};\nconst _hoisted_3 = { class: \"node-icon\" };\nconst _hoisted_4 = [\"title\"];\nconst _hoisted_5 = {\n    key: 2,\n    class: \"node-spinner\"\n};\nimport { ref, computed } from 'vue';\nimport { fetchDirectory, RateLimitError } from '../live2d/model-browser';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'TreeNode',\n    props: {\n        entry: {},\n        depth: {},\n        searchQuery: {}\n    },\n    emits: [\"select-model\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const expanded = ref(false);\n        const children = ref([]);\n        const loading = ref(false);\n        const loadedOnce = ref(false);\n        const childError = ref('');\n        const isSelected = ref(false);\n        const filteredChildren = computed(() => {\n            if (!props.searchQuery.trim())\n                return children.value;\n            const q = props.searchQuery.toLowerCase();\n            return children.value.filter(c => c.name.toLowerCase().includes(q) || c.type === 'dir');\n        });\n        async function loadChildren() {\n            loading.value = true;\n            childError.value = '';\n            try {\n                children.value = await fetchDirectory(props.entry.path);\n                loadedOnce.value = true;\n            }\n            catch (e) {\n                if (e instanceof RateLimitError) {\n                    childError.value = e.message;\n                }\n                else {\n                    childError.value = `: ${e.message || ''}`;\n                }\n            }\n            finally {\n                loading.value = false;\n            }\n        }\n        function handleClick() {\n            if (props.entry.type === 'dir') {\n                expanded.value = !expanded.value;\n                if (expanded.value && !loadedOnce.value) {\n                    loadChildren();\n                }\n            }\n            else if (props.entry.isModel) {\n                isSelected.value = true;\n                emit('select-model', props.entry.path);\n            }\n        }\n        return (_ctx, _cache) => {\n            const _component_TreeNode = _resolveComponent(\"TreeNode\", true);\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", {\n                    class: _normalizeClass([\"node-row\", { 'is-model': __props.entry.isModel, 'is-selected': isSelected.value }]),\n                    style: _normalizeStyle({ paddingLeft: __props.depth * 16 + 'px' }),\n                    onClick: handleClick\n                }, [\n                    _createCommentVNode(\" / \"),\n                    (__props.entry.type === 'dir')\n                        ? (_openBlock(), _createElementBlock(\"span\", {\n                            key: 0,\n                            class: _normalizeClass([\"expand-icon\", { expanded: expanded.value }])\n                        }, \"  \", 2 /* CLASS */))\n                        : (_openBlock(), _createElementBlock(\"span\", _hoisted_2)),\n                    _createCommentVNode(\"  \"),\n                    _createElementVNode(\"span\", _hoisted_3, [\n                        (__props.entry.type === 'dir')\n                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                                _createTextVNode(\"\")\n                            ], 64 /* STABLE_FRAGMENT */))\n                            : (__props.entry.isModel)\n                                ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                    _createTextVNode(\"\")\n                                ], 64 /* STABLE_FRAGMENT */))\n                                : (_openBlock(), _createElementBlock(_Fragment, { key: 2 }, [\n                                    _createTextVNode(\"\")\n                                ], 64 /* STABLE_FRAGMENT */))\n                    ]),\n                    _createCommentVNode(\"  \"),\n                    _createElementVNode(\"span\", {\n                        class: \"node-name\",\n                        title: __props.entry.path\n                    }, _toDisplayString(__props.entry.name), 9 /* TEXT, PROPS */, _hoisted_4),\n                    _createCommentVNode(\"  \"),\n                    (loading.value)\n                        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5))\n                        : _createCommentVNode(\"v-if\", true)\n                ], 6 /* CLASS, STYLE */),\n                _createCommentVNode(\"  \"),\n                (expanded.value && children.value.length > 0)\n                    ? (_openBlock(true), _createElementBlock(_Fragment, { key: 0 }, _renderList(filteredChildren.value, (child) => {\n                        return (_openBlock(), _createBlock(_component_TreeNode, {\n                            key: child.path,\n                            entry: child,\n                            depth: __props.depth + 1,\n                            \"search-query\": __props.searchQuery,\n                            onSelectModel: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('select-model', $event)))\n                        }, null, 8 /* PROPS */, [\"entry\", \"depth\", \"search-query\"]));\n                    }), 128 /* KEYED_FRAGMENT */))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\"  \"),\n                (expanded.value && !loading.value && children.value.length === 0 && loadedOnce.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 1,\n                        class: \"empty-hint\",\n                        style: _normalizeStyle({ paddingLeft: (__props.depth + 1) * 16 + 8 + 'px' })\n                    }, \"  \", 4 /* STYLE */))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\"  \"),\n                (expanded.value && childError.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 2,\n                        class: \"child-error\",\n                        style: _normalizeStyle({ paddingLeft: (__props.depth + 1) * 16 + 8 + 'px' })\n                    }, [\n                        _createTextVNode(_toDisplayString(childError.value) + \" \", 1 /* TEXT */),\n                        _createElementVNode(\"button\", {\n                            class: \"retry-link\",\n                            onClick: _withModifiers(loadChildren, [\"stop\"])\n                        }, \"\")\n                    ], 4 /* STYLE */))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./TreeNode.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TreeNode.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TreeNode.vue?vue&type=style&index=0&id=3a6a95ba&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3a6a95ba\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"model-browser\" };\nconst _hoisted_2 = { class: \"search-box\" };\nconst _hoisted_3 = {\n    key: 0,\n    class: \"error-bar\"\n};\nconst _hoisted_4 = { class: \"tree-container\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"loading-state\"\n};\nconst _hoisted_6 = {\n    key: 0,\n    class: \"empty-state\"\n};\nconst _hoisted_7 = { class: \"browser-footer\" };\nconst _hoisted_8 = {\n    key: 0,\n    class: \"selected-info\"\n};\nconst _hoisted_9 = { class: \"selected-path\" };\nconst _hoisted_10 = {\n    key: 1,\n    class: \"selected-info\"\n};\nconst _hoisted_11 = { class: \"footer-actions\" };\nconst _hoisted_12 = [\"disabled\"];\nimport { ref, computed } from 'vue';\nimport { fetchDirectory, buildCdnUrl, RateLimitError } from '../live2d/model-browser';\nimport TreeNode from './TreeNode.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ModelBrowser',\n    props: {\n        useCdn: { type: Boolean }\n    },\n    emits: [\"cancel\", \"load-model\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const rootEntries = ref([]);\n        const rootLoading = ref(false);\n        const errorMsg = ref('');\n        const searchQuery = ref('');\n        const selectedPath = ref('');\n        const selectedName = computed(() => {\n            if (!selectedPath.value)\n                return '';\n            const parts = selectedPath.value.split('/');\n            return parts[parts.length - 1];\n        });\n        const filteredRootEntries = computed(() => {\n            if (!searchQuery.value.trim())\n                return rootEntries.value;\n            const q = searchQuery.value.toLowerCase();\n            return rootEntries.value.filter(e => e.name.toLowerCase().includes(q));\n        });\n        function onSelectModel(path) {\n            selectedPath.value = path;\n        }\n        function confirmLoad() {\n            if (!selectedPath.value)\n                return;\n            const cdnUrl = buildCdnUrl(selectedPath.value, props.useCdn);\n            emit('load-model', cdnUrl);\n        }\n        async function loadRoot() {\n            rootLoading.value = true;\n            errorMsg.value = '';\n            try {\n                rootEntries.value = await fetchDirectory('');\n            }\n            catch (e) {\n                if (e instanceof RateLimitError) {\n                    errorMsg.value = e.message;\n                }\n                else {\n                    errorMsg.value = `: ${e.message || ''}`;\n                }\n            }\n            finally {\n                rootLoading.value = false;\n            }\n        }\n        // \n        loadRoot();\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _cache[5] || (_cache[5] = _createElementVNode(\"div\", { class: \"browser-header\" }, [\n                    _createElementVNode(\"span\", { class: \"browser-title\" }, \"\"),\n                    _createElementVNode(\"span\", { class: \"browser-hint\" }, \"Eikanya/Live2d-model\")\n                ], -1 /* CACHED */)),\n                _createCommentVNode(\"  \"),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _withDirectives(_createElementVNode(\"input\", {\n                        type: \"text\",\n                        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((searchQuery).value = $event)),\n                        placeholder: \"...\"\n                    }, null, 512 /* NEED_PATCH */), [\n                        [_vModelText, searchQuery.value]\n                    ])\n                ]),\n                _createCommentVNode(\"  \"),\n                (errorMsg.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                        _createElementVNode(\"span\", null, _toDisplayString(errorMsg.value), 1 /* TEXT */),\n                        _createElementVNode(\"button\", {\n                            class: \"retry-btn\",\n                            onClick: loadRoot\n                        }, \"\")\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\"  \"),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    (rootLoading.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [...(_cache[2] || (_cache[2] = [\n                                _createElementVNode(\"span\", { class: \"spinner\" }, null, -1 /* CACHED */),\n                                _createTextVNode(\" ... \", -1 /* CACHED */)\n                            ]))]))\n                        : (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredRootEntries.value, (entry) => {\n                                return (_openBlock(), _createBlock(TreeNode, {\n                                    key: entry.path,\n                                    entry: entry,\n                                    depth: 0,\n                                    \"search-query\": searchQuery.value,\n                                    onSelectModel: onSelectModel\n                                }, null, 8 /* PROPS */, [\"entry\", \"search-query\"]));\n                            }), 128 /* KEYED_FRAGMENT */)),\n                            (rootEntries.value.length === 0 && !rootLoading.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, \"  \"))\n                                : _createCommentVNode(\"v-if\", true)\n                        ], 64 /* STABLE_FRAGMENT */))\n                ]),\n                _createCommentVNode(\"  &  \"),\n                _createElementVNode(\"div\", _hoisted_7, [\n                    (selectedPath.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n                            _cache[3] || (_cache[3] = _createTextVNode(\" : \", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", _hoisted_9, _toDisplayString(selectedName.value), 1 /* TEXT */)\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [...(_cache[4] || (_cache[4] = [\n                                _createElementVNode(\"span\", { class: \"no-selection\" }, \"\", -1 /* CACHED */)\n                            ]))])),\n                    _createElementVNode(\"div\", _hoisted_11, [\n                        _createElementVNode(\"button\", {\n                            class: \"btn btn-secondary\",\n                            onClick: _cache[1] || (_cache[1] = ($event) => (_ctx.$emit('cancel')))\n                        }, \"\"),\n                        _createElementVNode(\"button\", {\n                            class: \"btn btn-primary\",\n                            disabled: !selectedPath.value,\n                            onClick: confirmLoad\n                        }, \"  \", 8 /* PROPS */, _hoisted_12)\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ModelBrowser.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ModelBrowser.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ModelBrowser.vue?vue&type=style&index=0&id=7ee23a0a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7ee23a0a\"]])\n\nexport default __exports__","import { LOCAL_LIVE2D_MODEL_SLOT_ID, SCRIPT_NAME } from '../core/constants';\nimport { saveLive2DModel, type StoredLive2DModel } from '../db/live2d-models';\nimport { Live2DLoader } from './loader';\nimport {\n  LIVE2D_RUNTIME_TYPES,\n  inferCubismVersionFromModelJson,\n  resolveRuntimeTypeFromCubismVersion,\n} from './runtime-router';\n\ntype JSZipLike = {\n  file(path: string): any;\n  forEach(callback: (path: string, file: any) => void): void;\n};\n\ntype ModelJsonEntry = {\n  path: string;\n  file: any;\n  priority: number;\n};\n\nexport const Live2DUploader = {\n  JSZip: null as any,\n\n  async _loadJSZip(): Promise<any> {\n    if (this.JSZip) return this.JSZip;\n\n    const topWindow = window.parent ?? window;\n    if ((topWindow as any).JSZip) {\n      this.JSZip = (topWindow as any).JSZip;\n      return this.JSZip;\n    }\n\n    return new Promise((resolve, reject) => {\n      const script = topWindow.document.createElement('script');\n      script.src = 'https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js';\n      script.async = true;\n      script.onload = () => {\n        this.JSZip = (topWindow as any).JSZip;\n        if (!this.JSZip) {\n          reject(new Error('JSZip '));\n          return;\n        }\n        try {\n          console.log(`[${SCRIPT_NAME}] JSZip `);\n        } catch {\n          // ignore\n        }\n        resolve(this.JSZip);\n      };\n      script.onerror = () => reject(new Error('JSZip '));\n      topWindow.document.head.appendChild(script);\n    });\n  },\n\n  async uploadZip(file: File): Promise<StoredLive2DModel> {\n    const JSZip = await this._loadJSZip();\n    const zip = (await JSZip.loadAsync(file)) as JSZipLike;\n\n    try {\n      console.log(\n        `[${SCRIPT_NAME}] Live2DUploader:  ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)`,\n      );\n    } catch {\n      // ignore\n    }\n\n    const modelJsonEntry = await this._findModelJson(zip);\n    if (!modelJsonEntry) {\n      throw new Error(' Live2D model3.json / model.json / *.model.json / model*.json');\n    }\n\n    const modelDir = modelJsonEntry.path.substring(0, modelJsonEntry.path.lastIndexOf('/') + 1);\n    const modelJsonText = String(await modelJsonEntry.file.async('text')).replace(/^\\uFEFF/, '');\n    const modelJson = JSON.parse(modelJsonText);\n\n    const entryPathLower = String(modelJsonEntry.path || '').toLowerCase();\n    const isModel3 = entryPathLower.endsWith('model3.json') || !!modelJson?.FileReferences;\n    const isModel2 =\n      !isModel3 &&\n      (typeof modelJson?.model === 'string' ||\n        typeof modelJson?.Model === 'string' ||\n        Array.isArray(modelJson?.textures) ||\n        Array.isArray(modelJson?.expressions) ||\n        typeof modelJson?.motions === 'object');\n\n    try {\n      console.log(\n        `[${SCRIPT_NAME}] Live2DUploader: : ${modelDir || ''}: ${\n          isModel3 ? 'Cubism 3/4/5' : 'Cubism 2.1'\n        }`,\n      );\n    } catch {\n      // ignore\n    }\n\n    let modelData: StoredLive2DModel;\n    if (isModel3) {\n      const moc3Data = await this._extractFile(zip, modelDir, modelJson.FileReferences?.Moc);\n      const moc3HeaderVersion = this._readMoc3HeaderVersion(moc3Data);\n      const detectedCubismVersion = await this._resolveModel3CubismVersion(modelJson, moc3Data);\n      const runtimeType = resolveRuntimeTypeFromCubismVersion(detectedCubismVersion);\n      modelData = {\n        modelId: LOCAL_LIVE2D_MODEL_SLOT_ID,\n        source: 'local',\n        fileName: String(file.name || '').trim() || 'uploaded-live2d.zip',\n        runtimeType,\n        cubismVersion: detectedCubismVersion,\n        moc3Version: moc3HeaderVersion ?? null,\n        modelJson,\n        moc3: moc3Data,\n        moc: null,\n        textures: await this._extractTextures(zip, modelDir, modelJson),\n        motions: await this._extractMotions(zip, modelDir, modelJson),\n        expressions: await this._extractExpressions(zip, modelDir, modelJson),\n        physics: modelJson.FileReferences?.Physics\n          ? await this._extractFileOptional(zip, modelDir, modelJson.FileReferences.Physics)\n          : null,\n        pose: modelJson.FileReferences?.Pose\n          ? await this._extractFileOptional(zip, modelDir, modelJson.FileReferences.Pose)\n          : null,\n        uploadTime: Date.now(),\n        fileSize: file.size,\n      };\n    } else if (isModel2) {\n      const mocPath = modelJson?.model || modelJson?.Model;\n      const physicsPath = modelJson?.physics || modelJson?.Physics;\n      const posePath = modelJson?.pose || modelJson?.Pose;\n      modelData = {\n        modelId: LOCAL_LIVE2D_MODEL_SLOT_ID,\n        source: 'local',\n        fileName: String(file.name || '').trim() || 'uploaded-live2d.zip',\n        runtimeType: LIVE2D_RUNTIME_TYPES.LEGACY,\n        cubismVersion: 2,\n        modelJson,\n        moc3Version: null,\n        moc3: null,\n        moc: await this._extractFile(zip, modelDir, mocPath),\n        textures: await this._extractTexturesV2(zip, modelDir, modelJson),\n        motions: await this._extractMotionsV2(zip, modelDir, modelJson),\n        expressions: await this._extractExpressionsV2(zip, modelDir, modelJson),\n        physics: physicsPath ? await this._extractFileOptional(zip, modelDir, physicsPath) : null,\n        pose: posePath ? await this._extractFileOptional(zip, modelDir, posePath) : null,\n        uploadTime: Date.now(),\n        fileSize: file.size,\n      };\n    } else {\n      throw new Error(' Live2D  zip  model3.json / model.json');\n    }\n\n    await saveLive2DModel(modelData);\n\n    try {\n      console.log(`[${SCRIPT_NAME}] Live2DUploader: `, {\n        modelId: modelData.modelId,\n        runtimeType: modelData.runtimeType,\n        cubismVersion: modelData.cubismVersion,\n      });\n    } catch {\n      // ignore\n    }\n\n    return modelData;\n  },\n\n  _toArrayBuffer(input: unknown): ArrayBuffer | null {\n    if (!input) return null;\n    if (input instanceof ArrayBuffer) return input;\n    if (ArrayBuffer.isView(input)) {\n      return input.buffer.slice(input.byteOffset, input.byteOffset + input.byteLength);\n    }\n    return null;\n  },\n\n  _normalizeMocVersion(rawMocVersion: unknown): number | null {\n    const value = Number(rawMocVersion || 0);\n    if (!Number.isFinite(value)) return null;\n    if (value >= 5) return 5;\n    if (value >= 1 && value <= 4) return 4;\n    return null;\n  },\n\n  _readMoc3HeaderVersion(moc3Data: unknown): number | null {\n    const moc3Buffer = this._toArrayBuffer(moc3Data);\n    if (!moc3Buffer || moc3Buffer.byteLength < 8) return null;\n\n    try {\n      const header = new Uint8Array(moc3Buffer, 0, 4);\n      const signature = String.fromCharCode(...header);\n      if (signature !== 'MOC3') return null;\n      const view = new DataView(moc3Buffer);\n      return Number(view.getUint32(4, true) || 0) || null;\n    } catch {\n      return null;\n    }\n  },\n\n  _detectCubismVersionFromMoc3Buffer(moc3Data: unknown): number | null {\n    const moc3Buffer = this._toArrayBuffer(moc3Data);\n    if (!moc3Buffer) return null;\n\n    const topWindow = window.parent ?? window;\n    const core = (topWindow as any)?.Live2DCubismCore;\n    const Moc = core?.Moc;\n    const Version = core?.Version;\n    if (typeof Moc?.fromArrayBuffer !== 'function' || typeof Version?.csmGetMocVersion !== 'function') {\n      return null;\n    }\n\n    let mocRef: any = null;\n    try {\n      mocRef = Moc.fromArrayBuffer(moc3Buffer);\n      if (!mocRef) return null;\n\n      const rawMocVersion = Number(Version.csmGetMocVersion(mocRef, moc3Buffer) || 0) || 0;\n      const latestMocVersion = Number(Version?.csmGetLatestMocVersion?.() || 0) || 0;\n      const normalized = this._normalizeMocVersion(rawMocVersion);\n      if (latestMocVersion > 0 && rawMocVersion > latestMocVersion) {\n        return null;\n      }\n      return normalized;\n    } catch {\n      return null;\n    } finally {\n      try {\n        if (mocRef && typeof mocRef._release === 'function') {\n          mocRef._release();\n        } else if (mocRef && typeof mocRef.release === 'function') {\n          mocRef.release();\n        }\n      } catch {\n        // ignore\n      }\n    }\n  },\n\n  async _resolveModel3CubismVersion(modelJson: any, moc3Data: ArrayBuffer): Promise<number> {\n    const jsonFallbackVersion = inferCubismVersionFromModelJson(modelJson, 4) || 4;\n    const headerVersionRaw = this._readMoc3HeaderVersion(moc3Data);\n    const headerVersion = this._normalizeMocVersion(headerVersionRaw);\n    if (headerVersion != null) {\n      return headerVersion;\n    }\n\n    try {\n      const requiredLatestVersion = headerVersionRaw && headerVersionRaw >= 5 ? headerVersionRaw : 5;\n      await Live2DLoader.ensureCubism5Core(requiredLatestVersion);\n    } catch {\n      // ignore\n    }\n\n    const mocVersion = this._detectCubismVersionFromMoc3Buffer(moc3Data);\n    return mocVersion ?? headerVersion ?? jsonFallbackVersion;\n  },\n\n  async _findModelJson(zip: JSZipLike): Promise<ModelJsonEntry | null> {\n    const candidates: ModelJsonEntry[] = [];\n    const jsonEntries: Array<{ path: string; file: any }> = [];\n\n    zip.forEach((path, file) => {\n      if (file?.dir) return;\n      if (/(^|\\/)model3\\.json$/i.test(path) || /\\.model3\\.json$/i.test(path)) {\n        candidates.push({ path, file, priority: 1 });\n      } else if (/(^|\\/)model\\.json$/i.test(path) || /\\.model\\.json$/i.test(path)) {\n        candidates.push({ path, file, priority: 2 });\n      } else if (/(^|\\/)model[_-]?\\d+\\.json$/i.test(path)) {\n        candidates.push({ path, file, priority: 3 });\n      }\n\n      if (/\\.json$/i.test(path)) {\n        jsonEntries.push({ path, file });\n      }\n    });\n\n    if (candidates.length > 0) {\n      candidates.sort((a, b) => a.priority - b.priority);\n      return candidates[0];\n    }\n\n    let best: { path: string; file: any } | null = null;\n    let bestScore = 0;\n    for (const entry of jsonEntries) {\n      try {\n        const text = await entry.file.async('text');\n        const json = JSON.parse(text);\n        if (!json || typeof json !== 'object') continue;\n\n        let score = 0;\n        const fileName = String(entry.path).split('/').pop()?.toLowerCase() ?? '';\n        if (fileName.includes('model')) score += 50;\n        if (json.FileReferences && typeof json.FileReferences === 'object') {\n          score += 100;\n          if (typeof json.FileReferences.Moc === 'string') score += 1000;\n          if (Array.isArray(json.FileReferences.Textures)) score += 200;\n        }\n        if (typeof json.model === 'string' || typeof json.Model === 'string') score += 900;\n        if (Array.isArray(json.textures) || Array.isArray(json.Textures)) score += 200;\n\n        if (score > bestScore) {\n          best = entry;\n          bestScore = score;\n        }\n      } catch {\n        // ignore\n      }\n    }\n\n    if (!best) return null;\n    return { path: best.path, file: best.file, priority: 99 };\n  },\n\n  async _extractFile(zip: JSZipLike, baseDir: string, relativePath: string): Promise<ArrayBuffer> {\n    const target = String(relativePath || '').trim();\n    if (!target) {\n      throw new Error('');\n    }\n\n    const fullPath = `${baseDir}${target}`;\n    let file = zip.file(fullPath);\n    if (!file) {\n      file = zip.file(target);\n    }\n    if (!file) {\n      const normalizedPath = target.replace(/\\\\/g, '/');\n      file = zip.file(`${baseDir}${normalizedPath}`) || zip.file(normalizedPath);\n    }\n    if (!file) {\n      throw new Error(`: ${fullPath}`);\n    }\n\n    return await file.async('arraybuffer');\n  },\n\n  async _extractFileOptional(zip: JSZipLike, baseDir: string, relativePath: string): Promise<ArrayBuffer | null> {\n    try {\n      return await this._extractFile(zip, baseDir, relativePath);\n    } catch {\n      return null;\n    }\n  },\n\n  async _extractTextures(zip: JSZipLike, baseDir: string, modelJson: any): Promise<StoredLive2DModel['textures']> {\n    const textures: StoredLive2DModel['textures'] = [];\n    const textureList = Array.isArray(modelJson?.FileReferences?.Textures) ? modelJson.FileReferences.Textures : [];\n\n    for (const texPathRaw of textureList) {\n      const texPath = String(texPathRaw || '').trim();\n      if (!texPath) continue;\n      try {\n        const data = await this._extractFile(zip, baseDir, texPath);\n        const lower = texPath.toLowerCase();\n        const mimeType = lower.endsWith('.png') ? 'image/png' : lower.endsWith('.webp') ? 'image/webp' : 'image/jpeg';\n        textures.push({\n          name: texPath,\n          data: new Blob([data], { type: mimeType }),\n        });\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${texPath}`, e);\n      }\n    }\n\n    return textures;\n  },\n\n  async _extractTexturesV2(zip: JSZipLike, baseDir: string, modelJson: any): Promise<StoredLive2DModel['textures']> {\n    const textures: StoredLive2DModel['textures'] = [];\n    const textureList = modelJson?.textures || modelJson?.Textures || [];\n    if (!Array.isArray(textureList)) return textures;\n\n    for (const texPathRaw of textureList) {\n      const texPath = String(texPathRaw || '').trim();\n      if (!texPath) continue;\n      try {\n        const data = await this._extractFile(zip, baseDir, texPath);\n        const lower = texPath.toLowerCase();\n        const mimeType = lower.endsWith('.png') ? 'image/png' : lower.endsWith('.webp') ? 'image/webp' : 'image/jpeg';\n        textures.push({\n          name: texPath,\n          data: new Blob([data], { type: mimeType }),\n        });\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${texPath}`, e);\n      }\n    }\n\n    return textures;\n  },\n\n  async _extractMotions(zip: JSZipLike, baseDir: string, modelJson: any): Promise<StoredLive2DModel['motions']> {\n    const motions: StoredLive2DModel['motions'] = {};\n    const motionGroups = modelJson?.FileReferences?.Motions || {};\n\n    for (const [groupName, motionList] of Object.entries(motionGroups)) {\n      motions[groupName] = [];\n      if (!Array.isArray(motionList)) continue;\n      for (const motionDef of motionList) {\n        const filePath = typeof motionDef === 'string' ? motionDef : (motionDef as any)?.File;\n        if (!filePath) continue;\n        try {\n          const data = await this._extractFile(zip, baseDir, filePath);\n          motions[groupName].push({ name: filePath, data });\n        } catch (e) {\n          console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${filePath}`, e);\n        }\n      }\n    }\n\n    const extractedCount = Object.values(motions).reduce(\n      (sum, list) => sum + (Array.isArray(list) ? list.length : 0),\n      0,\n    );\n\n    if (extractedCount === 0) {\n      const collectScannedMotions = (scanAllZip = false): string[] => {\n        const scanned: string[] = [];\n        zip.forEach((path, file) => {\n          if (file?.dir) return;\n          if (!scanAllZip && !path.startsWith(baseDir)) return;\n          if (!/\\.motion3\\.json$/i.test(path)) return;\n          scanned.push(path.startsWith(baseDir) ? path.substring(baseDir.length) : path);\n        });\n        return scanned;\n      };\n\n      let scannedMotions = collectScannedMotions(false);\n      if (scannedMotions.length === 0) {\n        scannedMotions = collectScannedMotions(true);\n      }\n\n      if (scannedMotions.length > 0) {\n        scannedMotions.sort((a, b) => a.localeCompare(b, 'zh-CN'));\n        motions.default = [];\n        for (const filePath of scannedMotions) {\n          try {\n            const data = await this._extractFile(zip, baseDir, filePath);\n            motions.default.push({ name: filePath, data });\n          } catch (e) {\n            console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${filePath}`, e);\n          }\n        }\n      }\n    }\n\n    return motions;\n  },\n\n  async _extractMotionsV2(zip: JSZipLike, baseDir: string, modelJson: any): Promise<StoredLive2DModel['motions']> {\n    const motions: StoredLive2DModel['motions'] = {};\n    const motionGroups = modelJson?.motions || modelJson?.Motions || {};\n\n    for (const [groupName, motionList] of Object.entries(motionGroups || {})) {\n      motions[groupName] = [];\n      if (!Array.isArray(motionList)) continue;\n      for (const motionDef of motionList) {\n        const filePath =\n          typeof motionDef === 'string' ? motionDef : (motionDef as any)?.file || (motionDef as any)?.File;\n        if (!filePath) continue;\n        try {\n          const data = await this._extractFile(zip, baseDir, filePath);\n          motions[groupName].push({ name: filePath, data });\n        } catch (e) {\n          console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${filePath}`, e);\n        }\n      }\n    }\n\n    const extractedCount = Object.values(motions).reduce(\n      (sum, list) => sum + (Array.isArray(list) ? list.length : 0),\n      0,\n    );\n    if (extractedCount === 0) {\n      const scannedMotions: string[] = [];\n      zip.forEach((path, file) => {\n        if (file?.dir) return;\n        if (path.startsWith(baseDir) && /\\.mtn$/i.test(path)) {\n          scannedMotions.push(path.substring(baseDir.length));\n        }\n      });\n\n      if (scannedMotions.length > 0) {\n        motions.default = [];\n        for (const filePath of scannedMotions) {\n          try {\n            const data = await this._extractFile(zip, baseDir, filePath);\n            motions.default.push({ name: filePath, data });\n          } catch (e) {\n            console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${filePath}`, e);\n          }\n        }\n      }\n    }\n\n    return motions;\n  },\n\n  async _extractExpressions(\n    zip: JSZipLike,\n    baseDir: string,\n    modelJson: any,\n  ): Promise<StoredLive2DModel['expressions']> {\n    const expressions: StoredLive2DModel['expressions'] = [];\n    const exprList = modelJson?.FileReferences?.Expressions || [];\n\n    for (const exprDef of exprList) {\n      const filePath = typeof exprDef === 'string' ? exprDef : exprDef?.File;\n      const name = typeof exprDef === 'object' ? exprDef?.Name : filePath;\n      if (!filePath) continue;\n      try {\n        const data = await this._extractFile(zip, baseDir, filePath);\n        expressions.push({ name: String(name || filePath), file: String(filePath), data });\n      } catch (e) {\n        console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${filePath}`, e);\n      }\n    }\n\n    if (expressions.length === 0) {\n      const scannedExprs: string[] = [];\n      zip.forEach((path, file) => {\n        if (file?.dir) return;\n        if (path.startsWith(baseDir) && /\\.exp3\\.json$/i.test(path)) {\n          scannedExprs.push(path.substring(baseDir.length));\n        }\n      });\n\n      for (const filePath of scannedExprs) {\n        try {\n          const data = await this._extractFile(zip, baseDir, filePath);\n          const name = filePath.replace(/\\.exp3\\.json$/i, '').split('/').pop() || filePath;\n          expressions.push({ name, file: filePath, data });\n        } catch (e) {\n          console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${filePath}`, e);\n        }\n      }\n    }\n\n    return expressions;\n  },\n\n  async _extractExpressionsV2(\n    zip: JSZipLike,\n    baseDir: string,\n    modelJson: any,\n  ): Promise<StoredLive2DModel['expressions']> {\n    const expressions: StoredLive2DModel['expressions'] = [];\n    const exprList = modelJson?.expressions || modelJson?.Expressions || [];\n\n    if (Array.isArray(exprList)) {\n      for (const exprDef of exprList) {\n        const filePath = typeof exprDef === 'string' ? exprDef : exprDef?.file || exprDef?.File;\n        const name = typeof exprDef === 'string' ? exprDef : exprDef?.name || exprDef?.Name || filePath;\n        if (!filePath) continue;\n        try {\n          const data = await this._extractFile(zip, baseDir, filePath);\n          expressions.push({ name: String(name || filePath), file: String(filePath), data });\n        } catch (e) {\n          console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${filePath}`, e);\n        }\n      }\n    }\n\n    if (expressions.length === 0) {\n      const scannedExprs: string[] = [];\n      zip.forEach((path, file) => {\n        if (file?.dir) return;\n        if (path.startsWith(baseDir) && /\\.exp\\.json$/i.test(path)) {\n          scannedExprs.push(path.substring(baseDir.length));\n        }\n      });\n\n      for (const filePath of scannedExprs) {\n        try {\n          const data = await this._extractFile(zip, baseDir, filePath);\n          const name = filePath.replace(/\\.exp\\.json$/i, '').split('/').pop() || filePath;\n          expressions.push({ name, file: filePath, data });\n        } catch (e) {\n          console.warn(`[${SCRIPT_NAME}] Live2DUploader: : ${filePath}`, e);\n        }\n      }\n    }\n\n    return expressions;\n  },\n};\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, unref as _unref, vModelSelect as _vModelSelect, withDirectives as _withDirectives, vModelText as _vModelText, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, createTextVNode as _createTextVNode, vShow as _vShow, withKeys as _withKeys, withModifiers as _withModifiers, createVNode as _createVNode, createStaticVNode as _createStaticVNode } from \"vue\";\nconst _hoisted_1 = { class: \"panel-main\" };\nconst _hoisted_2 = { class: \"panel-nav\" };\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"nav-index\" };\nconst _hoisted_5 = { class: \"nav-label\" };\nconst _hoisted_6 = { class: \"nav-sub\" };\nconst _hoisted_7 = { class: \"panel-body\" };\nconst _hoisted_8 = { class: \"setting-section\" };\nconst _hoisted_9 = { class: \"form-group\" };\nconst _hoisted_10 = { class: \"form-group\" };\nconst _hoisted_11 = [\"value\"];\nconst _hoisted_12 = { class: \"form-group\" };\nconst _hoisted_13 = { class: \"form-group\" };\nconst _hoisted_14 = { class: \"form-group\" };\nconst _hoisted_15 = { class: \"input-with-btn\" };\nconst _hoisted_16 = [\"value\"];\nconst _hoisted_17 = [\"disabled\"];\nconst _hoisted_18 = {\n    key: 0,\n    class: \"hint hint-error\"\n};\nconst _hoisted_19 = { class: \"form-group\" };\nconst _hoisted_20 = [\"disabled\"];\nconst _hoisted_21 = {\n    key: 0,\n    class: \"status-badge status-success\"\n};\nconst _hoisted_22 = {\n    key: 1,\n    class: \"status-badge status-fail\"\n};\nconst _hoisted_23 = { class: \"form-group\" };\nconst _hoisted_24 = { class: \"form-group\" };\nconst _hoisted_25 = { class: \"form-row\" };\nconst _hoisted_26 = { class: \"form-group half\" };\nconst _hoisted_27 = { class: \"form-group half\" };\nconst _hoisted_28 = { class: \"toggle-icon\" };\nconst _hoisted_29 = {\n    key: 0,\n    class: \"advanced-params\"\n};\nconst _hoisted_30 = { class: \"form-row\" };\nconst _hoisted_31 = { class: \"form-group half\" };\nconst _hoisted_32 = { class: \"form-group half\" };\nconst _hoisted_33 = { class: \"form-row\" };\nconst _hoisted_34 = { class: \"form-group half\" };\nconst _hoisted_35 = { class: \"form-group half\" };\nconst _hoisted_36 = { class: \"setting-section\" };\nconst _hoisted_37 = { class: \"form-group\" };\nconst _hoisted_38 = { class: \"input-with-btn\" };\nconst _hoisted_39 = [\"disabled\"];\nconst _hoisted_40 = { class: \"form-group\" };\nconst _hoisted_41 = { class: \"model-list\" };\nconst _hoisted_42 = [\"onClick\"];\nconst _hoisted_43 = { class: \"form-group\" };\nconst _hoisted_44 = { class: \"model-list\" };\nconst _hoisted_45 = [\"disabled\"];\nconst _hoisted_46 = [\"disabled\"];\nconst _hoisted_47 = [\"disabled\"];\nconst _hoisted_48 = { class: \"hint\" };\nconst _hoisted_49 = {\n    key: 0,\n    class: \"hint\"\n};\nconst _hoisted_50 = {\n    key: 1,\n    class: \"hint hint-error\"\n};\nconst _hoisted_51 = {\n    key: 2,\n    class: \"local-model-info\"\n};\nconst _hoisted_52 = {\n    key: 3,\n    class: \"hint\"\n};\nconst _hoisted_53 = { class: \"form-group\" };\nconst _hoisted_54 = { class: \"form-group\" };\nconst _hoisted_55 = { class: \"form-group\" };\nconst _hoisted_56 = { class: \"form-group\" };\nconst _hoisted_57 = { class: \"setting-section\" };\nconst _hoisted_58 = { class: \"form-group\" };\nconst _hoisted_59 = [\"value\"];\nconst _hoisted_60 = {\n    key: 0,\n    class: \"form-group\"\n};\nconst _hoisted_61 = { class: \"form-group\" };\nconst _hoisted_62 = { class: \"form-group\" };\nconst _hoisted_63 = [\"disabled\"];\nconst _hoisted_64 = { class: \"form-group\" };\nconst _hoisted_65 = [\"disabled\"];\nconst _hoisted_66 = { class: \"form-group\" };\nconst _hoisted_67 = { class: \"form-group\" };\nconst _hoisted_68 = [\"value\"];\nconst _hoisted_69 = { class: \"form-row\" };\nconst _hoisted_70 = { class: \"form-group half\" };\nconst _hoisted_71 = { class: \"form-group half\" };\nconst _hoisted_72 = { class: \"form-group\" };\nconst _hoisted_73 = { class: \"form-group\" };\nconst _hoisted_74 = { class: \"form-group\" };\nconst _hoisted_75 = { class: \"form-group\" };\nconst _hoisted_76 = { class: \"form-group\" };\nconst _hoisted_77 = { class: \"form-group\" };\nconst _hoisted_78 = {\n    key: 2,\n    class: \"form-group\"\n};\nconst _hoisted_79 = { class: \"form-row\" };\nconst _hoisted_80 = { class: \"form-group half\" };\nconst _hoisted_81 = [\"disabled\"];\nconst _hoisted_82 = { class: \"form-group\" };\nconst _hoisted_83 = { class: \"hint\" };\nconst _hoisted_84 = {\n    key: 0,\n    class: \"dice-sheet-list\"\n};\nconst _hoisted_85 = [\"checked\", \"onChange\"];\nconst _hoisted_86 = {\n    key: 1,\n    class: \"hint\"\n};\nconst _hoisted_87 = { class: \"setting-section\" };\nconst _hoisted_88 = { class: \"emotion-layout\" };\nconst _hoisted_89 = { class: \"emotion-configs\" };\nconst _hoisted_90 = { class: \"form-group\" };\nconst _hoisted_91 = { class: \"hint\" };\nconst _hoisted_92 = {\n    key: 0,\n    class: \"form-group\"\n};\nconst _hoisted_93 = { class: \"form-row\" };\nconst _hoisted_94 = { class: \"form-group half\" };\nconst _hoisted_95 = [\"disabled\"];\nconst _hoisted_96 = { class: \"form-row\" };\nconst _hoisted_97 = { class: \"form-group half\" };\nconst _hoisted_98 = { class: \"form-group half\" };\nconst _hoisted_99 = { class: \"form-group\" };\nconst _hoisted_100 = { class: \"hint\" };\nconst _hoisted_101 = { class: \"form-group\" };\nconst _hoisted_102 = { class: \"toggle-icon\" };\nconst _hoisted_103 = { class: \"emotion-map-table\" };\nconst _hoisted_104 = { class: \"emotion-map-tag\" };\nconst _hoisted_105 = [\"onUpdate:modelValue\"];\nconst _hoisted_106 = [\"value\"];\nconst _hoisted_107 = [\"value\"];\nconst _hoisted_108 = [\"value\", \"disabled\", \"onChange\"];\nconst _hoisted_109 = [\"value\"];\nconst _hoisted_110 = [\"value\"];\nconst _hoisted_111 = [\"onClick\"];\nconst _hoisted_112 = {\n    key: 1,\n    class: \"emotion-advanced-list\"\n};\nconst _hoisted_113 = { class: \"emotion-advanced-title\" };\nconst _hoisted_114 = { class: \"form-row\" };\nconst _hoisted_115 = { class: \"form-group half\" };\nconst _hoisted_116 = [\"value\", \"onBlur\"];\nconst _hoisted_117 = { class: \"form-group half\" };\nconst _hoisted_118 = [\"onUpdate:modelValue\"];\nconst _hoisted_119 = { class: \"form-group\" };\nconst _hoisted_120 = [\"onUpdate:modelValue\"];\nconst _hoisted_121 = { class: \"emotion-preview-panel\" };\nconst _hoisted_122 = { class: \"emotion-preview-header\" };\nconst _hoisted_123 = { class: \"emotion-preview-tag\" };\nconst _hoisted_124 = {\n    key: 0,\n    class: \"emotion-preview-empty\"\n};\nconst _hoisted_125 = { class: \"emotion-preview-controls\" };\nconst _hoisted_126 = { class: \"emotion-zoom-row\" };\nconst _hoisted_127 = { class: \"zoom-value\" };\nconst _hoisted_128 = [\"title\"];\nconst _hoisted_129 = { class: \"setting-section\" };\nconst _hoisted_130 = { class: \"form-group\" };\nconst _hoisted_131 = { class: \"form-group\" };\nconst _hoisted_132 = [\"value\"];\nconst _hoisted_133 = [\"value\"];\nconst _hoisted_134 = [\"value\"];\nconst _hoisted_135 = { class: \"form-group\" };\nconst _hoisted_136 = { class: \"form-group\" };\nconst _hoisted_137 = { class: \"form-group\" };\nconst _hoisted_138 = { class: \"form-group\" };\nconst _hoisted_139 = { class: \"input-with-btn\" };\nconst _hoisted_140 = [\"value\"];\nconst _hoisted_141 = [\"disabled\"];\nconst _hoisted_142 = { class: \"hint\" };\nconst _hoisted_143 = { class: \"toggle-icon\" };\nconst _hoisted_144 = {\n    key: 0,\n    class: \"advanced-params\"\n};\nconst _hoisted_145 = { class: \"form-group\" };\nconst _hoisted_146 = { class: \"form-group\" };\nconst _hoisted_147 = {\n    key: 1,\n    class: \"advanced-params\"\n};\nconst _hoisted_148 = { class: \"form-group\" };\nconst _hoisted_149 = { class: \"form-row\" };\nconst _hoisted_150 = { class: \"form-group half\" };\nconst _hoisted_151 = { class: \"form-group half\" };\nconst _hoisted_152 = { class: \"form-group\" };\nconst _hoisted_153 = { class: \"form-row\" };\nconst _hoisted_154 = { class: \"form-group half\" };\nconst _hoisted_155 = { class: \"form-group half\" };\nconst _hoisted_156 = { class: \"form-row\" };\nconst _hoisted_157 = { class: \"form-group half\" };\nconst _hoisted_158 = { class: \"form-group half\" };\nconst _hoisted_159 = { class: \"form-row\" };\nconst _hoisted_160 = { class: \"form-group half\" };\nconst _hoisted_161 = { class: \"form-group half\" };\nconst _hoisted_162 = {\n    key: 0,\n    class: \"form-group\"\n};\nconst _hoisted_163 = { class: \"form-group\" };\nconst _hoisted_164 = { class: \"form-group\" };\nconst _hoisted_165 = { class: \"local-model-info\" };\nconst _hoisted_166 = { class: \"form-row\" };\nconst _hoisted_167 = { class: \"form-group half\" };\nconst _hoisted_168 = [\"disabled\"];\nconst _hoisted_169 = { class: \"form-row\" };\nconst _hoisted_170 = { class: \"form-group half\" };\nconst _hoisted_171 = [\"disabled\"];\nconst _hoisted_172 = { class: \"form-group half\" };\nconst _hoisted_173 = {\n    key: 2,\n    class: \"form-group\"\n};\nconst _hoisted_174 = [\"disabled\"];\nconst _hoisted_175 = { class: \"setting-section\" };\nconst _hoisted_176 = { class: \"browser-dialog-body gpt-model-body\" };\nconst _hoisted_177 = { class: \"gpt-model-tools\" };\nconst _hoisted_178 = {\n    key: 0,\n    class: \"local-model-info\"\n};\nconst _hoisted_179 = {\n    key: 1,\n    class: \"gpt-model-card-list\"\n};\nconst _hoisted_180 = { class: \"gpt-model-card-head\" };\nconst _hoisted_181 = [\"onUpdate:modelValue\"];\nconst _hoisted_182 = { class: \"gpt-model-id\" };\nconst _hoisted_183 = { class: \"form-row\" };\nconst _hoisted_184 = { class: \"form-group half\" };\nconst _hoisted_185 = [\"onUpdate:modelValue\"];\nconst _hoisted_186 = { class: \"form-group half\" };\nconst _hoisted_187 = [\"onUpdate:modelValue\"];\nconst _hoisted_188 = { class: \"form-row\" };\nconst _hoisted_189 = { class: \"form-group half\" };\nconst _hoisted_190 = [\"onUpdate:modelValue\"];\nconst _hoisted_191 = { class: \"form-group half\" };\nconst _hoisted_192 = [\"onUpdate:modelValue\"];\nconst _hoisted_193 = { class: \"form-row\" };\nconst _hoisted_194 = { class: \"form-group half\" };\nconst _hoisted_195 = [\"onUpdate:modelValue\"];\nconst _hoisted_196 = [\"value\"];\nconst _hoisted_197 = { class: \"form-group half\" };\nconst _hoisted_198 = [\"onUpdate:modelValue\"];\nconst _hoisted_199 = { class: \"hint\" };\nconst _hoisted_200 = { class: \"gpt-model-card-actions\" };\nconst _hoisted_201 = [\"onClick\"];\nconst _hoisted_202 = [\"onClick\"];\nconst _hoisted_203 = [\"onClick\"];\nconst _hoisted_204 = [\"onClick\"];\nconst _hoisted_205 = [\"onClick\"];\nconst _hoisted_206 = { class: \"browser-dialog-header gpt-model-header\" };\nconst _hoisted_207 = { class: \"browser-dialog-body gpt-model-body\" };\nconst _hoisted_208 = { class: \"form-row\" };\nconst _hoisted_209 = { class: \"form-group half\" };\nconst _hoisted_210 = { class: \"form-group half\" };\nconst _hoisted_211 = { class: \"form-row\" };\nconst _hoisted_212 = { class: \"form-group half\" };\nconst _hoisted_213 = { class: \"form-group half\" };\nconst _hoisted_214 = { class: \"form-row\" };\nconst _hoisted_215 = { class: \"form-group half\" };\nconst _hoisted_216 = { class: \"form-group half\" };\nconst _hoisted_217 = { class: \"form-row\" };\nconst _hoisted_218 = { class: \"form-group half\" };\nconst _hoisted_219 = { class: \"form-group half\" };\nconst _hoisted_220 = { class: \"form-row\" };\nconst _hoisted_221 = { class: \"form-group half\" };\nconst _hoisted_222 = { class: \"form-group half\" };\nconst _hoisted_223 = { class: \"form-row\" };\nconst _hoisted_224 = { class: \"form-group half\" };\nconst _hoisted_225 = { class: \"form-group half\" };\nconst _hoisted_226 = { class: \"form-row\" };\nconst _hoisted_227 = { class: \"form-group half\" };\nconst _hoisted_228 = { class: \"form-group half\" };\nconst _hoisted_229 = { class: \"form-row\" };\nconst _hoisted_230 = { class: \"form-group half\" };\nconst _hoisted_231 = { class: \"form-group half\" };\nconst _hoisted_232 = { class: \"form-group\" };\nconst _hoisted_233 = { class: \"gpt-ref-list\" };\nconst _hoisted_234 = { class: \"form-row\" };\nconst _hoisted_235 = { class: \"form-group half\" };\nconst _hoisted_236 = [\"onUpdate:modelValue\"];\nconst _hoisted_237 = { class: \"form-group half\" };\nconst _hoisted_238 = [\"onUpdate:modelValue\"];\nconst _hoisted_239 = { class: \"form-group\" };\nconst _hoisted_240 = [\"onUpdate:modelValue\"];\nconst _hoisted_241 = { class: \"form-row\" };\nconst _hoisted_242 = { class: \"form-group half\" };\nconst _hoisted_243 = [\"onUpdate:modelValue\"];\nconst _hoisted_244 = { class: \"form-group half\" };\nconst _hoisted_245 = [\"onUpdate:modelValue\"];\nconst _hoisted_246 = { class: \"form-row\" };\nconst _hoisted_247 = { class: \"form-group half\" };\nconst _hoisted_248 = [\"onUpdate:modelValue\"];\nconst _hoisted_249 = { class: \"form-group half gpt-ref-actions\" };\nconst _hoisted_250 = [\"onClick\"];\nconst _hoisted_251 = [\"onClick\"];\nconst _hoisted_252 = { class: \"form-group\" };\nconst _hoisted_253 = { class: \"gpt-expression-map-list\" };\nconst _hoisted_254 = [\"onUpdate:modelValue\"];\nconst _hoisted_255 = [\"onUpdate:modelValue\"];\nconst _hoisted_256 = [\"value\"];\nconst _hoisted_257 = [\"onClick\"];\nconst _hoisted_258 = { class: \"browser-dialog-header\" };\nconst _hoisted_259 = { class: \"browser-dialog-body\" };\nimport { storeToRefs } from 'pinia';\nimport { computed, nextTick, onBeforeUnmount, ref, watch } from 'vue';\nimport { TTSManager } from '../audio/tts-manager';\nimport { inferGptSoVitsModelsFromFolderFiles, inferGptSoVitsVoicesFromFolderFiles, isAbsoluteFileSystemPath, TTS_PROVIDER, getGptSoVitsVoiceList, getTTSEnabled, getTTSVoiceListAsync, normalizeGptSoVitsModelsForStore, normalizeGptSoVitsSwitchMode, normalizeGptSoVitsVoicesForStore, pickFirstUsableGptSoVitsVoice, setTTSEnabled, } from '../audio/tts-config';\nimport { API_SOURCES, COMMENT_STYLES, COMMENT_TRIGGER_MODE_OPTIONS, DEFAULTS, EMOTION_TAGS, EMPTY_MOTION_GROUP_VALUE, LOCAL_LIVE2D_MODEL_PATH, LOCAL_LIVE2D_MODEL_SLOT_ID, RECOMMENDED_MODELS, SCRIPT_NAME, } from '../core/constants';\nimport { createDefaultEmotionConfigs, parseAliasesText } from '../core/emotion';\nimport { useSettingsStore } from '../core/settings';\nimport { deleteLive2DModel, getLive2DModel, hasLive2DModel } from '../db/live2d-models';\nimport { matchLive2DExpression, matchLive2DMotion } from '../live2d/expression-motion';\nimport { Live2DManager } from '../live2d/manager';\nimport { Live2DStage } from '../live2d/stage';\nimport { Live2DUploader } from '../live2d/uploader';\nimport ModelBrowser from './ModelBrowser.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SettingsPanel',\n    props: {\n        visible: { type: Boolean }\n    },\n    emits: [\"close\", \"model-change\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const sectionTabs = [\n            { key: 'api', index: '01', label: 'API ', en: 'API CONTROL' },\n            { key: 'live2d', index: '02', label: 'Live2D', en: 'MODEL CONTROL' },\n            { key: 'comment', index: '03', label: '', en: 'COMMENT SYSTEM' },\n            { key: 'expression', index: '04', label: '', en: 'EMOTION COT' },\n            { key: 'tts', index: '05', label: 'TTS', en: 'VOICE CONTROL' },\n            { key: 'about', index: '06', label: '', en: 'ABOUT & LICENSE' },\n        ];\n        const activeSection = ref('api');\n        const store = useSettingsStore();\n        const { settings } = storeToRefs(store);\n        function toBoundedNumber(value, fallback, min, max) {\n            const parsed = typeof value === 'number' ? value : Number(value);\n            if (!Number.isFinite(parsed))\n                return fallback;\n            return clamp(parsed, min, max);\n        }\n        function ensureNumericSettingsIntegrity() {\n            if (!settings.value.apiConfig || typeof settings.value.apiConfig !== 'object') {\n                settings.value.apiConfig = {\n                    url: '',\n                    apiKey: '',\n                    model: 'gpt-4o-mini',\n                    source: 'openai',\n                    max_tokens: DEFAULTS.MAX_TOKENS,\n                    temperature: DEFAULTS.TEMPERATURE,\n                    frequency_penalty: DEFAULTS.FREQUENCY_PENALTY,\n                    presence_penalty: DEFAULTS.PRESENCE_PENALTY,\n                    top_p: DEFAULTS.TOP_P,\n                    top_k: DEFAULTS.TOP_K,\n                    usePresetSampling: false,\n                    sendWorldInfo: false,\n                };\n            }\n            const api = settings.value.apiConfig;\n            api.max_tokens = Math.round(toBoundedNumber(api.max_tokens, DEFAULTS.MAX_TOKENS, 1, 4096));\n            api.temperature = toBoundedNumber(api.temperature, DEFAULTS.TEMPERATURE, 0, 2);\n            api.frequency_penalty = toBoundedNumber(api.frequency_penalty, DEFAULTS.FREQUENCY_PENALTY, -2, 2);\n            api.presence_penalty = toBoundedNumber(api.presence_penalty, DEFAULTS.PRESENCE_PENALTY, -2, 2);\n            api.top_p = toBoundedNumber(api.top_p, DEFAULTS.TOP_P, 0, 1);\n            api.top_k = Math.round(toBoundedNumber(api.top_k, DEFAULTS.TOP_K, 0, 500));\n            if (typeof api.url !== 'string')\n                api.url = String(api.url ?? '');\n            if (typeof api.apiKey !== 'string')\n                api.apiKey = String(api.apiKey ?? '');\n            if (typeof api.model !== 'string')\n                api.model = String(api.model ?? 'gpt-4o-mini');\n            if (typeof api.source !== 'string')\n                api.source = String(api.source ?? 'openai');\n            api.usePresetSampling = api.usePresetSampling === true;\n            api.sendWorldInfo = api.sendWorldInfo === true;\n            settings.value.petScale = toBoundedNumber(settings.value.petScale, DEFAULTS.PET_SCALE, 0.1, 3);\n            const rawBubbleDuration = typeof settings.value.bubbleDuration === 'number'\n                ? settings.value.bubbleDuration\n                : Number(settings.value.bubbleDuration ?? Number.NaN);\n            const bubbleDurationSeconds = Number.isFinite(rawBubbleDuration) && rawBubbleDuration > 600 ? rawBubbleDuration / 1000 : rawBubbleDuration;\n            settings.value.bubbleDuration = Math.round(toBoundedNumber(bubbleDurationSeconds, DEFAULTS.BUBBLE_DURATION, -1, 600));\n        }\n        const temperatureLabel = computed(() => toBoundedNumber(settings.value.apiConfig?.temperature, DEFAULTS.TEMPERATURE, 0, 2).toFixed(1));\n        const frequencyPenaltyLabel = computed(() => toBoundedNumber(settings.value.apiConfig?.frequency_penalty, DEFAULTS.FREQUENCY_PENALTY, -2, 2).toFixed(1));\n        const presencePenaltyLabel = computed(() => toBoundedNumber(settings.value.apiConfig?.presence_penalty, DEFAULTS.PRESENCE_PENALTY, -2, 2).toFixed(1));\n        const topPLabel = computed(() => toBoundedNumber(settings.value.apiConfig?.top_p, DEFAULTS.TOP_P, 0, 1).toFixed(2));\n        const petScaleLabel = computed(() => toBoundedNumber(settings.value.petScale, DEFAULTS.PET_SCALE, 0.1, 3).toFixed(2));\n        ensureNumericSettingsIntegrity();\n        const recommendedModels = RECOMMENDED_MODELS;\n        const commentStyles = COMMENT_STYLES;\n        const commentTriggerModeOptions = COMMENT_TRIGGER_MODE_OPTIONS;\n        const apiSources = API_SOURCES;\n        const showBrowser = ref(false);\n        const customModelUrl = ref(settings.value.modelPath || '');\n        const localModelFileInput = ref(null);\n        const uploadingLocalModel = ref(false);\n        const localModelActionBusy = ref(false);\n        const localModelStatus = ref('');\n        const localModelError = ref('');\n        const localModelInfo = ref(null);\n        const localModelBusy = computed(() => uploadingLocalModel.value || localModelActionBusy.value);\n        const localModelExists = computed(() => !!localModelInfo.value);\n        const diceReferenceSheetOptions = ref([]);\n        const refreshingDiceSheetOptions = ref(false);\n        function normalizeDiceReferenceSheetName(value) {\n            return String(value ?? '')\n                .replace(/\\u00a0/g, ' ')\n                .replace(/\\r\\n/g, '\\n')\n                .replace(/\\n+/g, ' ')\n                .replace(/\\s{2,}/g, ' ')\n                .trim();\n        }\n        function dedupeDiceReferenceSheetNames(values) {\n            const seen = new Set();\n            const list = [];\n            for (const value of values) {\n                const name = normalizeDiceReferenceSheetName(value);\n                if (!name)\n                    continue;\n                if (seen.has(name))\n                    continue;\n                seen.add(name);\n                list.push(name);\n            }\n            return list;\n        }\n        function parseDiceReferenceRecord(value) {\n            if (typeof value === 'string') {\n                const text = value.trim();\n                if (!text)\n                    return null;\n                try {\n                    return parseDiceReferenceRecord(JSON.parse(text));\n                }\n                catch {\n                    return null;\n                }\n            }\n            if (!value || typeof value !== 'object' || Array.isArray(value)) {\n                return null;\n            }\n            return value;\n        }\n        function isDiceReferencePayload(record) {\n            return Object.keys(record).some(key => key.startsWith('sheet_'));\n        }\n        function extractDiceReferenceSheetNamesFromPayload(payload) {\n            const record = parseDiceReferenceRecord(payload);\n            if (!record)\n                return [];\n            let tableRecord = record;\n            if (!isDiceReferencePayload(tableRecord)) {\n                const nested = parseDiceReferenceRecord(tableRecord.independentData);\n                if (!nested || !isDiceReferencePayload(nested)) {\n                    return [];\n                }\n                tableRecord = nested;\n            }\n            return dedupeDiceReferenceSheetNames(Object.keys(tableRecord)\n                .filter(key => key.startsWith('sheet_'))\n                .map(key => {\n                const sheet = parseDiceReferenceRecord(tableRecord?.[key]);\n                return sheet?.name ?? '';\n            }));\n        }\n        function pickDiceReferencePayloadFromIsolatedData(value) {\n            const isolated = parseDiceReferenceRecord(value);\n            if (!isolated)\n                return null;\n            const keys = Object.keys(isolated);\n            for (let i = keys.length - 1; i >= 0; i--) {\n                const slot = parseDiceReferenceRecord(isolated[keys[i]]);\n                if (!slot)\n                    continue;\n                const payload = parseDiceReferenceRecord(slot.independentData);\n                if (payload && isDiceReferencePayload(payload)) {\n                    return payload;\n                }\n            }\n            return null;\n        }\n        function pickDiceReferencePayloadFromMessage(message) {\n            if (!message || typeof message !== 'object')\n                return null;\n            const directCandidates = [\n                message.TavernDB_ACU_IndependentData,\n                message.TavernDB_ACU_Data,\n                message.TavernDB_ACU_SummaryData,\n                message.data?.TavernDB_ACU_IndependentData,\n                message.data?.TavernDB_ACU_Data,\n                message.data?.TavernDB_ACU_SummaryData,\n            ];\n            for (const candidate of directCandidates) {\n                const payload = parseDiceReferenceRecord(candidate);\n                if (!payload)\n                    continue;\n                if (isDiceReferencePayload(payload)) {\n                    return payload;\n                }\n                const nested = parseDiceReferenceRecord(payload.independentData);\n                if (nested && isDiceReferencePayload(nested)) {\n                    return nested;\n                }\n            }\n            const isolatedCandidates = [message.TavernDB_ACU_IsolatedData, message.data?.TavernDB_ACU_IsolatedData];\n            for (const candidate of isolatedCandidates) {\n                const payload = pickDiceReferencePayloadFromIsolatedData(candidate);\n                if (payload)\n                    return payload;\n            }\n            return null;\n        }\n        function readDiceReferenceSheetNamesFromApi() {\n            try {\n                const topWindow = window.parent ?? window;\n                const api = topWindow?.AutoCardUpdaterAPI;\n                if (!api || typeof api.exportTableAsJson !== 'function') {\n                    return [];\n                }\n                return extractDiceReferenceSheetNamesFromPayload(api.exportTableAsJson());\n            }\n            catch {\n                return [];\n            }\n        }\n        function readDiceReferenceSheetNamesFromChat() {\n            try {\n                const messages = getChatMessages(`0-{{lastMessageId}}`, {\n                    role: 'all',\n                    hide_state: 'all',\n                });\n                const list = Array.isArray(messages) ? messages : [];\n                for (let i = list.length - 1; i >= 0; i--) {\n                    const payload = pickDiceReferencePayloadFromMessage(list[i]);\n                    if (!payload)\n                        continue;\n                    const names = extractDiceReferenceSheetNamesFromPayload(payload);\n                    if (names.length > 0)\n                        return names;\n                }\n            }\n            catch {\n                // ignore\n            }\n            return [];\n        }\n        function getDiceReferenceSelectedSheets() {\n            const raw = Array.isArray(settings.value.diceReferenceVisibleSheets)\n                ? settings.value.diceReferenceVisibleSheets\n                : [];\n            return dedupeDiceReferenceSheetNames(raw.map(item => String(item ?? '')));\n        }\n        function setDiceReferenceSelectedSheets(next) {\n            settings.value.diceReferenceVisibleSheets = dedupeDiceReferenceSheetNames(next);\n        }\n        function isDiceSheetVisible(sheetName) {\n            const selected = getDiceReferenceSelectedSheets();\n            if (selected.length === 0)\n                return true;\n            return selected.includes(sheetName);\n        }\n        function onToggleDiceSheetVisibility(sheetName, event) {\n            const target = event?.target;\n            const checked = !!target?.checked;\n            const options = diceReferenceSheetOptions.value;\n            const current = getDiceReferenceSelectedSheets();\n            let next = current.length === 0 ? [...options] : [...current];\n            if (checked) {\n                if (!next.includes(sheetName)) {\n                    next.push(sheetName);\n                }\n            }\n            else {\n                next = next.filter(name => name !== sheetName);\n            }\n            // \n            if (options.length > 0 && next.length === options.length) {\n                next = [];\n            }\n            setDiceReferenceSelectedSheets(next);\n        }\n        const diceReferenceSheetSummary = computed(() => {\n            const optionsCount = diceReferenceSheetOptions.value.length;\n            const selected = getDiceReferenceSelectedSheets();\n            if (optionsCount <= 0) {\n                return '';\n            }\n            if (selected.length === 0) {\n                return `${optionsCount}/${optionsCount}`;\n            }\n            return ` ${selected.length}/${optionsCount}`;\n        });\n        function refreshDiceReferenceSheetOptions() {\n            refreshingDiceSheetOptions.value = true;\n            try {\n                const fromApi = readDiceReferenceSheetNamesFromApi();\n                const fromChat = fromApi.length > 0 ? [] : readDiceReferenceSheetNamesFromChat();\n                const selected = getDiceReferenceSelectedSheets();\n                diceReferenceSheetOptions.value = dedupeDiceReferenceSheetNames([\n                    ...fromApi,\n                    ...fromChat,\n                    ...selected,\n                ]);\n            }\n            finally {\n                refreshingDiceSheetOptions.value = false;\n            }\n        }\n        function selectAllDiceReferenceSheets() {\n            // \n            setDiceReferenceSelectedSheets([]);\n        }\n        function clearDiceReferenceSheets() {\n            // \n            setDiceReferenceSelectedSheets([]);\n        }\n        const ttsEnabled = ref(getTTSEnabled());\n        const ttsVoiceList = ref([]);\n        const refreshingTtsVoices = ref(false);\n        const gptSoVitsModelsJson = ref('');\n        const gptSoVitsVoicesJson = ref('');\n        const ttsTestText = ref(' TTS ');\n        const gptModelImportJsonInputRef = ref(null);\n        const gptModelImportFolderInputRef = ref(null);\n        const gptImportJsonInputRef = ref(null);\n        const gptImportFolderInputRef = ref(null);\n        const showGptModelManager = ref(false);\n        const showGptModelEditor = ref(false);\n        const gptModelManagerSearch = ref('');\n        const gptModelManagerModels = ref([]);\n        const gptModelManagerImportJsonInputRef = ref(null);\n        const gptModelManagerImportFolderInputRef = ref(null);\n        const gptModelEditor = ref(null);\n        const gptModelEditorModelId = ref('');\n        const gptModelEditorExpressionRows = ref([]);\n        const isGptSetModelMode = computed(() => normalizeGptSoVitsSwitchMode(settings.value.gptSoVits?.modelSwitchMode) === 'set_model');\n        const ttsVoiceHint = computed(() => {\n            const providerHint = settings.value.ttsProvider === TTS_PROVIDER.GPT_SOVITS_V2\n                ? 'GPT-SoVITS name '\n                : settings.value.ttsProvider === TTS_PROVIDER.EDGE_TTS_DIRECT\n                    ? 'EdgeTTS Edge '\n                    : 'LittleWhiteBox/';\n            const emptyHint = ttsVoiceList.value.length === 0 ? '' : '';\n            return `${providerHint}${emptyHint}`;\n        });\n        const gptModelSummaryHint = computed(() => {\n            const models = Array.isArray(settings.value.gptSoVits?.models) ? settings.value.gptSoVits.models : [];\n            const enabledCount = models.filter((item) => item?.enabled !== false).length;\n            const refCount = models.reduce((sum, item) => {\n                const refs = Array.isArray(item?.refAudios) ? item.refAudios.length : 0;\n                return sum + refs;\n            }, 0);\n            const defaultSpeaker = String(settings.value.ttsDefaultSpeaker || '').trim() || '';\n            return ` ${models.length}  ${enabledCount}  ${refCount} ${defaultSpeaker}`;\n        });\n        const filteredGptModelManagerModels = computed(() => {\n            const list = Array.isArray(gptModelManagerModels.value) ? gptModelManagerModels.value : [];\n            const keyword = String(gptModelManagerSearch.value || '').trim().toLowerCase();\n            if (!keyword)\n                return list;\n            return list.filter(model => {\n                const text = [\n                    String(model?.name || ''),\n                    String(model?.desc || ''),\n                    String(model?.id || ''),\n                    String(model?.paths?.gptWeightsPath || ''),\n                    String(model?.paths?.sovitsWeightsPath || ''),\n                ]\n                    .join(' ')\n                    .toLowerCase();\n                return text.includes(keyword);\n            });\n        });\n        const emotionTags = EMOTION_TAGS;\n        const live2dExpressions = ref([]);\n        const live2dMotionGroups = ref([]);\n        const live2dMotions = ref([]);\n        const refreshingLive2dLists = ref(false);\n        const live2dExpressionOptions = computed(() => {\n            const dedup = new Set();\n            const list = [];\n            for (const item of live2dExpressions.value) {\n                const value = String(item ?? '').trim();\n                if (!value)\n                    continue;\n                if (dedup.has(value))\n                    continue;\n                dedup.add(value);\n                list.push(value);\n            }\n            return list.sort((a, b) => a.localeCompare(b));\n        });\n        const live2dExpressionOptionSet = computed(() => {\n            return new Set(live2dExpressionOptions.value);\n        });\n        function normalizeMotionIndex(value) {\n            const parsed = Number(value);\n            return Number.isFinite(parsed) ? Math.max(0, Math.floor(parsed)) : 0;\n        }\n        function normalizeMotionGroupValue(value) {\n            const raw = String(value ?? '').trim();\n            if (raw === EMPTY_MOTION_GROUP_VALUE)\n                return '';\n            return raw;\n        }\n        function isEmptyMotionGroupMarker(value) {\n            return String(value ?? '').trim() === EMPTY_MOTION_GROUP_VALUE;\n        }\n        function normalizeMotionOverridePayload(payload) {\n            const explicitEmptyGroup = payload.explicitEmptyGroup === true || isEmptyMotionGroupMarker(payload.group);\n            return {\n                group: normalizeMotionGroupValue(payload.group),\n                index: normalizeMotionIndex(payload.index),\n                name: String(payload.name ?? '').trim(),\n                explicitEmptyGroup,\n            };\n        }\n        function encodeMotionOption(payload) {\n            const normalized = normalizeMotionOverridePayload(payload);\n            const hasExplicitEmpty = normalized.explicitEmptyGroup === true && normalized.group === '';\n            if (!normalized.group && normalized.index === 0 && !hasExplicitEmpty)\n                return '';\n            return JSON.stringify({\n                ...normalized,\n                group: normalized.group === '' && hasExplicitEmpty ? EMPTY_MOTION_GROUP_VALUE : normalized.group,\n            });\n        }\n        function decodeMotionOption(raw) {\n            const text = String(raw || '').trim();\n            if (!text)\n                return null;\n            try {\n                const parsed = JSON.parse(text);\n                if (!parsed || typeof parsed !== 'object')\n                    return null;\n                const explicitEmptyGroup = isEmptyMotionGroupMarker(parsed.group);\n                const group = normalizeMotionGroupValue(parsed.group ?? '');\n                const index = normalizeMotionIndex(parsed.index);\n                if (!group && index === 0 && !explicitEmptyGroup)\n                    return null;\n                return {\n                    group,\n                    index,\n                    name: String(parsed.name ?? '').trim(),\n                    explicitEmptyGroup,\n                };\n            }\n            catch {\n                return null;\n            }\n        }\n        function resolveMotionOverridePayload(cfg) {\n            const rawGroup = String(cfg?.live2dMotion?.group ?? '');\n            const explicitEmptyGroup = isEmptyMotionGroupMarker(rawGroup);\n            const overrideGroup = normalizeMotionGroupValue(rawGroup);\n            const overrideIndex = normalizeMotionIndex(cfg?.live2dMotion?.index);\n            const hasExplicitOverride = explicitEmptyGroup || !!overrideGroup || overrideIndex > 0;\n            if (!hasExplicitOverride)\n                return null;\n            const exactByGroupIndex = live2dMotions.value.find((motion) => {\n                const group = normalizeMotionGroupValue(motion?.group);\n                const index = normalizeMotionIndex(motion?.index);\n                return group === overrideGroup && index === overrideIndex;\n            });\n            if (exactByGroupIndex) {\n                return normalizeMotionOverridePayload({\n                    group: exactByGroupIndex.group,\n                    index: exactByGroupIndex.index,\n                    name: exactByGroupIndex.name,\n                });\n            }\n            // group  motion name\n            const lower = overrideGroup.toLowerCase();\n            if (lower) {\n                const byName = live2dMotions.value.find((motion) => {\n                    const name = String(motion?.name ?? '').trim().toLowerCase();\n                    const index = normalizeMotionIndex(motion?.index);\n                    return name === lower && index === overrideIndex;\n                }) ||\n                    live2dMotions.value.find((motion) => String(motion?.name ?? '').trim().toLowerCase() === lower);\n                if (byName) {\n                    return normalizeMotionOverridePayload({\n                        group: byName.group,\n                        index: byName.index,\n                        name: byName.name,\n                    });\n                }\n            }\n            return normalizeMotionOverridePayload({\n                group: overrideGroup,\n                index: overrideIndex,\n                explicitEmptyGroup,\n            });\n        }\n        function getMotionOverrideValue(cfg) {\n            const payload = resolveMotionOverridePayload(cfg);\n            if (!payload)\n                return '';\n            return encodeMotionOption(payload);\n        }\n        function getMotionOverrideLabel(cfg) {\n            const payload = resolveMotionOverridePayload(cfg);\n            if (!payload)\n                return '';\n            if (payload.name) {\n                const groupLabel = payload.group ? `${payload.group}#${payload.index}` : `#${payload.index}`;\n                return `${payload.name} ${groupLabel}`;\n            }\n            return `${payload.group || '()'}#${payload.index}`;\n        }\n        function setMotionOverrideValue(cfg, rawValue) {\n            const parsed = decodeMotionOption(String(rawValue || '').trim());\n            if (!parsed) {\n                cfg.live2dMotion.group = '';\n                cfg.live2dMotion.index = 0;\n                return;\n            }\n            cfg.live2dMotion.group =\n                parsed.group === '' && parsed.explicitEmptyGroup === true ? EMPTY_MOTION_GROUP_VALUE : parsed.group;\n            cfg.live2dMotion.index = parsed.index;\n        }\n        function onMotionOverrideChange(cfg, event) {\n            const target = event?.target;\n            setMotionOverrideValue(cfg, target?.value || '');\n        }\n        const live2dMotionSelectOptions = computed(() => {\n            const seen = new Set();\n            const options = [];\n            for (const motion of live2dMotions.value) {\n                const group = normalizeMotionGroupValue(motion?.group);\n                const index = normalizeMotionIndex(motion?.index);\n                const name = String(motion?.name ?? '').trim();\n                const value = encodeMotionOption({ group, index, name, explicitEmptyGroup: group === '' });\n                if (!value || seen.has(value))\n                    continue;\n                seen.add(value);\n                const groupLabel = `${group || '()'}#${index}`;\n                const safeName = name || '()';\n                options.push({\n                    key: `motion_${groupLabel}_${safeName}`.replace(/\\s+/g, '_'),\n                    value,\n                    label: `${safeName} ${groupLabel}`,\n                });\n            }\n            for (const group of live2dMotionGroups.value) {\n                const groupName = normalizeMotionGroupValue(group?.name);\n                const value = encodeMotionOption({\n                    group: groupName,\n                    index: 0,\n                    explicitEmptyGroup: groupName === '',\n                });\n                if (!value || seen.has(value))\n                    continue;\n                seen.add(value);\n                const groupLabel = groupName || '()';\n                options.push({\n                    key: `group_${groupLabel}_${group.count}`.replace(/\\s+/g, '_'),\n                    value,\n                    label: `${groupLabel} ${group.count}`,\n                });\n            }\n            return options.sort((a, b) => a.label.localeCompare(b.label, 'zh-CN'));\n        });\n        const live2dMotionOptionSet = computed(() => {\n            return new Set(live2dMotionSelectOptions.value.map(option => option.value));\n        });\n        const live2dListSummary = computed(() => {\n            const exprCount = live2dExpressions.value.length;\n            const motionCount = live2dMotions.value.length;\n            const groupCount = live2dMotionGroups.value.length;\n            if (!Live2DManager.model)\n                return ' Live2D ';\n            const exprHint = exprCount === 0 ? ' Expressions' : '';\n            const motionHint = motionCount === 0 ? ' motions' : '';\n            return ` ${exprCount} ${exprHint} ${motionCount} ${motionHint} ${groupCount} `;\n        });\n        const live2dPreviewMountEl = ref(null);\n        const live2dPreviewInteractEl = ref(null);\n        const previewMounted = ref(false);\n        const previewTag = ref('');\n        const previewStatus = ref('');\n        const previewZoomFactor = ref(1.8);\n        let previewPanOffsetX = 0;\n        let previewPanOffsetY = 0;\n        let previewBasePose = { x: 0, y: 0, scale: 1 };\n        let previewIsDragging = false;\n        let previewDragStart = { x: 0, y: 0 };\n        let previewDragOrigin = { x: 0, y: 0 };\n        let previewMountPromise = null;\n        let previewResizeObserver = null;\n        function clamp(value, min, max) {\n            return Math.max(min, Math.min(max, value));\n        }\n        function getPreviewCanvasSize() {\n            const el = live2dPreviewMountEl.value;\n            const rect = el?.getBoundingClientRect?.();\n            const width = Math.max(1, Math.floor(rect?.width || el?.clientWidth || 320));\n            const height = Math.max(1, Math.floor(rect?.height || el?.clientHeight || 260));\n            return { width, height };\n        }\n        function capturePreviewBasePose() {\n            const model = Live2DManager.model;\n            if (!model)\n                return;\n            const baseScale = Number(model.scale?.x);\n            previewBasePose = {\n                x: Number(model.x) || 0,\n                y: Number(model.y) || 0,\n                scale: Number.isFinite(baseScale) && baseScale > 0 ? baseScale : 1,\n            };\n        }\n        function applyPreviewViewport() {\n            if (!previewMounted.value)\n                return;\n            const model = Live2DManager.model;\n            if (!model)\n                return;\n            const { width, height } = getPreviewCanvasSize();\n            const maxOffsetX = Math.max(60, width * 0.45);\n            const maxOffsetY = Math.max(60, height * 0.45);\n            previewPanOffsetX = clamp(previewPanOffsetX, -maxOffsetX, maxOffsetX);\n            previewPanOffsetY = clamp(previewPanOffsetY, -maxOffsetY, maxOffsetY);\n            previewZoomFactor.value = clamp(previewZoomFactor.value, 0.5, 4);\n            const finalScale = previewBasePose.scale * previewZoomFactor.value;\n            if (model.scale?.set) {\n                model.scale.set(finalScale);\n            }\n            model.x = previewBasePose.x + previewPanOffsetX;\n            model.y = previewBasePose.y + previewPanOffsetY;\n            try {\n                const app = Live2DStage.app;\n                if (app?.renderer && app?.stage) {\n                    app.renderer.render(app.stage);\n                }\n            }\n            catch {\n                // ignore\n            }\n        }\n        function resetPreviewViewport() {\n            previewZoomFactor.value = 1.8;\n            previewPanOffsetX = 0;\n            previewPanOffsetY = 0;\n            applyPreviewViewport();\n        }\n        function getPreviewDragPoint(event) {\n            const ev = event?.originalEvent || event;\n            if (ev?.touches?.length)\n                return { x: ev.touches[0].clientX, y: ev.touches[0].clientY };\n            if (ev?.changedTouches?.length)\n                return { x: ev.changedTouches[0].clientX, y: ev.changedTouches[0].clientY };\n            if (Number.isFinite(ev?.clientX) && Number.isFinite(ev?.clientY))\n                return { x: ev.clientX, y: ev.clientY };\n            return null;\n        }\n        function unbindPreviewViewportEvents() {\n            const interactEl = live2dPreviewInteractEl.value;\n            if (!interactEl)\n                return;\n            const top = window.parent ?? window;\n            const doc = top.document;\n            const handlers = interactEl.__dpPreviewHandlers;\n            if (!handlers)\n                return;\n            try {\n                interactEl.removeEventListener('mousedown', handlers.onDown);\n                interactEl.removeEventListener('touchstart', handlers.onDown);\n                interactEl.removeEventListener('wheel', handlers.onWheel);\n                doc.removeEventListener('mousemove', handlers.onMove);\n                doc.removeEventListener('touchmove', handlers.onMove);\n                doc.removeEventListener('mouseup', handlers.onUp);\n                doc.removeEventListener('touchend', handlers.onUp);\n                doc.removeEventListener('touchcancel', handlers.onUp);\n            }\n            catch {\n                // ignore\n            }\n            interactEl.__dpPreviewHandlers = null;\n        }\n        function bindPreviewViewportEvents() {\n            const interactEl = live2dPreviewInteractEl.value;\n            if (!interactEl)\n                return;\n            if (interactEl.__dpPreviewHandlers)\n                return;\n            const top = window.parent ?? window;\n            const doc = top.document;\n            const onDown = (event) => {\n                if (!previewMounted.value)\n                    return;\n                const point = getPreviewDragPoint(event);\n                if (!point)\n                    return;\n                previewIsDragging = true;\n                previewDragStart = point;\n                previewDragOrigin = { x: previewPanOffsetX, y: previewPanOffsetY };\n                interactEl.style.cursor = 'grabbing';\n                if (typeof event.preventDefault === 'function')\n                    event.preventDefault();\n            };\n            const onMove = (event) => {\n                if (!previewIsDragging)\n                    return;\n                const point = getPreviewDragPoint(event);\n                if (!point)\n                    return;\n                previewPanOffsetX = previewDragOrigin.x + (point.x - previewDragStart.x);\n                previewPanOffsetY = previewDragOrigin.y + (point.y - previewDragStart.y);\n                applyPreviewViewport();\n                if (typeof event.preventDefault === 'function')\n                    event.preventDefault();\n            };\n            const onUp = () => {\n                if (!previewIsDragging)\n                    return;\n                previewIsDragging = false;\n                interactEl.style.cursor = 'grab';\n            };\n            const onWheel = (event) => {\n                if (!previewMounted.value)\n                    return;\n                event.preventDefault();\n                const delta = event.deltaY > 0 ? -0.1 : 0.1;\n                previewZoomFactor.value = clamp(previewZoomFactor.value + delta, 0.5, 4);\n                applyPreviewViewport();\n            };\n            interactEl.style.cursor = 'grab';\n            interactEl.addEventListener('mousedown', onDown);\n            interactEl.addEventListener('touchstart', onDown, { passive: false });\n            interactEl.addEventListener('wheel', onWheel, { passive: false });\n            doc.addEventListener('mousemove', onMove);\n            doc.addEventListener('touchmove', onMove, { passive: false });\n            doc.addEventListener('mouseup', onUp);\n            doc.addEventListener('touchend', onUp);\n            doc.addEventListener('touchcancel', onUp);\n            interactEl.__dpPreviewHandlers = { onDown, onMove, onUp, onWheel };\n        }\n        function disconnectPreviewResizeObserver() {\n            try {\n                previewResizeObserver?.disconnect();\n            }\n            catch {\n                // ignore\n            }\n            finally {\n                previewResizeObserver = null;\n            }\n        }\n        function bindPreviewResizeObserver() {\n            const mountEl = live2dPreviewMountEl.value;\n            if (!mountEl)\n                return;\n            disconnectPreviewResizeObserver();\n            if (typeof ResizeObserver === 'undefined')\n                return;\n            try {\n                previewResizeObserver = new ResizeObserver(() => {\n                    if (!previewMounted.value)\n                        return;\n                    const { width, height } = getPreviewCanvasSize();\n                    Live2DStage.resizePreview(width, height);\n                    applyPreviewViewport();\n                });\n                previewResizeObserver.observe(mountEl);\n            }\n            catch {\n                previewResizeObserver = null;\n            }\n        }\n        async function ensurePreviewMounted() {\n            if (previewMounted.value)\n                return true;\n            if (previewMountPromise)\n                return previewMountPromise;\n            previewMountPromise = (async () => {\n                await nextTick();\n                const mountEl = live2dPreviewMountEl.value;\n                if (!mountEl)\n                    return false;\n                if (!Live2DManager.model) {\n                    previewStatus.value = ' Live2D ';\n                    return false;\n                }\n                if (!Live2DStage.container) {\n                    previewStatus.value = 'Live2D ';\n                    return false;\n                }\n                previewStatus.value = '...';\n                const attached = Live2DStage.pushMount(mountEl);\n                if (!attached) {\n                    previewStatus.value = '';\n                    return false;\n                }\n                previewMounted.value = true;\n                bindPreviewViewportEvents();\n                bindPreviewResizeObserver();\n                const { width, height } = getPreviewCanvasSize();\n                Live2DStage.resizePreview(width, height);\n                Live2DManager.mountToStage(width, height, 1);\n                capturePreviewBasePose();\n                resetPreviewViewport();\n                // \n                refreshLive2DLists();\n                previewStatus.value = '/';\n                return true;\n            })().finally(() => {\n                previewMountPromise = null;\n            });\n            return previewMountPromise;\n        }\n        function cleanupPreviewMount() {\n            disconnectPreviewResizeObserver();\n            unbindPreviewViewportEvents();\n            previewIsDragging = false;\n            if (!previewMounted.value)\n                return;\n            previewMounted.value = false;\n            const restored = Live2DStage.popMount();\n            if (restored && Live2DManager.model) {\n                Live2DManager.mountToStage(restored.width, restored.height, 1);\n            }\n            previewStatus.value = '';\n        }\n        function replayPreview() {\n            void previewEmotion(previewTag.value);\n        }\n        watch(() => ({ visible: props.visible, section: activeSection.value }), ({ visible, section }) => {\n            if (visible && section === 'expression') {\n                void (async () => {\n                    const mounted = await ensurePreviewMounted();\n                    if (mounted) {\n                        void previewEmotion(previewTag.value);\n                    }\n                })();\n                return;\n            }\n            cleanupPreviewMount();\n        }, { immediate: true });\n        onBeforeUnmount(() => {\n            cleanupPreviewMount();\n        });\n        const modelList = ref([]);\n        const fetchingModels = ref(false);\n        const modelFetchError = ref('');\n        const testingConnection = ref(false);\n        const connectionStatus = ref('idle');\n        const connectionError = ref('');\n        const showAdvanced = ref(false);\n        const showEmotionAdvanced = ref(false);\n        const showLipSyncAdvanced = ref(false);\n        const lipSyncManualParamsText = ref('');\n        const overlayFallbackStyle = {\n            position: 'fixed',\n            inset: '0',\n            width: '100vw',\n            height: '100vh',\n            minHeight: '100vh',\n            zIndex: '10001',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n        };\n        const panelFallbackStyle = {\n            position: 'relative',\n            display: 'flex',\n            flexDirection: 'column',\n            width: 'min(1080px, calc(100vw - 24px))',\n            maxHeight: 'calc(100vh - 24px)',\n            minHeight: '280px',\n        };\n        function normalizeModelList(list) {\n            if (!Array.isArray(list))\n                return [];\n            const out = [];\n            for (const item of list) {\n                if (typeof item === 'string') {\n                    const trimmed = item.trim();\n                    if (trimmed)\n                        out.push(trimmed);\n                    continue;\n                }\n                if (item && typeof item === 'object') {\n                    const maybeId = item.id;\n                    const maybeModel = item.model;\n                    const maybeName = item.name;\n                    const picked = typeof maybeId === 'string'\n                        ? maybeId\n                        : typeof maybeModel === 'string'\n                            ? maybeModel\n                            : typeof maybeName === 'string'\n                                ? maybeName\n                                : '';\n                    const trimmed = picked.trim();\n                    if (trimmed)\n                        out.push(trimmed);\n                }\n            }\n            return [...new Set(out)];\n        }\n        async function getModelListByHttp(customApi) {\n            const base = String(customApi.apiurl || '')\n                .trim()\n                .replace(/\\/+$/, '');\n            if (!base)\n                throw new Error('API URL ');\n            const headers = { Accept: 'application/json' };\n            if (customApi.key)\n                headers.Authorization = `Bearer ${customApi.key}`;\n            const request = async (path) => fetch(`${base}${path}`, {\n                method: 'GET',\n                headers,\n                cache: 'no-cache',\n            });\n            let response = await request('/v1/models');\n            if (!response.ok && (response.status === 404 || response.status === 405)) {\n                response = await request('/models');\n            }\n            if (!response.ok) {\n                throw new Error(` (HTTP ${response.status})`);\n            }\n            const payload = (await response.json());\n            return normalizeModelList(payload.data ?? payload.models ?? payload);\n        }\n        async function getModelListSafe(customApi) {\n            const helperGetModelList = window?.TavernHelper?.getModelList;\n            if (typeof helperGetModelList === 'function') {\n                try {\n                    const models = await helperGetModelList(customApi);\n                    const normalized = normalizeModelList(models);\n                    if (normalized.length > 0)\n                        return normalized;\n                }\n                catch (e) {\n                    console.warn(`[${SCRIPT_NAME}] TavernHelper.getModelList  HTTP `, e);\n                }\n            }\n            if (typeof getModelList === 'function') {\n                try {\n                    const models = await getModelList(customApi);\n                    const normalized = normalizeModelList(models);\n                    if (normalized.length > 0)\n                        return normalized;\n                }\n                catch (e) {\n                    console.warn(`[${SCRIPT_NAME}] getModelList  HTTP `, e);\n                }\n            }\n            return getModelListByHttp(customApi);\n        }\n        async function fetchModels() {\n            const url = settings.value.apiConfig.url;\n            if (!url)\n                return;\n            fetchingModels.value = true;\n            modelFetchError.value = '';\n            modelList.value = [];\n            try {\n                const models = await getModelListSafe({\n                    apiurl: url,\n                    key: settings.value.apiConfig.apiKey || undefined,\n                });\n                modelList.value = models;\n                if (models.length > 0 && !models.includes(settings.value.apiConfig.model)) {\n                    settings.value.apiConfig.model = models[0];\n                }\n            }\n            catch (e) {\n                modelFetchError.value = `: ${e instanceof Error ? e.message : String(e)}`;\n            }\n            finally {\n                fetchingModels.value = false;\n            }\n        }\n        async function testConnection() {\n            const url = settings.value.apiConfig.url;\n            if (!url)\n                return;\n            testingConnection.value = true;\n            connectionStatus.value = 'idle';\n            connectionError.value = '';\n            try {\n                const models = await getModelListSafe({\n                    apiurl: url,\n                    key: settings.value.apiConfig.apiKey || undefined,\n                });\n                if (models && models.length >= 0) {\n                    connectionStatus.value = 'success';\n                }\n                else {\n                    connectionStatus.value = 'fail';\n                    connectionError.value = '';\n                }\n            }\n            catch (e) {\n                connectionStatus.value = 'fail';\n                connectionError.value = e instanceof Error ? e.message : String(e);\n            }\n            finally {\n                testingConnection.value = false;\n            }\n        }\n        function formatFileSize(fileSize) {\n            const bytes = Number(fileSize || 0);\n            if (!Number.isFinite(bytes) || bytes <= 0)\n                return '0 B';\n            if (bytes < 1024)\n                return `${Math.round(bytes)} B`;\n            if (bytes < 1024 * 1024)\n                return `${(bytes / 1024).toFixed(1)} KB`;\n            return `${(bytes / 1024 / 1024).toFixed(2)} MB`;\n        }\n        function formatLocalUploadTime(timestamp) {\n            const value = Number(timestamp || 0);\n            if (!Number.isFinite(value) || value <= 0)\n                return '';\n            try {\n                return new Date(value).toLocaleString();\n            }\n            catch {\n                return '';\n            }\n        }\n        function runtimeLabel(runtimeType) {\n            const runtime = String(runtimeType || '').trim().toLowerCase();\n            if (runtime === 'cubism5')\n                return 'cubism5';\n            return 'legacy';\n        }\n        async function refreshLocalModelInfo() {\n            try {\n                const model = await getLive2DModel(LOCAL_LIVE2D_MODEL_SLOT_ID);\n                localModelInfo.value = model;\n                if (!model && settings.value.modelPath === LOCAL_LIVE2D_MODEL_PATH) {\n                    localModelStatus.value = ' ZIP ';\n                }\n                else if (model) {\n                    localModelStatus.value = `${model.fileName}`;\n                }\n            }\n            catch (e) {\n                localModelInfo.value = null;\n                localModelError.value = `: ${e instanceof Error ? e.message : String(e)}`;\n            }\n        }\n        function triggerLocalModelUpload() {\n            localModelError.value = '';\n            localModelStatus.value = '';\n            const inputEl = localModelFileInput.value;\n            if (!inputEl)\n                return;\n            inputEl.value = '';\n            inputEl.click();\n        }\n        async function onLocalModelFileChange(event) {\n            const inputEl = event.target;\n            const file = inputEl?.files?.[0];\n            if (!file)\n                return;\n            uploadingLocalModel.value = true;\n            localModelError.value = '';\n            localModelStatus.value = ` ${file.name}...`;\n            try {\n                const storedModel = await Live2DUploader.uploadZip(file);\n                localModelStatus.value = `${storedModel.fileName}`;\n                await refreshLocalModelInfo();\n                settings.value.modelPath = LOCAL_LIVE2D_MODEL_PATH;\n                customModelUrl.value = LOCAL_LIVE2D_MODEL_PATH;\n                emit('model-change', LOCAL_LIVE2D_MODEL_PATH);\n                toastr.success('');\n            }\n            catch (e) {\n                const message = e instanceof Error ? e.message : String(e);\n                localModelError.value = `${message}`;\n                localModelStatus.value = '';\n                toastr.error(`${message}`);\n            }\n            finally {\n                uploadingLocalModel.value = false;\n                if (inputEl)\n                    inputEl.value = '';\n            }\n        }\n        async function useUploadedModel() {\n            localModelActionBusy.value = true;\n            localModelError.value = '';\n            try {\n                const exists = await hasLive2DModel(LOCAL_LIVE2D_MODEL_SLOT_ID);\n                if (!exists) {\n                    localModelStatus.value = ' ZIP';\n                    toastr.warning(' ZIP');\n                    return;\n                }\n                await refreshLocalModelInfo();\n                settings.value.modelPath = LOCAL_LIVE2D_MODEL_PATH;\n                customModelUrl.value = LOCAL_LIVE2D_MODEL_PATH;\n                localModelStatus.value = '';\n                emit('model-change', LOCAL_LIVE2D_MODEL_PATH);\n            }\n            catch (e) {\n                localModelError.value = `: ${e instanceof Error ? e.message : String(e)}`;\n            }\n            finally {\n                localModelActionBusy.value = false;\n            }\n        }\n        async function clearUploadedModel() {\n            localModelActionBusy.value = true;\n            localModelError.value = '';\n            try {\n                await deleteLive2DModel(LOCAL_LIVE2D_MODEL_SLOT_ID);\n                localModelInfo.value = null;\n                localModelStatus.value = '';\n                if (settings.value.modelPath === LOCAL_LIVE2D_MODEL_PATH) {\n                    settings.value.modelPath = DEFAULTS.MODEL_PATH;\n                    customModelUrl.value = DEFAULTS.MODEL_PATH;\n                    emit('model-change', DEFAULTS.MODEL_PATH);\n                }\n                toastr.success('');\n            }\n            catch (e) {\n                localModelError.value = `: ${e instanceof Error ? e.message : String(e)}`;\n            }\n            finally {\n                localModelActionBusy.value = false;\n            }\n        }\n        function selectModel(path) {\n            settings.value.modelPath = path;\n            customModelUrl.value = path;\n            emit('model-change', path);\n        }\n        function onBrowserLoad(url) {\n            settings.value.modelPath = url;\n            customModelUrl.value = url;\n            showBrowser.value = false;\n            emit('model-change', url);\n        }\n        function loadCustomUrl() {\n            let url = customModelUrl.value.trim();\n            if (!url)\n                return;\n            const blobMatch = url.match(/^https?:\\/\\/github\\.com\\/([^/]+\\/[^/]+)\\/blob\\/(.+)$/);\n            if (blobMatch) {\n                url = `https://raw.githubusercontent.com/${blobMatch[1]}/${blobMatch[2]}`;\n                customModelUrl.value = url;\n            }\n            settings.value.modelPath = url;\n            emit('model-change', url);\n        }\n        function resetSettings() {\n            store.resetSettings();\n        }\n        function resetEmotionConfigs() {\n            settings.value.emotionConfigs = createDefaultEmotionConfigs();\n            try {\n                toastr.success('');\n            }\n            catch {\n                // ignore\n            }\n        }\n        function onAliasesBlur(cfg, ev) {\n            const input = ev.target;\n            if (!input)\n                return;\n            cfg.aliases = parseAliasesText(input.value);\n        }\n        function refreshLive2DLists() {\n            refreshingLive2dLists.value = true;\n            try {\n                live2dExpressions.value = Live2DManager.getExpressions();\n                live2dMotions.value = Live2DManager.getMotions()\n                    .map(m => ({ name: m.name, group: m.group, index: m.index }))\n                    .sort((a, b) => a.name.localeCompare(b.name));\n                const groups = Live2DManager.getMotionGroups();\n                live2dMotionGroups.value = Object.entries(groups)\n                    .map(([name, count]) => ({ name, count }))\n                    .sort((a, b) => a.name.localeCompare(b.name));\n                try {\n                    toastr.info('/');\n                }\n                catch {\n                    // ignore\n                }\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] /:`, e);\n                live2dExpressions.value = [];\n                live2dMotions.value = [];\n                live2dMotionGroups.value = [];\n                try {\n                    toastr.error('');\n                }\n                catch {\n                    // ignore\n                }\n            }\n            finally {\n                refreshingLive2dLists.value = false;\n            }\n        }\n        function autoMatchLive2DOverrides(overwrite = false) {\n            const model = Live2DManager.model;\n            if (!model) {\n                try {\n                    toastr.warning('');\n                }\n                catch {\n                    // ignore\n                }\n                return;\n            }\n            let filled = 0;\n            for (const cfg of settings.value.emotionConfigs) {\n                const exprOverride = String(cfg.live2dExpression || '').trim();\n                if (overwrite || !exprOverride) {\n                    const matched = matchLive2DExpression(model, cfg.tag);\n                    if (matched) {\n                        cfg.live2dExpression = matched;\n                        filled += 1;\n                    }\n                }\n                const motionEnabled = cfg.live2dMotion?.enabled !== false;\n                const motionGroupOverride = String(cfg.live2dMotion?.group || '').trim();\n                if (motionEnabled && (overwrite || !motionGroupOverride)) {\n                    const matchedMotion = matchLive2DMotion(model, cfg.tag);\n                    if (matchedMotion) {\n                        cfg.live2dMotion.group = matchedMotion.group;\n                        cfg.live2dMotion.index = matchedMotion.index;\n                        filled += 1;\n                    }\n                }\n            }\n            try {\n                if (overwrite) {\n                    toastr.success(filled > 0 ? ` ${filled} ` : '');\n                }\n                else {\n                    toastr.success(filled > 0 ? ` ${filled} ` : '');\n                }\n            }\n            catch {\n                // ignore\n            }\n        }\n        function clearLive2DOverrides() {\n            let cleared = 0;\n            for (const cfg of settings.value.emotionConfigs) {\n                const hadExpr = !!String(cfg.live2dExpression || '').trim();\n                const hadGroup = !!String(cfg.live2dMotion?.group || '').trim();\n                if (hadExpr) {\n                    cfg.live2dExpression = '';\n                    cleared += 1;\n                }\n                if (hadGroup) {\n                    cfg.live2dMotion.group = '';\n                    cfg.live2dMotion.index = 0;\n                    cleared += 1;\n                }\n            }\n            try {\n                toastr.info(cleared > 0 ? ` ${cleared}  Live2D ` : ' Live2D ');\n            }\n            catch {\n                // ignore\n            }\n        }\n        async function previewEmotion(tag) {\n            previewTag.value = tag;\n            const mounted = await ensurePreviewMounted();\n            if (!mounted)\n                return;\n            const model = Live2DManager.model;\n            if (!model) {\n                previewStatus.value = '';\n                return;\n            }\n            applyPreviewViewport();\n            const cfg = settings.value.emotionConfigs.find(c => c.tag === tag);\n            const expr = matchLive2DExpression(model, tag, cfg?.live2dExpression);\n            if (expr) {\n                Live2DManager.playExpression(expr);\n            }\n            const motion = matchLive2DMotion(model, tag, cfg?.live2dMotion);\n            if (motion) {\n                Live2DManager.playMotion(motion.group, motion.index);\n            }\n            const exprText = expr ? `: ${expr}` : ': ()';\n            const motionText = motion\n                ? motion.name\n                    ? `: ${motion.name} (${motion.group || '()'}#${motion.index})`\n                    : `: ${motion.group || '()'}`\n                : ': ()';\n            previewStatus.value = `${tag} | ${exprText} | ${motionText}`;\n            if (!expr && !motion) {\n                try {\n                    toastr.info('/');\n                }\n                catch {\n                    // ignore\n                }\n            }\n        }\n        function onToggleTtsEnabled() {\n            setTTSEnabled(ttsEnabled.value);\n            if (!ttsEnabled.value) {\n                try {\n                    TTSManager.stop();\n                }\n                catch {\n                    // ignore\n                }\n            }\n        }\n        async function refreshTtsVoices() {\n            refreshingTtsVoices.value = true;\n            try {\n                ttsVoiceList.value = await getTTSVoiceListAsync();\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}]  TTS :`, e);\n                ttsVoiceList.value = [];\n            }\n            finally {\n                refreshingTtsVoices.value = false;\n            }\n        }\n        function normalizePathSepLocal(input) {\n            return String(input || '').replace(/\\\\/g, '/').trim();\n        }\n        function onGptSwitchModeChange() {\n            settings.value.gptSoVits.modelSwitchMode = normalizeGptSoVitsSwitchMode(settings.value.gptSoVits.modelSwitchMode);\n        }\n        function onGptRootDirChange() {\n            const nextRoot = normalizePathSepLocal(settings.value.gptSoVits.rootDir);\n            settings.value.gptSoVits.rootDir = nextRoot;\n            settings.value.gptSoVits.importPathPrefix = nextRoot;\n        }\n        function onGptImportPrefixChange() {\n            const nextPrefix = normalizePathSepLocal(settings.value.gptSoVits.importPathPrefix);\n            settings.value.gptSoVits.importPathPrefix = nextPrefix;\n            settings.value.gptSoVits.rootDir = nextPrefix;\n        }\n        function modelToLegacyVoice(model) {\n            if (!model)\n                return null;\n            const refs = Array.isArray(model.refAudios) ? model.refAudios : [];\n            const defRef = refs.find(item => String(item?.id || '').trim() === String(model.defaultRefId || '').trim()) ||\n                refs.find(item => String(item?.path || '').trim() === String(model?.paths?.defaultRefAudioPath || '').trim()) ||\n                refs[0] ||\n                null;\n            const params = model?.params || {};\n            return {\n                name: String(model.name || '').trim(),\n                desc: String(model.desc || '').trim(),\n                refAudioPath: String(defRef?.path || model?.paths?.defaultRefAudioPath || '').trim(),\n                promptText: String(defRef?.promptText || params.promptText || '').trim(),\n                promptLang: String(defRef?.promptLang || params.promptLang || 'zh').trim() || 'zh',\n                textLang: String(defRef?.textLang || params.textLang || 'auto').trim() || 'auto',\n                gptWeightsPath: String(model?.paths?.gptWeightsPath || '').trim(),\n                sovitsWeightsPath: String(model?.paths?.sovitsWeightsPath || '').trim(),\n                modelSwitchMode: String(params.modelSwitchMode || settings.value.gptSoVits.modelSwitchMode || 'set_weights').trim(),\n                setModelEndpoint: String(params.setModelEndpoint || settings.value.gptSoVits.setModelEndpoint || '/set_model').trim(),\n                strictWeightSwitch: !!(params.strictWeightSwitch ??\n                    settings.value.gptSoVits.strictWeightSwitch),\n            };\n        }\n        function syncLegacyVoicesFromModels(models) {\n            return (Array.isArray(models) ? models : [])\n                .map(modelToLegacyVoice)\n                .filter(Boolean)\n                .filter(voice => String(voice?.name || '').trim());\n        }\n        function setGptSoVitsModelsTextarea(models) {\n            try {\n                gptSoVitsModelsJson.value = JSON.stringify(models || [], null, 2);\n            }\n            catch {\n                gptSoVitsModelsJson.value = '[]';\n            }\n        }\n        function getGptModelsFromTextarea() {\n            const raw = gptSoVitsModelsJson.value || '[]';\n            const parsed = JSON.parse(raw);\n            if (!Array.isArray(parsed)) {\n                throw new Error('models must be array');\n            }\n            return normalizeGptSoVitsModelsForStore(parsed);\n        }\n        function setGptSoVitsVoicesTextarea(voices) {\n            try {\n                gptSoVitsVoicesJson.value = JSON.stringify(voices || [], null, 2);\n            }\n            catch {\n                gptSoVitsVoicesJson.value = '[]';\n            }\n        }\n        function getGptVoicesFromTextarea() {\n            const raw = gptSoVitsVoicesJson.value || '[]';\n            const parsed = JSON.parse(raw);\n            if (!Array.isArray(parsed)) {\n                throw new Error('voices must be array');\n            }\n            return normalizeGptSoVitsVoicesForStore(parsed);\n        }\n        function mergeGptSoVitsVoicesByName(existing, incoming) {\n            const out = Array.isArray(existing) ? existing.slice() : [];\n            const used = new Set(out.map(v => String(v?.name || '').trim()).filter(Boolean));\n            for (const voiceRaw of Array.isArray(incoming) ? incoming : []) {\n                if (!voiceRaw)\n                    continue;\n                const voice = { ...voiceRaw };\n                const base = String(voice.name || '').trim() || '';\n                let name = base;\n                let idx = 2;\n                while (used.has(name)) {\n                    name = `${base}_${idx++}`;\n                }\n                voice.name = name;\n                used.add(name);\n                out.push(voice);\n            }\n            return out;\n        }\n        function mergeGptSoVitsModelsByName(existing, incoming) {\n            const out = Array.isArray(existing) ? existing.slice() : [];\n            const used = new Set(out.map(v => String(v?.name || '').trim()).filter(Boolean));\n            for (const modelRaw of Array.isArray(incoming) ? incoming : []) {\n                if (!modelRaw)\n                    continue;\n                const model = { ...modelRaw };\n                const base = String(model.name || '').trim() || '';\n                let name = base;\n                let idx = 2;\n                while (used.has(name)) {\n                    name = `${base}_${idx++}`;\n                }\n                model.name = name;\n                used.add(name);\n                out.push(model);\n            }\n            return out;\n        }\n        function deepCloneGptModels(models) {\n            try {\n                return JSON.parse(JSON.stringify(Array.isArray(models) ? models : []));\n            }\n            catch {\n                return Array.isArray(models) ? models.slice() : [];\n            }\n        }\n        function createGptSoVitsModelTemplateConfig() {\n            return {\n                id: `model_${Date.now().toString(36)}`,\n                name: '',\n                enabled: true,\n                desc: '',\n                paths: {\n                    gptWeightsPath: '',\n                    sovitsWeightsPath: '',\n                    defaultRefAudioPath: '',\n                },\n                params: {\n                    promptText: '',\n                    promptLang: 'zh',\n                    textLang: 'zh',\n                    textSplitMethod: 'cut5',\n                    speedFactor: 1,\n                    mediaType: 'wav',\n                    streamingMode: false,\n                    modelSwitchMode: normalizeGptSoVitsSwitchMode(settings.value.gptSoVits.modelSwitchMode || 'set_weights'),\n                    setModelEndpoint: String(settings.value.gptSoVits.setModelEndpoint || '/set_model').trim() || '/set_model',\n                    strictWeightSwitch: !!settings.value.gptSoVits.strictWeightSwitch,\n                },\n                refAudios: [],\n                defaultRefId: '',\n                expressionRefMap: {},\n            };\n        }\n        function syncGptModelManagerFromSettings() {\n            const normalized = normalizeGptSoVitsModelsForStore(settings.value.gptSoVits.models || []);\n            gptModelManagerModels.value = deepCloneGptModels(normalized);\n        }\n        function openGptModelManager() {\n            syncGptModelManagerFromSettings();\n            gptModelManagerSearch.value = '';\n            closeGptModelEditor();\n            showGptModelManager.value = true;\n        }\n        function closeGptModelManager() {\n            showGptModelManager.value = false;\n            closeGptModelEditor();\n        }\n        async function applyGptModelManagerModelsToSettings(showSuccessMessage = '') {\n            const normalized = normalizeGptSoVitsModelsForStore(gptModelManagerModels.value || []);\n            const legacyVoices = syncLegacyVoicesFromModels(normalized);\n            gptModelManagerModels.value = deepCloneGptModels(normalized);\n            settings.value.gptSoVits.models = normalized;\n            settings.value.gptSoVits.voices = legacyVoices;\n            setGptSoVitsModelsTextarea(normalized);\n            setGptSoVitsVoicesTextarea(legacyVoices);\n            const firstUsable = pickFirstUsableGptSoVitsVoice(getGptSoVitsVoiceList());\n            if (!settings.value.ttsDefaultSpeaker && firstUsable?.name) {\n                settings.value.ttsDefaultSpeaker = firstUsable.name;\n            }\n            await refreshTtsVoices();\n            if (showSuccessMessage) {\n                toastr.success(showSuccessMessage);\n            }\n        }\n        async function saveGptModelManager() {\n            await applyGptModelManagerModelsToSettings(`GPT-SoVITS ${gptModelManagerModels.value.length} `);\n        }\n        async function saveGptModelManagerAndClose() {\n            await applyGptModelManagerModelsToSettings(`GPT-SoVITS ${gptModelManagerModels.value.length} `);\n            closeGptModelManager();\n        }\n        function addGptModelManagerModel() {\n            const merged = mergeGptSoVitsModelsByName(gptModelManagerModels.value, [createGptSoVitsModelTemplateConfig()]);\n            gptModelManagerModels.value = deepCloneGptModels(normalizeGptSoVitsModelsForStore(merged));\n            toastr.success('');\n        }\n        function getGptModelManagerIndexById(modelId) {\n            const targetId = String(modelId || '').trim();\n            if (!targetId)\n                return -1;\n            return gptModelManagerModels.value.findIndex(item => String(item?.id || '').trim() === targetId);\n        }\n        function removeGptModelManagerModel(modelId) {\n            const index = getGptModelManagerIndexById(modelId);\n            if (index < 0)\n                return;\n            gptModelManagerModels.value.splice(index, 1);\n            if (gptModelEditorModelId.value === modelId) {\n                closeGptModelEditor();\n            }\n        }\n        function duplicateGptModelManagerModel(modelId) {\n            const index = getGptModelManagerIndexById(modelId);\n            if (index < 0)\n                return;\n            const source = gptModelManagerModels.value[index];\n            const cloned = deepCloneGptModels([source])[0] || createGptSoVitsModelTemplateConfig();\n            cloned.id = `${String(source?.id || 'model').trim() || 'model'}_${Date.now().toString(36)}`;\n            const merged = mergeGptSoVitsModelsByName(gptModelManagerModels.value, [cloned]);\n            gptModelManagerModels.value = deepCloneGptModels(normalizeGptSoVitsModelsForStore(merged));\n            toastr.success('');\n        }\n        function setGptModelManagerDefaultSpeaker(model) {\n            const name = String(model?.name || '').trim();\n            if (!name) {\n                toastr.error('');\n                return;\n            }\n            settings.value.ttsDefaultSpeaker = name;\n            toastr.success(`${name}`);\n        }\n        async function testGptModelManagerModel(modelId) {\n            const index = getGptModelManagerIndexById(modelId);\n            if (index < 0)\n                return;\n            const model = gptModelManagerModels.value[index];\n            const name = String(model?.name || '').trim();\n            if (!name) {\n                toastr.error('');\n                return;\n            }\n            settings.value.ttsDefaultSpeaker = name;\n            await applyGptModelManagerModelsToSettings('');\n            await testTts();\n        }\n        function openGptModelManagerImportJson() {\n            gptModelManagerImportJsonInputRef.value?.click();\n        }\n        function openGptModelManagerImportFolder() {\n            gptModelManagerImportFolderInputRef.value?.click();\n        }\n        async function onGptModelManagerImportJsonChange(event) {\n            const input = event.target;\n            const file = input?.files?.[0];\n            if (!file)\n                return;\n            try {\n                const text = await file.text();\n                const parsed = JSON.parse(String(text || '[]'));\n                if (!Array.isArray(parsed)) {\n                    toastr.error('JSON ');\n                    return;\n                }\n                const normalizedIncoming = normalizeGptSoVitsModelsForStore(parsed);\n                const merged = mergeGptSoVitsModelsByName(gptModelManagerModels.value, normalizedIncoming);\n                gptModelManagerModels.value = deepCloneGptModels(normalizeGptSoVitsModelsForStore(merged));\n                toastr.success(`${normalizedIncoming.length} `);\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS  JSON :`, e);\n                toastr.error('JSON ');\n            }\n            finally {\n                if (input)\n                    input.value = '';\n            }\n        }\n        async function onGptModelManagerImportFolderChange(event) {\n            const input = event.target;\n            const fileList = input?.files;\n            if (!fileList || fileList.length === 0)\n                return;\n            try {\n                const prefix = normalizePathSepLocal(settings.value.gptSoVits.importPathPrefix || settings.value.gptSoVits.rootDir || '');\n                const inferred = inferGptSoVitsModelsFromFolderFiles(fileList, prefix);\n                if (!inferred || inferred.length === 0) {\n                    toastr.warning('');\n                    return;\n                }\n                const merged = mergeGptSoVitsModelsByName(gptModelManagerModels.value, inferred);\n                gptModelManagerModels.value = deepCloneGptModels(normalizeGptSoVitsModelsForStore(merged));\n                const hasRelativePath = inferred.some(model => {\n                    const p = String(model?.paths?.defaultRefAudioPath || '').trim();\n                    return p && !isAbsoluteFileSystemPath(p);\n                });\n                let msg = `${inferred.length} `;\n                if (hasRelativePath && !prefix) {\n                    msg += '';\n                }\n                toastr.success(msg);\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS :`, e);\n                toastr.error('');\n            }\n            finally {\n                if (input)\n                    input.value = '';\n            }\n        }\n        function exportGptModelManagerModels() {\n            try {\n                const normalized = normalizeGptSoVitsModelsForStore(gptModelManagerModels.value || []);\n                const blob = new Blob([JSON.stringify(normalized, null, 2)], { type: 'application/json' });\n                const url = URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = 'gpt_sovits_models.json';\n                a.click();\n                setTimeout(() => URL.revokeObjectURL(url), 1000);\n                toastr.success(' gpt_sovits_models.json');\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS :`, e);\n                toastr.error('');\n            }\n        }\n        function normalizeGptModelEditorRefAudio(raw, index) {\n            const id = String(raw?.id || `ref_${index + 1}`).trim() || `ref_${index + 1}`;\n            return {\n                id,\n                name: String(raw?.name || id).trim() || id,\n                path: normalizePathSepLocal(raw?.path || ''),\n                promptText: String(raw?.promptText || '').trim(),\n                promptLang: String(raw?.promptLang || 'zh').trim() || 'zh',\n                textLang: String(raw?.textLang || 'auto').trim() || 'auto',\n            };\n        }\n        function ensureGptModelEditorStructure() {\n            const model = gptModelEditor.value;\n            if (!model)\n                return;\n            model.paths = {\n                gptWeightsPath: normalizePathSepLocal(model?.paths?.gptWeightsPath || ''),\n                sovitsWeightsPath: normalizePathSepLocal(model?.paths?.sovitsWeightsPath || ''),\n                defaultRefAudioPath: normalizePathSepLocal(model?.paths?.defaultRefAudioPath || ''),\n            };\n            model.params = {\n                promptText: String(model?.params?.promptText || '').trim(),\n                promptLang: String(model?.params?.promptLang || 'zh').trim() || 'zh',\n                textLang: String(model?.params?.textLang || 'auto').trim() || 'auto',\n                textSplitMethod: String(model?.params?.textSplitMethod || 'cut5').trim() || 'cut5',\n                speedFactor: Number.isFinite(Number(model?.params?.speedFactor)) ? Number(model?.params?.speedFactor) : 1,\n                mediaType: String(model?.params?.mediaType || 'wav').trim() || 'wav',\n                streamingMode: !!model?.params?.streamingMode,\n                modelSwitchMode: normalizeGptSoVitsSwitchMode(model?.params?.modelSwitchMode || 'set_weights'),\n                setModelEndpoint: String(model?.params?.setModelEndpoint || '/set_model').trim() || '/set_model',\n                strictWeightSwitch: !!model?.params?.strictWeightSwitch,\n            };\n            model.refAudios = (Array.isArray(model.refAudios) ? model.refAudios : []).map((item, index) => normalizeGptModelEditorRefAudio(item, index));\n            if (!model.defaultRefId && model.refAudios.length > 0) {\n                model.defaultRefId = model.refAudios[0].id;\n            }\n            if (model.defaultRefId && !model.refAudios.some(item => item.id === model.defaultRefId)) {\n                model.defaultRefId = model.refAudios[0]?.id || '';\n            }\n            model.expressionRefMap = model.expressionRefMap && typeof model.expressionRefMap === 'object'\n                ? model.expressionRefMap\n                : {};\n        }\n        function syncGptModelEditorExpressionRowsFromModel() {\n            const model = gptModelEditor.value;\n            if (!model) {\n                gptModelEditorExpressionRows.value = [];\n                return;\n            }\n            const rows = [];\n            const map = model.expressionRefMap && typeof model.expressionRefMap === 'object' ? model.expressionRefMap : {};\n            Object.entries(map).forEach(([expression, refId]) => {\n                const exprText = String(expression || '').trim();\n                const targetRefId = String(refId || '').trim();\n                if (!exprText || !targetRefId)\n                    return;\n                rows.push({ expression: exprText, refId: targetRefId });\n            });\n            gptModelEditorExpressionRows.value = rows;\n        }\n        function applyGptModelEditorExpressionRowsToModel() {\n            const model = gptModelEditor.value;\n            if (!model)\n                return;\n            const validRefIds = new Set(model.refAudios.map(item => String(item?.id || '').trim()).filter(Boolean));\n            const nextMap = {};\n            for (const row of gptModelEditorExpressionRows.value) {\n                const expression = String(row?.expression || '').trim();\n                const refId = String(row?.refId || '').trim();\n                if (!expression || !refId)\n                    continue;\n                if (!validRefIds.has(refId))\n                    continue;\n                nextMap[expression] = refId;\n            }\n            model.expressionRefMap = nextMap;\n        }\n        function openGptModelEditor(modelId) {\n            const index = getGptModelManagerIndexById(modelId);\n            if (index < 0)\n                return;\n            const source = gptModelManagerModels.value[index];\n            gptModelEditor.value = deepCloneGptModels([source])[0] || null;\n            gptModelEditorModelId.value = String(source?.id || '').trim();\n            ensureGptModelEditorStructure();\n            syncGptModelEditorExpressionRowsFromModel();\n            showGptModelEditor.value = true;\n        }\n        function closeGptModelEditor() {\n            showGptModelEditor.value = false;\n            gptModelEditor.value = null;\n            gptModelEditorModelId.value = '';\n            gptModelEditorExpressionRows.value = [];\n        }\n        function addGptModelEditorRefAudio() {\n            const model = gptModelEditor.value;\n            if (!model)\n                return;\n            ensureGptModelEditorStructure();\n            const used = new Set(model.refAudios.map(item => String(item.id || '').trim()).filter(Boolean));\n            const base = `ref_${model.refAudios.length + 1}`;\n            let nextId = base;\n            let index = 2;\n            while (used.has(nextId)) {\n                nextId = `${base}_${index++}`;\n            }\n            model.refAudios.push({\n                id: nextId,\n                name: `${model.refAudios.length + 1}`,\n                path: '',\n                promptText: String(model.params.promptText || '').trim(),\n                promptLang: String(model.params.promptLang || 'zh').trim() || 'zh',\n                textLang: String(model.params.textLang || 'auto').trim() || 'auto',\n            });\n            if (!model.defaultRefId) {\n                model.defaultRefId = nextId;\n            }\n        }\n        function removeGptModelEditorRefAudio(refIndex) {\n            const model = gptModelEditor.value;\n            if (!model)\n                return;\n            if (refIndex < 0 || refIndex >= model.refAudios.length)\n                return;\n            const removedId = String(model.refAudios[refIndex]?.id || '').trim();\n            model.refAudios.splice(refIndex, 1);\n            if (removedId && model.defaultRefId === removedId) {\n                model.defaultRefId = model.refAudios[0]?.id || '';\n            }\n            if (removedId) {\n                gptModelEditorExpressionRows.value = gptModelEditorExpressionRows.value.filter(row => row.refId !== removedId);\n            }\n        }\n        function setGptModelEditorDefaultRef(refId) {\n            const model = gptModelEditor.value;\n            if (!model)\n                return;\n            const id = String(refId || '').trim();\n            if (!id)\n                return;\n            model.defaultRefId = id;\n        }\n        function addGptModelEditorExpressionRow() {\n            const model = gptModelEditor.value;\n            if (!model)\n                return;\n            const fallbackRefId = String(model.defaultRefId || model.refAudios[0]?.id || '').trim();\n            gptModelEditorExpressionRows.value.push({\n                expression: '',\n                refId: fallbackRefId,\n            });\n        }\n        function removeGptModelEditorExpressionRow(index) {\n            if (index < 0 || index >= gptModelEditorExpressionRows.value.length)\n                return;\n            gptModelEditorExpressionRows.value.splice(index, 1);\n        }\n        function saveGptModelEditor() {\n            const model = gptModelEditor.value;\n            if (!model)\n                return;\n            if (!String(model.name || '').trim()) {\n                toastr.error('');\n                return;\n            }\n            ensureGptModelEditorStructure();\n            applyGptModelEditorExpressionRowsToModel();\n            const targetIndex = getGptModelManagerIndexById(gptModelEditorModelId.value);\n            if (targetIndex < 0) {\n                toastr.error('');\n                return;\n            }\n            const list = gptModelManagerModels.value.slice();\n            list[targetIndex] = deepCloneGptModels([model])[0] || model;\n            gptModelManagerModels.value = deepCloneGptModels(normalizeGptSoVitsModelsForStore(list));\n            toastr.success('');\n            closeGptModelEditor();\n        }\n        function openGptModelImportJson() {\n            gptModelImportJsonInputRef.value?.click();\n        }\n        function openGptModelImportFolder() {\n            gptModelImportFolderInputRef.value?.click();\n        }\n        function openGptImportJson() {\n            gptImportJsonInputRef.value?.click();\n        }\n        function openGptImportFolder() {\n            gptImportFolderInputRef.value?.click();\n        }\n        async function onGptModelImportJsonChange(event) {\n            const input = event.target;\n            const file = input?.files?.[0];\n            if (!file)\n                return;\n            try {\n                const text = await file.text();\n                const parsed = JSON.parse(String(text || '[]'));\n                if (!Array.isArray(parsed)) {\n                    toastr.error('JSON ');\n                    return;\n                }\n                const normalizedIncoming = normalizeGptSoVitsModelsForStore(parsed);\n                const existingNormalized = normalizeGptSoVitsModelsForStore(settings.value.gptSoVits.models || []);\n                const merged = mergeGptSoVitsModelsByName(existingNormalized, normalizedIncoming);\n                const legacyVoices = syncLegacyVoicesFromModels(merged);\n                settings.value.gptSoVits.models = merged;\n                settings.value.gptSoVits.voices = legacyVoices;\n                setGptSoVitsModelsTextarea(merged);\n                setGptSoVitsVoicesTextarea(legacyVoices);\n                syncGptModelManagerFromSettings();\n                await refreshTtsVoices();\n                toastr.success(`${normalizedIncoming.length} `);\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS  JSON :`, e);\n                toastr.error('JSON ');\n            }\n            finally {\n                if (input)\n                    input.value = '';\n            }\n        }\n        async function onGptModelImportFolderChange(event) {\n            const input = event.target;\n            const fileList = input?.files;\n            if (!fileList || fileList.length === 0)\n                return;\n            try {\n                const prefix = normalizePathSepLocal(settings.value.gptSoVits.importPathPrefix || settings.value.gptSoVits.rootDir || '');\n                const inferred = inferGptSoVitsModelsFromFolderFiles(fileList, prefix);\n                if (!inferred || inferred.length === 0) {\n                    toastr.warning('');\n                    return;\n                }\n                const existingNormalized = normalizeGptSoVitsModelsForStore(settings.value.gptSoVits.models || []);\n                const merged = mergeGptSoVitsModelsByName(existingNormalized, inferred);\n                const legacyVoices = syncLegacyVoicesFromModels(merged);\n                settings.value.gptSoVits.models = merged;\n                settings.value.gptSoVits.voices = legacyVoices;\n                setGptSoVitsModelsTextarea(merged);\n                setGptSoVitsVoicesTextarea(legacyVoices);\n                syncGptModelManagerFromSettings();\n                await refreshTtsVoices();\n                const hasRelativePath = inferred.some(model => {\n                    const p = String(model?.paths?.defaultRefAudioPath || '').trim();\n                    return p && !isAbsoluteFileSystemPath(p);\n                });\n                let msg = `${inferred.length} `;\n                if (hasRelativePath && !prefix) {\n                    msg += '';\n                }\n                toastr.success(msg);\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS :`, e);\n                toastr.error('');\n            }\n            finally {\n                if (input)\n                    input.value = '';\n            }\n        }\n        async function onGptImportJsonChange(event) {\n            const input = event.target;\n            const file = input?.files?.[0];\n            if (!file)\n                return;\n            try {\n                const text = await file.text();\n                const parsed = JSON.parse(String(text || '[]'));\n                if (!Array.isArray(parsed)) {\n                    toastr.error('JSON ');\n                    return;\n                }\n                const normalizedIncoming = normalizeGptSoVitsVoicesForStore(parsed);\n                const existingNormalized = normalizeGptSoVitsVoicesForStore(settings.value.gptSoVits.voices || []).voices;\n                const merged = mergeGptSoVitsVoicesByName(existingNormalized, normalizedIncoming.voices);\n                settings.value.gptSoVits.voices = merged;\n                settings.value.gptSoVits.models = [];\n                setGptSoVitsModelsTextarea([]);\n                setGptSoVitsVoicesTextarea(merged);\n                syncGptModelManagerFromSettings();\n                await refreshTtsVoices();\n                let msg = `${normalizedIncoming.voices.length} `;\n                if (normalizedIncoming.ignoredCount > 0)\n                    msg += ` ${normalizedIncoming.ignoredCount} `;\n                if (normalizedIncoming.missingRefCount > 0)\n                    msg += ` ${normalizedIncoming.missingRefCount}  refAudioPath`;\n                toastr.success(msg);\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS  JSON :`, e);\n                toastr.error('JSON ');\n            }\n            finally {\n                if (input)\n                    input.value = '';\n            }\n        }\n        async function onGptImportFolderChange(event) {\n            const input = event.target;\n            const fileList = input?.files;\n            if (!fileList || fileList.length === 0)\n                return;\n            try {\n                const prefix = normalizePathSepLocal(settings.value.gptSoVits.importPathPrefix || settings.value.gptSoVits.rootDir || '');\n                const inferred = inferGptSoVitsVoicesFromFolderFiles(fileList, prefix);\n                if (!inferred || inferred.length === 0) {\n                    toastr.warning('');\n                    return;\n                }\n                const normalizedIncoming = normalizeGptSoVitsVoicesForStore(inferred);\n                const existingNormalized = normalizeGptSoVitsVoicesForStore(settings.value.gptSoVits.voices || []).voices;\n                const merged = mergeGptSoVitsVoicesByName(existingNormalized, normalizedIncoming.voices);\n                settings.value.gptSoVits.voices = merged;\n                settings.value.gptSoVits.models = [];\n                setGptSoVitsModelsTextarea([]);\n                setGptSoVitsVoicesTextarea(merged);\n                syncGptModelManagerFromSettings();\n                await refreshTtsVoices();\n                const hasRelativePath = normalizedIncoming.voices.some(v => !isAbsoluteFileSystemPath(v.refAudioPath || ''));\n                let msg = `${normalizedIncoming.voices.length} `;\n                if (hasRelativePath && !prefix) {\n                    msg += '';\n                }\n                toastr.success(msg);\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS :`, e);\n                toastr.error('');\n            }\n            finally {\n                if (input)\n                    input.value = '';\n            }\n        }\n        function exportGptSoVitsVoices() {\n            try {\n                const voices = settings.value.gptSoVits?.voices || [];\n                const blob = new Blob([JSON.stringify(voices, null, 2)], { type: 'application/json' });\n                const url = URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = 'gpt_sovits_voices.json';\n                a.click();\n                setTimeout(() => URL.revokeObjectURL(url), 1000);\n                toastr.success(' gpt_sovits_voices.json');\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS :`, e);\n                toastr.error('');\n            }\n        }\n        function exportGptSoVitsModels() {\n            try {\n                const models = settings.value.gptSoVits?.models || [];\n                const blob = new Blob([JSON.stringify(models, null, 2)], { type: 'application/json' });\n                const url = URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = 'gpt_sovits_models.json';\n                a.click();\n                setTimeout(() => URL.revokeObjectURL(url), 1000);\n                toastr.success(' gpt_sovits_models.json');\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS :`, e);\n                toastr.error('');\n            }\n        }\n        async function addGptSoVitsModelTemplate() {\n            try {\n                const current = getGptModelsFromTextarea();\n                const template = createGptSoVitsModelTemplateConfig();\n                const merged = mergeGptSoVitsModelsByName(current, [template]);\n                const legacyVoices = syncLegacyVoicesFromModels(merged);\n                settings.value.gptSoVits.models = merged;\n                settings.value.gptSoVits.voices = legacyVoices;\n                setGptSoVitsModelsTextarea(merged);\n                setGptSoVitsVoicesTextarea(legacyVoices);\n                syncGptModelManagerFromSettings();\n                await refreshTtsVoices();\n                toastr.success('');\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS :`, e);\n                toastr.error(' JSON');\n            }\n        }\n        function saveGptSoVitsModels() {\n            let parsed = null;\n            try {\n                parsed = JSON.parse(gptSoVitsModelsJson.value || '[]');\n            }\n            catch {\n                toastr.error(' JSON ');\n                return;\n            }\n            if (!Array.isArray(parsed)) {\n                toastr.error('');\n                return;\n            }\n            const normalized = normalizeGptSoVitsModelsForStore(parsed);\n            const legacyVoices = syncLegacyVoicesFromModels(normalized);\n            settings.value.gptSoVits.models = normalized;\n            settings.value.gptSoVits.voices = legacyVoices;\n            setGptSoVitsModelsTextarea(normalized);\n            setGptSoVitsVoicesTextarea(legacyVoices);\n            syncGptModelManagerFromSettings();\n            const firstUsable = pickFirstUsableGptSoVitsVoice(getGptSoVitsVoiceList());\n            if (!settings.value.ttsDefaultSpeaker && firstUsable?.name) {\n                settings.value.ttsDefaultSpeaker = firstUsable.name;\n            }\n            void refreshTtsVoices();\n            toastr.success(`GPT-SoVITS ${normalized.length} `);\n        }\n        async function addGptSoVitsVoiceTemplate() {\n            try {\n                const current = getGptVoicesFromTextarea().voices;\n                const template = {\n                    name: '',\n                    desc: '',\n                    refAudioPath: '',\n                    promptText: '',\n                    promptLang: 'zh',\n                    textLang: 'zh',\n                    gptWeightsPath: '',\n                    sovitsWeightsPath: '',\n                    modelSwitchMode: 'set_weights',\n                    setModelEndpoint: '/set_model',\n                    strictWeightSwitch: false,\n                };\n                const merged = mergeGptSoVitsVoicesByName(current, [template]);\n                settings.value.gptSoVits.voices = merged;\n                settings.value.gptSoVits.models = [];\n                setGptSoVitsModelsTextarea([]);\n                setGptSoVitsVoicesTextarea(merged);\n                syncGptModelManagerFromSettings();\n                await refreshTtsVoices();\n                toastr.success('');\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] GPT-SoVITS :`, e);\n                toastr.error(' JSON');\n            }\n        }\n        function saveGptSoVitsVoices() {\n            let parsed = null;\n            try {\n                parsed = JSON.parse(gptSoVitsVoicesJson.value || '[]');\n            }\n            catch {\n                toastr.error(' JSON ');\n                return;\n            }\n            if (!Array.isArray(parsed)) {\n                toastr.error('');\n                return;\n            }\n            const normalized = normalizeGptSoVitsVoicesForStore(parsed);\n            settings.value.gptSoVits.voices = normalized.voices;\n            settings.value.gptSoVits.models = [];\n            setGptSoVitsModelsTextarea([]);\n            setGptSoVitsVoicesTextarea(normalized.voices);\n            syncGptModelManagerFromSettings();\n            const firstUsable = pickFirstUsableGptSoVitsVoice(getGptSoVitsVoiceList());\n            if (!settings.value.ttsDefaultSpeaker && firstUsable?.name) {\n                settings.value.ttsDefaultSpeaker = firstUsable.name;\n            }\n            void refreshTtsVoices();\n            let msg = `GPT-SoVITS ${normalized.voices.length} `;\n            if (normalized.ignoredCount > 0)\n                msg += ` ${normalized.ignoredCount} `;\n            if (normalized.missingRefCount > 0)\n                msg += `${normalized.missingRefCount}  refAudioPath`;\n            toastr.success(msg);\n        }\n        function getCurrentCharacterId() {\n            try {\n                const ctx = SillyTavern?.getContext?.();\n                if (ctx?.characterId !== undefined && ctx?.characterId !== null) {\n                    return String(ctx.characterId);\n                }\n            }\n            catch {\n                // ignore\n            }\n            return 'default';\n        }\n        async function testTts() {\n            if (!ttsEnabled.value)\n                return;\n            const text = String(ttsTestText.value || '').trim() || ' TTS ';\n            const speaker = getCurrentCharacterId();\n            let voiceName = String(settings.value.ttsDefaultSpeaker || '').trim();\n            if (settings.value.ttsProvider === TTS_PROVIDER.GPT_SOVITS_V2) {\n                const voices = getGptSoVitsVoiceList();\n                const selected = voices.find(v => v.name === voiceName) || null;\n                const selectedUsable = !!String(selected?.gptSoVits?.refAudioPath || '').trim();\n                const fallback = pickFirstUsableGptSoVitsVoice(voices);\n                const target = selectedUsable ? selected : fallback;\n                const targetName = String(target?.name || '').trim();\n                if (!targetName) {\n                    toastr.error('refAudioPath ');\n                    return;\n                }\n                if (voiceName !== targetName) {\n                    settings.value.ttsDefaultSpeaker = targetName;\n                    voiceName = targetName;\n                    toastr.info(`${targetName}`);\n                }\n            }\n            else if (settings.value.ttsProvider === TTS_PROVIDER.EDGE_TTS_DIRECT && !voiceName) {\n                const voices = ttsVoiceList.value.length > 0 ? ttsVoiceList.value : await getTTSVoiceListAsync();\n                const fallbackName = String(voices[0]?.name || voices[0]?.value || '').trim();\n                if (!fallbackName) {\n                    toastr.error(' EdgeTTS ');\n                    return;\n                }\n                settings.value.ttsDefaultSpeaker = fallbackName;\n                voiceName = fallbackName;\n            }\n            try {\n                TTSManager.stop();\n                await TTSManager.speak({ type: 'dialogue', speaker, text, tts: voiceName ? { speaker: voiceName } : undefined }, `desktop_pet_tts_test_${Date.now()}`);\n            }\n            catch (e) {\n                console.warn(`[${SCRIPT_NAME}] TTS :`, e);\n            }\n        }\n        function stopTts() {\n            try {\n                TTSManager.stop();\n            }\n            catch {\n                // ignore\n            }\n        }\n        function applyLipSyncManualParams() {\n            const raw = String(lipSyncManualParamsText.value || '');\n            const parts = raw\n                .split(/[\\n,]/)\n                .map(item => String(item || '').trim())\n                .filter(Boolean);\n            const dedup = Array.from(new Set(parts));\n            settings.value.lipSyncManualParamIds = dedup;\n            lipSyncManualParamsText.value = dedup.join('\\n');\n        }\n        function close() {\n            applyLipSyncManualParams();\n            closeGptModelManager();\n            emit('close');\n        }\n        watch(() => props.visible, visible => {\n            if (!visible) {\n                closeGptModelManager();\n                return;\n            }\n            ensureNumericSettingsIntegrity();\n            activeSection.value = 'api';\n            customModelUrl.value = settings.value.modelPath || '';\n            showEmotionAdvanced.value = false;\n            ttsEnabled.value = getTTSEnabled();\n            localModelStatus.value = '';\n            localModelError.value = '';\n            lipSyncManualParamsText.value = Array.isArray(settings.value.lipSyncManualParamIds)\n                ? settings.value.lipSyncManualParamIds.join('\\n')\n                : '';\n            settings.value.gptSoVits.modelSwitchMode = normalizeGptSoVitsSwitchMode(settings.value.gptSoVits.modelSwitchMode);\n            const syncedPrefix = normalizePathSepLocal(settings.value.gptSoVits.importPathPrefix || settings.value.gptSoVits.rootDir || '');\n            settings.value.gptSoVits.rootDir = syncedPrefix;\n            settings.value.gptSoVits.importPathPrefix = syncedPrefix;\n            settings.value.gptSoVits.setModelEndpoint = String(settings.value.gptSoVits.setModelEndpoint || '/set_model').trim()\n                || '/set_model';\n            if (!Array.isArray(settings.value.gptSoVits.models)) {\n                settings.value.gptSoVits.models = [];\n            }\n            if (!Array.isArray(settings.value.gptSoVits.voices)) {\n                settings.value.gptSoVits.voices = [];\n            }\n            try {\n                gptSoVitsModelsJson.value = JSON.stringify(settings.value.gptSoVits?.models || [], null, 2);\n            }\n            catch {\n                gptSoVitsModelsJson.value = '[]';\n            }\n            try {\n                gptSoVitsVoicesJson.value = JSON.stringify(settings.value.gptSoVits?.voices || [], null, 2);\n            }\n            catch {\n                gptSoVitsVoicesJson.value = '[]';\n            }\n            syncGptModelManagerFromSettings();\n            void refreshTtsVoices();\n            refreshDiceReferenceSheetOptions();\n            void refreshLocalModelInfo();\n        }, { immediate: true });\n        watch(() => settings.value.ttsProvider, () => {\n            try {\n                TTSManager._refreshProviderState();\n            }\n            catch {\n                // ignore\n            }\n            void refreshTtsVoices();\n        });\n        watch(() => settings.value.useDiceDatabaseReference, enabled => {\n            if (!enabled)\n                return;\n            refreshDiceReferenceSheetOptions();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", null, [\n                (__props.visible)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"settings-overlay dp-settings-overlay\",\n                        style: overlayFallbackStyle,\n                        onClick: _withModifiers(close, [\"self\"])\n                    }, [\n                        _createElementVNode(\"div\", {\n                            class: \"settings-panel dp-settings-panel\",\n                            style: panelFallbackStyle\n                        }, [\n                            _createElementVNode(\"div\", { class: \"panel-header\" }, [\n                                _cache[85] || (_cache[85] = _createElementVNode(\"div\", { class: \"header-title\" }, [\n                                    _createElementVNode(\"h3\", null, \"\"),\n                                    _createElementVNode(\"p\", null, \"SYSTEM // SETTINGS\")\n                                ], -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-btn\",\n                                    type: \"button\",\n                                    onClick: close\n                                }, \"CLOSE\")\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_1, [\n                                _createElementVNode(\"aside\", _hoisted_2, [\n                                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(sectionTabs, (item) => {\n                                        return _createElementVNode(\"button\", {\n                                            key: item.key,\n                                            class: _normalizeClass([\"nav-btn\", { active: activeSection.value === item.key }]),\n                                            type: \"button\",\n                                            onClick: ($event) => (activeSection.value = item.key)\n                                        }, [\n                                            _createElementVNode(\"span\", _hoisted_4, _toDisplayString(item.index), 1 /* TEXT */),\n                                            _createElementVNode(\"span\", _hoisted_5, _toDisplayString(item.label), 1 /* TEXT */),\n                                            _createElementVNode(\"span\", _hoisted_6, _toDisplayString(item.en), 1 /* TEXT */)\n                                        ], 10 /* CLASS, PROPS */, _hoisted_3);\n                                    }), 64 /* STABLE_FRAGMENT */))\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_7, [\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_8, [\n                                        _cache[99] || (_cache[99] = _createElementVNode(\"h4\", null, [\n                                            _createElementVNode(\"span\", { class: \"section-index\" }, \"01\"),\n                                            _createElementVNode(\"span\", { class: \"section-label\" }, \"API \"),\n                                            _createElementVNode(\"span\", { class: \"section-sub\" }, \"API CONTROL\")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_9, [\n                                            _cache[87] || (_cache[87] = _createElementVNode(\"label\", null, \"API \", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"select\", {\n                                                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((_unref(settings).apiMode) = $event))\n                                            }, [...(_cache[86] || (_cache[86] = [\n                                                    _createElementVNode(\"option\", { value: \"tavern\" }, \" API\", -1 /* CACHED */),\n                                                    _createElementVNode(\"option\", { value: \"custom\" }, \" API\", -1 /* CACHED */)\n                                                ]))], 512 /* NEED_PATCH */), [\n                                                [_vModelSelect, _unref(settings).apiMode]\n                                            ])\n                                        ]),\n                                        (_unref(settings).apiMode === 'custom')\n                                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                                                _createElementVNode(\"div\", _hoisted_10, [\n                                                    _cache[88] || (_cache[88] = _createElementVNode(\"label\", null, \"API Source\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"select\", {\n                                                        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((_unref(settings).apiConfig.source) = $event))\n                                                    }, [\n                                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(apiSources), (src) => {\n                                                            return (_openBlock(), _createElementBlock(\"option\", {\n                                                                key: src.value,\n                                                                value: src.value\n                                                            }, _toDisplayString(src.label), 9 /* TEXT, PROPS */, _hoisted_11));\n                                                        }), 128 /* KEYED_FRAGMENT */))\n                                                    ], 512 /* NEED_PATCH */), [\n                                                        [_vModelSelect, _unref(settings).apiConfig.source]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_12, [\n                                                    _cache[89] || (_cache[89] = _createElementVNode(\"label\", null, \"API URL\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"input\", {\n                                                        type: \"text\",\n                                                        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event) => ((_unref(settings).apiConfig.url) = $event)),\n                                                        placeholder: \"https://api.openai.com/v1\"\n                                                    }, null, 512 /* NEED_PATCH */), [\n                                                        [_vModelText, _unref(settings).apiConfig.url]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_13, [\n                                                    _cache[90] || (_cache[90] = _createElementVNode(\"label\", null, \"API Key\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"input\", {\n                                                        type: \"password\",\n                                                        \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event) => ((_unref(settings).apiConfig.apiKey) = $event)),\n                                                        placeholder: \"sk-...\"\n                                                    }, null, 512 /* NEED_PATCH */), [\n                                                        [_vModelText, _unref(settings).apiConfig.apiKey]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_14, [\n                                                    _cache[91] || (_cache[91] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"div\", _hoisted_15, [\n                                                        (modelList.value.length === 0)\n                                                            ? _withDirectives((_openBlock(), _createElementBlock(\"input\", {\n                                                                key: 0,\n                                                                type: \"text\",\n                                                                \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event) => ((_unref(settings).apiConfig.model) = $event)),\n                                                                placeholder: \"gpt-4o-mini\"\n                                                            }, null, 512 /* NEED_PATCH */)), [\n                                                                [_vModelText, _unref(settings).apiConfig.model]\n                                                            ])\n                                                            : _withDirectives((_openBlock(), _createElementBlock(\"select\", {\n                                                                key: 1,\n                                                                \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event) => ((_unref(settings).apiConfig.model) = $event))\n                                                            }, [\n                                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(modelList.value, (m) => {\n                                                                    return (_openBlock(), _createElementBlock(\"option\", {\n                                                                        key: m,\n                                                                        value: m\n                                                                    }, _toDisplayString(m), 9 /* TEXT, PROPS */, _hoisted_16));\n                                                                }), 128 /* KEYED_FRAGMENT */))\n                                                            ], 512 /* NEED_PATCH */)), [\n                                                                [_vModelSelect, _unref(settings).apiConfig.model]\n                                                            ]),\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"input-btn\",\n                                                            type: \"button\",\n                                                            onClick: fetchModels,\n                                                            disabled: !_unref(settings).apiConfig.url || fetchingModels.value\n                                                        }, _toDisplayString(fetchingModels.value ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_17)\n                                                    ]),\n                                                    (modelFetchError.value)\n                                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18, _toDisplayString(modelFetchError.value), 1 /* TEXT */))\n                                                        : _createCommentVNode(\"v-if\", true)\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_19, [\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-test\",\n                                                        type: \"button\",\n                                                        disabled: !_unref(settings).apiConfig.url || testingConnection.value,\n                                                        onClick: testConnection\n                                                    }, _toDisplayString(testingConnection.value ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_20),\n                                                    (connectionStatus.value === 'success')\n                                                        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_21, \"\"))\n                                                        : _createCommentVNode(\"v-if\", true),\n                                                    (connectionStatus.value === 'fail')\n                                                        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_22, _toDisplayString(connectionError.value), 1 /* TEXT */))\n                                                        : _createCommentVNode(\"v-if\", true)\n                                                ])\n                                            ], 64 /* STABLE_FRAGMENT */))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        _createElementVNode(\"div\", _hoisted_23, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[6] || (_cache[6] = ($event) => ((_unref(settings).apiConfig.usePresetSampling) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).apiConfig.usePresetSampling]\n                                                ]),\n                                                _cache[92] || (_cache[92] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[93] || (_cache[93] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_24, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event) => ((_unref(settings).apiConfig.sendWorldInfo) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).apiConfig.sendWorldInfo]\n                                                ]),\n                                                _cache[94] || (_cache[94] = _createTextVNode(\" World Info \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[95] || (_cache[95] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        (!_unref(settings).apiConfig.usePresetSampling)\n                                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                                _createElementVNode(\"div\", _hoisted_25, [\n                                                    _createElementVNode(\"div\", _hoisted_26, [\n                                                        _cache[96] || (_cache[96] = _createElementVNode(\"label\", null, \"Max Tokens\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"number\",\n                                                            \"onUpdate:modelValue\": _cache[8] || (_cache[8] = ($event) => ((_unref(settings).apiConfig.max_tokens) = $event)),\n                                                            min: \"1\",\n                                                            max: \"4096\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).apiConfig.max_tokens,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_27, [\n                                                        _createElementVNode(\"label\", null, \"Temperature (\" + _toDisplayString(temperatureLabel.value) + \")\", 1 /* TEXT */),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"range\",\n                                                            \"onUpdate:modelValue\": _cache[9] || (_cache[9] = ($event) => ((_unref(settings).apiConfig.temperature) = $event)),\n                                                            min: \"0\",\n                                                            max: \"2\",\n                                                            step: \"0.1\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).apiConfig.temperature,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", {\n                                                    class: \"advanced-toggle\",\n                                                    onClick: _cache[10] || (_cache[10] = ($event) => (showAdvanced.value = !showAdvanced.value))\n                                                }, [\n                                                    _createElementVNode(\"span\", _hoisted_28, _toDisplayString(showAdvanced.value ? '' : ''), 1 /* TEXT */),\n                                                    _cache[97] || (_cache[97] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                                ]),\n                                                (showAdvanced.value)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_29, [\n                                                        _createElementVNode(\"div\", _hoisted_30, [\n                                                            _createElementVNode(\"div\", _hoisted_31, [\n                                                                _createElementVNode(\"label\", null, \"Frequency Penalty (\" + _toDisplayString(frequencyPenaltyLabel.value) + \")\", 1 /* TEXT */),\n                                                                _withDirectives(_createElementVNode(\"input\", {\n                                                                    type: \"range\",\n                                                                    \"onUpdate:modelValue\": _cache[11] || (_cache[11] = ($event) => ((_unref(settings).apiConfig.frequency_penalty) = $event)),\n                                                                    min: \"-2\",\n                                                                    max: \"2\",\n                                                                    step: \"0.1\"\n                                                                }, null, 512 /* NEED_PATCH */), [\n                                                                    [\n                                                                        _vModelText,\n                                                                        _unref(settings).apiConfig.frequency_penalty,\n                                                                        void 0,\n                                                                        { number: true }\n                                                                    ]\n                                                                ])\n                                                            ]),\n                                                            _createElementVNode(\"div\", _hoisted_32, [\n                                                                _createElementVNode(\"label\", null, \"Presence Penalty (\" + _toDisplayString(presencePenaltyLabel.value) + \")\", 1 /* TEXT */),\n                                                                _withDirectives(_createElementVNode(\"input\", {\n                                                                    type: \"range\",\n                                                                    \"onUpdate:modelValue\": _cache[12] || (_cache[12] = ($event) => ((_unref(settings).apiConfig.presence_penalty) = $event)),\n                                                                    min: \"-2\",\n                                                                    max: \"2\",\n                                                                    step: \"0.1\"\n                                                                }, null, 512 /* NEED_PATCH */), [\n                                                                    [\n                                                                        _vModelText,\n                                                                        _unref(settings).apiConfig.presence_penalty,\n                                                                        void 0,\n                                                                        { number: true }\n                                                                    ]\n                                                                ])\n                                                            ])\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_33, [\n                                                            _createElementVNode(\"div\", _hoisted_34, [\n                                                                _createElementVNode(\"label\", null, \"Top P (\" + _toDisplayString(topPLabel.value) + \")\", 1 /* TEXT */),\n                                                                _withDirectives(_createElementVNode(\"input\", {\n                                                                    type: \"range\",\n                                                                    \"onUpdate:modelValue\": _cache[13] || (_cache[13] = ($event) => ((_unref(settings).apiConfig.top_p) = $event)),\n                                                                    min: \"0\",\n                                                                    max: \"1\",\n                                                                    step: \"0.01\"\n                                                                }, null, 512 /* NEED_PATCH */), [\n                                                                    [\n                                                                        _vModelText,\n                                                                        _unref(settings).apiConfig.top_p,\n                                                                        void 0,\n                                                                        { number: true }\n                                                                    ]\n                                                                ])\n                                                            ]),\n                                                            _createElementVNode(\"div\", _hoisted_35, [\n                                                                _cache[98] || (_cache[98] = _createElementVNode(\"label\", null, \"Top K\", -1 /* CACHED */)),\n                                                                _withDirectives(_createElementVNode(\"input\", {\n                                                                    type: \"number\",\n                                                                    \"onUpdate:modelValue\": _cache[14] || (_cache[14] = ($event) => ((_unref(settings).apiConfig.top_k) = $event)),\n                                                                    min: \"0\",\n                                                                    max: \"500\"\n                                                                }, null, 512 /* NEED_PATCH */), [\n                                                                    [\n                                                                        _vModelText,\n                                                                        _unref(settings).apiConfig.top_k,\n                                                                        void 0,\n                                                                        { number: true }\n                                                                    ]\n                                                                ])\n                                                            ])\n                                                        ])\n                                                    ]))\n                                                    : _createCommentVNode(\"v-if\", true)\n                                            ], 64 /* STABLE_FRAGMENT */))\n                                            : _createCommentVNode(\"v-if\", true)\n                                    ], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'api']\n                                    ]),\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_36, [\n                                        _cache[109] || (_cache[109] = _createElementVNode(\"h4\", null, [\n                                            _createElementVNode(\"span\", { class: \"section-index\" }, \"02\"),\n                                            _createElementVNode(\"span\", { class: \"section-label\" }, \"Live2D \"),\n                                            _createElementVNode(\"span\", { class: \"section-sub\" }, \"MODEL CONTROL\")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_37, [\n                                            _cache[100] || (_cache[100] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_38, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"text\",\n                                                    \"onUpdate:modelValue\": _cache[15] || (_cache[15] = ($event) => ((customModelUrl).value = $event)),\n                                                    placeholder: \" .model.json  .model3.json  URL\",\n                                                    onKeydown: _withKeys(loadCustomUrl, [\"enter\"])\n                                                }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                                    [_vModelText, customModelUrl.value]\n                                                ]),\n                                                _createElementVNode(\"button\", {\n                                                    class: \"input-btn\",\n                                                    type: \"button\",\n                                                    onClick: loadCustomUrl,\n                                                    disabled: !customModelUrl.value.trim()\n                                                }, \"  \", 8 /* PROPS */, _hoisted_39)\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_40, [\n                                            _cache[101] || (_cache[101] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_41, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(recommendedModels), (m) => {\n                                                    return (_openBlock(), _createElementBlock(\"button\", {\n                                                        key: m.path,\n                                                        class: _normalizeClass([\"model-btn\", { active: _unref(settings).modelPath === m.path }]),\n                                                        type: \"button\",\n                                                        onClick: ($event) => (selectModel(m.path))\n                                                    }, _toDisplayString(m.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_42));\n                                                }), 128 /* KEYED_FRAGMENT */)),\n                                                _createElementVNode(\"button\", {\n                                                    class: \"model-btn browse-btn\",\n                                                    type: \"button\",\n                                                    onClick: _cache[16] || (_cache[16] = ($event) => (showBrowser.value = true))\n                                                }, \"\")\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_43, [\n                                            _cache[102] || (_cache[102] = _createElementVNode(\"label\", null, \" ZIP \", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_44, [\n                                                _createElementVNode(\"button\", {\n                                                    class: \"model-btn\",\n                                                    type: \"button\",\n                                                    disabled: localModelBusy.value,\n                                                    onClick: triggerLocalModelUpload\n                                                }, _toDisplayString(uploadingLocalModel.value ? '...' : ' ZIP '), 9 /* TEXT, PROPS */, _hoisted_45),\n                                                _createElementVNode(\"button\", {\n                                                    class: \"model-btn\",\n                                                    type: \"button\",\n                                                    disabled: localModelBusy.value || !localModelExists.value,\n                                                    onClick: useUploadedModel\n                                                }, \"  \", 8 /* PROPS */, _hoisted_46),\n                                                _createElementVNode(\"button\", {\n                                                    class: \"model-btn\",\n                                                    type: \"button\",\n                                                    disabled: localModelBusy.value || !localModelExists.value,\n                                                    onClick: clearUploadedModel\n                                                }, \"  \", 8 /* PROPS */, _hoisted_47)\n                                            ]),\n                                            _createElementVNode(\"input\", {\n                                                ref_key: \"localModelFileInput\",\n                                                ref: localModelFileInput,\n                                                class: \"hidden-file-input\",\n                                                type: \"file\",\n                                                accept: \".zip,application/zip\",\n                                                onChange: onLocalModelFileChange\n                                            }, null, 544 /* NEED_HYDRATION, NEED_PATCH */),\n                                            _createElementVNode(\"div\", _hoisted_48, \"\" + _toDisplayString(_unref(LOCAL_LIVE2D_MODEL_PATH)), 1 /* TEXT */),\n                                            (localModelStatus.value)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_49, _toDisplayString(localModelStatus.value), 1 /* TEXT */))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            (localModelError.value)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_50, _toDisplayString(localModelError.value), 1 /* TEXT */))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            (localModelInfo.value)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_51, [\n                                                    _createElementVNode(\"div\", null, \"\" + _toDisplayString(localModelInfo.value.fileName), 1 /* TEXT */),\n                                                    _createElementVNode(\"div\", null, \"Cubism \" + _toDisplayString(localModelInfo.value.cubismVersion ?? ''), 1 /* TEXT */),\n                                                    _createElementVNode(\"div\", null, \"Runtime\" + _toDisplayString(runtimeLabel(localModelInfo.value.runtimeType)), 1 /* TEXT */),\n                                                    _createElementVNode(\"div\", null, \"\" + _toDisplayString(formatLocalUploadTime(localModelInfo.value.uploadTime)), 1 /* TEXT */),\n                                                    _createElementVNode(\"div\", null, \"\" + _toDisplayString(formatFileSize(localModelInfo.value.fileSize)), 1 /* TEXT */)\n                                                ]))\n                                                : (_openBlock(), _createElementBlock(\"div\", _hoisted_52, \"\"))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_53, [\n                                            _createElementVNode(\"label\", null, \" (\" + _toDisplayString(petScaleLabel.value) + \")\", 1 /* TEXT */),\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"range\",\n                                                \"onUpdate:modelValue\": _cache[17] || (_cache[17] = ($event) => ((_unref(settings).petScale) = $event)),\n                                                min: \"0.1\",\n                                                max: \"3\",\n                                                step: \"0.05\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [\n                                                    _vModelText,\n                                                    _unref(settings).petScale,\n                                                    void 0,\n                                                    { number: true }\n                                                ]\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_54, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[18] || (_cache[18] = ($event) => ((_unref(settings).useCdn) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).useCdn]\n                                                ]),\n                                                _cache[103] || (_cache[103] = _createTextVNode(\"  CDN jsDelivr \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[104] || (_cache[104] = _createElementVNode(\"div\", { class: \"hint\" }, \" GitHub  CDN \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_55, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[19] || (_cache[19] = ($event) => ((_unref(settings).doubleTapRandomMotionEnabled) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).doubleTapRandomMotionEnabled]\n                                                ]),\n                                                _cache[105] || (_cache[105] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[106] || (_cache[106] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_56, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[20] || (_cache[20] = ($event) => ((_unref(settings).gazeFollowMouseEnabled) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).gazeFollowMouseEnabled]\n                                                ]),\n                                                _cache[107] || (_cache[107] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[108] || (_cache[108] = _createElementVNode(\"div\", { class: \"hint\" }, \"/\", -1 /* CACHED */))\n                                        ])\n                                    ], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'live2d']\n                                    ]),\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_57, [\n                                        _cache[133] || (_cache[133] = _createElementVNode(\"h4\", null, [\n                                            _createElementVNode(\"span\", { class: \"section-index\" }, \"03\"),\n                                            _createElementVNode(\"span\", { class: \"section-label\" }, \"\"),\n                                            _createElementVNode(\"span\", { class: \"section-sub\" }, \"COMMENT SYSTEM\")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_58, [\n                                            _cache[110] || (_cache[110] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"select\", {\n                                                \"onUpdate:modelValue\": _cache[21] || (_cache[21] = ($event) => ((_unref(settings).commentStyle) = $event))\n                                            }, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(commentStyles), (style) => {\n                                                    return (_openBlock(), _createElementBlock(\"option\", {\n                                                        key: style,\n                                                        value: style\n                                                    }, _toDisplayString(style), 9 /* TEXT, PROPS */, _hoisted_59));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ], 512 /* NEED_PATCH */), [\n                                                [_vModelSelect, _unref(settings).commentStyle]\n                                            ])\n                                        ]),\n                                        (_unref(settings).commentStyle === '')\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_60, [\n                                                _cache[111] || (_cache[111] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                _withDirectives(_createElementVNode(\"textarea\", {\n                                                    \"onUpdate:modelValue\": _cache[22] || (_cache[22] = ($event) => ((_unref(settings).customPrompt) = $event)),\n                                                    rows: \"4\",\n                                                    placeholder: \"...\"\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelText, _unref(settings).customPrompt]\n                                                ])\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        _createElementVNode(\"div\", _hoisted_61, [\n                                            _cache[112] || (_cache[112] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"text\",\n                                                \"onUpdate:modelValue\": _cache[23] || (_cache[23] = ($event) => ((_unref(settings).roleplayName) = $event)),\n                                                placeholder: \"\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [_vModelText, _unref(settings).roleplayName]\n                                            ]),\n                                            _cache[113] || (_cache[113] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_62, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[24] || (_cache[24] = ($event) => ((_unref(settings).roleplayIgnoreCommentStyle) = $event)),\n                                                    disabled: !_unref(settings).roleplayName.trim()\n                                                }, null, 8 /* PROPS */, _hoisted_63), [\n                                                    [_vModelCheckbox, _unref(settings).roleplayIgnoreCommentStyle]\n                                                ]),\n                                                _cache[114] || (_cache[114] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[115] || (_cache[115] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_64, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[25] || (_cache[25] = ($event) => ((_unref(settings).sendCharacterCardContent) = $event)),\n                                                    disabled: !_unref(settings).roleplayName.trim()\n                                                }, null, 8 /* PROPS */, _hoisted_65), [\n                                                    [_vModelCheckbox, _unref(settings).sendCharacterCardContent]\n                                                ]),\n                                                _cache[116] || (_cache[116] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[117] || (_cache[117] = _createElementVNode(\"div\", { class: \"hint\" }, \"//\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_66, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[26] || (_cache[26] = ($event) => ((_unref(settings).autoTrigger) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).autoTrigger]\n                                                ]),\n                                                _cache[118] || (_cache[118] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ])\n                                        ]),\n                                        (_unref(settings).autoTrigger)\n                                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                                _createElementVNode(\"div\", _hoisted_67, [\n                                                    _cache[119] || (_cache[119] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"select\", {\n                                                        \"onUpdate:modelValue\": _cache[27] || (_cache[27] = ($event) => ((_unref(settings).commentTriggerMode) = $event))\n                                                    }, [\n                                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(commentTriggerModeOptions), (option) => {\n                                                            return (_openBlock(), _createElementBlock(\"option\", {\n                                                                key: option.value,\n                                                                value: option.value\n                                                            }, _toDisplayString(option.label), 9 /* TEXT, PROPS */, _hoisted_68));\n                                                        }), 128 /* KEYED_FRAGMENT */))\n                                                    ], 512 /* NEED_PATCH */), [\n                                                        [_vModelSelect, _unref(settings).commentTriggerMode]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_69, [\n                                                    _createElementVNode(\"div\", _hoisted_70, [\n                                                        _cache[120] || (_cache[120] = _createElementVNode(\"label\", null, \" N \", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"number\",\n                                                            \"onUpdate:modelValue\": _cache[28] || (_cache[28] = ($event) => ((_unref(settings).triggerInterval) = $event)),\n                                                            min: \"1\",\n                                                            max: \"100\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).triggerInterval,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_71, [\n                                                        _createElementVNode(\"label\", null, \"\" + _toDisplayString(_unref(settings).triggerProbability) + \"%\", 1 /* TEXT */),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"range\",\n                                                            \"onUpdate:modelValue\": _cache[29] || (_cache[29] = ($event) => ((_unref(settings).triggerProbability) = $event)),\n                                                            min: \"0\",\n                                                            max: \"100\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).triggerProbability,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ])\n                                                    ])\n                                                ])\n                                            ], 64 /* STABLE_FRAGMENT */))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        _createElementVNode(\"div\", _hoisted_72, [\n                                            _cache[121] || (_cache[121] = _createElementVNode(\"label\", null, \" LLM \", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"number\",\n                                                \"onUpdate:modelValue\": _cache[30] || (_cache[30] = ($event) => ((_unref(settings).maxChatContext) = $event)),\n                                                min: \"1\",\n                                                max: \"50\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [\n                                                    _vModelText,\n                                                    _unref(settings).maxChatContext,\n                                                    void 0,\n                                                    { number: true }\n                                                ]\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_73, [\n                                            _cache[122] || (_cache[122] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"number\",\n                                                \"onUpdate:modelValue\": _cache[31] || (_cache[31] = ($event) => ((_unref(settings).bubbleDuration) = $event)),\n                                                min: \"-1\",\n                                                max: \"600\",\n                                                step: \"1\"\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [\n                                                    _vModelText,\n                                                    _unref(settings).bubbleDuration,\n                                                    void 0,\n                                                    { number: true }\n                                                ]\n                                            ]),\n                                            _cache[123] || (_cache[123] = _createElementVNode(\"div\", { class: \"hint\" }, \" -1  0 \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_74, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[32] || (_cache[32] = ($event) => ((_unref(settings).phoneMessageAutoRead) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).phoneMessageAutoRead]\n                                                ]),\n                                                _cache[124] || (_cache[124] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[125] || (_cache[125] = _createElementVNode(\"div\", { class: \"hint\" }, \" NPC  TTS \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_75, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[33] || (_cache[33] = ($event) => ((_unref(settings).baibaiPhoneMessageAutoRead) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).baibaiPhoneMessageAutoRead]\n                                                ]),\n                                                _cache[126] || (_cache[126] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[127] || (_cache[127] = _createElementVNode(\"div\", { class: \"hint\" }, \" NPC  TTS \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_76, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[34] || (_cache[34] = ($event) => ((_unref(settings).useTamakoTodaySpecial) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).useTamakoTodaySpecial]\n                                                ]),\n                                                _cache[128] || (_cache[128] = _createTextVNode(\"  Tamako  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[129] || (_cache[129] = _createElementVNode(\"div\", { class: \"hint\" }, \" Tamako Market \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_77, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[35] || (_cache[35] = ($event) => ((_unref(settings).useDiceDatabaseReference) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).useDiceDatabaseReference]\n                                                ]),\n                                                _cache[130] || (_cache[130] = _createTextVNode(\"  +  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[131] || (_cache[131] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                        ]),\n                                        (_unref(settings).useDiceDatabaseReference)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_78, [\n                                                _cache[132] || (_cache[132] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                _createElementVNode(\"div\", _hoisted_79, [\n                                                    _createElementVNode(\"div\", _hoisted_80, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-test\",\n                                                            type: \"button\",\n                                                            onClick: refreshDiceReferenceSheetOptions,\n                                                            disabled: refreshingDiceSheetOptions.value\n                                                        }, _toDisplayString(refreshingDiceSheetOptions.value ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_81)\n                                                    ]),\n                                                    _createElementVNode(\"div\", { class: \"form-group half\" }, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: selectAllDiceReferenceSheets\n                                                        }, \"\")\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_82, [\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-secondary\",\n                                                        type: \"button\",\n                                                        onClick: clearDiceReferenceSheets\n                                                    }, \"\"),\n                                                    _createElementVNode(\"div\", _hoisted_83, _toDisplayString(diceReferenceSheetSummary.value), 1 /* TEXT */)\n                                                ]),\n                                                (diceReferenceSheetOptions.value.length > 0)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_84, [\n                                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(diceReferenceSheetOptions.value, (sheetName) => {\n                                                            return (_openBlock(), _createElementBlock(\"label\", {\n                                                                class: \"dice-sheet-item\",\n                                                                key: sheetName\n                                                            }, [\n                                                                _createElementVNode(\"input\", {\n                                                                    type: \"checkbox\",\n                                                                    checked: isDiceSheetVisible(sheetName),\n                                                                    onChange: ($event) => (onToggleDiceSheetVisibility(sheetName, $event))\n                                                                }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_85),\n                                                                _createElementVNode(\"span\", null, _toDisplayString(sheetName), 1 /* TEXT */)\n                                                            ]));\n                                                        }), 128 /* KEYED_FRAGMENT */))\n                                                    ]))\n                                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_86, \"\"))\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true)\n                                    ], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'comment']\n                                    ]),\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_87, [\n                                        _cache[152] || (_cache[152] = _createElementVNode(\"h4\", null, [\n                                            _createElementVNode(\"span\", { class: \"section-index\" }, \"04\"),\n                                            _createElementVNode(\"span\", { class: \"section-label\" }, \"\"),\n                                            _createElementVNode(\"span\", { class: \"section-sub\" }, \"EMOTION COT\")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_88, [\n                                            _createElementVNode(\"div\", _hoisted_89, [\n                                                _createElementVNode(\"div\", _hoisted_90, [\n                                                    _createElementVNode(\"label\", null, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"checkbox\",\n                                                            \"onUpdate:modelValue\": _cache[36] || (_cache[36] = ($event) => ((_unref(settings).emotionCotEnabled) = $event))\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).emotionCotEnabled]\n                                                        ]),\n                                                        _cache[134] || (_cache[134] = _createTextVNode(\"  COT \", -1 /* CACHED */))\n                                                    ]),\n                                                    _cache[135] || (_cache[135] = _createElementVNode(\"div\", { class: \"hint\" }, [\n                                                        _createTextVNode(\" LLM  \"),\n                                                        _createElementVNode(\"code\", null, \"[|]: \"),\n                                                        _createTextVNode(\" /TTS  Live2D \")\n                                                    ], -1 /* CACHED */)),\n                                                    _createElementVNode(\"div\", _hoisted_91, \"\" + _toDisplayString(_unref(emotionTags).join('')), 1 /* TEXT */)\n                                                ]),\n                                                (_unref(settings).emotionCotEnabled)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_92, [\n                                                        _createElementVNode(\"label\", null, [\n                                                            _withDirectives(_createElementVNode(\"input\", {\n                                                                type: \"checkbox\",\n                                                                \"onUpdate:modelValue\": _cache[37] || (_cache[37] = ($event) => ((_unref(settings).emotionCotStripFromText) = $event))\n                                                            }, null, 512 /* NEED_PATCH */), [\n                                                                [_vModelCheckbox, _unref(settings).emotionCotStripFromText]\n                                                            ]),\n                                                            _cache[136] || (_cache[136] = _createTextVNode(\" /TTS  \", -1 /* CACHED */))\n                                                        ]),\n                                                        _cache[137] || (_cache[137] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                                    ]))\n                                                    : _createCommentVNode(\"v-if\", true),\n                                                _createElementVNode(\"div\", _hoisted_93, [\n                                                    _createElementVNode(\"div\", { class: \"form-group half\" }, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: resetEmotionConfigs\n                                                        }, \"\")\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_94, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-test\",\n                                                            type: \"button\",\n                                                            onClick: refreshLive2DLists,\n                                                            disabled: refreshingLive2dLists.value\n                                                        }, _toDisplayString(refreshingLive2dLists.value ? '...' : '/'), 9 /* TEXT, PROPS */, _hoisted_95)\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_96, [\n                                                    _createElementVNode(\"div\", _hoisted_97, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-test\",\n                                                            type: \"button\",\n                                                            onClick: _cache[38] || (_cache[38] = ($event) => (autoMatchLive2DOverrides(false)))\n                                                        }, \"  \")\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_98, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: _cache[39] || (_cache[39] = ($event) => (autoMatchLive2DOverrides(true)))\n                                                        }, \"  \")\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_99, [\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-secondary\",\n                                                        type: \"button\",\n                                                        onClick: clearLive2DOverrides\n                                                    }, \" Live2D \"),\n                                                    _createElementVNode(\"div\", _hoisted_100, _toDisplayString(live2dListSummary.value), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_101, [\n                                                    _createElementVNode(\"div\", {\n                                                        class: \"advanced-toggle\",\n                                                        onClick: _cache[40] || (_cache[40] = ($event) => (showEmotionAdvanced.value = !showEmotionAdvanced.value))\n                                                    }, [\n                                                        _createElementVNode(\"span\", _hoisted_102, _toDisplayString(showEmotionAdvanced.value ? '' : ''), 1 /* TEXT */),\n                                                        _createElementVNode(\"span\", null, _toDisplayString(showEmotionAdvanced.value ? '' : ''), 1 /* TEXT */)\n                                                    ]),\n                                                    _cache[138] || (_cache[138] = _createElementVNode(\"div\", { class: \"hint\" }, \"TTS \", -1 /* CACHED */))\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_103, [\n                                                    _cache[142] || (_cache[142] = _createElementVNode(\"div\", { class: \"emotion-map-head\" }, [\n                                                        _createElementVNode(\"div\", null, \"\"),\n                                                        _createElementVNode(\"div\", null, \"\"),\n                                                        _createElementVNode(\"div\", null, \"Live2D Expression\"),\n                                                        _createElementVNode(\"div\", null, \"Live2D Motion\"),\n                                                        _createElementVNode(\"div\", null, \"\")\n                                                    ], -1 /* CACHED */)),\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(settings).emotionConfigs, (cfg) => {\n                                                        return (_openBlock(), _createElementBlock(\"div\", {\n                                                            key: cfg.tag,\n                                                            class: \"emotion-map-row\"\n                                                        }, [\n                                                            _createElementVNode(\"div\", _hoisted_104, _toDisplayString(cfg.tag), 1 /* TEXT */),\n                                                            _cache[141] || (_cache[141] = _createElementVNode(\"div\", { class: \"emotion-map-arrow\" }, \"\", -1 /* CACHED */)),\n                                                            _withDirectives(_createElementVNode(\"select\", {\n                                                                \"onUpdate:modelValue\": ($event) => ((cfg.live2dExpression) = $event)\n                                                            }, [\n                                                                _cache[139] || (_cache[139] = _createElementVNode(\"option\", { value: \"\" }, \"\", -1 /* CACHED */)),\n                                                                (cfg.live2dExpression && !live2dExpressionOptionSet.value.has(cfg.live2dExpression))\n                                                                    ? (_openBlock(), _createElementBlock(\"option\", {\n                                                                        key: 0,\n                                                                        value: cfg.live2dExpression\n                                                                    }, _toDisplayString(cfg.live2dExpression) + \" \", 9 /* TEXT, PROPS */, _hoisted_106))\n                                                                    : _createCommentVNode(\"v-if\", true),\n                                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(live2dExpressionOptions.value, (expr) => {\n                                                                    return (_openBlock(), _createElementBlock(\"option\", {\n                                                                        key: expr,\n                                                                        value: expr\n                                                                    }, _toDisplayString(expr), 9 /* TEXT, PROPS */, _hoisted_107));\n                                                                }), 128 /* KEYED_FRAGMENT */))\n                                                            ], 8 /* PROPS */, _hoisted_105), [\n                                                                [_vModelSelect, cfg.live2dExpression]\n                                                            ]),\n                                                            _createElementVNode(\"select\", {\n                                                                value: getMotionOverrideValue(cfg),\n                                                                disabled: !cfg.live2dMotion.enabled,\n                                                                onChange: ($event) => (onMotionOverrideChange(cfg, $event))\n                                                            }, [\n                                                                _cache[140] || (_cache[140] = _createElementVNode(\"option\", { value: \"\" }, \"\", -1 /* CACHED */)),\n                                                                (getMotionOverrideValue(cfg) && !live2dMotionOptionSet.value.has(getMotionOverrideValue(cfg)))\n                                                                    ? (_openBlock(), _createElementBlock(\"option\", {\n                                                                        key: 0,\n                                                                        value: getMotionOverrideValue(cfg)\n                                                                    }, _toDisplayString(getMotionOverrideLabel(cfg)) + \" \", 9 /* TEXT, PROPS */, _hoisted_109))\n                                                                    : _createCommentVNode(\"v-if\", true),\n                                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(live2dMotionSelectOptions.value, (opt) => {\n                                                                    return (_openBlock(), _createElementBlock(\"option\", {\n                                                                        key: opt.key,\n                                                                        value: opt.value\n                                                                    }, _toDisplayString(opt.label), 9 /* TEXT, PROPS */, _hoisted_110));\n                                                                }), 128 /* KEYED_FRAGMENT */))\n                                                            ], 40 /* PROPS, NEED_HYDRATION */, _hoisted_108),\n                                                            _createElementVNode(\"button\", {\n                                                                class: \"btn btn-secondary emotion-map-preview-btn\",\n                                                                type: \"button\",\n                                                                title: \"\",\n                                                                onClick: ($event) => (previewEmotion(cfg.tag))\n                                                            }, \"  \", 8 /* PROPS */, _hoisted_111)\n                                                        ]));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]),\n                                                _cache[148] || (_cache[148] = _createElementVNode(\"div\", { class: \"hint\" }, \" Expressions Motions\", -1 /* CACHED */)),\n                                                (showEmotionAdvanced.value)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_112, [\n                                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(settings).emotionConfigs, (cfg) => {\n                                                            return (_openBlock(), _createElementBlock(\"div\", {\n                                                                key: `advanced_${cfg.tag}`,\n                                                                class: \"emotion-advanced-item\"\n                                                            }, [\n                                                                _createElementVNode(\"div\", _hoisted_113, _toDisplayString(cfg.tag) + \"  \", 1 /* TEXT */),\n                                                                _createElementVNode(\"div\", _hoisted_114, [\n                                                                    _createElementVNode(\"div\", _hoisted_115, [\n                                                                        _cache[143] || (_cache[143] = _createElementVNode(\"label\", null, \"raw tag  \", -1 /* CACHED */)),\n                                                                        _createElementVNode(\"input\", {\n                                                                            type: \"text\",\n                                                                            value: (cfg.aliases || []).join(', '),\n                                                                            onBlur: ($event) => (onAliasesBlur(cfg, $event)),\n                                                                            placeholder: \", smile\"\n                                                                        }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_116),\n                                                                        _cache[144] || (_cache[144] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                                                    ]),\n                                                                    _createElementVNode(\"div\", _hoisted_117, [\n                                                                        _cache[145] || (_cache[145] = _createElementVNode(\"label\", null, \"TTS \", -1 /* CACHED */)),\n                                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                                            type: \"text\",\n                                                                            \"onUpdate:modelValue\": ($event) => ((cfg.ttsContext) = $event),\n                                                                            placeholder: \"\"\n                                                                        }, null, 8 /* PROPS */, _hoisted_118), [\n                                                                            [_vModelText, cfg.ttsContext]\n                                                                        ]),\n                                                                        _cache[146] || (_cache[146] = _createElementVNode(\"div\", { class: \"hint\" }, \" |  contextTexts  TTS\", -1 /* CACHED */))\n                                                                    ])\n                                                                ]),\n                                                                _createElementVNode(\"div\", _hoisted_119, [\n                                                                    _createElementVNode(\"label\", null, [\n                                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                                            type: \"checkbox\",\n                                                                            \"onUpdate:modelValue\": ($event) => ((cfg.live2dMotion.enabled) = $event)\n                                                                        }, null, 8 /* PROPS */, _hoisted_120), [\n                                                                            [_vModelCheckbox, cfg.live2dMotion.enabled]\n                                                                        ]),\n                                                                        _cache[147] || (_cache[147] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                                                    ])\n                                                                ])\n                                                            ]));\n                                                        }), 128 /* KEYED_FRAGMENT */))\n                                                    ]))\n                                                    : _createCommentVNode(\"v-if\", true)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_121, [\n                                                _createElementVNode(\"div\", _hoisted_122, [\n                                                    _cache[149] || (_cache[149] = _createElementVNode(\"span\", { class: \"emotion-preview-title\" }, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"span\", _hoisted_123, \": \" + _toDisplayString(previewTag.value), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"div\", {\n                                                    class: \"emotion-preview-canvas\",\n                                                    ref_key: \"live2dPreviewMountEl\",\n                                                    ref: live2dPreviewMountEl\n                                                }, [\n                                                    _createElementVNode(\"div\", {\n                                                        class: \"emotion-preview-interact\",\n                                                        ref_key: \"live2dPreviewInteractEl\",\n                                                        ref: live2dPreviewInteractEl\n                                                    }, null, 512 /* NEED_PATCH */),\n                                                    (!_unref(Live2DManager).model)\n                                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_124, \"\"))\n                                                        : _createCommentVNode(\"v-if\", true)\n                                                ], 512 /* NEED_PATCH */),\n                                                _createElementVNode(\"div\", _hoisted_125, [\n                                                    _createElementVNode(\"div\", _hoisted_126, [\n                                                        _cache[150] || (_cache[150] = _createElementVNode(\"span\", { class: \"zoom-label\" }, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            class: \"zoom-slider\",\n                                                            type: \"range\",\n                                                            min: \"0.5\",\n                                                            max: \"4\",\n                                                            step: \"0.05\",\n                                                            \"onUpdate:modelValue\": _cache[41] || (_cache[41] = ($event) => ((previewZoomFactor).value = $event)),\n                                                            onInput: applyPreviewViewport\n                                                        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                previewZoomFactor.value,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ]),\n                                                        _createElementVNode(\"span\", _hoisted_127, _toDisplayString(Math.round(previewZoomFactor.value * 100)) + \"%\", 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"div\", { class: \"emotion-preview-actions\" }, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: resetPreviewViewport\n                                                        }, \"\"),\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: replayPreview\n                                                        }, \"\")\n                                                    ]),\n                                                    _cache[151] || (_cache[151] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"div\", {\n                                                        class: \"hint\",\n                                                        title: previewStatus.value\n                                                    }, _toDisplayString(previewStatus.value), 9 /* TEXT, PROPS */, _hoisted_128)\n                                                ])\n                                            ])\n                                        ])\n                                    ], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'expression']\n                                    ]),\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_129, [\n                                        _cache[185] || (_cache[185] = _createElementVNode(\"h4\", null, [\n                                            _createElementVNode(\"span\", { class: \"section-index\" }, \"05\"),\n                                            _createElementVNode(\"span\", { class: \"section-label\" }, \"TTS \"),\n                                            _createElementVNode(\"span\", { class: \"section-sub\" }, \"VOICE CONTROL\")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_130, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[42] || (_cache[42] = ($event) => ((ttsEnabled).value = $event)),\n                                                    onChange: onToggleTtsEnabled\n                                                }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                                    [_vModelCheckbox, ttsEnabled.value]\n                                                ]),\n                                                _cache[153] || (_cache[153] = _createTextVNode(\"  TTS  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[154] || (_cache[154] = _createElementVNode(\"div\", { class: \"hint\" }, \"/\", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_131, [\n                                            _cache[155] || (_cache[155] = _createElementVNode(\"label\", null, \"TTS \", -1 /* CACHED */)),\n                                            _withDirectives(_createElementVNode(\"select\", {\n                                                \"onUpdate:modelValue\": _cache[43] || (_cache[43] = ($event) => ((_unref(settings).ttsProvider) = $event))\n                                            }, [\n                                                _createElementVNode(\"option\", {\n                                                    value: _unref(TTS_PROVIDER).LITTLEWHITEBOX\n                                                }, \"X\", 8 /* PROPS */, _hoisted_132),\n                                                _createElementVNode(\"option\", {\n                                                    value: _unref(TTS_PROVIDER).GPT_SOVITS_V2\n                                                }, \"GPT-SoVITS v2ProPlus\", 8 /* PROPS */, _hoisted_133),\n                                                _createElementVNode(\"option\", {\n                                                    value: _unref(TTS_PROVIDER).EDGE_TTS_DIRECT\n                                                }, \"EdgeTTSEdge\", 8 /* PROPS */, _hoisted_134)\n                                            ], 512 /* NEED_PATCH */), [\n                                                [_vModelSelect, _unref(settings).ttsProvider]\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_135, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[44] || (_cache[44] = ($event) => ((_unref(settings).ttsAutoPlay) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).ttsAutoPlay]\n                                                ]),\n                                                _cache[156] || (_cache[156] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_136, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[45] || (_cache[45] = ($event) => ((_unref(settings).phoneMessageAutoRead) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).phoneMessageAutoRead]\n                                                ]),\n                                                _cache[157] || (_cache[157] = _createTextVNode(\"  NPC  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[158] || (_cache[158] = _createElementVNode(\"div\", { class: \"hint\" }, \" sender=contact  type=text \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_137, [\n                                            _createElementVNode(\"label\", null, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"checkbox\",\n                                                    \"onUpdate:modelValue\": _cache[46] || (_cache[46] = ($event) => ((_unref(settings).baibaiPhoneMessageAutoRead) = $event))\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelCheckbox, _unref(settings).baibaiPhoneMessageAutoRead]\n                                                ]),\n                                                _cache[159] || (_cache[159] = _createTextVNode(\"  NPC  \", -1 /* CACHED */))\n                                            ]),\n                                            _cache[160] || (_cache[160] = _createElementVNode(\"div\", { class: \"hint\" }, \" qq.private / qq.group  NPC \", -1 /* CACHED */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_138, [\n                                            _cache[162] || (_cache[162] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_139, [\n                                                _withDirectives(_createElementVNode(\"select\", {\n                                                    \"onUpdate:modelValue\": _cache[47] || (_cache[47] = ($event) => ((_unref(settings).ttsDefaultSpeaker) = $event))\n                                                }, [\n                                                    _cache[161] || (_cache[161] = _createElementVNode(\"option\", { value: \"\" }, \"\", -1 /* CACHED */)),\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(ttsVoiceList.value, (v) => {\n                                                        return (_openBlock(), _createElementBlock(\"option\", {\n                                                            key: v.name,\n                                                            value: v.name\n                                                        }, _toDisplayString(v.name) + _toDisplayString(v.desc ? ' (' + v.desc + ')' : ''), 9 /* TEXT, PROPS */, _hoisted_140));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ], 512 /* NEED_PATCH */), [\n                                                    [_vModelSelect, _unref(settings).ttsDefaultSpeaker]\n                                                ]),\n                                                _createElementVNode(\"button\", {\n                                                    class: \"input-btn\",\n                                                    type: \"button\",\n                                                    onClick: refreshTtsVoices,\n                                                    disabled: refreshingTtsVoices.value\n                                                }, _toDisplayString(refreshingTtsVoices.value ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_141)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_142, _toDisplayString(ttsVoiceHint.value), 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", {\n                                            class: \"advanced-toggle\",\n                                            onClick: _cache[48] || (_cache[48] = ($event) => (showLipSyncAdvanced.value = !showLipSyncAdvanced.value))\n                                        }, [\n                                            _createElementVNode(\"span\", _hoisted_143, _toDisplayString(showLipSyncAdvanced.value ? '' : ''), 1 /* TEXT */),\n                                            _cache[163] || (_cache[163] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                        ]),\n                                        (showLipSyncAdvanced.value)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_144, [\n                                                _createElementVNode(\"div\", _hoisted_145, [\n                                                    _createElementVNode(\"label\", null, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"checkbox\",\n                                                            \"onUpdate:modelValue\": _cache[49] || (_cache[49] = ($event) => ((_unref(settings).lipSyncManualParamsEnabled) = $event))\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).lipSyncManualParamsEnabled]\n                                                        ]),\n                                                        _cache[164] || (_cache[164] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                                    ]),\n                                                    _cache[165] || (_cache[165] = _createElementVNode(\"div\", { class: \"hint\" }, \" Param58 / Param61\", -1 /* CACHED */))\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_146, [\n                                                    _cache[166] || (_cache[166] = _createElementVNode(\"label\", null, \" ID\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"textarea\", {\n                                                        \"onUpdate:modelValue\": _cache[50] || (_cache[50] = ($event) => ((lipSyncManualParamsText).value = $event)),\n                                                        rows: \"3\",\n                                                        placeholder: \"ParamMouthOpenY\\nParam58\",\n                                                        onBlur: applyLipSyncManualParams\n                                                    }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                                        [_vModelText, lipSyncManualParamsText.value]\n                                                    ]),\n                                                    _cache[167] || (_cache[167] = _createElementVNode(\"div\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                                ])\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        (_unref(settings).ttsProvider === _unref(TTS_PROVIDER).GPT_SOVITS_V2)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_147, [\n                                                _createElementVNode(\"div\", _hoisted_148, [\n                                                    _cache[168] || (_cache[168] = _createElementVNode(\"label\", null, \"API \", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"input\", {\n                                                        type: \"text\",\n                                                        \"onUpdate:modelValue\": _cache[51] || (_cache[51] = ($event) => ((_unref(settings).gptSoVits.apiUrl) = $event)),\n                                                        placeholder: \"http://127.0.0.1:9880\"\n                                                    }, null, 512 /* NEED_PATCH */), [\n                                                        [_vModelText, _unref(settings).gptSoVits.apiUrl]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_149, [\n                                                    _createElementVNode(\"div\", _hoisted_150, [\n                                                        _cache[169] || (_cache[169] = _createElementVNode(\"label\", null, \"GPT-SoVITS \", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": _cache[52] || (_cache[52] = ($event) => ((_unref(settings).gptSoVits.rootDir) = $event)),\n                                                            placeholder: \"D:/GPT-SoVITS\",\n                                                            onChange: onGptRootDirChange\n                                                        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                                            [_vModelText, _unref(settings).gptSoVits.rootDir]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_151, [\n                                                        _cache[170] || (_cache[170] = _createElementVNode(\"label\", null, \" / \", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": _cache[53] || (_cache[53] = ($event) => ((_unref(settings).gptSoVits.importPathPrefix) = $event)),\n                                                            placeholder: \"D:/\",\n                                                            onChange: onGptImportPrefixChange\n                                                        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                                            [_vModelText, _unref(settings).gptSoVits.importPathPrefix]\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_152, [\n                                                    _createElementVNode(\"label\", null, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"checkbox\",\n                                                            \"onUpdate:modelValue\": _cache[54] || (_cache[54] = ($event) => ((_unref(settings).gptSoVits.useCorsProxy) = $event))\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).gptSoVits.useCorsProxy]\n                                                        ]),\n                                                        _cache[171] || (_cache[171] = _createTextVNode(\" /proxy \", -1 /* CACHED */))\n                                                    ]),\n                                                    _cache[172] || (_cache[172] = _createElementVNode(\"div\", { class: \"hint\" }, \" config \", -1 /* CACHED */))\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_153, [\n                                                    _createElementVNode(\"div\", _hoisted_154, [\n                                                        _cache[173] || (_cache[173] = _createElementVNode(\"label\", null, \"text_lang\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": _cache[55] || (_cache[55] = ($event) => ((_unref(settings).gptSoVits.textLang) = $event)),\n                                                            placeholder: \"auto/zh/en/ja...\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelText, _unref(settings).gptSoVits.textLang]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_155, [\n                                                        _cache[174] || (_cache[174] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": _cache[56] || (_cache[56] = ($event) => ((_unref(settings).gptSoVits.textSplitMethod) = $event)),\n                                                            placeholder: \"cut5\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelText, _unref(settings).gptSoVits.textSplitMethod]\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_156, [\n                                                    _createElementVNode(\"div\", _hoisted_157, [\n                                                        _cache[176] || (_cache[176] = _createElementVNode(\"label\", null, \"media_type\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"select\", {\n                                                            \"onUpdate:modelValue\": _cache[57] || (_cache[57] = ($event) => ((_unref(settings).gptSoVits.mediaType) = $event))\n                                                        }, [...(_cache[175] || (_cache[175] = [\n                                                                _createElementVNode(\"option\", { value: \"wav\" }, \"wav\", -1 /* CACHED */),\n                                                                _createElementVNode(\"option\", { value: \"ogg\" }, \"ogg\", -1 /* CACHED */),\n                                                                _createElementVNode(\"option\", { value: \"raw\" }, \"raw\", -1 /* CACHED */)\n                                                            ]))], 512 /* NEED_PATCH */), [\n                                                            [_vModelSelect, _unref(settings).gptSoVits.mediaType]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_158, [\n                                                        _createElementVNode(\"label\", null, [\n                                                            _withDirectives(_createElementVNode(\"input\", {\n                                                                type: \"checkbox\",\n                                                                \"onUpdate:modelValue\": _cache[58] || (_cache[58] = ($event) => ((_unref(settings).gptSoVits.streamingMode) = $event))\n                                                            }, null, 512 /* NEED_PATCH */), [\n                                                                [_vModelCheckbox, _unref(settings).gptSoVits.streamingMode]\n                                                            ]),\n                                                            _cache[177] || (_cache[177] = _createTextVNode(\" streaming_mode \", -1 /* CACHED */))\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_159, [\n                                                    _createElementVNode(\"div\", _hoisted_160, [\n                                                        _cache[178] || (_cache[178] = _createElementVNode(\"label\", null, \"speed_factor\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"number\",\n                                                            \"onUpdate:modelValue\": _cache[59] || (_cache[59] = ($event) => ((_unref(settings).gptSoVits.speedFactor) = $event)),\n                                                            min: \"0.5\",\n                                                            max: \"2\",\n                                                            step: \"0.05\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).gptSoVits.speedFactor,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_161, [\n                                                        _cache[180] || (_cache[180] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"select\", {\n                                                            \"onUpdate:modelValue\": _cache[60] || (_cache[60] = ($event) => ((_unref(settings).gptSoVits.modelSwitchMode) = $event)),\n                                                            onChange: onGptSwitchModeChange\n                                                        }, [...(_cache[179] || (_cache[179] = [\n                                                                _createElementVNode(\"option\", { value: \"set_weights\" }, \"set_weightsapi_v2.py\", -1 /* CACHED */),\n                                                                _createElementVNode(\"option\", { value: \"set_model\" }, \"set_modelapi.py\", -1 /* CACHED */),\n                                                                _createElementVNode(\"option\", { value: \"none\" }, \"\", -1 /* CACHED */)\n                                                            ]))], 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                                            [_vModelSelect, _unref(settings).gptSoVits.modelSwitchMode]\n                                                        ])\n                                                    ])\n                                                ]),\n                                                (isGptSetModelMode.value)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_162, [\n                                                        _cache[181] || (_cache[181] = _createElementVNode(\"label\", null, \"set_model endpoint\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": _cache[61] || (_cache[61] = ($event) => ((_unref(settings).gptSoVits.setModelEndpoint) = $event)),\n                                                            placeholder: \"/set_model\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelText, _unref(settings).gptSoVits.setModelEndpoint]\n                                                        ])\n                                                    ]))\n                                                    : _createCommentVNode(\"v-if\", true),\n                                                _createElementVNode(\"div\", _hoisted_163, [\n                                                    _createElementVNode(\"label\", null, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"checkbox\",\n                                                            \"onUpdate:modelValue\": _cache[62] || (_cache[62] = ($event) => ((_unref(settings).gptSoVits.strictWeightSwitch) = $event))\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).gptSoVits.strictWeightSwitch]\n                                                        ]),\n                                                        _cache[182] || (_cache[182] = _createTextVNode(\" strictWeightSwitch \", -1 /* CACHED */))\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_164, [\n                                                    _cache[183] || (_cache[183] = _createElementVNode(\"label\", null, \"v0.9\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"div\", _hoisted_165, _toDisplayString(gptModelSummaryHint.value), 1 /* TEXT */),\n                                                    _createElementVNode(\"div\", _hoisted_166, [\n                                                        _createElementVNode(\"div\", { class: \"form-group half\" }, [\n                                                            _createElementVNode(\"button\", {\n                                                                class: \"btn btn-secondary\",\n                                                                type: \"button\",\n                                                                onClick: openGptModelManager\n                                                            }, \"\")\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_167, [\n                                                            _createElementVNode(\"button\", {\n                                                                class: \"btn btn-secondary\",\n                                                                type: \"button\",\n                                                                onClick: refreshTtsVoices,\n                                                                disabled: refreshingTtsVoices.value\n                                                            }, _toDisplayString(refreshingTtsVoices.value ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_168)\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_169, [\n                                                        _createElementVNode(\"div\", _hoisted_170, [\n                                                            _createElementVNode(\"button\", {\n                                                                class: \"btn btn-test\",\n                                                                type: \"button\",\n                                                                onClick: testTts,\n                                                                disabled: !ttsEnabled.value\n                                                            }, \"\", 8 /* PROPS */, _hoisted_171)\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_172, [\n                                                            _withDirectives(_createElementVNode(\"input\", {\n                                                                type: \"text\",\n                                                                \"onUpdate:modelValue\": _cache[63] || (_cache[63] = ($event) => ((ttsTestText).value = $event)),\n                                                                placeholder: \"\"\n                                                            }, null, 512 /* NEED_PATCH */), [\n                                                                [_vModelText, ttsTestText.value]\n                                                            ])\n                                                        ])\n                                                    ]),\n                                                    _cache[184] || (_cache[184] = _createElementVNode(\"div\", { class: \"hint\" }, \" JSON //\", -1 /* CACHED */))\n                                                ])\n                                            ]))\n                                            : (_openBlock(), _createElementBlock(\"div\", _hoisted_173, [\n                                                _createElementVNode(\"button\", {\n                                                    class: \"btn btn-test\",\n                                                    type: \"button\",\n                                                    onClick: testTts,\n                                                    disabled: !ttsEnabled.value\n                                                }, \"\", 8 /* PROPS */, _hoisted_174),\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"text\",\n                                                    \"onUpdate:modelValue\": _cache[64] || (_cache[64] = ($event) => ((ttsTestText).value = $event)),\n                                                    placeholder: \"\"\n                                                }, null, 512 /* NEED_PATCH */), [\n                                                    [_vModelText, ttsTestText.value]\n                                                ])\n                                            ])),\n                                        _createElementVNode(\"div\", { class: \"form-group\" }, [\n                                            _createElementVNode(\"button\", {\n                                                class: \"btn btn-secondary\",\n                                                type: \"button\",\n                                                onClick: stopTts\n                                            }, \"\")\n                                        ])\n                                    ], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'tts']\n                                    ]),\n                                    _withDirectives(_createElementVNode(\"section\", _hoisted_175, [...(_cache[186] || (_cache[186] = [\n                                            _createStaticVNode(\"<h4 data-v-216a7ce1><span class=\\\"section-index\\\" data-v-216a7ce1>06</span><span class=\\\"section-label\\\" data-v-216a7ce1></span><span class=\\\"section-sub\\\" data-v-216a7ce1>ABOUT &amp; LICENSE</span></h4><div class=\\\"about-card\\\" data-v-216a7ce1><div class=\\\"about-title\\\" data-v-216a7ce1></div><a class=\\\"about-link\\\" href=\\\"https://discord.com/channels/1134557553011998840/1472242483806077061\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\" data-v-216a7ce1> https://discord.com/channels/1134557553011998840/1472242483806077061 </a></div><div class=\\\"about-card\\\" data-v-216a7ce1><div class=\\\"about-title\\\" data-v-216a7ce1></div><ul class=\\\"about-list\\\" data-v-216a7ce1><li data-v-216a7ce1>  Live2D  </li><li data-v-216a7ce1></li><li data-v-216a7ce1>  <a class=\\\"about-link\\\" href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\" data-v-216a7ce1> CC BY-NC-SA 4.0 </a> -- </li><li data-v-216a7ce1></li></ul></div>\", 3)\n                                        ]))], 512 /* NEED_PATCH */), [\n                                        [_vShow, activeSection.value === 'about']\n                                    ])\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", { class: \"panel-footer\" }, [\n                                _createElementVNode(\"button\", {\n                                    class: \"btn btn-secondary\",\n                                    type: \"button\",\n                                    onClick: resetSettings\n                                }, \"\"),\n                                _createElementVNode(\"button\", {\n                                    class: \"btn btn-primary\",\n                                    type: \"button\",\n                                    onClick: close\n                                }, \"\")\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (showGptModelManager.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 1,\n                        class: \"browser-overlay dp-browser-overlay gpt-model-overlay\",\n                        style: overlayFallbackStyle,\n                        onClick: _withModifiers(closeGptModelManager, [\"self\"])\n                    }, [\n                        _createElementVNode(\"div\", {\n                            class: \"browser-dialog dp-browser-dialog gpt-model-dialog\",\n                            style: panelFallbackStyle\n                        }, [\n                            _createElementVNode(\"div\", { class: \"browser-dialog-header gpt-model-header\" }, [\n                                _cache[187] || (_cache[187] = _createElementVNode(\"h3\", null, \"GPT-SoVITS v0.9\", -1 /* CACHED */)),\n                                _createElementVNode(\"div\", { class: \"gpt-model-header-actions\" }, [\n                                    _createElementVNode(\"button\", {\n                                        class: \"btn btn-secondary\",\n                                        type: \"button\",\n                                        onClick: openGptModelManagerImportJson\n                                    }, \"JSON\"),\n                                    _createElementVNode(\"button\", {\n                                        class: \"btn btn-secondary\",\n                                        type: \"button\",\n                                        onClick: openGptModelManagerImportFolder\n                                    }, \"\"),\n                                    _createElementVNode(\"button\", {\n                                        class: \"btn btn-secondary\",\n                                        type: \"button\",\n                                        onClick: exportGptModelManagerModels\n                                    }, \"JSON\"),\n                                    _createElementVNode(\"button\", {\n                                        class: \"btn btn-secondary\",\n                                        type: \"button\",\n                                        onClick: addGptModelManagerModel\n                                    }, \"\"),\n                                    _createElementVNode(\"button\", {\n                                        class: \"close-btn\",\n                                        type: \"button\",\n                                        onClick: closeGptModelManager\n                                    }, \"X\")\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_176, [\n                                _createElementVNode(\"div\", _hoisted_177, [\n                                    _withDirectives(_createElementVNode(\"input\", {\n                                        type: \"text\",\n                                        \"onUpdate:modelValue\": _cache[65] || (_cache[65] = ($event) => ((gptModelManagerSearch).value = $event)),\n                                        placeholder: \" /  / ID \"\n                                    }, null, 512 /* NEED_PATCH */), [\n                                        [_vModelText, gptModelManagerSearch.value]\n                                    ]),\n                                    _createElementVNode(\"button\", {\n                                        class: \"btn btn-secondary\",\n                                        type: \"button\",\n                                        onClick: saveGptModelManager\n                                    }, \"\"),\n                                    _createElementVNode(\"button\", {\n                                        class: \"btn btn-primary\",\n                                        type: \"button\",\n                                        onClick: saveGptModelManagerAndClose\n                                    }, \"\")\n                                ]),\n                                _createElementVNode(\"input\", {\n                                    ref_key: \"gptModelManagerImportJsonInputRef\",\n                                    ref: gptModelManagerImportJsonInputRef,\n                                    type: \"file\",\n                                    accept: \".json,application/json\",\n                                    style: { \"display\": \"none\" },\n                                    onChange: onGptModelManagerImportJsonChange\n                                }, null, 544 /* NEED_HYDRATION, NEED_PATCH */),\n                                _createElementVNode(\"input\", {\n                                    ref_key: \"gptModelManagerImportFolderInputRef\",\n                                    ref: gptModelManagerImportFolderInputRef,\n                                    type: \"file\",\n                                    webkitdirectory: \"\",\n                                    directory: \"\",\n                                    multiple: \"\",\n                                    style: { \"display\": \"none\" },\n                                    onChange: onGptModelManagerImportFolderChange\n                                }, null, 544 /* NEED_HYDRATION, NEED_PATCH */),\n                                (filteredGptModelManagerModels.value.length === 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_178, \" JSON/ \"))\n                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_179, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredGptModelManagerModels.value, (model) => {\n                                            return (_openBlock(), _createElementBlock(\"div\", {\n                                                key: model.id,\n                                                class: \"gpt-model-card\"\n                                            }, [\n                                                _createElementVNode(\"div\", _hoisted_180, [\n                                                    _createElementVNode(\"label\", null, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"checkbox\",\n                                                            \"onUpdate:modelValue\": ($event) => ((model.enabled) = $event)\n                                                        }, null, 8 /* PROPS */, _hoisted_181), [\n                                                            [_vModelCheckbox, model.enabled]\n                                                        ]),\n                                                        _cache[188] || (_cache[188] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                                    ]),\n                                                    _createElementVNode(\"span\", _hoisted_182, _toDisplayString(model.id), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_183, [\n                                                    _createElementVNode(\"div\", _hoisted_184, [\n                                                        _cache[189] || (_cache[189] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((model.name) = $event),\n                                                            placeholder: \"\"\n                                                        }, null, 8 /* PROPS */, _hoisted_185), [\n                                                            [_vModelText, model.name]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_186, [\n                                                        _cache[190] || (_cache[190] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((model.desc) = $event),\n                                                            placeholder: \"\"\n                                                        }, null, 8 /* PROPS */, _hoisted_187), [\n                                                            [_vModelText, model.desc]\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_188, [\n                                                    _createElementVNode(\"div\", _hoisted_189, [\n                                                        _cache[191] || (_cache[191] = _createElementVNode(\"label\", null, \"GPT \", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((model.paths.gptWeightsPath) = $event),\n                                                            placeholder: \"GPT_weights/xxx.ckpt\"\n                                                        }, null, 8 /* PROPS */, _hoisted_190), [\n                                                            [_vModelText, model.paths.gptWeightsPath]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_191, [\n                                                        _cache[192] || (_cache[192] = _createElementVNode(\"label\", null, \"SoVITS \", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((model.paths.sovitsWeightsPath) = $event),\n                                                            placeholder: \"SoVITS_weights/xxx.pth\"\n                                                        }, null, 8 /* PROPS */, _hoisted_192), [\n                                                            [_vModelText, model.paths.sovitsWeightsPath]\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_193, [\n                                                    _createElementVNode(\"div\", _hoisted_194, [\n                                                        _cache[194] || (_cache[194] = _createElementVNode(\"label\", null, \" ID\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"select\", {\n                                                            \"onUpdate:modelValue\": ($event) => ((model.defaultRefId) = $event)\n                                                        }, [\n                                                            _cache[193] || (_cache[193] = _createElementVNode(\"option\", { value: \"\" }, \"\", -1 /* CACHED */)),\n                                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(model.refAudios, (refAudio) => {\n                                                                return (_openBlock(), _createElementBlock(\"option\", {\n                                                                    key: refAudio.id,\n                                                                    value: refAudio.id\n                                                                }, _toDisplayString(refAudio.id) + \"\" + _toDisplayString(refAudio.name || '') + \" \", 9 /* TEXT, PROPS */, _hoisted_196));\n                                                            }), 128 /* KEYED_FRAGMENT */))\n                                                        ], 8 /* PROPS */, _hoisted_195), [\n                                                            [_vModelSelect, model.defaultRefId]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_197, [\n                                                        _cache[195] || (_cache[195] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((model.paths.defaultRefAudioPath) = $event),\n                                                            placeholder: \"wavs/xxx.wav\"\n                                                        }, null, 8 /* PROPS */, _hoisted_198), [\n                                                            [_vModelText, model.paths.defaultRefAudioPath]\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_199, \"  \" + _toDisplayString(model.refAudios.length) + \"  \" + _toDisplayString(Object.keys(model.expressionRefMap || {}).length) + \"  \", 1 /* TEXT */),\n                                                _createElementVNode(\"div\", _hoisted_200, [\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-secondary\",\n                                                        type: \"button\",\n                                                        onClick: ($event) => (openGptModelEditor(model.id))\n                                                    }, \" / \", 8 /* PROPS */, _hoisted_201),\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-secondary\",\n                                                        type: \"button\",\n                                                        onClick: ($event) => (setGptModelManagerDefaultSpeaker(model))\n                                                    }, \"  \", 8 /* PROPS */, _hoisted_202),\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-test\",\n                                                        type: \"button\",\n                                                        onClick: ($event) => (testGptModelManagerModel(model.id))\n                                                    }, \"  \", 8 /* PROPS */, _hoisted_203),\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-secondary\",\n                                                        type: \"button\",\n                                                        onClick: ($event) => (duplicateGptModelManagerModel(model.id))\n                                                    }, \"\", 8 /* PROPS */, _hoisted_204),\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn btn-secondary\",\n                                                        type: \"button\",\n                                                        onClick: ($event) => (removeGptModelManagerModel(model.id))\n                                                    }, \"\", 8 /* PROPS */, _hoisted_205)\n                                                ])\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ]))\n                            ]),\n                            _createElementVNode(\"div\", { class: \"panel-footer\" }, [\n                                _createElementVNode(\"button\", {\n                                    class: \"btn btn-secondary\",\n                                    type: \"button\",\n                                    onClick: closeGptModelManager\n                                }, \"\"),\n                                _createElementVNode(\"button\", {\n                                    class: \"btn btn-secondary\",\n                                    type: \"button\",\n                                    onClick: saveGptModelManager\n                                }, \"\"),\n                                _createElementVNode(\"button\", {\n                                    class: \"btn btn-primary\",\n                                    type: \"button\",\n                                    onClick: saveGptModelManagerAndClose\n                                }, \"\")\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (showGptModelEditor.value && gptModelEditor.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 2,\n                        class: \"browser-overlay dp-browser-overlay gpt-model-overlay\",\n                        style: overlayFallbackStyle,\n                        onClick: _withModifiers(closeGptModelEditor, [\"self\"])\n                    }, [\n                        _createElementVNode(\"div\", {\n                            class: \"browser-dialog dp-browser-dialog gpt-model-editor-dialog\",\n                            style: panelFallbackStyle\n                        }, [\n                            _createElementVNode(\"div\", _hoisted_206, [\n                                _createElementVNode(\"h3\", null, \"\" + _toDisplayString(gptModelEditor.value.name || gptModelEditor.value.id), 1 /* TEXT */),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-btn\",\n                                    type: \"button\",\n                                    onClick: closeGptModelEditor\n                                }, \"X\")\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_207, [\n                                _createElementVNode(\"div\", _hoisted_208, [\n                                    _createElementVNode(\"div\", _hoisted_209, [\n                                        _cache[196] || (_cache[196] = _createElementVNode(\"label\", null, \"ID\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[66] || (_cache[66] = ($event) => ((gptModelEditor.value.id) = $event)),\n                                            placeholder: \"model_xxx\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.id]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_210, [\n                                        _createElementVNode(\"label\", null, [\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"checkbox\",\n                                                \"onUpdate:modelValue\": _cache[67] || (_cache[67] = ($event) => ((gptModelEditor.value.enabled) = $event))\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [_vModelCheckbox, gptModelEditor.value.enabled]\n                                            ]),\n                                            _cache[197] || (_cache[197] = _createTextVNode(\"  \", -1 /* CACHED */))\n                                        ])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_211, [\n                                    _createElementVNode(\"div\", _hoisted_212, [\n                                        _cache[198] || (_cache[198] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[68] || (_cache[68] = ($event) => ((gptModelEditor.value.name) = $event)),\n                                            placeholder: \"\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.name]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_213, [\n                                        _cache[199] || (_cache[199] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[69] || (_cache[69] = ($event) => ((gptModelEditor.value.desc) = $event)),\n                                            placeholder: \"\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.desc]\n                                        ])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_214, [\n                                    _createElementVNode(\"div\", _hoisted_215, [\n                                        _cache[200] || (_cache[200] = _createElementVNode(\"label\", null, \"GPT \", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[70] || (_cache[70] = ($event) => ((gptModelEditor.value.paths.gptWeightsPath) = $event)),\n                                            placeholder: \"GPT_weights/xxx.ckpt\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.paths.gptWeightsPath]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_216, [\n                                        _cache[201] || (_cache[201] = _createElementVNode(\"label\", null, \"SoVITS \", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[71] || (_cache[71] = ($event) => ((gptModelEditor.value.paths.sovitsWeightsPath) = $event)),\n                                            placeholder: \"SoVITS_weights/xxx.pth\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.paths.sovitsWeightsPath]\n                                        ])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_217, [\n                                    _createElementVNode(\"div\", _hoisted_218, [\n                                        _cache[202] || (_cache[202] = _createElementVNode(\"label\", null, \"prompt_text\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[72] || (_cache[72] = ($event) => ((gptModelEditor.value.params.promptText) = $event)),\n                                            placeholder: \"\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.params.promptText]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_219, [\n                                        _cache[203] || (_cache[203] = _createElementVNode(\"label\", null, \"prompt_lang\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[73] || (_cache[73] = ($event) => ((gptModelEditor.value.params.promptLang) = $event)),\n                                            placeholder: \"zh\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.params.promptLang]\n                                        ])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_220, [\n                                    _createElementVNode(\"div\", _hoisted_221, [\n                                        _cache[204] || (_cache[204] = _createElementVNode(\"label\", null, \"text_lang\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[74] || (_cache[74] = ($event) => ((gptModelEditor.value.params.textLang) = $event)),\n                                            placeholder: \"auto/zh/en/ja...\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.params.textLang]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_222, [\n                                        _cache[205] || (_cache[205] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[75] || (_cache[75] = ($event) => ((gptModelEditor.value.params.textSplitMethod) = $event)),\n                                            placeholder: \"cut5\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.params.textSplitMethod]\n                                        ])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_223, [\n                                    _createElementVNode(\"div\", _hoisted_224, [\n                                        _cache[206] || (_cache[206] = _createElementVNode(\"label\", null, \"speed_factor\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"number\",\n                                            \"onUpdate:modelValue\": _cache[76] || (_cache[76] = ($event) => ((gptModelEditor.value.params.speedFactor) = $event)),\n                                            min: \"0.5\",\n                                            max: \"2\",\n                                            step: \"0.05\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [\n                                                _vModelText,\n                                                gptModelEditor.value.params.speedFactor,\n                                                void 0,\n                                                { number: true }\n                                            ]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_225, [\n                                        _cache[208] || (_cache[208] = _createElementVNode(\"label\", null, \"media_type\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"select\", {\n                                            \"onUpdate:modelValue\": _cache[77] || (_cache[77] = ($event) => ((gptModelEditor.value.params.mediaType) = $event))\n                                        }, [...(_cache[207] || (_cache[207] = [\n                                                _createElementVNode(\"option\", { value: \"wav\" }, \"wav\", -1 /* CACHED */),\n                                                _createElementVNode(\"option\", { value: \"ogg\" }, \"ogg\", -1 /* CACHED */),\n                                                _createElementVNode(\"option\", { value: \"raw\" }, \"raw\", -1 /* CACHED */)\n                                            ]))], 512 /* NEED_PATCH */), [\n                                            [_vModelSelect, gptModelEditor.value.params.mediaType]\n                                        ])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_226, [\n                                    _createElementVNode(\"div\", _hoisted_227, [\n                                        _createElementVNode(\"label\", null, [\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"checkbox\",\n                                                \"onUpdate:modelValue\": _cache[78] || (_cache[78] = ($event) => ((gptModelEditor.value.params.streamingMode) = $event))\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [_vModelCheckbox, gptModelEditor.value.params.streamingMode]\n                                            ]),\n                                            _cache[209] || (_cache[209] = _createTextVNode(\" streaming_mode \", -1 /* CACHED */))\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_228, [\n                                        _createElementVNode(\"label\", null, [\n                                            _withDirectives(_createElementVNode(\"input\", {\n                                                type: \"checkbox\",\n                                                \"onUpdate:modelValue\": _cache[79] || (_cache[79] = ($event) => ((gptModelEditor.value.params.strictWeightSwitch) = $event))\n                                            }, null, 512 /* NEED_PATCH */), [\n                                                [_vModelCheckbox, gptModelEditor.value.params.strictWeightSwitch]\n                                            ]),\n                                            _cache[210] || (_cache[210] = _createTextVNode(\" strictWeightSwitch \", -1 /* CACHED */))\n                                        ])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_229, [\n                                    _createElementVNode(\"div\", _hoisted_230, [\n                                        _cache[212] || (_cache[212] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"select\", {\n                                            \"onUpdate:modelValue\": _cache[80] || (_cache[80] = ($event) => ((gptModelEditor.value.params.modelSwitchMode) = $event))\n                                        }, [...(_cache[211] || (_cache[211] = [\n                                                _createElementVNode(\"option\", { value: \"set_weights\" }, \"set_weights\", -1 /* CACHED */),\n                                                _createElementVNode(\"option\", { value: \"set_model\" }, \"set_model\", -1 /* CACHED */),\n                                                _createElementVNode(\"option\", { value: \"none\" }, \"none\", -1 /* CACHED */)\n                                            ]))], 512 /* NEED_PATCH */), [\n                                            [_vModelSelect, gptModelEditor.value.params.modelSwitchMode]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_231, [\n                                        _cache[213] || (_cache[213] = _createElementVNode(\"label\", null, \"set_model endpoint\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"text\",\n                                            \"onUpdate:modelValue\": _cache[81] || (_cache[81] = ($event) => ((gptModelEditor.value.params.setModelEndpoint) = $event)),\n                                            placeholder: \"/set_model\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, gptModelEditor.value.params.setModelEndpoint]\n                                        ])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_232, [\n                                    _cache[220] || (_cache[220] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_233, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(gptModelEditor.value.refAudios, (refAudio, refIndex) => {\n                                            return (_openBlock(), _createElementBlock(\"div\", {\n                                                key: `${refAudio.id || 'ref'}_${refIndex}`,\n                                                class: \"gpt-ref-item\"\n                                            }, [\n                                                _createElementVNode(\"div\", _hoisted_234, [\n                                                    _createElementVNode(\"div\", _hoisted_235, [\n                                                        _cache[214] || (_cache[214] = _createElementVNode(\"label\", null, \"ID\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((refAudio.id) = $event),\n                                                            placeholder: \"ref_1\"\n                                                        }, null, 8 /* PROPS */, _hoisted_236), [\n                                                            [_vModelText, refAudio.id]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_237, [\n                                                        _cache[215] || (_cache[215] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((refAudio.name) = $event),\n                                                            placeholder: \"\"\n                                                        }, null, 8 /* PROPS */, _hoisted_238), [\n                                                            [_vModelText, refAudio.name]\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_239, [\n                                                    _cache[216] || (_cache[216] = _createElementVNode(\"label\", null, \"\", -1 /* CACHED */)),\n                                                    _withDirectives(_createElementVNode(\"input\", {\n                                                        type: \"text\",\n                                                        \"onUpdate:modelValue\": ($event) => ((refAudio.path) = $event),\n                                                        placeholder: \"wavs/xxx.wav\"\n                                                    }, null, 8 /* PROPS */, _hoisted_240), [\n                                                        [_vModelText, refAudio.path]\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_241, [\n                                                    _createElementVNode(\"div\", _hoisted_242, [\n                                                        _cache[217] || (_cache[217] = _createElementVNode(\"label\", null, \"prompt_text\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((refAudio.promptText) = $event),\n                                                            placeholder: \"\"\n                                                        }, null, 8 /* PROPS */, _hoisted_243), [\n                                                            [_vModelText, refAudio.promptText]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_244, [\n                                                        _cache[218] || (_cache[218] = _createElementVNode(\"label\", null, \"prompt_lang\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((refAudio.promptLang) = $event),\n                                                            placeholder: \"zh\"\n                                                        }, null, 8 /* PROPS */, _hoisted_245), [\n                                                            [_vModelText, refAudio.promptLang]\n                                                        ])\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_246, [\n                                                    _createElementVNode(\"div\", _hoisted_247, [\n                                                        _cache[219] || (_cache[219] = _createElementVNode(\"label\", null, \"text_lang\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            type: \"text\",\n                                                            \"onUpdate:modelValue\": ($event) => ((refAudio.textLang) = $event),\n                                                            placeholder: \"zh\"\n                                                        }, null, 8 /* PROPS */, _hoisted_248), [\n                                                            [_vModelText, refAudio.textLang]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_249, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: ($event) => (setGptModelEditorDefaultRef(refAudio.id))\n                                                        }, \"  \", 8 /* PROPS */, _hoisted_250),\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"btn btn-secondary\",\n                                                            type: \"button\",\n                                                            onClick: ($event) => (removeGptModelEditorRefAudio(refIndex))\n                                                        }, \"  \", 8 /* PROPS */, _hoisted_251)\n                                                    ])\n                                                ])\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ]),\n                                    _createElementVNode(\"button\", {\n                                        class: \"btn btn-secondary\",\n                                        type: \"button\",\n                                        onClick: addGptModelEditorRefAudio\n                                    }, \"\")\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_252, [\n                                    _cache[222] || (_cache[222] = _createElementVNode(\"label\", null, \" -> ID\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_253, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(gptModelEditorExpressionRows.value, (row, rowIndex) => {\n                                            return (_openBlock(), _createElementBlock(\"div\", {\n                                                key: `expr_map_${rowIndex}`,\n                                                class: \"gpt-expression-map-row\"\n                                            }, [\n                                                _withDirectives(_createElementVNode(\"input\", {\n                                                    type: \"text\",\n                                                    \"onUpdate:modelValue\": ($event) => ((row.expression) = $event),\n                                                    placeholder: \"\"\n                                                }, null, 8 /* PROPS */, _hoisted_254), [\n                                                    [_vModelText, row.expression]\n                                                ]),\n                                                _withDirectives(_createElementVNode(\"select\", {\n                                                    \"onUpdate:modelValue\": ($event) => ((row.refId) = $event)\n                                                }, [\n                                                    _cache[221] || (_cache[221] = _createElementVNode(\"option\", { value: \"\" }, \"\", -1 /* CACHED */)),\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(gptModelEditor.value.refAudios, (refAudio) => {\n                                                        return (_openBlock(), _createElementBlock(\"option\", {\n                                                            key: refAudio.id,\n                                                            value: refAudio.id\n                                                        }, _toDisplayString(refAudio.id) + \"\" + _toDisplayString(refAudio.name || '') + \" \", 9 /* TEXT, PROPS */, _hoisted_256));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ], 8 /* PROPS */, _hoisted_255), [\n                                                    [_vModelSelect, row.refId]\n                                                ]),\n                                                _createElementVNode(\"button\", {\n                                                    class: \"btn btn-secondary\",\n                                                    type: \"button\",\n                                                    onClick: ($event) => (removeGptModelEditorExpressionRow(rowIndex))\n                                                }, \"  \", 8 /* PROPS */, _hoisted_257)\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ]),\n                                    _createElementVNode(\"button\", {\n                                        class: \"btn btn-secondary\",\n                                        type: \"button\",\n                                        onClick: addGptModelEditorExpressionRow\n                                    }, \"\")\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", { class: \"panel-footer\" }, [\n                                _createElementVNode(\"button\", {\n                                    class: \"btn btn-secondary\",\n                                    type: \"button\",\n                                    onClick: closeGptModelEditor\n                                }, \"\"),\n                                _createElementVNode(\"button\", {\n                                    class: \"btn btn-primary\",\n                                    type: \"button\",\n                                    onClick: saveGptModelEditor\n                                }, \"\")\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (showBrowser.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 3,\n                        class: \"browser-overlay dp-browser-overlay\",\n                        style: overlayFallbackStyle,\n                        onClick: _cache[84] || (_cache[84] = _withModifiers(($event) => (showBrowser.value = false), [\"self\"]))\n                    }, [\n                        _createElementVNode(\"div\", {\n                            class: \"browser-dialog dp-browser-dialog\",\n                            style: panelFallbackStyle\n                        }, [\n                            _createElementVNode(\"div\", _hoisted_258, [\n                                _cache[223] || (_cache[223] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-btn\",\n                                    type: \"button\",\n                                    onClick: _cache[82] || (_cache[82] = ($event) => (showBrowser.value = false))\n                                }, \"X\")\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_259, [\n                                _createVNode(ModelBrowser, {\n                                    \"use-cdn\": _unref(settings).useCdn,\n                                    onCancel: _cache[83] || (_cache[83] = ($event) => (showBrowser.value = false)),\n                                    onLoadModel: onBrowserLoad\n                                }, null, 8 /* PROPS */, [\"use-cdn\"])\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SettingsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SettingsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SettingsPanel.vue?vue&type=style&index=0&id=216a7ce1&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-216a7ce1\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createVNode as _createVNode, createElementVNode as _createElementVNode, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"browser-dialog\" };\nconst _hoisted_2 = { class: \"browser-dialog-header\" };\nconst _hoisted_3 = { class: \"browser-dialog-body\" };\nimport { storeToRefs } from 'pinia';\nimport { onMounted, onUnmounted, ref, watch } from 'vue';\nimport { getTTSEnabled } from '../audio/tts-config';\nimport { TTSManager } from '../audio/tts-manager';\nimport { Commentator } from '../chat/commentator';\nimport { parseEmotionCotText } from '../chat/emotion-cot';\nimport { ChatMonitor } from '../chat/monitor';\nimport { DEFAULTS, LOCAL_LIVE2D_MODEL_PATH_PREFIX } from '../core/constants';\nimport { getEmotionConfigByTag } from '../core/emotion';\nimport { useSettingsStore } from '../core/settings';\nimport { useUiStore } from '../core/ui';\nimport { hasLive2DModel } from '../db/live2d-models';\nimport { Live2DManager } from '../live2d/manager';\nimport { matchLive2DExpression, matchLive2DMotion } from '../live2d/expression-motion';\nimport { LipSyncManager, setLipSyncRefs } from '../live2d/lip-sync';\nimport { Live2DStage } from '../live2d/stage';\nimport { error as logError, log } from '../utils/dom';\nimport ChatBubble from './ChatBubble.vue';\nimport FunctionMenu from './FunctionMenu.vue';\nimport ModelBrowser from './ModelBrowser.vue';\nimport SettingsPanel from './SettingsPanel.vue';\nconst BASE_STAGE_WIDTH = 280;\nconst BASE_STAGE_HEIGHT = 360;\nconst OPEN_SETTINGS_FN_KEY = '__desktopPetOpenSettings_v2';\nconst PHONE_TTS_SEEN_MAX = 4000;\nconst BAIBAI_ASSISTANT_SEEN_MAX = 2000;\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'PetContainer',\n    setup(__props) {\n        const store = useSettingsStore();\n        const { settings } = storeToRefs(store);\n        const uiStore = useUiStore();\n        const { showSettings } = storeToRefs(uiStore);\n        const bubbleText = ref('');\n        const bubbleDone = ref(true);\n        let globalOpenSettingsFn = null;\n        let modelLoadTaskId = 0;\n        let modelLoadingHideTimer = null;\n        let statusCheckTimer = null;\n        let viewportResizeSyncTimer = null;\n        let boundWindowResizeHandler = null;\n        let boundVisualViewportResizeHandler = null;\n        let gazeFollowBound = false;\n        let gazePointerMoveHandler = null;\n        let gazePointerDownHandler = null;\n        let gazeFollowRafId = null;\n        let gazePendingPoint = null;\n        const showMenu = ref(false);\n        const menuAnchor = ref({ x: 0, y: 0 });\n        const menuPlacement = ref('left');\n        const showModelBrowser = ref(false);\n        let phoneTtsBridgeBound = false;\n        let phoneMessageReceivedHandler = null;\n        let phoneAIGenCompleteHandler = null;\n        let phoneTtsListenSinceSec = 0;\n        const phoneSeenMessageKeys = new Set();\n        const phoneSeenMessageOrder = [];\n        const phoneTtsQueue = [];\n        let phoneTtsQueueRunning = false;\n        let baibaiPhoneTtsBridgeBound = false;\n        let baibaiPhonePollTimer = null;\n        const baibaiEventStops = [];\n        const baibaiSeenAssistantIds = new Set();\n        const baibaiSeenAssistantOrder = [];\n        function getTopWindow() {\n            try {\n                return window.parent ?? window;\n            }\n            catch {\n                return window;\n            }\n        }\n        function getCurrentCharacterId() {\n            try {\n                const ctx = SillyTavern?.getContext?.();\n                if (ctx?.characterId !== undefined && ctx?.characterId !== null) {\n                    return String(ctx.characterId);\n                }\n            }\n            catch {\n                // ignore\n            }\n            return 'default';\n        }\n        function getPhoneStore() {\n            try {\n                const topAny = getTopWindow();\n                const store = topAny?.extension_settings?.acsusPawsPuffs?.phone;\n                if (store && typeof store === 'object')\n                    return store;\n            }\n            catch {\n                // ignore\n            }\n            try {\n                const localAny = window;\n                const store = localAny?.extension_settings?.acsusPawsPuffs?.phone;\n                if (store && typeof store === 'object')\n                    return store;\n            }\n            catch {\n                // ignore\n            }\n            return null;\n        }\n        function getPhoneContactName(source, contactId) {\n            const safeId = String(contactId || '').trim();\n            const fallback = safeId.replace(/^chat_/, '').replace(/^tavern_/, '').trim() || '';\n            if (source === 'baibai')\n                return fallback;\n            const store = getPhoneStore();\n            const contacts = Array.isArray(store?.contacts) ? store.contacts : [];\n            const matched = contacts.find((item) => String(item?.id || '').trim() === safeId);\n            const name = String(matched?.name || '').trim();\n            return name || fallback;\n        }\n        function getPhoneChatHistory(contactId) {\n            const store = getPhoneStore();\n            const key = `chat_${String(contactId || '').trim()}`;\n            const history = store?.chats?.[key];\n            return Array.isArray(history) ? history : [];\n        }\n        function isNonUserPhoneMessage(message) {\n            const sender = String(message?.sender || '')\n                .trim()\n                .toLowerCase();\n            const type = String(message?.type || 'text')\n                .trim()\n                .toLowerCase();\n            return sender === 'contact' && type === 'text';\n        }\n        function sanitizePhoneSpeakText(value) {\n            return String(value ?? '')\n                .replace(/\\s+/g, ' ')\n                .trim();\n        }\n        function isPhoneAutoReadEnabled(source) {\n            if (source === 'baibai') {\n                return settings.value.baibaiPhoneMessageAutoRead === true;\n            }\n            return settings.value.phoneMessageAutoRead !== false;\n        }\n        function getNormalizedUserNames() {\n            const names = new Set();\n            const append = (value) => {\n                const normalized = sanitizePhoneSpeakText(value).toLowerCase();\n                if (normalized)\n                    names.add(normalized);\n            };\n            try {\n                append(SillyTavern?.name1);\n            }\n            catch {\n                // ignore\n            }\n            try {\n                const ctx = SillyTavern?.getContext?.();\n                append(ctx?.name1);\n                append(ctx?.userName);\n            }\n            catch {\n                // ignore\n            }\n            append('user');\n            return names;\n        }\n        function isBaibaiUserSender(senderName) {\n            const sender = sanitizePhoneSpeakText(senderName).toLowerCase();\n            if (!sender)\n                return false;\n            return getNormalizedUserNames().has(sender);\n        }\n        function sanitizeAssistantPhoneCommandText(value) {\n            return String(value ?? '')\n                .replace(/<think[ing]*?>[\\s\\S]*?<\\/think[ing]*?>/gi, '')\n                .replace(/<!--[\\s\\S]*?-->/g, '')\n                .trim();\n        }\n        function hasBaibaiPhoneCommand(value) {\n            return /\\bqq\\.(?:private|group)\\s*\\(/i.test(String(value ?? ''));\n        }\n        function parseBaibaiCommandArgs(rawArgs) {\n            const source = String(rawArgs || '').trim();\n            if (!source)\n                return [];\n            const quotedArgs = [];\n            const quotedMatcher = /'([^']*)'|\"([^\"]*)\"/g;\n            for (const match of source.matchAll(quotedMatcher)) {\n                const value = sanitizePhoneSpeakText(match[1] ?? match[2] ?? '');\n                quotedArgs.push(value);\n            }\n            if (quotedArgs.length > 0)\n                return quotedArgs;\n            return source\n                .split(',')\n                .map((item) => sanitizePhoneSpeakText(item))\n                .filter((item) => !!item);\n        }\n        function extractBaibaiTextPayloads(rawPayload) {\n            const payload = String(rawPayload ?? '');\n            if (!payload)\n                return [];\n            const marker = payload.match(/\\[(.+?)-(.+?)\\]/);\n            if (!marker) {\n                const text = sanitizePhoneSpeakText(payload);\n                return text ? [text] : [];\n            }\n            const markerType = sanitizePhoneSpeakText(marker[1]).toLowerCase();\n            if (markerType === 'bqb' || markerType === 'img') {\n                const text = sanitizePhoneSpeakText(payload.replace(marker[0], ''));\n                return text ? [text] : [];\n            }\n            return [];\n        }\n        function extractPhoneSpeakText(message) {\n            const type = String(message?.type || 'text')\n                .trim()\n                .toLowerCase();\n            switch (type) {\n                case 'text': {\n                    let text = sanitizePhoneSpeakText(message.content);\n                    text = text.replace(/^\\[(?:|||)?\\]/, '').trim();\n                    return text;\n                }\n                case 'quote':\n                    return sanitizePhoneSpeakText(message.replyContent || message.content || '');\n                case 'emoji':\n                    return sanitizePhoneSpeakText(` ${message.content || ''}`);\n                case 'image':\n                case 'image-real':\n                case 'image-fake': {\n                    const desc = sanitizePhoneSpeakText(message.description || message.content || '');\n                    return desc ? `${desc}` : '';\n                }\n                case 'redpacket':\n                    return ` ${sanitizePhoneSpeakText(message.amount || 0)} `;\n                case 'transfer': {\n                    const amount = sanitizePhoneSpeakText(message.amount || 0);\n                    const note = sanitizePhoneSpeakText(message.message || message.content || '');\n                    return note ? ` ${amount}  ${note}` : ` ${amount} `;\n                }\n                case 'video':\n                    return sanitizePhoneSpeakText(` ${message.description || ''}`) || '';\n                case 'file':\n                    return sanitizePhoneSpeakText(` ${message.filename || ''}`) || '';\n                case 'poke':\n                    return '';\n                case 'recalled':\n                case 'recalled-pending':\n                    return '';\n                case 'friend_request':\n                case 'friend_added':\n                case 'friend_deleted':\n                    return sanitizePhoneSpeakText(message.content || '');\n                case 'gift-membership':\n                case 'buy-membership': {\n                    const months = sanitizePhoneSpeakText(message.months || '');\n                    const memberType = String(message.membershipType || '').toUpperCase() || '';\n                    return sanitizePhoneSpeakText(`${months ? `${months}` : ''}${memberType}`);\n                }\n                default:\n                    return sanitizePhoneSpeakText(message.content || message.description || '');\n            }\n        }\n        function getPhoneMessageKey(source, contactId, message) {\n            const safeContact = String(contactId || '').trim();\n            const messageId = sanitizePhoneSpeakText(message?.id);\n            if (messageId)\n                return `${source}:${safeContact}:${messageId}`;\n            const sender = sanitizePhoneSpeakText(message?.sender).toLowerCase() || 'unknown';\n            const type = sanitizePhoneSpeakText(message?.type).toLowerCase() || 'text';\n            const time = Number(message?.time || 0);\n            const content = sanitizePhoneSpeakText(message?.content || message?.replyContent || message?.description || message?.filename || '').slice(0, 72);\n            return `${source}:${safeContact}:${sender}:${type}:${time}:${content}`;\n        }\n        function rememberPhoneMessageKey(key) {\n            if (!key || phoneSeenMessageKeys.has(key))\n                return;\n            phoneSeenMessageKeys.add(key);\n            phoneSeenMessageOrder.push(key);\n            if (phoneSeenMessageOrder.length <= PHONE_TTS_SEEN_MAX)\n                return;\n            const stale = phoneSeenMessageOrder.shift();\n            if (stale) {\n                phoneSeenMessageKeys.delete(stale);\n            }\n        }\n        function markExistingPhoneMessagesAsSeen() {\n            const store = getPhoneStore();\n            const chats = store?.chats;\n            if (!chats || typeof chats !== 'object')\n                return;\n            for (const [chatKey, list] of Object.entries(chats)) {\n                if (!Array.isArray(list))\n                    continue;\n                const contactId = String(chatKey || '')\n                    .replace(/^chat_/, '')\n                    .trim();\n                if (!contactId)\n                    continue;\n                for (const raw of list) {\n                    const message = raw;\n                    if (!isNonUserPhoneMessage(message))\n                        continue;\n                    rememberPhoneMessageKey(getPhoneMessageKey('acsus', contactId, message));\n                }\n            }\n        }\n        function resolveTavernEventName(eventKey) {\n            try {\n                const top = getTopWindow();\n                const fromTop = top?.SillyTavern?.eventTypes?.[eventKey];\n                if (fromTop)\n                    return String(fromTop);\n            }\n            catch {\n                // ignore\n            }\n            try {\n                const fromLegacy = tavern_events?.[eventKey];\n                if (fromLegacy)\n                    return String(fromLegacy);\n            }\n            catch {\n                // ignore\n            }\n            return null;\n        }\n        function bindTavernEvent(eventKey, handler) {\n            const eventName = resolveTavernEventName(eventKey);\n            if (!eventName)\n                return null;\n            try {\n                const top = getTopWindow();\n                const eventSource = top?.SillyTavern?.eventSource;\n                if (eventSource && typeof eventSource.on === 'function') {\n                    eventSource.on(eventName, handler);\n                    return {\n                        stop: () => {\n                            try {\n                                if (typeof eventSource.off === 'function') {\n                                    eventSource.off(eventName, handler);\n                                }\n                                else if (typeof eventSource.removeListener === 'function') {\n                                    eventSource.removeListener(eventName, handler);\n                                }\n                            }\n                            catch {\n                                // ignore\n                            }\n                        },\n                    };\n                }\n            }\n            catch {\n                // ignore\n            }\n            if (typeof eventOn === 'function') {\n                return eventOn(eventName, handler);\n            }\n            return null;\n        }\n        function resetBaibaiAssistantSeenState() {\n            baibaiSeenAssistantIds.clear();\n            baibaiSeenAssistantOrder.length = 0;\n        }\n        function rememberBaibaiAssistantMessageId(messageId) {\n            if (!Number.isFinite(messageId))\n                return;\n            if (baibaiSeenAssistantIds.has(messageId))\n                return;\n            baibaiSeenAssistantIds.add(messageId);\n            baibaiSeenAssistantOrder.push(messageId);\n            if (baibaiSeenAssistantOrder.length <= BAIBAI_ASSISTANT_SEEN_MAX)\n                return;\n            const stale = baibaiSeenAssistantOrder.shift();\n            if (typeof stale === 'number') {\n                baibaiSeenAssistantIds.delete(stale);\n            }\n        }\n        function getAssistantChatMessages() {\n            try {\n                const messages = getChatMessages(`0-{{lastMessageId}}`, {\n                    role: 'assistant',\n                    hide_state: 'unhidden',\n                });\n                return Array.isArray(messages) ? messages : [];\n            }\n            catch {\n                return [];\n            }\n        }\n        function parseBaibaiPhoneMessagesFromAssistant(message) {\n            const normalizedText = sanitizeAssistantPhoneCommandText(message?.message);\n            if (!normalizedText || !hasBaibaiPhoneCommand(normalizedText))\n                return [];\n            const assistantMessageId = Number(message?.message_id);\n            const parsed = [];\n            const commandMatches = normalizedText.matchAll(/([a-zA-Z]+\\.[a-zA-Z]+)\\(([\\s\\S]*?)\\);/g);\n            let commandIndex = 0;\n            for (const match of commandMatches) {\n                commandIndex++;\n                const commandName = String(match[1] || '')\n                    .trim()\n                    .toLowerCase();\n                if (commandName !== 'qq.private' && commandName !== 'qq.group')\n                    continue;\n                const args = parseBaibaiCommandArgs(String(match[2] || ''));\n                if (args.length < 4)\n                    continue;\n                const contactId = sanitizePhoneSpeakText(args[0]) || '';\n                const senderName = sanitizePhoneSpeakText(args[1]);\n                if (!senderName || isBaibaiUserSender(senderName))\n                    continue;\n                const textPayloads = extractBaibaiTextPayloads(args[2]);\n                if (textPayloads.length === 0)\n                    continue;\n                const rawTime = sanitizePhoneSpeakText(args[3]);\n                const messageIdPart = Number.isFinite(assistantMessageId) ? String(assistantMessageId) : 'unknown';\n                textPayloads.forEach((text, index) => {\n                    const speakText = sanitizePhoneSpeakText(text);\n                    if (!speakText)\n                        return;\n                    parsed.push({\n                        contactId,\n                        message: {\n                            id: `baibai_${messageIdPart}_${commandIndex}_${index}`,\n                            sender: 'contact',\n                            type: 'text',\n                            content: speakText,\n                            time: rawTime || messageIdPart,\n                        },\n                    });\n                });\n            }\n            return parsed;\n        }\n        function markExistingBaibaiMessagesAsSeen() {\n            const messages = getAssistantChatMessages();\n            for (const item of messages) {\n                const messageId = Number(item?.message_id);\n                if (!Number.isFinite(messageId) || messageId < 0)\n                    continue;\n                rememberBaibaiAssistantMessageId(messageId);\n            }\n        }\n        function collectUnsyncedBaibaiMessages() {\n            const messages = getAssistantChatMessages();\n            if (messages.length === 0)\n                return;\n            for (const item of messages) {\n                const messageId = Number(item?.message_id);\n                if (!Number.isFinite(messageId) || messageId < 0)\n                    continue;\n                if (baibaiSeenAssistantIds.has(messageId))\n                    continue;\n                rememberBaibaiAssistantMessageId(messageId);\n                const parsedMessages = parseBaibaiPhoneMessagesFromAssistant(item);\n                for (const parsed of parsedMessages) {\n                    enqueuePhoneMessageForTTS(parsed.contactId, parsed.message, 'baibai');\n                }\n            }\n        }\n        async function waitForTTSIdle(timeoutMs = 45000) {\n            const startAt = Date.now();\n            while (TTSManager.isLoading || TTSManager.isPlaying) {\n                if (Date.now() - startAt > timeoutMs) {\n                    TTSManager.stop();\n                    return;\n                }\n                await new Promise((resolve) => {\n                    window.setTimeout(resolve, 120);\n                });\n            }\n        }\n        async function drainPhoneTTSQueue() {\n            if (phoneTtsQueueRunning)\n                return;\n            phoneTtsQueueRunning = true;\n            try {\n                while (phoneTtsQueue.length > 0) {\n                    const next = phoneTtsQueue.shift();\n                    if (!next)\n                        continue;\n                    const ttsEnabled = getTTSEnabled();\n                    const autoPlay = !!settings.value.ttsAutoPlay;\n                    const phoneAutoRead = isPhoneAutoReadEnabled(next.source);\n                    if (!ttsEnabled || !autoPlay || !phoneAutoRead)\n                        continue;\n                    const speakText = extractPhoneSpeakText(next.message);\n                    if (!speakText)\n                        continue;\n                    const contactName = getPhoneContactName(next.source, next.contactId);\n                    const speaker = getCurrentCharacterId();\n                    const voiceName = String(settings.value.ttsDefaultSpeaker || '').trim();\n                    const ttsOverrides = {};\n                    if (voiceName)\n                        ttsOverrides.speaker = voiceName;\n                    const contextPrefix = next.source === 'baibai' ? '' : '';\n                    ttsOverrides.context = `${contextPrefix}${contactName}`;\n                    await waitForTTSIdle(45000);\n                    await TTSManager.speak({\n                        type: 'dialogue',\n                        speaker,\n                        text: speakText,\n                        tts: ttsOverrides,\n                    }, `desktop_pet_phone_${next.source}_${next.contactId}_${Date.now()}`);\n                }\n            }\n            catch (e) {\n                logError('', e);\n            }\n            finally {\n                phoneTtsQueueRunning = false;\n            }\n        }\n        function enqueuePhoneMessageForTTS(contactId, message, source = 'acsus') {\n            if (!message)\n                return;\n            if (!isNonUserPhoneMessage(message))\n                return;\n            const key = getPhoneMessageKey(source, contactId, message);\n            if (phoneSeenMessageKeys.has(key))\n                return;\n            rememberPhoneMessageKey(key);\n            const messageSec = Number(message.time || 0);\n            if (source === 'acsus' &&\n                Number.isFinite(messageSec) &&\n                messageSec > 0 &&\n                phoneTtsListenSinceSec > 0 &&\n                messageSec + 2 < phoneTtsListenSinceSec) {\n                return;\n            }\n            if (!isPhoneAutoReadEnabled(source)) {\n                return;\n            }\n            phoneTtsQueue.push({ source, contactId, message });\n            void drainPhoneTTSQueue();\n        }\n        function collectUnsyncedPhoneMessages(contactId) {\n            const history = getPhoneChatHistory(contactId);\n            if (history.length === 0)\n                return;\n            const pending = [];\n            for (let i = history.length - 1; i >= 0; i--) {\n                const message = history[i];\n                if (!isNonUserPhoneMessage(message))\n                    continue;\n                const key = getPhoneMessageKey('acsus', contactId, message);\n                if (phoneSeenMessageKeys.has(key)) {\n                    break;\n                }\n                pending.push(message);\n            }\n            pending.reverse().forEach((message) => {\n                enqueuePhoneMessageForTTS(contactId, message);\n            });\n        }\n        function bindPhoneTTSBridge() {\n            if (phoneTtsBridgeBound)\n                return;\n            phoneTtsListenSinceSec = Math.floor(Date.now() / 1000);\n            markExistingPhoneMessagesAsSeen();\n            const top = getTopWindow();\n            const topDoc = top.document ?? document;\n            phoneMessageReceivedHandler = (event) => {\n                const detail = event.detail || {};\n                const contactId = String(detail.contactId || '').trim();\n                if (!contactId)\n                    return;\n                enqueuePhoneMessageForTTS(contactId, detail.message);\n            };\n            phoneAIGenCompleteHandler = (event) => {\n                const detail = event.detail || {};\n                const contactId = String(detail.contactId || '').trim();\n                if (!contactId)\n                    return;\n                collectUnsyncedPhoneMessages(contactId);\n            };\n            topDoc.addEventListener('phone-message-received', phoneMessageReceivedHandler);\n            topDoc.addEventListener('phone-ai-generation-complete', phoneAIGenCompleteHandler);\n            phoneTtsBridgeBound = true;\n            log(' TTS ');\n        }\n        function unbindPhoneTTSBridge() {\n            if (!phoneTtsBridgeBound)\n                return;\n            const top = getTopWindow();\n            const topDoc = top.document ?? document;\n            if (phoneMessageReceivedHandler) {\n                topDoc.removeEventListener('phone-message-received', phoneMessageReceivedHandler);\n            }\n            if (phoneAIGenCompleteHandler) {\n                topDoc.removeEventListener('phone-ai-generation-complete', phoneAIGenCompleteHandler);\n            }\n            phoneMessageReceivedHandler = null;\n            phoneAIGenCompleteHandler = null;\n            phoneTtsQueue.length = 0;\n            phoneTtsQueueRunning = false;\n            phoneTtsBridgeBound = false;\n        }\n        function bindBaibaiPhoneTTSBridge() {\n            if (baibaiPhoneTtsBridgeBound)\n                return;\n            resetBaibaiAssistantSeenState();\n            markExistingBaibaiMessagesAsSeen();\n            const sync = () => {\n                collectUnsyncedBaibaiMessages();\n            };\n            const onChatChanged = () => {\n                resetBaibaiAssistantSeenState();\n                markExistingBaibaiMessagesAsSeen();\n            };\n            const eventKeys = ['GENERATION_ENDED', 'MESSAGE_UPDATED', 'MESSAGE_SWIPED'];\n            eventKeys.forEach((eventKey) => {\n                const stop = bindTavernEvent(eventKey, sync);\n                if (stop)\n                    baibaiEventStops.push(stop);\n            });\n            const chatChangedStop = bindTavernEvent('CHAT_CHANGED', onChatChanged);\n            if (chatChangedStop) {\n                baibaiEventStops.push(chatChangedStop);\n            }\n            if (baibaiEventStops.length === 0) {\n                baibaiPhonePollTimer = window.setInterval(() => {\n                    collectUnsyncedBaibaiMessages();\n                }, 1200);\n            }\n            baibaiPhoneTtsBridgeBound = true;\n            log(' TTS ');\n        }\n        function unbindBaibaiPhoneTTSBridge() {\n            if (!baibaiPhoneTtsBridgeBound)\n                return;\n            baibaiEventStops.forEach((stop) => {\n                stop.stop();\n            });\n            baibaiEventStops.length = 0;\n            if (baibaiPhonePollTimer !== null) {\n                window.clearInterval(baibaiPhonePollTimer);\n                baibaiPhonePollTimer = null;\n            }\n            resetBaibaiAssistantSeenState();\n            baibaiPhoneTtsBridgeBound = false;\n        }\n        function applyEmotionToLive2D(tag) {\n            try {\n                const model = Live2DManager.model;\n                if (!model)\n                    return false;\n                let applied = false;\n                const cfg = getEmotionConfigByTag(tag, settings.value.emotionConfigs);\n                const expression = matchLive2DExpression(model, tag, cfg?.live2dExpression);\n                if (expression) {\n                    Live2DManager.playExpression(expression);\n                    applied = true;\n                }\n                const motion = matchLive2DMotion(model, tag, cfg?.live2dMotion);\n                if (motion) {\n                    Live2DManager.playMotion(motion.group, motion.index);\n                    applied = true;\n                }\n                return applied;\n            }\n            catch (e) {\n                logError('', e);\n                return false;\n            }\n        }\n        watch(showSettings, (visible) => {\n            log(visible ? '' : '');\n        });\n        function registerGlobalOpenSettings() {\n            try {\n                const top = window.parent ?? window;\n                const fn = () => {\n                    uiStore.openSettings();\n                    log('');\n                };\n                top[OPEN_SETTINGS_FN_KEY] = fn;\n                globalOpenSettingsFn = fn;\n            }\n            catch (e) {\n                notifyInitError('', e);\n            }\n        }\n        function unregisterGlobalOpenSettings() {\n            try {\n                const top = window.parent ?? window;\n                if (globalOpenSettingsFn && top[OPEN_SETTINGS_FN_KEY] === globalOpenSettingsFn) {\n                    delete top[OPEN_SETTINGS_FN_KEY];\n                }\n            }\n            catch {\n                // ignore\n            }\n            finally {\n                globalOpenSettingsFn = null;\n            }\n        }\n        registerGlobalOpenSettings();\n        function openFunctionMenu(e) {\n            try {\n                if (navigator.vibrate) {\n                    navigator.vibrate(50);\n                }\n            }\n            catch {\n                // ignore\n            }\n            const top = getTopWindow();\n            let placement = 'right';\n            let x = e.clientX;\n            let y = e.clientY;\n            try {\n                const stageEl = top.document.getElementById('desktop-pet-stage');\n                const rect = stageEl?.getBoundingClientRect?.();\n                const vw = top.innerWidth || top.document.documentElement.clientWidth || 0;\n                if (rect && vw > 0) {\n                    placement = rect.left > vw / 2 ? 'left' : 'right';\n                    x = placement === 'left' ? rect.left - 10 : rect.right + 10;\n                    y = rect.top + rect.height * 0.5;\n                }\n                else if (vw > 0) {\n                    placement = e.clientX > vw / 2 ? 'left' : 'right';\n                }\n            }\n            catch {\n                // ignore\n            }\n            menuPlacement.value = placement;\n            menuAnchor.value = { x, y };\n            showMenu.value = true;\n        }\n        function toggleMotionLoop() {\n            const next = !settings.value.autoMotionLoop;\n            settings.value.autoMotionLoop = next;\n            Live2DManager.setAutoMotionLoopEnabled(next);\n        }\n        function cyclePersona() {\n            const personas = ['', '', '', ''];\n            const current = settings.value.commentStyle;\n            const idx = personas.indexOf(current);\n            const next = personas[(idx >= 0 ? idx + 1 : 0) % personas.length];\n            settings.value.commentStyle = next;\n            try {\n                toastr.info(`${next}`);\n            }\n            catch {\n                // ignore\n            }\n        }\n        function openModelBrowser() {\n            showMenu.value = false;\n            showModelBrowser.value = true;\n        }\n        function onModelBrowserLoad(url) {\n            settings.value.modelPath = url;\n            showModelBrowser.value = false;\n            void onModelChange(url);\n        }\n        function onManualChat(message) {\n            void Commentator.chat(message);\n        }\n        function closePet() {\n            showMenu.value = false;\n            showModelBrowser.value = false;\n            uiStore.closeSettings();\n            onBubbleHidden();\n            unbindGlobalGazeFollow(true);\n            unbindPhoneTTSBridge();\n            unbindBaibaiPhoneTTSBridge();\n            ChatMonitor.destroy();\n            Commentator.destroy();\n            Live2DManager.destroyModel();\n            Live2DStage.destroy();\n            try {\n                toastr.info('');\n            }\n            catch {\n                // ignore\n            }\n        }\n        function getStageSize(scale) {\n            const safeScale = normalizePetScale(scale);\n            return {\n                width: Math.max(1, Math.round(BASE_STAGE_WIDTH * safeScale)),\n                height: Math.max(1, Math.round(BASE_STAGE_HEIGHT * safeScale)),\n            };\n        }\n        function normalizePetScale(value) {\n            const parsed = typeof value === 'number' ? value : Number(value);\n            if (!Number.isFinite(parsed))\n                return DEFAULTS.PET_SCALE;\n            return Math.max(0.1, Math.min(3, parsed));\n        }\n        function clearModelLoadingHideTimer() {\n            if (modelLoadingHideTimer === null)\n                return;\n            window.clearTimeout(modelLoadingHideTimer);\n            modelLoadingHideTimer = null;\n        }\n        function clearStatusCheckTimer() {\n            if (statusCheckTimer === null)\n                return;\n            window.clearTimeout(statusCheckTimer);\n            statusCheckTimer = null;\n        }\n        function clearViewportResizeSyncTimer() {\n            if (viewportResizeSyncTimer === null)\n                return;\n            window.clearTimeout(viewportResizeSyncTimer);\n            viewportResizeSyncTimer = null;\n        }\n        function clearGazeFollowRaf() {\n            if (gazeFollowRafId === null)\n                return;\n            const top = getTopWindow();\n            try {\n                top.cancelAnimationFrame(gazeFollowRafId);\n            }\n            catch {\n                // ignore\n            }\n            gazeFollowRafId = null;\n        }\n        function isGazePointerTypeSupported(pointerType) {\n            return pointerType === 'mouse' || pointerType === 'pen';\n        }\n        function scheduleGazeFollow(clientX, clientY) {\n            if (!Number.isFinite(clientX) || !Number.isFinite(clientY))\n                return;\n            gazePendingPoint = { x: clientX, y: clientY };\n            if (gazeFollowRafId !== null)\n                return;\n            const top = getTopWindow();\n            gazeFollowRafId = top.requestAnimationFrame(() => {\n                gazeFollowRafId = null;\n                const point = gazePendingPoint;\n                gazePendingPoint = null;\n                if (!point)\n                    return;\n                if (settings.value.gazeFollowMouseEnabled === false)\n                    return;\n                if (Live2DStage.isPreviewMounted())\n                    return;\n                Live2DManager.focusByClientPoint(point.x, point.y, false);\n            });\n        }\n        function bindGlobalGazeFollow() {\n            if (gazeFollowBound)\n                return;\n            const top = getTopWindow();\n            const topDoc = top.document ?? document;\n            const handlePointerEvent = (event) => {\n                if (!isGazePointerTypeSupported(event.pointerType))\n                    return;\n                scheduleGazeFollow(event.clientX, event.clientY);\n            };\n            gazePointerMoveHandler = handlePointerEvent;\n            gazePointerDownHandler = handlePointerEvent;\n            topDoc.addEventListener('pointermove', gazePointerMoveHandler, { passive: true });\n            topDoc.addEventListener('pointerdown', gazePointerDownHandler, { passive: true });\n            gazeFollowBound = true;\n        }\n        function unbindGlobalGazeFollow(resetFocus = true) {\n            clearGazeFollowRaf();\n            gazePendingPoint = null;\n            const top = getTopWindow();\n            const topDoc = top.document ?? document;\n            if (gazePointerMoveHandler) {\n                topDoc.removeEventListener('pointermove', gazePointerMoveHandler);\n            }\n            if (gazePointerDownHandler) {\n                topDoc.removeEventListener('pointerdown', gazePointerDownHandler);\n            }\n            gazePointerMoveHandler = null;\n            gazePointerDownHandler = null;\n            gazeFollowBound = false;\n            if (resetFocus) {\n                Live2DManager.focusCenter(true);\n            }\n        }\n        function syncGazeFollowBinding() {\n            if (settings.value.gazeFollowMouseEnabled === false) {\n                unbindGlobalGazeFollow(true);\n                return;\n            }\n            bindGlobalGazeFollow();\n        }\n        function syncStageAfterViewportResize(reason) {\n            if (Live2DStage.isPreviewMounted())\n                return;\n            const stageSize = getStageSize(settings.value.petScale);\n            const recoverOnce = (label) => {\n                Live2DStage.resizeFloating(stageSize.width, stageSize.height);\n                const top = getTopWindow();\n                const stageEl = top.document.getElementById('desktop-pet-stage');\n                if (stageEl) {\n                    stageEl.style.display = 'block';\n                    stageEl.style.visibility = 'visible';\n                    stageEl.style.opacity = '1';\n                    stageEl.style.zIndex = '10000';\n                }\n                const stage = Live2DStage.getStage();\n                const hasModelOnStage = !!stage && stage.children.length > 0;\n                if (hasModelOnStage) {\n                    Live2DManager.updateScale(stageSize.width, stageSize.height, 1);\n                    log(`Viewport resize recovery synced model (${label})`);\n                    return;\n                }\n                Live2DManager.mountToStage(stageSize.width, stageSize.height, 1);\n                log(`Viewport resize recovery remounted model (${label})`);\n            };\n            recoverOnce(`${reason}-pass1`);\n            window.setTimeout(() => {\n                if (Live2DStage.isPreviewMounted())\n                    return;\n                recoverOnce(`${reason}-pass2`);\n            }, 220);\n            scheduleStatusCheck(`${reason}-recover`);\n        }\n        function scheduleViewportResizeSync(reason) {\n            clearViewportResizeSyncTimer();\n            viewportResizeSyncTimer = window.setTimeout(() => {\n                viewportResizeSyncTimer = null;\n                syncStageAfterViewportResize(reason);\n            }, 160);\n        }\n        function bindViewportResizeRecovery() {\n            const top = getTopWindow();\n            boundWindowResizeHandler = () => {\n                scheduleViewportResizeSync('window-resize');\n            };\n            try {\n                top.addEventListener('resize', boundWindowResizeHandler, { passive: true });\n            }\n            catch (e) {\n                logError('Failed to bind window.resize listener', e);\n                boundWindowResizeHandler = null;\n            }\n            const viewport = top.visualViewport;\n            if (!viewport)\n                return;\n            boundVisualViewportResizeHandler = () => {\n                scheduleViewportResizeSync('visual-viewport-resize');\n            };\n            try {\n                viewport.addEventListener('resize', boundVisualViewportResizeHandler, { passive: true });\n            }\n            catch (e) {\n                logError('Failed to bind visualViewport.resize listener', e);\n                boundVisualViewportResizeHandler = null;\n            }\n        }\n        function unbindViewportResizeRecovery() {\n            const top = getTopWindow();\n            if (boundWindowResizeHandler) {\n                try {\n                    top.removeEventListener('resize', boundWindowResizeHandler);\n                }\n                catch {\n                    // ignore\n                }\n                boundWindowResizeHandler = null;\n            }\n            const viewport = top.visualViewport;\n            if (viewport && boundVisualViewportResizeHandler) {\n                try {\n                    viewport.removeEventListener('resize', boundVisualViewportResizeHandler);\n                }\n                catch {\n                    // ignore\n                }\n                boundVisualViewportResizeHandler = null;\n            }\n        }\n        function renderModelLoadProgress(progress) {\n            const percent = Math.max(0, Math.min(100, Math.round(progress.percent)));\n            Live2DStage.showLoadingProgress(percent, progress.message);\n        }\n        function notifyInitError(message, err) {\n            logError(message, err);\n            try {\n                toastr.error(message);\n            }\n            catch {\n                // ignore\n            }\n        }\n        async function loadModelWithProgress(path) {\n            const taskId = ++modelLoadTaskId;\n            clearModelLoadingHideTimer();\n            renderModelLoadProgress({ percent: 0, message: '' });\n            const loaded = await Live2DManager.loadModel(path, (progress) => {\n                if (taskId !== modelLoadTaskId)\n                    return;\n                renderModelLoadProgress(progress);\n            });\n            if (taskId !== modelLoadTaskId) {\n                return loaded;\n            }\n            renderModelLoadProgress({\n                percent: 100,\n                message: loaded ? '' : '',\n            });\n            modelLoadingHideTimer = window.setTimeout(() => {\n                if (taskId !== modelLoadTaskId)\n                    return;\n                Live2DStage.hideLoadingProgress();\n                modelLoadingHideTimer = null;\n            }, loaded ? 400 : 15000);\n            return loaded;\n        }\n        function scheduleStatusCheck(reason) {\n            clearStatusCheckTimer();\n            statusCheckTimer = window.setTimeout(() => {\n                try {\n                    const top = window.parent ?? window;\n                    const stageEl = top.document.getElementById('desktop-pet-stage');\n                    const rect = stageEl?.getBoundingClientRect?.();\n                    const rectSummary = rect\n                        ? `${Math.round(rect.left)},${Math.round(rect.top)} ${Math.round(rect.width)}x${Math.round(rect.height)}`\n                        : 'none';\n                    const pixiVersion = String(top.PIXI?.VERSION || '').trim() || 'none';\n                    const hasLive2d = !!top.PIXI?.live2d?.Live2DModel;\n                    const hasModel = !!Live2DManager.model;\n                    const stageChildren = (Live2DStage.getStage()?.children?.length ?? 0);\n                    const stageVisible = !!rect &&\n                        rect.width > 10 &&\n                        rect.height > 10 &&\n                        rect.bottom > 0 &&\n                        rect.right > 0 &&\n                        rect.top < (top.innerHeight || 0) &&\n                        rect.left < (top.innerWidth || 0);\n                    if (stageVisible && hasLive2d && hasModel && stageChildren > 0) {\n                        statusCheckTimer = null;\n                        return;\n                    }\n                    if (stageEl) {\n                        const prevOutline = stageEl.style.outline;\n                        const prevBackground = stageEl.style.background;\n                        const prevZIndex = stageEl.style.zIndex;\n                        stageEl.style.outline = '2px dashed rgba(245, 158, 11, 0.95)';\n                        stageEl.style.background = 'rgba(245, 158, 11, 0.08)';\n                        stageEl.style.zIndex = '2147483647';\n                        window.setTimeout(() => {\n                            if (!stageEl?.ownerDocument?.documentElement?.contains(stageEl))\n                                return;\n                            stageEl.style.outline = prevOutline;\n                            stageEl.style.background = prevBackground;\n                            stageEl.style.zIndex = prevZIndex;\n                        }, 10000);\n                    }\n                    const message = `(${reason}) ` +\n                        `stage=${!!stageEl} rect=${rectSummary} visible=${stageVisible} ` +\n                        `pixi=${pixiVersion} live2d=${hasLive2d} model=${hasModel} children=${stageChildren}`;\n                    try {\n                        toastr.warning(message);\n                    }\n                    catch {\n                        // ignore\n                    }\n                }\n                catch (e) {\n                    notifyInitError('', e);\n                }\n                finally {\n                    statusCheckTimer = null;\n                }\n            }, 2500);\n        }\n        async function initPet() {\n            try {\n                log('');\n                const s = settings.value;\n                try {\n                    setLipSyncRefs({\n                        getProxiedAudioUrl: (url) => TTSManager._getProxiedAudioUrl(url),\n                    });\n                    TTSManager.init();\n                }\n                catch (e) {\n                    logError('TTS ', e);\n                }\n                bindPhoneTTSBridge();\n                bindBaibaiPhoneTTSBridge();\n                Commentator.setCallback((text, isDone) => {\n                    const parsed = parseEmotionCotText(text, {\n                        enabled: !!settings.value.emotionCotEnabled,\n                        stripFromText: settings.value.emotionCotStripFromText !== false,\n                        configs: settings.value.emotionConfigs,\n                    });\n                    bubbleText.value = parsed.cleanText;\n                    bubbleDone.value = isDone;\n                    if (!isDone)\n                        return;\n                    const finalText = String(parsed.cleanText || '').trim();\n                    if (!finalText)\n                        return;\n                    if (parsed.normalizedTag) {\n                        const applied = applyEmotionToLive2D(parsed.normalizedTag);\n                        if (!applied) {\n                            Live2DManager.playRandomAnimation();\n                        }\n                    }\n                    else {\n                        Live2DManager.playRandomAnimation();\n                    }\n                    const ttsEnabled = getTTSEnabled();\n                    const autoPlay = !!settings.value.ttsAutoPlay;\n                    const tagLabel = parsed.normalizedTag || '(none)';\n                    log(`TTS: enabled=${ttsEnabled}, autoPlay=${autoPlay}, tag=${tagLabel}, textLen=${finalText.length}`);\n                    if (!ttsEnabled)\n                        return;\n                    if (!autoPlay)\n                        return;\n                    const speaker = getCurrentCharacterId();\n                    const voiceName = String(settings.value.ttsDefaultSpeaker || '').trim();\n                    let context = String(parsed.context || '').trim();\n                    if (!context && parsed.normalizedTag) {\n                        const cfg = getEmotionConfigByTag(parsed.normalizedTag, settings.value.emotionConfigs);\n                        context = String(cfg?.ttsContext || '').trim();\n                    }\n                    log(`: speaker=${speaker}, voice=${voiceName || ''}, context=${context || ''}`);\n                    void (async () => {\n                        try {\n                            TTSManager.stop();\n                            const ttsOverrides = {};\n                            if (voiceName)\n                                ttsOverrides.speaker = voiceName;\n                            if (context)\n                                ttsOverrides.context = context;\n                            await TTSManager.speak({\n                                type: 'dialogue',\n                                speaker,\n                                text: finalText,\n                                tts: Object.keys(ttsOverrides).length > 0 ? ttsOverrides : undefined,\n                            }, `desktop_pet_comment_${Date.now()}`);\n                        }\n                        catch (e) {\n                            logError('', e);\n                        }\n                    })();\n                });\n                const ready = await Live2DManager.init();\n                if (!ready) {\n                    notifyInitError('Live2D SDK  CDN ');\n                    return;\n                }\n                log('Live2D SDK ');\n                Live2DManager.setAutoMotionLoopEnabled(s.autoMotionLoop);\n                const initialScale = normalizePetScale(s.petScale);\n                if (initialScale !== s.petScale) {\n                    settings.value.petScale = initialScale;\n                }\n                const stageSize = getStageSize(initialScale);\n                const created = Live2DStage.create({\n                    width: stageSize.width,\n                    height: stageSize.height,\n                    position: { x: s.petPosition.x, y: s.petPosition.y },\n                    scale: initialScale,\n                    onPositionChange: (x, y) => {\n                        settings.value.petPosition = { x, y };\n                    },\n                    onScaleChange: (scale) => {\n                        const safeScale = normalizePetScale(scale);\n                        if (safeScale !== settings.value.petScale) {\n                            settings.value.petScale = safeScale;\n                        }\n                    },\n                    onTap: (_e) => {\n                        log(' ->  LLM');\n                        Live2DManager.playRandomAnimation();\n                    },\n                    onDoubleTap: (_e) => {\n                        const motionEnabled = settings.value.doubleTapRandomMotionEnabled !== false;\n                        log(motionEnabled ? ' ->  + ' : ' -> ');\n                        ChatMonitor.manualTrigger();\n                        if (motionEnabled) {\n                            Live2DManager.playRandomAnimation();\n                        }\n                    },\n                    onLongPress: (_e) => {\n                        log(' -> ');\n                        openFunctionMenu(_e);\n                    },\n                });\n                if (!created) {\n                    notifyInitError('Live2D  WebGL ');\n                    return;\n                }\n                log('Live2D ');\n                const loaded = await loadModelWithProgress(s.modelPath);\n                if (loaded) {\n                    Live2DManager.mountToStage(stageSize.width, stageSize.height, 1);\n                    log('Live2D ');\n                }\n                else {\n                    notifyInitError('Live2D  CDN');\n                }\n                ChatMonitor.init({\n                    autoTrigger: s.autoTrigger,\n                    triggerInterval: s.triggerInterval,\n                    triggerProbability: s.triggerProbability,\n                    commentTriggerMode: s.commentTriggerMode,\n                }, () => {\n                    void Commentator.generate();\n                });\n                log('');\n                scheduleStatusCheck('init');\n            }\n            catch (e) {\n                notifyInitError('', e);\n            }\n        }\n        async function onModelChange(path) {\n            const nextPath = String(path || '').trim();\n            const isLocalModel = nextPath.length > 0 &&\n                nextPath.toLowerCase().startsWith(LOCAL_LIVE2D_MODEL_PATH_PREFIX.toLowerCase());\n            if (isLocalModel) {\n                try {\n                    const exists = await hasLive2DModel();\n                    if (!exists) {\n                        const message = ' ZIP ';\n                        log(`: local model missing, path=${nextPath}`);\n                        toastr.error(message);\n                        scheduleStatusCheck('model-change-local-missing');\n                        return;\n                    }\n                }\n                catch (e) {\n                    const message = `: ${e instanceof Error ? e.message : String(e)}`;\n                    log(`: path=${nextPath}`, e);\n                    toastr.error(message);\n                    scheduleStatusCheck('model-change-local-check-error');\n                    return;\n                }\n            }\n            const loaded = await loadModelWithProgress(path);\n            if (loaded) {\n                const stageSize = getStageSize(settings.value.petScale);\n                Live2DManager.mountToStage(stageSize.width, stageSize.height, 1);\n            }\n            else if (isLocalModel) {\n                const message = ' ZIP ';\n                log(`: path=${nextPath}`);\n                toastr.error(message);\n            }\n            scheduleStatusCheck(isLocalModel ? 'model-change-local' : 'model-change');\n        }\n        function onBubbleHidden() {\n            bubbleText.value = '';\n            bubbleDone.value = true;\n        }\n        watch(() => ({\n            autoTrigger: settings.value.autoTrigger,\n            triggerInterval: settings.value.triggerInterval,\n            triggerProbability: settings.value.triggerProbability,\n            commentTriggerMode: settings.value.commentTriggerMode,\n        }), (config) => {\n            ChatMonitor.updateConfig(config);\n        });\n        watch(() => settings.value.autoMotionLoop, (enabled) => {\n            Live2DManager.setAutoMotionLoopEnabled(enabled);\n        });\n        watch(() => settings.value.gazeFollowMouseEnabled, () => {\n            syncGazeFollowBinding();\n        });\n        watch(() => settings.value.petScale, (scale) => {\n            const safeScale = normalizePetScale(scale);\n            if (safeScale !== scale) {\n                settings.value.petScale = safeScale;\n                return;\n            }\n            const stageSize = getStageSize(safeScale);\n            Live2DStage.resizeFloating(stageSize.width, stageSize.height);\n            if (!Live2DStage.isPreviewMounted()) {\n                Live2DManager.updateScale(stageSize.width, stageSize.height, 1);\n            }\n        });\n        onMounted(() => {\n            bindViewportResizeRecovery();\n            syncGazeFollowBinding();\n            initPet();\n        });\n        onUnmounted(() => {\n            unbindViewportResizeRecovery();\n            unbindGlobalGazeFollow(true);\n            unregisterGlobalOpenSettings();\n            unbindPhoneTTSBridge();\n            unbindBaibaiPhoneTTSBridge();\n            modelLoadTaskId++;\n            clearModelLoadingHideTimer();\n            clearStatusCheckTimer();\n            clearViewportResizeSyncTimer();\n            Live2DStage.hideLoadingProgress();\n            ChatMonitor.destroy();\n            Commentator.destroy();\n            try {\n                TTSManager.stop();\n                LipSyncManager.cleanup();\n            }\n            catch {\n                // ignore\n            }\n            Live2DManager.destroyModel();\n            Live2DStage.destroy();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", null, [\n                _createVNode(ChatBubble, {\n                    text: bubbleText.value,\n                    \"is-done\": bubbleDone.value,\n                    \"auto-close-delay-seconds\": _unref(settings).bubbleDuration,\n                    onHidden: onBubbleHidden\n                }, null, 8 /* PROPS */, [\"text\", \"is-done\", \"auto-close-delay-seconds\"]),\n                _createVNode(SettingsPanel, {\n                    visible: _unref(showSettings),\n                    onClose: _cache[0] || (_cache[0] = ($event) => (_unref(uiStore).closeSettings())),\n                    onModelChange: onModelChange\n                }, null, 8 /* PROPS */, [\"visible\"]),\n                _createVNode(FunctionMenu, {\n                    visible: showMenu.value,\n                    x: menuAnchor.value.x,\n                    y: menuAnchor.value.y,\n                    placement: menuPlacement.value,\n                    \"motion-loop-enabled\": _unref(settings).autoMotionLoop,\n                    \"comment-style\": _unref(settings).commentStyle,\n                    onClose: _cache[1] || (_cache[1] = ($event) => (showMenu.value = false)),\n                    onSendChat: onManualChat,\n                    onToggleMotionLoop: toggleMotionLoop,\n                    onSwitchModel: openModelBrowser,\n                    onSwitchPersona: cyclePersona,\n                    onCloseModel: closePet\n                }, null, 8 /* PROPS */, [\"visible\", \"x\", \"y\", \"placement\", \"motion-loop-enabled\", \"comment-style\"]),\n                (showModelBrowser.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"browser-overlay\",\n                        onClick: _cache[4] || (_cache[4] = _withModifiers(($event) => (showModelBrowser.value = false), [\"self\"]))\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_1, [\n                            _createElementVNode(\"div\", _hoisted_2, [\n                                _cache[5] || (_cache[5] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-btn\",\n                                    onClick: _cache[2] || (_cache[2] = ($event) => (showModelBrowser.value = false))\n                                }, \"\")\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_3, [\n                                _createVNode(ModelBrowser, {\n                                    \"use-cdn\": _unref(settings).useCdn,\n                                    onCancel: _cache[3] || (_cache[3] = ($event) => (showModelBrowser.value = false)),\n                                    onLoadModel: onModelBrowserLoad\n                                }, null, 8 /* PROPS */, [\"use-cdn\"])\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./PetContainer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./PetContainer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./PetContainer.vue?vue&type=style&index=0&id=f0a5fb30&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_044411237ecec1aa8d154f48631c8f18/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-f0a5fb30\"]])\n\nexport default __exports__","/**\n *  iframe  <head> \n *  jQuery  Vue  DOM \n */\nexport function teleport_style(): void {\n  // /\n  deteleport_style();\n  $(`<div>`)\n    .attr('script_id', getScriptId())\n    .append($(`head > style`, document).clone())\n    .appendTo('head');\n}\n\n/**\n * \n */\nexport function deteleport_style(): void {\n  $(`head > div[script_id=\"${getScriptId()}\"]`).remove();\n}\n","import { createApp } from 'vue';\nimport { createPinia } from 'pinia';\nimport PetContainer from './ui/PetContainer.vue';\nimport { ChatMonitor } from './chat/monitor';\nimport { teleport_style, deteleport_style } from './utils/style-teleport';\nimport { error as logError, log, warn } from './utils/dom';\nimport { SCRIPT_NAME } from './core/constants';\nimport { useUiStore } from './core/ui';\n\nconst BUILD_TAG = '20260215.04';\nconst LEGACY_MENU_BUTTON_LABELS = new Set(['', '']);\nconst SETTINGS_LABEL = '';\nconst OPEN_SETTINGS_FN_KEY = '__desktopPetOpenSettings_v2';\n\n// Pinia  $(() => {}) \nconst pinia = createPinia();\nconst uiStore = useUiStore(pinia);\nconst EXTENSIONS_MENU_CONTAINER_ID = 'desktop-pet-settings-menu-container';\nconst EXTENSIONS_MENU_ITEM_ID = 'desktop-pet-settings-menu-item';\nconst EXTENSIONS_MENU_CLICK_NAMESPACE = '.desktopPetSettingsMenu';\n\nlet extensionsMenuRetryTimer: number | null = null;\n\nfunction getParentDocument(): Document {\n  try {\n    return window.parent?.document ?? document;\n  } catch {\n    return document;\n  }\n}\n\nfunction getTopWindow(): Window {\n  return window.parent ?? window;\n}\n\nfunction bindExtensionsMenuDelegation(parentDoc: Document): void {\n  const clickEvent = `click${EXTENSIONS_MENU_CLICK_NAMESPACE}`;\n  $(parentDoc).off(clickEvent, `#${EXTENSIONS_MENU_ITEM_ID}`);\n  $(parentDoc).on(clickEvent, `#${EXTENSIONS_MENU_ITEM_ID}`, (event) => {\n    void onExtensionsMenuItemClick(event as unknown as JQuery.ClickEvent);\n  });\n}\n\nfunction clearExtensionsMenuRetryTimer(): void {\n  if (extensionsMenuRetryTimer !== null) {\n    window.clearTimeout(extensionsMenuRetryTimer);\n    extensionsMenuRetryTimer = null;\n  }\n}\n\nfunction scheduleExtensionsMenuInjection(): void {\n  if (extensionsMenuRetryTimer !== null) {\n    return;\n  }\n\n  extensionsMenuRetryTimer = window.setTimeout(() => {\n    extensionsMenuRetryTimer = null;\n    injectExtensionsMenuItem();\n  }, 1000);\n}\n\nasync function onExtensionsMenuItemClick(event: JQuery.ClickEvent): Promise<void> {\n  event.stopPropagation();\n  log('');\n\n  const parentDoc = getParentDocument();\n  const $extensionsMenu = $('#extensionsMenu', parentDoc);\n  const $extensionsMenuButton = $('#extensionsMenuButton', parentDoc);\n\n  if ($extensionsMenuButton.length > 0 && $extensionsMenu.is(':visible')) {\n    $extensionsMenuButton.trigger('click');\n    await new Promise<void>((resolve) => {\n      window.setTimeout(resolve, 120);\n    });\n  }\n\n  const top = getTopWindow() as any;\n  const openSettings = top?.[OPEN_SETTINGS_FN_KEY];\n  if (typeof openSettings === 'function') {\n    openSettings();\n    log('');\n  } else {\n    uiStore.openSettings();\n    log(` Pinia  (showSettings=${String(uiStore.showSettings)})`);\n  }\n\n  window.setTimeout(() => {\n    try {\n      const overlay = parentDoc.querySelector('#desktop-pet-app .settings-overlay') as HTMLElement | null;\n      const rect = overlay?.getBoundingClientRect?.();\n      const summary = rect\n        ? `${Math.round(rect.left)},${Math.round(rect.top)} ${Math.round(rect.width)}x${Math.round(rect.height)}`\n        : 'none';\n      const style = overlay ? (window.getComputedStyle(overlay) as CSSStyleDeclaration) : null;\n      const styleSummary = style\n        ? `position=${style.position} display=${style.display} width=${style.width} height=${style.height}`\n        : 'style=none';\n      log(` DOM : overlay=${!!overlay} rect=${summary} ${styleSummary}`);\n    } catch (e) {\n      warn(' DOM ', e);\n    }\n  }, 0);\n}\n\nfunction injectExtensionsMenuItem(): void {\n  const parentDoc = getParentDocument();\n  const $extensionsMenu = $('#extensionsMenu', parentDoc);\n\n  if ($extensionsMenu.length === 0) {\n    scheduleExtensionsMenuInjection();\n    return;\n  }\n\n  bindExtensionsMenuDelegation(parentDoc);\n  const $existingItem = $(`#${EXTENSIONS_MENU_ITEM_ID}`, parentDoc);\n  if ($existingItem.length > 0) {\n    return;\n  }\n\n  const $container = $(\n    `<div class=\"extension_container interactable\" id=\"${EXTENSIONS_MENU_CONTAINER_ID}\" tabindex=\"0\"></div>`,\n  );\n\n  const $item = $(\n    `<div class=\"list-group-item flex-container flexGap5 interactable\" id=\"${EXTENSIONS_MENU_ITEM_ID}\" title=\"${SETTINGS_LABEL}\"><div class=\"fa-fw fa-solid fa-paw extensionsMenuExtensionButton\"></div><span>${SETTINGS_LABEL}</span></div>`,\n  );\n\n  $container.append($item);\n  $extensionsMenu.append($container);\n}\n\nfunction removeExtensionsMenuItem(): void {\n  clearExtensionsMenuRetryTimer();\n\n  const parentDoc = getParentDocument();\n  const clickEvent = `click${EXTENSIONS_MENU_CLICK_NAMESPACE}`;\n  $(parentDoc).off(clickEvent, `#${EXTENSIONS_MENU_ITEM_ID}`);\n  $(`#${EXTENSIONS_MENU_CONTAINER_ID}`, parentDoc).remove();\n}\n\nfunction removeLegacyMenuButtons(): void {\n  try {\n    const parentDoc = getParentDocument();\n    $('.qr--button.menu_button.interactable', parentDoc)\n      .filter((_idx, el) => LEGACY_MENU_BUTTON_LABELS.has(String($(el).text() || '').trim()))\n      .remove();\n  } catch (e) {\n    warn('', e);\n  }\n}\n\n$(() => {\n  // \n  teleport_style();\n\n  try {\n    log(`(${BUILD_TAG})`);\n    removeLegacyMenuButtons();\n    window.setTimeout(() => {\n      removeLegacyMenuButtons();\n    }, 1200);\n\n    //  Vue \n    try {\n      const parentDoc = getParentDocument();\n      $('#desktop-pet-app', parentDoc).remove();\n    } catch {\n      // ignore\n    }\n    const $app = $('<div id=\"desktop-pet-app\">').appendTo('body');\n    const app = createApp(PetContainer);\n    app.use(pinia);\n    app.config.errorHandler = (err, _instance, info) => {\n      logError(`Vue error: ${info}`, err);\n    };\n    app.config.warnHandler = (msg, _instance, trace) => {\n      warn(`Vue warn: ${msg}${trace ? `\\n${trace}` : ''}`);\n    };\n    app.mount($app[0]);\n    injectExtensionsMenuItem();\n\n    toastr.success(`${SCRIPT_NAME}(${BUILD_TAG})`);\n    log(`(${BUILD_TAG})`);\n\n    // \n    let chatId = SillyTavern.getCurrentChatId();\n    eventOn(tavern_events.CHAT_CHANGED, (newChatId: string) => {\n      if (chatId !== newChatId) {\n        chatId = newChatId;\n        ChatMonitor.resetState();\n      }\n    });\n  } catch (e) {\n    logError('', e);\n    toastr.error(`${SCRIPT_NAME}(${BUILD_TAG})`);\n    $('#desktop-pet-app').remove();\n  }\n});\n\n$(window).on('pagehide', () => {\n  removeLegacyMenuButtons();\n  removeExtensionsMenuItem();\n  deteleport_style();\n  $('#desktop-pet-app').remove();\n  $('#desktop-pet-stage').remove();\n});\n"],"names":["content","__esModule","default","module","id","locals","exports","add","cssWithMappingToString","list","toString","this","map","item","needLayer","concat","length","join","i","modules","media","dedupe","supports","layer","undefined","alreadyImportedModules","k","_k","push","___CSS_LOADER_EXPORT___","sfc","props","target","__vccOpts","key","val","listToStyles","parentId","styles","newStyles","part","css","sourceMap","parts","hasDocument","document","DEBUG","Error","stylesInDom","head","getElementsByTagName","singletonElement","singletonCounter","isProduction","noop","options","ssrIdKey","isOldIE","navigator","test","userAgent","toLowerCase","addStylesClient","_isProduction","_options","addStylesToDom","newList","mayRemove","domStyle","refs","j","addStyle","createStyleElement","styleElement","createElement","type","appendChild","obj","update","remove","querySelector","parentNode","removeChild","styleIndex","applyToSingletonTag","bind","applyToTag","newObj","textStore","replaceText","index","replacement","filter","Boolean","styleSheet","cssText","cssNode","createTextNode","childNodes","insertBefore","setAttribute","ssrId","sources","btoa","unescape","encodeURIComponent","JSON","stringify","firstChild","cssMapping","base64","data","sourceMapping","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","d","a","definition","o","Object","defineProperty","enumerable","get","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","Vue","DB_NAME","STORE_LIVE2D_MODELS","STORE_SDK_CACHE","LOCAL_LIVE2D_MODEL_PATH_PREFIX","LOCAL_LIVE2D_MODEL_SLOT_ID","LOCAL_LIVE2D_MODEL_PATH","EMPTY_MOTION_GROUP_VALUE","RECOMMENDED_MODELS","freeze","name","path","COMMENT_STYLES","COMMENT_TRIGGER_MODE_OPTIONS","label","EMOTION_TAGS","API_SOURCES","EIKANYA_CDN_BASE","EIKANYA_RAW_BASE","DEFAULTS","x","y","z","isRecord","Array","isArray","EMOTION_TAG_SET","Set","asEmotionTag","s","String","trim","has","DEFAULT_ALIASES","dedupAliases","aliases","out","seen","raw","trimmed","createDefaultEmotionConfigs","tag","ttsContext","live2dExpression","live2dMotion","enabled","group","normalizeEmotionConfigs","byTag","Map","live2dMotionRaw","indexRaw","Number","isFinite","Math","max","floor","cfg","v","set","defaults","def","getEmotionConfigByTag","configs","resolveEmotionTag","rawTag","direct","needle","alias","getTargetConsole","top","window","parent","console","log","args","warn","error","deleteAtPath","current","last","parseSettings","rawObject","first","SettingsSchema","safeParse","success","cleaned","issue","issues","second","parse","object","apiMode","enum","apiConfig","url","string","apiKey","model","source","max_tokens","number","min","temperature","frequency_penalty","presence_penalty","top_p","top_k","usePresetSampling","boolean","sendWorldInfo","modelPath","useCdn","petPosition","petScale","autoMotionLoop","doubleTapRandomMotionEnabled","gazeFollowMouseEnabled","commentStyle","commentTriggerMode","customPrompt","roleplayName","roleplayIgnoreCommentStyle","sendCharacterCardContent","autoTrigger","triggerInterval","triggerProbability","maxChatContext","bubbleDuration","useTamakoTodaySpecial","useDiceDatabaseReference","diceReferenceVisibleSheets","array","emotionCotEnabled","emotionCotStripFromText","emotionConfigs","ttsProvider","ttsAutoPlay","phoneMessageAutoRead","baibaiPhoneMessageAutoRead","ttsDefaultSpeaker","lipSyncManualParamsEnabled","lipSyncManualParamIds","gptSoVits","apiUrl","endpoint","useCorsProxy","mediaType","streamingMode","textLang","textSplitMethod","speedFactor","strictWeightSwitch","probeOnAudioError","modelSwitchMode","setModelEndpoint","rootDir","importPathPrefix","models","desc","paths","gptWeightsPath","sovitsWeightsPath","defaultRefAudioPath","params","promptText","promptLang","refAudios","defaultRefId","expressionRefMap","record","voices","refAudioPath","useSettingsStore","parsed","getVariables","script_id","getScriptId","includes","rawBubbleDuration","bubbleDurationSeconds","round","settings","ref","watchEffect","replaceVariables","updateSettings","partial","resetSettings","next","EDGE_BASE_URL","TRUSTED_CLIENT_TOKEN","WSS_URL","VOICE_LIST_URL","clockSkewSeconds","EDGE_FALLBACK_SHORT_VOICES","shortName","locale","gender","toAbortError","message","DOMException","err","buildConnectionId","bytes","Uint8Array","globalThis","crypto","getRandomValues","random","from","b","padStart","removeIncompatibleCharacters","text","code","charCodeAt","getVoiceName","voice","async","toSha256HexUpper","TextEncoder","encode","subtle","digest","toUpperCase","K","Uint32Array","H","withOneByte","paddedLength","ceil","padded","bitLength","high","low","w","offset","s0","rotateRight","s1","c","e","f","g","h","temp1","maj","word","sha256HexUpperFallback","bits","buildSecurityParamsWithReason","ticks","Date","now","SECONDS_TO_NANOSECONDS","security","secMsGec","toFixed","secMsGecVersion","mapEdgeVoice","ShortName","Locale","Gender","resourceId","FriendlyName","fetchVoicesOnce","response","fetch","headers","Accept","serverDate","date","ts","getTime","parseServerDateHeader","clientDate","ok","status","payload","json","result","sort","localeCompare","dedupeVoices","getEdgeFallbackVoices","synthesizeWithSocketUrl","socketUrl","voiceName","timestampMode","attemptLabel","timeoutMs","Promise","resolve","reject","done","ws","timeoutId","chunks","sawSocketError","sawOpen","closeCode","closeReason","closeWasClean","finish","fn","clearTimeout","onopen","onmessage","onerror","onclose","onSocket","signal","removeEventListener","onAbort","fail","close","aborted","addEventListener","once","WebSocket","binaryType","setTimeout","timestamp","mode","toISOString","replace","slice","toUTCString","dateToString","send","buildSpeechConfigMessage","requestId","ssml","buildSsmlMessage","escapedText","escapeXml","buildSsml","event","textMessage","headerEndIndex","indexOf","headerText","line","split","idx","parseHeadersFromTextMessage","Path","ArrayBuffer","isView","buffer","byteOffset","byteLength","Blob","arrayBuffer","binary","headerLength","headerBytes","TextDecoder","decode","parseHeadersAndDataFromBinaryMessage","contentType","startsWith","handleBinary","catch","reason","wasClean","merged","totalLength","reduce","sum","chunk","concatChunks","blob","TTS_PROVIDER","LITTLEWHITEBOX","GPT_SOVITS_V2","EDGE_TTS_DIRECT","normalizePathSep","getTopWindow","getStoragePrefix","getTtsEnabledKey","getCharTtsVoiceKey","normalizeGptSoVitsSwitchMode","normalizeSetModelEndpoint","toFiniteNumber","fallback","safeObject","safeArray","buildGptSoVitsModelId","seed","normalizeGptSoVitsRefAudio","ref_audio_path","refId","prompt_text","prompt_lang","text_lang","normalizeGptSoVitsModel","globalDefaults","modelName","speaker","modelParams","text_split_method","speed_factor","media_type","streaming_mode","gpt_weights_path","sovits_weights_path","refAudioCandidates","references","refAudioList","unshift","refIds","refPaths","refIndex","entries","normalized","nextId","some","find","resolvedDefaultRefPath","rawMap","expressionMap","forEach","expr","exprText","resolvedRefId","description","normalizeGptSoVitsModelsForStoreInternal","modelList","idSet","nameSet","baseName","nextName","buildRuntimeVoiceFromModel","globalCfg","defaultRef","gptSoVitsModel","getTTSProvider","getGptSoVitsConfig","normalizedRootDir","normalizedImportPrefix","assign","normalizedModels","voiceList","toGptSoVitsVoiceConfig","legacyVoicesToModels","normalizeGptSoVitsVoice","rawCfg","ref_audio","gptPath","gpt","sovitsPath","sovits","model_switch_mode","set_model_endpoint","strict_weight_switch","normalizeGptSoVitsModelsForStore","isGptSoVitsVoiceUsable","pickFirstUsableGptSoVitsVoice","getFileExtLower","lastIndexOf","stripFileExt","isAbsoluteFileSystemPath","pathStr","p","joinPathPrefix","prefix","relPath","rel","useBackslash","sep","cleanPrefix","cleanRel","normalizedPrefix","normalizedRel","lowerPrefix","lowerRel","prefixSegs","relSegs","tail","inferLangFromText","t","cleanPromptTextFromFilenameBase","cleanVoiceNameFromWeightsBase","suffixes","before","re","pickLargestFile","files","size","pickBestAudioFile","audioFiles","candidates","file","ext","score","weightsStemKey","fileName","stem","collectWeightCandidates","ckpts","pths","ckptList","pthList","ckptByBase","ckptByStem","base","used","addCandidate","gptFile","sovitsFile","pth","matched","usedGpt","usedSovits","inferExpressionTagFromAudioName","rules","patterns","rule","pattern","inferGptSoVitsModelsFromFolderFiles","fileList","importOptions","normalizedRootHint","relativeRootName","normalizeRelativePath","webkitRelativePath","lowerRoot","groups","dirKey","groupFiles","audios","toServerPath","abs","audioCandidates","inferredTag","bestAudio","weightCandidatesRaw","weightCandidates","dirName","pop","groupNameUsed","pair","defaultRefBase","audioIndex","lang","defaultPromptText","defaultLang","getGptSoVitsVoiceList","_lwbTtsCache","_lwbTtsCacheTime","_edgeTtsCache","_edgeTtsCacheTime","getEdgeDirectVoiceListAsync","securityResult","urls","lastError","fetchEdgeVoices","getTTSVoiceListAsync","provider","getGptSoVitsVoiceListAsync","mySpeakers","cache","volc","fetchLittleWhiteBoxTTSConfig","isFreeVoice","inferResourceId","getVoiceDesc","topAny","xbTts","xiaobaixTts","getConfig","config","xbVoiceData","XB_TTS_VOICE_DATA","inferSource","scene","lower","female_1","female_2","female_3","female_4","female_5","female_6","female_7","male_1","male_2","male_3","male_4","configurable","getTTSEnabled","saved","localStorage","getItem","_db","getDb","setDb","initDB","existing","request","indexedDB","open","onsuccess","db","onversionchange","onupgradeneeded","database","transaction","objectStoreNames","contains","store","createObjectStore","keyPath","createIndex","unique","objectStore","indexNames","ensureLive2DStore","ensureSdkCacheStore","LIVE2D_RUNTIME_TYPES","LEGACY","CUBISM5","RUNTIME_TYPE_SET","values","normalizeCubismVersion","major","match","parseInt","parseMajorVersion","inferCubismVersionFromModelJson","modelJson","jsonRecord","directCandidates","Version","version","Meta","meta","candidate","FileReferences","Model","normalizeLive2DRuntimeType","resolveRuntimeTypeFromCubismVersion","cubismVersion","resolveLive2DRuntime","modelData","input","inferredVersion","runtimeType","withResolvedLive2DRuntime","resolved","resolveSlotId","_modelId","ensureDb","saveLive2DModel","cubismVersionRaw","uploadTimeRaw","uploadTime","fileSizeRaw","fileSize","modelId","moc3","moc","physics","pose","textures","motions","expressions","normalizeStoredModel","put","oncomplete","getLive2DModel","slotId","hasLive2DModel","Live2DLoader","PIXI_URL","CUBISM4_CORE_URL","CUBISM4_CORE_FALLBACK_URLS","CUBISM5_CORE_URL","CUBISM5_CORE_FALLBACK_URLS","CUBISM2_CORE_URL","SDK_URL","CUBISM5_RUNTIME_URL","CUBISM5_RUNTIME_FALLBACK_URLS","SDK_CACHE_KEY","_READY_MARK","_RUNTIME_KEY","isLoaded","loadPromise","legacyCoreLoaded","legacyCorePromise","legacyCoreSource","cubism5CoreLoaded","cubism5CorePromise","cubism5CoreSource","cubism5RuntimeLoaded","cubism5RuntimePromise","cubism5RuntimeSource","legacyLive2DNamespace","cubism5Live2DNamespace","patchedResolveUrlPrototypes","WeakSet","patchedXhrLoaderNamespaces","pixiUrlResolvePatched","pixiUrlResolveOriginal","legacyCoreObject","cubism5CoreObject","activeCoreType","loadedScriptUrls","_getUrlBase","URL","location","href","hash","search","slashIndex","_normalizeRuntimeUrl","_ensureCubismCoreLocateFile","_topWindow","coreUrl","baseUrl","Live2DCubismCore","locateFile","_loadScriptSrc","doc","script","timer","src","crossOrigin","onload","load","_getRuntime","getRuntime","_doLoad","targetWindow","runtime","_setRuntime","_detectActiveRuntimeType","getPixi","pixi","activeNamespace","PIXI","live2d","Live2DModel","live2dModel","live2dNamespace","getRuntimeNamespace","pixiVersion","VERSION","loadedAt","_getLatestMocVersion","csmGetLatestMocVersion","_waitForLatestMocVersion","expectedMajor","intervalMs","startedAt","latestVersion","_isLegacyMocVersion","latestMocVersion","_isCubism5MocVersion","requiredVersion","_setGlobalCubismCore","coreObject","ensureLegacyCore","previousCore","coreUrls","_getCubism4CoreUrls","coreText","then","_executeScript","loadedVersion","candidateError","ensureCubism5Core","requiredLatestVersion","existingIsCubism5","hasPinnedCubism5Source","_getCubism5CoreUrls","_isDirectResourceUrl","_patchPixiUrlResolve","utils","urlApi","originalResolve","loaderRef","resourcePath","_patchModelSettingsResolveURL","runtimeNamespace","runtimeLabel","patchedCount","ctorName","proto","resolveURL","__galgameResolveUrlPatched","originalResolveURL","_patchXhrLoader","XHRLoader","originalLoader","loader","hasNamespace","hasXHRLoader","loaderType","context","rawUrl","requestUrl","requestType","header","signature","fromCharCode","_getCubism5RuntimeUrls","pushUrl","fallbackUrl","ensureCubism5Runtime","runtimeUrls","runtimeUrl","runtimeText","activateRuntime","pixiText","Live2D","core2Text","cached","_getFromCache","sdk","sdkText","_saveToCache","textContent","tx","clearCache","delete","DEFAULT_CONFIG","longPressDelay","doubleClickWindow","moveThreshold","GestureRecognizer","element","onGesture","isDraggingCheck","state","startPos","longPressTimer","doubleClickTimer","longPressFired","moved","activePointerId","destroyed","boundPointerDown","boundPointerMove","boundPointerUp","boundContextMenu","constructor","maxTouchPoints","handlePointerDown","handlePointerMove","handlePointerUp","preventDefault","destroy","clearAllTimers","_e","pointerType","isPrimary","pointerId","clientX","clientY","clearLongPressTimer","resetState","dx","dy","sqrt","clearDoubleClickTimer","Live2DStage","app","canvas","glContext","container","mountStack","mountMode","_pendingFloatingResize","loadingOverlay","loadingText","loadingBarFill","interactionLayer","gestureRecognizer","_dragClass","_minVisiblePx","_interactionPaddingPx","_alphaHitThreshold","_maxPixelScanSamples","_onPositionChange","_boundWindowResize","_interactionSyncTimer","_pixelReadBuffer","_lastClampLogAt","_clampPosition","width","height","minVisible","_top","viewportWidth","innerWidth","documentElement","clientWidth","viewportHeight","innerHeight","clientHeight","safeWidth","safeHeight","safeMinVisibleX","safeMinVisibleY","minX","minY","maxX","maxY","safeX","safeY","clampedX","clampedY","clamped","_shouldClampCurrentPosition","hasCustom","style","right","bottom","hasExplicitLeftTop","left","_getContainerRectSize","rect","getBoundingClientRect","_isRectFullyOutsideViewport","_getVisibleAreaRatio","rectWidth","rectHeight","visibleLeft","visibleTop","visibleRight","visibleBottom","visibleArea","totalArea","_clampPositionByAxis","viewportSize","safeSize","safeViewport","safeMinVisible","safeValue","_clampContainerToViewport","shouldClamp","fullyOutside","visibleRatio","isResizeClamp","forceFullVisible","minVisibleX","minVisibleY","nextX","nextY","to","_bindWindowResize","_unbindWindowResize","passive","_getPIXI","_measureOpaqueBoundsFromCanvas","containerWidth","containerHeight","gl","bufferWidth","drawingBufferWidth","bufferHeight","drawingBufferHeight","pixels","readPixels","RGBA","UNSIGNED_BYTE","scanStep","alphaThreshold","rowOffset","scaleX","scaleY","_syncInteractionLayerBounds","disableLayer","pointerEvents","cursor","parseFloat","applyBounds","padding","x1","y1","stage","children","alphaBounds","getBounds","bounds","fallbackWidth","fallbackHeight","_startInteractionSyncTimer","_stopInteractionSyncTimer","setInterval","clearInterval","_enablePointerDrag","$container","dragTarget","onPositionChange","startClientX","startClientY","startLeft","startTop","dragging","touchPointerIds","getRectSize","cleanup","removeClass","button","getRectLeftTop","setPointerCapture","dist","addClass","onPointerUp","topPx","releasePointerCapture","getSelection","removeAllRanges","_ensureLoadingOverlay","overlay","ownerDocument","hideLoadingProgress","panel","track","fill","showLoadingProgress","percent","safePercent","create","stale","getElementById","position","body","className","dpr","devicePixelRatio","getContext","alpha","antialias","stencil","depth","preserveDrawingBuffer","premultipliedAlpha","attrs","getContextAttributes","Application","view","backgroundAlpha","autoStart","resolution","autoDensity","$","draggable","handle","start","ui","drag","stop","interactionTarget","currentScale","scale","isPinching","pinchStartDistance","pinchStartScale","activeTouchPointers","emitScaleChange","nextScale","safeScale","onScaleChange","getPinchDistance","points","setDraggableState","onTouchPointerEnd","distance","delta","deltaY","onTap","onDoubleTap","onLongPress","hasClass","getStage","isPreviewMounted","pushMount","mountEl","isConnected","nextSibling","styleText","getComputedStyle","popMount","entry","restore","resize","resizeFloating","renderer","resizePreview","EXPRESSION_LIVE2D_MAP","uniquePush","uniquePushAllowEmpty","finalValue","uniqueMotionPush","normalizeFileStem","noQuery","filePart","decoded","decodeURIComponent","normalizeDefinitionName","directName","Name","Id","File","collectSettingsCandidates","motionManager","internalModel","rawSettings","isExpressionFileLike","isMotionFileLike","isMotionDefinition","node","soundLike","Sound","sound","countMotionDefinitions","count","mergeGroupCount","keyRaw","groupName","parsedCount","safeCount","prev","pushFromContainer","names","fallbackPrefix","fallbackPrefixInner","pushFromList","fallbackName","collectExpressionNamesFromUnknown","visited","visit","itemAny","fileLike","anyObj","directFile","rawKey","keyLower","keyIsExpression","nextContext","collectMotionGroupCountsFromUnknown","parentKey","keyIsMotionContainer","nested","nestedRawKey","nestedValue","nestedRaw","nestedKey","nestedCount","pushMotionEntriesFromGroupContainer","isKnownMotionDef","groupRaw","groupTrimmed","collectMotionEntries","definitions","settingsCandidates","Motions","collectExpressionNames","expressionManager","Expressions","getExpressionCount","getExpressionName","getExpressionFile","collectMotionGroupNames","groupNames","pushFromObject","keys","motionGroups","anySettings","getMotionGroupCount","getMotionGroupName","getMotionGroupNames","matchLive2DExpression","targetExpression","override","overrideName","mapping","candidateRaw","exact","matchLive2DMotion","hasEmptyGroupMarker","overrideGroup","rawGroup","normalizeMotionOverrideGroup","overrideIndexRaw","overrideIndex","exactByGroupIndex","exactGroup","exactInGroup","firstInGroup","exactByName","fuzzyByName","nameLower","fuzzyGroup","fuzzy","TICKER_REGISTERED_FLAG","Live2DManager","_JSDELIVR_HOSTS","_runtime","_runtimeType","_runtimeInfo","_localBlobUrls","_xhrBlobUrlSupport","_xhrBlobUrlSupportPromise","_hasLoggedBlobUrlDisabled","isReady","modelBaseWidth","modelBaseHeight","modelBaseBounds","_lastModelJson","_lastModelJsonSourceUrl","_autoMotionTimer","autoMotionLoopEnabled","_mouthParamCore","_mouthParamIds","_mouthParamIndexes","_mouthParamRangeMins","_mouthParamRangeMaxs","_mouthParamWarned","_mouthCurrentValue","_lipSyncActive","_inModelUpdate","_writeMaskCore","_writeMaskRestore","_updateHookModel","_updateHookRestore","_manualMouthParamEnabled","_manualMouthParamIds","_manualMouthParamIdSet","runtimePixi","_setRuntimeInfo","runtimeInfo","_registerLocalBlobUrl","_revokeLocalBlobUrls","topURL","revokeObjectURL","_disableXhrBlobUrls","_supportsXhrBlobUrls","XHR","XMLHttpRequest","createObjectURL","blobUrl","xhr","responseType","timeout","buf","onabort","ontimeout","finally","supported","_isLocalModelPath","_normalizeLocalModelId","_path","_toArrayBuffer","_normalizeMocVersion","rawMocVersion","_readMoc3HeaderVersion","moc3Data","moc3Buffer","DataView","getUint32","_detectCubismVersionFromMoc3Buffer","core","Moc","fromArrayBuffer","csmGetMocVersion","mocRef","_release","release","_detectRuntimeFromMoc3","resolvedRuntime","headerVersionRaw","headerVersion","runtimeWithHeader","moc3Version","resolvedVersion","_isCoreParseError","stack","_ensureRuntimeDependencies","contextLabel","requiredMocVersion","patched","fallbackRuntime","_getLive2DModelClass","namespace","_registerTickerForRuntime","registerTicker","Ticker","_blobToDataUrl","reader","FileReader","readAsDataURL","_normalizeStoredPath","_getPathBaseName","lastSlash","_guessMimeTypeByPath","endsWith","_findStoredTextureBlob","targetPath","normalizedTarget","targetBaseName","byBase","indexed","_findStoredMotionData","targetNormalized","targetGroup","groupList","crossExact","crossByBase","_findStoredExpressionData","_toLocalBlobUrl","mimeType","_toLocalDataUrl","_buildLocalModelBlobUrl","modifiedModelJson","_normalizeLegacyCubism2Settings","mapFile","pathHint","fallbackMime","mocUrl","Textures","texPath","textureBlob","physicsUrl","Physics","poseUrl","Pose","motionListRaw","motionList","targetList","storedMotion","existingDef","motionPath","motionData","motionUrl","storedExpr","exprPath","exprData","exprUrl","mocPath","textureList","texturePath","textureUrl","physicsPath","posePath","motionDef","exprDef","modelBlob","_buildLocalModelDataUrl","_encodePathSegment","segment","safeChar","encoded","ch","_normalizeRemoteUrl","inputUrl","urlObj","pathname","_normalizeResourceRef","inputRef","qIndex","pathPart","queryPart","_getMirrorEikanyaModelUrl","modelUrl","_expandJsDelivrHosts","hostname","results","host","u","_convertJsDelivrGhToRawCandidates","owner","repoWithRef","filePath","repo","suffix","_buildModelUrlCandidates","bases","addBase","mirrorUrl","variant","_createModelWithTimeout","dataUrl","timeoutPromise","_resolve","race","autoUpdate","autoInteract","_fetchWithTimeout","init","AbortController","controller","abort","_toPositiveNumber","_toScale","_readModelBaseBounds","getLocalBounds","_resolveModelBaseBounds","measured","_applyStageTransform","stageWidth","stageHeight","safeStageWidth","safeStageHeight","safeModelWidth","safeModelHeight","fitScale","finalScale","visible","anchor","pivot","modelWidth","modelHeight","hintKeys","texture","textureId","skin","defaultTexture","defaultSkin","selected","hint","normalizedTextures","textureCount","_clearAutoMotionLoop","_stopCurrentMotion","stopped","tryCall","method","mm","animator","internal","_refreshManualMouthParams","ids","_setLipSyncActive","active","coreModel","_ensureLipSyncHooks","_installCoreWriteMask","setAutoMotionLoopEnabled","_startAutoMotionLoop","_pickDefaultMotionGroup","preferred","token","initialGroups","getMotionGroups","motionGroup","allGroupNames","playOne","playMotion","randGroup","randIndex","groupCount","_stripJsonComments","output","inString","quoteChar","escaping","inLineComment","inBlockComment","_tryParseModelJson","_buildModelJsonCandidates","_fetchModelJsonCandidate","useProxy","_getProxiedUrl","resp","sourceUrl","originalUrl","getCorsProxyUrl","proxied","enableCorsProxy","corsProxy","getProxyUrl","origin","retries","loadModel","onProgress","progress","reportProgress","loadWithRuntime","progressStart","progressSuffix","texturesReady","_waitForTextures","loadedCount","totalCount","ratio","destroyModel","loadedFrom","localModelData","buildLocalUrl","preferBlob","usedBlobUrl","localUrl","loaded","localError","localDataUrl","dataFallbackError","forcedRuntime","retryLocalUrl","forcedRetryError","modelUrlCandidates","candidateUrl","attemptProgressStart","attemptModel","attemptTexturesReady","attemptError","tryCreate","runtimeHint","_buildRemoteModelDataUrl","firstError","proxyDataUrl","proxyError","proxyForcedRetryError","measuredBounds","getExpressions","forceProxyResources","candidateUrls","sourceModelUrl","directError","resolveUrl","UserData","remoteMocUrl","mocResponse","mocBuffer","mocProbeError","modelJsonStr","mountToStage","removeChildAt","transform","addChild","updateScale","_getModelBaseSize","fallbackNames","mergeGroupMap","keyTrimmed","defs","getMotions","pushAll","items","cachedAny","motionsContainer","playExpression","expression","runMotionWithRuntimeFallback","motionIndex","motion","startMotion","startRandomMotion","tryRecoverByKnownEntries","playRandomAnimation","focusByClientPoint","immediate","focus","focusController","normalizedX","normalizedY","focusCenter","setMouthOpen","_characterId","clampedValue","logPrefix","getParamRange","paramId","paramIndex","NaN","readNumber","getParameterMinimumValue","getParameterMaximumValue","getParamMin","getParamMax","mapToParamValue","getIndexById","getParameterIndex","getParamIndex","applyById","mappedValue","setParameterValueById","addParameterValueById","setParamFloat","addParamFloat","applyByIndex","getParameterId","setParameterValueByIndex","addParameterValueByIndex","setParameterValue","addParameterValue","paramNames","appliedAny","manualId","paramName","getParameterCount","numericFallback","pid","range","picked","pidx","msg","presetCandidates","scannedIds","_isMouthParam","paramIdOrIndex","restoreEntries","methods","getParamRef","paramRef","apply","updater","rawUpdate","self","ret","_applyMouthValueToModel","targetValue","oldValue","applied","_getMouthParamSource","getLipSyncDebugInfo","lipSyncOverride","mouthParamsSource","mouthParamsCount","clear","retryCount","check","_textures","tex","baseTexture","valid","every","_ttsGetProxiedAudioUrlRef","LipSyncManager","audioContext","analyser","dataArray","animationFrameId","currentCharacterId","lastVolume","connectedAudioElements","_proxyAudio","_proxyAudioCleanup","fftSize","smoothingFactor","sensitivity","minThreshold","resume","AudioContextClass","AudioContext","webkitAudioContext","createAnalyser","smoothingTimeConstant","frequencyBinCount","_getProxiedAudioUrl","connectAudio","audioElement","disconnect","targetAudio","isLocalhost","isDataUrl","isBlobUrl","isSameOrigin","proxiedUrl","Audio","substring","currentTime","volume","paused","play","syncPlay","syncPause","pause","syncSeek","createMediaElementSource","connect","destination","getVolume","getByteFrequencyData","average","startSync","characterId","stopSync","frameCount","requestAnimationFrame","cancelAnimationFrame","getSettingsSnapshot","_showToastRef","showToast","toastr","info","clipText","isProxyNotFound","bodyText","hasLive2D","TTSManager","autoPlay","isPlaying","isLoading","currentAudio","currentSegmentId","littleWhiteBox","_gptSoVitsResolvedProxyRoute","_gptSoVitsActiveWeights","_gptSoVitsWeightSwitchUnavailable","_gptSoVitsWeightSwitchWarned","_gptSoVitsProxyWarned","_gptSoVitsFetchController","_edgeDirectFetchController","_edgeDirectSocket","_edgeDirectObjectUrl","_refreshProviderState","LittleWhiteBox","_onPlaybackEnded","_cleanupEdgeDirectResources","hideLoadingIndicator","jq","jQuery","on","showLoadingIndicator","classList","_abortGptSoVitsFetch","player","_stopCurrent","_getCurrentAudioElement","audio","audioElements","allAudio","querySelectorAll","anyAudio","_getPreferredAudioElement","_isProxyUrl","safeUrl","_buildGptSoVitsProxyUrl","route","_rememberProxyRoute","directUrl","remembered","rememberedUrl","_buildGptSoVitsTtsUrl","resolvedVoice","endpointRaw","modelCfg","vcfg","searchParams","_requestGptSoVitsApi","queryParams","jsonBody","pathRaw","directUrlObj","attemptTargets","addTarget","errors","credentials","_fetchGptSoVitsApi","_postGptSoVitsApi","_setGptSoVitsWeights","kind","weightsPath","normalizedKind","weights_path","_setGptSoVitsModelPair","endpointOverride","gpt_model_path","sovits_model_path","_ensureGptSoVitsWeights","modelPaths","switchMode","desiredGpt","desiredSovits","failures","trySetModelFallback","triggerMsg","fallbackErr","setModelError","setModelFetchBlocked","fetchBlocked","detail","clipped","_speakWithGptSoVits","segmentId","audioUrl","onEnded","lipId","_startLipSyncOnPlay","_speakWithEdgeDirect","cleanText","attempts","plainBase","attemptErrors","attempt","ua","isEdgeUA","allUnopened","likelyUaRejected","securityHint","synthesizeToBlob","socket","blockedHint","objectUrl","_startLipSyncWhenModelReady","maxWait","startTime","tryWait","_waitForModelReadyBeforeTTS","hasStarted","tryBind","preferredAudio","_bindLipSyncToAudio","onPlaying","onTimeUpdate","onEnd","speak","ttsConfig","tts","boundVoice","getCharacterTTSVoice","defaultVoice","resolveVoiceByName","speakerValue","contextTexts","callGenerate","ChatMonitor","messageCount","ignoreNextCount","_onTrigger","_stops","_lastUserSignalAt","_config","onTrigger","messageSentStop","_bindEvent","_messageId","_recordUserSignal","userRenderedStop","afterCommandsStop","_type","option","dryRun","quiet_prompt","generationStartedStop","generationEndedStop","_handleTriggerCount","_resolveEventName","eventKey","fromSillyTavern","SillyTavern","eventTypes","fromLegacy","tavern_events","handler","eventName","eventSource","off","eventOn","updateConfig","_shouldCountBySource","_checkAutoTrigger","roll","manualTrigger","markSelfGeneration","PROMPT_TEMPLATES","systemPrompt","responseFormat","resolvePromptTemplate","template","appendEmotionCotFormat","buildRoleplayInstruction","roleplay","roleName","lines","characterCardContent","shouldIgnoreStyleByRoleplay","ignoreCommentStyle","buildContextLines","chatContext","role","getDiceReferenceText","diceReference","referenceText","buildDiceReferenceInstruction","appendDiceAdviceRequirement","Commentator","isGenerating","_onComment","_streamStop","_latestStreamText","setCallback","cb","generate","emittedDone","chatMessages","_getChatContext","todaySpecial","_getTamakoTodaySpecialContent","roleplayOptions","_resolveRoleplayOptions","diceReferenceOptions","_resolveDiceReferenceOptions","system","user","ignoreStyleByRoleplay","responseFormatWithAdvice","finalFormat","roleplayInstruction","diceReferenceInstruction","contextLines","systemParts","buildPrompt","_generateCustom","_generateTavern","finalText","chat","userMessage","getChatResponseFormat","safeUserMessage","buildChatPrompt","maxTokens","_setupStreamListener","orderedPrompts","generateRaw","should_silence","should_stream","ordered_prompts","custom_api","_cleanupStreamListener","usePreset","buildAttemptBody","messages","stream","chat_completion_source","custom_prompt_post_processing","reverse_proxy","custom_url","custom_include_headers","requestWithAttempt","getRequestHeaders","errTxt","statusText","choices","details","iframe_events","STREAM_TOKEN_RECEIVED_FULLY","fullText","maxCount","getChatMessages","hide_state","safeMaxCount","_getCurrentCharacterCardContent","visibleSheets","visibleSheetNames","_normalizeDiceVisibleSheetNames","_getDiceDatabaseReferenceContent","apiData","_getDiceDatabaseDataFromApi","apiSummary","_summarizeDiceDatabasePayload","chatData","_getDiceDatabaseDataFromChatContext","topWindow","api","AutoCardUpdaterAPI","exportTableAsJson","_normalizeDiceDatabasePayload","_pickDiceDatabasePayloadFromMessage","TavernDB_ACU_IndependentData","TavernDB_ACU_Data","TavernDB_ACU_SummaryData","isolatedCandidates","TavernDB_ACU_IsolatedData","_pickDiceDatabasePayloadFromIsolatedData","isolated","_parseMaybeJsonRecord","slot","independentData","_isDiceDatabasePayload","sourceLabel","visibleNameSet","_normalizeReferenceText","sheets","sheet","priority","_getDiceSheetPriority","_buildDiceSheetSummary","nextLine","sheetName","rows","row","cell","dataRows","rowText","_formatDiceSheetRow","pairs","_truncateReferenceText","maxLength","characters","charIdRaw","idText","idNum","currentName","name2","fields","personality","scenario","first_mes","mes_example","system_prompt","post_history_instructions","_normalizeCharacterCardField","topDocument","currentSelector","plotContent","directText","_sanitizeTamakoText","innerText","beautifierFrame","_readTamakoPayloadFromIframe","payloadText","_extractTamakoTextFromPayload","currentContent","iframe","captureTags","_getTamakoCaptureTags","tags","valuesFromTags","_extractTamakoTagText","extensionSettings","TamakoMarket","safeTag","escapedTag","regex","RegExp","exec","RE_THINK_CLOSED","RE_THINK_UNCLOSED","parseBracketContent","bracketContent","pipeParts","exprVoicePart","parseEmotionCotText","rawText","stripThinkBlocks","normalizedTag","trimStart","after","isPendingPrefix","speakerMatch","stripFromText","prefixMatch","useUiStore","showSettings","openSettings","closeSettings","_hoisted_1","class","_hoisted_2","_hoisted_3","__name","isDone","autoCloseDelaySeconds","emits","setup","__props","emit","__emit","displayText","bubbleStyle","LOADING_FRAMES","positionTimer","loadingTimer","autoCloseTimer","loadingFrameIndex","getFiniteNumber","updateBubblePosition","vw","vh","getModelHeadAnchor","fallbackX","fallbackY","rawLeft","rawTop","safeLeft","safeTop","startPositionSync","stopPositionSync","stopLoadingAnimation","stopAutoCloseTimer","scheduleAutoClose","delayMs","delaySeconds","normalizedSeconds","getAutoCloseDelayMs","closeBubble","watch","onUnmounted","_ctx","_cache","onClick","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","placement","motionLoopEnabled","menuEl","inputEl","chatOpen","posX","posY","panelTransform","computed","panelStyle","clampIntoViewport","el","openChat","nextTick","select","onInputKeydown","shiftKey","onGlobalKeydown","ref_key","$event","$emit","placeholder","onKeydown","disabled","_","isModelFile","FILTERED_EXTENSIONS","shouldShow","fetchDirectory","remaining","resetTime","resetDate","RateLimitError","isModel","super","toLocaleTimeString","searchQuery","expanded","loading","loadedOnce","childError","isSelected","filteredChildren","q","loadChildren","handleClick","_component_TreeNode","paddingLeft","title","child","onSelectModel","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","rootEntries","rootLoading","errorMsg","selectedPath","selectedName","filteredRootEntries","confirmLoad","cdnUrl","encodedPath","buildCdnUrl","loadRoot","TreeNode","Live2DUploader","JSZip","_loadJSZip","uploadZip","zip","loadAsync","modelJsonEntry","_findModelJson","modelDir","modelJsonText","isModel3","isModel2","_extractFile","moc3HeaderVersion","detectedCubismVersion","_resolveModel3CubismVersion","_extractTextures","_extractMotions","_extractExpressions","_extractFileOptional","_extractTexturesV2","_extractMotionsV2","_extractExpressionsV2","jsonFallbackVersion","jsonEntries","dir","best","bestScore","baseDir","relativePath","fullPath","normalizedPath","texPathRaw","collectScannedMotions","scanAllZip","scanned","scannedMotions","exprList","scannedExprs","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","_hoisted_58","_hoisted_59","_hoisted_60","_hoisted_61","_hoisted_62","_hoisted_63","_hoisted_64","_hoisted_65","_hoisted_66","_hoisted_67","_hoisted_68","_hoisted_69","_hoisted_70","_hoisted_71","_hoisted_72","_hoisted_73","_hoisted_74","_hoisted_75","_hoisted_76","_hoisted_77","_hoisted_78","_hoisted_79","_hoisted_80","_hoisted_81","_hoisted_82","_hoisted_83","_hoisted_84","_hoisted_85","_hoisted_86","_hoisted_87","_hoisted_88","_hoisted_89","_hoisted_90","_hoisted_91","_hoisted_92","_hoisted_93","_hoisted_94","_hoisted_95","_hoisted_96","_hoisted_97","_hoisted_98","_hoisted_99","_hoisted_100","_hoisted_101","_hoisted_102","_hoisted_103","_hoisted_104","_hoisted_105","_hoisted_106","_hoisted_107","_hoisted_108","_hoisted_109","_hoisted_110","_hoisted_111","_hoisted_112","_hoisted_113","_hoisted_114","_hoisted_115","_hoisted_116","_hoisted_117","_hoisted_118","_hoisted_119","_hoisted_120","_hoisted_121","_hoisted_122","_hoisted_123","_hoisted_124","_hoisted_125","_hoisted_126","_hoisted_127","_hoisted_128","_hoisted_129","_hoisted_130","_hoisted_131","_hoisted_132","_hoisted_133","_hoisted_134","_hoisted_135","_hoisted_136","_hoisted_137","_hoisted_138","_hoisted_139","_hoisted_140","_hoisted_141","_hoisted_142","_hoisted_143","_hoisted_144","_hoisted_145","_hoisted_146","_hoisted_147","_hoisted_148","_hoisted_149","_hoisted_150","_hoisted_151","_hoisted_152","_hoisted_153","_hoisted_154","_hoisted_155","_hoisted_156","_hoisted_157","_hoisted_158","_hoisted_159","_hoisted_160","_hoisted_161","_hoisted_162","_hoisted_163","_hoisted_164","_hoisted_165","_hoisted_166","_hoisted_167","_hoisted_168","_hoisted_169","_hoisted_170","_hoisted_171","_hoisted_172","_hoisted_173","_hoisted_174","_hoisted_175","_hoisted_176","_hoisted_177","_hoisted_178","_hoisted_179","_hoisted_180","_hoisted_181","_hoisted_182","_hoisted_183","_hoisted_184","_hoisted_185","_hoisted_186","_hoisted_187","_hoisted_188","_hoisted_189","_hoisted_190","_hoisted_191","_hoisted_192","_hoisted_193","_hoisted_194","_hoisted_195","_hoisted_196","_hoisted_197","_hoisted_198","_hoisted_199","_hoisted_200","_hoisted_201","_hoisted_202","_hoisted_203","_hoisted_204","_hoisted_205","_hoisted_206","_hoisted_207","_hoisted_208","_hoisted_209","_hoisted_210","_hoisted_211","_hoisted_212","_hoisted_213","_hoisted_214","_hoisted_215","_hoisted_216","_hoisted_217","_hoisted_218","_hoisted_219","_hoisted_220","_hoisted_221","_hoisted_222","_hoisted_223","_hoisted_224","_hoisted_225","_hoisted_226","_hoisted_227","_hoisted_228","_hoisted_229","_hoisted_230","_hoisted_231","_hoisted_232","_hoisted_233","_hoisted_234","_hoisted_235","_hoisted_236","_hoisted_237","_hoisted_238","_hoisted_239","_hoisted_240","_hoisted_241","_hoisted_242","_hoisted_243","_hoisted_244","_hoisted_245","_hoisted_246","_hoisted_247","_hoisted_248","_hoisted_249","_hoisted_250","_hoisted_251","_hoisted_252","_hoisted_253","_hoisted_254","_hoisted_255","_hoisted_256","_hoisted_257","_hoisted_258","_hoisted_259","sectionTabs","en","activeSection","toBoundedNumber","clamp","ensureNumericSettingsIntegrity","temperatureLabel","frequencyPenaltyLabel","presencePenaltyLabel","topPLabel","petScaleLabel","recommendedModels","commentStyles","commentTriggerModeOptions","apiSources","showBrowser","customModelUrl","localModelFileInput","uploadingLocalModel","localModelActionBusy","localModelStatus","localModelError","localModelInfo","localModelBusy","localModelExists","diceReferenceSheetOptions","refreshingDiceSheetOptions","normalizeDiceReferenceSheetName","dedupeDiceReferenceSheetNames","parseDiceReferenceRecord","isDiceReferencePayload","extractDiceReferenceSheetNamesFromPayload","tableRecord","pickDiceReferencePayloadFromIsolatedData","pickDiceReferencePayloadFromMessage","getDiceReferenceSelectedSheets","setDiceReferenceSelectedSheets","isDiceSheetVisible","diceReferenceSheetSummary","optionsCount","refreshDiceReferenceSheetOptions","fromApi","readDiceReferenceSheetNamesFromApi","fromChat","readDiceReferenceSheetNamesFromChat","selectAllDiceReferenceSheets","clearDiceReferenceSheets","ttsEnabled","ttsVoiceList","refreshingTtsVoices","gptSoVitsModelsJson","gptSoVitsVoicesJson","ttsTestText","showGptModelManager","showGptModelEditor","gptModelManagerSearch","gptModelManagerModels","gptModelManagerImportJsonInputRef","gptModelManagerImportFolderInputRef","gptModelEditor","gptModelEditorModelId","gptModelEditorExpressionRows","isGptSetModelMode","ttsVoiceHint","gptModelSummaryHint","enabledCount","refCount","defaultSpeaker","filteredGptModelManagerModels","keyword","emotionTags","live2dExpressions","live2dMotionGroups","live2dMotions","refreshingLive2dLists","live2dExpressionOptions","dedup","live2dExpressionOptionSet","normalizeMotionIndex","normalizeMotionGroupValue","isEmptyMotionGroupMarker","normalizeMotionOverridePayload","explicitEmptyGroup","encodeMotionOption","hasExplicitEmpty","resolveMotionOverridePayload","byName","getMotionOverrideValue","getMotionOverrideLabel","groupLabel","setMotionOverrideValue","rawValue","decodeMotionOption","live2dMotionSelectOptions","safeName","live2dMotionOptionSet","live2dListSummary","exprCount","motionCount","live2dPreviewMountEl","live2dPreviewInteractEl","previewMounted","previewTag","previewStatus","previewZoomFactor","previewPanOffsetX","previewPanOffsetY","previewBasePose","previewIsDragging","previewDragStart","previewDragOrigin","previewMountPromise","previewResizeObserver","getPreviewCanvasSize","applyPreviewViewport","maxOffsetX","maxOffsetY","render","resetPreviewViewport","getPreviewDragPoint","ev","originalEvent","touches","changedTouches","disconnectPreviewResizeObserver","ensurePreviewMounted","interactEl","__dpPreviewHandlers","onDown","point","onMove","onUp","onWheel","bindPreviewViewportEvents","ResizeObserver","observe","bindPreviewResizeObserver","baseScale","capturePreviewBasePose","refreshLive2DLists","cleanupPreviewMount","handlers","unbindPreviewViewportEvents","restored","replayPreview","previewEmotion","section","onBeforeUnmount","fetchingModels","modelFetchError","testingConnection","connectionStatus","connectionError","showAdvanced","showEmotionAdvanced","showLipSyncAdvanced","lipSyncManualParamsText","overlayFallbackStyle","inset","minHeight","zIndex","display","alignItems","justifyContent","panelFallbackStyle","flexDirection","maxHeight","normalizeModelList","maybeId","maybeModel","maybeName","getModelListSafe","customApi","helperGetModelList","TavernHelper","getModelList","apiurl","Authorization","getModelListByHttp","fetchModels","testConnection","formatFileSize","formatLocalUploadTime","toLocaleString","refreshLocalModelInfo","triggerLocalModelUpload","click","onLocalModelFileChange","storedModel","useUploadedModel","warning","clearUploadedModel","deleteLive2DModel","onBrowserLoad","loadCustomUrl","blobMatch","resetEmotionConfigs","onAliasesBlur","parseAliasesText","m","autoMatchLive2DOverrides","overwrite","filled","exprOverride","motionEnabled","motionGroupOverride","matchedMotion","clearLive2DOverrides","cleared","hadExpr","hadGroup","motionText","onToggleTtsEnabled","setItem","setTTSEnabled","refreshTtsVoices","normalizePathSepLocal","onGptSwitchModeChange","onGptRootDirChange","nextRoot","onGptImportPrefixChange","nextPrefix","modelToLegacyVoice","defRef","syncLegacyVoicesFromModels","setGptSoVitsModelsTextarea","setGptSoVitsVoicesTextarea","mergeGptSoVitsModelsByName","incoming","modelRaw","deepCloneGptModels","createGptSoVitsModelTemplateConfig","syncGptModelManagerFromSettings","openGptModelManager","closeGptModelEditor","closeGptModelManager","applyGptModelManagerModelsToSettings","showSuccessMessage","legacyVoices","firstUsable","saveGptModelManager","saveGptModelManagerAndClose","addGptModelManagerModel","getGptModelManagerIndexById","targetId","findIndex","openGptModelManagerImportJson","openGptModelManagerImportFolder","onGptModelManagerImportJsonChange","normalizedIncoming","onGptModelManagerImportFolderChange","inferred","hasRelativePath","exportGptModelManagerModels","download","ensureGptModelEditorStructure","normalizeGptModelEditorRefAudio","openGptModelEditor","targetRefId","syncGptModelEditorExpressionRowsFromModel","addGptModelEditorRefAudio","addGptModelEditorExpressionRow","fallbackRefId","saveGptModelEditor","validRefIds","nextMap","applyGptModelEditorExpressionRowsToModel","targetIndex","testTts","ctx","getCurrentCharacterId","selectedUsable","targetName","stopTts","applyLipSyncManualParams","syncedPrefix","step","accept","onChange","checked","opt","onBlur","onInput","webkitdirectory","directory","multiple","refAudio","cloned","splice","removedId","rowIndex","ModelBrowser","onCancel","onLoadModel","OPEN_SETTINGS_FN_KEY","uiStore","bubbleText","bubbleDone","globalOpenSettingsFn","modelLoadTaskId","modelLoadingHideTimer","statusCheckTimer","viewportResizeSyncTimer","boundWindowResizeHandler","boundVisualViewportResizeHandler","gazeFollowBound","gazePointerMoveHandler","gazePointerDownHandler","gazeFollowRafId","gazePendingPoint","showMenu","menuAnchor","menuPlacement","showModelBrowser","phoneTtsBridgeBound","phoneMessageReceivedHandler","phoneAIGenCompleteHandler","phoneTtsListenSinceSec","phoneSeenMessageKeys","phoneSeenMessageOrder","phoneTtsQueue","phoneTtsQueueRunning","baibaiPhoneTtsBridgeBound","baibaiPhonePollTimer","baibaiEventStops","baibaiSeenAssistantIds","baibaiSeenAssistantOrder","getPhoneStore","extension_settings","acsusPawsPuffs","phone","localAny","getPhoneContactName","contactId","safeId","contacts","isNonUserPhoneMessage","sender","sanitizePhoneSpeakText","isPhoneAutoReadEnabled","isBaibaiUserSender","senderName","append","name1","userName","getNormalizedUserNames","parseBaibaiCommandArgs","rawArgs","quotedArgs","quotedMatcher","matchAll","extractBaibaiTextPayloads","rawPayload","marker","markerType","extractPhoneSpeakText","replyContent","amount","note","filename","months","membershipType","getPhoneMessageKey","safeContact","messageId","time","rememberPhoneMessageKey","shift","bindTavernEvent","fromTop","resolveTavernEventName","removeListener","resetBaibaiAssistantSeenState","rememberBaibaiAssistantMessageId","getAssistantChatMessages","parseBaibaiPhoneMessagesFromAssistant","normalizedText","hasBaibaiPhoneCommand","assistantMessageId","message_id","commandMatches","commandIndex","commandName","textPayloads","rawTime","messageIdPart","speakText","markExistingBaibaiMessagesAsSeen","collectUnsyncedBaibaiMessages","parsedMessages","enqueuePhoneMessageForTTS","waitForTTSIdle","startAt","messageSec","phoneAutoRead","contactName","ttsOverrides","contextPrefix","drainPhoneTTSQueue","collectUnsyncedPhoneMessages","history","chats","getPhoneChatHistory","pending","reverse","bindPhoneTTSBridge","chatKey","markExistingPhoneMessagesAsSeen","topDoc","unbindPhoneTTSBridge","unbindBaibaiPhoneTTSBridge","toggleMotionLoop","cyclePersona","personas","openModelBrowser","onModelBrowserLoad","onModelChange","onManualChat","closePet","onBubbleHidden","unbindGlobalGazeFollow","getStageSize","normalizePetScale","clearModelLoadingHideTimer","clearStatusCheckTimer","clearViewportResizeSyncTimer","bindGlobalGazeFollow","handlePointerEvent","scheduleGazeFollow","resetFocus","clearGazeFollowRaf","syncGazeFollowBinding","scheduleViewportResizeSync","stageSize","recoverOnce","stageEl","visibility","opacity","scheduleStatusCheck","syncStageAfterViewportResize","renderModelLoadProgress","notifyInitError","loadModelWithProgress","taskId","rectSummary","hasLive2d","hasModel","stageChildren","stageVisible","prevOutline","outline","prevBackground","background","prevZIndex","initPet","getProxiedAudioUrl","setLipSyncRefs","sync","chatChangedStop","bindBaibaiPhoneTTSBridge","applyEmotionToLive2D","initialScale","vibrate","openFunctionMenu","nextPath","isLocalModel","registerGlobalOpenSettings","onMounted","viewport","visualViewport","bindViewportResizeRecovery","unbindViewportResizeRecovery","unregisterGlobalOpenSettings","ChatBubble","onHidden","SettingsPanel","onClose","FunctionMenu","onSendChat","onToggleMotionLoop","onSwitchModel","onSwitchPersona","onCloseModel","deteleport_style","BUILD_TAG","LEGACY_MENU_BUTTON_LABELS","SETTINGS_LABEL","pinia","EXTENSIONS_MENU_CONTAINER_ID","EXTENSIONS_MENU_ITEM_ID","EXTENSIONS_MENU_CLICK_NAMESPACE","extensionsMenuRetryTimer","getParentDocument","bindExtensionsMenuDelegation","parentDoc","clickEvent","stopPropagation","$extensionsMenu","$extensionsMenuButton","is","trigger","summary","onExtensionsMenuItemClick","injectExtensionsMenuItem","$item","removeExtensionsMenuItem","removeLegacyMenuButtons","_idx","attr","clone","appendTo","$app","createApp","PetContainer","use","errorHandler","_instance","warnHandler","trace","mount","chatId","getCurrentChatId","CHAT_CHANGED","newChatId"],"sourceRoot":""}